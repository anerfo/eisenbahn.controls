'*** Allgemeine Kommentare
'***
'*** Datum der letzten Änderung : 12.01.2026
'***
'*** Letzte Änderung:
'***
'***                !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!! = x12 !!!!!
'***                in den Programmen für Bergfahrt geändert, da Kontakt 1.2 wackelt (geändert in x99) 
'***
'***                Betriebsart 0-4 Variante 2 eingebaut
'***
'***                GUID korrigiert (die vier Linien für die Darstellung der Routen lagen im Vordergrund)
'***
'***                Betriebsartenvarianten werden gespeichert
'***
'***                Betriebsart 2-0 Variante 2 eingebaut
'***
'***                Betriebsart 2-0 Variante 1 eingebaut
'***
'***                Rundenzähler eingebaut
'***
'***                Kontakt 0.0 false und Kontakt 0.2 false - Bahnhofsausfahrt - auskommentierte Zeilen reaktiviert
'***                (Signal 11 schalten)
'***
'***                Fahrparameter von Excel-Tabelle in das Programm übernommen
'***
'***                Lokprogramme erweitert (Rückmeldekontakten ein Lokprogramm zugeordnet)
'***                 
'***                Kamerasteuerung geändert
'***                Neue Rückmeldungen eingebaut:
'***                3.6 für Stopp in Bärental (10.12.2019)
'***                ButtonVisible korrigiert (26.02.2019)
'***                 
'***                Halt bei Talfahrt und in der Diagonalen
'***                Bedienoberfläche modifiziert (28.01.2019)
'***                Anfahr-Bergfahrt und Anhalteprogramm als Unterprogramm
'***                Lokprogramme ergänzt (03.01.2018)
'***                verzögerter Start bei Lokprogrammen _T_StartEinzelLokx (30.12.2018)
'***                EinzelLokStopElapsed: Zyklusende entfernt
'***                Betriebsart 1/0 oben lang: Weiche 17 nicht mit Kontakt 0.5 sondern erst mit 0.4 rechts schalten   (102)
'***                                           Weiche 17 nicht mit Kontakt 0.1 sondern mit Kontakt 0.0 links schalten (103)
'***                Programm für Lok40 eingebaut Betriebsart 1/0 (24.12.2018)
'***                Lokfunktionen gespeichert
'***                Timer für Kurzzug auf Gleis 1 umgebaut und mit Lok29 getestet (23.12.2018)
'***                Programm für Lok29 eingebaut Betriebsart 1/0 (23.12.2018)
'***                Programm für Lok68 eingebaut Betriebsart 1/0 (23.12.2018)
'***                Stopp im SBHF geändert - Timer 9 und 11 - Gleis 1,2,3,4 Route unten (20.11.2018)
'***
'***                Unterprogramm BergfahrtLokx geändert (Rückmeldung 1.2 ODER eingefügt). Zug soll bei der Mühle links fahren können.
'***

Public Class Automatikprogramme

    Implements Communication.KontaktEventUpdateInterface
    Implements Communication.WeichenEventUpdateInterface

    Private Const TimerTableName = "AutomatikTimer"
    Private Const AutomatikParameterTableName = "AutomatikParameter"
    Private Const HueLightName = "Hue lightstrip Freizeitraum"

    Private _eb As Communication.KernelInterface
    Private _daten As Daten.DatenInterface
    Private _dmxServer As DMXServer.IDMXServer
    Private _LokStufen As LokStufen
    Private _AnzahlLoks As Integer
    Public WithEvents _kalteHerz As DasKalteHerz = Nothing

    Private _HueBridge As Hue.HueBridge
    Private _HueLight As Hue.Contracts.HueLight
    Private _Webcams As Webcams.IWebcamController
    Private _mediaProvider As MediaProvider.IMediaProvider
    Private _Betriebsparameter As Betriebsparameter

    Private _aktiv As Integer

    Private _AutomatikParameter, _AutomatikParameter1, _AutomatikParameterH, _Betriebsart, _Betriebsart12, _Betriebsart34, A_Stop, A_StopH, A_StopB, _Route_Gleis1, _Route_Gleis2, _Route_Gleis3, _Route_Gleis4, _StopZug1, _StopZug2, _StopZug3, _StopZug4 As Integer
    Private _Bhf_Gleis1, _Bhf_Gleis2, _Bhf_Gleis3, _Bhf_Gleis4, _Bhf2_Gleis1, _Bhf2_Gleis2, _Bhf2_Gleis3, _Bhf2_Gleis4, _SBhf_Gleis1, _SBhf_Gleis2, _SBhf_Gleis3, _SBhf_Gleis4, _Berg_Gleis1, _Berg_Gleis2, _Berg_Gleis3, _Berg_Gleis4, Diagonale_Gleis1, Diagonale_Gleis2, Diagonale_Gleis3, Diagonale_Gleis4, Talstrecke_Gleis1, Talstrecke_Gleis2, Talstrecke_Gleis3, Talstrecke_Gleis4 As Integer
    Private _Kurzzug1, _Kurzzug2, _Kurzzug3, _Kurzzug4, _NachlaufZug1, _NachlaufZug2, _NachlaufZug3, _NachlaufZug4, _Weichen_in_Startposition, _Weichen_initialisiert, _Signale_in_Startposition, _Signale_initialisiert, Start_Betaetigt, Stop_Betaetigt,
            _TimerStory_laeuft, _Innenbeleuchtung As Boolean
    Private _Beleuchtung, _Funktionsmodelle, _Hue, _HueHell, _Hue_Reset, _HueAus, _StoryPointer, _StoryControl, _StoryAuto, _StoryZeit, _Music_laeuft, _Zug_laeuft, _Motor, _Innenbeleuchtung2, _Fahrzeugbeleuchtung2, _Dampf, _AkustischeSignale, _Durchsagen, _Fernlicht As Integer
    Private Ort_Lok1, Ort_Lok2, Ort_Lok3, Ort_Lok4, ARoute_Lok1, ARoute_Lok2, ARoute_Lok3, ARoute_Lok4, _Kamera, _aktuelleKamera, Startzug As Integer
    Private _GleisFrei1, _GleisFrei2, _GleisFrei3, _GleisFrei4 As Integer
    Private _Betriebsart0_3Var, _Betriebsart0_4Var, _Betriebsart0_5Var, _Betriebsart1_0Var, _Betriebsart1_3Var, _Betriebsart1_4Var, _Betriebsart1_5Var As Integer
    Private _Betriebsart2_0Var, _Betriebsart2_3Var, _Betriebsart2_4Var, _Betriebsart2_5Var, _Betriebsart3_0Var, _Betriebsart3_3Var, _Betriebsart3_4Var, _Betriebsart3_5Var As Integer
    Private anfahren, abstellen, bremsen, bremsen_kurz_von_links, bremsen_kurz_von_rechts, bergfahrt, nachlauf As Integer
    Private _Loknummer_4A, _Loknummer_4B As Integer

    Private Betriebsparameter As ExcelDocument = New ExcelDocument("H:\\EB_Media\\Betriebsparameter\\Betriebsparameter.xlsx")
    '*** Fahrprogramm für Züge erstellen FPZ
    '*** Variable definieren
    '*** Programmschritte definieren
    Private _Prog10, _Prog11, _Prog12, _Prog13, _Prog14, _Prog15, _Prog16, _Prog17, _Prog18, _Prog19 As Integer
    Private _Prog20, _Prog21, _Prog22, _Prog23, _Prog24, _Prog25, _Prog26, _Prog27, _Prog28, _Prog29 As Integer
    Private _Prog30, _Prog31, _Prog32, _Prog33, _Prog34, _Prog35, _Prog36, _Prog37, _Prog38, _Prog39 As Integer
    Private _Prog40, _Prog41, _Prog42, _Prog43, _Prog44, _Prog45, _Prog46, _Prog47, _Prog48, _Prog49 As Integer
    Private _Prog50, _Prog51, _Prog52, _Prog53, _Prog54, _Prog55, _Prog56, _Prog57, _Prog58, _Prog59 As Integer
    Private _Prog60, _Prog61, _Prog62, _Prog63, _Prog64, _Prog65, _Prog66, _Prog67, _Prog68, _Prog69 As Integer
    Private _Prog70, _Prog71, _Prog72, _Prog73, _Prog74, _Prog75, _Prog76, _Prog77, _Prog78, _Prog79 As Integer
    Private _Prog80 As Integer
    '*** Bahnhofsgleise auf denen die Züge stehen definieren
    Private _GlsL10, _GlsL11, _GlsL12, _GlsL13, _GlsL14, _GlsL15, _GlsL16, _GlsL17, _GlsL18, _GlsL19 As Integer
    Private _GlsL20, _GlsL21, _GlsL22, _GlsL23, _GlsL24, _GlsL25, _GlsL26, _GlsL27, _GlsL28, _GlsL29 As Integer
    Private _GlsL30, _GlsL31, _GlsL32, _GlsL33, _GlsL34, _GlsL35, _GlsL36, _GlsL37, _GlsL38, _GlsL39 As Integer
    Private _GlsL40, _GlsL41, _GlsL42, _GlsL43, _GlsL44, _GlsL45, _GlsL46, _GlsL47, _GlsL48, _GlsL49 As Integer
    Private _GlsL50, _GlsL51, _GlsL52, _GlsL53, _GlsL54, _GlsL55, _GlsL56, _GlsL57, _GlsL58, _GlsL59 As Integer
    Private _GlsL60, _GlsL61, _GlsL62, _GlsL63, _GlsL64, _GlsL65, _GlsL66, _GlsL67, _GlsL68, _GlsL69 As Integer
    Private _GlsL70, _GlsL71, _GlsL72, _GlsL73, _GlsL74, _GlsL75, _GlsL76, _GlsL77, _GlsL78, _GlsL79 As Integer
    Private _GlsL80 As Integer
    '*** Zugtyp definieren
    Private _TypL10, _TypL11, _TypL12, _TypL13, _TypL14, _TypL15, _TypL16, _TypL17, _TypL18, _TypL19 As Integer
    Private _TypL20, _TypL21, _TypL22, _TypL23, _TypL24, _TypL25, _TypL26, _TypL27, _TypL28, _TypL29 As Integer
    Private _TypL30, _TypL31, _TypL32, _TypL33, _TypL34, _TypL35, _TypL36, _TypL37, _TypL38, _TypL39 As Integer
    Private _TypL40, _TypL41, _TypL42, _TypL43, _TypL44, _TypL45, _TypL46, _TypL47, _TypL48, _TypL49 As Integer
    Private _TypL50, _TypL51, _TypL52, _TypL53, _TypL54, _TypL55, _TypL56, _TypL57, _TypL58, _TypL59 As Integer
    Private _TypL60, _TypL61, _TypL62, _TypL63, _TypL64, _TypL65, _TypL66, _TypL67, _TypL68, _TypL69 As Integer
    Private _TypL70, _TypL71, _TypL72, _TypL73, _TypL74, _TypL75, _TypL76, _TypL77, _TypL78, _TypL79 As Integer
    Private _TypL80 As Integer
    '*** Weichen- und Signalsteuerung
    Private Weiche13schalten, Weiche14schalten, Weiche15schalten, Weiche16schalten, Weiche17schalten, Weiche18schalten As Boolean
    Private Weiche19schalten, Weiche20schalten, Weiche21schalten, Weiche22schalten, Weiche23schalten, Weiche24schalten As Boolean
    Private Weiche25schalten, Weiche26schalten, Weiche27schalten As Boolean
    Private Signal9schalten, Signal10schalten, Signal11schalten, Signal12schalten As Boolean
    '*** Clips
    Private Film, Pfad As String
    '*** Hilfsariablen definieren
    Private _Prog28H As Integer
    Private _Zugtyp1, _Zugtyp2, _Zugtyp3, _Zugtyp4 As Integer
    Private Forbach, Marxzel, Windeck As Integer

    Private L1_aktuell, L2_aktuell, L3_aktuell, L4_aktuell, L5_aktuell, L6_aktuell, L7_aktuell, L1_soll, L2_soll, L3_soll, L4_soll, L5_soll, L6_soll, L7_soll, S_DMX, Szene, DMX_Pointer, DMX_Klick As Integer

    Private Bri_aktuell, Sat_aktuell, Col_aktuell, CT_aktuell, CT_M, Bri_soll, Bri_M, Sat_soll, Col_soll, CT_soll, Hue_Control, Hue_Control_aktuell, Hue_Control_M, Hue_Takt, Hue_Aenderung, Hue_Neue_Aenderung As Integer
    Private FilmFortschritt As Integer
    Private Fahrplan, Warte1A1, Warte1A2, Warte1SB, Warte1BA, Warte1TA, Warte1DI, Warte2A1, Warte2A2, Warte2SB, Warte2BA, Warte2TA, Warte2DI, Warte3A1, Warte3A2, Warte3SB, Warte3BA, Warte3TA, Warte3DI, Warte4A1, Warte4A2, Warte4SB, Warte4BA, Warte4TA, Warte4DI As Integer

    Private Property AutomatikParameter As Integer
        Get
            Return _AutomatikParameter
        End Get
        Set(value As Integer)
            If AutoParaLabel.IsHandleCreated And AutoParaLabel.InvokeRequired Then
                Me.Invoke(Sub() SetParaLabel(value))
            Else
                SetParaLabel(value)
            End If
            _AutomatikParameter = value
        End Set
    End Property

    Private Sub SetParaLabel(ByRef value As String)
        AutoParaLabel.Text = value
    End Sub

    Private Property AutomatikParameter1 As Integer
        Get
            Return _AutomatikParameter1
        End Get
        Set(value As Integer)
            SetAutoParaLabel1(value)
            _AutomatikParameter1 = value
        End Set
    End Property

    Private Sub SetAutoParaLabel1(ByVal value As String)
        If AutoParaLabel1.IsHandleCreated And AutoParaLabel1.InvokeRequired Then
            Me.Invoke(Sub() SetAutoParaLabel1(value))
        Else
            AutoParaLabel1.Text = value
        End If
    End Sub

    Private Sub SetProgramCounterLabel(ByVal value As String)
        If ProgramCounterLabel.IsHandleCreated And ProgramCounterLabel.InvokeRequired Then
            Me.Invoke(Sub() SetProgramCounterLabel(value))
        Else
            ProgramCounterLabel.Text = value
        End If
    End Sub

    Private Sub SetProgramCounterLabel1(ByVal value As String)
        If ProgramCounterLabel1.IsHandleCreated And ProgramCounterLabel1.InvokeRequired Then
            Me.Invoke(Sub() SetProgramCounterLabel1(value))
        Else
            ProgramCounterLabel1.Text = value
        End If
    End Sub

    Private Property Betriebsart As Integer
        Get
            Return _Betriebsart
        End Get
        Set(value As Integer)
            _Betriebsart = value

            Dim text As String = "Betriebsart "
            If _Betriebsart = 0 Then
                text = "Automatik ausgeschaltet"
            ElseIf _Betriebsart = 1 Then
                text = "Züge fahren auf Innenkreis und Außenkreis unabhängig"
            ElseIf _Betriebsart = 2 Then
                text = "Alle Züge fahren koordiniert"
            ElseIf _Betriebsart = 3 Then
                text = "Das kalte Herz"
            End If
            Button10.Text = text
            _daten.write_to_table(AutomatikParameterTableName, 0, _Betriebsart)
        End Set
    End Property

    Private Property Betriebsart12 As Integer
        Get
            Return _Betriebsart12
        End Get
        Set(value As Integer)
            _Betriebsart12 = value
            Dim text As String = "Betriebsart12 "
            If _Betriebsart12 = 0 Then
                text = "aus"
            ElseIf _Betriebsart12 = 1 Then
                text = "Gleis 1"
            ElseIf _Betriebsart12 = 2 Then
                text = "Gleis 2"
            ElseIf _Betriebsart12 = 3 Then
                text = "beide"
            End If
            Button11.Text = text
            If Not _daten Is Nothing Then
                _daten.write_to_table(AutomatikParameterTableName, 1, _Betriebsart12)
            End If
        End Set
    End Property

    Private Property Betriebsart34 As Integer
        Get
            Return _Betriebsart34
        End Get
        Set(value As Integer)
            _Betriebsart34 = value
            Dim text As String = "Betriebsart34 "
            If _Betriebsart34 = 0 Then
                text = "aus"
            ElseIf _Betriebsart34 = 3 Then
                text = "Gleis 3"
            ElseIf _Betriebsart34 = 4 Then
                text = "Gleis 4"
            ElseIf _Betriebsart34 = 5 Then
                text = "beide"
            End If
            Button12.Text = text
            If Not _daten Is Nothing Then
                _daten.write_to_table(AutomatikParameterTableName, 2, _Betriebsart34)
            End If
        End Set
    End Property

    Private WithEvents Timer_1, Timer_2, Timer_3, Timer_4, Timer_5, Timer_6, Timer_7, Timer_8, Timer_9, Timer_10, Timer_11, Timer_12 As Timers.Timer  ' *** , Timer_Event_ein, Timer_Event_aus
    Private WithEvents Timer_EinzelLok1, Timer_EinzelLok2, Timer_EinzelLok3, Timer_EinzelLok4, Timer_Music As Timers.Timer
    Private WithEvents Timer_Story_Auto, Timer_Kamera0, Timer_Kamera1, Timer_Kamera2, Timer_DMX, Timer_HUE, Delay_Automatik_110, Delay_Automatik_210 As Timers.Timer
    'Private WithEvents Timer_Story1, Timer_Story_DMX, Timer_Story3, Timer_Story4, Timer_Story5, Timer_Story6, Timer_Story7, Timer_Story8, Timer_Story_Film, Timer_Story_Auto, Timer_Kamera0, Timer_Kamera1, Timer_Kamera2, Timer_DMX, Timer_HUE As Timers.Timer
    '*** Fahrprogramm für Züge erstellen FPZ Timer_Story_DMX, Timer_Story_Film,
    '*** Timer definieren (Programme)
    Private WithEvents Prog_Lok10, Prog_Lok11, Prog_Lok12, Prog_Lok13, Prog_Lok14, Prog_Lok15, Prog_Lok16, Prog_Lok17, Prog_Lok18, Prog_Lok19 As Timers.Timer
    Private WithEvents Prog_Lok20, Prog_Lok21, Prog_Lok22, Prog_Lok23, Prog_Lok24, Prog_Lok25, Prog_Lok26, Prog_Lok27, Prog_Lok28, Prog_Lok29 As Timers.Timer
    Private WithEvents Prog_Lok30, Prog_Lok31, Prog_Lok32, Prog_Lok33, Prog_Lok34, Prog_Lok35, Prog_Lok36, Prog_Lok37, Prog_Lok38, Prog_Lok39 As Timers.Timer
    Private WithEvents Prog_Lok40, Prog_Lok41, Prog_Lok42, Prog_Lok43, Prog_Lok44, Prog_Lok45, Prog_Lok46, Prog_Lok47, Prog_Lok48, Prog_Lok49 As Timers.Timer
    Private WithEvents Prog_Lok50, Prog_Lok51, Prog_Lok52, Prog_Lok53, Prog_Lok54, Prog_Lok55, Prog_Lok56, Prog_Lok57, Prog_Lok58, Prog_Lok59 As Timers.Timer
    Private WithEvents Prog_Lok60, Prog_Lok61, Prog_Lok62, Prog_Lok63, Prog_Lok64, Prog_Lok65, Prog_Lok66, Prog_Lok67, Prog_Lok68, Prog_Lok69 As Timers.Timer
    Private WithEvents Prog_Lok70, Prog_Lok71, Prog_Lok72, Prog_Lok73, Prog_Lok74, Prog_Lok75, Prog_Lok76, Prog_Lok77, Prog_Lok78, Prog_Lok79 As Timers.Timer
    Private WithEvents Prog_Lok80 As Timers.Timer

    ' *** Initialisierung
    Public Sub New(ByRef eb As Communication.KernelInterface,
                   ByRef daten As Daten.DatenInterface,
                   ByRef dmxServer As DMXServer.IDMXServer,
                   ByRef webcams As Webcams.IWebcamController,
                   ByRef mediaProvider As MediaProvider.IMediaProvider,
                   ByRef betriebsparameter As Betriebsparameter)
        InitializeComponent()

        _eb = eb
        _daten = daten
        _dmxServer = dmxServer
        _eb.registriereFuerKontaktEvents(Me)
        _eb.registriereFuerWeichenEvents(Me)
        _HueBridge = Hue.HueBridgeLocator.Locate()
        _HueLight = _HueBridge.GetLight(HueLightName)
        _Webcams = webcams
        _mediaProvider = mediaProvider
        _Betriebsparameter = betriebsparameter

        ' Sync Fahrparameter vom Excel
        'For i As Integer = 1 To 80
        '    For Each q As Betriebsparameter.FahrparameterEnum In [Enum].GetValues(GetType(Betriebsparameter.FahrparameterEnum))
        '        _Betriebsparameter.SetFahrparameter(i, q, Me.Betriebsparameter.GetValue("Fahrparameter", q + 4, i + 4))
        '    Next
        'Next
        '_Betriebsparameter.Save()

        Pfad = "H:\EB_Media\Clips\"
        Dim test As Integer = _Betriebsparameter.Fahrparameter(20, Betriebsparameter.FahrparameterEnum.V_100)
        FilmFortschritt = 0

        ' *** 3 (Auto) - 0 (Marxzel) - 1 (Forbach) - 2 (Windeck)

        Forbach = 2
        Marxzel = 1
        Windeck = 0


        AutomatikParameter = 0
        AutomatikParameter1 = 0
        _AutomatikParameterH = 0
        _Weichen_in_Startposition = False
        _Weichen_initialisiert = False
        _Signale_in_Startposition = False
        _Signale_initialisiert = False

        Betriebsart = _daten.read_from_table(AutomatikParameterTableName, 0)
        Betriebsart12 = _daten.read_from_table(AutomatikParameterTableName, 1)
        Betriebsart34 = _daten.read_from_table(AutomatikParameterTableName, 2)
        _Route_Gleis1 = _daten.read_from_table(AutomatikParameterTableName, 3)
        _Route_Gleis2 = _daten.read_from_table(AutomatikParameterTableName, 4)
        _Route_Gleis3 = _daten.read_from_table(AutomatikParameterTableName, 5)
        _Route_Gleis4 = _daten.read_from_table(AutomatikParameterTableName, 6)
        _Bhf_Gleis1 = _daten.read_from_table(AutomatikParameterTableName, 7)
        _Bhf_Gleis2 = _daten.read_from_table(AutomatikParameterTableName, 8)
        _Bhf_Gleis3 = _daten.read_from_table(AutomatikParameterTableName, 9)
        _Bhf_Gleis4 = _daten.read_from_table(AutomatikParameterTableName, 10)

        ' *** 11 Reserve, nicht mehr verwendet
        ' *** 12 Reserve, nicht mehr verwendet
        ' *** 13 Reserve, nicht mehr verwendet
        ' *** 14 Reserve, nicht mehr verwendet

        _Motor = _daten.read_from_table(AutomatikParameterTableName, 15)
        _Fahrzeugbeleuchtung2 = _daten.read_from_table(AutomatikParameterTableName, 16)
        _Dampf = _daten.read_from_table(AutomatikParameterTableName, 17)
        _Innenbeleuchtung2 = _daten.read_from_table(AutomatikParameterTableName, 18)
        _AkustischeSignale = _daten.read_from_table(AutomatikParameterTableName, 19)
        _Durchsagen = _daten.read_from_table(AutomatikParameterTableName, 20)
        _Fernlicht = _daten.read_from_table(AutomatikParameterTableName, 21)

        _SBhf_Gleis1 = _daten.read_from_table(AutomatikParameterTableName, 22)
        _SBhf_Gleis2 = _daten.read_from_table(AutomatikParameterTableName, 23)
        _SBhf_Gleis3 = _daten.read_from_table(AutomatikParameterTableName, 24)
        _SBhf_Gleis4 = _daten.read_from_table(AutomatikParameterTableName, 25)

        _Berg_Gleis1 = _daten.read_from_table(AutomatikParameterTableName, 26)
        _Berg_Gleis2 = _daten.read_from_table(AutomatikParameterTableName, 27)
        _Berg_Gleis3 = _daten.read_from_table(AutomatikParameterTableName, 28)
        _Berg_Gleis4 = _daten.read_from_table(AutomatikParameterTableName, 29)

        _Bhf2_Gleis1 = _daten.read_from_table(AutomatikParameterTableName, 30)
        _Bhf2_Gleis2 = _daten.read_from_table(AutomatikParameterTableName, 31)
        _Bhf2_Gleis3 = _daten.read_from_table(AutomatikParameterTableName, 32)
        _Bhf2_Gleis4 = _daten.read_from_table(AutomatikParameterTableName, 33)

        _Kamera = _daten.read_from_table(AutomatikParameterTableName, 34)

        Diagonale_Gleis1 = _daten.read_from_table(AutomatikParameterTableName, 35)
        Diagonale_Gleis2 = _daten.read_from_table(AutomatikParameterTableName, 36)
        Diagonale_Gleis3 = _daten.read_from_table(AutomatikParameterTableName, 37)
        Diagonale_Gleis4 = _daten.read_from_table(AutomatikParameterTableName, 38)

        Talstrecke_Gleis1 = _daten.read_from_table(AutomatikParameterTableName, 39)
        Talstrecke_Gleis2 = _daten.read_from_table(AutomatikParameterTableName, 40)
        Talstrecke_Gleis3 = _daten.read_from_table(AutomatikParameterTableName, 41)
        Talstrecke_Gleis4 = _daten.read_from_table(AutomatikParameterTableName, 42)
        Startzug = _daten.read_from_table(AutomatikParameterTableName, 43)
        _Beleuchtung = _daten.read_from_table(AutomatikParameterTableName, 44)
        _Funktionsmodelle = _daten.read_from_table(AutomatikParameterTableName, 45)
        _Zugtyp1 = _daten.read_from_table(AutomatikParameterTableName, 46)
        _Zugtyp2 = _daten.read_from_table(AutomatikParameterTableName, 47)
        _Zugtyp3 = _daten.read_from_table(AutomatikParameterTableName, 48)
        _Zugtyp4 = _daten.read_from_table(AutomatikParameterTableName, 49)
        _Hue = _daten.read_from_table(AutomatikParameterTableName, 50)

        'FilmZeile = _daten.read_from_table(AutomatikParameterTableName, 51)

        ComboBox1.SelectedIndex = _daten.read_from_table(AutomatikParameterTableName, 52)
        Hue_Control = _daten.read_from_table(AutomatikParameterTableName, 53)

        _Betriebsart0_3Var = _daten.read_from_table(AutomatikParameterTableName, 54)
        _Betriebsart0_4Var = _daten.read_from_table(AutomatikParameterTableName, 55)
        _Betriebsart0_5Var = _daten.read_from_table(AutomatikParameterTableName, 56)
        _Betriebsart1_0Var = _daten.read_from_table(AutomatikParameterTableName, 57)
        _Betriebsart1_3Var = _daten.read_from_table(AutomatikParameterTableName, 58)
        _Betriebsart1_4Var = _daten.read_from_table(AutomatikParameterTableName, 59)
        _Betriebsart1_5Var = _daten.read_from_table(AutomatikParameterTableName, 60)
        _Betriebsart2_0Var = _daten.read_from_table(AutomatikParameterTableName, 61)
        _Betriebsart2_3Var = _daten.read_from_table(AutomatikParameterTableName, 62)
        _Betriebsart2_4Var = _daten.read_from_table(AutomatikParameterTableName, 63)
        _Betriebsart2_5Var = _daten.read_from_table(AutomatikParameterTableName, 64)
        _Betriebsart3_0Var = _daten.read_from_table(AutomatikParameterTableName, 65)
        _Betriebsart3_3Var = _daten.read_from_table(AutomatikParameterTableName, 66)
        _Betriebsart3_4Var = _daten.read_from_table(AutomatikParameterTableName, 67)
        _Betriebsart3_5Var = _daten.read_from_table(AutomatikParameterTableName, 68)

        _Loknummer_4A = _daten.read_from_table(AutomatikParameterTableName, 69)
        If _Loknummer_4A = 0 Then
            _Loknummer_4A = 10
        End If
        _Loknummer_4B = _daten.read_from_table(AutomatikParameterTableName, 70)
        If _Loknummer_4B = 0 Then
            _Loknummer_4B = 10
        End If

        Button19.Text = "V0"    ' Gleis1/Gleis2
        Button38.Text = "V0"    ' Gleis3/Gleis4
        Button30.Text = "V0"    ' Gleis3
        Button35.Text = "V0"    ' Gleis4
        Button40.Text = "V0"    ' Gleis1
        Button44.Text = "V0"    ' Gleis2

        If _Betriebsart1_0Var = 1 Then
            Button40.Text = "V1"
        End If
        If _Betriebsart2_0Var = 1 Then
            Button44.Text = "V1"
        End If
        If _Betriebsart0_3Var = 1 Then
            Button30.Text = "V1"
        End If
        If _Betriebsart0_4Var = 1 Then
            Button35.Text = "V1"
        End If
        If _Betriebsart0_4Var = 2 Then
            Button35.Text = "V2"
        End If
        If _Betriebsart3_0Var = 1 Then
            Button19.Text = "V1"
        End If
        If _Betriebsart3_0Var = 2 Then
            Button19.Text = "V2"
        End If
        If _Betriebsart0_5Var = 1 Then
            Button38.Text = "V1"
        End If

        ARoute_Lok1 = _Route_Gleis1
        ARoute_Lok2 = _Route_Gleis2
        ARoute_Lok3 = _Route_Gleis3
        ARoute_Lok4 = _Route_Gleis4

        anfahren = 0
        abstellen = 50
        bremsen = 100
        bremsen_kurz_von_links = 130
        bremsen_kurz_von_rechts = 160
        bergfahrt = 200
        nachlauf = 180

        _StopZug1 = 0
        _StopZug2 = 0
        _StopZug3 = 0
        _StopZug4 = 0

        'If _eb.weiche(1).Richtung = Klassen.WeichenRichtung.rechts Then
        'End If

        ' *** Erster Integer=Display, zweiter Integer= Kamera

        If _Kamera = 0 Then
            _Webcams.SetWebcam(0, Marxzel)
            _aktuelleKamera = Marxzel
            Button13.Text = "Wiehre"
            Button13.BackColor = Drawing.Color.LightGray
        ElseIf _Kamera = 1 Then
            _Webcams.SetWebcam(0, Forbach)
            _aktuelleKamera = Forbach
            Button13.Text = "Hinterzarten"
            Button13.BackColor = Drawing.Color.LightGray
        ElseIf _Kamera = 2 Then
            _Webcams.SetWebcam(0, Windeck)
            _aktuelleKamera = Windeck
            Button13.Text = "Titisee"
            Button13.BackColor = Drawing.Color.LightGray
        ElseIf _Kamera = 3 Then
            _Webcams.SetWebcam(0, Forbach)
            _aktuelleKamera = Forbach
            Button13.Text = "Kamera - Automatik"
            Button13.BackColor = Drawing.Color.LightYellow
        End If
        If _Funktionsmodelle = 0 Then
            Button14.Text = "Funk.-Modelle aus"
            Button14.BackColor = Drawing.Color.LightGray
            '_eb.weicheSchalten(30, Klassen.WeichenRichtung.rechts)
            '_eb.weicheSchalten(34, Klassen.WeichenRichtung.rechts)
            '_eb.weicheSchalten(40, Klassen.WeichenRichtung.rechts)
        ElseIf _Funktionsmodelle = 1 Then
            Button14.Text = "Funk.-Modelle ein"
            Button14.BackColor = Drawing.Color.LightGreen
            '_eb.weicheSchalten(30, Klassen.WeichenRichtung.links)
            '_eb.weicheSchalten(34, Klassen.WeichenRichtung.links)
            '_eb.weicheSchalten(40, Klassen.WeichenRichtung.links)
        ElseIf _Funktionsmodelle = 2 Then
            Button14.Text = "Funk.-Modelle Auto"
            Button14.BackColor = Drawing.Color.LightYellow
            '_eb.weicheSchalten(30, Klassen.WeichenRichtung.rechts)
            '_eb.weicheSchalten(34, Klassen.WeichenRichtung.rechts)
            '_eb.weicheSchalten(40, Klassen.WeichenRichtung.rechts)
        End If


        If _Bhf_Gleis1 = 0 Then
            Button31.Text = "kein Halt"
            Button31.BackColor = Drawing.Color.LightGreen
        ElseIf _Bhf_Gleis1 = 1 Then
            Button31.Text = "Halt"
            Button31.BackColor = Drawing.Color.LightYellow
        ElseIf _Bhf_Gleis1 = 2 Then
            Button31.Text = "Wechsel > 2"
            Button31.BackColor = Drawing.Color.LightYellow
        ElseIf _Bhf_Gleis1 = 3 Then
            Button31.Text = "Wechsel > 3"
            Button31.BackColor = Drawing.Color.LightYellow
        ElseIf _Bhf_Gleis1 = 4 Then
            Button31.Text = "Wechsel > 4"
            Button31.BackColor = Drawing.Color.LightYellow
        End If

        If _Bhf_Gleis2 = 0 Then
            Button32.Text = "kein Halt"
            Button32.BackColor = Drawing.Color.LightGreen
        ElseIf _Bhf_Gleis2 = 2 Then
            Button32.Text = "Halt"
            Button32.BackColor = Drawing.Color.LightYellow
        ElseIf _Bhf_Gleis2 = 1 Then
            Button32.Text = "Wechsel > 1"
            Button32.BackColor = Drawing.Color.LightYellow
        ElseIf _Bhf_Gleis2 = 3 Then
            Button32.Text = "Wechsel > 3"
            Button32.BackColor = Drawing.Color.LightYellow
        ElseIf _Bhf_Gleis2 = 4 Then
            Button32.Text = "Wechsel > 4"
            Button32.BackColor = Drawing.Color.LightYellow
        End If

        If _Bhf_Gleis3 = 0 Then
            Button33.Text = "kein Halt"
            Button33.BackColor = Drawing.Color.LightGreen
        ElseIf _Bhf_Gleis3 = 1 Then
            Button33.Text = "Wechsel > 1"
            Button33.BackColor = Drawing.Color.LightYellow
        ElseIf _Bhf_Gleis3 = 2 Then
            Button33.Text = "Wechsel > 2"
            Button33.BackColor = Drawing.Color.LightYellow
        ElseIf _Bhf_Gleis3 = 3 Then
            Button33.Text = "Halt"
            Button33.BackColor = Drawing.Color.LightYellow
        ElseIf _Bhf_Gleis3 = 4 Then
            Button33.Text = "Wechsel > 4"
            Button33.BackColor = Drawing.Color.LightYellow
        End If

        If _Bhf_Gleis4 = 0 Then
            Button34.Text = "kein Halt"
            Button34.BackColor = Drawing.Color.LightGreen
        ElseIf _Bhf_Gleis4 = 1 Then
            Button34.Text = "Wechsel > 1"
            Button34.BackColor = Drawing.Color.LightYellow
        ElseIf _Bhf_Gleis4 = 2 Then
            Button34.Text = "Wechsel > 2"
            Button34.BackColor = Drawing.Color.LightYellow
        ElseIf _Bhf_Gleis4 = 3 Then
            Button34.Text = "Wechsel > 3"
            Button34.BackColor = Drawing.Color.LightYellow
        ElseIf _Bhf_Gleis4 = 4 Then
            Button34.Text = "Halt"
            Button34.BackColor = Drawing.Color.LightYellow
        End If

        If _SBhf_Gleis1 = 0 Then
            Button51.Text = "kein Halt"
            Button51.BackColor = Drawing.Color.LightGreen
        ElseIf _SBhf_Gleis1 = 1 Then
            Button51.Text = "Halt"
            Button51.BackColor = Drawing.Color.LightYellow
        ElseIf _SBhf_Gleis1 = 2 Then
            Button51.Text = "Wechsel > 2"
            Button51.BackColor = Drawing.Color.LightYellow
        ElseIf _SBhf_Gleis1 = 3 Then
            Button51.Text = "Wechsel > 3"
            Button51.BackColor = Drawing.Color.LightYellow
        ElseIf _SBhf_Gleis1 = 4 Then
            Button51.Text = "Wechsel > 4"
            Button51.BackColor = Drawing.Color.LightYellow
        End If

        If _SBhf_Gleis2 = 0 Then
            Button52.Text = "kein Halt"
            Button52.BackColor = Drawing.Color.LightGreen
        ElseIf _SBhf_Gleis2 = 2 Then
            Button52.Text = "Halt"
            Button52.BackColor = Drawing.Color.LightYellow
        ElseIf _SBhf_Gleis2 = 1 Then
            Button52.Text = "Wechsel > 1"
            Button52.BackColor = Drawing.Color.LightYellow
        ElseIf _SBhf_Gleis2 = 3 Then
            Button52.Text = "Wechsel > 3"
            Button52.BackColor = Drawing.Color.LightYellow
        ElseIf _SBhf_Gleis2 = 4 Then
            Button52.Text = "Wechsel > 4"
            Button52.BackColor = Drawing.Color.LightYellow
        End If

        If _SBhf_Gleis3 = 0 Then
            Button53.Text = "kein Halt"
            Button53.BackColor = Drawing.Color.LightGreen
        ElseIf _SBhf_Gleis3 = 3 Then
            Button53.Text = "Halt"
            Button53.BackColor = Drawing.Color.LightYellow
        ElseIf _SBhf_Gleis3 = 1 Then
            Button53.Text = "Wechsel > 1"
            Button53.BackColor = Drawing.Color.LightYellow
        ElseIf _SBhf_Gleis3 = 2 Then
            Button53.Text = "Wechsel > 2"
            Button53.BackColor = Drawing.Color.LightYellow
        ElseIf _SBhf_Gleis3 = 4 Then
            Button53.Text = "Wechsel > 4"
            Button53.BackColor = Drawing.Color.LightYellow
        End If

        If _SBhf_Gleis4 = 0 Then
            Button54.Text = "kein Halt"
            Button54.BackColor = Drawing.Color.LightGreen
        ElseIf _SBhf_Gleis4 = 4 Then
            Button54.Text = "Halt"
            Button54.BackColor = Drawing.Color.LightYellow
        ElseIf _SBhf_Gleis4 = 1 Then
            Button54.Text = "Wechsel > 1"
            Button54.BackColor = Drawing.Color.LightYellow
        ElseIf _SBhf_Gleis4 = 2 Then
            Button54.Text = "Wechsel > 2"
            Button54.BackColor = Drawing.Color.LightYellow
        ElseIf _SBhf_Gleis4 = 3 Then
            Button54.Text = "Wechsel > 3"
            Button54.BackColor = Drawing.Color.LightYellow
        End If

        If _Berg_Gleis1 = 0 Then
            Button61.Text = "kein Halt"
            Button61.BackColor = Drawing.Color.LightGreen
        ElseIf _Berg_Gleis1 = 1 Then
            Button61.Text = "Zindelstein"
            Button61.BackColor = Drawing.Color.LightYellow
        ElseIf _Berg_Gleis1 = 2 Then
            Button61.Text = "Bärental"
            Button61.BackColor = Drawing.Color.LightYellow
        Else
            _Berg_Gleis1 = 0
        End If

        If _Berg_Gleis2 = 0 Then
            Button62.Text = "kein Halt"
            Button62.BackColor = Drawing.Color.LightGreen
        ElseIf _Berg_Gleis2 = 1 Then
            Button62.Text = "Zindelstein"
            Button62.BackColor = Drawing.Color.LightYellow
        ElseIf _Berg_Gleis2 = 2 Then
            Button62.Text = "Bärental"
            Button62.BackColor = Drawing.Color.LightYellow
        Else
            _Berg_Gleis2 = 0
        End If

        If _Berg_Gleis3 = 0 Then
            Button63.Text = "kein Halt"
            Button63.BackColor = Drawing.Color.LightGreen
        ElseIf _Berg_Gleis3 = 1 Then
            Button63.Text = "Zindelstein"
            Button63.BackColor = Drawing.Color.LightYellow
        ElseIf _Berg_Gleis3 = 2 Then
            Button63.Text = "Bärental"
            Button63.BackColor = Drawing.Color.LightYellow
        Else
            _Berg_Gleis3 = 0
        End If

        If _Berg_Gleis4 = 0 Then
            Button64.Text = "kein Halt"
            Button64.BackColor = Drawing.Color.LightGreen
        ElseIf _Berg_Gleis4 = 1 Then
            Button64.Text = "Zindelstein"
            Button64.BackColor = Drawing.Color.LightYellow
        ElseIf _Berg_Gleis4 = 2 Then
            Button64.Text = "Bärental"
            Button64.BackColor = Drawing.Color.LightYellow
        Else
            _Berg_Gleis4 = 0
        End If

        If _Bhf2_Gleis1 = 0 Then
            Button71.Text = "kein Halt"
            Button71.BackColor = Drawing.Color.LightGreen
        ElseIf _Bhf2_Gleis1 = 1 Then
            Button71.Text = "Halt"
            Button71.BackColor = Drawing.Color.LightYellow
        ElseIf _Bhf2_Gleis1 = 2 Then
            Button71.Text = "Wechsel > 2"
            Button71.BackColor = Drawing.Color.LightYellow
        ElseIf _Bhf2_Gleis1 = 3 Then
            Button71.Text = "Wechsel > 3"
            Button71.BackColor = Drawing.Color.LightYellow
        ElseIf _Bhf2_Gleis1 = 4 Then
            Button71.Text = "Wechsel > 4"
            Button71.BackColor = Drawing.Color.LightYellow
        End If

        If _Bhf2_Gleis2 = 0 Then
            Button72.Text = "kein Halt"
            Button72.BackColor = Drawing.Color.LightGreen
        ElseIf _Bhf2_Gleis2 = 2 Then
            Button72.Text = "Halt"
            Button72.BackColor = Drawing.Color.LightYellow
        ElseIf _Bhf2_Gleis2 = 1 Then
            Button72.Text = "Wechsel > 1"
            Button72.BackColor = Drawing.Color.LightYellow
        ElseIf _Bhf2_Gleis2 = 3 Then
            Button72.Text = "Wechsel > 3"
            Button72.BackColor = Drawing.Color.LightYellow
        ElseIf _Bhf2_Gleis2 = 4 Then
            Button72.Text = "Wechsel > 4"
            Button72.BackColor = Drawing.Color.LightYellow
        End If

        If _Bhf2_Gleis3 = 0 Then
            Button73.Text = "kein Halt"
            Button73.BackColor = Drawing.Color.LightGreen
        ElseIf _Bhf2_Gleis3 = 1 Then
            Button73.Text = "Wechsel > 1"
            Button73.BackColor = Drawing.Color.LightYellow
        ElseIf _Bhf2_Gleis3 = 2 Then
            Button73.Text = "Wechsel > 2"
            Button73.BackColor = Drawing.Color.LightYellow
        ElseIf _Bhf2_Gleis3 = 3 Then
            Button73.Text = "Halt"
            Button73.BackColor = Drawing.Color.LightYellow
        ElseIf _Bhf2_Gleis3 = 4 Then
            Button73.Text = "Wechsel > 4"
            Button73.BackColor = Drawing.Color.LightYellow
        End If

        If _Bhf2_Gleis4 = 0 Then
            Button74.Text = "kein Halt"
            Button74.BackColor = Drawing.Color.LightGreen
        ElseIf _Bhf2_Gleis4 = 1 Then
            Button74.Text = "Wechsel > 1"
            Button74.BackColor = Drawing.Color.LightYellow
        ElseIf _Bhf2_Gleis4 = 2 Then
            Button74.Text = "Wechsel > 2"
            Button74.BackColor = Drawing.Color.LightYellow
        ElseIf _Bhf2_Gleis4 = 3 Then
            Button74.Text = "Wechsel > 3"
            Button74.BackColor = Drawing.Color.LightYellow
        ElseIf _Bhf2_Gleis4 = 4 Then
            Button74.Text = "Halt"
            Button74.BackColor = Drawing.Color.LightYellow
        End If

        If Diagonale_Gleis1 = 0 Then
            Button81.BackColor = Drawing.Color.LightGreen
            Button81.Text = "kein Halt"
        ElseIf Diagonale_Gleis1 = 1 Then
            Button81.Text = "Halt"
            Button81.BackColor = Drawing.Color.LightYellow
        ElseIf Diagonale_Gleis1 = 2 Then
            Button81.Text = "Wechsel -> 2"
            Button81.BackColor = Drawing.Color.LightYellow
        End If
        If Diagonale_Gleis2 = 0 Then
            Button82.BackColor = Drawing.Color.LightGreen
            Button82.Text = "kein Halt"
        ElseIf Diagonale_Gleis2 = 1 Then
            Button82.Text = "Wechsel -> 1"
            Button82.BackColor = Drawing.Color.LightYellow
        ElseIf Diagonale_Gleis2 = 2 Then
            Button82.Text = "Halt"
            Button82.BackColor = Drawing.Color.LightYellow
        End If
        If Diagonale_Gleis3 = 0 Then
            Button83.BackColor = Drawing.Color.LightGreen
            Button83.Text = "kein Halt"
        ElseIf Diagonale_Gleis3 = 3 Then
            Button83.Text = "Halt"
            Button83.BackColor = Drawing.Color.LightYellow
        End If
        If Diagonale_Gleis4 = 0 Then
            Button84.BackColor = Drawing.Color.LightGreen
            Button84.Text = "kein Halt"
        ElseIf Diagonale_Gleis4 = 4 Then
            Button84.Text = "Halt"
            Button84.BackColor = Drawing.Color.LightYellow
        End If
        If Talstrecke_Gleis1 = 0 Then
            Button91.BackColor = Drawing.Color.LightGreen
            Button91.Text = "kein Halt"
        ElseIf Talstrecke_Gleis1 = 1 Then
            Button91.Text = "Halt"
            Button91.BackColor = Drawing.Color.LightYellow
        End If
        If Talstrecke_Gleis2 = 0 Then
            Button92.BackColor = Drawing.Color.LightGreen
            Button92.Text = "kein Halt"
        ElseIf Talstrecke_Gleis2 = 2 Then
            Button92.Text = "Halt"
            Button92.BackColor = Drawing.Color.LightYellow
        End If
        If Talstrecke_Gleis3 = 0 Then
            Button93.BackColor = Drawing.Color.LightGreen
            Button93.Text = "kein Halt"
        ElseIf Talstrecke_Gleis3 = 3 Then
            Button93.Text = "Halt"
            Button93.BackColor = Drawing.Color.LightYellow
        End If
        If Talstrecke_Gleis4 = 0 Then
            Button94.BackColor = Drawing.Color.LightGreen
            Button94.Text = "kein Halt"
        ElseIf Talstrecke_Gleis4 = 4 Then
            Button94.Text = "Halt"
            Button94.BackColor = Drawing.Color.LightYellow
        End If

        _GleisFrei1 = 0
        _GleisFrei2 = 0
        _GleisFrei3 = 0
        _GleisFrei4 = 0
        Button15.Text = "belegt / nicht benutzt"
        Button15.BackColor = Drawing.Color.LightYellow
        Button16.Text = "belegt / nicht benutzt"
        Button16.BackColor = Drawing.Color.LightYellow
        Button17.Text = "belegt / nicht benutzt"
        Button17.BackColor = Drawing.Color.LightYellow
        Button18.Text = "belegt / nicht benutzt"
        Button18.BackColor = Drawing.Color.LightYellow

        Routen(Button21, _Route_Gleis1)
        Routen(Button22, _Route_Gleis2)
        Routen(Button23, _Route_Gleis3)
        Routen(Button24, _Route_Gleis4)

        If Betriebsart = 0 Or Betriebsart = 1 Or Betriebsart = 2 Or Betriebsart = 3 Then
            If _Beleuchtung = 0 Then
                _dmxServer.SetData(1, 0)
                _dmxServer.SetData(2, 0)
                _dmxServer.SetData(3, 0)
                _dmxServer.SetData(4, 0)
                _dmxServer.SetData(6, 0)
                _dmxServer.SetData(7, 0)
                _dmxServer.SetData(8, 0)
                L1_aktuell = 0
                L2_aktuell = 0
                L3_aktuell = 0
                L4_aktuell = 0
                L5_aktuell = 0
                L6_aktuell = 0
                L7_aktuell = 0
                'Button1.Text = "DMX"
                'Button1.BackColor = Drawing.Color.LightGray
                'Button36.BackColor = Drawing.Color.LightYellow
                'Button37.BackColor = Drawing.Color.LightGray
            ElseIf _Beleuchtung = 1 Then
                _dmxServer.SetData(1, 200)
                _dmxServer.SetData(2, 200)
                _dmxServer.SetData(3, 200)
                _dmxServer.SetData(4, 200)
                _dmxServer.SetData(6, 200)
                _dmxServer.SetData(7, 200)
                _dmxServer.SetData(8, 200)
                L1_aktuell = 200
                L2_aktuell = 200
                L3_aktuell = 200
                L4_aktuell = 200
                L5_aktuell = 200
                L6_aktuell = 200
                L7_aktuell = 200
                'Button1.Text = "DMX"
                'Button1.BackColor = Drawing.Color.LightGray
                'Button36.BackColor = Drawing.Color.LightGray
                'Button37.BackColor = Drawing.Color.LightYellow
            Else
                _dmxServer.SetData(1, 64)
                _dmxServer.SetData(2, 64)
                _dmxServer.SetData(3, 100)
                _dmxServer.SetData(4, 128)
                _dmxServer.SetData(6, 100)
                _dmxServer.SetData(7, 64)
                _dmxServer.SetData(8, 64)
                L1_aktuell = 64
                L2_aktuell = 64
                L3_aktuell = 100
                L4_aktuell = 128
                L5_aktuell = 100
                L6_aktuell = 64
                L7_aktuell = 64
                'Button1.Text = "mittig"
                'Button1.BackColor = Drawing.Color.LightYellow
                'Button36.BackColor = Drawing.Color.LightGray
                'Button37.BackColor = Drawing.Color.LightGray
                _Beleuchtung = 2
                _daten.write_to_table(AutomatikParameterTableName, 44, _Beleuchtung)
            End If
        Else
            Betriebsart = 0
        End If

        If _Hue >= 3 Then
            _Hue = 2
            _daten.write_to_table(AutomatikParameterTableName, 50, _Hue)
        End If

        _HueBridge = Hue.HueBridgeLocator.Locate()
        _HueLight = _HueBridge.GetLight(HueLightName)

        'If Hue_Control = 0 Then
        '    _HueBridge.SetLightOnOff(_HueLight, False)
        '    _HueHell = 0
        '    _HueAus = 1
        'End If
        'If Hue_Control = 1 Or Hue_Control = 2 Then
        '    _HueBridge.SetLightOnOff(_HueLight, True)
        '    _HueHell = 0
        '    _HueAus = 0
        '    Hue_Control_M = _Hue
        '    Hue_Control_aktuell = Hue_Control
        '    If _Hue = 0 Then
        '        _HueBridge.SetLightCT(_HueLight, 256)
        '        _HueBridge.SetLight(_HueLight, bri:=255)
        '        CT_soll = 256
        '        CT_aktuell = 256
        '        Bri_soll = 255
        '        Bri_aktuell = 255
        '    ElseIf _Hue = 1 Then
        '        _HueBridge.SetLightCT(_HueLight, 256)
        '        _HueBridge.SetLight(_HueLight, bri:=160)
        '        CT_soll = 256
        '        CT_aktuell = 256
        '        Bri_soll = 160
        '        Bri_aktuell = 160
        '    ElseIf _Hue = 2 Then
        '        _HueBridge.SetLightCT(_HueLight, 256)
        '        _HueBridge.SetLight(_HueLight, bri:=80)
        '        CT_soll = 256
        '        CT_aktuell = 256
        '        Bri_soll = 80
        '        Bri_aktuell = 80
        '    ElseIf _Hue = 3 Then
        '        _HueBridge.SetLight(_HueLight, sat:=254)
        '        _HueBridge.SetLight(_HueLight, bri:=80)
        '        _HueBridge.SetLight(_HueLight, hue:=64000)
        '        Bri_soll = 80
        '        Bri_aktuell = 80
        '        Sat_soll = 256
        '        Sat_aktuell = 256
        '        Col_soll = 64000
        '        Col_aktuell = 64000
        '    ElseIf _Hue = 4 Then
        '        _HueBridge.SetLight(_HueLight, sat:=254)
        '        _HueBridge.SetLight(_HueLight, bri:=80)
        '        _HueBridge.SetLight(_HueLight, hue:=45000)
        '        Bri_soll = 80
        '        Bri_aktuell = 80
        '        Sat_soll = 256
        '        Sat_aktuell = 256
        '        Col_soll = 45000
        '        Col_aktuell = 45000
        '    ElseIf _Hue = 5 Then
        '        _HueBridge.SetLight(_HueLight, sat:=254)
        '        _HueBridge.SetLight(_HueLight, bri:=80)
        '        _HueBridge.SetLight(_HueLight, hue:=20500)
        '        Bri_soll = 80
        '        Bri_aktuell = 80
        '        Sat_soll = 256
        '        Sat_aktuell = 256
        '        Col_soll = 20500
        '        Col_aktuell = 20500
        '    ElseIf _Hue = 6 Then
        '        _HueBridge.SetLight(_HueLight, sat:=254)
        '        _HueBridge.SetLight(_HueLight, bri:=80)
        '        _HueBridge.SetLight(_HueLight, hue:=10000)
        '        Bri_soll = 80
        '        Bri_aktuell = 80
        '        Sat_soll = 256
        '        Sat_aktuell = 256
        '        Col_soll = 10000
        '        Col_aktuell = 10000
        '    Else
        '        _Hue = 6
        '    End If
        'End If
        'If Hue_Control = 4 Then
        '    _HueHell = 1
        '    _HueAus = 0
        '    _HueBridge.SetLightOnOff(_HueLight, True)
        '    _HueBridge.SetLightCT(_HueLight, 256)
        '    _HueBridge.SetLight(_HueLight, bri:=255)
        '    Bri_soll = 250
        '    Bri_aktuell = 250
        '    CT_soll = 256
        '    CT_aktuell = 256
        '    Hue_Control_aktuell = 4
        'End If

        If Betriebsart = 0 Then
            Button10.BackColor = Drawing.Color.LightYellow
            TextBox1.Text = "Die Automatik ist ausgeschaltet"
            AutoParaLabel.Visible = False
            Label30.Visible = False
            ProgramCounterLabel.Visible = False
            AutoParaLabel1.Visible = False
            Label31.Visible = False
            ProgramCounterLabel1.Visible = False
        ElseIf Betriebsart = 1 Then
            Button10.BackColor = Drawing.Color.LightGreen
            AutoParaLabel.Visible = True
            Label30.Visible = True
            ProgramCounterLabel.Visible = True
            AutoParaLabel1.Visible = True
            Label31.Visible = True
            ProgramCounterLabel1.Visible = True
        ElseIf Betriebsart = 2 Then
            Button10.BackColor = Drawing.Color.LightBlue
            AutoParaLabel.Visible = True
            Label30.Visible = True
            ProgramCounterLabel.Visible = True
            AutoParaLabel1.Visible = False
            Label31.Visible = False
            ProgramCounterLabel1.Visible = False
        ElseIf Betriebsart = 3 Then
            Button10.BackColor = Drawing.Color.LightCyan
            AutoParaLabel.Visible = False
            Label30.Visible = False
            ProgramCounterLabel.Visible = False
            AutoParaLabel1.Visible = False
            Label31.Visible = False
            ProgramCounterLabel1.Visible = False
        Else
            Betriebsart = 0
        End If

        Button3.BackColor = Drawing.Color.LightGray
        Button4.BackColor = Drawing.Color.LightGray
        Button5.BackColor = Drawing.Color.LightGray
        Button6.BackColor = Drawing.Color.LightGray
        Button7.BackColor = Drawing.Color.LightGray
        Button8.BackColor = Drawing.Color.LightGray
        Button9.BackColor = Drawing.Color.LightGray

        If _Motor = 0 Then
            Button3.BackColor = Drawing.Color.LightGray
            Button3.Text = "Motor aus"
        ElseIf _Motor = 1 Then
            Button3.BackColor = Drawing.Color.LightYellow
            Button3.Text = "Motor ein/aus 1"
        ElseIf _Motor = 2 Then
            Button3.BackColor = Drawing.Color.LightYellow
            Button3.Text = "Motor ein/aus 2"
        ElseIf _Motor = 3 Then
            Button3.BackColor = Drawing.Color.LightYellow
            Button3.Text = "Motor ein/aus 3"
        ElseIf _Motor = 4 Then
            Button3.BackColor = Drawing.Color.LightYellow
            Button3.Text = "Motor ein"
        End If

        If _Fahrzeugbeleuchtung2 = 0 Then
            Button4.BackColor = Drawing.Color.LightGray
            Button4.Text = "Beleuchtung aus"
        ElseIf _Fahrzeugbeleuchtung2 = 1 Then
            Button4.BackColor = Drawing.Color.LightYellow
            Button4.Text = "Beleuchtung ein/aus"
        ElseIf _Fahrzeugbeleuchtung2 = 2 Then
            Button4.BackColor = Drawing.Color.LightYellow
            Button4.Text = "Beleuchtung ein"
        End If

        If _Dampf = 0 Then
            Button5.BackColor = Drawing.Color.LightGray
            Button5.Text = "Dampf aus"
        ElseIf _Dampf = 1 Then
            Button5.BackColor = Drawing.Color.LightYellow
            Button5.Text = "Dampf ein/aus 1"
        ElseIf _Dampf = 2 Then
            Button5.BackColor = Drawing.Color.LightYellow
            Button5.Text = "Dampf ein/aus 2"
        ElseIf _Dampf = 3 Then
            Button5.BackColor = Drawing.Color.LightYellow
            Button5.Text = "Dampf ein"
        End If

        If _Innenbeleuchtung2 = 0 Then
            Button6.BackColor = Drawing.Color.LightGray
            Button6.Text = "Innenlicht aus"
        ElseIf _Innenbeleuchtung2 = 1 Then
            Button6.BackColor = Drawing.Color.LightYellow
            Button6.Text = "Innenlicht ein/aus"
        ElseIf _Innenbeleuchtung2 = 2 Then
            Button6.BackColor = Drawing.Color.LightYellow
            Button6.Text = "Innenlicht ein"
        End If

        If _AkustischeSignale = 0 Then
            Button7.BackColor = Drawing.Color.LightGray
            Button7.Text = "akust. Signale aus"
        ElseIf _AkustischeSignale = 1 Then
            Button7.BackColor = Drawing.Color.LightYellow
            Button7.Text = "akust. Signale ein 1"
        ElseIf _AkustischeSignale = 2 Then
            Button7.BackColor = Drawing.Color.LightYellow
            Button7.Text = "akust. Signale ein 2"
        End If

        If _Durchsagen = 1 Then Button8.BackColor = Drawing.Color.LightYellow
        If _Fernlicht = 1 Then Button9.BackColor = Drawing.Color.LightYellow

        ButtonsVisible(999)

        Ort_Lok1 = 0
        Ort_Lok2 = 0
        Ort_Lok3 = 0
        Ort_Lok4 = 0

        Weiche13schalten = True
        Weiche14schalten = True
        Weiche15schalten = True
        Weiche16schalten = True
        Weiche17schalten = True
        Weiche18schalten = False
        Weiche19schalten = True
        Weiche20schalten = True
        Weiche21schalten = True
        Weiche22schalten = True
        Weiche23schalten = True
        Weiche24schalten = False
        Weiche25schalten = True
        Weiche26schalten = True
        Weiche27schalten = True
        Signal9schalten = False
        Signal10schalten = False
        Signal11schalten = False
        Signal12schalten = False

        A_Stop = 0
        NumericUpDown8.BackColor = Drawing.Color.White
        NumericUpDown9.BackColor = Drawing.Color.White
        NumericUpDown10.BackColor = Drawing.Color.White
        NumericUpDown11.BackColor = Drawing.Color.White
        If Startzug = 1 Then
            NumericUpDown8.BackColor = Drawing.Color.LightBlue
        ElseIf Startzug = 2 Then
            NumericUpDown9.BackColor = Drawing.Color.LightBlue
        ElseIf Startzug = 3 Then
            NumericUpDown10.BackColor = Drawing.Color.LightBlue
        ElseIf Startzug = 4 Then
            NumericUpDown11.BackColor = Drawing.Color.LightBlue
        End If

        If _Zugtyp1 = 1 Then
            Button25.Text = "PK"
            _NachlaufZug1 = False
            _Kurzzug1 = True
        ElseIf _Zugtyp1 = 2 Then
            Button25.Text = "GK"
            _NachlaufZug1 = False
            _Kurzzug1 = True
        ElseIf _Zugtyp1 = 3 Then
            Button25.Text = "PL"
            _NachlaufZug1 = False
            _Kurzzug1 = False
        ElseIf _Zugtyp1 = 4 Then
            Button25.Text = "GL"
            _NachlaufZug1 = False
            _Kurzzug1 = False
        ElseIf _Zugtyp1 = 5 Then
            Button25.Text = "PN"
            _NachlaufZug1 = True
            _Kurzzug1 = False
        ElseIf _Zugtyp1 = 6 Then
            Button25.Text = "GN"
            _NachlaufZug1 = True
            _Kurzzug1 = False
        Else
            _Zugtyp1 = 3
            Button25.Text = "PL"
        End If

        If _Zugtyp2 = 1 Then
            Button26.Text = "PK"
            _NachlaufZug2 = False
            _Kurzzug2 = True
        ElseIf _Zugtyp2 = 2 Then
            Button26.Text = "GK"
            _NachlaufZug2 = False
            _Kurzzug2 = True
        ElseIf _Zugtyp2 = 3 Then
            Button26.Text = "PL"
            _NachlaufZug2 = False
            _Kurzzug2 = False
        ElseIf _Zugtyp2 = 4 Then
            Button26.Text = "GL"
            _NachlaufZug2 = False
            _Kurzzug2 = False
        ElseIf _Zugtyp2 = 5 Then
            Button26.Text = "PN"
            _NachlaufZug2 = True
            _Kurzzug2 = False
        ElseIf _Zugtyp2 = 6 Then
            Button26.Text = "GN"
            _NachlaufZug2 = True
            _Kurzzug2 = False
        Else
            _Zugtyp2 = 3
            Button26.Text = "PL"
        End If

        If _Zugtyp3 = 1 Then
            Button27.Text = "PK"
            _NachlaufZug3 = False
            _Kurzzug3 = True
        ElseIf _Zugtyp3 = 2 Then
            Button27.Text = "GK"
            _NachlaufZug3 = False
            _Kurzzug3 = True
        ElseIf _Zugtyp3 = 3 Then
            Button27.Text = "PL"
            _NachlaufZug3 = False
            _Kurzzug3 = False
        ElseIf _Zugtyp3 = 4 Then
            Button27.Text = "GL"
            _NachlaufZug3 = False
            _Kurzzug3 = False
        ElseIf _Zugtyp3 = 5 Then
            Button27.Text = "PN"
            _NachlaufZug3 = True
            _Kurzzug3 = False
        ElseIf _Zugtyp3 = 6 Then
            Button27.Text = "GN"
            _NachlaufZug3 = True
            _Kurzzug3 = False
        Else
            _Zugtyp3 = 3
            Button27.Text = "PL"
        End If

        If _Zugtyp4 = 1 Then
            Button28.Text = "PK"
            _NachlaufZug4 = False
            _Kurzzug4 = True
        ElseIf _Zugtyp4 = 2 Then
            Button28.Text = "GK"
            _NachlaufZug4 = False
            _Kurzzug4 = True
        ElseIf _Zugtyp4 = 3 Then
            Button28.Text = "PL"
            _NachlaufZug4 = False
            _Kurzzug4 = False
        ElseIf _Zugtyp4 = 4 Then
            Button28.Text = "GL"
            _NachlaufZug4 = False
            _Kurzzug4 = False
        ElseIf _Zugtyp4 = 5 Then
            Button28.Text = "PN"
            _NachlaufZug4 = True
            _Kurzzug4 = False
        ElseIf _Zugtyp4 = 6 Then
            Button28.Text = "GN"
            _NachlaufZug4 = True
            _Kurzzug4 = False
        Else
            _Zugtyp4 = 3
            Button28.Text = "PL"
        End If

        Dim timer1 As Double = daten.read_from_table(TimerTableName, 0)
        Dim timer2 As Double = daten.read_from_table(TimerTableName, 1)
        Dim timer3 As Double = daten.read_from_table(TimerTableName, 2)
        Dim timer4 As Double = daten.read_from_table(TimerTableName, 3)

        If timer1 = 0 Then
            timer1 = NumericUpDown1.Minimum * 1000
        End If
        If timer2 = 0 Then
            timer2 = NumericUpDown2.Minimum * 1000
        End If
        If timer3 = 0 Then
            timer3 = NumericUpDown3.Minimum * 1000
        End If
        If timer4 = 0 Then
            timer4 = NumericUpDown4.Minimum * 1000
        End If

        Timer_1 = New Timers.Timer(timer3)
        Timer_2 = New Timers.Timer(timer3)
        Timer_3 = New Timers.Timer(timer4)
        Timer_4 = New Timers.Timer(timer4)
        Timer_5 = New Timers.Timer(timer1)
        Timer_6 = New Timers.Timer(timer1)
        Timer_7 = New Timers.Timer(timer2)
        Timer_8 = New Timers.Timer(timer2)
        Timer_9 = New Timers.Timer(10000)
        Timer_10 = New Timers.Timer(10000)
        Timer_11 = New Timers.Timer(10000)
        Timer_12 = New Timers.Timer(10000)

        Timer_EinzelLok1 = New Timers.Timer(5000)
        Timer_EinzelLok2 = New Timers.Timer(5000)
        Timer_EinzelLok3 = New Timers.Timer(5000)
        Timer_EinzelLok4 = New Timers.Timer(5000)

        Timer_Kamera0 = New Timers.Timer(4000)
        Timer_Kamera1 = New Timers.Timer(4000)
        Timer_Kamera2 = New Timers.Timer(4000)
        Delay_Automatik_110 = New Timers.Timer(5000)
        Delay_Automatik_210 = New Timers.Timer(5000)

        Timer_Music = New Timers.Timer(411000)
        'Timer_Story1 = New Timers.Timer(15900)
        'Timer_Story_DMX = New Timers.Timer(100)
        'Timer_Story3 = New Timers.Timer(25500)
        'Timer_Story4 = New Timers.Timer(12250)
        'Timer_Story5 = New Timers.Timer(50000)
        'Timer_Story6 = New Timers.Timer(60000)
        'Timer_Story7 = New Timers.Timer(70000)
        'Timer_Story8 = New Timers.Timer(80000)
        'Timer_Story_Film = New Timers.Timer(300)
        Timer_Story_Auto = New Timers.Timer(100000)

        Timer_DMX = New Timers.Timer(100)
        Timer_HUE = New Timers.Timer(100)

        '*** Fahrprogramm für Züge FPZ
        '*** Timer definieren
        Prog_Lok10 = New Timers.Timer(200)
        Prog_Lok11 = New Timers.Timer(200)
        Prog_Lok12 = New Timers.Timer(200)
        Prog_Lok13 = New Timers.Timer(200)
        Prog_Lok14 = New Timers.Timer(200)
        Prog_Lok15 = New Timers.Timer(200)
        Prog_Lok16 = New Timers.Timer(200)
        Prog_Lok17 = New Timers.Timer(200)
        Prog_Lok18 = New Timers.Timer(200)
        Prog_Lok19 = New Timers.Timer(200)
        Prog_Lok20 = New Timers.Timer(200)
        Prog_Lok21 = New Timers.Timer(200)
        Prog_Lok22 = New Timers.Timer(200)
        Prog_Lok23 = New Timers.Timer(200)
        Prog_Lok24 = New Timers.Timer(200)
        Prog_Lok25 = New Timers.Timer(200)
        Prog_Lok26 = New Timers.Timer(200)
        Prog_Lok27 = New Timers.Timer(200)
        Prog_Lok28 = New Timers.Timer(200)
        Prog_Lok29 = New Timers.Timer(200)
        Prog_Lok30 = New Timers.Timer(200)
        Prog_Lok31 = New Timers.Timer(200)
        Prog_Lok32 = New Timers.Timer(200)
        Prog_Lok33 = New Timers.Timer(200)
        Prog_Lok34 = New Timers.Timer(200)
        Prog_Lok35 = New Timers.Timer(200)
        Prog_Lok36 = New Timers.Timer(200)
        Prog_Lok37 = New Timers.Timer(200)
        Prog_Lok38 = New Timers.Timer(200)
        Prog_Lok39 = New Timers.Timer(200)
        Prog_Lok40 = New Timers.Timer(200)
        Prog_Lok41 = New Timers.Timer(200)
        Prog_Lok42 = New Timers.Timer(200)
        Prog_Lok43 = New Timers.Timer(200)
        Prog_Lok44 = New Timers.Timer(200)
        Prog_Lok45 = New Timers.Timer(200)
        Prog_Lok46 = New Timers.Timer(200)
        Prog_Lok47 = New Timers.Timer(200)
        Prog_Lok48 = New Timers.Timer(200)
        Prog_Lok49 = New Timers.Timer(200)
        Prog_Lok50 = New Timers.Timer(200)
        Prog_Lok51 = New Timers.Timer(200)
        Prog_Lok52 = New Timers.Timer(200)
        Prog_Lok53 = New Timers.Timer(200)
        Prog_Lok54 = New Timers.Timer(200)
        Prog_Lok55 = New Timers.Timer(200)
        Prog_Lok56 = New Timers.Timer(200)
        Prog_Lok57 = New Timers.Timer(200)
        Prog_Lok58 = New Timers.Timer(200)
        Prog_Lok59 = New Timers.Timer(200)
        Prog_Lok60 = New Timers.Timer(200)
        Prog_Lok61 = New Timers.Timer(200)
        Prog_Lok62 = New Timers.Timer(200)
        Prog_Lok63 = New Timers.Timer(200)
        Prog_Lok64 = New Timers.Timer(200)
        Prog_Lok65 = New Timers.Timer(200)
        Prog_Lok66 = New Timers.Timer(200)
        Prog_Lok67 = New Timers.Timer(200)
        Prog_Lok68 = New Timers.Timer(200)
        Prog_Lok69 = New Timers.Timer(200)
        Prog_Lok70 = New Timers.Timer(200)
        Prog_Lok71 = New Timers.Timer(200)
        Prog_Lok72 = New Timers.Timer(200)
        Prog_Lok73 = New Timers.Timer(200)
        Prog_Lok74 = New Timers.Timer(200)
        Prog_Lok75 = New Timers.Timer(200)
        Prog_Lok76 = New Timers.Timer(200)
        Prog_Lok77 = New Timers.Timer(200)
        Prog_Lok78 = New Timers.Timer(200)
        Prog_Lok79 = New Timers.Timer(200)
        Prog_Lok80 = New Timers.Timer(200)

        'Timer_Event_ein = New Timers.Timer(2000)
        'Timer_Event_aus = New Timers.Timer(2000)

        NumericUpDown1.Value = timer1 / 1000
        NumericUpDown2.Value = timer2 / 1000
        NumericUpDown3.Value = timer3 / 1000
        NumericUpDown4.Value = timer4 / 1000

        _LokStufen = New LokStufen(_eb, _daten)
        LoksWiederherstellen()
        'LokTimerLaden()
        GeschwindikeitenSetzen(_LokStufen.AktiveHolen(Startzug))
        'Button41.Text = "Weichen initialisieren"
        'Button42.Text = "Signale initialisieren"

        _kalteHerz = New DasKalteHerz(_eb, _daten, _dmxServer)

        StoryImage = "0-Grundbild.jpg"
        If ComboBox1.SelectedIndex = 0 Then
            StoryText = "Aus"
        ElseIf ComboBox1.SelectedIndex = 1 Then
            StoryText = "Eisenbahn"
        ElseIf ComboBox1.SelectedIndex = 2 Then
            StoryText = "Das kalte Herz"
        ElseIf ComboBox1.SelectedIndex = 3 Then
            'StoryText = "Tag und Nacht"
        ElseIf ComboBox1.SelectedIndex = 4 Then
            'StoryText = "Zug verfolgen"
        Else
            StoryText = "Modelleisenbahnanlage 'Altenstein' "
        End If

        _StoryPointer = 0
        _TimerStory_laeuft = False
        _StoryControl = 3
        _StoryAuto = 0
        _StoryZeit = 8000
        _Music_laeuft = 0
        _Zug_laeuft = 0
        CheckBox1.Enabled = False
        DMX_Pointer = 0
        DMX_Klick = 0
        Fahrplan = 0

        Warte1A1 = NumericUpDown1.Value * 1000
        Warte1A2 = NumericUpDown1.Value * 1000
        Warte1BA = NumericUpDown1.Value * 1000
        Warte1SB = NumericUpDown1.Value * 1000
        Warte1TA = NumericUpDown1.Value * 1000
        Warte1DI = NumericUpDown1.Value * 1000

        Warte2A1 = NumericUpDown2.Value * 1000
        Warte2A2 = NumericUpDown2.Value * 1000
        Warte2BA = NumericUpDown2.Value * 1000
        Warte2SB = NumericUpDown2.Value * 1000
        Warte2TA = NumericUpDown2.Value * 1000
        Warte2DI = NumericUpDown2.Value * 1000

        Warte3A1 = NumericUpDown3.Value * 1000
        Warte3A2 = NumericUpDown3.Value * 1000
        Warte3BA = NumericUpDown3.Value * 1000
        Warte3SB = NumericUpDown3.Value * 1000
        Warte3TA = NumericUpDown3.Value * 1000
        Warte3DI = NumericUpDown3.Value * 1000

        Warte4A1 = NumericUpDown4.Value * 1000
        Warte4A2 = NumericUpDown4.Value * 1000
        Warte4BA = NumericUpDown4.Value * 1000
        Warte4SB = NumericUpDown4.Value * 1000
        Warte4TA = NumericUpDown4.Value * 1000
        Warte4DI = NumericUpDown4.Value * 1000

        ButtonsVisible(999)

    End Sub

#Region "Infrastructure"

    Private Sub StopAllTimers()
        Timer_1.Stop()
        Timer_2.Stop()
        Timer_3.Stop()
        Timer_4.Stop()
        Timer_5.Stop()
        Timer_6.Stop()
        Timer_7.Stop()
        Timer_8.Stop()
        Timer_9.Stop()
        Timer_10.Stop()
        Timer_11.Stop()
        Timer_12.Stop()

        Timer_EinzelLok1.Stop()
        Timer_EinzelLok2.Stop()
        Timer_EinzelLok3.Stop()
        Timer_EinzelLok4.Stop()

        Timer_Kamera0.Stop()
        Timer_Kamera1.Stop()
        Timer_Kamera2.Stop()
        Delay_Automatik_110.Stop()
        Delay_Automatik_210.Stop()

        Timer_Music.Stop()

        'Timer_Story_DMX.Stop()

        'Timer_Story_Film.Stop()
        Timer_Story_Auto.Stop()

        Timer_DMX.Stop()
        Timer_HUE.Stop()

        Prog_Lok10.Stop()
        Prog_Lok11.Stop()
        Prog_Lok12.Stop()
        Prog_Lok13.Stop()
        Prog_Lok14.Stop()
        Prog_Lok15.Stop()
        Prog_Lok16.Stop()
        Prog_Lok17.Stop()
        Prog_Lok18.Stop()
        Prog_Lok19.Stop()
        Prog_Lok20.Stop()
        Prog_Lok21.Stop()
        Prog_Lok22.Stop()
        Prog_Lok23.Stop()
        Prog_Lok24.Stop()
        Prog_Lok25.Stop()
        Prog_Lok26.Stop()
        Prog_Lok27.Stop()
        Prog_Lok28.Stop()
        Prog_Lok29.Stop()
        Prog_Lok30.Stop()
        Prog_Lok31.Stop()
        Prog_Lok32.Stop()
        Prog_Lok33.Stop()
        Prog_Lok34.Stop()
        Prog_Lok35.Stop()
        Prog_Lok36.Stop()
        Prog_Lok37.Stop()
        Prog_Lok38.Stop()
        Prog_Lok39.Stop()
        Prog_Lok40.Stop()
        Prog_Lok41.Stop()
        Prog_Lok42.Stop()
        Prog_Lok43.Stop()
        Prog_Lok44.Stop()
        Prog_Lok45.Stop()
        Prog_Lok46.Stop()
        Prog_Lok47.Stop()
        Prog_Lok48.Stop()
        Prog_Lok49.Stop()
        Prog_Lok50.Stop()
        Prog_Lok51.Stop()
        Prog_Lok52.Stop()
        Prog_Lok53.Stop()
        Prog_Lok54.Stop()
        Prog_Lok55.Stop()
        Prog_Lok56.Stop()
        Prog_Lok57.Stop()
        Prog_Lok58.Stop()
        Prog_Lok59.Stop()
        Prog_Lok60.Stop()
        Prog_Lok61.Stop()
        Prog_Lok62.Stop()
        Prog_Lok63.Stop()
        Prog_Lok64.Stop()
        Prog_Lok65.Stop()
        Prog_Lok66.Stop()
        Prog_Lok67.Stop()
        Prog_Lok68.Stop()
        Prog_Lok69.Stop()
        Prog_Lok70.Stop()
        Prog_Lok71.Stop()
        Prog_Lok72.Stop()
        Prog_Lok73.Stop()
        Prog_Lok74.Stop()
        Prog_Lok75.Stop()
        Prog_Lok76.Stop()
        Prog_Lok77.Stop()
        Prog_Lok78.Stop()
        Prog_Lok79.Stop()
        Prog_Lok80.Stop()

        If _Bhf_Gleis1 = 0 Then
            Button31.BackColor = Drawing.Color.LightGreen
        Else
            Button31.BackColor = Drawing.Color.LightYellow
        End If
        If _Bhf_Gleis2 = 0 Then
            Button32.BackColor = Drawing.Color.LightGreen
        Else
            Button32.BackColor = Drawing.Color.LightYellow
        End If
        If _Bhf_Gleis3 = 0 Then
            Button33.BackColor = Drawing.Color.LightGreen
        Else
            Button33.BackColor = Drawing.Color.LightYellow
        End If
        If _Bhf_Gleis4 = 0 Then
            Button34.BackColor = Drawing.Color.LightGreen
        Else
            Button34.BackColor = Drawing.Color.LightYellow
        End If

        If _SBhf_Gleis1 = 0 Then
            Button51.BackColor = Drawing.Color.LightGreen
        ElseIf _SBhf_Gleis1 = 1 Then
            Button51.BackColor = Drawing.Color.LightYellow
        ElseIf _SBhf_Gleis1 = 2 Then
            Button51.BackColor = Drawing.Color.LightYellow
        End If
        If _SBhf_Gleis2 = 0 Then
            Button52.BackColor = Drawing.Color.LightGreen
        ElseIf _SBhf_Gleis2 = 1 Then
            Button52.BackColor = Drawing.Color.LightYellow
        ElseIf _Bhf_Gleis2 = 2 Then
            Button52.BackColor = Drawing.Color.LightYellow
        End If
        If _SBhf_Gleis3 = 0 Then
            Button53.BackColor = Drawing.Color.LightGreen
        ElseIf _SBhf_Gleis3 = 1 Then
            Button53.BackColor = Drawing.Color.LightYellow
        ElseIf _SBhf_Gleis3 = 2 Then
            Button53.BackColor = Drawing.Color.LightYellow
        End If
        If _SBhf_Gleis4 = 0 Then
            Button54.BackColor = Drawing.Color.LightGreen
        ElseIf _SBhf_Gleis4 = 1 Then
            Button54.BackColor = Drawing.Color.LightYellow
        ElseIf _SBhf_Gleis4 = 2 Then
            Button54.BackColor = Drawing.Color.LightYellow
        End If

        If _Bhf2_Gleis1 = 0 Then
            Button71.BackColor = Drawing.Color.LightGreen
        ElseIf _Bhf2_Gleis1 = 1 Then
            Button71.BackColor = Drawing.Color.LightYellow
        ElseIf _Bhf2_Gleis1 = 2 Then
            Button71.BackColor = Drawing.Color.LightYellow
        End If
        If _Bhf2_Gleis2 = 0 Then
            Button72.BackColor = Drawing.Color.LightGreen
        ElseIf _Bhf2_Gleis2 = 1 Then
            Button72.BackColor = Drawing.Color.LightYellow
        ElseIf _Bhf_Gleis2 = 2 Then
            Button72.BackColor = Drawing.Color.LightYellow
        End If
        If _Bhf2_Gleis3 = 0 Then
            Button73.BackColor = Drawing.Color.LightGreen
        ElseIf _Bhf2_Gleis3 = 1 Then
            Button73.BackColor = Drawing.Color.LightYellow
        ElseIf _Bhf2_Gleis3 = 2 Then
            Button73.BackColor = Drawing.Color.LightYellow
        End If
        If _Bhf2_Gleis4 = 0 Then
            Button74.BackColor = Drawing.Color.LightGreen
        ElseIf _Bhf2_Gleis4 = 1 Then
            Button74.BackColor = Drawing.Color.LightYellow
        ElseIf _Bhf2_Gleis4 = 2 Then
            Button74.BackColor = Drawing.Color.LightYellow
        End If


        If _Berg_Gleis1 = 0 Then
            Button61.BackColor = Drawing.Color.LightGreen
        ElseIf _Berg_Gleis1 = 1 Then
            Button61.BackColor = Drawing.Color.LightYellow
        ElseIf _Berg_Gleis1 = 2 Then
            Button61.BackColor = Drawing.Color.LightYellow
        End If
        If _Berg_Gleis2 = 0 Then
            Button62.BackColor = Drawing.Color.LightGreen
        ElseIf _Berg_Gleis2 = 1 Then
            Button62.BackColor = Drawing.Color.LightYellow
        ElseIf _Bhf_Gleis2 = 2 Then
            Button62.BackColor = Drawing.Color.LightYellow
        End If
        If _Berg_Gleis3 = 0 Then
            Button63.BackColor = Drawing.Color.LightGreen
        ElseIf _Berg_Gleis3 = 1 Then
            Button63.BackColor = Drawing.Color.LightYellow
        ElseIf _Berg_Gleis3 = 2 Then
            Button63.BackColor = Drawing.Color.LightYellow
        End If
        If _Berg_Gleis4 = 0 Then
            Button64.BackColor = Drawing.Color.LightGreen
        ElseIf _Berg_Gleis4 = 1 Then
            Button64.BackColor = Drawing.Color.LightYellow
        ElseIf _Berg_Gleis4 = 2 Then
            Button64.BackColor = Drawing.Color.LightYellow
        End If


    End Sub

    Private Sub BetriebsartenAktivieren(ByRef aktiv As Boolean)
        Button23.Enabled = aktiv
        Button21.Enabled = aktiv
        Button22.Enabled = aktiv
        Button24.Enabled = aktiv

        Button31.Enabled = aktiv
        Button32.Enabled = aktiv
        Button33.Enabled = aktiv
        Button34.Enabled = aktiv

        Button10.Enabled = aktiv
        Button11.Enabled = aktiv
        Button12.Enabled = aktiv

        Button19.Enabled = aktiv
        Button38.Enabled = aktiv
        Button30.Enabled = aktiv
        Button35.Enabled = aktiv
        Button40.Enabled = aktiv
        Button44.Enabled = aktiv

    End Sub

    Private Sub DeactivateAllAutomatics(ByRef checkbox As Windows.Forms.CheckBox)
        StopAllTimers()
        If (checkbox.Checked = True) Then
            Stop_Betaetigt = False
            If checkbox.Equals(CheckBox1) Then
                _aktiv = 1
            Else
                CheckBox1.Checked = False
            End If
            BetriebsartenAktivieren(False)
        Else
            BetriebsartenAktivieren(True)
        End If
    End Sub

    Public Sub update1(ByVal Kontakte() As Klassen.Kontakt) Implements Communication.KontaktEventUpdateInterface.update
        If (CheckBox1.Checked) Then
            Automatik1(Kontakte)
        End If
    End Sub

    Dim Weiche0Richtung As Klassen.WeichenRichtung

    Sub UpdateWeichen(ByVal Weiche() As Klassen.Weiche) Implements Communication.WeichenEventUpdateInterface.update

        If _Weichen_initialisiert = True Then
            If _Weichen_in_Startposition = True Then
                Button41.BackColor = Drawing.Color.Green
                Button41.Text = "Weichen sind in Startposition"
            Else
                Button41.BackColor = Drawing.Color.Yellow
                Button41.Text = "Signale initialisieren"
            End If
        Else
            Button41.BackColor = Drawing.Color.Red
            Button41.Text = "Weichen initialisieren"
        End If
        If _Signale_initialisiert = True Then
            If _Signale_in_Startposition = True Then
                Button42.BackColor = Drawing.Color.Green
                Button42.Text = "Signale sind in Startposition"
            Else
                Button42.BackColor = Drawing.Color.Yellow
                Button42.Text = "Signale initialisieren"
            End If
        Else
            Button42.BackColor = Drawing.Color.Red
        End If

        If Betriebsart = 1 Then

        End If

        If Betriebsart = 2 Then
            If Betriebsart12 = 0 And Betriebsart34 = 0 Then

            End If
            If Betriebsart12 = 0 And Betriebsart34 = 3 Then

            End If
            If Betriebsart12 = 0 And Betriebsart34 = 4 Then

            End If
            If Betriebsart12 = 0 And Betriebsart34 = 5 Then
                'If _eb.weiche(23).Richtung = Klassen.WeichenRichtung.links Or
                '    _eb.weiche(16).Richtung = Klassen.WeichenRichtung.links Or
                '    _eb.weiche(14).Richtung = Klassen.WeichenRichtung.links Then

                '    Button41.BackColor = Drawing.Color.Yellow

                'End If
            End If
            If Betriebsart12 = 1 And Betriebsart34 = 0 Then

            End If
            If Betriebsart12 = 1 And Betriebsart34 = 3 Then

            End If
            If Betriebsart12 = 1 And Betriebsart34 = 4 Then

            End If
            If Betriebsart12 = 1 And Betriebsart34 = 5 Then

            End If
            If Betriebsart12 = 2 And Betriebsart34 = 0 Then

            End If
            If Betriebsart12 = 2 And Betriebsart34 = 3 Then

            End If
            If Betriebsart12 = 2 And Betriebsart34 = 4 Then

            End If
            If Betriebsart12 = 2 And Betriebsart34 = 5 Then

            End If
            If Betriebsart12 = 3 And Betriebsart34 = 0 Then

            End If
            If Betriebsart12 = 3 And Betriebsart34 = 3 Then

            End If
            If Betriebsart12 = 3 And Betriebsart34 = 4 Then

            End If
            If Betriebsart12 = 3 And Betriebsart34 = 5 Then

            End If
        End If
    End Sub

    Private Sub CheckBox1_CheckedChanged(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles CheckBox1.CheckedChanged
        CheckBox1.Enabled = False
        If CheckBox1.Checked = False Then
            DeactivateAllAutomatics(CheckBox1)
            Start_Betaetigt = False
            Stop_Betaetigt = True
            Button43.Text = "Start"
            Button43.BackColor = Drawing.Color.White
            'Button42.BackColor = Drawing.Color.Yellow
            'Button41.BackColor = Drawing.Color.Yellow
            AutomatikParameter = 0
            PictureBox1.Visible = False
            StopMusic()
            ComboBox1.Enabled = True
            Ort_Lok1 = 0
            Ort_Lok2 = 0
            Ort_Lok3 = 0
            Ort_Lok4 = 0
            _Weichen_in_Startposition = False
            _Signale_in_Startposition = False
            ButtonsVisible(999)
        End If
    End Sub

    Private Sub HandleTimerElapsed2(sender As System.Object, e As System.EventArgs) Handles Timer_2.Elapsed
        Timer_2.Stop()
        _eb.weicheSchalten(2, Klassen.WeichenRichtung.links)  'Signal 2 grün schalten
    End Sub
    Private Sub HandleTimerElapsed3(sender As System.Object, e As System.EventArgs) Handles Timer_3.Elapsed
        Timer_3.Stop()
        _eb.weicheSchalten(3, Klassen.WeichenRichtung.links)  'Signal 3 grün schalten
    End Sub
    Private Sub HandleTimerElapsed4(sender As System.Object, e As System.EventArgs) Handles Timer_4.Elapsed
        Timer_4.Stop()
        _eb.weicheSchalten(4, Klassen.WeichenRichtung.links)  'Signal 4 grün schalten
    End Sub
    Private Sub HandleTimerElapsed5(sender As System.Object, e As System.EventArgs) Handles Timer_5.Elapsed
        Timer_5.Stop()
        _eb.weicheSchalten(5, Klassen.WeichenRichtung.links)  'Signal 5 grün schalten
    End Sub
    Private Sub HandleTimerElapsed6(sender As System.Object, e As System.EventArgs) Handles Timer_6.Elapsed
        Timer_6.Stop()
        _eb.weicheSchalten(6, Klassen.WeichenRichtung.links)  'Signal 6 grün schalten
    End Sub
    Private Sub HandleTimerElapsed7(sender As System.Object, e As System.EventArgs) Handles Timer_7.Elapsed
        Timer_7.Stop()
        _eb.weicheSchalten(7, Klassen.WeichenRichtung.links)  'Signal 7 grün schalten
    End Sub
    Private Sub HandleTimerElapsed8(sender As System.Object, e As System.EventArgs) Handles Timer_8.Elapsed
        Timer_8.Stop()
        _eb.weicheSchalten(8, Klassen.WeichenRichtung.links)  'Signal 8 grün schalten
    End Sub
    Private Sub HandleTimerElapsed9(sender As System.Object, e As System.EventArgs) Handles Timer_9.Elapsed
        Timer_9.Stop()
        Button51.BackColor = Drawing.Color.LightYellow
        Button52.BackColor = Drawing.Color.LightYellow
        Button53.BackColor = Drawing.Color.LightYellow
        Button54.BackColor = Drawing.Color.LightYellow
        _eb.weicheSchalten(9, Klassen.WeichenRichtung.links)  'Signal 9 grün schalten
    End Sub
    Private Sub HandleTimerElapsed10(sender As System.Object, e As System.EventArgs) Handles Timer_10.Elapsed
        Timer_10.Stop()
        _eb.weicheSchalten(10, Klassen.WeichenRichtung.links)  'Signal 10 grün schalten
        Button81.BackColor = Drawing.Color.LightYellow
        Button82.BackColor = Drawing.Color.LightYellow
        Button83.BackColor = Drawing.Color.LightYellow
        Button84.BackColor = Drawing.Color.LightYellow
    End Sub
    Private Sub HandleTimerElapsed11(sender As System.Object, e As System.EventArgs) Handles Timer_11.Elapsed
        Timer_11.Stop()
        Button51.BackColor = Drawing.Color.LightYellow
        Button52.BackColor = Drawing.Color.LightYellow
        Button53.BackColor = Drawing.Color.LightYellow
        Button54.BackColor = Drawing.Color.LightYellow
        _eb.weicheSchalten(11, Klassen.WeichenRichtung.links)  'Signal 11 grün schalten
    End Sub
    Private Sub HandleTimerElapsed12(sender As System.Object, e As System.EventArgs) Handles Timer_12.Elapsed
        Timer_12.Stop()
        Button91.BackColor = Drawing.Color.LightYellow
        Button92.BackColor = Drawing.Color.LightYellow
        Button93.BackColor = Drawing.Color.LightYellow
        Button94.BackColor = Drawing.Color.LightYellow
        _eb.weicheSchalten(12, Klassen.WeichenRichtung.links)  'Signal 12 grün schalten
        If _Betriebsart3_0Var = 1 Then
            _eb.weicheSchalten(23, Klassen.WeichenRichtung.links)
        ElseIf _Betriebsart0_5Var = 1 Then

        Else
            Button91.BackColor = Drawing.Color.LightYellow
            If Ort_Lok1 = 120 Then
                _eb.weicheSchalten(26, Klassen.WeichenRichtung.rechts)
                _eb.weicheSchalten(23, Klassen.WeichenRichtung.links)
                _eb.weicheSchalten(21, Klassen.WeichenRichtung.rechts)
            End If
            If Ort_Lok2 = 220 Then
                _eb.weicheSchalten(26, Klassen.WeichenRichtung.rechts)
                _eb.weicheSchalten(23, Klassen.WeichenRichtung.links)
                _eb.weicheSchalten(21, Klassen.WeichenRichtung.links)
            End If
            If Ort_Lok3 = 313 Then
                If _Route_Gleis3 = 1 Then
                    _eb.weicheSchalten(26, Klassen.WeichenRichtung.rechts)
                    _eb.weicheSchalten(23, Klassen.WeichenRichtung.rechts)
                Else
                    _eb.weicheSchalten(26, Klassen.WeichenRichtung.links)
                    _eb.weicheSchalten(22, Klassen.WeichenRichtung.rechts)
                End If
            End If
            If Ort_Lok4 = 413 Then
                If _Route_Gleis4 = 1 Then
                    _eb.weicheSchalten(26, Klassen.WeichenRichtung.rechts)
                    _eb.weicheSchalten(23, Klassen.WeichenRichtung.rechts)
                Else
                    _eb.weicheSchalten(26, Klassen.WeichenRichtung.links)
                    _eb.weicheSchalten(22, Klassen.WeichenRichtung.links)
                End If
            End If
        End If
    End Sub

    Private Sub HandleTimerElapsed13(sender As System.Object, e As System.EventArgs) Handles Timer_EinzelLok1.Elapsed
        If Me.InvokeRequired Then
            Me.Invoke(Sub() HandleTimerElapsed13(sender, e))
            Return
        End If
        ' ***
        ' *** Datum: 27.02.2021
        ' ***
        Dim Stufe3, Stufe4 As Integer
        Timer_EinzelLok1.Stop()
        _StopZug1 = 0
        A_StopB = 0
        If A_StopH = 0 Then
            _AutomatikParameterH = 0
            If Ort_Lok1 = 0 Then   ' Zug 1 steht vor Signal 5 im Bahnhof <-- (Erstfahrt nach Start)
                ' ***
                ' *** Zug 1 steht im Bahnhof (Erstfahrt nach Start)
                ' ***
                _eb.weicheSchalten(23, Klassen.WeichenRichtung.links)
                _eb.weicheSchalten(21, Klassen.WeichenRichtung.rechts)
                If _Bhf_Gleis1 = 0 Then
                    Button31.BackColor = Drawing.Color.LightGreen
                Else
                    Button31.BackColor = Drawing.Color.LightYellow
                End If
                If _Route_Gleis1 = 0 Then
                    _eb.weicheSchalten(17, Klassen.WeichenRichtung.links)
                ElseIf _Route_Gleis1 = 1 Then
                    _eb.weicheSchalten(17, Klassen.WeichenRichtung.rechts)
                    _eb.weicheSchalten(27, Klassen.WeichenRichtung.rechts)
                ElseIf _Route_Gleis1 = 2 Then
                    _eb.weicheSchalten(17, Klassen.WeichenRichtung.links)
                    _eb.weicheSchalten(19, Klassen.WeichenRichtung.links)   ' *** Weiche 19 vorschalten 09.10.2021
                End If
                If _Route_Gleis1 = 1 Then
                Else
                    If _SBhf_Gleis1 > 0 Then
                        _eb.weicheSchalten(11, Klassen.WeichenRichtung.rechts)
                    Else
                        _eb.weicheSchalten(11, Klassen.WeichenRichtung.links)
                    End If
                End If
                Zug1(anfahren)
                AutomatikParameter = 100
            ElseIf Ort_Lok1 = 100 Then
                ' ***
                ' *** Zug 1 steht im Bahnhof < --
                ' ***
                Button31.BackColor = Drawing.Color.LightYellow
                If Weiche17schalten = True Then
                    If _Route_Gleis1 = 0 Then
                        _eb.weicheSchalten(17, Klassen.WeichenRichtung.links)
                    ElseIf _Route_Gleis1 = 1 Then
                        _eb.weicheSchalten(17, Klassen.WeichenRichtung.rechts)
                    ElseIf _Route_Gleis1 = 2 Then
                        _eb.weicheSchalten(17, Klassen.WeichenRichtung.links)
                    End If
                End If
                If Weiche19schalten = True Then         ' *** Weiche 19 vorschalten 09.10.21
                    If _Route_Gleis1 = 2 Then
                        _eb.weicheSchalten(19, Klassen.WeichenRichtung.links)
                    End If
                End If
                'If Weiche21schalten = True Then         ' *** Weiche 21 vorschalten 09.10.21
                '    If _Route_Gleis1 = 0 And (_SBhf_Gleis1 = 0 Or _SBhf_Gleis1 = 1) Then
                '        _eb.weicheSchalten(21, Klassen.WeichenRichtung.rechts)
                '    End If
                '    If _Route_Gleis1 = 1 Then
                '        _eb.weicheSchalten(21, Klassen.WeichenRichtung.rechts)
                '    End If
                '    If _Route_Gleis1 = 2 And (_SBhf_Gleis1 = 0 Or _SBhf_Gleis1 = 1) Then
                '        _eb.weicheSchalten(21, Klassen.WeichenRichtung.rechts)
                '    End If
                'End If
                If Weiche27schalten = True Then
                    If _Route_Gleis1 > 0 Then
                        _eb.weicheSchalten(27, Klassen.WeichenRichtung.rechts)
                    End If
                End If
                If _Route_Gleis1 = 1 Then
                Else                         ' SBHF kann durch Zug 2 belegt sein !
                    If _SBhf_Gleis1 > 0 Then
                        _eb.weicheSchalten(11, Klassen.WeichenRichtung.rechts)
                    Else
                        _eb.weicheSchalten(11, Klassen.WeichenRichtung.links)
                    End If
                End If
                If _Kamera = 3 And _aktuelleKamera <> Marxzel Then
                    _Webcams.SetWebcam(0, Marxzel)
                    SetText(Button13, "Wiehre")
                    _aktuelleKamera = Marxzel
                End If
                Zug1(anfahren)
                AutomatikParameter = 100
            ElseIf Ort_Lok1 = 102 Then
                ' ***
                ' *** Zug 1 steht im Schattenbahnhof
                ' ***
                Button51.BackColor = Drawing.Color.LightYellow
                If _Route_Gleis1 = 0 Then
                    AutomatikParameter = 120
                ElseIf _Route_Gleis1 = 1 Then
                    AutomatikParameter = 120
                ElseIf _Route_Gleis1 = 2 Then
                    AutomatikParameter = 102
                End If
                If Weiche21schalten = True Then
                    _eb.weicheSchalten(21, Klassen.WeichenRichtung.rechts)
                End If
                If Weiche23schalten = True Then
                    If _Route_Gleis1 = 0 Then
                        _eb.weicheSchalten(23, Klassen.WeichenRichtung.links)
                    ElseIf _Route_Gleis1 = 1 Then
                        _eb.weicheSchalten(23, Klassen.WeichenRichtung.links)
                    ElseIf _Route_Gleis1 = 2 Then
                        _eb.weicheSchalten(23, Klassen.WeichenRichtung.rechts)
                    End If
                End If
                _eb.weicheSchalten(11, Klassen.WeichenRichtung.links)
                _LokStufen.EinzelLokSenden(1, 3)
            ElseIf Ort_Lok1 = 103 Then
                ' ***
                ' *** Zug 1 steht vor Signal 10 (Diagonale)
                ' ***
                Button81.BackColor = Drawing.Color.LightYellow
                _eb.weicheSchalten(10, Klassen.WeichenRichtung.links)
                If Weiche14schalten = True Then
                    _eb.weicheSchalten(14, Klassen.WeichenRichtung.links)
                End If
                If Weiche19schalten = True Then
                    _eb.weicheSchalten(19, Klassen.WeichenRichtung.links)
                End If
                AutomatikParameter = 103
            ElseIf Ort_Lok1 = 105 Then
                ' ***
                ' *** Zug 1 steht vor Signal 6 (Bahnhof -->)
                ' ***
                If Weiche27schalten = True Then
                    _eb.weicheSchalten(27, Klassen.WeichenRichtung.rechts)
                End If
                If Weiche21schalten = True Then             ' *** Weiche 21 vorschalten 09.10.2021
                    _eb.weicheSchalten(21, Klassen.WeichenRichtung.rechts)
                End If
                Button71.BackColor = Drawing.Color.LightYellow
                Zug1(anfahren)
                AutomatikParameter = 106
                If _Kamera = 3 And _aktuelleKamera <> Forbach Then
                    _Webcams.SetWebcam(0, Forbach)
                    SetText(Button13, "Hinterzarten")
                    _aktuelleKamera = Forbach
                End If
            ElseIf Ort_Lok1 = 112 Then
                ' ***
                ' *** Zug 1 steht auf dem Berg
                ' ***
                Button61.BackColor = Drawing.Color.LightYellow
                Stufe3 = _LokStufen.Holen(NumericUpDown8.Value, 3)
                Stufe4 = _LokStufen.Holen(NumericUpDown8.Value, 4)
                If Stufe4 < Stufe3 Then
                    _LokStufen.EinzelLokSenden(1, 4)
                Else
                    _LokStufen.EinzelLokSenden(1, 3)
                End If
                AutomatikParameter = 115
                A_StopB = 0
            ElseIf Ort_Lok1 = 120 Then
                ' ***
                ' *** Zug 1 steht vor Signal 12 (Talfahrt)
                ' ***
                Button91.BackColor = Drawing.Color.LightYellow
                If Weiche21schalten = True Then
                    _eb.weicheSchalten(21, Klassen.WeichenRichtung.rechts)
                End If
                If Weiche26schalten = True Then
                    _eb.weicheSchalten(26, Klassen.WeichenRichtung.rechts)
                End If
                If Weiche23schalten = True Then
                    _eb.weicheSchalten(23, Klassen.WeichenRichtung.links)
                End If
                _eb.weicheSchalten(12, Klassen.WeichenRichtung.links)
                _LokStufen.EinzelLokSenden(1, 3)
                AutomatikParameter = 120
            End If
        Else
            Zyklusende()
        End If

        If ComboBox1.SelectedIndex = 5 Then
            If _Bhf_Gleis1 <> 0 Then
                If Ort_Lok1 = 100 Then
                    BeleuchtungSchalten()
                End If
            Else
                If _Bhf2_Gleis1 <> 0 And _Route_Gleis1 = 2 Then
                    If Ort_Lok1 = 105 Then
                        BeleuchtungSchalten()
                    End If
                Else
                    If _SBhf_Gleis1 <> 0 And (_Route_Gleis1 = 0 Or _Route_Gleis1 = 2) Then
                        If Ort_Lok1 = 102 Then
                            BeleuchtungSchalten()
                        End If
                    Else
                        If _Berg_Gleis1 <> 0 And (_Route_Gleis1 = 1 Or _Route_Gleis1 = 2) Then
                            If Ort_Lok1 = 112 Then
                                BeleuchtungSchalten()
                            End If
                        Else
                            If Diagonale_Gleis1 <> 0 And _Route_Gleis1 = 2 Then
                                If Ort_Lok1 = 103 Then
                                    BeleuchtungSchalten()
                                End If
                            Else
                                If Talstrecke_Gleis1 <> 0 And (_Route_Gleis1 = 1 Or _Route_Gleis1 = 2) Then
                                    If Ort_Lok1 = 120 Then
                                        BeleuchtungSchalten()
                                    End If
                                End If
                            End If
                        End If
                    End If
                End If
            End If
        End If
    End Sub
    Private Sub HandleTimerElapsed14(sender As System.Object, e As System.EventArgs) Handles Timer_EinzelLok2.Elapsed
        If Me.InvokeRequired Then
            Me.Invoke(Sub() HandleTimerElapsed14(sender, e))
            Return
        End If
        ' ***
        ' *** Datum: 19.01.2021
        ' ***
        Dim Stufe3, Stufe4 As Integer
        Timer_EinzelLok2.Stop()
        _StopZug2 = 0
        A_StopB = 0
        If A_StopH = 0 Then
            _AutomatikParameterH = 0
            If Ort_Lok2 = 0 Then                     ' Zug 2 steht vor Signal 7 im Bahnhof <-- (Erstfahrt nach Start)
                ' ***
                ' *** Zug 2 steht im Bahnhof (Erstfahrt nach Start)
                ' ***
                _eb.weicheSchalten(23, Klassen.WeichenRichtung.links)
                _eb.weicheSchalten(21, Klassen.WeichenRichtung.links)
                If _Bhf_Gleis2 = 0 Then
                    Button32.BackColor = Drawing.Color.LightGreen
                Else
                    Button32.BackColor = Drawing.Color.LightYellow
                End If
                If _Route_Gleis2 = 0 Then
                    _eb.weicheSchalten(17, Klassen.WeichenRichtung.links)
                ElseIf _Route_Gleis2 = 1 Then
                    _eb.weicheSchalten(17, Klassen.WeichenRichtung.rechts)
                    _eb.weicheSchalten(27, Klassen.WeichenRichtung.rechts)
                ElseIf _Route_Gleis2 = 2 Then
                    _eb.weicheSchalten(17, Klassen.WeichenRichtung.links)
                    _eb.weicheSchalten(19, Klassen.WeichenRichtung.rechts)   ' *** Weiche 19 vorschalten 09.10.2021
                End If
                If _Route_Gleis2 = 1 Then
                Else
                    If _SBhf_Gleis2 > 0 Then
                        _eb.weicheSchalten(11, Klassen.WeichenRichtung.rechts)
                    Else
                        _eb.weicheSchalten(11, Klassen.WeichenRichtung.links)
                    End If
                End If
                Zug2(anfahren)
                AutomatikParameter = 200
            ElseIf Ort_Lok2 = 200 Then                 ' Zug 2 steht vor Signal 7 im Bahnhof <--
                ' ***
                ' *** Zug 2 steht im Bahnhof < --
                ' ***
                Button32.BackColor = Drawing.Color.LightYellow
                If Weiche17schalten = True Then
                    If _Route_Gleis2 = 0 Then
                        _eb.weicheSchalten(17, Klassen.WeichenRichtung.links)
                    ElseIf _Route_Gleis2 = 1 Then
                        _eb.weicheSchalten(17, Klassen.WeichenRichtung.rechts)
                    ElseIf _Route_Gleis2 = 2 Then
                        _eb.weicheSchalten(17, Klassen.WeichenRichtung.links)
                    End If
                End If
                If Weiche19schalten = True Then         ' *** Weiche 19 vorschalten 09.10.21
                    If _Route_Gleis2 = 2 Then
                        _eb.weicheSchalten(19, Klassen.WeichenRichtung.rechts)
                    End If
                End If
                'If Weiche21schalten = True Then         ' *** Weiche 21 vorschalten 09.10.21
                '    If _Route_Gleis2 = 0 And (_SBhf_Gleis2 = 0 Or _SBhf_Gleis2 = 2) Then
                '        _eb.weicheSchalten(21, Klassen.WeichenRichtung.links)
                '    End If
                '    If _Route_Gleis2 = 1 Then
                '        _eb.weicheSchalten(21, Klassen.WeichenRichtung.links)
                '    End If
                '    If _Route_Gleis2 = 2 And (_SBhf_Gleis2 = 0 Or _SBhf_Gleis2 = 2) Then
                '        _eb.weicheSchalten(21, Klassen.WeichenRichtung.links)
                '    End If
                'End If
                If Weiche27schalten = True Then
                    If _Route_Gleis2 > 0 Then
                        _eb.weicheSchalten(27, Klassen.WeichenRichtung.rechts)
                    End If
                End If
                If _Route_Gleis2 = 1 Then
                Else               ' SBHF kann durch Zug 1 belegt sein !
                    If _SBhf_Gleis2 > 0 Then
                        _eb.weicheSchalten(11, Klassen.WeichenRichtung.rechts)
                    Else
                        _eb.weicheSchalten(11, Klassen.WeichenRichtung.links)
                    End If
                End If
                If _Kamera = 3 And _aktuelleKamera <> Marxzel Then
                    _Webcams.SetWebcam(0, Marxzel)
                    SetText(Button13, "Wiehre")
                    _aktuelleKamera = Marxzel
                End If
                Zug2(anfahren)
                AutomatikParameter = 200
            ElseIf Ort_Lok2 = 202 Then                    ' Zug 2 steht vor Signal 11 im Schattenbahnhof
                Button52.BackColor = Drawing.Color.LightYellow
                If _Route_Gleis2 = 0 Then
                    AutomatikParameter = 220
                ElseIf _Route_Gleis2 = 1 Then
                    AutomatikParameter = 220
                ElseIf _Route_Gleis2 = 2 Then
                    AutomatikParameter = 202
                End If
                If Weiche21schalten = True Then
                    _eb.weicheSchalten(21, Klassen.WeichenRichtung.links)
                End If
                If Weiche23schalten = True Then
                    If _Route_Gleis2 = 0 Then
                        _eb.weicheSchalten(23, Klassen.WeichenRichtung.links)
                    ElseIf _Route_Gleis2 = 1 Then
                        _eb.weicheSchalten(23, Klassen.WeichenRichtung.links)
                    ElseIf _Route_Gleis2 = 2 Then
                        _eb.weicheSchalten(23, Klassen.WeichenRichtung.rechts)
                    End If
                End If
                _eb.weicheSchalten(11, Klassen.WeichenRichtung.links)
                _LokStufen.EinzelLokSenden(2, 3)
            ElseIf Ort_Lok2 = 203 Then                   ' Zug 2 steht vor Signal 10 (Diagonale)
                Button82.BackColor = Drawing.Color.LightYellow
                _eb.weicheSchalten(10, Klassen.WeichenRichtung.links)
                If Weiche14schalten = True Then
                    _eb.weicheSchalten(14, Klassen.WeichenRichtung.links)
                End If
                If Weiche19schalten = True Then
                    _eb.weicheSchalten(19, Klassen.WeichenRichtung.rechts)
                End If
                AutomatikParameter = 203
            ElseIf Ort_Lok2 = 205 Then                   ' Zug 2 steht vor Signal 8 im Bahnhof -->
                Button72.BackColor = Drawing.Color.LightYellow
                If Weiche27schalten = True Then
                    _eb.weicheSchalten(27, Klassen.WeichenRichtung.rechts)
                End If
                If Weiche21schalten = True Then             ' *** Weiche 21 vorschalten 09.10.2021
                    _eb.weicheSchalten(21, Klassen.WeichenRichtung.rechts)
                End If
                Zug2(anfahren)
                AutomatikParameter = 206
                If _Kamera = 3 And _aktuelleKamera <> Forbach Then
                    _Webcams.SetWebcam(0, Forbach)
                    SetText(Button13, "Hinterzarten")
                    _aktuelleKamera = Forbach
                End If
            ElseIf Ort_Lok2 = 212 Then                   ' Zug 2 steht auf dem Berg
                Button62.BackColor = Drawing.Color.LightYellow
                Stufe3 = _LokStufen.Holen(NumericUpDown9.Value, 3)
                Stufe4 = _LokStufen.Holen(NumericUpDown9.Value, 4)
                If Stufe4 < Stufe3 Then
                    _LokStufen.EinzelLokSenden(2, 4)
                Else
                    _LokStufen.EinzelLokSenden(2, 3)
                End If
                AutomatikParameter = 215
                A_StopB = 0
            ElseIf Ort_Lok2 = 220 Then                   ' Zug 2 steht vor Signal 12 (Talfahrt)
                Button92.BackColor = Drawing.Color.LightYellow
                If Weiche23schalten = True Then
                    _eb.weicheSchalten(23, Klassen.WeichenRichtung.links)
                End If
                If Weiche26schalten = True Then
                    _eb.weicheSchalten(26, Klassen.WeichenRichtung.rechts)
                End If
                If Weiche27schalten = True Then
                    _eb.weicheSchalten(21, Klassen.WeichenRichtung.links)
                End If
                _eb.weicheSchalten(12, Klassen.WeichenRichtung.links)
                _LokStufen.EinzelLokSenden(2, 3)
                AutomatikParameter = 220
            End If
        Else
            Zyklusende()
        End If

        If ComboBox1.SelectedIndex = 5 Then
            If _Bhf_Gleis2 <> 0 Then
                If Ort_Lok2 = 200 Then
                    BeleuchtungSchalten()
                End If
            Else
                If _Bhf2_Gleis2 <> 0 And _Route_Gleis2 = 2 Then
                    If Ort_Lok2 = 205 Then
                        BeleuchtungSchalten()
                    End If
                Else
                    If _SBhf_Gleis2 <> 0 And (_Route_Gleis2 = 0 Or _Route_Gleis2 = 2) Then
                        If Ort_Lok2 = 202 Then
                            BeleuchtungSchalten()
                        End If
                    Else
                        If _Berg_Gleis2 <> 0 And (_Route_Gleis2 = 1 Or _Route_Gleis2 = 2) Then
                            If Ort_Lok2 = 212 Then
                                BeleuchtungSchalten()
                            End If
                        Else
                            If Diagonale_Gleis2 <> 0 And _Route_Gleis2 = 2 Then
                                If Ort_Lok2 = 203 Then
                                    BeleuchtungSchalten()
                                End If
                            Else
                                If Talstrecke_Gleis2 <> 0 And (_Route_Gleis2 = 1 Or _Route_Gleis2 = 2) Then
                                    If Ort_Lok2 = 220 Then
                                        BeleuchtungSchalten()
                                    End If
                                End If
                            End If
                        End If
                    End If
                End If
            End If
        End If
    End Sub
    Private Sub HandleTimerElapsed15(sender As System.Object, e As System.EventArgs) Handles Timer_EinzelLok3.Elapsed
        If Me.InvokeRequired Then
            Me.Invoke(Sub() HandleTimerElapsed15(sender, e))
            Return
        End If
        ' ***
        ' *** Datum: 17.02.2020
        ' ***
        Dim Stufe3, Stufe4 As Integer
        Signal9schalten = True
        Timer_EinzelLok3.Stop()
        _StopZug3 = 0
        A_StopB = 0
        If A_StopH = 0 Then
            _AutomatikParameterH = 0
            If Betriebsart = 1 Then
                Zug3(anfahren)
                Button33.BackColor = Drawing.Color.LightYellow
            Else
                If Ort_Lok3 = 0 Then
                    ' ***
                    ' *** Zug 3 steht im Bahnhof (Erstfahrt nach Start)
                    ' ***
                    _eb.weicheSchalten(20, Klassen.WeichenRichtung.links)
                    If Weiche27schalten = True Then
                        If _Route_Gleis3 = 0 Then
                            _eb.weicheSchalten(27, Klassen.WeichenRichtung.links)
                        ElseIf _Route_Gleis3 = 1 Then
                            _eb.weicheSchalten(27, Klassen.WeichenRichtung.rechts)
                        ElseIf _Route_Gleis3 = 2 Then
                            _eb.weicheSchalten(27, Klassen.WeichenRichtung.rechts)
                        End If
                    End If
                    Zug3(anfahren)
                    AutomatikParameter = 300
                    If _Bhf_Gleis3 = 0 Then
                        Button33.BackColor = Drawing.Color.LightGreen
                    Else
                        Button33.BackColor = Drawing.Color.LightYellow
                    End If

                ElseIf Ort_Lok3 = 300 Then                  ' Zug 3 steht im Bahnhof -->
                    Button33.BackColor = Drawing.Color.LightYellow
                    If Weiche27schalten = True Then
                        If _Route_Gleis3 = 0 Then
                            _eb.weicheSchalten(27, Klassen.WeichenRichtung.links)
                        ElseIf _Route_Gleis3 = 1 Then
                            _eb.weicheSchalten(27, Klassen.WeichenRichtung.rechts)
                        ElseIf _Route_Gleis3 = 2 Then
                            _eb.weicheSchalten(27, Klassen.WeichenRichtung.rechts)
                        End If
                    End If
                    ' *** Signal 9
                    Signal9schalten = True
                    If _Route_Gleis3 = 0 Then
                        Signal9schalten = True
                    ElseIf _Route_Gleis3 = 1 Then
                        Signal9schalten = False
                    ElseIf _Route_Gleis3 = 2 Then
                        Signal9schalten = False
                    End If
                    If Signal9schalten = True Then
                        If _SBhf_Gleis3 > 0 Then
                            _eb.weicheSchalten(9, Klassen.WeichenRichtung.rechts)
                        Else
                            _eb.weicheSchalten(9, Klassen.WeichenRichtung.links)
                        End If
                    End If
                    If _Kamera = 3 And _aktuelleKamera <> Forbach Then
                        _Webcams.SetWebcam(0, Forbach)
                        SetText(Button13, "Hinterzarten")
                        _aktuelleKamera = Forbach
                    End If
                    Zug3(anfahren)
                    AutomatikParameter = 300

                ElseIf Ort_Lok3 = 320 Or Ort_Lok3 = 301 Then
                    ' ***
                    ' *** Zug 3 steht im Schattenbahnhof
                    ' ***
                    Button53.BackColor = Drawing.Color.LightYellow
                    If Weiche20schalten = True Then
                        _eb.weicheSchalten(20, Klassen.WeichenRichtung.links)
                    End If
                    If _Betriebsart0_3Var = 0 Then
                        _eb.weicheSchalten(9, Klassen.WeichenRichtung.links)
                    Else
                        _eb.weicheSchalten(11, Klassen.WeichenRichtung.links)
                    End If
                    If _Betriebsart0_5Var = 0 Then
                        _eb.weicheSchalten(9, Klassen.WeichenRichtung.links)
                    Else
                        _eb.weicheSchalten(11, Klassen.WeichenRichtung.links)
                    End If
                    AutomatikParameter = 320
                    _LokStufen.EinzelLokSenden(3, 3)

                ElseIf Ort_Lok3 = 315 Then
                    ' ***
                    ' *** Zug 3 steht im Bahnhof <--
                    ' ***
                    Button73.BackColor = Drawing.Color.LightYellow

                    If Weiche17schalten = True Then
                        _eb.weicheSchalten(17, Klassen.WeichenRichtung.rechts)
                    End If
                    If Weiche27schalten = True Then
                        _eb.weicheSchalten(27, Klassen.WeichenRichtung.links)
                    End If
                    If _SBhf_Gleis3 = 0 Then
                        If _Betriebsart0_3Var = 0 Then
                            _eb.weicheSchalten(9, Klassen.WeichenRichtung.links)
                        Else
                            _eb.weicheSchalten(11, Klassen.WeichenRichtung.links)
                        End If
                    Else
                        If _Betriebsart0_3Var = 0 Then
                            _eb.weicheSchalten(9, Klassen.WeichenRichtung.rechts)
                        Else
                            _eb.weicheSchalten(11, Klassen.WeichenRichtung.rechts)
                        End If
                    End If
                    If _Kamera = 3 And _aktuelleKamera <> Marxzel Then
                        _Webcams.SetWebcam(0, Marxzel)
                        SetText(Button13, "Wiehre")
                        _aktuelleKamera = Marxzel
                    End If
                    Zug3(anfahren)
                    AutomatikParameter = 305

                ElseIf Ort_Lok3 = 312 Then
                    ' ***
                    ' *** Zug 3 steht auf dem Berg
                    ' ***
                    Button63.BackColor = Drawing.Color.LightYellow
                    Stufe3 = _LokStufen.Holen(NumericUpDown10.Value, 3)
                    Stufe4 = _LokStufen.Holen(NumericUpDown10.Value, 4)
                    If Stufe4 < Stufe3 Then
                        _LokStufen.EinzelLokSenden(3, 4)
                    Else
                        _LokStufen.EinzelLokSenden(3, 3)
                    End If
                    AutomatikParameter = 315
                    A_StopB = 0

                ElseIf Ort_Lok3 = 310 Then
                    ' ***
                    ' *** Zug 3 steht vor Signal 10 (Diagonale)
                    ' ***
                    Button83.BackColor = Drawing.Color.LightYellow
                    If Weiche14schalten = True Then
                        _eb.weicheSchalten(14, Klassen.WeichenRichtung.rechts)
                    End If
                    If Weiche20schalten = True Then
                        _eb.weicheSchalten(20, Klassen.WeichenRichtung.links)
                    End If
                    _eb.weicheSchalten(10, Klassen.WeichenRichtung.links)
                    AutomatikParameter = 320
                ElseIf Ort_Lok3 = 313 Then
                    ' ***
                    ' *** Zug 3 steht vor Signal 12 (Talfahrt)
                    ' ***
                    Button93.BackColor = Drawing.Color.LightYellow
                    If _Route_Gleis3 = 0 Then
                        AutomatikParameter = 317
                    ElseIf _Route_Gleis3 = 1 Then
                        If Diagonale_Gleis3 = 1 Then
                            _eb.weicheSchalten(10, Klassen.WeichenRichtung.rechts)
                        End If
                        AutomatikParameter = 310
                    ElseIf _Route_Gleis3 = 2 Then
                        AutomatikParameter = 317
                    End If

                    If Weiche23schalten = True Then
                        _eb.weicheSchalten(23, Klassen.WeichenRichtung.rechts)
                    End If
                    If Weiche26schalten = True Then
                        If _Route_Gleis3 = 0 Then
                            _eb.weicheSchalten(26, Klassen.WeichenRichtung.rechts)
                        ElseIf _Route_Gleis3 = 1 Then
                            _eb.weicheSchalten(26, Klassen.WeichenRichtung.rechts)
                        ElseIf _Route_Gleis3 = 2 Then
                            _eb.weicheSchalten(26, Klassen.WeichenRichtung.links)
                        End If
                    End If
                    If Weiche22schalten = True Then
                        _eb.weicheSchalten(22, Klassen.WeichenRichtung.rechts)
                    End If
                    _eb.weicheSchalten(12, Klassen.WeichenRichtung.links)
                    _LokStufen.EinzelLokSenden(3, 3)
                End If
            End If
        Else
            Zyklusende()
        End If

        If ComboBox1.SelectedIndex = 5 Then
            If _Bhf_Gleis3 <> 0 Then
                If Ort_Lok3 = 300 Then
                    BeleuchtungSchalten()
                End If
            Else
                If _Bhf2_Gleis3 <> 0 And _Route_Gleis3 = 2 Then
                    If Ort_Lok3 = 315 Then
                        BeleuchtungSchalten()
                    End If
                Else
                    If _SBhf_Gleis3 <> 0 And (_Route_Gleis3 = 0 Or _Route_Gleis3 = 2) Then
                        If Ort_Lok3 = 320 Or Ort_Lok3 = 301 Then
                            BeleuchtungSchalten()
                        End If
                    Else
                        If _Berg_Gleis3 <> 0 And (_Route_Gleis3 = 1 Or _Route_Gleis3 = 2) Then
                            If Ort_Lok3 = 312 Then
                                BeleuchtungSchalten()
                            End If
                        Else
                            If Diagonale_Gleis3 <> 0 And _Route_Gleis3 = 1 Then
                                If Ort_Lok3 = 310 Then
                                    BeleuchtungSchalten()
                                End If
                            Else
                                If Talstrecke_Gleis3 <> 0 And (_Route_Gleis3 = 1 Or _Route_Gleis3 = 2) Then
                                    If Ort_Lok3 = 313 Then
                                        BeleuchtungSchalten()
                                    End If
                                End If
                            End If
                        End If
                    End If
                End If
            End If
        End If
    End Sub
    Private Sub HandleTimerElapsed16(sender As System.Object, e As System.EventArgs) Handles Timer_EinzelLok4.Elapsed
        If Me.InvokeRequired Then
            Me.Invoke(Sub() HandleTimerElapsed16(sender, e))
            Return
        End If
        ' ***
        ' *** Datum: 17.02.2020
        ' ***
        Dim Stufe3, Stufe4 As Integer

        Signal9schalten = True

        Timer_EinzelLok4.Stop()
        _StopZug4 = 0
        A_StopB = 0
        If A_StopH = 0 Then
            _AutomatikParameterH = 0
            If Betriebsart = 1 Then
                Zug4(anfahren)
                Button34.BackColor = Drawing.Color.LightYellow
            Else
                If Ort_Lok4 = 0 Then                        ' Zug 4 steht im Bahnhof (Erstfahrt nach Start)
                    _eb.weicheSchalten(20, Klassen.WeichenRichtung.rechts)
                    If Weiche27schalten = True Then
                        If _Route_Gleis4 = 0 Then
                            _eb.weicheSchalten(27, Klassen.WeichenRichtung.links)
                        ElseIf _Route_Gleis4 = 1 Then
                            _eb.weicheSchalten(27, Klassen.WeichenRichtung.rechts)
                        ElseIf _Route_Gleis4 = 2 Then
                            _eb.weicheSchalten(27, Klassen.WeichenRichtung.rechts)
                        End If
                    End If
                    Zug4(anfahren)
                    AutomatikParameter = 400
                    If _Bhf_Gleis4 = 0 Then
                        Button34.BackColor = Drawing.Color.LightGreen
                    Else
                        Button34.BackColor = Drawing.Color.LightYellow
                    End If
                ElseIf Ort_Lok4 = 400 Then                      ' Zug 4 steht im Bahnhof -->
                    Button34.BackColor = Drawing.Color.LightYellow
                    ' *** Weiche 27
                    If Weiche27schalten = True Then
                        If _Route_Gleis4 = 0 Then
                            _eb.weicheSchalten(27, Klassen.WeichenRichtung.links)
                        ElseIf _Route_Gleis4 = 1 Then
                            _eb.weicheSchalten(27, Klassen.WeichenRichtung.rechts)
                        ElseIf _Route_Gleis4 = 2 Then
                            _eb.weicheSchalten(27, Klassen.WeichenRichtung.rechts)
                        End If
                    End If
                    ' *** Signal 9
                    Signal9schalten = True
                    If _Route_Gleis4 = 0 Then
                        Signal9schalten = True
                    ElseIf _Route_Gleis4 = 1 Then
                        Signal9schalten = False
                    ElseIf _Route_Gleis4 = 2 Then
                        Signal9schalten = False
                    End If
                    If Signal9schalten = True Then
                        If _SBhf_Gleis4 > 0 Then
                            _eb.weicheSchalten(9, Klassen.WeichenRichtung.rechts)
                        Else
                            _eb.weicheSchalten(9, Klassen.WeichenRichtung.links)
                        End If
                    End If
                    If _Kamera = 3 And _aktuelleKamera <> Forbach Then
                        _Webcams.SetWebcam(0, Forbach)
                        SetText(Button13, "Hinterzarten")
                        _aktuelleKamera = Forbach
                    End If
                    Zug4(anfahren)
                    AutomatikParameter = 400
                ElseIf Ort_Lok4 = 402 Then    'Zug 4 steht im Schattenbahnhof vor Signal 11 (Betriebsart 0-4 Variante 2)

                    Button54.BackColor = Drawing.Color.LightYellow
                    AutomatikParameter = 420
                    _eb.weicheSchalten(11, Klassen.WeichenRichtung.links)
                    _LokStufen.EinzelLokSenden(4, 3)

                ElseIf Ort_Lok4 = 420 Or Ort_Lok4 = 401 Then    'Zug 4 steht im Schattenbahnhof
                    Button54.BackColor = Drawing.Color.LightYellow
                    If Weiche20schalten = True Then
                        _eb.weicheSchalten(20, Klassen.WeichenRichtung.rechts)
                    End If
                    If _Betriebsart0_4Var = 0 Then
                        _eb.weicheSchalten(9, Klassen.WeichenRichtung.links)
                    Else
                        _eb.weicheSchalten(11, Klassen.WeichenRichtung.links)
                    End If
                    If _Betriebsart0_5Var = 0 Then
                        _eb.weicheSchalten(9, Klassen.WeichenRichtung.links)
                    Else
                        _eb.weicheSchalten(11, Klassen.WeichenRichtung.links)
                    End If
                    AutomatikParameter = 420
                    _LokStufen.EinzelLokSenden(4, 3)
                ElseIf Ort_Lok4 = 415 Then                      'Zug 4 steht im Bahnhof <--
                    Button74.BackColor = Drawing.Color.LightYellow
                    If Weiche17schalten = True Then
                        _eb.weicheSchalten(17, Klassen.WeichenRichtung.rechts)
                    End If
                    If Weiche27schalten = True Then
                        _eb.weicheSchalten(27, Klassen.WeichenRichtung.links)
                    End If
                    If _SBhf_Gleis4 = 0 Then
                        _eb.weicheSchalten(9, Klassen.WeichenRichtung.links)
                    Else
                        _eb.weicheSchalten(9, Klassen.WeichenRichtung.rechts)
                    End If
                    If _Kamera = 3 And _aktuelleKamera <> Marxzel Then
                        _Webcams.SetWebcam(0, Marxzel)
                        SetText(Button13, "Wiehre")
                        _aktuelleKamera = Marxzel
                    End If
                    Zug4(anfahren)
                    AutomatikParameter = 405

                ElseIf Ort_Lok4 = 412 Then                      ' Zug 4 steht auf dem Berg
                    Button64.BackColor = Drawing.Color.LightYellow
                    Stufe3 = _LokStufen.Holen(NumericUpDown11.Value, 3)
                    Stufe4 = _LokStufen.Holen(NumericUpDown11.Value, 4)
                    If Stufe4 < Stufe3 Then
                        _LokStufen.EinzelLokSenden(4, 4)
                    Else
                        _LokStufen.EinzelLokSenden(4, 3)
                    End If
                    AutomatikParameter = 415
                    A_StopB = 0

                ElseIf Ort_Lok4 = 410 Then
                    ' ***
                    ' *** Zug 4 steht vor Signal 10 (Diagonale)
                    ' ***
                    Button84.BackColor = Drawing.Color.LightYellow
                    If Weiche14schalten = True Then
                        _eb.weicheSchalten(14, Klassen.WeichenRichtung.rechts)
                    End If
                    If Weiche20schalten = True Then
                        _eb.weicheSchalten(20, Klassen.WeichenRichtung.rechts)
                    End If
                    _eb.weicheSchalten(10, Klassen.WeichenRichtung.links)
                    AutomatikParameter = 320

                ElseIf Ort_Lok4 = 413 Then
                    ' ***
                    ' *** Zug 4 steht vor Signal 12 (Talfahrt)
                    ' ***
                    Button94.BackColor = Drawing.Color.LightYellow
                    If _Route_Gleis4 = 0 Then
                        AutomatikParameter = 417
                    ElseIf _Route_Gleis4 = 1 Then
                        If Diagonale_Gleis4 = 1 Then
                            _eb.weicheSchalten(10, Klassen.WeichenRichtung.rechts)
                        End If
                        AutomatikParameter = 410
                    ElseIf _Route_Gleis4 = 2 Then
                        AutomatikParameter = 417
                    End If
                    If Weiche23schalten = True Then
                        _eb.weicheSchalten(23, Klassen.WeichenRichtung.rechts)
                    End If
                    If Weiche26schalten = True Then
                        If _Route_Gleis4 = 0 Then
                            _eb.weicheSchalten(26, Klassen.WeichenRichtung.rechts)
                        ElseIf _Route_Gleis4 = 1 Then
                            _eb.weicheSchalten(26, Klassen.WeichenRichtung.rechts)
                        ElseIf _Route_Gleis4 = 2 Then
                            _eb.weicheSchalten(26, Klassen.WeichenRichtung.links)
                        End If
                    End If
                    If Weiche22schalten = True Then
                        _eb.weicheSchalten(22, Klassen.WeichenRichtung.links)
                    End If
                    _eb.weicheSchalten(12, Klassen.WeichenRichtung.links)
                    _LokStufen.EinzelLokSenden(4, 3)
                End If
            End If
        Else
            Zyklusende()
        End If
        If ComboBox1.SelectedIndex = 5 Then
            If _Bhf_Gleis4 <> 0 Then
                If Ort_Lok4 = 400 Then
                    BeleuchtungSchalten()
                End If
            Else
                If _Bhf2_Gleis4 <> 0 And _Route_Gleis4 = 2 Then
                    If Ort_Lok4 = 415 Then
                        BeleuchtungSchalten()
                    End If
                Else
                    If _SBhf_Gleis4 <> 0 And (_Route_Gleis4 = 0 Or _Route_Gleis4 = 2) Then
                        If Ort_Lok4 = 420 Or Ort_Lok4 = 401 Then
                            BeleuchtungSchalten()
                        End If
                    Else
                        If _Berg_Gleis4 <> 0 And (_Route_Gleis4 = 1 Or _Route_Gleis4 = 2) Then
                            If Ort_Lok4 = 412 Then
                                BeleuchtungSchalten()
                            End If
                        Else
                            If Diagonale_Gleis4 <> 0 And _Route_Gleis4 = 1 Then
                                If Ort_Lok4 = 410 Then
                                    BeleuchtungSchalten()
                                End If
                            Else
                                If Talstrecke_Gleis4 <> 0 And (_Route_Gleis4 = 1 Or _Route_Gleis4 = 2) Then
                                    If Ort_Lok4 = 413 Then
                                        BeleuchtungSchalten()
                                    End If
                                End If
                            End If
                        End If
                    End If
                End If
            End If
        End If

    End Sub

    Private Sub HandleTimerElapsed17(sender As System.Object, e As System.EventArgs) Handles Timer_Music.Elapsed
        _Music_laeuft = 0
        If _StoryPointer = 106 Then
            StoryColor = Drawing.Color.LightGreen
        End If
        Timer_Music.Stop()
        If _StoryAuto = 0 Then
            StoryColor = Drawing.Color.LightGray
        Else
            StoryColor = Drawing.Color.LightBlue
        End If
    End Sub
    Private Sub HandleTimerElapsed20(sender As System.Object, e As System.EventArgs) Handles Timer_Story_Auto.Elapsed
        If _StoryAuto = 1 Then
            StoryProgress(DasKalteHerz.ProgressEvent.StepForward)
            StoryColor = Drawing.Color.LightBlue
        Else
            Timer_Story_Auto.Stop()
            StoryColor = Drawing.Color.LightGray
        End If
    End Sub
    Private Sub HandleTimerElapsed21(sender As System.Object, e As System.EventArgs) Handles Timer_DMX.Elapsed
        Dim Min, Schritt As Integer
        Min = 40
        'Schritt = S_DMX
        Schritt = 4

        Timer_DMX.Interval = 100

        If L1_soll > Min And L1_aktuell < Min Then
            L1_aktuell = Min
        End If
        If L2_soll > Min And L2_aktuell < Min Then
            L2_aktuell = Min
        End If
        If L3_soll > Min And L3_aktuell < Min Then
            L3_aktuell = Min
        End If
        If L4_soll > Min And L4_aktuell < Min Then
            L4_aktuell = Min
        End If
        If L5_soll > Min And L5_aktuell < Min Then
            L5_aktuell = Min
        End If
        If L6_soll > Min And L6_aktuell < Min Then
            L6_aktuell = Min
        End If
        If L7_soll > Min And L7_aktuell < Min Then
            L7_aktuell = Min
        End If

        If L1_aktuell > L1_soll + Schritt Then
            L1_aktuell = L1_aktuell - Schritt
        End If
        If L1_aktuell < L1_soll - Schritt Then
            L1_aktuell = L1_aktuell + Schritt
        End If
        If L2_aktuell > L2_soll + Schritt Then
            L2_aktuell = L2_aktuell - Schritt
        End If
        If L2_aktuell < L2_soll - Schritt Then
            L2_aktuell = L2_aktuell + Schritt
        End If
        If L3_aktuell > L3_soll + Schritt Then
            L3_aktuell = L3_aktuell - Schritt
        End If
        If L3_aktuell < L3_soll - Schritt Then
            L3_aktuell = L3_aktuell + Schritt
        End If
        If L4_aktuell > L4_soll + Schritt Then
            L4_aktuell = L4_aktuell - Schritt
        End If
        If L4_aktuell < L4_soll - Schritt Then
            L4_aktuell = L4_aktuell + Schritt
        End If
        If L5_aktuell > L5_soll + Schritt Then
            L5_aktuell = L5_aktuell - Schritt
        End If
        If L5_aktuell < L5_soll - Schritt Then
            L5_aktuell = L5_aktuell + Schritt
        End If
        If L6_aktuell > L6_soll + Schritt Then
            L6_aktuell = L6_aktuell - Schritt
        End If
        If L6_aktuell < L6_soll - Schritt Then
            L6_aktuell = L6_aktuell + Schritt
        End If
        If L7_aktuell > L7_soll + Schritt Then
            L7_aktuell = L7_aktuell - Schritt
        End If
        If L7_aktuell < L7_soll - Schritt Then
            L7_aktuell = L7_aktuell + Schritt
        End If

        If L1_aktuell > L1_soll Then
            L1_aktuell = L1_aktuell - 1
        End If
        If L1_aktuell < L1_soll Then
            L1_aktuell = L1_aktuell + 1
        End If
        If L2_aktuell > L2_soll Then
            L2_aktuell = L2_aktuell - 1
        End If
        If L2_aktuell < L2_soll Then
            L2_aktuell = L2_aktuell + 1
        End If
        If L3_aktuell > L3_soll Then
            L3_aktuell = L3_aktuell - 1
        End If
        If L3_aktuell < L3_soll Then
            L3_aktuell = L3_aktuell + 1
        End If
        If L4_aktuell > L4_soll Then
            L4_aktuell = L4_aktuell - 1
        End If
        If L4_aktuell < L4_soll Then
            L4_aktuell = L4_aktuell + 1
        End If
        If L5_aktuell > L5_soll Then
            L5_aktuell = L5_aktuell - 1
        End If
        If L5_aktuell < L5_soll Then
            L5_aktuell = L5_aktuell + 1
        End If
        If L6_aktuell > L6_soll Then
            L6_aktuell = L6_aktuell - 1
        End If
        If L6_aktuell < L6_soll Then
            L6_aktuell = L6_aktuell + 1
        End If
        If L7_aktuell > L7_soll Then
            L7_aktuell = L7_aktuell - 1
        End If
        If L7_aktuell < L7_soll Then
            L7_aktuell = L7_aktuell + 1
        End If

        If L1_aktuell < Min And L1_soll < Min Then
            L1_aktuell = 0
        End If
        If L2_aktuell < Min And L2_soll < Min Then
            L2_aktuell = 0
        End If
        If L3_aktuell < Min And L3_soll < Min Then
            L3_aktuell = 0
        End If
        If L4_aktuell < Min And L4_soll < Min Then
            L4_aktuell = 0
        End If
        If L5_aktuell < Min And L5_soll < Min Then
            L5_aktuell = 0
        End If
        If L6_aktuell < Min And L6_soll < Min Then
            L6_aktuell = 0
        End If
        If L7_aktuell < Min And L7_soll < Min Then
            L7_aktuell = 0
        End If

        _dmxServer.SetData(1, L1_aktuell)
        _dmxServer.SetData(2, L2_aktuell)
        _dmxServer.SetData(3, L3_aktuell)
        _dmxServer.SetData(4, L4_aktuell)
        _dmxServer.SetData(6, L5_aktuell)
        _dmxServer.SetData(7, L6_aktuell)
        _dmxServer.SetData(8, L7_aktuell)

        If L1_aktuell = L1_soll And L2_aktuell = L2_soll And L3_aktuell = L3_soll And L4_aktuell = L4_soll And L5_aktuell = L5_soll And L6_aktuell = L6_soll And L7_aktuell = L7_soll Then
            Timer_DMX.Stop()
        End If

    End Sub
    Private Sub HandleTimerElapsed96(sender As System.Object, e As System.EventArgs) Handles Timer_HUE.Elapsed
        Timer_HUE.Interval = 200
        If Hue_Aenderung = 2 Then
            Hue_Aenderung = 0
        End If
        If Hue_Aenderung = 0 Then
            If Col_soll <> Col_aktuell Then
                Hue_Aenderung = 1
            End If
            If CT_soll <> CT_aktuell Then
                Hue_Aenderung = 1
            End If
            If Sat_soll <> Sat_aktuell Then
                Hue_Aenderung = 1
            End If
            If Bri_soll <> Bri_aktuell Then
                Hue_Aenderung = 1
            End If
            If Hue_Control <> Hue_Control_aktuell Then
                Hue_Aenderung = 1
            End If
            If _Hue_Reset = 1 Then
                Hue_Aenderung = 1
                _Hue_Reset = 0
            End If
        End If

        Hue_Takt = Hue_Takt + 1
        If Hue_Takt > 16 Then
            Hue_Takt = 0
        End If

        If Hue_Aenderung = 1 Then
            If Hue_Takt = 1 Then
                _HueBridge = Hue.HueBridgeLocator.Locate()
                _HueLight = _HueBridge.GetLight(HueLightName)
            ElseIf Hue_Takt = 4 Then
                If Hue_Control = 0 Then
                    _HueBridge.SetLightOnOff(_HueLight, False)
                Else
                    _HueBridge.SetLightOnOff(_HueLight, True)
                End If
                Hue_Control_aktuell = Hue_Control
            ElseIf Hue_Takt = 8 Then
                If Hue_Control = 1 Or Hue_Control = 4 Then
                    _HueBridge.SetLightCT(_HueLight, CT_soll)
                    CT_aktuell = CT_soll
                    _HueBridge.SetLight(_HueLight, bri:=Bri_soll)
                    Bri_aktuell = Bri_soll
                End If
            ElseIf Hue_Takt = 12 Then
                If Hue_Control = 2 Then
                    _HueBridge.SetLight(_HueLight, hue:=Col_soll)
                    Col_aktuell = Col_soll
                    _HueBridge.SetLight(_HueLight, sat:=Sat_soll)
                    Sat_aktuell = Sat_soll
                    _HueBridge.SetLight(_HueLight, bri:=Bri_soll)
                    Bri_aktuell = Bri_soll
                End If
            ElseIf Hue_Takt = 3 Then
                Hue_Aenderung = 2
                '_Hue_Reset = 0
            End If
        End If
    End Sub

    ' *** Lokprogramme

    Private Sub HandleTimerElapsed22(sender As System.Object, e As System.EventArgs) Handles Prog_Lok10.Elapsed

        '*** Fahrprogramm TEE VT 11.5
        '*** Datum: 05.01.2023

        SetText(TextBox1, "TEE VT 11.5                                                             IBS: 29.12.2025 - V3 : 8")
        LoadImage(PictureBox1, "H:\\EB_Media\\LokFotos\\Baureihe_TEE_01.jpg")
        GeschwindikeitenSetzen(10)
        Dim Stufe1, Stufe2, Stufe3, Stufe4 As Integer
        Dim Stufe11, Stufe12, Stufe13, Stufe14, Stufe21, Stufe22, Stufe23, Stufe24 As Integer
        Dim V_100, V_130, V_160, V_180, V_500 As Integer
        Dim T_100, T_130, T_160, T_180, T_500 As Integer
        Dim G_200 As Integer
        'Dim Index As Integer
        'Index = 10 + 4

        'T_100 = Betriebsparameter.GetValue("Fahrparameter", 4, Index)
        'T_130 = Betriebsparameter.GetValue("Fahrparameter", 5, Index)
        'T_160 = Betriebsparameter.GetValue("Fahrparameter", 6, Index)
        'T_180 = Betriebsparameter.GetValue("Fahrparameter", 7, Index)
        'T_500 = Betriebsparameter.GetValue("Fahrparameter", 8, Index)
        'V_100 = Betriebsparameter.GetValue("Fahrparameter", 9, Index)
        'V_130 = Betriebsparameter.GetValue("Fahrparameter", 10, Index)
        'V_160 = Betriebsparameter.GetValue("Fahrparameter", 11, Index)
        'V_180 = Betriebsparameter.GetValue("Fahrparameter", 12, Index)
        'V_500 = Betriebsparameter.GetValue("Fahrparameter", 13, Index)
        'G_200 = Betriebsparameter.GetValue("Fahrparameter", 14, Index)

        T_100 = _Betriebsparameter.Fahrparameter(10, KlausEBspecific.Betriebsparameter.FahrparameterEnum.T_100)
        T_130 = _Betriebsparameter.Fahrparameter(10, KlausEBspecific.Betriebsparameter.FahrparameterEnum.T_130)
        T_160 = _Betriebsparameter.Fahrparameter(10, KlausEBspecific.Betriebsparameter.FahrparameterEnum.T_160)
        T_180 = _Betriebsparameter.Fahrparameter(10, KlausEBspecific.Betriebsparameter.FahrparameterEnum.T_180)
        T_500 = _Betriebsparameter.Fahrparameter(10, KlausEBspecific.Betriebsparameter.FahrparameterEnum.T_500)
        V_100 = _Betriebsparameter.Fahrparameter(10, KlausEBspecific.Betriebsparameter.FahrparameterEnum.V_100)
        V_130 = _Betriebsparameter.Fahrparameter(10, KlausEBspecific.Betriebsparameter.FahrparameterEnum.V_130)
        V_160 = _Betriebsparameter.Fahrparameter(10, KlausEBspecific.Betriebsparameter.FahrparameterEnum.V_160)
        V_180 = _Betriebsparameter.Fahrparameter(10, KlausEBspecific.Betriebsparameter.FahrparameterEnum.V_180)
        V_500 = _Betriebsparameter.Fahrparameter(10, KlausEBspecific.Betriebsparameter.FahrparameterEnum.V_500)
        G_200 = _Betriebsparameter.Fahrparameter(10, KlausEBspecific.Betriebsparameter.FahrparameterEnum.G_200)

        If A_StopB = 1 Then
            V_100 = 8000
        End If

        Stufe1 = _LokStufen.Holen(10, 1)
        Stufe2 = _LokStufen.Holen(10, 2)
        Stufe3 = _LokStufen.Holen(10, 3)
        Stufe4 = _LokStufen.Holen(10, 4)

        If Stufe2 = 1 Then
            T_100 = T_100
            T_130 = T_130
            T_160 = T_160
            V_180 = V_180
        ElseIf Stufe2 = 2 Then
            T_100 = T_100 + 200
            T_130 = T_130 + 200
            T_160 = T_160 + 200
            V_180 = V_180 + 350
        ElseIf Stufe2 = 3 Then
            T_100 = T_100 + 500
            T_130 = T_130 + 500
            T_160 = T_160 + 500
            V_180 = V_180 + 700
        ElseIf Stufe2 = 4 Then
            T_100 = T_100 + 800
            T_130 = T_130 + 800
            T_160 = T_160 + 800
            V_180 = V_180 + 1000
        ElseIf Stufe2 = 5 Then
            T_100 = T_100 + 1100
            T_130 = T_130 + 1100
            T_160 = T_160 + 1100
            V_180 = V_180 + 1350
        ElseIf Stufe2 = 6 Then
            T_100 = T_100 + 1300
            T_130 = T_130 + 1300
            T_160 = T_160 + 1300
            V_180 = V_180 + 1700
        Else
            T_100 = T_100 + 1300
            T_130 = T_130 + 1300
            T_160 = T_160 + 1300
            V_180 = V_180 + 2000
        End If

        Stufe2 = Stufe1

        Stufe11 = Stufe1 + 1
        If Stufe11 > Stufe3 Then
            Stufe11 = Stufe3
        End If
        Stufe12 = Stufe1 + 2
        If Stufe12 > Stufe3 Then
            Stufe12 = Stufe3
        End If
        Stufe13 = Stufe1 + 3
        If Stufe13 > Stufe3 Then
            Stufe13 = Stufe3
        End If
        Stufe14 = Stufe1 + 4
        If Stufe14 > Stufe3 Then
            Stufe14 = Stufe3
        End If

        Stufe21 = Stufe2 + 1
        If Stufe21 > Stufe3 Then
            Stufe21 = Stufe3
        End If
        Stufe22 = Stufe2 + 2
        If Stufe22 > Stufe3 Then
            Stufe22 = Stufe3
        End If
        Stufe23 = Stufe2 + 3
        If Stufe23 > Stufe3 Then
            Stufe23 = Stufe3
        End If
        Stufe24 = Stufe2 + 4
        If Stufe24 > Stufe3 Then
            Stufe24 = Stufe3
        End If
        If G_200 > 0 Then
            If G_200 < Stufe4 Then
                G_200 = Stufe4
            End If
        Else
            G_200 = Stufe4
        End If

        If Betriebsart = 1 And (_GlsL10 = 3 Or _GlsL10 = 4) Then
            SetProgramCounterLabel1(_Prog10)
        Else
            SetProgramCounterLabel(_Prog10)
        End If

        ' Lok starten - Bahnhofsausfahrt

        If _Prog10 = 0 Then
            Prog_Lok10.Interval = 2000
            If _Fahrzeugbeleuchtung2 > 0 Then
                _eb.lokSteuern(10, Klassen.LokEigenschaften.Hauptfunktion, 1) ' Licht ein
            End If
        ElseIf _Prog10 = 1 Then
            _Betriebsparameter.RundenErhoehen(10)
        ElseIf _Prog10 = 2 Then
            If _Motor > 0 Then
                _eb.lokSteuern(10, Klassen.LokEigenschaften.Funktion1, 1) ' Motor ein
            Else
                _Prog10 = 8
            End If
        ElseIf _Prog10 = 3 Then
        ElseIf _Prog10 = 4 Then
        ElseIf _Prog10 = 5 Then
        ElseIf _Prog10 = 6 Then
        ElseIf _Prog10 = 7 Then
        ElseIf _Prog10 = 8 Then
        ElseIf _Prog10 = 9 Then
            If _Innenbeleuchtung2 > 0 Then
                _eb.lokSteuern(10, Klassen.LokEigenschaften.Funktion2, 1) ' Innenbeleuchtung ein
            End If
        ElseIf _Prog10 = 10 Then
        ElseIf _Prog10 = 11 Then
            If _AkustischeSignale > 0 Then
                _eb.lokSteuern(10, Klassen.LokEigenschaften.Funktion3, 1) ' Pfiff ein
            End If
        ElseIf _Prog10 = 12 Then
            _eb.lokSteuern(10, Klassen.LokEigenschaften.Funktion3, 0) ' Pfiff aus
        ElseIf _Prog10 = 13 Then
            _eb.lokSteuern(10, Klassen.LokEigenschaften.Geschwindigkeit, Stufe1)
        ElseIf _Prog10 = 14 Then
            _eb.lokSteuern(10, Klassen.LokEigenschaften.Geschwindigkeit, Stufe11)
        ElseIf _Prog10 = 15 Then
            _eb.lokSteuern(10, Klassen.LokEigenschaften.Geschwindigkeit, Stufe12)
        ElseIf _Prog10 = 16 Then
            _eb.lokSteuern(10, Klassen.LokEigenschaften.Geschwindigkeit, Stufe13)
        ElseIf _Prog10 = 17 Then
            _eb.lokSteuern(10, Klassen.LokEigenschaften.Geschwindigkeit, Stufe14)
        ElseIf _Prog10 = 18 Then
            _eb.lokSteuern(10, Klassen.LokEigenschaften.Geschwindigkeit, Stufe3)
        ElseIf _Prog10 = 19 Then
        ElseIf _Prog10 = 20 Then
            If _Motor < 3 Then
                _eb.lokSteuern(10, Klassen.LokEigenschaften.Funktion1, 0) ' Motor aus
            End If

            ' Lok abstellen

        ElseIf _Prog10 = 50 Then
            Prog_Lok10.Interval = 2000
        ElseIf _Prog10 = 51 Then
            If _Innenbeleuchtung2 < 2 Then
                _eb.lokSteuern(10, Klassen.LokEigenschaften.Funktion2, 0) ' Innenbeleuchtung aus
            End If
        ElseIf _Prog10 = 52 Then
            If _Fahrzeugbeleuchtung2 < 2 Then
                _eb.lokSteuern(10, Klassen.LokEigenschaften.Hauptfunktion, 0) ' Licht aus
            End If
        ElseIf _Prog10 = 53 Then
            If _Motor < 3 Then
                _eb.lokSteuern(10, Klassen.LokEigenschaften.Funktion1, 0) ' Motor aus
            End If

            ' Lok bremsen (Bahnhofseinfahrt Normalzug von links und von rechts)

        ElseIf _Prog10 = 100 Then
            Prog_Lok10.Interval = V_100
        ElseIf _Prog10 = 101 Then
            _eb.lokSteuern(10, Klassen.LokEigenschaften.Geschwindigkeit, Stufe24)
            Prog_Lok10.Interval = T_100
        ElseIf _Prog10 = 102 Then
            _eb.lokSteuern(10, Klassen.LokEigenschaften.Geschwindigkeit, Stufe23)
        ElseIf _Prog10 = 103 Then
            _eb.lokSteuern(10, Klassen.LokEigenschaften.Geschwindigkeit, Stufe22)
        ElseIf _Prog10 = 104 Then
            _eb.lokSteuern(10, Klassen.LokEigenschaften.Geschwindigkeit, Stufe21)
        ElseIf _Prog10 = 105 Then
            _eb.lokSteuern(10, Klassen.LokEigenschaften.Geschwindigkeit, Stufe2)

            ' Lok bremsen (Bahnhofseinfahrt Kurzzug von links)

        ElseIf _Prog10 = 130 Then
            Prog_Lok10.Interval = V_130
        ElseIf _Prog10 = 131 Then
            _eb.lokSteuern(10, Klassen.LokEigenschaften.Geschwindigkeit, Stufe24)
            Prog_Lok10.Interval = T_130
        ElseIf _Prog10 = 132 Then
            _eb.lokSteuern(10, Klassen.LokEigenschaften.Geschwindigkeit, Stufe23)
        ElseIf _Prog10 = 133 Then
            _eb.lokSteuern(10, Klassen.LokEigenschaften.Geschwindigkeit, Stufe22)
        ElseIf _Prog10 = 134 Then
            _eb.lokSteuern(10, Klassen.LokEigenschaften.Geschwindigkeit, Stufe21)
        ElseIf _Prog10 = 135 Then
            _eb.lokSteuern(10, Klassen.LokEigenschaften.Geschwindigkeit, Stufe2)
        ElseIf _Prog10 = 136 Then
            _eb.lokSteuern(10, Klassen.LokEigenschaften.Geschwindigkeit, 0)
        ElseIf _Prog10 = 137 Then
            Prog_Lok10.Interval = 2000
        ElseIf _Prog10 = 138 Then
            If _Motor < 3 Then
                _eb.lokSteuern(10, Klassen.LokEigenschaften.Funktion1, 0) ' Motor aus
            End If
        ElseIf _Prog10 = 139 Then
            If _Innenbeleuchtung2 < 2 Then
                _eb.lokSteuern(10, Klassen.LokEigenschaften.Funktion2, 0) ' Innenbeleuchtung aus
            End If
        ElseIf _Prog10 = 140 Then
            If _Fahrzeugbeleuchtung2 < 2 Then
                _eb.lokSteuern(10, Klassen.LokEigenschaften.Hauptfunktion, 0) ' Licht aus
            End If

            ' Lok bremsen (Bahnhofseinfahrt Kurzzug von rechts)

        ElseIf _Prog10 = 160 Then
            Prog_Lok10.Interval = V_160
        ElseIf _Prog10 = 161 Then
            _eb.lokSteuern(10, Klassen.LokEigenschaften.Geschwindigkeit, Stufe24)
            Prog_Lok10.Interval = T_160
        ElseIf _Prog10 = 162 Then
            _eb.lokSteuern(10, Klassen.LokEigenschaften.Geschwindigkeit, Stufe23)
        ElseIf _Prog10 = 163 Then
            _eb.lokSteuern(10, Klassen.LokEigenschaften.Geschwindigkeit, Stufe22)
        ElseIf _Prog10 = 164 Then
            _eb.lokSteuern(10, Klassen.LokEigenschaften.Geschwindigkeit, Stufe21)
        ElseIf _Prog10 = 165 Then
            _eb.lokSteuern(10, Klassen.LokEigenschaften.Geschwindigkeit, Stufe2)
        ElseIf _Prog10 = 166 Then
            _eb.lokSteuern(10, Klassen.LokEigenschaften.Geschwindigkeit, 0)
        ElseIf _Prog10 = 167 Then
            Prog_Lok10.Interval = 2000
        ElseIf _Prog10 = 168 Then
            If _Motor < 3 Then
                _eb.lokSteuern(10, Klassen.LokEigenschaften.Funktion1, 0) ' Motor aus
            End If
        ElseIf _Prog10 = 169 Then
            If _Innenbeleuchtung2 < 2 Then
                _eb.lokSteuern(10, Klassen.LokEigenschaften.Funktion2, 0) ' Innenbeleuchtung aus
            End If
        ElseIf _Prog10 = 170 Then
            If _Fahrzeugbeleuchtung2 < 2 Then
                _eb.lokSteuern(10, Klassen.LokEigenschaften.Hauptfunktion, 0) ' Licht aus
            End If

            ' Rangierzug

        ElseIf _Prog10 = 180 Then
            Prog_Lok10.Interval = V_180
            If _TypL10 < 5 Then
                _eb.lokSteuern(10, Klassen.LokEigenschaften.Geschwindigkeit, 0)
                _Prog10 = 181
            Else
                _eb.lokSteuern(10, Klassen.LokEigenschaften.Geschwindigkeit, Stufe2)
            End If
        ElseIf _Prog10 = 181 Then
            Prog_Lok10.Interval = T_180
            _eb.lokSteuern(10, Klassen.LokEigenschaften.Geschwindigkeit, 1)
        ElseIf _Prog10 = 182 Then
            _eb.lokSteuern(10, Klassen.LokEigenschaften.Geschwindigkeit, 0)

            ' Tunnelausfahrt

        ElseIf _Prog10 = 200 Then ' Kontakt 1.2 <- (bergauf)
            _eb.lokSteuern(10, Klassen.LokEigenschaften.Geschwindigkeit, G_200)
            Prog_Lok10.Interval = 2000
        ElseIf _Prog10 = 201 Then
        ElseIf _Prog10 = 202 Then
        ElseIf _Prog10 = 203 Then
        ElseIf _Prog10 = 204 Then
        ElseIf _Prog10 = 205 Then
            If Stufe4 < Stufe3 Then
                _eb.lokSteuern(10, Klassen.LokEigenschaften.Geschwindigkeit, Stufe3)
            Else
                _eb.lokSteuern(10, Klassen.LokEigenschaften.Geschwindigkeit, Stufe4)
            End If
        ElseIf _Prog10 = 206 Then
        ElseIf _Prog10 = 207 Then
            If _Motor > 1 Then
                _eb.lokSteuern(10, Klassen.LokEigenschaften.Funktion1, 1) ' Motor ein
            End If
        ElseIf _Prog10 = 208 Then
        ElseIf _Prog10 = 209 Then
            If _AkustischeSignale > 1 Then
                _eb.lokSteuern(10, Klassen.LokEigenschaften.Funktion3, 1) ' Hupe ein
            End If
        ElseIf _Prog10 = 210 Then
            _eb.lokSteuern(10, Klassen.LokEigenschaften.Funktion3, 0) ' Hupe aus

        ElseIf _Prog10 = 220 Then ' Kontakt 3.1 -> (hinter dem Martinstor bergauf)
            Prog_Lok10.Interval = 2000
        ElseIf _Prog10 = 221 Then
        ElseIf _Prog10 = 222 Then
        ElseIf _Prog10 = 223 Then
        ElseIf _Prog10 = 224 Then
        ElseIf _Prog10 = 225 Then
        ElseIf _Prog10 = 226 Then
        ElseIf _Prog10 = 227 Then
            If _Motor < 3 Then
                _eb.lokSteuern(10, Klassen.LokEigenschaften.Funktion1, 0) ' Motor aus
            End If

        ElseIf _Prog10 = 240 Then ' Kontakt 3.7 <- (hinter der Brücke bergauf)
            Prog_Lok10.Interval = 2000
        ElseIf _Prog10 = 241 Then
        ElseIf _Prog10 = 242 Then
        ElseIf _Prog10 = 243 Then
        ElseIf _Prog10 = 244 Then
        ElseIf _Prog10 = 245 Then
            If _AkustischeSignale > 1 Then
                _eb.lokSteuern(10, Klassen.LokEigenschaften.Funktion3, 1) ' Hupe ein
            End If
        ElseIf _Prog10 = 246 Then
            _eb.lokSteuern(10, Klassen.LokEigenschaften.Funktion3, 0) ' Hupe aus
        ElseIf _Prog10 = 247 Then
        ElseIf _Prog10 = 248 Then

        ElseIf _Prog10 = 260 Then ' Kontakt 3.3 (links bzw vor der Brücke)
            Prog_Lok10.Interval = 2000
        ElseIf _Prog10 = 261 Then
        ElseIf _Prog10 = 262 Then
            _eb.lokSteuern(10, Klassen.LokEigenschaften.Geschwindigkeit, Stufe3)

        ElseIf _Prog10 = 600 Then ' Kontakt 3.5 <- (unter der Burg)
            Prog_Lok10.Interval = 2000
            If _AkustischeSignale > 1 Then
                _eb.lokSteuern(10, Klassen.LokEigenschaften.Funktion3, 1) ' Hupe ein
            End If
        ElseIf _Prog10 = 601 Then
            _eb.lokSteuern(10, Klassen.LokEigenschaften.Funktion3, 0) ' Hupe aus
        ElseIf _Prog10 = 602 Then
        ElseIf _Prog10 = 603 Then
        ElseIf _Prog10 = 604 Then

        ElseIf _Prog10 = 620 Then ' Kontakt 3.7 -> (hinter der Brücke bergab)
            Prog_Lok10.Interval = 2000
        ElseIf _Prog10 = 621 Then
        ElseIf _Prog10 = 622 Then
            If _Motor > 1 Then
                _eb.lokSteuern(10, Klassen.LokEigenschaften.Funktion1, 1) ' Motor ein
            End If
        ElseIf _Prog10 = 623 Then
            If _AkustischeSignale > 1 Then
                _eb.lokSteuern(10, Klassen.LokEigenschaften.Funktion3, 1) ' Hupe ein
            End If
        ElseIf _Prog10 = 624 Then
            _eb.lokSteuern(10, Klassen.LokEigenschaften.Funktion3, 0) ' Hupe aus


        ElseIf _Prog10 = 640 Then ' Kontakt 3.1 <- Talfahrt
            Prog_Lok10.Interval = 5000
        ElseIf _Prog10 = 641 Then
        ElseIf _Prog10 = 642 Then
        ElseIf _Prog10 = 643 Then
            If _Motor < 3 Then
                _eb.lokSteuern(10, Klassen.LokEigenschaften.Funktion1, 0) ' Motor aus
            End If

        ElseIf _Prog10 = 660 Then ' Kontakt 1.2 -> Talfahrt
            Prog_Lok10.Interval = 2000
        ElseIf _Prog10 = 661 Then
        ElseIf _Prog10 = 662 Then
        ElseIf _Prog10 = 663 Then
        ElseIf _Prog10 = 664 Then
        ElseIf _Prog10 = 665 Then
            If _GlsL10 = 1 Or _GlsL10 = 2 Then
                If _Motor > 0 Then
                    _eb.lokSteuern(10, Klassen.LokEigenschaften.Funktion1, 1) ' Motor ein
                End If
            End If
        ElseIf _Prog10 = 666 Then
        ElseIf _Prog10 = 667 Then
            If _GlsL10 = 1 Or _GlsL10 = 2 Then
                If _AkustischeSignale > 0 Then
                    _eb.lokSteuern(10, Klassen.LokEigenschaften.Funktion3, 1) ' Hupe ein
                End If
            End If
        ElseIf _Prog10 = 668 Then
            _eb.lokSteuern(10, Klassen.LokEigenschaften.Funktion3, 0) ' Hupe aus

        ElseIf _Prog10 = 700 Then ' Kontakt 0.4 <- Diagonale
            Prog_Lok10.Interval = 2000
        ElseIf _Prog10 = 701 Then
        ElseIf _Prog10 = 702 Then
        ElseIf _Prog10 = 703 Then
        ElseIf _Prog10 = 704 Then
            If _Motor > 0 Then
                _eb.lokSteuern(10, Klassen.LokEigenschaften.Funktion1, 1) ' Motor ein
            End If
        ElseIf _Prog10 = 705 Then
            If _AkustischeSignale > 0 Then
                _eb.lokSteuern(10, Klassen.LokEigenschaften.Funktion3, 1) ' Hupe ein
            End If
        ElseIf _Prog10 = 706 Then
            _eb.lokSteuern(10, Klassen.LokEigenschaften.Funktion3, 0) ' Hupe aus


            ' Zindelstein

        ElseIf _Prog10 = 500 Then
            Prog_Lok10.Interval = V_500
        ElseIf _Prog10 = 501 Then
            _eb.lokSteuern(10, Klassen.LokEigenschaften.Geschwindigkeit, Stufe23)
            Prog_Lok10.Interval = T_500
        ElseIf _Prog10 = 502 Then
            _eb.lokSteuern(10, Klassen.LokEigenschaften.Geschwindigkeit, Stufe22)
        ElseIf _Prog10 = 503 Then
            _eb.lokSteuern(10, Klassen.LokEigenschaften.Geschwindigkeit, Stufe21)
        ElseIf _Prog10 = 504 Then
            _eb.lokSteuern(10, Klassen.LokEigenschaften.Geschwindigkeit, Stufe2)
        ElseIf _Prog10 = 505 Then
            _eb.lokSteuern(10, Klassen.LokEigenschaften.Geschwindigkeit, 0)


        Else
            _Prog10 = 0
            Prog_Lok10.Stop()
            Prog_Lok10.Interval = 200
            If Betriebsart = 1 Then
                SetProgramCounterLabel1(String.Empty)
            Else
                SetProgramCounterLabel(String.Empty)
            End If
        End If
        _Prog10 = _Prog10 + 1
    End Sub
    Private Sub HandleTimerElapsed23(sender As System.Object, e As System.EventArgs) Handles Prog_Lok11.Elapsed

        '*** Fahrprogramm für ICE 410 001-2 und 410 002-0
        '*** Datum: 23.02.2020

        SetText(TextBox1, "ICE 410 001-2 und 410 002-0                                             IBS: 29.12.2025 - V3 : 5")
        LoadImage(PictureBox1, "H:\\EB_Media\\LokFotos\\Baureihe_ICE_02.jpg")
        GeschwindikeitenSetzen(11)

        Dim Stufe1, Stufe2, Stufe3, Stufe4 As Integer
        Dim Stufe11, Stufe12, Stufe13, Stufe14, Stufe21, Stufe22, Stufe23, Stufe24 As Integer
        Dim V_100, V_130, V_160, V_180, V_500 As Integer
        Dim T_100, T_130, T_160, T_180, T_500 As Integer
        Dim G_200 As Integer

        T_100 = _Betriebsparameter.Fahrparameter(11, KlausEBspecific.Betriebsparameter.FahrparameterEnum.T_100)
        T_130 = _Betriebsparameter.Fahrparameter(11, KlausEBspecific.Betriebsparameter.FahrparameterEnum.T_130)
        T_160 = _Betriebsparameter.Fahrparameter(11, KlausEBspecific.Betriebsparameter.FahrparameterEnum.T_160)
        T_180 = _Betriebsparameter.Fahrparameter(11, KlausEBspecific.Betriebsparameter.FahrparameterEnum.T_180)
        T_500 = _Betriebsparameter.Fahrparameter(11, KlausEBspecific.Betriebsparameter.FahrparameterEnum.T_500)
        V_100 = _Betriebsparameter.Fahrparameter(11, KlausEBspecific.Betriebsparameter.FahrparameterEnum.V_100)
        V_130 = _Betriebsparameter.Fahrparameter(11, KlausEBspecific.Betriebsparameter.FahrparameterEnum.V_130)
        V_160 = _Betriebsparameter.Fahrparameter(11, KlausEBspecific.Betriebsparameter.FahrparameterEnum.V_160)
        V_180 = _Betriebsparameter.Fahrparameter(11, KlausEBspecific.Betriebsparameter.FahrparameterEnum.V_180)
        V_500 = _Betriebsparameter.Fahrparameter(11, KlausEBspecific.Betriebsparameter.FahrparameterEnum.V_500)
        G_200 = _Betriebsparameter.Fahrparameter(11, KlausEBspecific.Betriebsparameter.FahrparameterEnum.G_200)

        If A_StopB = 1 Then
            V_100 = 5000
        End If

        Stufe1 = _LokStufen.Holen(11, 1)
        Stufe2 = _LokStufen.Holen(11, 2)
        Stufe3 = _LokStufen.Holen(11, 3)
        Stufe4 = _LokStufen.Holen(11, 4)

        If Stufe2 = 1 Then
            T_100 = T_100
            T_130 = T_130
            T_160 = T_160
            V_180 = V_180
        ElseIf Stufe2 = 2 Then
            T_100 = T_100 + 200
            T_130 = T_130 + 200
            T_160 = T_160 + 200
            V_180 = V_180 + 200
        ElseIf Stufe2 = 3 Then
            T_100 = T_100 + 400
            T_130 = T_130 + 400
            T_160 = T_160 + 400
            V_180 = V_180 + 400
        ElseIf Stufe2 = 4 Then
            T_100 = T_100 + 500
            T_130 = T_130 + 500
            T_160 = T_160 + 500
            V_180 = V_180 + 500
        ElseIf Stufe2 = 5 Then
            T_100 = T_100 + 600
            T_130 = T_130 + 600
            T_160 = T_160 + 600
            V_180 = V_180 + 600
        ElseIf Stufe2 = 6 Then
            T_100 = T_100 + 800
            T_130 = T_130 + 800
            T_160 = T_160 + 800
            V_180 = V_180 + 800
        Else
            T_100 = T_100 + 500
            T_130 = T_130 + 500
            T_160 = T_160 + 500
            V_180 = V_180 + 500
        End If

        Stufe2 = Stufe1

        Stufe11 = Stufe1 + 1
        If Stufe11 > Stufe3 Then
            Stufe11 = Stufe3
        End If
        Stufe12 = Stufe1 + 2
        If Stufe12 > Stufe3 Then
            Stufe12 = Stufe3
        End If
        Stufe13 = Stufe1 + 3
        If Stufe13 > Stufe3 Then
            Stufe13 = Stufe3
        End If
        Stufe14 = Stufe1 + 4
        If Stufe14 > Stufe3 Then
            Stufe14 = Stufe3
        End If

        Stufe21 = Stufe2 + 1
        If Stufe21 > Stufe3 Then
            Stufe21 = Stufe3
        End If
        Stufe22 = Stufe2 + 2
        If Stufe22 > Stufe3 Then
            Stufe22 = Stufe3
        End If
        Stufe23 = Stufe2 + 3
        If Stufe23 > Stufe3 Then
            Stufe23 = Stufe3
        End If
        Stufe24 = Stufe2 + 4
        If Stufe24 > Stufe3 Then
            Stufe24 = Stufe3
        End If
        If G_200 > 0 Then
            If G_200 < Stufe4 Then
                G_200 = Stufe4
            End If
        Else
            G_200 = Stufe4
        End If

        If Betriebsart = 1 And (_GlsL11 = 3 Or _GlsL11 = 4) Then
            SetProgramCounterLabel1(_Prog11)
        Else
            SetProgramCounterLabel(_Prog11)
        End If

        ' Lok starten - Bahnhofsausfahrt

        If _Prog11 = 0 Then
            Prog_Lok11.Interval = 2000
            If _Fahrzeugbeleuchtung2 > 0 Then
                _eb.lokSteuern(11, Klassen.LokEigenschaften.Hauptfunktion, 1) ' Licht ein
            End If
        ElseIf _Prog11 = 1 Then
            _Betriebsparameter.RundenErhoehen(11)
        ElseIf _Prog11 = 2 Then
        ElseIf _Prog11 = 3 Then

            ' Bahnhofsausfahrt

        ElseIf _Prog11 = 4 Then
            _eb.lokSteuern(11, Klassen.LokEigenschaften.Geschwindigkeit, Stufe1)
        ElseIf _Prog11 = 5 Then
            _eb.lokSteuern(11, Klassen.LokEigenschaften.Geschwindigkeit, Stufe11)
        ElseIf _Prog11 = 6 Then
            _eb.lokSteuern(11, Klassen.LokEigenschaften.Geschwindigkeit, Stufe12)
        ElseIf _Prog11 = 7 Then
            _eb.lokSteuern(11, Klassen.LokEigenschaften.Geschwindigkeit, Stufe13)
        ElseIf _Prog11 = 8 Then
            _eb.lokSteuern(11, Klassen.LokEigenschaften.Geschwindigkeit, Stufe14)
        ElseIf _Prog11 = 9 Then
            _eb.lokSteuern(11, Klassen.LokEigenschaften.Geschwindigkeit, Stufe3)
        ElseIf _Prog11 = 10 Then

            ' Lok abstellen

        ElseIf _Prog11 = 50 Then
            Prog_Lok11.Interval = 2000
        ElseIf _Prog11 = 51 Then
        ElseIf _Prog11 = 52 Then
            If _Fahrzeugbeleuchtung2 < 2 Then
                _eb.lokSteuern(11, Klassen.LokEigenschaften.Hauptfunktion, 0) ' Licht aus
            End If

            ' Lok bremsen (Bahnhofseinfahrt Normalzug von links und von rechts)

        ElseIf _Prog11 = 100 Then
            Prog_Lok11.Interval = V_100
        ElseIf _Prog11 = 101 Then
            _eb.lokSteuern(11, Klassen.LokEigenschaften.Geschwindigkeit, Stufe24)
            Prog_Lok11.Interval = T_100
        ElseIf _Prog11 = 102 Then
            _eb.lokSteuern(11, Klassen.LokEigenschaften.Geschwindigkeit, Stufe23)
        ElseIf _Prog11 = 103 Then
            _eb.lokSteuern(11, Klassen.LokEigenschaften.Geschwindigkeit, Stufe22)
        ElseIf _Prog11 = 104 Then
            _eb.lokSteuern(11, Klassen.LokEigenschaften.Geschwindigkeit, Stufe21)
        ElseIf _Prog11 = 105 Then
            _eb.lokSteuern(11, Klassen.LokEigenschaften.Geschwindigkeit, Stufe2)

            ' Lok bremsen (Bahnhofseinfahrt Kurzzug von links)

        ElseIf _Prog11 = 130 Then
            Prog_Lok11.Interval = V_130
        ElseIf _Prog11 = 131 Then
            _eb.lokSteuern(11, Klassen.LokEigenschaften.Geschwindigkeit, Stufe24)
            Prog_Lok11.Interval = T_130
        ElseIf _Prog11 = 132 Then
            _eb.lokSteuern(11, Klassen.LokEigenschaften.Geschwindigkeit, Stufe23)
        ElseIf _Prog11 = 133 Then
            _eb.lokSteuern(11, Klassen.LokEigenschaften.Geschwindigkeit, Stufe22)
        ElseIf _Prog11 = 134 Then
            _eb.lokSteuern(11, Klassen.LokEigenschaften.Geschwindigkeit, Stufe21)
        ElseIf _Prog11 = 135 Then
            _eb.lokSteuern(11, Klassen.LokEigenschaften.Geschwindigkeit, Stufe2)
        ElseIf _Prog11 = 136 Then
            _eb.lokSteuern(11, Klassen.LokEigenschaften.Geschwindigkeit, 0)
        ElseIf _Prog11 = 137 Then
            Prog_Lok11.Interval = 2000
        ElseIf _Prog11 = 138 Then
            If _Fahrzeugbeleuchtung2 < 2 Then
                _eb.lokSteuern(11, Klassen.LokEigenschaften.Hauptfunktion, 0) ' Licht aus
            End If

            ' Lok bremsen (Bahnhofseinfahrt Kurzzug von rechts)

        ElseIf _Prog11 = 160 Then
            Prog_Lok11.Interval = V_160
        ElseIf _Prog11 = 161 Then
            _eb.lokSteuern(11, Klassen.LokEigenschaften.Geschwindigkeit, Stufe24)
            Prog_Lok11.Interval = T_160
        ElseIf _Prog11 = 162 Then
            _eb.lokSteuern(11, Klassen.LokEigenschaften.Geschwindigkeit, Stufe23)
        ElseIf _Prog11 = 163 Then
            _eb.lokSteuern(11, Klassen.LokEigenschaften.Geschwindigkeit, Stufe22)
        ElseIf _Prog11 = 164 Then
            _eb.lokSteuern(11, Klassen.LokEigenschaften.Geschwindigkeit, Stufe21)
        ElseIf _Prog11 = 165 Then
            _eb.lokSteuern(11, Klassen.LokEigenschaften.Geschwindigkeit, Stufe2)
        ElseIf _Prog11 = 166 Then
            _eb.lokSteuern(11, Klassen.LokEigenschaften.Geschwindigkeit, 0)
        ElseIf _Prog11 = 167 Then
            Prog_Lok11.Interval = 2000
        ElseIf _Prog11 = 168 Then
            If _Fahrzeugbeleuchtung2 < 2 Then
                _eb.lokSteuern(11, Klassen.LokEigenschaften.Hauptfunktion, 0) ' Licht aus
            End If

            ' Rangierzug

        ElseIf _Prog11 = 180 Then
            Prog_Lok11.Interval = V_180
            If _TypL11 < 5 Then
                _eb.lokSteuern(11, Klassen.LokEigenschaften.Geschwindigkeit, 0)
                _Prog11 = 181
            Else
                _eb.lokSteuern(11, Klassen.LokEigenschaften.Geschwindigkeit, Stufe2)
            End If
        ElseIf _Prog11 = 181 Then
            Prog_Lok11.Interval = T_180
            _eb.lokSteuern(11, Klassen.LokEigenschaften.Geschwindigkeit, 1)
        ElseIf _Prog11 = 182 Then
            _eb.lokSteuern(11, Klassen.LokEigenschaften.Geschwindigkeit, 0)

            ' Tunnelausfahrt

        ElseIf _Prog11 = 200 Then ' Kontakt 1.2 <- (bergauf)
            _eb.lokSteuern(11, Klassen.LokEigenschaften.Geschwindigkeit, G_200)
            Prog_Lok11.Interval = 2000
        ElseIf _Prog11 = 201 Then
        ElseIf _Prog11 = 202 Then
        ElseIf _Prog11 = 203 Then
        ElseIf _Prog11 = 204 Then
        ElseIf _Prog11 = 205 Then
            If Stufe4 < Stufe3 Then
                _eb.lokSteuern(11, Klassen.LokEigenschaften.Geschwindigkeit, Stufe3)
            Else
                _eb.lokSteuern(11, Klassen.LokEigenschaften.Geschwindigkeit, Stufe4)
            End If

        ElseIf _Prog11 = 220 Then ' Kontakt 3.1 -> (hinter dem Martinstor bergauf)
            Prog_Lok11.Interval = 2000
        ElseIf _Prog11 = 221 Then
        ElseIf _Prog11 = 222 Then

        ElseIf _Prog11 = 240 Then ' Kontakt 3.7 <- (hinter der Brücke bergauf)
            Prog_Lok11.Interval = 2000
        ElseIf _Prog11 = 241 Then
        ElseIf _Prog11 = 242 Then

        ElseIf _Prog11 = 260 Then ' Kontakt 3.3 (links bzw vor der Brücke)
            Prog_Lok11.Interval = 2000
        ElseIf _Prog11 = 261 Then
        ElseIf _Prog11 = 262 Then
            _eb.lokSteuern(11, Klassen.LokEigenschaften.Geschwindigkeit, Stufe3)

        ElseIf _Prog11 = 600 Then ' Kontakt 3.5 <- (unter der Burg)
            Prog_Lok11.Interval = 2000
        ElseIf _Prog11 = 601 Then
        ElseIf _Prog11 = 602 Then

        ElseIf _Prog11 = 620 Then ' Kontakt 3.7 -> (hinter der Brücke bergab)
            Prog_Lok11.Interval = 2000
        ElseIf _Prog11 = 621 Then
        ElseIf _Prog11 = 622 Then

        ElseIf _Prog11 = 640 Then ' Kontakt 3.1 <- Talfahrt
            Prog_Lok11.Interval = 2000
        ElseIf _Prog11 = 641 Then
        ElseIf _Prog11 = 642 Then

        ElseIf _Prog11 = 660 Then ' Kontakt 1.2 -> Talfahrt
            Prog_Lok11.Interval = 2000
        ElseIf _Prog11 = 661 Then
        ElseIf _Prog11 = 662 Then

        ElseIf _Prog11 = 700 Then ' Kontakt 0.4 <- Diagonale
            Prog_Lok11.Interval = 2000
        ElseIf _Prog11 = 701 Then
        ElseIf _Prog11 = 702 Then

            ' Zindelstein

        ElseIf _Prog11 = 500 Then
            Prog_Lok11.Interval = V_500
        ElseIf _Prog11 = 501 Then
            _eb.lokSteuern(11, Klassen.LokEigenschaften.Geschwindigkeit, Stufe23)
            Prog_Lok11.Interval = T_500
        ElseIf _Prog11 = 502 Then
            _eb.lokSteuern(11, Klassen.LokEigenschaften.Geschwindigkeit, Stufe22)
        ElseIf _Prog11 = 503 Then
            _eb.lokSteuern(11, Klassen.LokEigenschaften.Geschwindigkeit, Stufe21)
        ElseIf _Prog11 = 504 Then
            _eb.lokSteuern(11, Klassen.LokEigenschaften.Geschwindigkeit, Stufe2)
        ElseIf _Prog11 = 505 Then
            _eb.lokSteuern(11, Klassen.LokEigenschaften.Geschwindigkeit, 0)


        Else
            _Prog11 = 0
            Prog_Lok11.Stop()
            Prog_Lok11.Interval = 200
            If Betriebsart = 1 Then
                SetProgramCounterLabel1(String.Empty)
            Else
                SetProgramCounterLabel(String.Empty)
            End If
        End If
        _Prog11 = _Prog11 + 1
    End Sub
    Private Sub HandleTimerElapsed24(sender As System.Object, e As System.EventArgs) Handles Prog_Lok12.Elapsed

        '*** Fahrprogramm für E103 113-7
        '*** Datum: 12.11.2023

        SetText(TextBox1, "E-Lok 103 113-7                                                         IBS: 29.12.2025 - V3 : 8")
        LoadImage(PictureBox1, "H:\\EB_Media\\LokFotos\\Baureihe_103_01.jpg")
        GeschwindikeitenSetzen(12)
        Dim Stufe1, Stufe2, Stufe3, Stufe4 As Integer
        Dim Stufe11, Stufe12, Stufe13, Stufe14, Stufe21, Stufe22, Stufe23, Stufe24 As Integer
        Dim V_100, V_130, V_160, V_180, V_500 As Integer
        Dim T_100, T_130, T_160, T_180, T_500 As Integer
        Dim G_200 As Integer

        T_100 = _Betriebsparameter.Fahrparameter(12, KlausEBspecific.Betriebsparameter.FahrparameterEnum.T_100)
        T_130 = _Betriebsparameter.Fahrparameter(12, KlausEBspecific.Betriebsparameter.FahrparameterEnum.T_130)
        T_160 = _Betriebsparameter.Fahrparameter(12, KlausEBspecific.Betriebsparameter.FahrparameterEnum.T_160)
        T_180 = _Betriebsparameter.Fahrparameter(12, KlausEBspecific.Betriebsparameter.FahrparameterEnum.T_180)
        T_500 = _Betriebsparameter.Fahrparameter(12, KlausEBspecific.Betriebsparameter.FahrparameterEnum.T_500)
        V_100 = _Betriebsparameter.Fahrparameter(12, KlausEBspecific.Betriebsparameter.FahrparameterEnum.V_100)
        V_130 = _Betriebsparameter.Fahrparameter(12, KlausEBspecific.Betriebsparameter.FahrparameterEnum.V_130)
        V_160 = _Betriebsparameter.Fahrparameter(12, KlausEBspecific.Betriebsparameter.FahrparameterEnum.V_160)
        V_180 = _Betriebsparameter.Fahrparameter(12, KlausEBspecific.Betriebsparameter.FahrparameterEnum.V_180)
        V_500 = _Betriebsparameter.Fahrparameter(12, KlausEBspecific.Betriebsparameter.FahrparameterEnum.V_500)
        G_200 = _Betriebsparameter.Fahrparameter(12, KlausEBspecific.Betriebsparameter.FahrparameterEnum.G_200)

        If A_StopB = 1 Then
            V_100 = 4000
        End If

        Stufe1 = _LokStufen.Holen(12, 1)
        Stufe2 = _LokStufen.Holen(12, 2)
        Stufe3 = _LokStufen.Holen(12, 3)
        Stufe4 = _LokStufen.Holen(12, 4)

        If Stufe2 = 1 Then
            T_100 = T_100
            T_130 = T_130
            T_160 = T_160
            V_180 = V_180
        ElseIf Stufe2 = 2 Then
            T_100 = T_100 + 100
            T_130 = T_130 + 100
            T_160 = T_160 + 100
            V_180 = V_180 + 100
        ElseIf Stufe2 = 3 Then
            T_100 = T_100 + 200
            T_130 = T_130 + 200
            T_160 = T_160 + 200
            V_180 = V_180 + 300
        ElseIf Stufe2 = 4 Then
            T_100 = T_100 + 300
            T_130 = T_130 + 300
            T_160 = T_160 + 300
            V_180 = V_180 + 1000
        ElseIf Stufe2 = 5 Then
            T_100 = T_100 + 400
            T_130 = T_130 + 400
            T_160 = T_160 + 400
            V_180 = V_180 + 2000
        ElseIf Stufe2 = 6 Then
            T_100 = T_100 + 500
            T_130 = T_130 + 500
            T_160 = T_160 + 500
            V_180 = V_180 + 3000
        Else
            T_100 = T_100 + 600
            T_130 = T_130 + 600
            T_160 = T_160 + 600
            V_180 = V_180 + 4000
        End If

        Stufe2 = Stufe1

        Stufe11 = Stufe1 + 1
        If Stufe11 > Stufe3 Then
            Stufe11 = Stufe3
        End If
        Stufe12 = Stufe1 + 2
        If Stufe12 > Stufe3 Then
            Stufe12 = Stufe3
        End If
        Stufe13 = Stufe1 + 3
        If Stufe13 > Stufe3 Then
            Stufe13 = Stufe3
        End If
        Stufe14 = Stufe1 + 4
        If Stufe14 > Stufe3 Then
            Stufe14 = Stufe3
        End If

        Stufe21 = Stufe2 + 1
        If Stufe21 > Stufe3 Then
            Stufe21 = Stufe3
        End If
        Stufe22 = Stufe2 + 2
        If Stufe22 > Stufe3 Then
            Stufe22 = Stufe3
        End If
        Stufe23 = Stufe2 + 3
        If Stufe23 > Stufe3 Then
            Stufe23 = Stufe3
        End If
        Stufe24 = Stufe2 + 4
        If Stufe24 > Stufe3 Then
            Stufe24 = Stufe3
        End If
        If G_200 > 0 Then
            If G_200 < Stufe4 Then
                G_200 = Stufe4
            End If
        Else
            G_200 = Stufe4
        End If

        If Betriebsart = 1 And (_GlsL12 = 3 Or _GlsL12 = 4) Then
            SetProgramCounterLabel1(_Prog12)
        Else
            SetProgramCounterLabel(_Prog12)
        End If

        ' Lok starten - Bahnhofsausfahrt

        If _Prog12 = 0 Then
            Prog_Lok12.Interval = 2000
            If _Fahrzeugbeleuchtung2 > 0 Then
                _eb.lokSteuern(12, Klassen.LokEigenschaften.Hauptfunktion, 1) ' Licht ein
            End If
        ElseIf _Prog12 = 1 Then
            _eb.lokSteuern(40, Klassen.LokEigenschaften.Geschwindigkeit, 0)
        ElseIf _Prog12 = 2 Then
            _Betriebsparameter.RundenErhoehen(12)
        ElseIf _Prog12 = 3 Then
        ElseIf _Prog12 = 4 Then
        ElseIf _Prog12 = 5 Then
        ElseIf _Prog12 = 6 Then
        ElseIf _Prog12 = 7 Then

            ' Bahnhofsausfahrt

        ElseIf _Prog12 = 8 Then
            _eb.lokSteuern(12, Klassen.LokEigenschaften.Geschwindigkeit, Stufe1)
        ElseIf _Prog12 = 9 Then
            _eb.lokSteuern(12, Klassen.LokEigenschaften.Geschwindigkeit, Stufe11)
        ElseIf _Prog12 = 10 Then
            _eb.lokSteuern(12, Klassen.LokEigenschaften.Geschwindigkeit, Stufe12)
        ElseIf _Prog12 = 11 Then
            _eb.lokSteuern(12, Klassen.LokEigenschaften.Geschwindigkeit, Stufe13)
        ElseIf _Prog12 = 12 Then
            _eb.lokSteuern(12, Klassen.LokEigenschaften.Geschwindigkeit, Stufe14)
        ElseIf _Prog12 = 13 Then
            _eb.lokSteuern(12, Klassen.LokEigenschaften.Geschwindigkeit, Stufe3)

            ' Lok abstellen

        ElseIf _Prog12 = 50 Then
            Prog_Lok12.Interval = 2000
        ElseIf _Prog12 = 51 Then
        ElseIf _Prog12 = 52 Then
            If _Fahrzeugbeleuchtung2 < 2 Then
                _eb.lokSteuern(12, Klassen.LokEigenschaften.Hauptfunktion, 0) ' Licht aus
            End If

            ' Lok bremsen (Bahnhofseinfahrt Normalzug von links und von rechts)

        ElseIf _Prog12 = 100 Then
            Prog_Lok12.Interval = V_100
        ElseIf _Prog12 = 101 Then
            _eb.lokSteuern(12, Klassen.LokEigenschaften.Geschwindigkeit, Stufe24)
            Prog_Lok12.Interval = T_100
        ElseIf _Prog12 = 102 Then
            _eb.lokSteuern(12, Klassen.LokEigenschaften.Geschwindigkeit, Stufe23)
        ElseIf _Prog12 = 103 Then
            _eb.lokSteuern(12, Klassen.LokEigenschaften.Geschwindigkeit, Stufe22)
        ElseIf _Prog12 = 104 Then
            _eb.lokSteuern(12, Klassen.LokEigenschaften.Geschwindigkeit, Stufe21)
        ElseIf _Prog12 = 105 Then
            _eb.lokSteuern(12, Klassen.LokEigenschaften.Geschwindigkeit, Stufe2)
        ElseIf _Prog12 = 137 Then
            Prog_Lok12.Interval = 2000
        ElseIf _Prog12 = 138 Then
            If _Fahrzeugbeleuchtung2 < 2 Then
                _eb.lokSteuern(12, Klassen.LokEigenschaften.Hauptfunktion, 0) ' Licht aus
            End If

            ' Lok bremsen (Bahnhofseinfahrt Kurzzug von links)

        ElseIf _Prog12 = 130 Then
            Prog_Lok12.Interval = V_130
        ElseIf _Prog12 = 131 Then
            _eb.lokSteuern(12, Klassen.LokEigenschaften.Geschwindigkeit, Stufe24)
            Prog_Lok12.Interval = T_130
        ElseIf _Prog12 = 132 Then
            _eb.lokSteuern(12, Klassen.LokEigenschaften.Geschwindigkeit, Stufe23)
        ElseIf _Prog12 = 133 Then
            _eb.lokSteuern(12, Klassen.LokEigenschaften.Geschwindigkeit, Stufe22)
        ElseIf _Prog12 = 134 Then
            _eb.lokSteuern(12, Klassen.LokEigenschaften.Geschwindigkeit, Stufe21)
        ElseIf _Prog12 = 135 Then
            _eb.lokSteuern(12, Klassen.LokEigenschaften.Geschwindigkeit, Stufe2)
        ElseIf _Prog12 = 136 Then
            _eb.lokSteuern(12, Klassen.LokEigenschaften.Geschwindigkeit, 0)
        ElseIf _Prog12 = 137 Then
            Prog_Lok12.Interval = 2000
        ElseIf _Prog12 = 138 Then
            If _Fahrzeugbeleuchtung2 < 2 Then
                _eb.lokSteuern(12, Klassen.LokEigenschaften.Hauptfunktion, 0) ' Licht aus
            End If

            ' Lok bremsen (Bahnhofseinfahrt Kurzzug von rechts)

        ElseIf _Prog12 = 160 Then
            Prog_Lok12.Interval = V_160
        ElseIf _Prog12 = 161 Then
            _eb.lokSteuern(12, Klassen.LokEigenschaften.Geschwindigkeit, Stufe24)
            Prog_Lok12.Interval = T_160
        ElseIf _Prog12 = 162 Then
            _eb.lokSteuern(12, Klassen.LokEigenschaften.Geschwindigkeit, Stufe23)
        ElseIf _Prog12 = 163 Then
            _eb.lokSteuern(12, Klassen.LokEigenschaften.Geschwindigkeit, Stufe22)
        ElseIf _Prog12 = 164 Then
            _eb.lokSteuern(12, Klassen.LokEigenschaften.Geschwindigkeit, Stufe21)
        ElseIf _Prog12 = 165 Then
            _eb.lokSteuern(12, Klassen.LokEigenschaften.Geschwindigkeit, Stufe2)
        ElseIf _Prog12 = 166 Then
            _eb.lokSteuern(12, Klassen.LokEigenschaften.Geschwindigkeit, 0)
        ElseIf _Prog12 = 167 Then
            Prog_Lok12.Interval = 2000
        ElseIf _Prog12 = 168 Then
            If _Fahrzeugbeleuchtung2 < 2 Then
                _eb.lokSteuern(12, Klassen.LokEigenschaften.Hauptfunktion, 0) ' Licht aus
            End If

            ' Rangierzug

        ElseIf _Prog12 = 180 Then
            Prog_Lok12.Interval = V_180
            If _TypL12 < 5 Then
                _eb.lokSteuern(12, Klassen.LokEigenschaften.Geschwindigkeit, 0)
                _Prog12 = 181
            Else
                _eb.lokSteuern(12, Klassen.LokEigenschaften.Geschwindigkeit, Stufe2)
            End If
        ElseIf _Prog12 = 181 Then
            Prog_Lok12.Interval = T_180
            _eb.lokSteuern(12, Klassen.LokEigenschaften.Geschwindigkeit, 3)
        ElseIf _Prog12 = 182 Then
            _eb.lokSteuern(12, Klassen.LokEigenschaften.Geschwindigkeit, 0)

            ' Tunnelausfahrt

        ElseIf _Prog12 = 200 Then ' Kontakt 1.2 <- (bergauf)
            _eb.lokSteuern(12, Klassen.LokEigenschaften.Geschwindigkeit, G_200)
            Prog_Lok12.Interval = 2000
        ElseIf _Prog12 = 201 Then
        ElseIf _Prog12 = 202 Then
        ElseIf _Prog12 = 203 Then
        ElseIf _Prog12 = 204 Then
        ElseIf _Prog12 = 205 Then
            If Stufe4 < Stufe3 Then
                _eb.lokSteuern(12, Klassen.LokEigenschaften.Geschwindigkeit, Stufe3)
            Else
                _eb.lokSteuern(12, Klassen.LokEigenschaften.Geschwindigkeit, Stufe4)
            End If

        ElseIf _Prog12 = 220 Then ' Kontakt 3.1 -> (hinter dem Martinstor bergauf)
            Prog_Lok12.Interval = 2000
        ElseIf _Prog12 = 221 Then
        ElseIf _Prog12 = 222 Then

        ElseIf _Prog12 = 240 Then ' Kontakt 3.7 <- (hinter der Brücke bergauf)
            Prog_Lok12.Interval = 2000
        ElseIf _Prog12 = 241 Then
        ElseIf _Prog12 = 242 Then

        ElseIf _Prog12 = 260 Then ' Kontakt 3.3 (links bzw vor der Brücke)
            Prog_Lok12.Interval = 2000
        ElseIf _Prog12 = 261 Then
        ElseIf _Prog12 = 262 Then
            _eb.lokSteuern(12, Klassen.LokEigenschaften.Geschwindigkeit, Stufe3)

        ElseIf _Prog12 = 600 Then ' Kontakt 3.5 <- (unter der Burg)
            Prog_Lok12.Interval = 2000
        ElseIf _Prog12 = 601 Then
        ElseIf _Prog12 = 602 Then

        ElseIf _Prog12 = 620 Then ' Kontakt 3.7 -> (hinter der Brücke bergab)
            Prog_Lok12.Interval = 2000
        ElseIf _Prog12 = 621 Then
        ElseIf _Prog12 = 622 Then

        ElseIf _Prog12 = 640 Then ' Kontakt 3.1 <- Talfahrt
            Prog_Lok12.Interval = 2000
        ElseIf _Prog12 = 641 Then
        ElseIf _Prog12 = 642 Then

        ElseIf _Prog12 = 660 Then ' Kontakt 1.2 -> Talfahrt
            Prog_Lok12.Interval = 2000
        ElseIf _Prog12 = 661 Then
        ElseIf _Prog12 = 662 Then

        ElseIf _Prog12 = 700 Then ' Kontakt 0.4 <- Diagonale
            Prog_Lok12.Interval = 2000
        ElseIf _Prog12 = 701 Then
        ElseIf _Prog12 = 702 Then

            ' Zindelstein

        ElseIf _Prog12 = 500 Then
            Prog_Lok12.Interval = V_500
        ElseIf _Prog12 = 501 Then
            _eb.lokSteuern(12, Klassen.LokEigenschaften.Geschwindigkeit, Stufe23)
            Prog_Lok12.Interval = T_500
        ElseIf _Prog12 = 502 Then
            _eb.lokSteuern(12, Klassen.LokEigenschaften.Geschwindigkeit, Stufe22)
        ElseIf _Prog12 = 503 Then
            _eb.lokSteuern(12, Klassen.LokEigenschaften.Geschwindigkeit, Stufe21)
        ElseIf _Prog12 = 504 Then
            _eb.lokSteuern(12, Klassen.LokEigenschaften.Geschwindigkeit, Stufe2)
            Prog_Lok12.Interval = 2000
        ElseIf _Prog12 = 505 Then
            _eb.lokSteuern(12, Klassen.LokEigenschaften.Geschwindigkeit, 0)



        Else
            _Prog12 = 0
            Prog_Lok12.Stop()
            Prog_Lok12.Interval = 200
            If Betriebsart = 1 Then
                SetProgramCounterLabel1(String.Empty)
            Else
                SetProgramCounterLabel(String.Empty)
            End If
        End If
        _Prog12 = _Prog12 + 1
    End Sub
    Private Sub HandleTimerElapsed25(sender As System.Object, e As System.EventArgs) Handles Prog_Lok13.Elapsed

        '*** Fahrprogramm E120 002-1
        '*** Datum: 23.02.2020

        SetText(TextBox1, "E-Lok 120 002-1                                                         IBS: 29.12.2025 - V3: 10")
        LoadImage(PictureBox1, "H:\\EB_Media\\LokFotos\\Baureihe_120_01.jpg")
        GeschwindikeitenSetzen(13)

        Dim Stufe1, Stufe2, Stufe3, Stufe4 As Integer
        Dim Stufe11, Stufe12, Stufe13, Stufe14, Stufe21, Stufe22, Stufe23, Stufe24 As Integer
        Dim V_100, V_130, V_160, V_180, V_500 As Integer
        Dim T_100, T_130, T_160, T_180, T_500 As Integer
        Dim G_200 As Integer

        T_100 = _Betriebsparameter.Fahrparameter(13, KlausEBspecific.Betriebsparameter.FahrparameterEnum.T_100)
        T_130 = _Betriebsparameter.Fahrparameter(13, KlausEBspecific.Betriebsparameter.FahrparameterEnum.T_130)
        T_160 = _Betriebsparameter.Fahrparameter(13, KlausEBspecific.Betriebsparameter.FahrparameterEnum.T_160)
        T_180 = _Betriebsparameter.Fahrparameter(13, KlausEBspecific.Betriebsparameter.FahrparameterEnum.T_180)
        T_500 = _Betriebsparameter.Fahrparameter(13, KlausEBspecific.Betriebsparameter.FahrparameterEnum.T_500)
        V_100 = _Betriebsparameter.Fahrparameter(13, KlausEBspecific.Betriebsparameter.FahrparameterEnum.V_100)
        V_130 = _Betriebsparameter.Fahrparameter(13, KlausEBspecific.Betriebsparameter.FahrparameterEnum.V_130)
        V_160 = _Betriebsparameter.Fahrparameter(13, KlausEBspecific.Betriebsparameter.FahrparameterEnum.V_160)
        V_180 = _Betriebsparameter.Fahrparameter(13, KlausEBspecific.Betriebsparameter.FahrparameterEnum.V_180)
        V_500 = _Betriebsparameter.Fahrparameter(13, KlausEBspecific.Betriebsparameter.FahrparameterEnum.V_500)
        G_200 = _Betriebsparameter.Fahrparameter(13, KlausEBspecific.Betriebsparameter.FahrparameterEnum.G_200)

        If A_StopB = 1 Then
            V_100 = 8000
        End If

        Stufe1 = _LokStufen.Holen(13, 1)
        Stufe2 = _LokStufen.Holen(13, 2)
        Stufe3 = _LokStufen.Holen(13, 3)
        Stufe4 = _LokStufen.Holen(13, 4)

        If Stufe2 = 1 Then
            T_100 = T_100
            T_130 = T_130
            T_160 = T_160
            V_180 = V_180
        ElseIf Stufe2 = 2 Then
            T_100 = T_100 + 300
            T_130 = T_130 + 300
            T_160 = T_160 + 300
            V_180 = V_180 + 500
        ElseIf Stufe2 = 3 Then
            T_100 = T_100 + 500
            T_130 = T_130 + 500
            T_160 = T_160 + 500
            V_180 = V_180 + 1000
        ElseIf Stufe2 = 4 Then
            T_100 = T_100 + 700
            T_130 = T_130 + 700
            T_160 = T_160 + 700
            V_180 = V_180 + 1500
        ElseIf Stufe2 = 5 Then
            T_100 = T_100 + 900
            T_130 = T_130 + 900
            T_160 = T_160 + 900
            V_180 = V_180 + 2000
        ElseIf Stufe2 = 6 Then
            T_100 = T_100 + 1200
            T_130 = T_130 + 1200
            T_160 = T_160 + 1200
            V_180 = V_180 + 2500
        Else
            T_100 = T_100 + 1200
            T_130 = T_130 + 1200
            T_160 = T_160 + 1200
            V_180 = V_180 + 2500
        End If

        Stufe2 = Stufe1

        Stufe11 = Stufe1 + 1
        If Stufe11 > Stufe3 Then
            Stufe11 = Stufe3
        End If
        Stufe12 = Stufe1 + 2
        If Stufe12 > Stufe3 Then
            Stufe12 = Stufe3
        End If
        Stufe13 = Stufe1 + 3
        If Stufe13 > Stufe3 Then
            Stufe13 = Stufe3
        End If
        Stufe14 = Stufe1 + 4
        If Stufe14 > Stufe3 Then
            Stufe14 = Stufe3
        End If

        Stufe21 = Stufe2 + 1
        If Stufe21 > Stufe3 Then
            Stufe21 = Stufe3
        End If
        Stufe22 = Stufe2 + 2
        If Stufe22 > Stufe3 Then
            Stufe22 = Stufe3
        End If
        Stufe23 = Stufe2 + 3
        If Stufe23 > Stufe3 Then
            Stufe23 = Stufe3
        End If
        Stufe24 = Stufe2 + 4
        If Stufe24 > Stufe3 Then
            Stufe24 = Stufe3
        End If
        If G_200 > 0 Then
            If G_200 < Stufe4 Then
                G_200 = Stufe4
            End If
        Else
            G_200 = Stufe4
        End If

        If Betriebsart = 1 And (_GlsL13 = 3 Or _GlsL13 = 4) Then
            SetProgramCounterLabel1(_Prog13)
        Else
            SetProgramCounterLabel(_Prog13)
        End If

        ' Lok starten - Bahnhofsausfahrt

        If _Prog13 = 0 Then
            Prog_Lok13.Interval = 2000
            If _Fahrzeugbeleuchtung2 > 0 Then
                _eb.lokSteuern(13, Klassen.LokEigenschaften.Hauptfunktion, 1) ' Licht ein
            End If
        ElseIf _Prog13 = 1 Then
        ElseIf _Prog13 = 2 Then
            _Betriebsparameter.RundenErhoehen(13)
        ElseIf _Prog13 = 3 Then
        ElseIf _Prog13 = 4 Then
        ElseIf _Prog13 = 5 Then
        ElseIf _Prog13 = 6 Then

            ' Bahnhofsausfahrt

        ElseIf _Prog13 = 7 Then
            _eb.lokSteuern(13, Klassen.LokEigenschaften.Geschwindigkeit, Stufe1)
        ElseIf _Prog13 = 8 Then
            _eb.lokSteuern(13, Klassen.LokEigenschaften.Geschwindigkeit, Stufe11)
        ElseIf _Prog13 = 9 Then
            _eb.lokSteuern(13, Klassen.LokEigenschaften.Geschwindigkeit, Stufe12)
        ElseIf _Prog13 = 10 Then
            _eb.lokSteuern(13, Klassen.LokEigenschaften.Geschwindigkeit, Stufe13)
        ElseIf _Prog13 = 11 Then
            _eb.lokSteuern(13, Klassen.LokEigenschaften.Geschwindigkeit, Stufe14)
        ElseIf _Prog13 = 12 Then
            _eb.lokSteuern(13, Klassen.LokEigenschaften.Geschwindigkeit, Stufe3)

            ' Lok abstellen

        ElseIf _Prog13 = 50 Then
            Prog_Lok13.Interval = 2000
        ElseIf _Prog13 = 51 Then
        ElseIf _Prog13 = 52 Then
            If _Fahrzeugbeleuchtung2 < 2 Then
                _eb.lokSteuern(13, Klassen.LokEigenschaften.Hauptfunktion, 0) ' Licht aus
            End If

            ' Lok bremsen (Bahnhofseinfahrt Normalzug von links und von rechts)

        ElseIf _Prog13 = 100 Then
            Prog_Lok13.Interval = V_100
        ElseIf _Prog13 = 101 Then
            _eb.lokSteuern(13, Klassen.LokEigenschaften.Geschwindigkeit, Stufe24)
            Prog_Lok13.Interval = T_100
        ElseIf _Prog13 = 102 Then
            _eb.lokSteuern(13, Klassen.LokEigenschaften.Geschwindigkeit, Stufe23)
        ElseIf _Prog13 = 103 Then
            _eb.lokSteuern(13, Klassen.LokEigenschaften.Geschwindigkeit, Stufe22)
        ElseIf _Prog13 = 104 Then
            _eb.lokSteuern(13, Klassen.LokEigenschaften.Geschwindigkeit, Stufe21)
        ElseIf _Prog13 = 105 Then
            _eb.lokSteuern(13, Klassen.LokEigenschaften.Geschwindigkeit, Stufe2)

            ' Lok bremsen (Bahnhofseinfahrt Kurzzug von links)

        ElseIf _Prog13 = 130 Then
            Prog_Lok13.Interval = V_130
        ElseIf _Prog13 = 131 Then
            _eb.lokSteuern(13, Klassen.LokEigenschaften.Geschwindigkeit, Stufe24)
            Prog_Lok13.Interval = T_130
        ElseIf _Prog13 = 132 Then
            _eb.lokSteuern(13, Klassen.LokEigenschaften.Geschwindigkeit, Stufe23)
        ElseIf _Prog13 = 133 Then
            _eb.lokSteuern(13, Klassen.LokEigenschaften.Geschwindigkeit, Stufe22)
        ElseIf _Prog13 = 134 Then
            _eb.lokSteuern(13, Klassen.LokEigenschaften.Geschwindigkeit, Stufe21)
        ElseIf _Prog13 = 135 Then
            _eb.lokSteuern(13, Klassen.LokEigenschaften.Geschwindigkeit, Stufe2)
        ElseIf _Prog13 = 136 Then
            _eb.lokSteuern(13, Klassen.LokEigenschaften.Geschwindigkeit, 0)
        ElseIf _Prog13 = 137 Then
            Prog_Lok13.Interval = 2000
        ElseIf _Prog13 = 138 Then
            If _Fahrzeugbeleuchtung2 < 2 Then
                _eb.lokSteuern(13, Klassen.LokEigenschaften.Hauptfunktion, 0) ' Licht aus
            End If

            ' Lok bremsen (Bahnhofseinfahrt Kurzzug von rechts)

        ElseIf _Prog13 = 160 Then
            Prog_Lok13.Interval = V_160
        ElseIf _Prog13 = 161 Then
            _eb.lokSteuern(13, Klassen.LokEigenschaften.Geschwindigkeit, Stufe24)
            Prog_Lok13.Interval = T_160
        ElseIf _Prog13 = 162 Then
            _eb.lokSteuern(13, Klassen.LokEigenschaften.Geschwindigkeit, Stufe23)
        ElseIf _Prog13 = 163 Then
            _eb.lokSteuern(13, Klassen.LokEigenschaften.Geschwindigkeit, Stufe22)
        ElseIf _Prog13 = 164 Then
            _eb.lokSteuern(13, Klassen.LokEigenschaften.Geschwindigkeit, Stufe21)
        ElseIf _Prog13 = 165 Then
            _eb.lokSteuern(13, Klassen.LokEigenschaften.Geschwindigkeit, Stufe2)
        ElseIf _Prog13 = 166 Then
            _eb.lokSteuern(13, Klassen.LokEigenschaften.Geschwindigkeit, 0)
        ElseIf _Prog13 = 167 Then
            Prog_Lok13.Interval = 2000
        ElseIf _Prog13 = 168 Then
            If _Fahrzeugbeleuchtung2 < 2 Then
                _eb.lokSteuern(13, Klassen.LokEigenschaften.Hauptfunktion, 0) ' Licht aus
            End If

            ' Rangierzug

        ElseIf _Prog13 = 180 Then
            Prog_Lok13.Interval = V_180
            If _TypL13 < 5 Then
                _eb.lokSteuern(13, Klassen.LokEigenschaften.Geschwindigkeit, 0)
                _Prog13 = 181
            Else
                _eb.lokSteuern(13, Klassen.LokEigenschaften.Geschwindigkeit, Stufe2)
            End If
        ElseIf _Prog13 = 181 Then
            Prog_Lok13.Interval = T_180
            _eb.lokSteuern(13, Klassen.LokEigenschaften.Geschwindigkeit, 1)
        ElseIf _Prog13 = 182 Then
            _eb.lokSteuern(13, Klassen.LokEigenschaften.Geschwindigkeit, 0)

            ' Tunnelausfahrt

        ElseIf _Prog13 = 200 Then ' Kontakt 1.2 <- (bergauf)
            _eb.lokSteuern(13, Klassen.LokEigenschaften.Geschwindigkeit, G_200)
            Prog_Lok13.Interval = 2000
        ElseIf _Prog13 = 201 Then
        ElseIf _Prog13 = 202 Then
        ElseIf _Prog13 = 203 Then
        ElseIf _Prog13 = 204 Then
        ElseIf _Prog13 = 205 Then
            If Stufe4 < Stufe3 Then
                _eb.lokSteuern(13, Klassen.LokEigenschaften.Geschwindigkeit, Stufe3)
            Else
                _eb.lokSteuern(13, Klassen.LokEigenschaften.Geschwindigkeit, Stufe4)
            End If

        ElseIf _Prog13 = 220 Then ' Kontakt 3.1 -> (hinter dem Martinstor bergauf)
            Prog_Lok13.Interval = 2000
        ElseIf _Prog13 = 221 Then
        ElseIf _Prog13 = 222 Then

        ElseIf _Prog13 = 240 Then ' Kontakt 3.7 <- (hinter der Brücke bergauf)
            Prog_Lok13.Interval = 2000
        ElseIf _Prog13 = 241 Then
        ElseIf _Prog13 = 242 Then

        ElseIf _Prog13 = 260 Then ' Kontakt 3.3 (links bzw vor der Brücke)
            Prog_Lok13.Interval = 2000
        ElseIf _Prog13 = 261 Then
        ElseIf _Prog13 = 262 Then
            _eb.lokSteuern(13, Klassen.LokEigenschaften.Geschwindigkeit, Stufe3)

        ElseIf _Prog13 = 600 Then ' Kontakt 3.5 <- (unter der Burg)
            Prog_Lok13.Interval = 2000
        ElseIf _Prog13 = 601 Then
        ElseIf _Prog13 = 602 Then

        ElseIf _Prog13 = 620 Then ' Kontakt 3.7 -> (hinter der Brücke bergab)
            Prog_Lok13.Interval = 2000
        ElseIf _Prog13 = 621 Then
        ElseIf _Prog13 = 622 Then

        ElseIf _Prog13 = 640 Then ' Kontakt 3.1 <- Talfahrt
            Prog_Lok13.Interval = 2000
        ElseIf _Prog13 = 641 Then
        ElseIf _Prog13 = 642 Then

        ElseIf _Prog13 = 660 Then ' Kontakt 1.2 -> Talfahrt
            Prog_Lok13.Interval = 2000
        ElseIf _Prog13 = 661 Then
        ElseIf _Prog13 = 662 Then

        ElseIf _Prog13 = 700 Then ' Kontakt 0.4 <- Diagonale
            Prog_Lok13.Interval = 2000
        ElseIf _Prog13 = 701 Then
        ElseIf _Prog13 = 702 Then

            ' Zindelstein

        ElseIf _Prog13 = 500 Then
            Prog_Lok13.Interval = V_500
        ElseIf _Prog13 = 501 Then
            _eb.lokSteuern(13, Klassen.LokEigenschaften.Geschwindigkeit, Stufe23)
            Prog_Lok13.Interval = T_500
        ElseIf _Prog13 = 502 Then
            _eb.lokSteuern(13, Klassen.LokEigenschaften.Geschwindigkeit, Stufe22)
        ElseIf _Prog13 = 503 Then
            _eb.lokSteuern(13, Klassen.LokEigenschaften.Geschwindigkeit, Stufe21)
        ElseIf _Prog13 = 504 Then
            _eb.lokSteuern(13, Klassen.LokEigenschaften.Geschwindigkeit, Stufe2)
        ElseIf _Prog13 = 505 Then
            _eb.lokSteuern(13, Klassen.LokEigenschaften.Geschwindigkeit, 0)

        Else
            _Prog13 = 0
            Prog_Lok13.Stop()
            Prog_Lok13.Interval = 200
            If Betriebsart = 1 Then
                SetProgramCounterLabel1(String.Empty)
            Else
                SetProgramCounterLabel(String.Empty)
            End If
        End If
        _Prog13 = _Prog13 + 1
    End Sub
    Private Sub HandleTimerElapsed26(sender As System.Object, e As System.EventArgs) Handles Prog_Lok14.Elapsed

        '*** Fahrprogramm SBB Lok2000 460 024-3
        '*** Datum: 08.10.2020

        SetText(TextBox1, "E-Lok SBB 460 024-3                                                     IBS: 29.12.2025 - V3 : 9")
        LoadImage(PictureBox1, "H:\\EB_Media\\LokFotos\\Baureihe_460_01.jpg")
        GeschwindikeitenSetzen(14)

        Dim Stufe1, Stufe2, Stufe3, Stufe4 As Integer
        Dim Stufe11, Stufe12, Stufe13, Stufe14, Stufe21, Stufe22, Stufe23, Stufe24 As Integer
        Dim V_100, V_130, V_160, V_180, V_500 As Integer
        Dim T_100, T_130, T_160, T_180, T_500 As Integer
        Dim G_200 As Integer

        T_100 = _Betriebsparameter.Fahrparameter(14, KlausEBspecific.Betriebsparameter.FahrparameterEnum.T_100)
        T_130 = _Betriebsparameter.Fahrparameter(14, KlausEBspecific.Betriebsparameter.FahrparameterEnum.T_130)
        T_160 = _Betriebsparameter.Fahrparameter(14, KlausEBspecific.Betriebsparameter.FahrparameterEnum.T_160)
        T_180 = _Betriebsparameter.Fahrparameter(14, KlausEBspecific.Betriebsparameter.FahrparameterEnum.T_180)
        T_500 = _Betriebsparameter.Fahrparameter(14, KlausEBspecific.Betriebsparameter.FahrparameterEnum.T_500)
        V_100 = _Betriebsparameter.Fahrparameter(14, KlausEBspecific.Betriebsparameter.FahrparameterEnum.V_100)
        V_130 = _Betriebsparameter.Fahrparameter(14, KlausEBspecific.Betriebsparameter.FahrparameterEnum.V_130)
        V_160 = _Betriebsparameter.Fahrparameter(14, KlausEBspecific.Betriebsparameter.FahrparameterEnum.V_160)
        V_180 = _Betriebsparameter.Fahrparameter(14, KlausEBspecific.Betriebsparameter.FahrparameterEnum.V_180)
        V_500 = _Betriebsparameter.Fahrparameter(14, KlausEBspecific.Betriebsparameter.FahrparameterEnum.V_500)
        G_200 = _Betriebsparameter.Fahrparameter(14, KlausEBspecific.Betriebsparameter.FahrparameterEnum.G_200)

        If A_StopB = 1 Then
            V_100 = 8000
        End If

        Stufe1 = _LokStufen.Holen(14, 1)
        Stufe2 = _LokStufen.Holen(14, 2)
        Stufe3 = _LokStufen.Holen(14, 3)
        Stufe4 = _LokStufen.Holen(14, 4)

        If Stufe2 = 1 Then
            T_100 = T_100
            T_130 = T_130
            T_160 = T_160
            V_180 = V_180
        ElseIf Stufe2 = 2 Then
            T_100 = T_100 + 300
            T_130 = T_130 + 300
            T_160 = T_160 + 300
            V_180 = V_180 + 500
        ElseIf Stufe2 = 3 Then
            T_100 = T_100 + 500
            T_130 = T_130 + 500
            T_160 = T_160 + 500
            V_180 = V_180 + 1000
        ElseIf Stufe2 = 4 Then
            T_100 = T_100 + 700
            T_130 = T_130 + 700
            T_160 = T_160 + 700
            V_180 = V_180 + 1500
        ElseIf Stufe2 = 5 Then
            T_100 = T_100 + 900
            T_130 = T_130 + 900
            T_160 = T_160 + 900
            V_180 = V_180 + 2000
        ElseIf Stufe2 = 6 Then
            T_100 = T_100 + 1200
            T_130 = T_130 + 1200
            T_160 = T_160 + 1200
            V_180 = V_180 + 2500
        Else
            T_100 = T_100 + 1200
            T_130 = T_130 + 1200
            T_160 = T_160 + 1200
            V_180 = V_180 + 2500
        End If

        Stufe2 = Stufe1

        Stufe11 = Stufe1 + 1
        If Stufe11 > Stufe3 Then
            Stufe11 = Stufe3
        End If
        Stufe12 = Stufe1 + 2
        If Stufe12 > Stufe3 Then
            Stufe12 = Stufe3
        End If
        Stufe13 = Stufe1 + 3
        If Stufe13 > Stufe3 Then
            Stufe13 = Stufe3
        End If
        Stufe14 = Stufe1 + 4
        If Stufe14 > Stufe3 Then
            Stufe14 = Stufe3
        End If

        Stufe21 = Stufe2 + 1
        If Stufe21 > Stufe3 Then
            Stufe21 = Stufe3
        End If
        Stufe22 = Stufe2 + 2
        If Stufe22 > Stufe3 Then
            Stufe22 = Stufe3
        End If
        Stufe23 = Stufe2 + 3
        If Stufe23 > Stufe3 Then
            Stufe23 = Stufe3
        End If
        Stufe24 = Stufe2 + 4
        If Stufe24 > Stufe3 Then
            Stufe24 = Stufe3
        End If
        If G_200 > 0 Then
            If G_200 < Stufe4 Then
                G_200 = Stufe4
            End If
        Else
            G_200 = Stufe4
        End If

        If Betriebsart = 1 And (_GlsL14 = 3 Or _GlsL14 = 4) Then
            SetProgramCounterLabel1(_Prog14)
        Else
            SetProgramCounterLabel(_Prog14)
        End If

        ' Lok starten - Bahnhofsausfahrt

        If _Prog14 = 0 Then
            Prog_Lok14.Interval = 2000
            If _Fahrzeugbeleuchtung2 > 0 Then
                _eb.lokSteuern(14, Klassen.LokEigenschaften.Hauptfunktion, 1) ' Licht ein
            End If
        ElseIf _Prog14 = 1 Then
        ElseIf _Prog14 = 2 Then
            _Betriebsparameter.RundenErhoehen(14)
        ElseIf _Prog14 = 3 Then
        ElseIf _Prog14 = 4 Then
        ElseIf _Prog14 = 5 Then
        ElseIf _Prog14 = 6 Then

            ' Bahnhofsausfahrt

        ElseIf _Prog14 = 7 Then
            _eb.lokSteuern(14, Klassen.LokEigenschaften.Geschwindigkeit, Stufe1)
        ElseIf _Prog14 = 8 Then
            _eb.lokSteuern(14, Klassen.LokEigenschaften.Geschwindigkeit, Stufe11)
        ElseIf _Prog14 = 9 Then
            _eb.lokSteuern(14, Klassen.LokEigenschaften.Geschwindigkeit, Stufe12)
        ElseIf _Prog14 = 10 Then
            _eb.lokSteuern(14, Klassen.LokEigenschaften.Geschwindigkeit, Stufe13)
        ElseIf _Prog14 = 11 Then
            _eb.lokSteuern(14, Klassen.LokEigenschaften.Geschwindigkeit, Stufe14)
        ElseIf _Prog14 = 12 Then
            _eb.lokSteuern(14, Klassen.LokEigenschaften.Geschwindigkeit, Stufe3)

            ' Lok abstellen

        ElseIf _Prog14 = 50 Then
            Prog_Lok14.Interval = 2000
        ElseIf _Prog14 = 51 Then
        ElseIf _Prog14 = 52 Then
            If _Fahrzeugbeleuchtung2 < 2 Then
                _eb.lokSteuern(14, Klassen.LokEigenschaften.Hauptfunktion, 0) ' Licht aus
            End If

            ' Lok bremsen (Bahnhofseinfahrt Normalzug von links und von rechts)

        ElseIf _Prog14 = 100 Then
            Prog_Lok14.Interval = V_100
        ElseIf _Prog14 = 101 Then
            _eb.lokSteuern(14, Klassen.LokEigenschaften.Geschwindigkeit, Stufe24)
            Prog_Lok14.Interval = T_100
        ElseIf _Prog14 = 102 Then
            _eb.lokSteuern(14, Klassen.LokEigenschaften.Geschwindigkeit, Stufe23)
        ElseIf _Prog14 = 103 Then
            _eb.lokSteuern(14, Klassen.LokEigenschaften.Geschwindigkeit, Stufe22)
        ElseIf _Prog14 = 104 Then
            _eb.lokSteuern(14, Klassen.LokEigenschaften.Geschwindigkeit, Stufe21)
        ElseIf _Prog14 = 105 Then
            _eb.lokSteuern(14, Klassen.LokEigenschaften.Geschwindigkeit, Stufe2)

            ' Lok bremsen (Bahnhofseinfahrt Kurzzug von links)

        ElseIf _Prog14 = 130 Then
            Prog_Lok14.Interval = V_130
        ElseIf _Prog14 = 131 Then
            _eb.lokSteuern(14, Klassen.LokEigenschaften.Geschwindigkeit, Stufe24)
            Prog_Lok14.Interval = T_130
        ElseIf _Prog14 = 132 Then
            _eb.lokSteuern(14, Klassen.LokEigenschaften.Geschwindigkeit, Stufe23)
        ElseIf _Prog14 = 133 Then
            _eb.lokSteuern(14, Klassen.LokEigenschaften.Geschwindigkeit, Stufe22)
        ElseIf _Prog14 = 134 Then
            _eb.lokSteuern(14, Klassen.LokEigenschaften.Geschwindigkeit, Stufe21)
        ElseIf _Prog14 = 135 Then
            _eb.lokSteuern(14, Klassen.LokEigenschaften.Geschwindigkeit, Stufe2)
        ElseIf _Prog14 = 136 Then
            _eb.lokSteuern(14, Klassen.LokEigenschaften.Geschwindigkeit, 0)
        ElseIf _Prog14 = 137 Then
            Prog_Lok14.Interval = 2000
        ElseIf _Prog14 = 138 Then
            If _Fahrzeugbeleuchtung2 < 2 Then
                _eb.lokSteuern(14, Klassen.LokEigenschaften.Hauptfunktion, 0) ' Licht aus
            End If

            ' Lok bremsen (Bahnhofseinfahrt Kurzzug von rechts)

        ElseIf _Prog14 = 160 Then
            Prog_Lok14.Interval = V_160
        ElseIf _Prog14 = 161 Then
            _eb.lokSteuern(14, Klassen.LokEigenschaften.Geschwindigkeit, Stufe24)
            Prog_Lok14.Interval = T_160
        ElseIf _Prog14 = 162 Then
            _eb.lokSteuern(14, Klassen.LokEigenschaften.Geschwindigkeit, Stufe23)
        ElseIf _Prog14 = 163 Then
            _eb.lokSteuern(14, Klassen.LokEigenschaften.Geschwindigkeit, Stufe22)
        ElseIf _Prog14 = 164 Then
            _eb.lokSteuern(14, Klassen.LokEigenschaften.Geschwindigkeit, Stufe21)
        ElseIf _Prog14 = 165 Then
            _eb.lokSteuern(14, Klassen.LokEigenschaften.Geschwindigkeit, Stufe2)
        ElseIf _Prog14 = 166 Then
            _eb.lokSteuern(14, Klassen.LokEigenschaften.Geschwindigkeit, 0)
        ElseIf _Prog14 = 167 Then
            Prog_Lok14.Interval = 2000
        ElseIf _Prog14 = 168 Then
            If _Fahrzeugbeleuchtung2 < 2 Then
                _eb.lokSteuern(14, Klassen.LokEigenschaften.Hauptfunktion, 0) ' Licht aus
            End If

            ' Rangierzug

        ElseIf _Prog14 = 180 Then
            _eb.lokSteuern(14, Klassen.LokEigenschaften.Geschwindigkeit, 2)
            Prog_Lok14.Interval = V_180
        ElseIf _Prog14 = 181 Then
            Prog_Lok14.Interval = T_180
            _eb.lokSteuern(14, Klassen.LokEigenschaften.Geschwindigkeit, 1)
        ElseIf _Prog14 = 182 Then
            _eb.lokSteuern(14, Klassen.LokEigenschaften.Geschwindigkeit, 0)

            ' Tunnelausfahrt

        ElseIf _Prog14 = 200 Then ' Kontakt 1.2 <- (bergauf)
            _eb.lokSteuern(14, Klassen.LokEigenschaften.Geschwindigkeit, G_200)
            Prog_Lok14.Interval = 2000
        ElseIf _Prog14 = 201 Then
        ElseIf _Prog14 = 202 Then
        ElseIf _Prog14 = 203 Then
        ElseIf _Prog14 = 204 Then
        ElseIf _Prog14 = 205 Then
            If Stufe4 < Stufe3 Then
                _eb.lokSteuern(14, Klassen.LokEigenschaften.Geschwindigkeit, Stufe3)
            Else
                _eb.lokSteuern(14, Klassen.LokEigenschaften.Geschwindigkeit, Stufe4)
            End If

        ElseIf _Prog14 = 220 Then ' Kontakt 3.1 -> (hinter dem Martinstor bergauf)
            Prog_Lok14.Interval = 2000
        ElseIf _Prog14 = 221 Then
        ElseIf _Prog14 = 222 Then

        ElseIf _Prog14 = 240 Then ' Kontakt 3.7 <- (hinter der Brücke bergauf)
            Prog_Lok14.Interval = 2000
        ElseIf _Prog14 = 241 Then
        ElseIf _Prog14 = 242 Then

        ElseIf _Prog14 = 260 Then ' Kontakt 3.3 (links bzw vor der Brücke)
            Prog_Lok14.Interval = 2000
        ElseIf _Prog14 = 261 Then
        ElseIf _Prog14 = 262 Then
            _eb.lokSteuern(14, Klassen.LokEigenschaften.Geschwindigkeit, Stufe3)

        ElseIf _Prog14 = 600 Then ' Kontakt 3.5 <- (unter der Burg)
            Prog_Lok14.Interval = 2000
        ElseIf _Prog14 = 601 Then
        ElseIf _Prog14 = 602 Then

        ElseIf _Prog14 = 620 Then ' Kontakt 3.7 -> (hinter der Brücke bergab)
            Prog_Lok14.Interval = 2000
        ElseIf _Prog14 = 621 Then
        ElseIf _Prog14 = 622 Then

        ElseIf _Prog14 = 640 Then ' Kontakt 3.1 <- Talfahrt
            Prog_Lok14.Interval = 2000
        ElseIf _Prog14 = 641 Then
        ElseIf _Prog14 = 642 Then

        ElseIf _Prog14 = 660 Then ' Kontakt 1.2 -> Talfahrt
            Prog_Lok14.Interval = 2000
        ElseIf _Prog14 = 661 Then
        ElseIf _Prog14 = 662 Then

        ElseIf _Prog14 = 700 Then ' Kontakt 0.4 <- Diagonale
            Prog_Lok14.Interval = 2000
        ElseIf _Prog14 = 701 Then
        ElseIf _Prog14 = 702 Then

            ' Zindelstein

        ElseIf _Prog14 = 500 Then
            Prog_Lok14.Interval = V_500
        ElseIf _Prog14 = 501 Then
            _eb.lokSteuern(14, Klassen.LokEigenschaften.Geschwindigkeit, Stufe23)
            Prog_Lok14.Interval = T_500
        ElseIf _Prog14 = 502 Then
            _eb.lokSteuern(14, Klassen.LokEigenschaften.Geschwindigkeit, Stufe22)
        ElseIf _Prog14 = 503 Then
            _eb.lokSteuern(14, Klassen.LokEigenschaften.Geschwindigkeit, Stufe21)
        ElseIf _Prog14 = 503 Then
            _eb.lokSteuern(14, Klassen.LokEigenschaften.Geschwindigkeit, Stufe2)
        ElseIf _Prog14 = 504 Then
            _eb.lokSteuern(14, Klassen.LokEigenschaften.Geschwindigkeit, 0)


        Else
            _Prog14 = 0
            Prog_Lok14.Stop()
            Prog_Lok14.Interval = 200
            If Betriebsart = 1 Then
                SetProgramCounterLabel1(String.Empty)
            Else
                SetProgramCounterLabel(String.Empty)
            End If
        End If
        _Prog14 = _Prog14 + 1
    End Sub
    Private Sub HandleTimerElapsed27(sender As System.Object, e As System.EventArgs) Handles Prog_Lok15.Elapsed

        '*** Fahrprogramm E103 165 -7
        '*** Datum: 23.02.2020

        SetText(TextBox1, "E-Lok 103 165-7                                                         IBS: 05.01.2026 - V3: 8")
        LoadImage(PictureBox1, "H:\\EB_Media\\LokFotos\\Baureihe_103_10.jpg")
        GeschwindikeitenSetzen(15)

        Dim Stufe1, Stufe2, Stufe3, Stufe4 As Integer
        Dim Stufe11, Stufe12, Stufe13, Stufe14, Stufe21, Stufe22, Stufe23, Stufe24 As Integer
        Dim V_100, V_130, V_160, V_180, V_500 As Integer
        Dim T_100, T_130, T_160, T_180, T_500 As Integer
        Dim G_200 As Integer

        T_100 = _Betriebsparameter.Fahrparameter(15, KlausEBspecific.Betriebsparameter.FahrparameterEnum.T_100)
        T_130 = _Betriebsparameter.Fahrparameter(15, KlausEBspecific.Betriebsparameter.FahrparameterEnum.T_130)
        T_160 = _Betriebsparameter.Fahrparameter(15, KlausEBspecific.Betriebsparameter.FahrparameterEnum.T_160)
        T_180 = _Betriebsparameter.Fahrparameter(15, KlausEBspecific.Betriebsparameter.FahrparameterEnum.T_180)
        T_500 = _Betriebsparameter.Fahrparameter(15, KlausEBspecific.Betriebsparameter.FahrparameterEnum.T_500)
        V_100 = _Betriebsparameter.Fahrparameter(15, KlausEBspecific.Betriebsparameter.FahrparameterEnum.V_100)
        V_130 = _Betriebsparameter.Fahrparameter(15, KlausEBspecific.Betriebsparameter.FahrparameterEnum.V_130)
        V_160 = _Betriebsparameter.Fahrparameter(15, KlausEBspecific.Betriebsparameter.FahrparameterEnum.V_160)
        V_180 = _Betriebsparameter.Fahrparameter(15, KlausEBspecific.Betriebsparameter.FahrparameterEnum.V_180)
        V_500 = _Betriebsparameter.Fahrparameter(15, KlausEBspecific.Betriebsparameter.FahrparameterEnum.V_500)
        G_200 = _Betriebsparameter.Fahrparameter(15, KlausEBspecific.Betriebsparameter.FahrparameterEnum.G_200)

        If A_StopB = 1 Then
            V_100 = 8000
        End If

        Stufe1 = _LokStufen.Holen(15, 1)
        Stufe2 = _LokStufen.Holen(15, 2)
        Stufe3 = _LokStufen.Holen(15, 3)
        Stufe4 = _LokStufen.Holen(15, 4)

        If Stufe2 = 1 Then
            T_100 = T_100
            T_130 = T_130
            T_160 = T_160
            V_180 = V_180
        ElseIf Stufe2 = 2 Then
            T_100 = T_100 + 150
            T_130 = T_130 + 150
            T_160 = T_160 + 150
            V_180 = V_180 + 150
        ElseIf Stufe2 = 3 Then
            T_100 = T_100 + 300
            T_130 = T_130 + 300
            T_160 = T_160 + 300
            V_180 = V_180 + 500
        ElseIf Stufe2 = 4 Then
            T_100 = T_100 + 450
            T_130 = T_130 + 450
            T_160 = T_160 + 450
            V_180 = V_180 + 1000
        ElseIf Stufe2 = 5 Then
            T_100 = T_100 + 600
            T_130 = T_130 + 600
            T_160 = T_160 + 600
            V_180 = V_180 + 1000
        ElseIf Stufe2 = 6 Then
            T_100 = T_100 + 750
            T_130 = T_130 + 750
            T_160 = T_160 + 7500
            V_180 = V_180 + 1500
        Else
            T_100 = T_100 + 900
            T_130 = T_130 + 900
            T_160 = T_160 + 900
            V_180 = V_180 + 2000
        End If

        Stufe2 = Stufe1

        Stufe11 = Stufe1 + 1
        If Stufe11 > Stufe3 Then
            Stufe11 = Stufe3
        End If
        Stufe12 = Stufe1 + 2
        If Stufe12 > Stufe3 Then
            Stufe12 = Stufe3
        End If
        Stufe13 = Stufe1 + 3
        If Stufe13 > Stufe3 Then
            Stufe13 = Stufe3
        End If
        Stufe14 = Stufe1 + 4
        If Stufe14 > Stufe3 Then
            Stufe14 = Stufe3
        End If

        Stufe21 = Stufe2 + 1
        If Stufe21 > Stufe3 Then
            Stufe21 = Stufe3
        End If
        Stufe22 = Stufe2 + 2
        If Stufe22 > Stufe3 Then
            Stufe22 = Stufe3
        End If
        Stufe23 = Stufe2 + 3
        If Stufe23 > Stufe3 Then
            Stufe23 = Stufe3
        End If
        Stufe24 = Stufe2 + 4
        If Stufe24 > Stufe3 Then
            Stufe24 = Stufe3
        End If
        If G_200 > 0 Then
            If G_200 < Stufe4 Then
                G_200 = Stufe4
            End If
        Else
            G_200 = Stufe4
        End If

        If Betriebsart = 1 And (_GlsL15 = 3 Or _GlsL15 = 4) Then
            SetProgramCounterLabel1(_Prog15)
        Else
            SetProgramCounterLabel(_Prog15)
        End If

        ' Lok starten - Bahnhofsausfahrt

        If _Prog15 = 0 Then
            Prog_Lok15.Interval = 2000
            If _Fahrzeugbeleuchtung2 > 0 Then
                _eb.lokSteuern(15, Klassen.LokEigenschaften.Hauptfunktion, 1) ' Licht ein
            End If
        ElseIf _Prog15 = 1 Then
        ElseIf _Prog15 = 2 Then
            _Betriebsparameter.RundenErhoehen(15)
        ElseIf _Prog15 = 3 Then
        ElseIf _Prog15 = 4 Then
        ElseIf _Prog15 = 5 Then
        ElseIf _Prog15 = 6 Then

            ' Bahnhofsausfahrt

        ElseIf _Prog15 = 7 Then
            _eb.lokSteuern(15, Klassen.LokEigenschaften.Geschwindigkeit, Stufe1)
        ElseIf _Prog15 = 8 Then
            _eb.lokSteuern(15, Klassen.LokEigenschaften.Geschwindigkeit, Stufe11)
        ElseIf _Prog15 = 9 Then
            _eb.lokSteuern(15, Klassen.LokEigenschaften.Geschwindigkeit, Stufe12)
        ElseIf _Prog15 = 10 Then
            _eb.lokSteuern(15, Klassen.LokEigenschaften.Geschwindigkeit, Stufe13)
        ElseIf _Prog15 = 11 Then
            _eb.lokSteuern(15, Klassen.LokEigenschaften.Geschwindigkeit, Stufe14)
        ElseIf _Prog15 = 12 Then
            _eb.lokSteuern(15, Klassen.LokEigenschaften.Geschwindigkeit, Stufe3)

            ' Lok abstellen

        ElseIf _Prog15 = 50 Then
            Prog_Lok15.Interval = 2000
        ElseIf _Prog15 = 51 Then
        ElseIf _Prog15 = 52 Then
            If _Fahrzeugbeleuchtung2 < 2 Then
                _eb.lokSteuern(15, Klassen.LokEigenschaften.Hauptfunktion, 0) ' Licht aus
            End If

            ' Lok bremsen (Bahnhofseinfahrt Normalzug von links und von rechts)

        ElseIf _Prog15 = 100 Then
            Prog_Lok15.Interval = V_100
        ElseIf _Prog15 = 101 Then
            _eb.lokSteuern(15, Klassen.LokEigenschaften.Geschwindigkeit, Stufe24)
            Prog_Lok15.Interval = T_100
        ElseIf _Prog15 = 102 Then
            _eb.lokSteuern(15, Klassen.LokEigenschaften.Geschwindigkeit, Stufe23)
        ElseIf _Prog15 = 103 Then
            _eb.lokSteuern(15, Klassen.LokEigenschaften.Geschwindigkeit, Stufe22)
        ElseIf _Prog15 = 104 Then
            _eb.lokSteuern(15, Klassen.LokEigenschaften.Geschwindigkeit, Stufe21)
        ElseIf _Prog15 = 105 Then
            _eb.lokSteuern(15, Klassen.LokEigenschaften.Geschwindigkeit, Stufe2)

            ' Lok bremsen (Bahnhofseinfahrt Kurzzug von links)

        ElseIf _Prog15 = 130 Then
            Prog_Lok15.Interval = V_130
        ElseIf _Prog15 = 131 Then
            _eb.lokSteuern(15, Klassen.LokEigenschaften.Geschwindigkeit, Stufe24)
            Prog_Lok15.Interval = T_130
        ElseIf _Prog15 = 132 Then
            _eb.lokSteuern(15, Klassen.LokEigenschaften.Geschwindigkeit, Stufe23)
        ElseIf _Prog15 = 133 Then
            _eb.lokSteuern(15, Klassen.LokEigenschaften.Geschwindigkeit, Stufe22)
        ElseIf _Prog15 = 134 Then
            _eb.lokSteuern(15, Klassen.LokEigenschaften.Geschwindigkeit, Stufe21)
        ElseIf _Prog15 = 135 Then
            _eb.lokSteuern(15, Klassen.LokEigenschaften.Geschwindigkeit, Stufe2)
        ElseIf _Prog15 = 136 Then
            _eb.lokSteuern(15, Klassen.LokEigenschaften.Geschwindigkeit, 0)
        ElseIf _Prog15 = 137 Then
            Prog_Lok15.Interval = 2000
        ElseIf _Prog15 = 138 Then
            If _Fahrzeugbeleuchtung2 < 2 Then
                _eb.lokSteuern(15, Klassen.LokEigenschaften.Hauptfunktion, 0) ' Licht aus
            End If

            ' Lok bremsen (Bahnhofseinfahrt Kurzzug von rechts)

        ElseIf _Prog15 = 160 Then
            Prog_Lok15.Interval = V_160
        ElseIf _Prog15 = 161 Then
            _eb.lokSteuern(15, Klassen.LokEigenschaften.Geschwindigkeit, Stufe24)
            Prog_Lok15.Interval = T_160
        ElseIf _Prog15 = 162 Then
            _eb.lokSteuern(15, Klassen.LokEigenschaften.Geschwindigkeit, Stufe23)
        ElseIf _Prog15 = 163 Then
            _eb.lokSteuern(15, Klassen.LokEigenschaften.Geschwindigkeit, Stufe22)
        ElseIf _Prog15 = 164 Then
            _eb.lokSteuern(15, Klassen.LokEigenschaften.Geschwindigkeit, Stufe21)
        ElseIf _Prog15 = 165 Then
            _eb.lokSteuern(15, Klassen.LokEigenschaften.Geschwindigkeit, Stufe2)
        ElseIf _Prog15 = 166 Then
            _eb.lokSteuern(15, Klassen.LokEigenschaften.Geschwindigkeit, 0)
        ElseIf _Prog15 = 167 Then
            Prog_Lok15.Interval = 2000
        ElseIf _Prog15 = 168 Then
            If _Fahrzeugbeleuchtung2 < 2 Then
                _eb.lokSteuern(15, Klassen.LokEigenschaften.Hauptfunktion, 0) ' Licht aus
            End If


            ' Rangierzug

        ElseIf _Prog15 = 180 Then
            _eb.lokSteuern(14, Klassen.LokEigenschaften.Geschwindigkeit, Stufe2)
            Prog_Lok15.Interval = V_180
        ElseIf _Prog15 = 181 Then
            Prog_Lok15.Interval = T_180
            _eb.lokSteuern(14, Klassen.LokEigenschaften.Geschwindigkeit, 1)
        ElseIf _Prog15 = 182 Then
            _eb.lokSteuern(15, Klassen.LokEigenschaften.Geschwindigkeit, 0)

            ' Tunnelausfahrt

        ElseIf _Prog15 = 200 Then ' Kontakt 1.2 <- (bergauf)
            _eb.lokSteuern(15, Klassen.LokEigenschaften.Geschwindigkeit, G_200)
            Prog_Lok15.Interval = 2000
        ElseIf _Prog15 = 201 Then
        ElseIf _Prog15 = 202 Then
        ElseIf _Prog15 = 203 Then
        ElseIf _Prog15 = 204 Then
        ElseIf _Prog15 = 205 Then
            If Stufe4 < Stufe3 Then
                _eb.lokSteuern(15, Klassen.LokEigenschaften.Geschwindigkeit, Stufe3)
            Else
                _eb.lokSteuern(15, Klassen.LokEigenschaften.Geschwindigkeit, Stufe4)
            End If

        ElseIf _Prog15 = 220 Then ' Kontakt 3.1 -> (hinter dem Martinstor bergauf)
            Prog_Lok15.Interval = 2000
        ElseIf _Prog15 = 221 Then
        ElseIf _Prog15 = 222 Then

        ElseIf _Prog15 = 240 Then ' Kontakt 3.7 <- (hinter der Brücke bergauf)
            Prog_Lok15.Interval = 2000
        ElseIf _Prog15 = 241 Then
        ElseIf _Prog15 = 242 Then

        ElseIf _Prog15 = 260 Then ' Kontakt 3.3 (links bzw vor der Brücke)
            Prog_Lok15.Interval = 2000
        ElseIf _Prog15 = 261 Then
        ElseIf _Prog15 = 262 Then
            _eb.lokSteuern(15, Klassen.LokEigenschaften.Geschwindigkeit, Stufe3)

        ElseIf _Prog15 = 600 Then ' Kontakt 3.5 <- (unter der Burg)
            Prog_Lok15.Interval = 2000
        ElseIf _Prog15 = 601 Then
        ElseIf _Prog15 = 602 Then

        ElseIf _Prog15 = 620 Then ' Kontakt 3.7 -> (hinter der Brücke bergab)
            Prog_Lok15.Interval = 2000
        ElseIf _Prog15 = 621 Then
        ElseIf _Prog15 = 622 Then

        ElseIf _Prog15 = 640 Then ' Kontakt 3.1 <- Talfahrt
            Prog_Lok15.Interval = 2000
        ElseIf _Prog15 = 641 Then
        ElseIf _Prog15 = 642 Then

        ElseIf _Prog15 = 660 Then ' Kontakt 1.2 -> Talfahrt
            Prog_Lok15.Interval = 2000
        ElseIf _Prog15 = 661 Then
        ElseIf _Prog15 = 662 Then

        ElseIf _Prog15 = 700 Then ' Kontakt 0.4 <- Diagonale
            Prog_Lok15.Interval = 2000
        ElseIf _Prog15 = 701 Then
        ElseIf _Prog15 = 702 Then

            ' Zindelstein

        ElseIf _Prog15 = 500 Then
            Prog_Lok15.Interval = V_500
        ElseIf _Prog15 = 501 Then
            _eb.lokSteuern(15, Klassen.LokEigenschaften.Geschwindigkeit, Stufe23)
            Prog_Lok15.Interval = T_500
        ElseIf _Prog15 = 502 Then
            _eb.lokSteuern(15, Klassen.LokEigenschaften.Geschwindigkeit, Stufe22)
        ElseIf _Prog15 = 503 Then
            _eb.lokSteuern(15, Klassen.LokEigenschaften.Geschwindigkeit, Stufe21)
        ElseIf _Prog15 = 504 Then
            _eb.lokSteuern(15, Klassen.LokEigenschaften.Geschwindigkeit, Stufe2)
        ElseIf _Prog15 = 505 Then
            _eb.lokSteuern(15, Klassen.LokEigenschaften.Geschwindigkeit, 0)

        Else
            _Prog15 = 0
            Prog_Lok15.Stop()
            Prog_Lok15.Interval = 200
            If Betriebsart = 1 Then
                SetProgramCounterLabel1(String.Empty)
            Else
                SetProgramCounterLabel(String.Empty)
            End If
        End If
        _Prog15 = _Prog15 + 1
    End Sub
    Private Sub HandleTimerElapsed28(sender As System.Object, e As System.EventArgs) Handles Prog_Lok16.Elapsed

        '*** Fahrprogramm E120 139-1
        '*** Datum: 23.02.2020

        SetText(TextBox1, "E-Lok 120 139-1                                                         IBS: 02.05.2021 - V3 : 8")
        LoadImage(PictureBox1, "H:\\EB_Media\\LokFotos\\Baureihe_120_20.jpg")
        GeschwindikeitenSetzen(16)

        Dim Stufe1, Stufe2, Stufe3, Stufe4 As Integer
        Dim Stufe11, Stufe12, Stufe13, Stufe14, Stufe21, Stufe22, Stufe23, Stufe24 As Integer
        Dim V_100, V_130, V_160, V_180, V_500 As Integer
        Dim T_100, T_130, T_160, T_180, T_500 As Integer
        Dim G_200 As Integer

        T_100 = _Betriebsparameter.Fahrparameter(16, KlausEBspecific.Betriebsparameter.FahrparameterEnum.T_100)
        T_130 = _Betriebsparameter.Fahrparameter(16, KlausEBspecific.Betriebsparameter.FahrparameterEnum.T_130)
        T_160 = _Betriebsparameter.Fahrparameter(16, KlausEBspecific.Betriebsparameter.FahrparameterEnum.T_160)
        T_180 = _Betriebsparameter.Fahrparameter(16, KlausEBspecific.Betriebsparameter.FahrparameterEnum.T_180)
        T_500 = _Betriebsparameter.Fahrparameter(16, KlausEBspecific.Betriebsparameter.FahrparameterEnum.T_500)
        V_100 = _Betriebsparameter.Fahrparameter(16, KlausEBspecific.Betriebsparameter.FahrparameterEnum.V_100)
        V_130 = _Betriebsparameter.Fahrparameter(16, KlausEBspecific.Betriebsparameter.FahrparameterEnum.V_130)
        V_160 = _Betriebsparameter.Fahrparameter(16, KlausEBspecific.Betriebsparameter.FahrparameterEnum.V_160)
        V_180 = _Betriebsparameter.Fahrparameter(16, KlausEBspecific.Betriebsparameter.FahrparameterEnum.V_180)
        V_500 = _Betriebsparameter.Fahrparameter(16, KlausEBspecific.Betriebsparameter.FahrparameterEnum.V_500)
        G_200 = _Betriebsparameter.Fahrparameter(16, KlausEBspecific.Betriebsparameter.FahrparameterEnum.G_200)

        If A_StopB = 1 Then
            V_100 = 8000
        End If

        Stufe1 = _LokStufen.Holen(16, 1)
        Stufe2 = _LokStufen.Holen(16, 2)
        Stufe3 = _LokStufen.Holen(16, 3)
        Stufe4 = _LokStufen.Holen(16, 4)

        If Stufe2 = 1 Then
            T_100 = T_100
            T_130 = T_130
            T_160 = T_160
            V_180 = V_180
        ElseIf Stufe2 = 2 Then
            T_100 = T_100 + 300
            T_130 = T_130 + 300
            T_160 = T_160 + 300
            V_180 = V_180 + 500
        ElseIf Stufe2 = 3 Then
            T_100 = T_100 + 500
            T_130 = T_130 + 500
            T_160 = T_160 + 500
            V_180 = V_180 + 1000
        ElseIf Stufe2 = 4 Then
            T_100 = T_100 + 700
            T_130 = T_130 + 700
            T_160 = T_160 + 700
            V_180 = V_180 + 1500
        ElseIf Stufe2 = 5 Then
            T_100 = T_100 + 900
            T_130 = T_130 + 900
            T_160 = T_160 + 900
            V_180 = V_180 + 2000
        ElseIf Stufe2 = 6 Then
            T_100 = T_100 + 1200
            T_130 = T_130 + 1200
            T_160 = T_160 + 1200
            V_180 = V_180 + 2500
        Else
            T_100 = T_100 + 1200
            T_130 = T_130 + 1200
            T_160 = T_160 + 1200
            V_180 = V_180 + 2500
        End If

        Stufe2 = Stufe1

        Stufe11 = Stufe1 + 1
        If Stufe11 > Stufe3 Then
            Stufe11 = Stufe3
        End If
        Stufe12 = Stufe1 + 2
        If Stufe12 > Stufe3 Then
            Stufe12 = Stufe3
        End If
        Stufe13 = Stufe1 + 3
        If Stufe13 > Stufe3 Then
            Stufe13 = Stufe3
        End If
        Stufe14 = Stufe1 + 4
        If Stufe14 > Stufe3 Then
            Stufe14 = Stufe3
        End If

        Stufe21 = Stufe2 + 1
        If Stufe21 > Stufe3 Then
            Stufe21 = Stufe3
        End If
        Stufe22 = Stufe2 + 2
        If Stufe22 > Stufe3 Then
            Stufe22 = Stufe3
        End If
        Stufe23 = Stufe2 + 3
        If Stufe23 > Stufe3 Then
            Stufe23 = Stufe3
        End If
        Stufe24 = Stufe2 + 4
        If Stufe24 > Stufe3 Then
            Stufe24 = Stufe3
        End If
        If G_200 > 0 Then
            If G_200 < Stufe4 Then
                G_200 = Stufe4
            End If
        Else
            G_200 = Stufe4
        End If

        If Betriebsart = 1 And (_GlsL16 = 3 Or _GlsL16 = 4) Then
            SetProgramCounterLabel1(_Prog16)
        Else
            SetProgramCounterLabel(_Prog16)
        End If

        ' Lok starten - Bahnhofsausfahrt

        If _Prog16 = 0 Then
            Prog_Lok16.Interval = 2000
            If _Fahrzeugbeleuchtung2 > 0 Then
                _eb.lokSteuern(16, Klassen.LokEigenschaften.Hauptfunktion, 1) ' Licht ein
            End If
        ElseIf _Prog16 = 1 Then
        ElseIf _Prog16 = 2 Then
            _Betriebsparameter.RundenErhoehen(16)
        ElseIf _Prog16 = 3 Then
        ElseIf _Prog16 = 4 Then
        ElseIf _Prog16 = 5 Then
        ElseIf _Prog16 = 6 Then

            ' Bahnhofsausfahrt

        ElseIf _Prog16 = 7 Then
            _eb.lokSteuern(16, Klassen.LokEigenschaften.Geschwindigkeit, Stufe1)
        ElseIf _Prog16 = 8 Then
            _eb.lokSteuern(16, Klassen.LokEigenschaften.Geschwindigkeit, Stufe11)
        ElseIf _Prog16 = 9 Then
            _eb.lokSteuern(16, Klassen.LokEigenschaften.Geschwindigkeit, Stufe12)
        ElseIf _Prog16 = 10 Then
            _eb.lokSteuern(16, Klassen.LokEigenschaften.Geschwindigkeit, Stufe13)
        ElseIf _Prog16 = 11 Then
            _eb.lokSteuern(16, Klassen.LokEigenschaften.Geschwindigkeit, Stufe14)
        ElseIf _Prog16 = 12 Then
            _eb.lokSteuern(16, Klassen.LokEigenschaften.Geschwindigkeit, Stufe3)

            ' Lok abstellen

        ElseIf _Prog16 = 50 Then
            Prog_Lok16.Interval = 2000
        ElseIf _Prog16 = 51 Then
        ElseIf _Prog16 = 52 Then
            If _Fahrzeugbeleuchtung2 < 2 Then
                _eb.lokSteuern(16, Klassen.LokEigenschaften.Hauptfunktion, 0) ' Licht aus
            End If

            ' Lok bremsen (Bahnhofseinfahrt Normalzug von links und von rechts)

        ElseIf _Prog16 = 100 Then
            Prog_Lok16.Interval = V_100
        ElseIf _Prog16 = 101 Then
            _eb.lokSteuern(16, Klassen.LokEigenschaften.Geschwindigkeit, Stufe24)
            Prog_Lok16.Interval = T_100
        ElseIf _Prog16 = 102 Then
            _eb.lokSteuern(16, Klassen.LokEigenschaften.Geschwindigkeit, Stufe23)
        ElseIf _Prog16 = 103 Then
            _eb.lokSteuern(16, Klassen.LokEigenschaften.Geschwindigkeit, Stufe22)
        ElseIf _Prog16 = 104 Then
            _eb.lokSteuern(16, Klassen.LokEigenschaften.Geschwindigkeit, Stufe21)
        ElseIf _Prog16 = 105 Then
            _eb.lokSteuern(16, Klassen.LokEigenschaften.Geschwindigkeit, Stufe2)

            ' Lok bremsen (Bahnhofseinfahrt Kurzzug von links)

        ElseIf _Prog16 = 130 Then
            Prog_Lok16.Interval = V_130
        ElseIf _Prog16 = 131 Then
            _eb.lokSteuern(16, Klassen.LokEigenschaften.Geschwindigkeit, Stufe24)
            Prog_Lok16.Interval = T_130
        ElseIf _Prog16 = 132 Then
            _eb.lokSteuern(16, Klassen.LokEigenschaften.Geschwindigkeit, Stufe23)
        ElseIf _Prog16 = 133 Then
            _eb.lokSteuern(16, Klassen.LokEigenschaften.Geschwindigkeit, Stufe22)
        ElseIf _Prog16 = 134 Then
            _eb.lokSteuern(16, Klassen.LokEigenschaften.Geschwindigkeit, Stufe21)
        ElseIf _Prog16 = 135 Then
            _eb.lokSteuern(16, Klassen.LokEigenschaften.Geschwindigkeit, Stufe2)
        ElseIf _Prog16 = 136 Then
            _eb.lokSteuern(16, Klassen.LokEigenschaften.Geschwindigkeit, 0)
        ElseIf _Prog16 = 137 Then
            Prog_Lok16.Interval = 2000
        ElseIf _Prog16 = 138 Then
            If _Fahrzeugbeleuchtung2 < 2 Then
                _eb.lokSteuern(16, Klassen.LokEigenschaften.Hauptfunktion, 0) ' Licht aus
            End If

            ' Lok bremsen (Bahnhofseinfahrt Kurzzug von rechts)

        ElseIf _Prog16 = 160 Then
            Prog_Lok16.Interval = V_160
        ElseIf _Prog16 = 161 Then
            _eb.lokSteuern(16, Klassen.LokEigenschaften.Geschwindigkeit, Stufe24)
            Prog_Lok16.Interval = T_160
        ElseIf _Prog16 = 162 Then
            _eb.lokSteuern(16, Klassen.LokEigenschaften.Geschwindigkeit, Stufe23)
        ElseIf _Prog16 = 163 Then
            _eb.lokSteuern(16, Klassen.LokEigenschaften.Geschwindigkeit, Stufe22)
        ElseIf _Prog16 = 164 Then
            _eb.lokSteuern(16, Klassen.LokEigenschaften.Geschwindigkeit, Stufe21)
        ElseIf _Prog16 = 165 Then
            _eb.lokSteuern(16, Klassen.LokEigenschaften.Geschwindigkeit, Stufe2)
        ElseIf _Prog16 = 166 Then
            _eb.lokSteuern(16, Klassen.LokEigenschaften.Geschwindigkeit, 0)
        ElseIf _Prog16 = 167 Then
            Prog_Lok16.Interval = 2000
        ElseIf _Prog16 = 168 Then
            If _Fahrzeugbeleuchtung2 < 2 Then
                _eb.lokSteuern(16, Klassen.LokEigenschaften.Hauptfunktion, 0) ' Licht aus
            End If

            ' Rangierzug

        ElseIf _Prog16 = 180 Then
            _eb.lokSteuern(16, Klassen.LokEigenschaften.Geschwindigkeit, 2)
            Prog_Lok16.Interval = V_180
        ElseIf _Prog16 = 181 Then
            Prog_Lok16.Interval = T_180
            _eb.lokSteuern(16, Klassen.LokEigenschaften.Geschwindigkeit, 1)
        ElseIf _Prog16 = 182 Then
            _eb.lokSteuern(16, Klassen.LokEigenschaften.Geschwindigkeit, 0)

            ' Tunnelausfahrt

        ElseIf _Prog16 = 200 Then ' Kontakt 1.2 <- (bergauf)
            _eb.lokSteuern(16, Klassen.LokEigenschaften.Geschwindigkeit, G_200)
            Prog_Lok16.Interval = 2000
        ElseIf _Prog16 = 201 Then
        ElseIf _Prog16 = 202 Then
        ElseIf _Prog16 = 203 Then
        ElseIf _Prog16 = 204 Then
        ElseIf _Prog16 = 205 Then
            If Stufe4 < Stufe3 Then
                _eb.lokSteuern(16, Klassen.LokEigenschaften.Geschwindigkeit, Stufe3)
            Else
                _eb.lokSteuern(16, Klassen.LokEigenschaften.Geschwindigkeit, Stufe4)
            End If

        ElseIf _Prog16 = 220 Then ' Kontakt 3.1 -> (hinter dem Martinstor bergauf)
            Prog_Lok16.Interval = 2000
        ElseIf _Prog16 = 221 Then
        ElseIf _Prog16 = 222 Then

        ElseIf _Prog16 = 240 Then ' Kontakt 3.7 <- (hinter der Brücke bergauf)
            Prog_Lok16.Interval = 2000
        ElseIf _Prog16 = 241 Then
        ElseIf _Prog16 = 242 Then

        ElseIf _Prog16 = 260 Then ' Kontakt 3.3 (links bzw vor der Brücke)
            Prog_Lok16.Interval = 2000
        ElseIf _Prog16 = 261 Then
        ElseIf _Prog16 = 262 Then
            _eb.lokSteuern(16, Klassen.LokEigenschaften.Geschwindigkeit, Stufe3)

        ElseIf _Prog16 = 600 Then ' Kontakt 3.5 <- (unter der Burg)
            Prog_Lok16.Interval = 2000
        ElseIf _Prog16 = 601 Then
        ElseIf _Prog16 = 602 Then

        ElseIf _Prog16 = 620 Then ' Kontakt 3.7 -> (hinter der Brücke bergab)
            Prog_Lok16.Interval = 2000
        ElseIf _Prog16 = 621 Then
        ElseIf _Prog16 = 622 Then

        ElseIf _Prog16 = 640 Then ' Kontakt 3.1 <- Talfahrt
            Prog_Lok16.Interval = 2000
        ElseIf _Prog16 = 641 Then
        ElseIf _Prog16 = 641 Then

        ElseIf _Prog16 = 660 Then ' Kontakt 1.2 -> Talfahrt
            Prog_Lok16.Interval = 2000
        ElseIf _Prog16 = 661 Then
        ElseIf _Prog16 = 662 Then

        ElseIf _Prog16 = 700 Then ' Kontakt 0.4 <- Diagonale
            Prog_Lok16.Interval = 2000
        ElseIf _Prog16 = 701 Then
        ElseIf _Prog16 = 702 Then

            ' Zindelstein

        ElseIf _Prog16 = 500 Then
            Prog_Lok16.Interval = V_500
        ElseIf _Prog16 = 501 Then
            _eb.lokSteuern(16, Klassen.LokEigenschaften.Geschwindigkeit, Stufe23)
            Prog_Lok16.Interval = T_500
        ElseIf _Prog16 = 502 Then
            _eb.lokSteuern(16, Klassen.LokEigenschaften.Geschwindigkeit, Stufe22)
        ElseIf _Prog16 = 503 Then
            _eb.lokSteuern(16, Klassen.LokEigenschaften.Geschwindigkeit, Stufe21)
        ElseIf _Prog16 = 503 Then
            _eb.lokSteuern(16, Klassen.LokEigenschaften.Geschwindigkeit, Stufe2)
        ElseIf _Prog16 = 504 Then
            _eb.lokSteuern(16, Klassen.LokEigenschaften.Geschwindigkeit, 0)

        Else
            _Prog16 = 0
            Prog_Lok16.Stop()
            Prog_Lok16.Interval = 200
            If Betriebsart = 1 Then
                SetProgramCounterLabel1(String.Empty)
            Else
                SetProgramCounterLabel(String.Empty)
            End If
        End If
        _Prog16 = _Prog16 + 1
    End Sub
    Private Sub HandleTimerElapsed29(sender As System.Object, e As System.EventArgs) Handles Prog_Lok17.Elapsed

        '*** Fahrprogramm für E-Lok 12X 001-5
        '*** Datum: 13.12.2020

        SetText(TextBox1, "E-Lok 12X 001-5                                                         IBS: 03.02.2023 - V3: 9")
        LoadImage(PictureBox1, "H:\\EB_Media\\LokFotos\\Baureihe_12X_01.jpg")
        GeschwindikeitenSetzen(17)

        Dim Stufe1, Stufe2, Stufe3, Stufe4 As Integer
        Dim Stufe11, Stufe12, Stufe13, Stufe14, Stufe21, Stufe22, Stufe23, Stufe24 As Integer
        Dim V_100, V_130, V_160, V_180, V_500 As Integer
        Dim T_100, T_130, T_160, T_180, T_500 As Integer
        Dim G_200 As Integer

        T_100 = _Betriebsparameter.Fahrparameter(17, KlausEBspecific.Betriebsparameter.FahrparameterEnum.T_100)
        T_130 = _Betriebsparameter.Fahrparameter(17, KlausEBspecific.Betriebsparameter.FahrparameterEnum.T_130)
        T_160 = _Betriebsparameter.Fahrparameter(17, KlausEBspecific.Betriebsparameter.FahrparameterEnum.T_160)
        T_180 = _Betriebsparameter.Fahrparameter(17, KlausEBspecific.Betriebsparameter.FahrparameterEnum.T_180)
        T_500 = _Betriebsparameter.Fahrparameter(17, KlausEBspecific.Betriebsparameter.FahrparameterEnum.T_500)
        V_100 = _Betriebsparameter.Fahrparameter(17, KlausEBspecific.Betriebsparameter.FahrparameterEnum.V_100)
        V_130 = _Betriebsparameter.Fahrparameter(17, KlausEBspecific.Betriebsparameter.FahrparameterEnum.V_130)
        V_160 = _Betriebsparameter.Fahrparameter(17, KlausEBspecific.Betriebsparameter.FahrparameterEnum.V_160)
        V_180 = _Betriebsparameter.Fahrparameter(17, KlausEBspecific.Betriebsparameter.FahrparameterEnum.V_180)
        V_500 = _Betriebsparameter.Fahrparameter(17, KlausEBspecific.Betriebsparameter.FahrparameterEnum.V_500)
        G_200 = _Betriebsparameter.Fahrparameter(17, KlausEBspecific.Betriebsparameter.FahrparameterEnum.G_200)

        If A_StopB = 1 Then
            V_100 = 8000
        End If

        Stufe1 = _LokStufen.Holen(17, 1)
        Stufe2 = _LokStufen.Holen(17, 2)
        Stufe3 = _LokStufen.Holen(17, 3)
        Stufe4 = _LokStufen.Holen(17, 4)

        If Stufe2 = 1 Then
            T_100 = T_100
            T_130 = T_130
            T_160 = T_160
            V_180 = V_180
        ElseIf Stufe2 = 2 Then
            T_100 = T_100 + 200
            T_130 = T_130 + 200
            T_160 = T_160 + 200
            V_180 = V_180 + 200
        ElseIf Stufe2 = 3 Then
            T_100 = T_100 + 400
            T_130 = T_130 + 400
            T_160 = T_160 + 400
            V_180 = V_180 + 400
        ElseIf Stufe2 = 4 Then
            T_100 = T_100 + 500
            T_130 = T_130 + 500
            T_160 = T_160 + 500
            V_180 = V_180 + 500
        ElseIf Stufe2 = 5 Then
            T_100 = T_100 + 600
            T_130 = T_130 + 600
            T_160 = T_160 + 600
            V_180 = V_180 + 600
        ElseIf Stufe2 = 6 Then
            T_100 = T_100 + 800
            T_130 = T_130 + 800
            T_160 = T_160 + 800
            V_180 = V_180 + 800
        Else
            T_100 = T_100 + 500
            T_130 = T_130 + 500
            T_160 = T_160 + 500
            V_180 = V_180 + 500
        End If

        Stufe2 = Stufe1

        Stufe11 = Stufe1 + 1
        If Stufe11 > Stufe3 Then
            Stufe11 = Stufe3
        End If
        Stufe12 = Stufe1 + 2
        If Stufe12 > Stufe3 Then
            Stufe12 = Stufe3
        End If
        Stufe13 = Stufe1 + 3
        If Stufe13 > Stufe3 Then
            Stufe13 = Stufe3
        End If
        Stufe14 = Stufe1 + 4
        If Stufe14 > Stufe3 Then
            Stufe14 = Stufe3
        End If

        Stufe21 = Stufe2 + 1
        If Stufe21 > Stufe3 Then
            Stufe21 = Stufe3
        End If
        Stufe22 = Stufe2 + 2
        If Stufe22 > Stufe3 Then
            Stufe22 = Stufe3
        End If
        Stufe23 = Stufe2 + 3
        If Stufe23 > Stufe3 Then
            Stufe23 = Stufe3
        End If
        Stufe24 = Stufe2 + 4
        If Stufe24 > Stufe3 Then
            Stufe24 = Stufe3
        End If
        If G_200 > 0 Then
            If G_200 < Stufe4 Then
                G_200 = Stufe4
            End If
        Else
            G_200 = Stufe4
        End If

        If Betriebsart = 1 And (_GlsL17 = 3 Or _GlsL17 = 4) Then
            SetProgramCounterLabel1(_Prog17)
        Else
            SetProgramCounterLabel(_Prog17)
        End If

        ' Lok starten - Bahnhofsausfahrt

        If _Prog17 = 0 Then
            Prog_Lok17.Interval = 2000
            If _Fernlicht > 0 Then
                _eb.lokSteuern(17, Klassen.LokEigenschaften.Hauptfunktion, 1) ' Licht ein
            End If
        ElseIf _Prog17 = 1 Then
        ElseIf _Prog17 = 2 Then
            _Betriebsparameter.RundenErhoehen(17)
        ElseIf _Prog17 = 3 Then
        ElseIf _Prog17 = 4 Then
        ElseIf _Prog17 = 5 Then
        ElseIf _Prog17 = 6 Then

            ' Bahnhofsausfahrt

        ElseIf _Prog17 = 7 Then
            _eb.lokSteuern(17, Klassen.LokEigenschaften.Geschwindigkeit, Stufe1)
        ElseIf _Prog17 = 8 Then
            _eb.lokSteuern(17, Klassen.LokEigenschaften.Geschwindigkeit, Stufe11)
        ElseIf _Prog17 = 9 Then
            _eb.lokSteuern(17, Klassen.LokEigenschaften.Geschwindigkeit, Stufe12)
        ElseIf _Prog17 = 10 Then
            _eb.lokSteuern(17, Klassen.LokEigenschaften.Geschwindigkeit, Stufe13)
        ElseIf _Prog17 = 11 Then
            _eb.lokSteuern(17, Klassen.LokEigenschaften.Geschwindigkeit, Stufe14)
        ElseIf _Prog17 = 12 Then
            _eb.lokSteuern(17, Klassen.LokEigenschaften.Geschwindigkeit, Stufe3)

            ' Lok abstellen

        ElseIf _Prog17 = 50 Then
            Prog_Lok17.Interval = 2000
        ElseIf _Prog17 = 51 Then
        ElseIf _Prog17 = 52 Then
            If _Fernlicht < 2 Then
                _eb.lokSteuern(17, Klassen.LokEigenschaften.Hauptfunktion, 0) ' Licht aus
            End If

            ' Lok bremsen (Bahnhofseinfahrt Normalzug von links und von rechts)

        ElseIf _Prog17 = 100 Then
            Prog_Lok17.Interval = V_100
        ElseIf _Prog17 = 101 Then
            _eb.lokSteuern(17, Klassen.LokEigenschaften.Geschwindigkeit, Stufe24)
            Prog_Lok17.Interval = T_100
        ElseIf _Prog17 = 102 Then
            _eb.lokSteuern(17, Klassen.LokEigenschaften.Geschwindigkeit, Stufe23)
        ElseIf _Prog17 = 103 Then
            _eb.lokSteuern(17, Klassen.LokEigenschaften.Geschwindigkeit, Stufe22)
        ElseIf _Prog17 = 104 Then
            _eb.lokSteuern(17, Klassen.LokEigenschaften.Geschwindigkeit, Stufe21)
        ElseIf _Prog17 = 105 Then
            _eb.lokSteuern(17, Klassen.LokEigenschaften.Geschwindigkeit, Stufe2)

            ' Lok bremsen (Bahnhofseinfahrt Kurzzug von links)

        ElseIf _Prog17 = 130 Then
            Prog_Lok17.Interval = V_130
        ElseIf _Prog17 = 131 Then
            _eb.lokSteuern(17, Klassen.LokEigenschaften.Geschwindigkeit, Stufe24)
            Prog_Lok17.Interval = T_130
        ElseIf _Prog17 = 132 Then
            _eb.lokSteuern(17, Klassen.LokEigenschaften.Geschwindigkeit, Stufe23)
        ElseIf _Prog17 = 133 Then
            _eb.lokSteuern(17, Klassen.LokEigenschaften.Geschwindigkeit, Stufe22)
        ElseIf _Prog17 = 134 Then
            _eb.lokSteuern(17, Klassen.LokEigenschaften.Geschwindigkeit, Stufe21)
        ElseIf _Prog17 = 135 Then
            _eb.lokSteuern(17, Klassen.LokEigenschaften.Geschwindigkeit, Stufe2)
        ElseIf _Prog17 = 136 Then
            _eb.lokSteuern(17, Klassen.LokEigenschaften.Geschwindigkeit, 0)
        ElseIf _Prog17 = 137 Then
            Prog_Lok17.Interval = 2000
        ElseIf _Prog17 = 138 Then
            If _Fahrzeugbeleuchtung2 < 2 Then
                _eb.lokSteuern(17, Klassen.LokEigenschaften.Hauptfunktion, 0) ' Licht aus
            End If

            ' Lok bremsen (Bahnhofseinfahrt Kurzzug von rechts)

        ElseIf _Prog17 = 160 Then
            Prog_Lok17.Interval = V_160
        ElseIf _Prog17 = 161 Then
            _eb.lokSteuern(17, Klassen.LokEigenschaften.Geschwindigkeit, Stufe24)
            Prog_Lok17.Interval = T_160
        ElseIf _Prog17 = 162 Then
            _eb.lokSteuern(17, Klassen.LokEigenschaften.Geschwindigkeit, Stufe23)
        ElseIf _Prog17 = 163 Then
            _eb.lokSteuern(17, Klassen.LokEigenschaften.Geschwindigkeit, Stufe22)
        ElseIf _Prog17 = 164 Then
            _eb.lokSteuern(17, Klassen.LokEigenschaften.Geschwindigkeit, Stufe21)
        ElseIf _Prog17 = 165 Then
            _eb.lokSteuern(17, Klassen.LokEigenschaften.Geschwindigkeit, Stufe2)
        ElseIf _Prog17 = 166 Then
            _eb.lokSteuern(17, Klassen.LokEigenschaften.Geschwindigkeit, 0)
        ElseIf _Prog17 = 167 Then
            Prog_Lok17.Interval = 2000
        ElseIf _Prog17 = 168 Then
            If _Fahrzeugbeleuchtung2 < 2 Then
                _eb.lokSteuern(17, Klassen.LokEigenschaften.Hauptfunktion, 0) ' Licht aus
            End If

            ' Rangierzug

        ElseIf _Prog17 = 180 Then
            _eb.lokSteuern(17, Klassen.LokEigenschaften.Geschwindigkeit, 2)
            Prog_Lok17.Interval = V_180
        ElseIf _Prog17 = 181 Then
            Prog_Lok17.Interval = T_180
            _eb.lokSteuern(17, Klassen.LokEigenschaften.Geschwindigkeit, 1)
        ElseIf _Prog17 = 182 Then
            _eb.lokSteuern(17, Klassen.LokEigenschaften.Geschwindigkeit, 0)

            ' Tunnelausfahrt

        ElseIf _Prog17 = 200 Then ' Kontakt 1.2 <- (bergauf)
            _eb.lokSteuern(17, Klassen.LokEigenschaften.Geschwindigkeit, G_200)
            Prog_Lok17.Interval = 2000
        ElseIf _Prog17 = 201 Then
        ElseIf _Prog17 = 202 Then
        ElseIf _Prog17 = 203 Then
        ElseIf _Prog17 = 204 Then
        ElseIf _Prog17 = 205 Then
            If Stufe4 < Stufe3 Then
                _eb.lokSteuern(17, Klassen.LokEigenschaften.Geschwindigkeit, Stufe3)
            Else
                _eb.lokSteuern(17, Klassen.LokEigenschaften.Geschwindigkeit, Stufe4)
            End If

        ElseIf _Prog17 = 220 Then ' Kontakt 3.1 -> (hinter dem Martinstor bergauf)
            Prog_Lok17.Interval = 2000
        ElseIf _Prog17 = 221 Then
        ElseIf _Prog17 = 222 Then

        ElseIf _Prog17 = 240 Then ' Kontakt 3.7 <- (hinter der Brücke bergauf)
            Prog_Lok17.Interval = 2000
        ElseIf _Prog17 = 241 Then
        ElseIf _Prog17 = 242 Then

        ElseIf _Prog17 = 260 Then ' Kontakt 3.3 (links bzw vor der Brücke)
            Prog_Lok17.Interval = 2000
        ElseIf _Prog17 = 261 Then
        ElseIf _Prog17 = 262 Then
            _eb.lokSteuern(17, Klassen.LokEigenschaften.Geschwindigkeit, Stufe3)

        ElseIf _Prog17 = 600 Then ' Kontakt 3.5 <- (unter der Burg)
            Prog_Lok17.Interval = 2000
        ElseIf _Prog17 = 601 Then
        ElseIf _Prog17 = 602 Then

        ElseIf _Prog17 = 620 Then ' Kontakt 3.7 -> (hinter der Brücke bergab)
            Prog_Lok17.Interval = 2000
        ElseIf _Prog17 = 621 Then
        ElseIf _Prog17 = 622 Then

        ElseIf _Prog17 = 640 Then ' Kontakt 3.1 <- Talfahrt
            Prog_Lok17.Interval = 2000
        ElseIf _Prog17 = 641 Then
        ElseIf _Prog17 = 642 Then

        ElseIf _Prog17 = 660 Then ' Kontakt 1.2 -> Talfahrt
            Prog_Lok17.Interval = 2000
        ElseIf _Prog17 = 661 Then
        ElseIf _Prog17 = 662 Then

        ElseIf _Prog17 = 700 Then ' Kontakt 0.4 <- Diagonale
            Prog_Lok17.Interval = 2000
        ElseIf _Prog17 = 701 Then
        ElseIf _Prog17 = 702 Then

            ' Zindelstein

        ElseIf _Prog17 = 500 Then
            Prog_Lok17.Interval = V_500
        ElseIf _Prog17 = 501 Then
            _eb.lokSteuern(17, Klassen.LokEigenschaften.Geschwindigkeit, Stufe23)
            Prog_Lok17.Interval = T_500
        ElseIf _Prog17 = 502 Then
            _eb.lokSteuern(17, Klassen.LokEigenschaften.Geschwindigkeit, Stufe22)
        ElseIf _Prog17 = 503 Then
            _eb.lokSteuern(17, Klassen.LokEigenschaften.Geschwindigkeit, Stufe21)
        ElseIf _Prog17 = 504 Then
            _eb.lokSteuern(17, Klassen.LokEigenschaften.Geschwindigkeit, Stufe2)
        ElseIf _Prog17 = 505 Then
            _eb.lokSteuern(17, Klassen.LokEigenschaften.Geschwindigkeit, 0)

        Else
            _Prog17 = 0
            Prog_Lok17.Stop()
            Prog_Lok17.Interval = 200
            If Betriebsart = 1 Then
                SetProgramCounterLabel1(String.Empty)
            Else
                SetProgramCounterLabel(String.Empty)
            End If
        End If
        _Prog17 = _Prog17 + 1
    End Sub
    Private Sub HandleTimerElapsed30(sender As System.Object, e As System.EventArgs) Handles Prog_Lok18.Elapsed

        '*** Fahrprogramm E118 024-9
        '*** Datum: 23.02.2020

        SetText(TextBox1, "E-Lok 118 024-9                                                         IBS: 07.02.2021 - V3 : 7")
        LoadImage(PictureBox1, "H:\\EB_Media\\LokFotos\\Baureihe_118_01.jpg")
        GeschwindikeitenSetzen(18)

        Dim Stufe1, Stufe2, Stufe3, Stufe4 As Integer
        Dim Stufe11, Stufe12, Stufe13, Stufe14, Stufe21, Stufe22, Stufe23, Stufe24 As Integer
        Dim V_100, V_130, V_160, V_180, V_500 As Integer
        Dim T_100, T_130, T_160, T_180, T_500 As Integer
        Dim G_200 As Integer

        T_100 = _Betriebsparameter.Fahrparameter(18, KlausEBspecific.Betriebsparameter.FahrparameterEnum.T_100)
        T_130 = _Betriebsparameter.Fahrparameter(18, KlausEBspecific.Betriebsparameter.FahrparameterEnum.T_130)
        T_160 = _Betriebsparameter.Fahrparameter(18, KlausEBspecific.Betriebsparameter.FahrparameterEnum.T_160)
        T_180 = _Betriebsparameter.Fahrparameter(18, KlausEBspecific.Betriebsparameter.FahrparameterEnum.T_180)
        T_500 = _Betriebsparameter.Fahrparameter(18, KlausEBspecific.Betriebsparameter.FahrparameterEnum.T_500)
        V_100 = _Betriebsparameter.Fahrparameter(18, KlausEBspecific.Betriebsparameter.FahrparameterEnum.V_100)
        V_130 = _Betriebsparameter.Fahrparameter(18, KlausEBspecific.Betriebsparameter.FahrparameterEnum.V_130)
        V_160 = _Betriebsparameter.Fahrparameter(18, KlausEBspecific.Betriebsparameter.FahrparameterEnum.V_160)
        V_180 = _Betriebsparameter.Fahrparameter(18, KlausEBspecific.Betriebsparameter.FahrparameterEnum.V_180)
        V_500 = _Betriebsparameter.Fahrparameter(18, KlausEBspecific.Betriebsparameter.FahrparameterEnum.V_500)
        G_200 = _Betriebsparameter.Fahrparameter(18, KlausEBspecific.Betriebsparameter.FahrparameterEnum.G_200)

        If A_StopB = 1 Then
            V_100 = 3000
        End If

        Stufe1 = _LokStufen.Holen(18, 1)
        Stufe2 = _LokStufen.Holen(18, 2)
        Stufe3 = _LokStufen.Holen(18, 3)
        Stufe4 = _LokStufen.Holen(18, 4)

        If Stufe2 = 1 Then
            T_100 = T_100
            T_130 = T_130
            T_160 = T_160
            V_180 = V_180
        ElseIf Stufe2 = 2 Then
            T_100 = T_100 + 300
            T_130 = T_130 + 300
            T_160 = T_160 + 300
            V_180 = V_180 + 500
        ElseIf Stufe2 = 3 Then
            T_100 = T_100 + 500
            T_130 = T_130 + 500
            T_160 = T_160 + 500
            V_180 = V_180 + 1000
        ElseIf Stufe2 = 4 Then
            T_100 = T_100 + 700
            T_130 = T_130 + 700
            T_160 = T_160 + 700
            V_180 = V_180 + 1500
        ElseIf Stufe2 = 5 Then
            T_100 = T_100 + 900
            T_130 = T_130 + 900
            T_160 = T_160 + 900
            V_180 = V_180 + 2000
        ElseIf Stufe2 = 6 Then
            T_100 = T_100 + 1200
            T_130 = T_130 + 1200
            T_160 = T_160 + 1200
            V_180 = V_180 + 2500
        Else
            T_100 = T_100 + 1200
            T_130 = T_130 + 1200
            T_160 = T_160 + 1200
            V_180 = V_180 + 2500
        End If

        Stufe2 = Stufe1

        Stufe11 = Stufe1 + 1
        If Stufe11 > Stufe3 Then
            Stufe11 = Stufe3
        End If
        Stufe12 = Stufe1 + 2
        If Stufe12 > Stufe3 Then
            Stufe12 = Stufe3
        End If
        Stufe13 = Stufe1 + 3
        If Stufe13 > Stufe3 Then
            Stufe13 = Stufe3
        End If
        Stufe14 = Stufe1 + 4
        If Stufe14 > Stufe3 Then
            Stufe14 = Stufe3
        End If

        Stufe21 = Stufe2 + 1
        If Stufe21 > Stufe3 Then
            Stufe21 = Stufe3
        End If
        Stufe22 = Stufe2 + 2
        If Stufe22 > Stufe3 Then
            Stufe22 = Stufe3
        End If
        Stufe23 = Stufe2 + 3
        If Stufe23 > Stufe3 Then
            Stufe23 = Stufe3
        End If
        Stufe24 = Stufe2 + 4
        If Stufe24 > Stufe3 Then
            Stufe24 = Stufe3
        End If
        If G_200 > 0 Then
            If G_200 < Stufe4 Then
                G_200 = Stufe4
            End If
        Else
            G_200 = Stufe4
        End If

        If Betriebsart = 1 And (_GlsL18 = 3 Or _GlsL18 = 4) Then
            SetProgramCounterLabel1(_Prog18)
        Else
            SetProgramCounterLabel(_Prog18)
        End If

        ' Lok starten - Bahnhofsausfahrt

        If _Prog18 = 0 Then
            Prog_Lok18.Interval = 2000
            If _Fahrzeugbeleuchtung2 > 0 Then
                _eb.lokSteuern(18, Klassen.LokEigenschaften.Hauptfunktion, 1) ' Licht ein
            End If
        ElseIf _Prog18 = 1 Then
        ElseIf _Prog18 = 2 Then
            _Betriebsparameter.RundenErhoehen(18)
        ElseIf _Prog18 = 3 Then
        ElseIf _Prog18 = 4 Then
        ElseIf _Prog18 = 5 Then
        ElseIf _Prog18 = 6 Then

            ' Bahnhofsausfahrt

        ElseIf _Prog18 = 7 Then
            _eb.lokSteuern(18, Klassen.LokEigenschaften.Geschwindigkeit, Stufe1)
        ElseIf _Prog18 = 8 Then
            _eb.lokSteuern(18, Klassen.LokEigenschaften.Geschwindigkeit, Stufe11)
        ElseIf _Prog18 = 9 Then
            _eb.lokSteuern(18, Klassen.LokEigenschaften.Geschwindigkeit, Stufe12)
        ElseIf _Prog18 = 10 Then
            _eb.lokSteuern(18, Klassen.LokEigenschaften.Geschwindigkeit, Stufe13)
        ElseIf _Prog18 = 11 Then
            _eb.lokSteuern(18, Klassen.LokEigenschaften.Geschwindigkeit, Stufe14)
        ElseIf _Prog18 = 12 Then
            _eb.lokSteuern(18, Klassen.LokEigenschaften.Geschwindigkeit, Stufe3)

            ' Lok abstellen

        ElseIf _Prog18 = 50 Then
            Prog_Lok18.Interval = 2000
        ElseIf _Prog18 = 51 Then
        ElseIf _Prog18 = 52 Then
            If _Fahrzeugbeleuchtung2 < 2 Then
                _eb.lokSteuern(18, Klassen.LokEigenschaften.Hauptfunktion, 0) ' Licht aus
            End If

            ' Lok bremsen (Bahnhofseinfahrt Normalzug von links und von rechts)

        ElseIf _Prog18 = 100 Then
            Prog_Lok18.Interval = V_100
        ElseIf _Prog18 = 101 Then
            _eb.lokSteuern(18, Klassen.LokEigenschaften.Geschwindigkeit, Stufe24)
            Prog_Lok18.Interval = T_100
        ElseIf _Prog18 = 102 Then
            _eb.lokSteuern(18, Klassen.LokEigenschaften.Geschwindigkeit, Stufe23)
        ElseIf _Prog18 = 103 Then
            _eb.lokSteuern(18, Klassen.LokEigenschaften.Geschwindigkeit, Stufe22)
        ElseIf _Prog18 = 104 Then
            _eb.lokSteuern(18, Klassen.LokEigenschaften.Geschwindigkeit, Stufe21)
        ElseIf _Prog18 = 105 Then
            _eb.lokSteuern(18, Klassen.LokEigenschaften.Geschwindigkeit, Stufe2)

            ' Lok bremsen (Bahnhofseinfahrt Kurzzug von links)

        ElseIf _Prog18 = 130 Then
            Prog_Lok18.Interval = V_130
        ElseIf _Prog18 = 131 Then
            _eb.lokSteuern(18, Klassen.LokEigenschaften.Geschwindigkeit, Stufe24)
            Prog_Lok18.Interval = T_130
        ElseIf _Prog18 = 132 Then
            _eb.lokSteuern(18, Klassen.LokEigenschaften.Geschwindigkeit, Stufe23)
        ElseIf _Prog18 = 133 Then
            _eb.lokSteuern(18, Klassen.LokEigenschaften.Geschwindigkeit, Stufe22)
        ElseIf _Prog18 = 134 Then
            _eb.lokSteuern(18, Klassen.LokEigenschaften.Geschwindigkeit, Stufe21)
        ElseIf _Prog18 = 135 Then
            _eb.lokSteuern(18, Klassen.LokEigenschaften.Geschwindigkeit, Stufe2)
        ElseIf _Prog18 = 136 Then
            _eb.lokSteuern(18, Klassen.LokEigenschaften.Geschwindigkeit, 0)
        ElseIf _Prog18 = 137 Then
            Prog_Lok18.Interval = 2000
        ElseIf _Prog18 = 138 Then
            If _Fahrzeugbeleuchtung2 < 2 Then
                _eb.lokSteuern(18, Klassen.LokEigenschaften.Hauptfunktion, 0) ' Licht aus
            End If

            ' Lok bremsen (Bahnhofseinfahrt Kurzzug von rechts)

        ElseIf _Prog18 = 160 Then
            Prog_Lok18.Interval = V_160
        ElseIf _Prog18 = 161 Then
            _eb.lokSteuern(18, Klassen.LokEigenschaften.Geschwindigkeit, Stufe24)
            Prog_Lok18.Interval = T_160
        ElseIf _Prog18 = 162 Then
            _eb.lokSteuern(18, Klassen.LokEigenschaften.Geschwindigkeit, Stufe23)
        ElseIf _Prog18 = 163 Then
            _eb.lokSteuern(18, Klassen.LokEigenschaften.Geschwindigkeit, Stufe22)
        ElseIf _Prog18 = 164 Then
            _eb.lokSteuern(18, Klassen.LokEigenschaften.Geschwindigkeit, Stufe21)
        ElseIf _Prog18 = 165 Then
            _eb.lokSteuern(18, Klassen.LokEigenschaften.Geschwindigkeit, Stufe2)
        ElseIf _Prog18 = 166 Then
            _eb.lokSteuern(18, Klassen.LokEigenschaften.Geschwindigkeit, 0)
        ElseIf _Prog18 = 167 Then
            Prog_Lok18.Interval = 2000
        ElseIf _Prog18 = 168 Then
            If _Fahrzeugbeleuchtung2 < 2 Then
                _eb.lokSteuern(18, Klassen.LokEigenschaften.Hauptfunktion, 0) ' Licht aus
            End If

            ' Rangierzug

        ElseIf _Prog18 = 180 Then
            _eb.lokSteuern(18, Klassen.LokEigenschaften.Geschwindigkeit, 2)
            Prog_Lok18.Interval = V_180
        ElseIf _Prog18 = 181 Then
            Prog_Lok18.Interval = T_180
            _eb.lokSteuern(18, Klassen.LokEigenschaften.Geschwindigkeit, 1)
        ElseIf _Prog18 = 182 Then
            _eb.lokSteuern(18, Klassen.LokEigenschaften.Geschwindigkeit, 0)

            ' Tunnelausfahrt

        ElseIf _Prog18 = 200 Then ' Kontakt 1.2 <- (bergauf)
            _eb.lokSteuern(18, Klassen.LokEigenschaften.Geschwindigkeit, G_200)
            Prog_Lok18.Interval = 2000
        ElseIf _Prog18 = 201 Then
        ElseIf _Prog18 = 202 Then
        ElseIf _Prog18 = 203 Then
        ElseIf _Prog18 = 204 Then
        ElseIf _Prog18 = 205 Then
            If Stufe4 < Stufe3 Then
                _eb.lokSteuern(18, Klassen.LokEigenschaften.Geschwindigkeit, Stufe3)
            Else
                _eb.lokSteuern(18, Klassen.LokEigenschaften.Geschwindigkeit, Stufe4)
            End If

        ElseIf _Prog18 = 220 Then ' Kontakt 3.1 -> (hinter dem Martinstor bergauf)
            Prog_Lok18.Interval = 2000
        ElseIf _Prog18 = 221 Then
        ElseIf _Prog18 = 222 Then

        ElseIf _Prog18 = 240 Then ' Kontakt 3.7 <- (hinter der Brücke bergauf)
            Prog_Lok18.Interval = 2000
        ElseIf _Prog18 = 241 Then
        ElseIf _Prog18 = 242 Then

        ElseIf _Prog18 = 260 Then ' Kontakt 3.3 (links bzw vor der Brücke)
            Prog_Lok18.Interval = 2000
        ElseIf _Prog18 = 261 Then
        ElseIf _Prog18 = 262 Then
            _eb.lokSteuern(18, Klassen.LokEigenschaften.Geschwindigkeit, Stufe3)

        ElseIf _Prog18 = 600 Then ' Kontakt 3.5 <- (unter der Burg)
            Prog_Lok18.Interval = 2000
        ElseIf _Prog18 = 601 Then
        ElseIf _Prog18 = 602 Then

        ElseIf _Prog18 = 620 Then ' Kontakt 3.7 -> (hinter der Brücke bergab)
            Prog_Lok18.Interval = 2000
        ElseIf _Prog18 = 621 Then
        ElseIf _Prog18 = 622 Then

        ElseIf _Prog18 = 640 Then ' Kontakt 3.1 <- Talfahrt
            Prog_Lok18.Interval = 2000
        ElseIf _Prog18 = 641 Then
        ElseIf _Prog18 = 642 Then

        ElseIf _Prog18 = 660 Then ' Kontakt 1.2 -> Talfahrt
            Prog_Lok18.Interval = 2000
        ElseIf _Prog18 = 661 Then
        ElseIf _Prog18 = 662 Then

        ElseIf _Prog18 = 700 Then ' Kontakt 0.4 <- Diagonale
            Prog_Lok18.Interval = 2000
        ElseIf _Prog18 = 701 Then
        ElseIf _Prog18 = 702 Then

            ' Zindelstein

        ElseIf _Prog18 = 500 Then
            Prog_Lok18.Interval = V_500
        ElseIf _Prog18 = 501 Then
            _eb.lokSteuern(18, Klassen.LokEigenschaften.Geschwindigkeit, Stufe24)
            Prog_Lok18.Interval = T_500
        ElseIf _Prog18 = 502 Then
            _eb.lokSteuern(18, Klassen.LokEigenschaften.Geschwindigkeit, Stufe23)
        ElseIf _Prog18 = 503 Then
            _eb.lokSteuern(18, Klassen.LokEigenschaften.Geschwindigkeit, Stufe22)
        ElseIf _Prog18 = 504 Then
            _eb.lokSteuern(18, Klassen.LokEigenschaften.Geschwindigkeit, Stufe21)
        ElseIf _Prog18 = 505 Then
            _eb.lokSteuern(18, Klassen.LokEigenschaften.Geschwindigkeit, Stufe2)
        ElseIf _Prog18 = 506 Then
            _eb.lokSteuern(18, Klassen.LokEigenschaften.Geschwindigkeit, 0)

        Else
            _Prog18 = 0
            Prog_Lok18.Stop()
            Prog_Lok18.Interval = 200
            If Betriebsart = 1 Then
                SetProgramCounterLabel1(String.Empty)
            Else
                SetProgramCounterLabel(String.Empty)
            End If
        End If
        _Prog18 = _Prog18 + 1
    End Sub
    Private Sub HandleTimerElapsed31(sender As System.Object, e As System.EventArgs) Handles Prog_Lok19.Elapsed

        '*** Fahrprogramm E101 003-2
        '*** Datum: 17.07.2020

        SetText(TextBox1, "E-Lok 101 003-2                                                         IBS: 06.01.2022 - V3: 7")
        LoadImage(PictureBox1, "H:\\EB_Media\\LokFotos\\Baureihe_101_02.jpg")
        GeschwindikeitenSetzen(19)

        Dim Stufe1, Stufe2, Stufe3, Stufe4 As Integer
        Dim Stufe11, Stufe12, Stufe13, Stufe14, Stufe21, Stufe22, Stufe23, Stufe24 As Integer
        Dim V_100, V_130, V_160, V_180, V_500 As Integer
        Dim T_100, T_130, T_160, T_180, T_500 As Integer
        Dim G_200 As Integer

        T_100 = _Betriebsparameter.Fahrparameter(19, KlausEBspecific.Betriebsparameter.FahrparameterEnum.T_100)
        T_130 = _Betriebsparameter.Fahrparameter(19, KlausEBspecific.Betriebsparameter.FahrparameterEnum.T_130)
        T_160 = _Betriebsparameter.Fahrparameter(19, KlausEBspecific.Betriebsparameter.FahrparameterEnum.T_160)
        T_180 = _Betriebsparameter.Fahrparameter(19, KlausEBspecific.Betriebsparameter.FahrparameterEnum.T_180)
        T_500 = _Betriebsparameter.Fahrparameter(19, KlausEBspecific.Betriebsparameter.FahrparameterEnum.T_500)
        V_100 = _Betriebsparameter.Fahrparameter(19, KlausEBspecific.Betriebsparameter.FahrparameterEnum.V_100)
        V_130 = _Betriebsparameter.Fahrparameter(19, KlausEBspecific.Betriebsparameter.FahrparameterEnum.V_130)
        V_160 = _Betriebsparameter.Fahrparameter(19, KlausEBspecific.Betriebsparameter.FahrparameterEnum.V_160)
        V_180 = _Betriebsparameter.Fahrparameter(19, KlausEBspecific.Betriebsparameter.FahrparameterEnum.V_180)
        V_500 = _Betriebsparameter.Fahrparameter(19, KlausEBspecific.Betriebsparameter.FahrparameterEnum.V_500)
        G_200 = _Betriebsparameter.Fahrparameter(19, KlausEBspecific.Betriebsparameter.FahrparameterEnum.G_200)

        If A_StopB = 1 Then
            V_100 = 8000
        End If

        Stufe1 = _LokStufen.Holen(19, 1)
        Stufe2 = _LokStufen.Holen(19, 2)
        Stufe3 = _LokStufen.Holen(19, 3)
        Stufe4 = _LokStufen.Holen(19, 4)

        If Stufe2 = 1 Then
            T_100 = T_100
            T_130 = T_130
            T_160 = T_160
            V_180 = V_180
        ElseIf Stufe2 = 2 Then
            T_100 = T_100 + 300
            T_130 = T_130 + 300
            T_160 = T_160 + 300
            V_180 = V_180 + 500
        ElseIf Stufe2 = 3 Then
            T_100 = T_100 + 500
            T_130 = T_130 + 500
            T_160 = T_160 + 500
            V_180 = V_180 + 1000
        ElseIf Stufe2 = 4 Then
            T_100 = T_100 + 700
            T_130 = T_130 + 700
            T_160 = T_160 + 700
            V_180 = V_180 + 1500
        ElseIf Stufe2 = 5 Then
            T_100 = T_100 + 900
            T_130 = T_130 + 900
            T_160 = T_160 + 900
            V_180 = V_180 + 2000
        ElseIf Stufe2 = 6 Then
            T_100 = T_100 + 1200
            T_130 = T_130 + 1200
            T_160 = T_160 + 1200
            V_180 = V_180 + 2500
        Else
            T_100 = T_100 + 1200
            T_130 = T_130 + 1200
            T_160 = T_160 + 1200
            V_180 = V_180 + 2500
        End If

        Stufe2 = Stufe1

        Stufe11 = Stufe1 + 1
        If Stufe11 > Stufe3 Then
            Stufe11 = Stufe3
        End If
        Stufe12 = Stufe1 + 2
        If Stufe12 > Stufe3 Then
            Stufe12 = Stufe3
        End If
        Stufe13 = Stufe1 + 3
        If Stufe13 > Stufe3 Then
            Stufe13 = Stufe3
        End If
        Stufe14 = Stufe1 + 4
        If Stufe14 > Stufe3 Then
            Stufe14 = Stufe3
        End If

        Stufe21 = Stufe2 + 1
        If Stufe21 > Stufe3 Then
            Stufe21 = Stufe3
        End If
        Stufe22 = Stufe2 + 2
        If Stufe22 > Stufe3 Then
            Stufe22 = Stufe3
        End If
        Stufe23 = Stufe2 + 3
        If Stufe23 > Stufe3 Then
            Stufe23 = Stufe3
        End If
        Stufe24 = Stufe2 + 4
        If Stufe24 > Stufe3 Then
            Stufe24 = Stufe3
        End If
        If G_200 > 0 Then
            If G_200 < Stufe4 Then
                G_200 = Stufe4
            End If
        Else
            G_200 = Stufe4
        End If

        If Betriebsart = 1 And (_GlsL19 = 3 Or _GlsL19 = 4) Then
            SetProgramCounterLabel1(_Prog19)
        Else
            SetProgramCounterLabel(_Prog19)
        End If

        ' Lok starten - Bahnhofsausfahrt

        If _Prog19 = 0 Then
            Prog_Lok19.Interval = 2000
            If _Fahrzeugbeleuchtung2 > 0 Then
                _eb.lokSteuern(19, Klassen.LokEigenschaften.Hauptfunktion, 1) ' Licht ein
            End If
        ElseIf _Prog19 = 1 Then
            _Betriebsparameter.RundenErhoehen(19)
        ElseIf _Prog19 = 2 Then
            If _Innenbeleuchtung2 > 0 Then
                _eb.lokSteuern(19, Klassen.LokEigenschaften.Funktion2, 1) ' Fernlicht ein
            End If
        ElseIf _Prog19 = 3 Then
        ElseIf _Prog19 = 4 Then
        ElseIf _Prog19 = 5 Then
        ElseIf _Prog19 = 6 Then
            'StopMusic()

            ' Bahnhofsausfahrt

        ElseIf _Prog19 = 7 Then
            _eb.lokSteuern(19, Klassen.LokEigenschaften.Geschwindigkeit, Stufe1)
        ElseIf _Prog19 = 8 Then
            _eb.lokSteuern(19, Klassen.LokEigenschaften.Geschwindigkeit, Stufe11)
        ElseIf _Prog19 = 9 Then
            _eb.lokSteuern(19, Klassen.LokEigenschaften.Geschwindigkeit, Stufe12)
        ElseIf _Prog19 = 10 Then
            _eb.lokSteuern(19, Klassen.LokEigenschaften.Geschwindigkeit, Stufe13)
        ElseIf _Prog19 = 11 Then
            _eb.lokSteuern(19, Klassen.LokEigenschaften.Geschwindigkeit, Stufe14)
        ElseIf _Prog19 = 12 Then
            _eb.lokSteuern(19, Klassen.LokEigenschaften.Geschwindigkeit, Stufe3)

            ' Lok abstellen

        ElseIf _Prog19 = 50 Then
            Prog_Lok19.Interval = 2000
            If _Fernlicht = 0 Then
                _eb.lokSteuern(19, Klassen.LokEigenschaften.Funktion2, 0) ' Fernlicht aus
            End If
        ElseIf _Prog19 = 51 Then
        ElseIf _Prog19 = 52 Then
            If _Fahrzeugbeleuchtung2 < 2 Then
                _eb.lokSteuern(19, Klassen.LokEigenschaften.Hauptfunktion, 0) ' Licht aus
            End If

            ' Lok bremsen (Bahnhofseinfahrt Normalzug von links und von rechts)

        ElseIf _Prog19 = 100 Then
            Prog_Lok19.Interval = V_100
        ElseIf _Prog19 = 101 Then
            _eb.lokSteuern(19, Klassen.LokEigenschaften.Geschwindigkeit, Stufe24)
            Prog_Lok19.Interval = T_100
        ElseIf _Prog19 = 102 Then
            _eb.lokSteuern(19, Klassen.LokEigenschaften.Geschwindigkeit, Stufe23)
        ElseIf _Prog19 = 103 Then
            _eb.lokSteuern(19, Klassen.LokEigenschaften.Geschwindigkeit, Stufe22)
        ElseIf _Prog19 = 104 Then
            _eb.lokSteuern(19, Klassen.LokEigenschaften.Geschwindigkeit, Stufe21)
        ElseIf _Prog19 = 105 Then
            _eb.lokSteuern(19, Klassen.LokEigenschaften.Geschwindigkeit, Stufe2)

            ' Lok bremsen (Bahnhofseinfahrt Kurzzug von links)

        ElseIf _Prog19 = 130 Then
            Prog_Lok19.Interval = V_130
        ElseIf _Prog19 = 131 Then
            _eb.lokSteuern(19, Klassen.LokEigenschaften.Geschwindigkeit, Stufe24)
            Prog_Lok19.Interval = T_130
        ElseIf _Prog19 = 132 Then
            _eb.lokSteuern(19, Klassen.LokEigenschaften.Geschwindigkeit, Stufe23)
        ElseIf _Prog19 = 133 Then
            _eb.lokSteuern(19, Klassen.LokEigenschaften.Geschwindigkeit, Stufe22)
        ElseIf _Prog19 = 134 Then
            _eb.lokSteuern(19, Klassen.LokEigenschaften.Geschwindigkeit, Stufe21)
        ElseIf _Prog19 = 135 Then
            _eb.lokSteuern(19, Klassen.LokEigenschaften.Geschwindigkeit, Stufe2)
        ElseIf _Prog19 = 136 Then
            _eb.lokSteuern(19, Klassen.LokEigenschaften.Geschwindigkeit, 0)
        ElseIf _Prog19 = 137 Then
            Prog_Lok19.Interval = 2000
        ElseIf _Prog19 = 138 Then
            If _Fahrzeugbeleuchtung2 < 2 Then
                _eb.lokSteuern(19, Klassen.LokEigenschaften.Hauptfunktion, 0) ' Licht aus
            End If

            ' Lok bremsen (Bahnhofseinfahrt Kurzzug von rechts)

        ElseIf _Prog19 = 160 Then
            Prog_Lok19.Interval = V_160
        ElseIf _Prog19 = 161 Then
            _eb.lokSteuern(19, Klassen.LokEigenschaften.Geschwindigkeit, Stufe24)
            Prog_Lok19.Interval = T_160
        ElseIf _Prog19 = 162 Then
            _eb.lokSteuern(19, Klassen.LokEigenschaften.Geschwindigkeit, Stufe23)
        ElseIf _Prog19 = 163 Then
            _eb.lokSteuern(19, Klassen.LokEigenschaften.Geschwindigkeit, Stufe22)
        ElseIf _Prog19 = 164 Then
            _eb.lokSteuern(19, Klassen.LokEigenschaften.Geschwindigkeit, Stufe21)
        ElseIf _Prog19 = 165 Then
            _eb.lokSteuern(19, Klassen.LokEigenschaften.Geschwindigkeit, Stufe2)
        ElseIf _Prog19 = 166 Then
            _eb.lokSteuern(19, Klassen.LokEigenschaften.Geschwindigkeit, 0)
        ElseIf _Prog19 = 167 Then
            Prog_Lok19.Interval = 2000
        ElseIf _Prog19 = 168 Then
            If _Fahrzeugbeleuchtung2 < 2 Then
                _eb.lokSteuern(19, Klassen.LokEigenschaften.Hauptfunktion, 0) ' Licht aus
            End If

            ' Rangierzug

        ElseIf _Prog19 = 180 Then
            _eb.lokSteuern(19, Klassen.LokEigenschaften.Geschwindigkeit, 2)
            Prog_Lok19.Interval = V_180
        ElseIf _Prog19 = 181 Then
            Prog_Lok19.Interval = T_180
            _eb.lokSteuern(19, Klassen.LokEigenschaften.Geschwindigkeit, 1)
        ElseIf _Prog19 = 182 Then
            _eb.lokSteuern(19, Klassen.LokEigenschaften.Geschwindigkeit, 0)

            ' Tunnelausfahrt

        ElseIf _Prog19 = 200 Then ' Kontakt 1.2 <- (bergauf)
            _eb.lokSteuern(19, Klassen.LokEigenschaften.Geschwindigkeit, G_200)
            Prog_Lok19.Interval = 2000
        ElseIf _Prog19 = 201 Then
        ElseIf _Prog19 = 202 Then
        ElseIf _Prog19 = 203 Then
        ElseIf _Prog19 = 204 Then
        ElseIf _Prog19 = 205 Then
            If Stufe4 < Stufe3 Then
                _eb.lokSteuern(19, Klassen.LokEigenschaften.Geschwindigkeit, Stufe3)
            Else
                _eb.lokSteuern(19, Klassen.LokEigenschaften.Geschwindigkeit, Stufe4)
            End If

        ElseIf _Prog19 = 220 Then ' Kontakt 3.1 -> (hinter dem Martinstor bergauf)
            Prog_Lok19.Interval = 2000
        ElseIf _Prog19 = 221 Then
        ElseIf _Prog19 = 222 Then

        ElseIf _Prog19 = 240 Then ' Kontakt 3.7 <- (hinter der Brücke bergauf)
            Prog_Lok19.Interval = 2000
        ElseIf _Prog19 = 241 Then
        ElseIf _Prog19 = 242 Then

        ElseIf _Prog19 = 260 Then ' Kontakt 3.3 (links bzw vor der Brücke)
            Prog_Lok19.Interval = 2000
        ElseIf _Prog19 = 261 Then
        ElseIf _Prog19 = 262 Then
            _eb.lokSteuern(19, Klassen.LokEigenschaften.Geschwindigkeit, Stufe3)

        ElseIf _Prog19 = 600 Then ' Kontakt 3.5 <- (unter der Burg)
            Prog_Lok19.Interval = 2000
        ElseIf _Prog19 = 601 Then
        ElseIf _Prog19 = 602 Then

        ElseIf _Prog19 = 620 Then ' Kontakt 3.7 -> (hinter der Brücke bergab)
            Prog_Lok19.Interval = 2000
        ElseIf _Prog19 = 621 Then
        ElseIf _Prog19 = 622 Then

        ElseIf _Prog19 = 640 Then ' Kontakt 3.1 <- Talfahrt
            Prog_Lok19.Interval = 2000
        ElseIf _Prog19 = 641 Then
        ElseIf _Prog19 = 642 Then

        ElseIf _Prog19 = 660 Then ' Kontakt 1.2 -> Talfahrt
            Prog_Lok19.Interval = 2000
        ElseIf _Prog19 = 661 Then
        ElseIf _Prog19 = 662 Then

        ElseIf _Prog19 = 700 Then ' Kontakt 0.4 <- Diagonale
            Prog_Lok19.Interval = 2000
        ElseIf _Prog19 = 701 Then
        ElseIf _Prog19 = 702 Then

            ' Zindelstein

        ElseIf _Prog19 = 500 Then
            Prog_Lok19.Interval = V_500
        ElseIf _Prog19 = 501 Then
            _eb.lokSteuern(19, Klassen.LokEigenschaften.Geschwindigkeit, Stufe23)
            Prog_Lok19.Interval = T_100
        ElseIf _Prog19 = 502 Then
            _eb.lokSteuern(19, Klassen.LokEigenschaften.Geschwindigkeit, Stufe22)
        ElseIf _Prog19 = 503 Then
            _eb.lokSteuern(19, Klassen.LokEigenschaften.Geschwindigkeit, Stufe21)
        ElseIf _Prog19 = 504 Then
            _eb.lokSteuern(19, Klassen.LokEigenschaften.Geschwindigkeit, Stufe2)
        ElseIf _Prog19 = 505 Then
            _eb.lokSteuern(19, Klassen.LokEigenschaften.Geschwindigkeit, 0)

        Else
            _Prog19 = 0
            Prog_Lok19.Stop()
            Prog_Lok19.Interval = 200
            If Betriebsart = 1 Then
                SetProgramCounterLabel1(String.Empty)
            Else
                SetProgramCounterLabel(String.Empty)
            End If
        End If
        _Prog19 = _Prog19 + 1
    End Sub
    Private Sub HandleTimerElapsed32(sender As System.Object, e As System.EventArgs) Handles Prog_Lok20.Elapsed

        '*** Fahrprogramm für TEE NS DE 1001
        '*** Datum: 23.02.2020

        SetText(TextBox1, "TEE NS DE 1001                                                          IBS: 06.01.2022 V1: 6 - V3: 10")
        LoadImage(PictureBox1, "H:\\EB_Media\\LokFotos\\Baureihe_TEE_20.jpg")
        GeschwindikeitenSetzen(20)

        Dim Stufe1, Stufe2, Stufe3, Stufe4 As Integer
        Dim Stufe11, Stufe12, Stufe13, Stufe14, Stufe21, Stufe22, Stufe23, Stufe24 As Integer
        Dim V_100, V_130, V_160, V_180, V_500 As Integer
        Dim T_100, T_130, T_160, T_180, T_500 As Integer
        Dim G_200 As Integer

        T_100 = _Betriebsparameter.Fahrparameter(20, KlausEBspecific.Betriebsparameter.FahrparameterEnum.T_100)
        T_130 = _Betriebsparameter.Fahrparameter(20, KlausEBspecific.Betriebsparameter.FahrparameterEnum.T_130)
        T_160 = _Betriebsparameter.Fahrparameter(20, KlausEBspecific.Betriebsparameter.FahrparameterEnum.T_160)
        T_180 = _Betriebsparameter.Fahrparameter(20, KlausEBspecific.Betriebsparameter.FahrparameterEnum.T_180)
        T_500 = _Betriebsparameter.Fahrparameter(20, KlausEBspecific.Betriebsparameter.FahrparameterEnum.T_500)
        V_100 = _Betriebsparameter.Fahrparameter(20, KlausEBspecific.Betriebsparameter.FahrparameterEnum.V_100)
        V_130 = _Betriebsparameter.Fahrparameter(20, KlausEBspecific.Betriebsparameter.FahrparameterEnum.V_130)
        V_160 = _Betriebsparameter.Fahrparameter(20, KlausEBspecific.Betriebsparameter.FahrparameterEnum.V_160)
        V_180 = _Betriebsparameter.Fahrparameter(20, KlausEBspecific.Betriebsparameter.FahrparameterEnum.V_180)
        V_500 = _Betriebsparameter.Fahrparameter(20, KlausEBspecific.Betriebsparameter.FahrparameterEnum.V_500)
        G_200 = _Betriebsparameter.Fahrparameter(20, KlausEBspecific.Betriebsparameter.FahrparameterEnum.G_200)

        If A_StopB = 1 Then
            V_100 = 8000
        End If

        Stufe1 = _LokStufen.Holen(20, 1)
        Stufe2 = _LokStufen.Holen(20, 2)
        Stufe3 = _LokStufen.Holen(20, 3)
        Stufe4 = _LokStufen.Holen(20, 4)

        If Stufe2 = 1 Then
            T_100 = T_100
            T_130 = T_130
            T_160 = T_160
            V_180 = V_180
        ElseIf Stufe2 = 2 Then
            T_100 = T_100 + 300
            T_130 = T_130 + 300
            T_160 = T_160 + 300
            V_180 = V_180 + 500
        ElseIf Stufe2 = 3 Then
            T_100 = T_100 + 500
            T_130 = T_130 + 500
            T_160 = T_160 + 500
            V_180 = V_180 + 1000
        ElseIf Stufe2 = 4 Then
            T_100 = T_100 + 700
            T_130 = T_130 + 700
            T_160 = T_160 + 700
            V_180 = V_180 + 1500
        ElseIf Stufe2 = 5 Then
            T_100 = T_100 + 900
            T_130 = T_130 + 900
            T_160 = T_160 + 900
            V_180 = V_180 + 2000
        ElseIf Stufe2 = 6 Then
            T_100 = T_100 + 1200
            T_130 = T_130 + 1200
            T_160 = T_160 + 1200
            V_180 = V_180 + 2500
        Else
            T_100 = T_100 + 1200
            T_130 = T_130 + 1200
            T_160 = T_160 + 1200
            V_180 = V_180 + 2500
        End If

        Stufe2 = Stufe1

        Stufe11 = Stufe1 + 1
        If Stufe11 > Stufe3 Then
            Stufe11 = Stufe3
        End If
        Stufe12 = Stufe1 + 2
        If Stufe12 > Stufe3 Then
            Stufe12 = Stufe3
        End If
        Stufe13 = Stufe1 + 3
        If Stufe13 > Stufe3 Then
            Stufe13 = Stufe3
        End If
        Stufe14 = Stufe1 + 4
        If Stufe14 > Stufe3 Then
            Stufe14 = Stufe3
        End If

        Stufe21 = Stufe2 + 1
        If Stufe21 > Stufe3 Then
            Stufe21 = Stufe3
        End If
        Stufe22 = Stufe2 + 2
        If Stufe22 > Stufe3 Then
            Stufe22 = Stufe3
        End If
        Stufe23 = Stufe2 + 3
        If Stufe23 > Stufe3 Then
            Stufe23 = Stufe3
        End If
        Stufe24 = Stufe2 + 4
        If Stufe24 > Stufe3 Then
            Stufe24 = Stufe3
        End If
        If G_200 > 0 Then
            If G_200 < Stufe4 Then
                G_200 = Stufe4
            End If
        Else
            G_200 = Stufe4
        End If

        If Betriebsart = 1 And (_GlsL20 = 3 Or _GlsL20 = 4) Then
            SetProgramCounterLabel1(_Prog20)
        Else
            SetProgramCounterLabel(_Prog20)
        End If

        ' Lok starten - Bahnhofsausfahrt

        If _Prog20 = 0 Then
            Prog_Lok20.Interval = 2000
            If _Fahrzeugbeleuchtung2 > 0 Then
                _eb.lokSteuern(20, Klassen.LokEigenschaften.Hauptfunktion, 1) ' Licht ein
            End If
        ElseIf _Prog20 = 1 Then
        ElseIf _Prog20 = 2 Then
            _Betriebsparameter.RundenErhoehen(20)
        ElseIf _Prog20 = 3 Then
        ElseIf _Prog20 = 4 Then
        ElseIf _Prog20 = 5 Then
        ElseIf _Prog20 = 6 Then

            ' Bahnhofsausfahrt

        ElseIf _Prog20 = 7 Then
            _eb.lokSteuern(20, Klassen.LokEigenschaften.Geschwindigkeit, Stufe1)
        ElseIf _Prog20 = 8 Then
            _eb.lokSteuern(20, Klassen.LokEigenschaften.Geschwindigkeit, Stufe11)
        ElseIf _Prog20 = 9 Then
            _eb.lokSteuern(20, Klassen.LokEigenschaften.Geschwindigkeit, Stufe12)
        ElseIf _Prog20 = 10 Then
            _eb.lokSteuern(20, Klassen.LokEigenschaften.Geschwindigkeit, Stufe13)
        ElseIf _Prog20 = 11 Then
            _eb.lokSteuern(20, Klassen.LokEigenschaften.Geschwindigkeit, Stufe14)
        ElseIf _Prog20 = 12 Then
            _eb.lokSteuern(20, Klassen.LokEigenschaften.Geschwindigkeit, Stufe3)

            ' Lok abstellen

        ElseIf _Prog20 = 50 Then
            Prog_Lok20.Interval = 2000
        ElseIf _Prog20 = 51 Then    ' *** Lok hat keine Lichtfunktion
        ElseIf _Prog20 = 52 Then

            ' Lok bremsen (Bahnhofseinfahrt Normalzug von links und von rechts)

        ElseIf _Prog20 = 100 Then
            Prog_Lok20.Interval = V_100
        ElseIf _Prog20 = 101 Then
            _eb.lokSteuern(20, Klassen.LokEigenschaften.Geschwindigkeit, Stufe24)
            Prog_Lok20.Interval = T_100
        ElseIf _Prog20 = 102 Then
            _eb.lokSteuern(20, Klassen.LokEigenschaften.Geschwindigkeit, Stufe23)
        ElseIf _Prog20 = 103 Then
            _eb.lokSteuern(20, Klassen.LokEigenschaften.Geschwindigkeit, Stufe22)
        ElseIf _Prog20 = 104 Then
            _eb.lokSteuern(20, Klassen.LokEigenschaften.Geschwindigkeit, Stufe21)
        ElseIf _Prog20 = 105 Then
            _eb.lokSteuern(20, Klassen.LokEigenschaften.Geschwindigkeit, Stufe2)

            ' Lok bremsen (Bahnhofseinfahrt Kurzzug von links)

        ElseIf _Prog20 = 130 Then
            Prog_Lok20.Interval = V_130
        ElseIf _Prog20 = 131 Then
            _eb.lokSteuern(20, Klassen.LokEigenschaften.Geschwindigkeit, Stufe24)
            Prog_Lok20.Interval = T_130
        ElseIf _Prog20 = 132 Then
            _eb.lokSteuern(20, Klassen.LokEigenschaften.Geschwindigkeit, Stufe23)
        ElseIf _Prog20 = 133 Then
            _eb.lokSteuern(20, Klassen.LokEigenschaften.Geschwindigkeit, Stufe22)
        ElseIf _Prog20 = 134 Then
            _eb.lokSteuern(20, Klassen.LokEigenschaften.Geschwindigkeit, Stufe21)
        ElseIf _Prog20 = 135 Then
            _eb.lokSteuern(20, Klassen.LokEigenschaften.Geschwindigkeit, Stufe2)
        ElseIf _Prog20 = 136 Then
            _eb.lokSteuern(20, Klassen.LokEigenschaften.Geschwindigkeit, 0)
        ElseIf _Prog20 = 137 Then
            Prog_Lok20.Interval = 2000
        ElseIf _Prog20 = 138 Then
            If _Fahrzeugbeleuchtung2 < 2 Then
                _eb.lokSteuern(20, Klassen.LokEigenschaften.Hauptfunktion, 0) ' Licht aus
            End If

            ' Lok bremsen (Bahnhofseinfahrt Kurzzug von rechts)

        ElseIf _Prog20 = 160 Then
            Prog_Lok20.Interval = V_160
        ElseIf _Prog20 = 161 Then
            _eb.lokSteuern(20, Klassen.LokEigenschaften.Geschwindigkeit, Stufe24)
            Prog_Lok20.Interval = T_160
        ElseIf _Prog20 = 162 Then
            _eb.lokSteuern(20, Klassen.LokEigenschaften.Geschwindigkeit, Stufe23)
        ElseIf _Prog20 = 163 Then
            _eb.lokSteuern(20, Klassen.LokEigenschaften.Geschwindigkeit, Stufe22)
        ElseIf _Prog20 = 164 Then
            _eb.lokSteuern(20, Klassen.LokEigenschaften.Geschwindigkeit, Stufe21)
        ElseIf _Prog20 = 165 Then
            _eb.lokSteuern(20, Klassen.LokEigenschaften.Geschwindigkeit, Stufe2)
        ElseIf _Prog20 = 166 Then
            _eb.lokSteuern(20, Klassen.LokEigenschaften.Geschwindigkeit, 0)
        ElseIf _Prog20 = 167 Then
            Prog_Lok20.Interval = 2000
        ElseIf _Prog20 = 168 Then
            If _Fahrzeugbeleuchtung2 < 2 Then
                _eb.lokSteuern(20, Klassen.LokEigenschaften.Hauptfunktion, 0) ' Licht aus
            End If

            ' Rangierzug

        ElseIf _Prog20 = 180 Then
            _eb.lokSteuern(20, Klassen.LokEigenschaften.Geschwindigkeit, 2)
            Prog_Lok20.Interval = V_180
        ElseIf _Prog20 = 181 Then
            Prog_Lok20.Interval = T_180
            _eb.lokSteuern(20, Klassen.LokEigenschaften.Geschwindigkeit, 1)
        ElseIf _Prog20 = 182 Then
            _eb.lokSteuern(20, Klassen.LokEigenschaften.Geschwindigkeit, 0)

            ' Tunnelausfahrt

        ElseIf _Prog20 = 200 Then ' Kontakt 1.2 <- (bergauf)
            _eb.lokSteuern(20, Klassen.LokEigenschaften.Geschwindigkeit, G_200)
            Prog_Lok20.Interval = 2000
        ElseIf _Prog20 = 201 Then
        ElseIf _Prog20 = 202 Then
        ElseIf _Prog20 = 203 Then
        ElseIf _Prog20 = 204 Then
        ElseIf _Prog20 = 205 Then
            If Stufe4 < Stufe3 Then
                _eb.lokSteuern(20, Klassen.LokEigenschaften.Geschwindigkeit, Stufe3)
            Else
                _eb.lokSteuern(20, Klassen.LokEigenschaften.Geschwindigkeit, Stufe4)
            End If

        ElseIf _Prog20 = 220 Then ' Kontakt 3.1 -> (hinter dem Martinstor bergauf)
            Prog_Lok20.Interval = 2000
        ElseIf _Prog20 = 221 Then
        ElseIf _Prog20 = 222 Then

        ElseIf _Prog20 = 240 Then ' Kontakt 3.7 <- (hinter der Brücke bergauf)
            Prog_Lok20.Interval = 2000
        ElseIf _Prog20 = 241 Then
        ElseIf _Prog20 = 242 Then

        ElseIf _Prog20 = 260 Then ' Kontakt 3.3 (links bzw vor der Brücke)
            Prog_Lok20.Interval = 2000
        ElseIf _Prog20 = 261 Then
        ElseIf _Prog20 = 262 Then
            _eb.lokSteuern(20, Klassen.LokEigenschaften.Geschwindigkeit, Stufe3)

        ElseIf _Prog20 = 600 Then ' Kontakt 3.5 <- (unter der Burg)
            Prog_Lok20.Interval = 2000
        ElseIf _Prog20 = 601 Then
        ElseIf _Prog20 = 602 Then

        ElseIf _Prog20 = 620 Then ' Kontakt 3.7 -> (hinter der Brücke bergab)
            Prog_Lok20.Interval = 2000
        ElseIf _Prog20 = 621 Then
        ElseIf _Prog20 = 622 Then

        ElseIf _Prog20 = 640 Then ' Kontakt 3.1 <- Talfahrt
            Prog_Lok20.Interval = 2000
        ElseIf _Prog20 = 641 Then
        ElseIf _Prog20 = 642 Then

        ElseIf _Prog20 = 660 Then ' Kontakt 1.2 -> Talfahrt
            Prog_Lok20.Interval = 2000
        ElseIf _Prog20 = 661 Then
        ElseIf _Prog20 = 662 Then

        ElseIf _Prog20 = 700 Then ' Kontakt 0.4 <- Diagonale
            Prog_Lok20.Interval = 2000
        ElseIf _Prog20 = 701 Then
        ElseIf _Prog20 = 702 Then

            ' Zindelstein

        ElseIf _Prog20 = 500 Then
            Prog_Lok20.Interval = V_500
        ElseIf _Prog20 = 501 Then
            _eb.lokSteuern(20, Klassen.LokEigenschaften.Geschwindigkeit, Stufe23)
            Prog_Lok20.Interval = T_500
        ElseIf _Prog20 = 502 Then
            _eb.lokSteuern(20, Klassen.LokEigenschaften.Geschwindigkeit, Stufe22)
        ElseIf _Prog20 = 503 Then
            _eb.lokSteuern(20, Klassen.LokEigenschaften.Geschwindigkeit, Stufe21)
        ElseIf _Prog20 = 504 Then
            _eb.lokSteuern(20, Klassen.LokEigenschaften.Geschwindigkeit, Stufe2)
        ElseIf _Prog20 = 505 Then
            _eb.lokSteuern(20, Klassen.LokEigenschaften.Geschwindigkeit, 0)

        Else
            _Prog20 = 0
            Prog_Lok20.Stop()
            Prog_Lok20.Interval = 200
            If Betriebsart = 1 Then
                SetProgramCounterLabel1(String.Empty)
            Else
                SetProgramCounterLabel(String.Empty)
            End If
        End If
        _Prog20 = _Prog20 + 1
    End Sub
    Private Sub HandleTimerElapsed33(sender As System.Object, e As System.EventArgs) Handles Prog_Lok21.Elapsed

        '*** Fahrprogramm für Ae6/6
        '*** Datum: 08.10.2021

        SetText(TextBox1, "E-Lok AE66 11426                                                        IBS: 08.10.2021 - V3 : 8")
        LoadImage(PictureBox1, "H:\\EB_Media\\LokFotos\\Baureihe AE66_01.jpg")
        GeschwindikeitenSetzen(21)

        Dim Stufe1, Stufe2, Stufe3, Stufe4 As Integer
        Dim Stufe11, Stufe12, Stufe13, Stufe14, Stufe21, Stufe22, Stufe23, Stufe24 As Integer
        Dim V_100, V_130, V_160, V_180, V_500 As Integer
        Dim T_100, T_130, T_160, T_180, T_500 As Integer
        Dim G_200 As Integer

        T_100 = _Betriebsparameter.Fahrparameter(21, KlausEBspecific.Betriebsparameter.FahrparameterEnum.T_100)
        T_130 = _Betriebsparameter.Fahrparameter(21, KlausEBspecific.Betriebsparameter.FahrparameterEnum.T_130)
        T_160 = _Betriebsparameter.Fahrparameter(21, KlausEBspecific.Betriebsparameter.FahrparameterEnum.T_160)
        T_180 = _Betriebsparameter.Fahrparameter(21, KlausEBspecific.Betriebsparameter.FahrparameterEnum.T_180)
        T_500 = _Betriebsparameter.Fahrparameter(21, KlausEBspecific.Betriebsparameter.FahrparameterEnum.T_500)
        V_100 = _Betriebsparameter.Fahrparameter(21, KlausEBspecific.Betriebsparameter.FahrparameterEnum.V_100)
        V_130 = _Betriebsparameter.Fahrparameter(21, KlausEBspecific.Betriebsparameter.FahrparameterEnum.V_130)
        V_160 = _Betriebsparameter.Fahrparameter(21, KlausEBspecific.Betriebsparameter.FahrparameterEnum.V_160)
        V_180 = _Betriebsparameter.Fahrparameter(21, KlausEBspecific.Betriebsparameter.FahrparameterEnum.V_180)
        V_500 = _Betriebsparameter.Fahrparameter(21, KlausEBspecific.Betriebsparameter.FahrparameterEnum.V_500)
        G_200 = _Betriebsparameter.Fahrparameter(21, KlausEBspecific.Betriebsparameter.FahrparameterEnum.G_200)

        If A_StopB = 1 Then
            V_100 = 8000
        End If

        Stufe1 = _LokStufen.Holen(21, 1)
        Stufe2 = _LokStufen.Holen(21, 2)
        Stufe3 = _LokStufen.Holen(21, 3)
        Stufe4 = _LokStufen.Holen(21, 4)

        If Stufe2 = 1 Then
            T_100 = T_100
            T_130 = T_130
            T_160 = T_160
            V_180 = V_180
        ElseIf Stufe2 = 2 Then
            T_100 = T_100 + 300
            T_130 = T_130 + 300
            T_160 = T_160 + 300
            V_180 = V_180 + 500
        ElseIf Stufe2 = 3 Then
            T_100 = T_100 + 500
            T_130 = T_130 + 500
            T_160 = T_160 + 500
            V_180 = V_180 + 1000
        ElseIf Stufe2 = 4 Then
            T_100 = T_100 + 700
            T_130 = T_130 + 700
            T_160 = T_160 + 700
            V_180 = V_180 + 1500
        ElseIf Stufe2 = 5 Then
            T_100 = T_100 + 900
            T_130 = T_130 + 900
            T_160 = T_160 + 900
            V_180 = V_180 + 2000
        ElseIf Stufe2 = 6 Then
            T_100 = T_100 + 1200
            T_130 = T_130 + 1200
            T_160 = T_160 + 1200
            V_180 = V_180 + 2500
        Else
            T_100 = T_100 + 1200
            T_130 = T_130 + 1200
            T_160 = T_160 + 1200
            V_180 = V_180 + 2500
        End If

        Stufe2 = Stufe1

        Stufe11 = Stufe1 + 1
        If Stufe11 > Stufe3 Then
            Stufe11 = Stufe3
        End If
        Stufe12 = Stufe1 + 2
        If Stufe12 > Stufe3 Then
            Stufe12 = Stufe3
        End If
        Stufe13 = Stufe1 + 3
        If Stufe13 > Stufe3 Then
            Stufe13 = Stufe3
        End If
        Stufe14 = Stufe1 + 4
        If Stufe14 > Stufe3 Then
            Stufe14 = Stufe3
        End If

        Stufe21 = Stufe2 + 1
        If Stufe21 > Stufe3 Then
            Stufe21 = Stufe3
        End If
        Stufe22 = Stufe2 + 2
        If Stufe22 > Stufe3 Then
            Stufe22 = Stufe3
        End If
        Stufe23 = Stufe2 + 3
        If Stufe23 > Stufe3 Then
            Stufe23 = Stufe3
        End If
        Stufe24 = Stufe2 + 4
        If Stufe24 > Stufe3 Then
            Stufe24 = Stufe3
        End If
        If G_200 > 0 Then
            If G_200 < Stufe4 Then
                G_200 = Stufe4
            End If
        Else
            G_200 = Stufe4
        End If

        If Betriebsart = 1 And (_GlsL21 = 3 Or _GlsL21 = 4) Then
            SetProgramCounterLabel1(_Prog21)
        Else
            SetProgramCounterLabel(_Prog21)
        End If

        ' Lok starten - Bahnhofsausfahrt

        If _Prog21 = 0 Then
            Prog_Lok21.Interval = 2000
            If _Fahrzeugbeleuchtung2 > 0 Then
                _eb.lokSteuern(21, Klassen.LokEigenschaften.Hauptfunktion, 1) ' Licht ein
            End If
        ElseIf _Prog21 = 1 Then
        ElseIf _Prog21 = 2 Then
            _Betriebsparameter.RundenErhoehen(21)
        ElseIf _Prog21 = 3 Then
        ElseIf _Prog21 = 4 Then
        ElseIf _Prog21 = 5 Then
        ElseIf _Prog21 = 6 Then

            ' Bahnhofsausfahrt

        ElseIf _Prog21 = 7 Then
            _eb.lokSteuern(21, Klassen.LokEigenschaften.Geschwindigkeit, Stufe1)
        ElseIf _Prog21 = 8 Then
            _eb.lokSteuern(21, Klassen.LokEigenschaften.Geschwindigkeit, Stufe11)
        ElseIf _Prog21 = 9 Then
            _eb.lokSteuern(21, Klassen.LokEigenschaften.Geschwindigkeit, Stufe12)
        ElseIf _Prog21 = 10 Then
            _eb.lokSteuern(21, Klassen.LokEigenschaften.Geschwindigkeit, Stufe13)
        ElseIf _Prog21 = 11 Then
            _eb.lokSteuern(21, Klassen.LokEigenschaften.Geschwindigkeit, Stufe14)
        ElseIf _Prog21 = 12 Then
            _eb.lokSteuern(21, Klassen.LokEigenschaften.Geschwindigkeit, Stufe3)

            ' Lok abstellen

        ElseIf _Prog21 = 50 Then
            Prog_Lok21.Interval = 2000
        ElseIf _Prog21 = 51 Then
        ElseIf _Prog21 = 52 Then
            If _Fahrzeugbeleuchtung2 < 2 Then
                _eb.lokSteuern(21, Klassen.LokEigenschaften.Hauptfunktion, 0) ' Licht aus
            End If

            ' Lok bremsen (Bahnhofseinfahrt Normalzug von links und von rechts)

        ElseIf _Prog21 = 100 Then
            Prog_Lok21.Interval = V_100
        ElseIf _Prog21 = 101 Then
            _eb.lokSteuern(21, Klassen.LokEigenschaften.Geschwindigkeit, Stufe24)
            Prog_Lok21.Interval = T_100
        ElseIf _Prog21 = 102 Then
            _eb.lokSteuern(21, Klassen.LokEigenschaften.Geschwindigkeit, Stufe23)
        ElseIf _Prog21 = 103 Then
            _eb.lokSteuern(21, Klassen.LokEigenschaften.Geschwindigkeit, Stufe22)
        ElseIf _Prog21 = 104 Then
            _eb.lokSteuern(21, Klassen.LokEigenschaften.Geschwindigkeit, Stufe21)
        ElseIf _Prog21 = 105 Then
            _eb.lokSteuern(21, Klassen.LokEigenschaften.Geschwindigkeit, Stufe2)

            ' Lok bremsen (Bahnhofseinfahrt Kurzzug von links)

        ElseIf _Prog21 = 130 Then
            Prog_Lok21.Interval = V_130
        ElseIf _Prog21 = 131 Then
            _eb.lokSteuern(21, Klassen.LokEigenschaften.Geschwindigkeit, Stufe24)
            Prog_Lok21.Interval = T_130
        ElseIf _Prog21 = 132 Then
            _eb.lokSteuern(21, Klassen.LokEigenschaften.Geschwindigkeit, Stufe23)
        ElseIf _Prog21 = 133 Then
            _eb.lokSteuern(21, Klassen.LokEigenschaften.Geschwindigkeit, Stufe22)
        ElseIf _Prog21 = 134 Then
            _eb.lokSteuern(21, Klassen.LokEigenschaften.Geschwindigkeit, Stufe21)
        ElseIf _Prog21 = 135 Then
            _eb.lokSteuern(21, Klassen.LokEigenschaften.Geschwindigkeit, Stufe2)
        ElseIf _Prog21 = 136 Then
            _eb.lokSteuern(21, Klassen.LokEigenschaften.Geschwindigkeit, 0)
        ElseIf _Prog21 = 137 Then
            Prog_Lok21.Interval = 2000
        ElseIf _Prog21 = 138 Then
            If _Fahrzeugbeleuchtung2 < 2 Then
                _eb.lokSteuern(21, Klassen.LokEigenschaften.Hauptfunktion, 0) ' Licht aus
            End If

            ' Lok bremsen (Bahnhofseinfahrt Kurzzug von rechts)

        ElseIf _Prog21 = 160 Then
            Prog_Lok21.Interval = V_500
        ElseIf _Prog21 = 161 Then
            _eb.lokSteuern(21, Klassen.LokEigenschaften.Geschwindigkeit, Stufe24)
            Prog_Lok21.Interval = T_500
        ElseIf _Prog21 = 162 Then
            _eb.lokSteuern(21, Klassen.LokEigenschaften.Geschwindigkeit, Stufe23)
        ElseIf _Prog21 = 163 Then
            _eb.lokSteuern(21, Klassen.LokEigenschaften.Geschwindigkeit, Stufe22)
        ElseIf _Prog21 = 164 Then
            _eb.lokSteuern(21, Klassen.LokEigenschaften.Geschwindigkeit, Stufe21)
        ElseIf _Prog21 = 165 Then
            _eb.lokSteuern(21, Klassen.LokEigenschaften.Geschwindigkeit, Stufe2)
        ElseIf _Prog21 = 166 Then
            _eb.lokSteuern(21, Klassen.LokEigenschaften.Geschwindigkeit, 0)
        ElseIf _Prog21 = 167 Then
            Prog_Lok21.Interval = 2000
        ElseIf _Prog21 = 168 Then
            If _Fahrzeugbeleuchtung2 < 2 Then
                _eb.lokSteuern(21, Klassen.LokEigenschaften.Hauptfunktion, 0) ' Licht aus
            End If

            ' Rangierzug

        ElseIf _Prog21 = 180 Then
            _eb.lokSteuern(21, Klassen.LokEigenschaften.Geschwindigkeit, 2)
            Prog_Lok21.Interval = V_180
        ElseIf _Prog21 = 181 Then
            Prog_Lok21.Interval = T_180
            _eb.lokSteuern(21, Klassen.LokEigenschaften.Geschwindigkeit, 1)
        ElseIf _Prog21 = 182 Then
            _eb.lokSteuern(21, Klassen.LokEigenschaften.Geschwindigkeit, 0)


            ' Tunnelausfahrt

        ElseIf _Prog21 = 200 Then ' Kontakt 1.2 <- (bergauf)
            _eb.lokSteuern(21, Klassen.LokEigenschaften.Geschwindigkeit, G_200)
            Prog_Lok21.Interval = 2000
        ElseIf _Prog21 = 201 Then
        ElseIf _Prog21 = 202 Then
        ElseIf _Prog21 = 203 Then
        ElseIf _Prog21 = 204 Then
        ElseIf _Prog21 = 205 Then
            If Stufe4 < Stufe3 Then
                _eb.lokSteuern(21, Klassen.LokEigenschaften.Geschwindigkeit, Stufe3)
            Else
                _eb.lokSteuern(21, Klassen.LokEigenschaften.Geschwindigkeit, Stufe4)
            End If

        ElseIf _Prog21 = 220 Then ' Kontakt 3.1 -> (hinter dem Martinstor bergauf)
            Prog_Lok21.Interval = 2000
        ElseIf _Prog21 = 221 Then
        ElseIf _Prog21 = 222 Then

        ElseIf _Prog21 = 240 Then ' Kontakt 3.7 <- (hinter der Brücke bergauf)
            Prog_Lok21.Interval = 2000
        ElseIf _Prog21 = 241 Then
        ElseIf _Prog21 = 242 Then

        ElseIf _Prog21 = 260 Then ' Kontakt 3.3 (links bzw vor der Brücke)
            Prog_Lok21.Interval = 2000
        ElseIf _Prog21 = 261 Then
        ElseIf _Prog21 = 262 Then
            _eb.lokSteuern(21, Klassen.LokEigenschaften.Geschwindigkeit, Stufe3)

        ElseIf _Prog21 = 600 Then ' Kontakt 3.5 <- (unter der Burg)
            Prog_Lok21.Interval = 2000
        ElseIf _Prog21 = 601 Then
        ElseIf _Prog21 = 602 Then

        ElseIf _Prog21 = 620 Then ' Kontakt 3.7 -> (hinter der Brücke bergab)
            Prog_Lok21.Interval = 2000
        ElseIf _Prog21 = 621 Then
        ElseIf _Prog21 = 622 Then

        ElseIf _Prog21 = 640 Then ' Kontakt 3.1 <- Talfahrt
            Prog_Lok21.Interval = 2000
        ElseIf _Prog21 = 641 Then
        ElseIf _Prog21 = 641 Then

        ElseIf _Prog21 = 660 Then ' Kontakt 1.2 -> Talfahrt
            Prog_Lok21.Interval = 2000
        ElseIf _Prog21 = 661 Then
        ElseIf _Prog21 = 662 Then

        ElseIf _Prog21 = 700 Then ' Kontakt 0.4 <- Diagonale
            Prog_Lok21.Interval = 2000
        ElseIf _Prog21 = 701 Then
        ElseIf _Prog21 = 702 Then

            ' Zindelstein

        ElseIf _Prog21 = 500 Then
            Prog_Lok21.Interval = V_500
        ElseIf _Prog21 = 501 Then
            _eb.lokSteuern(21, Klassen.LokEigenschaften.Geschwindigkeit, Stufe23)
            Prog_Lok21.Interval = T_500
        ElseIf _Prog21 = 502 Then
            _eb.lokSteuern(21, Klassen.LokEigenschaften.Geschwindigkeit, Stufe22)
        ElseIf _Prog21 = 503 Then
            _eb.lokSteuern(21, Klassen.LokEigenschaften.Geschwindigkeit, Stufe21)
        ElseIf _Prog21 = 504 Then
            _eb.lokSteuern(21, Klassen.LokEigenschaften.Geschwindigkeit, Stufe2)
            Prog_Lok21.Interval = 1200
        ElseIf _Prog21 = 505 Then
            _eb.lokSteuern(21, Klassen.LokEigenschaften.Geschwindigkeit, 0)

        Else
            _Prog21 = 0
            Prog_Lok21.Stop()
            Prog_Lok21.Interval = 200
            If Betriebsart = 1 Then
                SetProgramCounterLabel1(String.Empty)
            Else
                SetProgramCounterLabel(String.Empty)
            End If
        End If
        _Prog21 = _Prog21 + 1
    End Sub
    Private Sub HandleTimerElapsed34(sender As System.Object, e As System.EventArgs) Handles Prog_Lok22.Elapsed

        '*** Fahrprogramm für E110 234-2
        '*** Datum: 23.02.2020 +

        SetText(TextBox1, "E-Lok 110 234-2                                                         IBS: 11.10.2025 - V3 : 8")
        LoadImage(PictureBox1, "H:\\EB_Media\\LokFotos\\Baureihe_110_01.jpg")
        GeschwindikeitenSetzen(22)

        Dim Stufe1, Stufe2, Stufe3, Stufe4 As Integer
        Dim Stufe11, Stufe12, Stufe13, Stufe14, Stufe21, Stufe22, Stufe23, Stufe24 As Integer
        Dim V_100, V_130, V_160, V_180, V_500 As Integer
        Dim T_100, T_130, T_160, T_180, T_500 As Integer
        Dim G_200 As Integer
        Dim Index As Integer

        T_100 = _Betriebsparameter.Fahrparameter(22, KlausEBspecific.Betriebsparameter.FahrparameterEnum.T_100)
        T_130 = _Betriebsparameter.Fahrparameter(22, KlausEBspecific.Betriebsparameter.FahrparameterEnum.T_130)
        T_160 = _Betriebsparameter.Fahrparameter(22, KlausEBspecific.Betriebsparameter.FahrparameterEnum.T_160)
        T_180 = _Betriebsparameter.Fahrparameter(22, KlausEBspecific.Betriebsparameter.FahrparameterEnum.T_180)
        T_500 = _Betriebsparameter.Fahrparameter(22, KlausEBspecific.Betriebsparameter.FahrparameterEnum.T_500)
        V_100 = _Betriebsparameter.Fahrparameter(22, KlausEBspecific.Betriebsparameter.FahrparameterEnum.V_100)
        V_130 = _Betriebsparameter.Fahrparameter(22, KlausEBspecific.Betriebsparameter.FahrparameterEnum.V_130)
        V_160 = _Betriebsparameter.Fahrparameter(22, KlausEBspecific.Betriebsparameter.FahrparameterEnum.V_160)
        V_180 = _Betriebsparameter.Fahrparameter(22, KlausEBspecific.Betriebsparameter.FahrparameterEnum.V_180)
        V_500 = _Betriebsparameter.Fahrparameter(22, KlausEBspecific.Betriebsparameter.FahrparameterEnum.V_500)
        G_200 = _Betriebsparameter.Fahrparameter(22, KlausEBspecific.Betriebsparameter.FahrparameterEnum.G_200)

        If A_StopB = 1 Then
            V_100 = 5000
        End If

        Stufe1 = _LokStufen.Holen(22, 1)
        Stufe2 = _LokStufen.Holen(22, 2)
        Stufe3 = _LokStufen.Holen(22, 3)
        Stufe4 = _LokStufen.Holen(22, 4)

        If Stufe2 = 1 Then
            T_100 = T_100
            T_130 = T_130
            T_160 = T_160
            V_180 = V_180
        ElseIf Stufe2 = 2 Then
            T_100 = T_100 + 300
            T_130 = T_130 + 300
            T_160 = T_160 + 300
            V_180 = V_180 + 500
        ElseIf Stufe2 = 3 Then
            T_100 = T_100 + 500
            T_130 = T_130 + 500
            T_160 = T_160 + 500
            V_180 = V_180 + 1000
        ElseIf Stufe2 = 4 Then
            T_100 = T_100 + 700
            T_130 = T_130 + 700
            T_160 = T_160 + 700
            V_180 = V_180 + 1500
        ElseIf Stufe2 = 5 Then
            T_100 = T_100 + 900
            T_130 = T_130 + 900
            T_160 = T_160 + 900
            V_180 = V_180 + 2000
        ElseIf Stufe2 = 6 Then
            T_100 = T_100 + 1200
            T_130 = T_130 + 1200
            T_160 = T_160 + 1200
            V_180 = V_180 + 2500
        Else
            T_100 = T_100 + 1200
            T_130 = T_130 + 1200
            T_160 = T_160 + 1200
            V_180 = V_180 + 2500
        End If

        Stufe2 = Stufe1

        Stufe11 = Stufe1 + 1
        If Stufe11 > Stufe3 Then
            Stufe11 = Stufe3
        End If
        Stufe12 = Stufe1 + 2
        If Stufe12 > Stufe3 Then
            Stufe12 = Stufe3
        End If
        Stufe13 = Stufe1 + 3
        If Stufe13 > Stufe3 Then
            Stufe13 = Stufe3
        End If
        Stufe14 = Stufe1 + 4
        If Stufe14 > Stufe3 Then
            Stufe14 = Stufe3
        End If

        Stufe21 = Stufe2 + 1
        If Stufe21 > Stufe3 Then
            Stufe21 = Stufe3
        End If
        Stufe22 = Stufe2 + 2
        If Stufe22 > Stufe3 Then
            Stufe22 = Stufe3
        End If
        Stufe23 = Stufe2 + 3
        If Stufe23 > Stufe3 Then
            Stufe23 = Stufe3
        End If
        Stufe24 = Stufe2 + 4
        If Stufe24 > Stufe3 Then
            Stufe24 = Stufe3
        End If
        If G_200 > 0 Then
            If G_200 < Stufe4 Then
                G_200 = Stufe4
            End If
        Else
            G_200 = Stufe4
        End If

        If Betriebsart = 1 And (_GlsL22 = 3 Or _GlsL22 = 4) Then
            SetProgramCounterLabel1(_Prog22)
        Else
            SetProgramCounterLabel(_Prog22)
        End If

        ' Lok starten - Bahnhofsausfahrt

        If _Prog22 = 0 Then
            Prog_Lok22.Interval = 2000
            If _Fahrzeugbeleuchtung2 > 0 Then
                _eb.lokSteuern(22, Klassen.LokEigenschaften.Hauptfunktion, 1) ' Licht ein
            End If
        ElseIf _Prog22 = 1 Then
        ElseIf _Prog22 = 2 Then
            _Betriebsparameter.RundenErhoehen(22)
        ElseIf _Prog22 = 3 Then
        ElseIf _Prog22 = 4 Then
        ElseIf _Prog22 = 5 Then
        ElseIf _Prog22 = 6 Then

            ' Bahnhofsausfahrt

        ElseIf _Prog22 = 7 Then
            _eb.lokSteuern(22, Klassen.LokEigenschaften.Geschwindigkeit, Stufe1)
        ElseIf _Prog22 = 8 Then
            _eb.lokSteuern(22, Klassen.LokEigenschaften.Geschwindigkeit, Stufe11)
        ElseIf _Prog22 = 9 Then
            _eb.lokSteuern(22, Klassen.LokEigenschaften.Geschwindigkeit, Stufe12)
        ElseIf _Prog22 = 10 Then
            _eb.lokSteuern(22, Klassen.LokEigenschaften.Geschwindigkeit, Stufe13)
        ElseIf _Prog22 = 11 Then
            _eb.lokSteuern(22, Klassen.LokEigenschaften.Geschwindigkeit, Stufe14)
        ElseIf _Prog22 = 12 Then
            _eb.lokSteuern(22, Klassen.LokEigenschaften.Geschwindigkeit, Stufe3)

            ' Lok abstellen

        ElseIf _Prog22 = 50 Then
            Prog_Lok22.Interval = 2000
        ElseIf _Prog22 = 51 Then
        ElseIf _Prog22 = 52 Then
            If _Fahrzeugbeleuchtung2 < 2 Then
                _eb.lokSteuern(22, Klassen.LokEigenschaften.Hauptfunktion, 0) ' Licht aus
            End If

            ' Lok bremsen (Bahnhofseinfahrt Normalzug von links und von rechts)

        ElseIf _Prog22 = 100 Then
            Prog_Lok22.Interval = V_100
        ElseIf _Prog22 = 101 Then
            _eb.lokSteuern(22, Klassen.LokEigenschaften.Geschwindigkeit, Stufe24)
            Prog_Lok22.Interval = T_100
        ElseIf _Prog22 = 102 Then
            _eb.lokSteuern(22, Klassen.LokEigenschaften.Geschwindigkeit, Stufe23)
        ElseIf _Prog22 = 103 Then
            _eb.lokSteuern(22, Klassen.LokEigenschaften.Geschwindigkeit, Stufe22)
        ElseIf _Prog22 = 104 Then
            _eb.lokSteuern(22, Klassen.LokEigenschaften.Geschwindigkeit, Stufe21)
        ElseIf _Prog22 = 105 Then
            _eb.lokSteuern(22, Klassen.LokEigenschaften.Geschwindigkeit, Stufe2)

            ' Lok bremsen (Bahnhofseinfahrt Kurzzug von links)

        ElseIf _Prog22 = 130 Then
            Prog_Lok22.Interval = V_130
        ElseIf _Prog22 = 131 Then
            _eb.lokSteuern(22, Klassen.LokEigenschaften.Geschwindigkeit, Stufe24)
            Prog_Lok22.Interval = T_130
        ElseIf _Prog22 = 132 Then
            _eb.lokSteuern(22, Klassen.LokEigenschaften.Geschwindigkeit, Stufe23)
        ElseIf _Prog22 = 133 Then
            _eb.lokSteuern(22, Klassen.LokEigenschaften.Geschwindigkeit, Stufe22)
        ElseIf _Prog22 = 134 Then
            _eb.lokSteuern(22, Klassen.LokEigenschaften.Geschwindigkeit, Stufe21)
        ElseIf _Prog22 = 135 Then
            _eb.lokSteuern(22, Klassen.LokEigenschaften.Geschwindigkeit, Stufe2)
        ElseIf _Prog22 = 136 Then
            _eb.lokSteuern(22, Klassen.LokEigenschaften.Geschwindigkeit, 0)
        ElseIf _Prog22 = 137 Then
            Prog_Lok22.Interval = 2000
        ElseIf _Prog22 = 138 Then
            If _Fahrzeugbeleuchtung2 < 2 Then
                _eb.lokSteuern(22, Klassen.LokEigenschaften.Hauptfunktion, 0) ' Licht aus
            End If

            ' Lok bremsen (Bahnhofseinfahrt Kurzzug von rechts)

        ElseIf _Prog22 = 160 Then
            Prog_Lok22.Interval = V_160
        ElseIf _Prog22 = 161 Then
            _eb.lokSteuern(22, Klassen.LokEigenschaften.Geschwindigkeit, Stufe24)
            Prog_Lok22.Interval = T_160
        ElseIf _Prog22 = 162 Then
            _eb.lokSteuern(22, Klassen.LokEigenschaften.Geschwindigkeit, Stufe23)
        ElseIf _Prog22 = 163 Then
            _eb.lokSteuern(22, Klassen.LokEigenschaften.Geschwindigkeit, Stufe22)
        ElseIf _Prog22 = 164 Then
            _eb.lokSteuern(22, Klassen.LokEigenschaften.Geschwindigkeit, Stufe21)
        ElseIf _Prog22 = 165 Then
            _eb.lokSteuern(22, Klassen.LokEigenschaften.Geschwindigkeit, Stufe2)
        ElseIf _Prog22 = 166 Then
            _eb.lokSteuern(22, Klassen.LokEigenschaften.Geschwindigkeit, 0)
        ElseIf _Prog22 = 167 Then
            Prog_Lok22.Interval = 2000
        ElseIf _Prog22 = 168 Then
            If _Fahrzeugbeleuchtung2 < 2 Then
                _eb.lokSteuern(22, Klassen.LokEigenschaften.Hauptfunktion, 0) ' Licht aus
            End If

            ' Rangierzug

        ElseIf _Prog22 = 180 Then
            _eb.lokSteuern(22, Klassen.LokEigenschaften.Geschwindigkeit, 2)
            Prog_Lok22.Interval = V_180
        ElseIf _Prog22 = 181 Then
            Prog_Lok22.Interval = T_180
            _eb.lokSteuern(22, Klassen.LokEigenschaften.Geschwindigkeit, 1)
        ElseIf _Prog22 = 182 Then
            _eb.lokSteuern(22, Klassen.LokEigenschaften.Geschwindigkeit, 0)

            ' Tunnelausfahrt

        ElseIf _Prog22 = 200 Then ' Kontakt 1.2 <- (bergauf)
            _eb.lokSteuern(22, Klassen.LokEigenschaften.Geschwindigkeit, G_200)
            Prog_Lok22.Interval = 2000
        ElseIf _Prog22 = 201 Then
        ElseIf _Prog22 = 202 Then
        ElseIf _Prog22 = 203 Then
            If Stufe4 < 10 Then
                _eb.lokSteuern(22, Klassen.LokEigenschaften.Geschwindigkeit, 10)
            Else
                _eb.lokSteuern(22, Klassen.LokEigenschaften.Geschwindigkeit, Stufe4)
            End If
        ElseIf _Prog22 = 204 Then
        ElseIf _Prog22 = 205 Then
            If Stufe4 < Stufe3 Then
                _eb.lokSteuern(22, Klassen.LokEigenschaften.Geschwindigkeit, Stufe3)
            Else
                _eb.lokSteuern(22, Klassen.LokEigenschaften.Geschwindigkeit, Stufe4)
            End If

        ElseIf _Prog22 = 220 Then ' Kontakt 3.1 -> (hinter dem Martinstor bergauf)
            Prog_Lok22.Interval = 2000
        ElseIf _Prog22 = 221 Then
        ElseIf _Prog22 = 222 Then

        ElseIf _Prog22 = 240 Then ' Kontakt 3.7 <- (hinter der Brücke bergauf)
            Prog_Lok22.Interval = 2000
        ElseIf _Prog22 = 241 Then
        ElseIf _Prog22 = 242 Then

        ElseIf _Prog22 = 260 Then ' Kontakt 3.3 (links bzw vor der Brücke)
            Prog_Lok22.Interval = 2000
        ElseIf _Prog22 = 261 Then
        ElseIf _Prog22 = 262 Then
            _eb.lokSteuern(22, Klassen.LokEigenschaften.Geschwindigkeit, Stufe3)

        ElseIf _Prog22 = 600 Then ' Kontakt 3.5 <- (unter der Burg)
            Prog_Lok22.Interval = 2000
        ElseIf _Prog22 = 601 Then
        ElseIf _Prog22 = 602 Then

        ElseIf _Prog22 = 620 Then ' Kontakt 3.7 -> (hinter der Brücke bergab)
            Prog_Lok22.Interval = 2000
        ElseIf _Prog22 = 621 Then
        ElseIf _Prog22 = 622 Then

        ElseIf _Prog22 = 640 Then ' Kontakt 3.1 <- Talfahrt
            Prog_Lok22.Interval = 2000
        ElseIf _Prog22 = 641 Then
        ElseIf _Prog22 = 642 Then

        ElseIf _Prog22 = 660 Then ' Kontakt 1.2 -> Talfahrt
            Prog_Lok22.Interval = 2000
        ElseIf _Prog22 = 661 Then
        ElseIf _Prog22 = 662 Then

        ElseIf _Prog22 = 700 Then ' Kontakt 0.4 <- Diagonale
            Prog_Lok22.Interval = 2000
        ElseIf _Prog22 = 701 Then
        ElseIf _Prog22 = 702 Then

            ' Zindelstein

        ElseIf _Prog22 = 500 Then
            Prog_Lok22.Interval = V_500
        ElseIf _Prog22 = 501 Then
            _eb.lokSteuern(22, Klassen.LokEigenschaften.Geschwindigkeit, Stufe23)
            Prog_Lok22.Interval = T_500
        ElseIf _Prog22 = 502 Then
            _eb.lokSteuern(22, Klassen.LokEigenschaften.Geschwindigkeit, Stufe22)
        ElseIf _Prog22 = 503 Then
            _eb.lokSteuern(22, Klassen.LokEigenschaften.Geschwindigkeit, Stufe21)
        ElseIf _Prog22 = 504 Then
            _eb.lokSteuern(22, Klassen.LokEigenschaften.Geschwindigkeit, Stufe2)
        ElseIf _Prog22 = 505 Then
            _eb.lokSteuern(22, Klassen.LokEigenschaften.Geschwindigkeit, 0)

        Else
            _Prog22 = 0
            Prog_Lok22.Stop()
            Prog_Lok22.Interval = 200
            If Betriebsart = 1 Then
                SetProgramCounterLabel1(String.Empty)
            Else
                SetProgramCounterLabel(String.Empty)
            End If
        End If
        _Prog22 = _Prog22 + 1
    End Sub
    Private Sub HandleTimerElapsed35(sender As System.Object, e As System.EventArgs) Handles Prog_Lok23.Elapsed

        '*** Fahrprogramm für E111
        '*** Datum: 23.02.2020

        SetText(TextBox1, "E-Lok 111 043-6                                                         IBS: 06.01.2022 V1: 2 - V3: 6")
        LoadImage(PictureBox1, "H:\\EB_Media\\LokFotos\\Baureihe_111_02.jpg")
        GeschwindikeitenSetzen(23)

        Dim Stufe1, Stufe2, Stufe3, Stufe4 As Integer
        Dim Stufe11, Stufe12, Stufe13, Stufe14, Stufe21, Stufe22, Stufe23, Stufe24 As Integer
        Dim V_100, V_130, V_160, V_180, V_500 As Integer
        Dim T_100, T_130, T_160, T_180, T_500 As Integer
        Dim G_200 As Integer

        T_100 = _Betriebsparameter.Fahrparameter(23, KlausEBspecific.Betriebsparameter.FahrparameterEnum.T_100)
        T_130 = _Betriebsparameter.Fahrparameter(23, KlausEBspecific.Betriebsparameter.FahrparameterEnum.T_130)
        T_160 = _Betriebsparameter.Fahrparameter(23, KlausEBspecific.Betriebsparameter.FahrparameterEnum.T_160)
        T_180 = _Betriebsparameter.Fahrparameter(23, KlausEBspecific.Betriebsparameter.FahrparameterEnum.T_180)
        T_500 = _Betriebsparameter.Fahrparameter(23, KlausEBspecific.Betriebsparameter.FahrparameterEnum.T_500)
        V_100 = _Betriebsparameter.Fahrparameter(23, KlausEBspecific.Betriebsparameter.FahrparameterEnum.V_100)
        V_130 = _Betriebsparameter.Fahrparameter(23, KlausEBspecific.Betriebsparameter.FahrparameterEnum.V_130)
        V_160 = _Betriebsparameter.Fahrparameter(23, KlausEBspecific.Betriebsparameter.FahrparameterEnum.V_160)
        V_180 = _Betriebsparameter.Fahrparameter(23, KlausEBspecific.Betriebsparameter.FahrparameterEnum.V_180)
        V_500 = _Betriebsparameter.Fahrparameter(23, KlausEBspecific.Betriebsparameter.FahrparameterEnum.V_500)
        G_200 = _Betriebsparameter.Fahrparameter(23, KlausEBspecific.Betriebsparameter.FahrparameterEnum.G_200)

        If A_StopB = 1 Then
            V_100 = 4000
        End If

        Stufe1 = _LokStufen.Holen(23, 1)
        Stufe2 = _LokStufen.Holen(23, 2)
        Stufe3 = _LokStufen.Holen(23, 3)
        Stufe4 = _LokStufen.Holen(23, 4)

        If Stufe2 = 1 Then
            T_100 = T_100
            T_130 = T_130
            T_160 = T_160
            V_180 = V_180
        ElseIf Stufe2 = 2 Then
            T_100 = T_100 + 300
            T_130 = T_130 + 300
            T_160 = T_160 + 300
            V_180 = V_180 + 500
        ElseIf Stufe2 = 3 Then
            T_100 = T_100 + 500
            T_130 = T_130 + 500
            T_160 = T_160 + 500
            V_180 = V_180 + 1000
        ElseIf Stufe2 = 4 Then
            T_100 = T_100 + 700
            T_130 = T_130 + 700
            T_160 = T_160 + 700
            V_180 = V_180 + 1500
        ElseIf Stufe2 = 5 Then
            T_100 = T_100 + 900
            T_130 = T_130 + 900
            T_160 = T_160 + 900
            V_180 = V_180 + 2000
        ElseIf Stufe2 = 6 Then
            T_100 = T_100 + 1200
            T_130 = T_130 + 1200
            T_160 = T_160 + 1200
            V_180 = V_180 + 2500
        Else
            T_100 = T_100 + 1200
            T_130 = T_130 + 1200
            T_160 = T_160 + 1200
            V_180 = V_180 + 2500
        End If

        Stufe2 = Stufe1

        Stufe11 = Stufe1 + 1
        If Stufe11 > Stufe3 Then
            Stufe11 = Stufe3
        End If
        Stufe12 = Stufe1 + 2
        If Stufe12 > Stufe3 Then
            Stufe12 = Stufe3
        End If
        Stufe13 = Stufe1 + 3
        If Stufe13 > Stufe3 Then
            Stufe13 = Stufe3
        End If
        Stufe14 = Stufe1 + 4
        If Stufe14 > Stufe3 Then
            Stufe14 = Stufe3
        End If

        Stufe21 = Stufe2 + 1
        If Stufe21 > Stufe3 Then
            Stufe21 = Stufe3
        End If
        Stufe22 = Stufe2 + 2
        If Stufe22 > Stufe3 Then
            Stufe22 = Stufe3
        End If
        Stufe23 = Stufe2 + 3
        If Stufe23 > Stufe3 Then
            Stufe23 = Stufe3
        End If
        Stufe24 = Stufe2 + 4
        If Stufe24 > Stufe3 Then
            Stufe24 = Stufe3
        End If
        If G_200 > 0 Then
            If G_200 < Stufe4 Then
                G_200 = Stufe4
            End If
        Else
            G_200 = Stufe4
        End If

        If Betriebsart = 1 And (_GlsL23 = 3 Or _GlsL23 = 4) Then
            SetProgramCounterLabel1(_Prog23)
        Else
            SetProgramCounterLabel(_Prog23)
        End If

        ' Lok starten - Bahnhofsausfahrt

        If _Prog23 = 0 Then
            Prog_Lok23.Interval = 2000
            If _Fahrzeugbeleuchtung2 > 0 Then
                _eb.lokSteuern(23, Klassen.LokEigenschaften.Hauptfunktion, 1) ' Licht ein
            End If
        ElseIf _Prog23 = 1 Then
        ElseIf _Prog23 = 2 Then
            _Betriebsparameter.RundenErhoehen(23)
        ElseIf _Prog23 = 3 Then
        ElseIf _Prog23 = 4 Then
        ElseIf _Prog23 = 5 Then
        ElseIf _Prog23 = 6 Then

            ' Bahnhofsausfahrt

        ElseIf _Prog23 = 7 Then
            _eb.lokSteuern(23, Klassen.LokEigenschaften.Geschwindigkeit, Stufe1)
        ElseIf _Prog23 = 8 Then
            _eb.lokSteuern(23, Klassen.LokEigenschaften.Geschwindigkeit, Stufe11)
        ElseIf _Prog23 = 9 Then
            _eb.lokSteuern(23, Klassen.LokEigenschaften.Geschwindigkeit, Stufe12)
        ElseIf _Prog23 = 10 Then
            _eb.lokSteuern(23, Klassen.LokEigenschaften.Geschwindigkeit, Stufe13)
        ElseIf _Prog23 = 11 Then
            _eb.lokSteuern(23, Klassen.LokEigenschaften.Geschwindigkeit, Stufe14)
        ElseIf _Prog23 = 12 Then
            _eb.lokSteuern(23, Klassen.LokEigenschaften.Geschwindigkeit, Stufe3)

            ' Lok abstellen

        ElseIf _Prog23 = 50 Then
            Prog_Lok23.Interval = 2000
        ElseIf _Prog23 = 51 Then
        ElseIf _Prog23 = 52 Then
            If _Fahrzeugbeleuchtung2 < 2 Then
                _eb.lokSteuern(23, Klassen.LokEigenschaften.Hauptfunktion, 0) ' Licht aus
            End If

            ' Lok bremsen (Bahnhofseinfahrt Normalzug von links und von rechts)

        ElseIf _Prog23 = 100 Then
            Prog_Lok23.Interval = V_100
        ElseIf _Prog23 = 101 Then
            _eb.lokSteuern(23, Klassen.LokEigenschaften.Geschwindigkeit, Stufe24)
            Prog_Lok23.Interval = T_100
        ElseIf _Prog23 = 102 Then
            _eb.lokSteuern(23, Klassen.LokEigenschaften.Geschwindigkeit, Stufe23)
        ElseIf _Prog23 = 103 Then
            _eb.lokSteuern(23, Klassen.LokEigenschaften.Geschwindigkeit, Stufe22)
        ElseIf _Prog23 = 104 Then
            _eb.lokSteuern(23, Klassen.LokEigenschaften.Geschwindigkeit, Stufe21)
        ElseIf _Prog23 = 105 Then
            _eb.lokSteuern(23, Klassen.LokEigenschaften.Geschwindigkeit, Stufe2)

            ' Lok bremsen (Bahnhofseinfahrt Kurzzug von links)

        ElseIf _Prog23 = 130 Then
            Prog_Lok23.Interval = V_130
        ElseIf _Prog23 = 131 Then
            _eb.lokSteuern(23, Klassen.LokEigenschaften.Geschwindigkeit, Stufe24)
            Prog_Lok23.Interval = T_130
        ElseIf _Prog23 = 132 Then
            _eb.lokSteuern(23, Klassen.LokEigenschaften.Geschwindigkeit, Stufe23)
        ElseIf _Prog23 = 133 Then
            _eb.lokSteuern(23, Klassen.LokEigenschaften.Geschwindigkeit, Stufe22)
        ElseIf _Prog23 = 134 Then
            _eb.lokSteuern(23, Klassen.LokEigenschaften.Geschwindigkeit, Stufe21)
        ElseIf _Prog23 = 135 Then
            _eb.lokSteuern(23, Klassen.LokEigenschaften.Geschwindigkeit, Stufe2)
        ElseIf _Prog23 = 136 Then
            _eb.lokSteuern(23, Klassen.LokEigenschaften.Geschwindigkeit, 0)
        ElseIf _Prog23 = 137 Then
            Prog_Lok23.Interval = 2000
        ElseIf _Prog23 = 138 Then
            If _Fahrzeugbeleuchtung2 < 2 Then
                _eb.lokSteuern(23, Klassen.LokEigenschaften.Hauptfunktion, 0) ' Licht aus
            End If

            ' Lok bremsen (Bahnhofseinfahrt Kurzzug von rechts)

        ElseIf _Prog23 = 160 Then
            Prog_Lok23.Interval = V_160
        ElseIf _Prog23 = 161 Then
            _eb.lokSteuern(23, Klassen.LokEigenschaften.Geschwindigkeit, Stufe24)
            Prog_Lok23.Interval = T_160
        ElseIf _Prog23 = 162 Then
            _eb.lokSteuern(23, Klassen.LokEigenschaften.Geschwindigkeit, Stufe23)
        ElseIf _Prog23 = 163 Then
            _eb.lokSteuern(23, Klassen.LokEigenschaften.Geschwindigkeit, Stufe22)
        ElseIf _Prog23 = 164 Then
            _eb.lokSteuern(23, Klassen.LokEigenschaften.Geschwindigkeit, Stufe21)
        ElseIf _Prog23 = 165 Then
            _eb.lokSteuern(23, Klassen.LokEigenschaften.Geschwindigkeit, Stufe2)
        ElseIf _Prog23 = 166 Then
            _eb.lokSteuern(23, Klassen.LokEigenschaften.Geschwindigkeit, 0)
        ElseIf _Prog23 = 167 Then
            Prog_Lok23.Interval = 2000
        ElseIf _Prog23 = 168 Then
            If _Fahrzeugbeleuchtung2 < 2 Then
                _eb.lokSteuern(23, Klassen.LokEigenschaften.Hauptfunktion, 0) ' Licht aus
            End If

            ' Rangierzug

        ElseIf _Prog23 = 180 Then
            _eb.lokSteuern(23, Klassen.LokEigenschaften.Geschwindigkeit, 2)
            Prog_Lok23.Interval = V_180
        ElseIf _Prog23 = 181 Then
            Prog_Lok23.Interval = T_180
            _eb.lokSteuern(23, Klassen.LokEigenschaften.Geschwindigkeit, 1)
        ElseIf _Prog23 = 182 Then
            _eb.lokSteuern(23, Klassen.LokEigenschaften.Geschwindigkeit, 0)

            ' Tunnelausfahrt

        ElseIf _Prog23 = 200 Then ' Kontakt 1.2 <- (bergauf)
            _eb.lokSteuern(23, Klassen.LokEigenschaften.Geschwindigkeit, G_200)
            Prog_Lok23.Interval = 2000
        ElseIf _Prog23 = 201 Then
        ElseIf _Prog23 = 202 Then
        ElseIf _Prog23 = 203 Then
        ElseIf _Prog23 = 204 Then
        ElseIf _Prog23 = 205 Then
            If Stufe4 < Stufe3 Then
                _eb.lokSteuern(23, Klassen.LokEigenschaften.Geschwindigkeit, Stufe3)
            Else
                _eb.lokSteuern(23, Klassen.LokEigenschaften.Geschwindigkeit, Stufe4)
            End If

        ElseIf _Prog23 = 220 Then ' Kontakt 3.1 -> (hinter dem Martinstor bergauf)
            Prog_Lok23.Interval = 2000
        ElseIf _Prog23 = 221 Then
        ElseIf _Prog23 = 222 Then

        ElseIf _Prog23 = 240 Then ' Kontakt 3.7 <- (hinter der Brücke bergauf)
            Prog_Lok23.Interval = 2000
        ElseIf _Prog23 = 241 Then
        ElseIf _Prog23 = 242 Then

        ElseIf _Prog23 = 260 Then ' Kontakt 3.3 (links bzw vor der Brücke)
            Prog_Lok23.Interval = 2000
        ElseIf _Prog23 = 261 Then
        ElseIf _Prog23 = 262 Then
            _eb.lokSteuern(23, Klassen.LokEigenschaften.Geschwindigkeit, Stufe3)

        ElseIf _Prog23 = 600 Then ' Kontakt 3.5 <- (unter der Burg)
            Prog_Lok23.Interval = 2000
        ElseIf _Prog23 = 601 Then
        ElseIf _Prog23 = 602 Then

        ElseIf _Prog23 = 620 Then ' Kontakt 3.7 -> (hinter der Brücke bergab)
            Prog_Lok23.Interval = 2000
        ElseIf _Prog23 = 621 Then
        ElseIf _Prog23 = 622 Then

        ElseIf _Prog23 = 640 Then ' Kontakt 3.1 <- Talfahrt
            Prog_Lok23.Interval = 2000
        ElseIf _Prog23 = 641 Then
        ElseIf _Prog23 = 642 Then

        ElseIf _Prog23 = 660 Then ' Kontakt 1.2 -> Talfahrt
            Prog_Lok23.Interval = 2000
        ElseIf _Prog23 = 661 Then
        ElseIf _Prog23 = 662 Then

        ElseIf _Prog23 = 700 Then ' Kontakt 0.4 <- Diagonale
            Prog_Lok23.Interval = 2000
        ElseIf _Prog23 = 701 Then
        ElseIf _Prog23 = 702 Then

            ' Zindelstein

        ElseIf _Prog23 = 500 Then
            Prog_Lok23.Interval = V_500
        ElseIf _Prog23 = 501 Then
            _eb.lokSteuern(23, Klassen.LokEigenschaften.Geschwindigkeit, Stufe23)
            Prog_Lok23.Interval = T_500
        ElseIf _Prog23 = 502 Then
            _eb.lokSteuern(23, Klassen.LokEigenschaften.Geschwindigkeit, Stufe22)
        ElseIf _Prog23 = 503 Then
            _eb.lokSteuern(23, Klassen.LokEigenschaften.Geschwindigkeit, Stufe21)
        ElseIf _Prog23 = 504 Then
            _eb.lokSteuern(23, Klassen.LokEigenschaften.Geschwindigkeit, Stufe2)
        ElseIf _Prog23 = 505 Then
            _eb.lokSteuern(23, Klassen.LokEigenschaften.Geschwindigkeit, 0)


        Else
            _Prog23 = 0
            Prog_Lok23.Stop()
            Prog_Lok23.Interval = 200
            If Betriebsart = 1 Then
                SetProgramCounterLabel1(String.Empty)
            Else
                SetProgramCounterLabel(String.Empty)
            End If
        End If
        _Prog23 = _Prog23 + 1
    End Sub
    Private Sub HandleTimerElapsed36(sender As System.Object, e As System.EventArgs) Handles Prog_Lok24.Elapsed

        '*** Fahrprogramm für E 110 155-9
        '*** Datum: 11.10.2025

        SetText(TextBox1, "E-Lok 110 155-9                                                         IBS: 05.01.2026 - V3 : 6")
        LoadImage(PictureBox1, "H:\\EB_Media\\LokFotos\\Baureihe_110_10.jpg")
        GeschwindikeitenSetzen(24)

        Dim Stufe1, Stufe2, Stufe3, Stufe4 As Integer
        Dim Stufe11, Stufe12, Stufe13, Stufe14, Stufe21, Stufe22, Stufe23, Stufe24 As Integer
        Dim V_100, V_130, V_160, V_180, V_500 As Integer
        Dim T_100, T_130, T_160, T_180, T_500 As Integer
        Dim G_200 As Integer

        T_100 = _Betriebsparameter.Fahrparameter(24, KlausEBspecific.Betriebsparameter.FahrparameterEnum.T_100)
        T_130 = _Betriebsparameter.Fahrparameter(24, KlausEBspecific.Betriebsparameter.FahrparameterEnum.T_130)
        T_160 = _Betriebsparameter.Fahrparameter(24, KlausEBspecific.Betriebsparameter.FahrparameterEnum.T_160)
        T_180 = _Betriebsparameter.Fahrparameter(24, KlausEBspecific.Betriebsparameter.FahrparameterEnum.T_180)
        T_500 = _Betriebsparameter.Fahrparameter(24, KlausEBspecific.Betriebsparameter.FahrparameterEnum.T_500)
        V_100 = _Betriebsparameter.Fahrparameter(24, KlausEBspecific.Betriebsparameter.FahrparameterEnum.V_100)
        V_130 = _Betriebsparameter.Fahrparameter(24, KlausEBspecific.Betriebsparameter.FahrparameterEnum.V_130)
        V_160 = _Betriebsparameter.Fahrparameter(24, KlausEBspecific.Betriebsparameter.FahrparameterEnum.V_160)
        V_180 = _Betriebsparameter.Fahrparameter(24, KlausEBspecific.Betriebsparameter.FahrparameterEnum.V_180)
        V_500 = _Betriebsparameter.Fahrparameter(24, KlausEBspecific.Betriebsparameter.FahrparameterEnum.V_500)
        G_200 = _Betriebsparameter.Fahrparameter(24, KlausEBspecific.Betriebsparameter.FahrparameterEnum.G_200)

        If A_StopB = 1 Then
            V_100 = 8000
        End If

        Stufe1 = _LokStufen.Holen(24, 1)
        Stufe2 = _LokStufen.Holen(24, 2)
        Stufe3 = _LokStufen.Holen(24, 3)
        Stufe4 = _LokStufen.Holen(24, 4)

        If Stufe2 = 1 Then
            T_100 = T_100
            T_130 = T_130
            T_160 = T_160
            V_180 = V_180
        ElseIf Stufe2 = 2 Then
            T_100 = T_100 + 300
            T_130 = T_130 + 300
            T_160 = T_160 + 300
            V_180 = V_180 + 500
        ElseIf Stufe2 = 3 Then
            T_100 = T_100 + 500
            T_130 = T_130 + 500
            T_160 = T_160 + 500
            V_180 = V_180 + 1000
        ElseIf Stufe2 = 4 Then
            T_100 = T_100 + 700
            T_130 = T_130 + 700
            T_160 = T_160 + 700
            V_180 = V_180 + 1500
        ElseIf Stufe2 = 5 Then
            T_100 = T_100 + 900
            T_130 = T_130 + 900
            T_160 = T_160 + 900
            V_180 = V_180 + 2000
        ElseIf Stufe2 = 6 Then
            T_100 = T_100 + 1200
            T_130 = T_130 + 1200
            T_160 = T_160 + 1200
            V_180 = V_180 + 2500
        Else
            T_100 = T_100 + 1200
            T_130 = T_130 + 1200
            T_160 = T_160 + 1200
            V_180 = V_180 + 2500
        End If

        Stufe2 = Stufe1

        Stufe11 = Stufe1 + 1
        If Stufe11 > Stufe3 Then
            Stufe11 = Stufe3
        End If
        Stufe12 = Stufe1 + 2
        If Stufe12 > Stufe3 Then
            Stufe12 = Stufe3
        End If
        Stufe13 = Stufe1 + 3
        If Stufe13 > Stufe3 Then
            Stufe13 = Stufe3
        End If
        Stufe14 = Stufe1 + 4
        If Stufe14 > Stufe3 Then
            Stufe14 = Stufe3
        End If

        Stufe21 = Stufe2 + 1
        If Stufe21 > Stufe3 Then
            Stufe21 = Stufe3
        End If
        Stufe22 = Stufe2 + 2
        If Stufe22 > Stufe3 Then
            Stufe22 = Stufe3
        End If
        Stufe23 = Stufe2 + 3
        If Stufe23 > Stufe3 Then
            Stufe23 = Stufe3
        End If
        Stufe24 = Stufe2 + 4
        If Stufe24 > Stufe3 Then
            Stufe24 = Stufe3
        End If
        If G_200 > 0 Then
            If G_200 < Stufe4 Then
                G_200 = Stufe4
            End If
        Else
            G_200 = Stufe4
        End If


        If Betriebsart = 1 And (_GlsL24 = 3 Or _GlsL24 = 4) Then
            SetProgramCounterLabel1(_Prog24)
        Else
            SetProgramCounterLabel(_Prog24)
        End If

        ' Lok starten - Bahnhofsausfahrt

        If _Prog24 = 0 Then
            Prog_Lok24.Interval = 2000
            If _Fahrzeugbeleuchtung2 > 0 Then
                _eb.lokSteuern(24, Klassen.LokEigenschaften.Hauptfunktion, 1) ' Licht ein
            End If
        ElseIf _Prog24 = 1 Then
        ElseIf _Prog24 = 2 Then
            _Betriebsparameter.RundenErhoehen(24)
        ElseIf _Prog24 = 3 Then
        ElseIf _Prog24 = 4 Then
        ElseIf _Prog24 = 5 Then
        ElseIf _Prog24 = 6 Then

            ' Bahnhofsausfahrt

        ElseIf _Prog24 = 7 Then
            _eb.lokSteuern(24, Klassen.LokEigenschaften.Geschwindigkeit, Stufe1)
        ElseIf _Prog24 = 8 Then
            _eb.lokSteuern(24, Klassen.LokEigenschaften.Geschwindigkeit, Stufe11)
        ElseIf _Prog24 = 9 Then
            _eb.lokSteuern(24, Klassen.LokEigenschaften.Geschwindigkeit, Stufe12)
        ElseIf _Prog24 = 10 Then
            _eb.lokSteuern(24, Klassen.LokEigenschaften.Geschwindigkeit, Stufe13)
        ElseIf _Prog24 = 11 Then
            _eb.lokSteuern(24, Klassen.LokEigenschaften.Geschwindigkeit, Stufe14)
        ElseIf _Prog24 = 12 Then
            _eb.lokSteuern(24, Klassen.LokEigenschaften.Geschwindigkeit, Stufe3)

            ' Lok abstellen

        ElseIf _Prog24 = 50 Then
            Prog_Lok24.Interval = 2000
        ElseIf _Prog24 = 51 Then
        ElseIf _Prog24 = 52 Then
            If _Fahrzeugbeleuchtung2 < 2 Then
                _eb.lokSteuern(24, Klassen.LokEigenschaften.Hauptfunktion, 0) ' Licht aus
            End If

            ' Lok bremsen (Bahnhofseinfahrt Normalzug von links und von rechts)

        ElseIf _Prog24 = 100 Then
            Prog_Lok24.Interval = V_100
        ElseIf _Prog24 = 101 Then
            _eb.lokSteuern(24, Klassen.LokEigenschaften.Geschwindigkeit, Stufe24)
            Prog_Lok24.Interval = T_100
        ElseIf _Prog24 = 102 Then
            _eb.lokSteuern(24, Klassen.LokEigenschaften.Geschwindigkeit, Stufe23)
        ElseIf _Prog24 = 103 Then
            _eb.lokSteuern(24, Klassen.LokEigenschaften.Geschwindigkeit, Stufe22)
        ElseIf _Prog24 = 104 Then
            _eb.lokSteuern(24, Klassen.LokEigenschaften.Geschwindigkeit, Stufe21)
        ElseIf _Prog24 = 104 Then
            _eb.lokSteuern(24, Klassen.LokEigenschaften.Geschwindigkeit, Stufe2)

            ' Lok bremsen (Bahnhofseinfahrt Kurzzug von links)

        ElseIf _Prog24 = 130 Then
            Prog_Lok24.Interval = V_130
        ElseIf _Prog24 = 131 Then
            _eb.lokSteuern(24, Klassen.LokEigenschaften.Geschwindigkeit, Stufe24)
            Prog_Lok24.Interval = T_130
        ElseIf _Prog24 = 132 Then
            _eb.lokSteuern(24, Klassen.LokEigenschaften.Geschwindigkeit, Stufe23)
        ElseIf _Prog24 = 133 Then
            _eb.lokSteuern(24, Klassen.LokEigenschaften.Geschwindigkeit, Stufe22)
        ElseIf _Prog24 = 134 Then
            _eb.lokSteuern(24, Klassen.LokEigenschaften.Geschwindigkeit, Stufe21)
        ElseIf _Prog24 = 135 Then
            _eb.lokSteuern(24, Klassen.LokEigenschaften.Geschwindigkeit, Stufe2)
        ElseIf _Prog24 = 136 Then
            _eb.lokSteuern(24, Klassen.LokEigenschaften.Geschwindigkeit, 0)
        ElseIf _Prog24 = 137 Then
            Prog_Lok24.Interval = 2000
        ElseIf _Prog24 = 138 Then
            If _Fahrzeugbeleuchtung2 < 2 Then
                _eb.lokSteuern(24, Klassen.LokEigenschaften.Hauptfunktion, 0) ' Licht aus
            End If

            ' Lok bremsen (Bahnhofseinfahrt Kurzzug von rechts)

        ElseIf _Prog24 = 160 Then
            Prog_Lok24.Interval = V_160
        ElseIf _Prog24 = 161 Then
            _eb.lokSteuern(24, Klassen.LokEigenschaften.Geschwindigkeit, Stufe24)
            Prog_Lok24.Interval = T_160
        ElseIf _Prog24 = 162 Then
            _eb.lokSteuern(24, Klassen.LokEigenschaften.Geschwindigkeit, Stufe23)
        ElseIf _Prog24 = 163 Then
            _eb.lokSteuern(24, Klassen.LokEigenschaften.Geschwindigkeit, Stufe22)
        ElseIf _Prog24 = 164 Then
            _eb.lokSteuern(24, Klassen.LokEigenschaften.Geschwindigkeit, Stufe21)
        ElseIf _Prog24 = 165 Then
            _eb.lokSteuern(24, Klassen.LokEigenschaften.Geschwindigkeit, Stufe2)
        ElseIf _Prog24 = 166 Then
            _eb.lokSteuern(24, Klassen.LokEigenschaften.Geschwindigkeit, 0)
        ElseIf _Prog24 = 167 Then
            Prog_Lok24.Interval = 2000
        ElseIf _Prog24 = 168 Then
            If _Fahrzeugbeleuchtung2 < 2 Then
                _eb.lokSteuern(24, Klassen.LokEigenschaften.Hauptfunktion, 0) ' Licht aus
            End If

            ' Rangierzug

        ElseIf _Prog24 = 180 Then
            _eb.lokSteuern(24, Klassen.LokEigenschaften.Geschwindigkeit, 1)
            Prog_Lok24.Interval = V_180
        ElseIf _Prog24 = 181 Then
            Prog_Lok24.Interval = T_180
            _eb.lokSteuern(24, Klassen.LokEigenschaften.Geschwindigkeit, 1)
        ElseIf _Prog24 = 182 Then
            _eb.lokSteuern(24, Klassen.LokEigenschaften.Geschwindigkeit, 0)

            ' Tunnelausfahrt

        ElseIf _Prog24 = 200 Then ' Kontakt 1.2 <- (bergauf)
            _eb.lokSteuern(24, Klassen.LokEigenschaften.Geschwindigkeit, G_200)
            Prog_Lok24.Interval = 2000
        ElseIf _Prog24 = 201 Then
        ElseIf _Prog24 = 202 Then
        ElseIf _Prog24 = 203 Then
        ElseIf _Prog24 = 204 Then
        ElseIf _Prog24 = 205 Then
            If Stufe4 < Stufe3 Then
                _eb.lokSteuern(24, Klassen.LokEigenschaften.Geschwindigkeit, Stufe3)
            Else
                _eb.lokSteuern(24, Klassen.LokEigenschaften.Geschwindigkeit, Stufe4)
            End If

        ElseIf _Prog24 = 220 Then ' Kontakt 3.1 -> (hinter dem Martinstor bergauf)
            Prog_Lok24.Interval = 2000
        ElseIf _Prog24 = 221 Then
        ElseIf _Prog24 = 222 Then

        ElseIf _Prog24 = 240 Then ' Kontakt 3.7 <- (hinter der Brücke bergauf)
            Prog_Lok24.Interval = 2000
        ElseIf _Prog24 = 241 Then
        ElseIf _Prog24 = 242 Then

        ElseIf _Prog24 = 260 Then ' Kontakt 3.3 (links bzw vor der Brücke)
            Prog_Lok24.Interval = 2000
        ElseIf _Prog24 = 261 Then
        ElseIf _Prog24 = 262 Then
            _eb.lokSteuern(24, Klassen.LokEigenschaften.Geschwindigkeit, Stufe3)

        ElseIf _Prog24 = 600 Then ' Kontakt 3.5 <- (unter der Burg)
            Prog_Lok24.Interval = 2000
        ElseIf _Prog24 = 601 Then
        ElseIf _Prog24 = 602 Then

        ElseIf _Prog24 = 620 Then ' Kontakt 3.7 -> (hinter der Brücke bergab)
            Prog_Lok24.Interval = 2000
        ElseIf _Prog24 = 621 Then
        ElseIf _Prog24 = 622 Then

        ElseIf _Prog24 = 640 Then ' Kontakt 3.1 <- Talfahrt
            Prog_Lok24.Interval = 2000
        ElseIf _Prog24 = 641 Then
        ElseIf _Prog24 = 642 Then

        ElseIf _Prog24 = 660 Then ' Kontakt 1.2 -> Talfahrt
            Prog_Lok24.Interval = 2000
        ElseIf _Prog24 = 661 Then
        ElseIf _Prog24 = 662 Then

        ElseIf _Prog24 = 700 Then ' Kontakt 0.4 <- Diagonale
            Prog_Lok24.Interval = 2000
        ElseIf _Prog24 = 701 Then
        ElseIf _Prog24 = 702 Then

            ' Zindelstein

        ElseIf _Prog24 = 500 Then
            Prog_Lok24.Interval = V_500
        ElseIf _Prog24 = 501 Then
            _eb.lokSteuern(24, Klassen.LokEigenschaften.Geschwindigkeit, Stufe24)
            Prog_Lok24.Interval = T_500
        ElseIf _Prog24 = 502 Then
            _eb.lokSteuern(24, Klassen.LokEigenschaften.Geschwindigkeit, Stufe23)
        ElseIf _Prog24 = 503 Then
            _eb.lokSteuern(24, Klassen.LokEigenschaften.Geschwindigkeit, Stufe22)
        ElseIf _Prog24 = 504 Then
            _eb.lokSteuern(24, Klassen.LokEigenschaften.Geschwindigkeit, Stufe21)
        ElseIf _Prog24 = 505 Then
            _eb.lokSteuern(24, Klassen.LokEigenschaften.Geschwindigkeit, Stufe2)
        ElseIf _Prog24 = 506 Then
            _eb.lokSteuern(24, Klassen.LokEigenschaften.Geschwindigkeit, 0)

        Else
            _Prog24 = 0
            Prog_Lok24.Stop()
            Prog_Lok24.Interval = 200
            If Betriebsart = 1 Then
                SetProgramCounterLabel1(String.Empty)
            Else
                SetProgramCounterLabel(String.Empty)
            End If
        End If
        _Prog24 = _Prog24 + 1
    End Sub
    Private Sub HandleTimerElapsed37(sender As System.Object, e As System.EventArgs) Handles Prog_Lok25.Elapsed

        '*** Fahrprogramm für E-Lok RE 4/4
        '*** Datum: 23.02.2020 +

        SetText(TextBox1, "E-Lok RE 4/4                                                            IBS: 06.01.2022 - V3: 6")
        LoadImage(PictureBox1, "H:\\EB_Media\\LokFotos\\Baureihe_RE44_01.jpg")
        GeschwindikeitenSetzen(25)

        Dim Stufe1, Stufe2, Stufe3, Stufe4 As Integer
        Dim Stufe11, Stufe12, Stufe13, Stufe14, Stufe21, Stufe22, Stufe23, Stufe24 As Integer
        Dim V_100, V_130, V_160, V_180, V_500 As Integer
        Dim T_100, T_130, T_160, T_180, T_500 As Integer
        Dim G_200 As Integer

        T_100 = _Betriebsparameter.Fahrparameter(25, KlausEBspecific.Betriebsparameter.FahrparameterEnum.T_100)
        T_130 = _Betriebsparameter.Fahrparameter(25, KlausEBspecific.Betriebsparameter.FahrparameterEnum.T_130)
        T_160 = _Betriebsparameter.Fahrparameter(25, KlausEBspecific.Betriebsparameter.FahrparameterEnum.T_160)
        T_180 = _Betriebsparameter.Fahrparameter(25, KlausEBspecific.Betriebsparameter.FahrparameterEnum.T_180)
        T_500 = _Betriebsparameter.Fahrparameter(25, KlausEBspecific.Betriebsparameter.FahrparameterEnum.T_500)
        V_100 = _Betriebsparameter.Fahrparameter(25, KlausEBspecific.Betriebsparameter.FahrparameterEnum.V_100)
        V_130 = _Betriebsparameter.Fahrparameter(25, KlausEBspecific.Betriebsparameter.FahrparameterEnum.V_130)
        V_160 = _Betriebsparameter.Fahrparameter(25, KlausEBspecific.Betriebsparameter.FahrparameterEnum.V_160)
        V_180 = _Betriebsparameter.Fahrparameter(25, KlausEBspecific.Betriebsparameter.FahrparameterEnum.V_180)
        V_500 = _Betriebsparameter.Fahrparameter(25, KlausEBspecific.Betriebsparameter.FahrparameterEnum.V_500)
        G_200 = _Betriebsparameter.Fahrparameter(25, KlausEBspecific.Betriebsparameter.FahrparameterEnum.G_200)

        If A_StopB = 1 Then
            V_100 = 8000
        End If

        Stufe1 = _LokStufen.Holen(25, 1)
        Stufe2 = _LokStufen.Holen(25, 2)
        Stufe3 = _LokStufen.Holen(25, 3)
        Stufe4 = _LokStufen.Holen(25, 4)

        If Stufe2 = 1 Then
            T_100 = T_100
            T_130 = T_130
            T_160 = T_160
            V_180 = V_180
        ElseIf Stufe2 = 2 Then
            T_100 = T_100 + 300
            T_130 = T_130 + 300
            T_160 = T_160 + 300
            V_180 = V_180 + 500
        ElseIf Stufe2 = 3 Then
            T_100 = T_100 + 500
            T_130 = T_130 + 500
            T_160 = T_160 + 500
            V_180 = V_180 + 1000
        ElseIf Stufe2 = 4 Then
            T_100 = T_100 + 700
            T_130 = T_130 + 700
            T_160 = T_160 + 700
            V_180 = V_180 + 1500
        ElseIf Stufe2 = 5 Then
            T_100 = T_100 + 900
            T_130 = T_130 + 900
            T_160 = T_160 + 900
            V_180 = V_180 + 2000
        ElseIf Stufe2 = 6 Then
            T_100 = T_100 + 1200
            T_130 = T_130 + 1200
            T_160 = T_160 + 1200
            V_180 = V_180 + 2500
        Else
            T_100 = T_100 + 1200
            T_130 = T_130 + 1200
            T_160 = T_160 + 1200
            V_180 = V_180 + 2500
        End If

        Stufe2 = Stufe1

        Stufe11 = Stufe1 + 1
        If Stufe11 > Stufe3 Then
            Stufe11 = Stufe3
        End If
        Stufe12 = Stufe1 + 2
        If Stufe12 > Stufe3 Then
            Stufe12 = Stufe3
        End If
        Stufe13 = Stufe1 + 3
        If Stufe13 > Stufe3 Then
            Stufe13 = Stufe3
        End If
        Stufe14 = Stufe1 + 4
        If Stufe14 > Stufe3 Then
            Stufe14 = Stufe3
        End If

        Stufe21 = Stufe2 + 1
        If Stufe21 > Stufe3 Then
            Stufe21 = Stufe3
        End If
        Stufe22 = Stufe2 + 2
        If Stufe22 > Stufe3 Then
            Stufe22 = Stufe3
        End If
        Stufe23 = Stufe2 + 3
        If Stufe23 > Stufe3 Then
            Stufe23 = Stufe3
        End If
        Stufe24 = Stufe2 + 4
        If Stufe24 > Stufe3 Then
            Stufe24 = Stufe3
        End If
        If G_200 > 0 Then
            If G_200 < Stufe4 Then
                G_200 = Stufe4
            End If
        Else
            G_200 = Stufe4
        End If

        If Betriebsart = 1 And (_GlsL25 = 3 Or _GlsL25 = 4) Then
            SetProgramCounterLabel1(_Prog25)
        Else
            SetProgramCounterLabel(_Prog25)
        End If

        ' Lok starten - Bahnhofsausfahrt

        If _Prog25 = 0 Then
            Prog_Lok25.Interval = 2000
            If _Fahrzeugbeleuchtung2 > 0 Then
                _eb.lokSteuern(25, Klassen.LokEigenschaften.Hauptfunktion, 1) ' Licht ein
            End If
        ElseIf _Prog25 = 1 Then
        ElseIf _Prog25 = 2 Then
            _Betriebsparameter.RundenErhoehen(25)
        ElseIf _Prog25 = 3 Then
        ElseIf _Prog25 = 4 Then
        ElseIf _Prog25 = 5 Then
        ElseIf _Prog25 = 6 Then

            ' Bahnhofsausfahrt

        ElseIf _Prog25 = 7 Then
            _eb.lokSteuern(25, Klassen.LokEigenschaften.Geschwindigkeit, Stufe1)
        ElseIf _Prog25 = 8 Then
            _eb.lokSteuern(25, Klassen.LokEigenschaften.Geschwindigkeit, Stufe11)
        ElseIf _Prog25 = 9 Then
            _eb.lokSteuern(25, Klassen.LokEigenschaften.Geschwindigkeit, Stufe12)
        ElseIf _Prog25 = 10 Then
            _eb.lokSteuern(25, Klassen.LokEigenschaften.Geschwindigkeit, Stufe13)
        ElseIf _Prog25 = 11 Then
            _eb.lokSteuern(25, Klassen.LokEigenschaften.Geschwindigkeit, Stufe14)
        ElseIf _Prog25 = 12 Then
            _eb.lokSteuern(25, Klassen.LokEigenschaften.Geschwindigkeit, Stufe3)

            ' Lok abstellen

        ElseIf _Prog25 = 50 Then
            Prog_Lok25.Interval = 2000
        ElseIf _Prog25 = 51 Then
        ElseIf _Prog25 = 52 Then
            If _Fahrzeugbeleuchtung2 < 2 Then
                _eb.lokSteuern(25, Klassen.LokEigenschaften.Hauptfunktion, 0) ' Licht aus
            End If

            ' Lok bremsen (Bahnhofseinfahrt Normalzug von links und von rechts)

        ElseIf _Prog25 = 100 Then
            Prog_Lok25.Interval = V_100
        ElseIf _Prog25 = 101 Then
            _eb.lokSteuern(25, Klassen.LokEigenschaften.Geschwindigkeit, Stufe24)
            Prog_Lok25.Interval = T_100
        ElseIf _Prog25 = 102 Then
            _eb.lokSteuern(25, Klassen.LokEigenschaften.Geschwindigkeit, Stufe23)
        ElseIf _Prog25 = 103 Then
            _eb.lokSteuern(25, Klassen.LokEigenschaften.Geschwindigkeit, Stufe22)
        ElseIf _Prog25 = 104 Then
            _eb.lokSteuern(25, Klassen.LokEigenschaften.Geschwindigkeit, Stufe21)
        ElseIf _Prog25 = 105 Then
            _eb.lokSteuern(25, Klassen.LokEigenschaften.Geschwindigkeit, Stufe2)

            ' Lok bremsen (Bahnhofseinfahrt Kurzzug von links)

        ElseIf _Prog25 = 130 Then
            Prog_Lok25.Interval = V_130
        ElseIf _Prog25 = 131 Then
            _eb.lokSteuern(25, Klassen.LokEigenschaften.Geschwindigkeit, Stufe24)
            Prog_Lok25.Interval = T_130
        ElseIf _Prog25 = 132 Then
            _eb.lokSteuern(25, Klassen.LokEigenschaften.Geschwindigkeit, Stufe23)
        ElseIf _Prog25 = 133 Then
            _eb.lokSteuern(25, Klassen.LokEigenschaften.Geschwindigkeit, Stufe22)
        ElseIf _Prog25 = 134 Then
            _eb.lokSteuern(25, Klassen.LokEigenschaften.Geschwindigkeit, Stufe21)
        ElseIf _Prog25 = 135 Then
            _eb.lokSteuern(25, Klassen.LokEigenschaften.Geschwindigkeit, Stufe2)
        ElseIf _Prog25 = 136 Then
            _eb.lokSteuern(25, Klassen.LokEigenschaften.Geschwindigkeit, 0)
        ElseIf _Prog25 = 137 Then
            Prog_Lok25.Interval = 2000
        ElseIf _Prog25 = 138 Then
            If _Fahrzeugbeleuchtung2 < 2 Then
                _eb.lokSteuern(25, Klassen.LokEigenschaften.Hauptfunktion, 0) ' Licht aus
            End If

            ' Lok bremsen (Bahnhofseinfahrt Kurzzug von rechts)

        ElseIf _Prog25 = 160 Then
            Prog_Lok25.Interval = V_160
        ElseIf _Prog25 = 161 Then
            _eb.lokSteuern(25, Klassen.LokEigenschaften.Geschwindigkeit, Stufe24)
            Prog_Lok25.Interval = T_160
        ElseIf _Prog25 = 162 Then
            _eb.lokSteuern(25, Klassen.LokEigenschaften.Geschwindigkeit, Stufe23)
        ElseIf _Prog25 = 163 Then
            _eb.lokSteuern(25, Klassen.LokEigenschaften.Geschwindigkeit, Stufe22)
        ElseIf _Prog25 = 164 Then
            _eb.lokSteuern(25, Klassen.LokEigenschaften.Geschwindigkeit, Stufe21)
        ElseIf _Prog25 = 165 Then
            _eb.lokSteuern(25, Klassen.LokEigenschaften.Geschwindigkeit, Stufe2)
        ElseIf _Prog25 = 166 Then
            _eb.lokSteuern(25, Klassen.LokEigenschaften.Geschwindigkeit, 0)
        ElseIf _Prog25 = 167 Then
            Prog_Lok25.Interval = 2000
        ElseIf _Prog25 = 168 Then
            If _Fahrzeugbeleuchtung2 < 2 Then
                _eb.lokSteuern(25, Klassen.LokEigenschaften.Hauptfunktion, 0) ' Licht aus
            End If

            ' Rangierzug

        ElseIf _Prog25 = 180 Then
            _eb.lokSteuern(25, Klassen.LokEigenschaften.Geschwindigkeit, 2)
            Prog_Lok25.Interval = V_180
        ElseIf _Prog25 = 181 Then
            Prog_Lok25.Interval = T_180
            _eb.lokSteuern(25, Klassen.LokEigenschaften.Geschwindigkeit, 1)
        ElseIf _Prog25 = 182 Then
            _eb.lokSteuern(25, Klassen.LokEigenschaften.Geschwindigkeit, 0)

            ' Tunnelausfahrt

        ElseIf _Prog25 = 200 Then ' Kontakt 1.2 <- (bergauf)
            _eb.lokSteuern(25, Klassen.LokEigenschaften.Geschwindigkeit, G_200)
            Prog_Lok25.Interval = 2000
        ElseIf _Prog25 = 201 Then
        ElseIf _Prog25 = 202 Then
        ElseIf _Prog25 = 203 Then
        ElseIf _Prog25 = 204 Then
        ElseIf _Prog25 = 205 Then
            If Stufe4 < Stufe3 Then
                _eb.lokSteuern(25, Klassen.LokEigenschaften.Geschwindigkeit, Stufe3)
            Else
                _eb.lokSteuern(25, Klassen.LokEigenschaften.Geschwindigkeit, Stufe4)
            End If

        ElseIf _Prog25 = 220 Then ' Kontakt 3.1 -> (hinter dem Martinstor bergauf)
            Prog_Lok25.Interval = 2000
        ElseIf _Prog25 = 221 Then
        ElseIf _Prog25 = 222 Then

        ElseIf _Prog25 = 240 Then ' Kontakt 3.7 <- (hinter der Brücke bergauf)
            Prog_Lok25.Interval = 2000
        ElseIf _Prog25 = 241 Then
        ElseIf _Prog25 = 242 Then

        ElseIf _Prog25 = 260 Then ' Kontakt 3.3 (links bzw vor der Brücke)
            Prog_Lok25.Interval = 2000
        ElseIf _Prog25 = 261 Then
        ElseIf _Prog25 = 262 Then
            _eb.lokSteuern(25, Klassen.LokEigenschaften.Geschwindigkeit, Stufe3)

        ElseIf _Prog25 = 600 Then ' Kontakt 3.5 <- (unter der Burg)
            Prog_Lok25.Interval = 2000
        ElseIf _Prog25 = 601 Then
        ElseIf _Prog25 = 602 Then

        ElseIf _Prog25 = 620 Then ' Kontakt 3.7 -> (hinter der Brücke bergab)
            Prog_Lok25.Interval = 2000
        ElseIf _Prog25 = 621 Then
        ElseIf _Prog25 = 622 Then

        ElseIf _Prog25 = 640 Then ' Kontakt 3.1 <- Talfahrt
            Prog_Lok25.Interval = 2000
        ElseIf _Prog25 = 641 Then
        ElseIf _Prog25 = 642 Then

        ElseIf _Prog25 = 660 Then ' Kontakt 1.2 -> Talfahrt
            Prog_Lok25.Interval = 2000
        ElseIf _Prog25 = 661 Then
        ElseIf _Prog25 = 662 Then

        ElseIf _Prog25 = 700 Then ' Kontakt 0.4 <- Diagonale
            Prog_Lok25.Interval = 2000
        ElseIf _Prog25 = 701 Then
        ElseIf _Prog25 = 702 Then

            ' Zindelstein

        ElseIf _Prog25 = 500 Then
            Prog_Lok25.Interval = V_500
        ElseIf _Prog25 = 501 Then
            _eb.lokSteuern(25, Klassen.LokEigenschaften.Geschwindigkeit, Stufe23)
            Prog_Lok25.Interval = T_500
        ElseIf _Prog25 = 502 Then
            _eb.lokSteuern(25, Klassen.LokEigenschaften.Geschwindigkeit, Stufe22)
        ElseIf _Prog25 = 503 Then
            _eb.lokSteuern(25, Klassen.LokEigenschaften.Geschwindigkeit, Stufe21)
        ElseIf _Prog25 = 504 Then
            _eb.lokSteuern(25, Klassen.LokEigenschaften.Geschwindigkeit, Stufe2)
        ElseIf _Prog25 = 505 Then
            _eb.lokSteuern(25, Klassen.LokEigenschaften.Geschwindigkeit, 0)

        Else
            _Prog25 = 0
            Prog_Lok25.Stop()
            Prog_Lok25.Interval = 200
            If Betriebsart = 1 Then
                SetProgramCounterLabel1(String.Empty)
            Else
                SetProgramCounterLabel(String.Empty)
            End If
        End If
        _Prog25 = _Prog25 + 1
    End Sub
    Private Sub HandleTimerElapsed38(sender As System.Object, e As System.EventArgs) Handles Prog_Lok26.Elapsed

        '*** Fahrprogramm für E-Lok 120 119-3
        '*** Datum: 23.02.2020

        SetText(TextBox1, "E-Lok 120 119-3                                                         IBS: 02.05.2021 - V3 : 8")
        LoadImage(PictureBox1, "H:\\EB_Media\\LokFotos\\Baureihe_120_10.jpg")
        GeschwindikeitenSetzen(26)

        Dim Stufe1, Stufe2, Stufe3, Stufe4 As Integer
        Dim Stufe11, Stufe12, Stufe13, Stufe14, Stufe21, Stufe22, Stufe23, Stufe24 As Integer
        Dim V_100, V_130, V_160, V_180, V_500 As Integer
        Dim T_100, T_130, T_160, T_180, T_500 As Integer
        Dim G_200 As Integer

        T_100 = _Betriebsparameter.Fahrparameter(26, KlausEBspecific.Betriebsparameter.FahrparameterEnum.T_100)
        T_130 = _Betriebsparameter.Fahrparameter(26, KlausEBspecific.Betriebsparameter.FahrparameterEnum.T_130)
        T_160 = _Betriebsparameter.Fahrparameter(26, KlausEBspecific.Betriebsparameter.FahrparameterEnum.T_160)
        T_180 = _Betriebsparameter.Fahrparameter(26, KlausEBspecific.Betriebsparameter.FahrparameterEnum.T_180)
        T_500 = _Betriebsparameter.Fahrparameter(26, KlausEBspecific.Betriebsparameter.FahrparameterEnum.T_500)
        V_100 = _Betriebsparameter.Fahrparameter(26, KlausEBspecific.Betriebsparameter.FahrparameterEnum.V_100)
        V_130 = _Betriebsparameter.Fahrparameter(26, KlausEBspecific.Betriebsparameter.FahrparameterEnum.V_130)
        V_160 = _Betriebsparameter.Fahrparameter(26, KlausEBspecific.Betriebsparameter.FahrparameterEnum.V_160)
        V_180 = _Betriebsparameter.Fahrparameter(26, KlausEBspecific.Betriebsparameter.FahrparameterEnum.V_180)
        V_500 = _Betriebsparameter.Fahrparameter(26, KlausEBspecific.Betriebsparameter.FahrparameterEnum.V_500)
        G_200 = _Betriebsparameter.Fahrparameter(26, KlausEBspecific.Betriebsparameter.FahrparameterEnum.G_200)

        If A_StopB = 1 Then
            V_100 = 8000
        End If

        Stufe1 = _LokStufen.Holen(26, 1)
        Stufe2 = _LokStufen.Holen(26, 2)
        Stufe3 = _LokStufen.Holen(26, 3)
        Stufe4 = _LokStufen.Holen(26, 4)

        If Stufe2 = 1 Then
            T_100 = T_100
            T_130 = T_130
            T_160 = T_160
            V_180 = V_180
        ElseIf Stufe2 = 2 Then
            T_100 = T_100 + 300
            T_130 = T_130 + 300
            T_160 = T_160 + 300
            V_180 = V_180 + 500
        ElseIf Stufe2 = 3 Then
            T_100 = T_100 + 500
            T_130 = T_130 + 500
            T_160 = T_160 + 500
            V_180 = V_180 + 1000
        ElseIf Stufe2 = 4 Then
            T_100 = T_100 + 700
            T_130 = T_130 + 700
            T_160 = T_160 + 700
            V_180 = V_180 + 1500
        ElseIf Stufe2 = 5 Then
            T_100 = T_100 + 900
            T_130 = T_130 + 900
            T_160 = T_160 + 900
            V_180 = V_180 + 2000
        ElseIf Stufe2 = 6 Then
            T_100 = T_100 + 1200
            T_130 = T_130 + 1200
            T_160 = T_160 + 1200
            V_180 = V_180 + 2500
        Else
            T_100 = T_100 + 1200
            T_130 = T_130 + 1200
            T_160 = T_160 + 1200
            V_180 = V_180 + 2500
        End If

        Stufe2 = Stufe1

        Stufe11 = Stufe1 + 1
        If Stufe11 > Stufe3 Then
            Stufe11 = Stufe3
        End If
        Stufe12 = Stufe1 + 2
        If Stufe12 > Stufe3 Then
            Stufe12 = Stufe3
        End If
        Stufe13 = Stufe1 + 3
        If Stufe13 > Stufe3 Then
            Stufe13 = Stufe3
        End If
        Stufe14 = Stufe1 + 4
        If Stufe14 > Stufe3 Then
            Stufe14 = Stufe3
        End If

        Stufe21 = Stufe2 + 1
        If Stufe21 > Stufe3 Then
            Stufe21 = Stufe3
        End If
        Stufe22 = Stufe2 + 2
        If Stufe22 > Stufe3 Then
            Stufe22 = Stufe3
        End If
        Stufe23 = Stufe2 + 3
        If Stufe23 > Stufe3 Then
            Stufe23 = Stufe3
        End If
        Stufe24 = Stufe2 + 4
        If Stufe24 > Stufe3 Then
            Stufe24 = Stufe3
        End If
        If G_200 > 0 Then
            If G_200 < Stufe4 Then
                G_200 = Stufe4
            End If
        Else
            G_200 = Stufe4
        End If

        If Betriebsart = 1 And (_GlsL26 = 3 Or _GlsL26 = 4) Then
            SetProgramCounterLabel1(_Prog26)
        Else
            SetProgramCounterLabel(_Prog26)
        End If

        ' Lok starten - Bahnhofsausfahrt

        If _Prog26 = 0 Then
            If _Fahrzeugbeleuchtung2 > 0 Then
                _eb.lokSteuern(26, Klassen.LokEigenschaften.Hauptfunktion, 1) ' Licht ein
            End If
            Prog_Lok26.Interval = 2000
        ElseIf _Prog26 = 1 Then
        ElseIf _Prog26 = 2 Then
            _Betriebsparameter.RundenErhoehen(26)
        ElseIf _Prog26 = 3 Then
        ElseIf _Prog26 = 4 Then
        ElseIf _Prog26 = 5 Then
        ElseIf _Prog26 = 6 Then

            ' Bahnhofsausfahrt

        ElseIf _Prog26 = 7 Then
            _eb.lokSteuern(26, Klassen.LokEigenschaften.Geschwindigkeit, Stufe1)
        ElseIf _Prog26 = 8 Then
            _eb.lokSteuern(26, Klassen.LokEigenschaften.Geschwindigkeit, Stufe11)
        ElseIf _Prog26 = 9 Then
            _eb.lokSteuern(26, Klassen.LokEigenschaften.Geschwindigkeit, Stufe12)
        ElseIf _Prog26 = 10 Then
            _eb.lokSteuern(26, Klassen.LokEigenschaften.Geschwindigkeit, Stufe13)
        ElseIf _Prog26 = 11 Then
            _eb.lokSteuern(26, Klassen.LokEigenschaften.Geschwindigkeit, Stufe14)
        ElseIf _Prog26 = 12 Then
            _eb.lokSteuern(26, Klassen.LokEigenschaften.Geschwindigkeit, Stufe3)

            ' Lok abstellen

        ElseIf _Prog26 = 50 Then
            Prog_Lok26.Interval = 2000
        ElseIf _Prog26 = 51 Then
        ElseIf _Prog26 = 52 Then
            If _Fahrzeugbeleuchtung2 < 2 Then
                _eb.lokSteuern(26, Klassen.LokEigenschaften.Hauptfunktion, 0) ' Licht aus
            End If

            ' Lok bremsen (Bahnhofseinfahrt Normalzug von links und von rechts)

        ElseIf _Prog26 = 100 Then
            Prog_Lok26.Interval = V_100
        ElseIf _Prog26 = 101 Then
            _eb.lokSteuern(26, Klassen.LokEigenschaften.Geschwindigkeit, Stufe24)
            Prog_Lok26.Interval = T_100
        ElseIf _Prog26 = 102 Then
            _eb.lokSteuern(26, Klassen.LokEigenschaften.Geschwindigkeit, Stufe23)
        ElseIf _Prog26 = 103 Then
            _eb.lokSteuern(26, Klassen.LokEigenschaften.Geschwindigkeit, Stufe22)
        ElseIf _Prog26 = 104 Then
            _eb.lokSteuern(26, Klassen.LokEigenschaften.Geschwindigkeit, Stufe21)
        ElseIf _Prog26 = 105 Then
            _eb.lokSteuern(26, Klassen.LokEigenschaften.Geschwindigkeit, Stufe2)

            ' Lok bremsen (Bahnhofseinfahrt Kurzzug von links)

        ElseIf _Prog26 = 130 Then
            Prog_Lok26.Interval = V_130
        ElseIf _Prog26 = 131 Then
            _eb.lokSteuern(26, Klassen.LokEigenschaften.Geschwindigkeit, Stufe24)
            Prog_Lok26.Interval = T_130
        ElseIf _Prog26 = 132 Then
            _eb.lokSteuern(26, Klassen.LokEigenschaften.Geschwindigkeit, Stufe23)
        ElseIf _Prog26 = 133 Then
            _eb.lokSteuern(26, Klassen.LokEigenschaften.Geschwindigkeit, Stufe22)
        ElseIf _Prog26 = 134 Then
            _eb.lokSteuern(26, Klassen.LokEigenschaften.Geschwindigkeit, Stufe21)
        ElseIf _Prog26 = 135 Then
            _eb.lokSteuern(26, Klassen.LokEigenschaften.Geschwindigkeit, Stufe2)
        ElseIf _Prog26 = 136 Then
            _eb.lokSteuern(26, Klassen.LokEigenschaften.Geschwindigkeit, 0)
        ElseIf _Prog26 = 137 Then
            Prog_Lok26.Interval = 2000
        ElseIf _Prog26 = 138 Then
            If _Fahrzeugbeleuchtung2 < 2 Then
                _eb.lokSteuern(26, Klassen.LokEigenschaften.Hauptfunktion, 0) ' Licht aus
            End If

            ' Lok bremsen (Bahnhofseinfahrt Kurzzug von rechts)

        ElseIf _Prog26 = 160 Then
            Prog_Lok26.Interval = V_160
        ElseIf _Prog26 = 161 Then
            _eb.lokSteuern(26, Klassen.LokEigenschaften.Geschwindigkeit, Stufe24)
            Prog_Lok26.Interval = T_160
        ElseIf _Prog26 = 162 Then
            _eb.lokSteuern(26, Klassen.LokEigenschaften.Geschwindigkeit, Stufe23)
        ElseIf _Prog26 = 163 Then
            _eb.lokSteuern(26, Klassen.LokEigenschaften.Geschwindigkeit, Stufe22)
        ElseIf _Prog26 = 164 Then
            _eb.lokSteuern(26, Klassen.LokEigenschaften.Geschwindigkeit, Stufe21)
        ElseIf _Prog26 = 165 Then
            _eb.lokSteuern(26, Klassen.LokEigenschaften.Geschwindigkeit, Stufe2)
        ElseIf _Prog26 = 166 Then
            _eb.lokSteuern(26, Klassen.LokEigenschaften.Geschwindigkeit, 0)
        ElseIf _Prog26 = 167 Then
            Prog_Lok26.Interval = 2000
        ElseIf _Prog26 = 168 Then
            If _Fahrzeugbeleuchtung2 < 2 Then
                _eb.lokSteuern(26, Klassen.LokEigenschaften.Hauptfunktion, 0) ' Licht aus
            End If

            ' Rangierzug

        ElseIf _Prog26 = 180 Then
            _eb.lokSteuern(26, Klassen.LokEigenschaften.Geschwindigkeit, 2)
            Prog_Lok26.Interval = V_180
        ElseIf _Prog26 = 181 Then
            Prog_Lok26.Interval = T_180
            _eb.lokSteuern(26, Klassen.LokEigenschaften.Geschwindigkeit, 1)
        ElseIf _Prog26 = 182 Then
            _eb.lokSteuern(26, Klassen.LokEigenschaften.Geschwindigkeit, 0)

            ' Tunnelausfahrt

        ElseIf _Prog26 = 200 Then ' Kontakt 1.2 <- (bergauf)
            _eb.lokSteuern(26, Klassen.LokEigenschaften.Geschwindigkeit, G_200)
            Prog_Lok26.Interval = 2000
        ElseIf _Prog26 = 201 Then
        ElseIf _Prog26 = 202 Then
        ElseIf _Prog26 = 203 Then
        ElseIf _Prog26 = 204 Then
        ElseIf _Prog26 = 205 Then
            If Stufe4 < Stufe3 Then
                _eb.lokSteuern(26, Klassen.LokEigenschaften.Geschwindigkeit, Stufe3)
            Else
                _eb.lokSteuern(26, Klassen.LokEigenschaften.Geschwindigkeit, Stufe4)
            End If

        ElseIf _Prog26 = 220 Then ' Kontakt 3.1 -> (hinter dem Martinstor bergauf)
            Prog_Lok26.Interval = 2000
        ElseIf _Prog26 = 221 Then
        ElseIf _Prog26 = 222 Then

        ElseIf _Prog26 = 240 Then ' Kontakt 3.7 <- (hinter der Brücke bergauf)
            Prog_Lok26.Interval = 2000
        ElseIf _Prog26 = 241 Then
        ElseIf _Prog26 = 242 Then

        ElseIf _Prog26 = 260 Then ' Kontakt 3.3 (links bzw vor der Brücke)
            Prog_Lok26.Interval = 2000
        ElseIf _Prog26 = 261 Then
        ElseIf _Prog26 = 262 Then
            _eb.lokSteuern(26, Klassen.LokEigenschaften.Geschwindigkeit, Stufe3)

        ElseIf _Prog26 = 600 Then ' Kontakt 3.5 <- (unter der Burg)
            Prog_Lok26.Interval = 2000
        ElseIf _Prog26 = 601 Then
        ElseIf _Prog26 = 602 Then

        ElseIf _Prog26 = 620 Then ' Kontakt 3.7 -> (hinter der Brücke bergab)
            Prog_Lok26.Interval = 2000
        ElseIf _Prog26 = 621 Then
        ElseIf _Prog26 = 622 Then

        ElseIf _Prog26 = 640 Then ' Kontakt 3.1 <- Talfahrt
            Prog_Lok26.Interval = 2000
        ElseIf _Prog26 = 641 Then
        ElseIf _Prog26 = 642 Then

        ElseIf _Prog26 = 660 Then ' Kontakt 1.2 -> Talfahrt
            Prog_Lok26.Interval = 2000
        ElseIf _Prog26 = 661 Then
        ElseIf _Prog26 = 662 Then

        ElseIf _Prog26 = 700 Then ' Kontakt 0.4 <- Diagonale
            Prog_Lok26.Interval = 2000
        ElseIf _Prog26 = 701 Then
        ElseIf _Prog26 = 702 Then

            ' Zindelstein

        ElseIf _Prog26 = 500 Then
            Prog_Lok26.Interval = V_500
        ElseIf _Prog26 = 501 Then
            _eb.lokSteuern(26, Klassen.LokEigenschaften.Geschwindigkeit, Stufe23)
            Prog_Lok26.Interval = T_500
        ElseIf _Prog26 = 502 Then
            _eb.lokSteuern(26, Klassen.LokEigenschaften.Geschwindigkeit, Stufe22)
        ElseIf _Prog26 = 503 Then
            _eb.lokSteuern(26, Klassen.LokEigenschaften.Geschwindigkeit, Stufe21)
        ElseIf _Prog26 = 504 Then
            _eb.lokSteuern(26, Klassen.LokEigenschaften.Geschwindigkeit, Stufe2)
        ElseIf _Prog26 = 505 Then
            _eb.lokSteuern(26, Klassen.LokEigenschaften.Geschwindigkeit, 0)

        Else
            _Prog26 = 0
            Prog_Lok26.Stop()
            Prog_Lok26.Interval = 200
            If Betriebsart = 1 Then
                SetProgramCounterLabel1(String.Empty)
            Else
                SetProgramCounterLabel(String.Empty)
            End If
        End If
        _Prog26 = _Prog26 + 1
    End Sub
    Private Sub HandleTimerElapsed39(sender As System.Object, e As System.EventArgs) Handles Prog_Lok27.Elapsed

        '*** Fahrprogramm für "Krokodil braun"
        '*** Datum: 10.10.2023

        SetText(TextBox1, "E-Lok CE 6/8  14253                                                     IBS: 10.12.2025 V3: 7")
        LoadImage(PictureBox1, "H:\\EB_Media\\LokFotos\\Baureihe_CE68b_01.jpg")
        GeschwindikeitenSetzen(27)

        Dim Stufe1, Stufe2, Stufe3, Stufe4 As Integer
        Dim Stufe11, Stufe12, Stufe13, Stufe14, Stufe21, Stufe22, Stufe23, Stufe24 As Integer
        Dim V_100, V_130, V_160, V_180, V_500 As Integer
        Dim T_100, T_130, T_160, T_180, T_500 As Integer
        Dim G_200 As Integer

        T_100 = _Betriebsparameter.Fahrparameter(27, KlausEBspecific.Betriebsparameter.FahrparameterEnum.T_100)
        T_130 = _Betriebsparameter.Fahrparameter(27, KlausEBspecific.Betriebsparameter.FahrparameterEnum.T_130)
        T_160 = _Betriebsparameter.Fahrparameter(27, KlausEBspecific.Betriebsparameter.FahrparameterEnum.T_160)
        T_180 = _Betriebsparameter.Fahrparameter(27, KlausEBspecific.Betriebsparameter.FahrparameterEnum.T_180)
        T_500 = _Betriebsparameter.Fahrparameter(27, KlausEBspecific.Betriebsparameter.FahrparameterEnum.T_500)
        V_100 = _Betriebsparameter.Fahrparameter(27, KlausEBspecific.Betriebsparameter.FahrparameterEnum.V_100)
        V_130 = _Betriebsparameter.Fahrparameter(27, KlausEBspecific.Betriebsparameter.FahrparameterEnum.V_130)
        V_160 = _Betriebsparameter.Fahrparameter(27, KlausEBspecific.Betriebsparameter.FahrparameterEnum.V_160)
        V_180 = _Betriebsparameter.Fahrparameter(27, KlausEBspecific.Betriebsparameter.FahrparameterEnum.V_180)
        V_500 = _Betriebsparameter.Fahrparameter(27, KlausEBspecific.Betriebsparameter.FahrparameterEnum.V_500)
        G_200 = _Betriebsparameter.Fahrparameter(27, KlausEBspecific.Betriebsparameter.FahrparameterEnum.G_200)

        If A_StopB = 1 Then
            V_100 = 8000
        End If

        Stufe1 = _LokStufen.Holen(27, 1)
        Stufe2 = _LokStufen.Holen(27, 2)
        Stufe3 = _LokStufen.Holen(27, 3)
        Stufe4 = _LokStufen.Holen(27, 4)

        If Stufe2 = 1 Then
            T_100 = T_100
            T_130 = T_130
            T_160 = T_160
            V_180 = V_180
        ElseIf Stufe2 = 2 Then
            T_100 = T_100 + 300
            T_130 = T_130 + 300
            T_160 = T_160 + 300
            V_180 = V_180 + 500
        ElseIf Stufe2 = 3 Then
            T_100 = T_100 + 500
            T_130 = T_130 + 500
            T_160 = T_160 + 500
            V_180 = V_180 + 1000
        ElseIf Stufe2 = 4 Then
            T_100 = T_100 + 700
            T_130 = T_130 + 700
            T_160 = T_160 + 700
            V_180 = V_180 + 1500
        ElseIf Stufe2 = 5 Then
            T_100 = T_100 + 900
            T_130 = T_130 + 900
            T_160 = T_160 + 900
            V_180 = V_180 + 2000
        ElseIf Stufe2 = 6 Then
            T_100 = T_100 + 1200
            T_130 = T_130 + 1200
            T_160 = T_160 + 1200
            V_180 = V_180 + 2500
        Else
            T_100 = T_100 + 1200
            T_130 = T_130 + 1200
            T_160 = T_160 + 1200
            V_180 = V_180 + 2500
        End If

        Stufe2 = Stufe1

        Stufe11 = Stufe1 + 1
        If Stufe11 > Stufe3 Then
            Stufe11 = Stufe3
        End If
        Stufe12 = Stufe1 + 2
        If Stufe12 > Stufe3 Then
            Stufe12 = Stufe3
        End If
        Stufe13 = Stufe1 + 3
        If Stufe13 > Stufe3 Then
            Stufe13 = Stufe3
        End If
        Stufe14 = Stufe1 + 4
        If Stufe14 > Stufe3 Then
            Stufe14 = Stufe3
        End If

        Stufe21 = Stufe2 + 1
        If Stufe21 > Stufe3 Then
            Stufe21 = Stufe3
        End If
        Stufe22 = Stufe2 + 2
        If Stufe22 > Stufe3 Then
            Stufe22 = Stufe3
        End If
        Stufe23 = Stufe2 + 3
        If Stufe23 > Stufe3 Then
            Stufe23 = Stufe3
        End If
        Stufe24 = Stufe2 + 4
        If Stufe24 > Stufe3 Then
            Stufe24 = Stufe3
        End If
        If G_200 > 0 Then
            If G_200 < Stufe4 Then
                G_200 = Stufe4
            End If
        Else
            G_200 = Stufe4
        End If

        If Betriebsart = 1 And (_GlsL27 = 3 Or _GlsL27 = 4) Then
            SetProgramCounterLabel1(_Prog27)
        Else
            SetProgramCounterLabel(_Prog27)
        End If

        ' Lok starten - Bahnhofsausfahrt

        If _Prog27 = 0 Then
            Prog_Lok27.Interval = 2000
        ElseIf _Prog27 = 1 Then
            If _Fahrzeugbeleuchtung2 > 0 Then
                _eb.lokSteuern(27, Klassen.LokEigenschaften.Hauptfunktion, 1) ' Licht ein
            End If
        ElseIf _Prog27 = 2 Then
        ElseIf _Prog27 = 3 Then
            _Betriebsparameter.RundenErhoehen(27)
        ElseIf _Prog27 = 4 Then
        ElseIf _Prog27 = 5 Then
        ElseIf _Prog27 = 6 Then
        ElseIf _Prog27 = 7 Then
        ElseIf _Prog27 = 8 Then
        ElseIf _Prog27 = 9 Then
        ElseIf _Prog27 = 10 Then
        ElseIf _Prog27 = 11 Then

            ' Bahnhofsausfahrt

        ElseIf _Prog27 = 12 Then
            If _AkustischeSignale > 0 Then
                _eb.lokSteuern(27, Klassen.LokEigenschaften.Funktion3, 1) ' Signal ein
            End If
        ElseIf _Prog27 = 13 Then
            _eb.lokSteuern(27, Klassen.LokEigenschaften.Funktion3, 0) ' Signal aus
        ElseIf _Prog27 = 14 Then
            _eb.lokSteuern(27, Klassen.LokEigenschaften.Geschwindigkeit, Stufe1)
        ElseIf _Prog27 = 15 Then
            _eb.lokSteuern(27, Klassen.LokEigenschaften.Geschwindigkeit, Stufe11)
        ElseIf _Prog27 = 16 Then
            _eb.lokSteuern(27, Klassen.LokEigenschaften.Geschwindigkeit, Stufe12)
        ElseIf _Prog27 = 17 Then
            _eb.lokSteuern(27, Klassen.LokEigenschaften.Geschwindigkeit, Stufe13)
        ElseIf _Prog27 = 18 Then
            _eb.lokSteuern(27, Klassen.LokEigenschaften.Geschwindigkeit, Stufe14)
        ElseIf _Prog27 = 19 Then
            _eb.lokSteuern(27, Klassen.LokEigenschaften.Geschwindigkeit, Stufe3)
        ElseIf _Prog27 = 20 Then
        ElseIf _Prog27 = 21 Then
        ElseIf _Prog27 = 22 Then
        ElseIf _Prog27 = 23 Then
            If _Motor < 3 Then
                _eb.lokSteuern(27, Klassen.LokEigenschaften.Funktion2, 0) ' Motor aus
            End If
        ElseIf _Prog27 = 24 Then

            ' Lok abstellen

        ElseIf _Prog27 = 50 Then
            Prog_Lok27.Interval = 2000
            If _Motor < 3 Then
                _eb.lokSteuern(27, Klassen.LokEigenschaften.Funktion2, 0) ' Motor aus
            End If
        ElseIf _Prog27 = 51 Then
        ElseIf _Prog27 = 52 Then
            If _Fahrzeugbeleuchtung2 < 2 Then
                _eb.lokSteuern(27, Klassen.LokEigenschaften.Hauptfunktion, 0) ' Licht aus
            End If

            ' Lok bremsen (Bahnhofseinfahrt Normalzug von links und von rechts)

        ElseIf _Prog27 = 100 Then
            Prog_Lok27.Interval = V_100
        ElseIf _Prog27 = 101 Then
            _eb.lokSteuern(27, Klassen.LokEigenschaften.Geschwindigkeit, Stufe24)
            Prog_Lok27.Interval = T_100
        ElseIf _Prog27 = 102 Then
            _eb.lokSteuern(27, Klassen.LokEigenschaften.Geschwindigkeit, Stufe23)
        ElseIf _Prog27 = 103 Then
            _eb.lokSteuern(27, Klassen.LokEigenschaften.Geschwindigkeit, Stufe22)
        ElseIf _Prog27 = 104 Then
            _eb.lokSteuern(27, Klassen.LokEigenschaften.Geschwindigkeit, Stufe21)
        ElseIf _Prog27 = 105 Then
            _eb.lokSteuern(27, Klassen.LokEigenschaften.Geschwindigkeit, Stufe2)

            ' Lok bremsen (Bahnhofseinfahrt Kurzzug von links)

        ElseIf _Prog27 = 130 Then
            Prog_Lok27.Interval = V_130
        ElseIf _Prog27 = 131 Then
            _eb.lokSteuern(27, Klassen.LokEigenschaften.Geschwindigkeit, Stufe24)
            Prog_Lok27.Interval = T_130
        ElseIf _Prog27 = 132 Then
            _eb.lokSteuern(27, Klassen.LokEigenschaften.Geschwindigkeit, Stufe23)
        ElseIf _Prog27 = 133 Then
            _eb.lokSteuern(27, Klassen.LokEigenschaften.Geschwindigkeit, Stufe22)
        ElseIf _Prog27 = 134 Then
            _eb.lokSteuern(27, Klassen.LokEigenschaften.Geschwindigkeit, Stufe21)
        ElseIf _Prog27 = 135 Then
            _eb.lokSteuern(27, Klassen.LokEigenschaften.Geschwindigkeit, Stufe2)
        ElseIf _Prog27 = 136 Then
            _eb.lokSteuern(27, Klassen.LokEigenschaften.Geschwindigkeit, 0)
        ElseIf _Prog27 = 137 Then
            Prog_Lok27.Interval = 2000
        ElseIf _Prog27 = 138 Then
            If _Motor < 3 Then
                _eb.lokSteuern(27, Klassen.LokEigenschaften.Funktion2, 0) ' Motor aus
            End If
        ElseIf _Prog27 = 139 Then
        ElseIf _Prog27 = 140 Then
            If _Fahrzeugbeleuchtung2 < 2 Then
                _eb.lokSteuern(27, Klassen.LokEigenschaften.Hauptfunktion, 0) ' Licht aus
            End If

            ' Lok bremsen (Bahnhofseinfahrt Kurzzug von rechts)

        ElseIf _Prog27 = 160 Then
            Prog_Lok27.Interval = V_160
        ElseIf _Prog27 = 161 Then
            _eb.lokSteuern(27, Klassen.LokEigenschaften.Geschwindigkeit, Stufe24)
            Prog_Lok27.Interval = T_160
        ElseIf _Prog27 = 162 Then
            _eb.lokSteuern(27, Klassen.LokEigenschaften.Geschwindigkeit, Stufe23)
        ElseIf _Prog27 = 163 Then
            _eb.lokSteuern(27, Klassen.LokEigenschaften.Geschwindigkeit, Stufe22)
        ElseIf _Prog27 = 164 Then
            _eb.lokSteuern(27, Klassen.LokEigenschaften.Geschwindigkeit, Stufe21)
        ElseIf _Prog27 = 165 Then
            _eb.lokSteuern(27, Klassen.LokEigenschaften.Geschwindigkeit, Stufe2)
        ElseIf _Prog27 = 166 Then
            _eb.lokSteuern(27, Klassen.LokEigenschaften.Geschwindigkeit, 0)
        ElseIf _Prog27 = 167 Then
            Prog_Lok27.Interval = 2000
        ElseIf _Prog27 = 168 Then
            If _Motor < 3 Then
                _eb.lokSteuern(27, Klassen.LokEigenschaften.Funktion2, 0) ' Motor aus
            End If
        ElseIf _Prog27 = 169 Then
        ElseIf _Prog27 = 170 Then
            If _Fahrzeugbeleuchtung2 < 2 Then
                _eb.lokSteuern(27, Klassen.LokEigenschaften.Hauptfunktion, 0) ' Licht aus
            End If

            ' Rangierzug

        ElseIf _Prog27 = 180 Then
            _eb.lokSteuern(27, Klassen.LokEigenschaften.Geschwindigkeit, 2)
            Prog_Lok27.Interval = V_180
        ElseIf _Prog27 = 181 Then
            Prog_Lok27.Interval = T_180
            _eb.lokSteuern(27, Klassen.LokEigenschaften.Geschwindigkeit, 1)
        ElseIf _Prog27 = 182 Then
            _eb.lokSteuern(27, Klassen.LokEigenschaften.Geschwindigkeit, 0)

            ' Tunnelausfahrt

        ElseIf _Prog27 = 200 Then ' Kontakt 1.2 <- (bergauf)
            _eb.lokSteuern(27, Klassen.LokEigenschaften.Geschwindigkeit, G_200)
            Prog_Lok27.Interval = 2000
        ElseIf _Prog27 = 201 Then
        ElseIf _Prog27 = 202 Then
        ElseIf _Prog27 = 203 Then
        ElseIf _Prog27 = 204 Then
        ElseIf _Prog27 = 205 Then
            If Stufe4 < Stufe3 Then
                _eb.lokSteuern(27, Klassen.LokEigenschaften.Geschwindigkeit, Stufe3)
            Else
                _eb.lokSteuern(27, Klassen.LokEigenschaften.Geschwindigkeit, Stufe4)
            End If
        ElseIf _Prog27 = 206 Then
            If _Motor > 1 Then
                _eb.lokSteuern(27, Klassen.LokEigenschaften.Funktion2, 1) ' Motor ein
            End If
        ElseIf _Prog27 = 207 Then
        ElseIf _Prog27 = 208 Then
        ElseIf _Prog27 = 209 Then
            If _AkustischeSignale > 1 Then
                _eb.lokSteuern(27, Klassen.LokEigenschaften.Funktion3, 1) ' Pfiff ein
            End If
        ElseIf _Prog27 = 210 Then
            _eb.lokSteuern(27, Klassen.LokEigenschaften.Funktion3, 0) ' Pfiff aus

        ElseIf _Prog27 = 220 Then ' Kontakt 3.1 -> (hinter dem Martinstor bergauf)
            Prog_Lok27.Interval = 2000
        ElseIf _Prog27 = 221 Then
        ElseIf _Prog27 = 222 Then
        ElseIf _Prog27 = 223 Then
        ElseIf _Prog27 = 224 Then
        ElseIf _Prog27 = 225 Then
        ElseIf _Prog27 = 226 Then
        ElseIf _Prog27 = 227 Then
        ElseIf _Prog27 = 228 Then
        ElseIf _Prog27 = 229 Then
        ElseIf _Prog27 = 230 Then
            If _Motor < 3 Then
                _eb.lokSteuern(27, Klassen.LokEigenschaften.Funktion2, 0) ' Motor aus
            End If

        ElseIf _Prog27 = 240 Then ' Kontakt 3.7 <- (hinter der Brücke bergauf)
            Prog_Lok27.Interval = 2000
        ElseIf _Prog27 = 241 Then
        ElseIf _Prog27 = 242 Then
        ElseIf _Prog27 = 243 Then
            'If _Motor > 1 Then
            '    _eb.lokSteuern(27, Klassen.LokEigenschaften.Funktion2, 1) ' Motor ein
            'End If
        ElseIf _Prog27 = 244 Then
            If _AkustischeSignale > 1 Then
                _eb.lokSteuern(27, Klassen.LokEigenschaften.Funktion3, 1) ' Pfiff ein
            End If
        ElseIf _Prog27 = 245 Then
            _eb.lokSteuern(27, Klassen.LokEigenschaften.Funktion3, 0) ' Pfiff aus
        ElseIf _Prog27 = 246 Then

        ElseIf _Prog27 = 260 Then ' Kontakt 3.3 (links bzw vor der Brücke)
            Prog_Lok27.Interval = 2000
        ElseIf _Prog27 = 261 Then
        ElseIf _Prog27 = 262 Then
            _eb.lokSteuern(20, Klassen.LokEigenschaften.Geschwindigkeit, Stufe3)

        ElseIf _Prog27 = 600 Then ' Kontakt 3.5 <- (unter der Burg)
            Prog_Lok27.Interval = 2000
        ElseIf _Prog27 = 601 Then
            If _AkustischeSignale > 1 Then
                _eb.lokSteuern(27, Klassen.LokEigenschaften.Funktion3, 1) ' Pfiff ein
            End If
        ElseIf _Prog27 = 602 Then
            _eb.lokSteuern(27, Klassen.LokEigenschaften.Funktion3, 0) ' Pfiff aus
        ElseIf _Prog27 = 603 Then

        ElseIf _Prog27 = 620 Then ' Kontakt 3.7 -> (hinter der Brücke bergab)
            Prog_Lok27.Interval = 2000
        ElseIf _Prog27 = 621 Then
        ElseIf _Prog27 = 622 Then
            If _Motor > 1 Then
                _eb.lokSteuern(27, Klassen.LokEigenschaften.Funktion2, 1) ' Motor ein
            End If
        ElseIf _Prog27 = 623 Then
        ElseIf _Prog27 = 624 Then
            If _AkustischeSignale > 1 Then
                _eb.lokSteuern(27, Klassen.LokEigenschaften.Funktion3, 1) ' Pfiff ein
            End If
        ElseIf _Prog27 = 625 Then
            _eb.lokSteuern(27, Klassen.LokEigenschaften.Funktion3, 0) ' Pfiff aus

        ElseIf _Prog27 = 640 Then ' Kontakt 3.1 <- Talfahrt
            Prog_Lok27.Interval = 2000
        ElseIf _Prog27 = 641 Then
        ElseIf _Prog27 = 642 Then
        ElseIf _Prog27 = 643 Then
        ElseIf _Prog27 = 644 Then
        ElseIf _Prog27 = 645 Then
        ElseIf _Prog27 = 646 Then
            If _Motor < 3 Then
                _eb.lokSteuern(27, Klassen.LokEigenschaften.Funktion2, 0) ' Motor aus
            End If

        ElseIf _Prog27 = 660 Then ' Kontakt 1.2 -> Talfahrt
            Prog_Lok27.Interval = 2000
        ElseIf _Prog27 = 661 Then
        ElseIf _Prog27 = 662 Then
        ElseIf _Prog27 = 663 Then
            If _GlsL27 = 1 Or _GlsL27 = 2 Then
                If _Motor > 0 Then
                    _eb.lokSteuern(27, Klassen.LokEigenschaften.Funktion2, 1) ' Motor ein
                End If
            End If
        ElseIf _Prog27 = 664 Then
            If _GlsL27 = 1 Or _GlsL27 = 2 Then
                If _AkustischeSignale > 0 Then
                    _eb.lokSteuern(27, Klassen.LokEigenschaften.Funktion3, 1) ' Pfiff ein
                End If
            End If
            _eb.lokSteuern(27, Klassen.LokEigenschaften.Funktion3, 0) ' Pfiff aus

        ElseIf _Prog27 = 700 Then ' Kontakt 0.4 <- Diagonale
            Prog_Lok27.Interval = 2000
        ElseIf _Prog27 = 701 Then
        ElseIf _Prog27 = 702 Then
        ElseIf _Prog27 = 703 Then
        ElseIf _Prog27 = 704 Then
        ElseIf _Prog27 = 705 Then
            If _Motor > 0 Then
                _eb.lokSteuern(27, Klassen.LokEigenschaften.Funktion2, 1) ' Motor ein
            End If
        ElseIf _Prog27 = 706 Then
        ElseIf _Prog27 = 707 Then
            If _AkustischeSignale > 0 Then
                _eb.lokSteuern(27, Klassen.LokEigenschaften.Funktion3, 1) ' Pfiff ein
            End If
        ElseIf _Prog27 = 708 Then
            _eb.lokSteuern(27, Klassen.LokEigenschaften.Funktion3, 0) ' Pfiff aus

            ' Zindelstein

        ElseIf _Prog27 = 500 Then
            Prog_Lok27.Interval = V_500
        ElseIf _Prog27 = 501 Then
            _eb.lokSteuern(27, Klassen.LokEigenschaften.Geschwindigkeit, Stufe23)
            Prog_Lok27.Interval = T_500
        ElseIf _Prog27 = 502 Then
            _eb.lokSteuern(27, Klassen.LokEigenschaften.Geschwindigkeit, Stufe22)
        ElseIf _Prog27 = 503 Then
            _eb.lokSteuern(27, Klassen.LokEigenschaften.Geschwindigkeit, Stufe21)
        ElseIf _Prog27 = 504 Then
            _eb.lokSteuern(27, Klassen.LokEigenschaften.Geschwindigkeit, Stufe2)
        ElseIf _Prog27 = 505 Then
            _eb.lokSteuern(27, Klassen.LokEigenschaften.Geschwindigkeit, 0)

        Else
            _Prog27 = 0
            Prog_Lok27.Stop()
            Prog_Lok27.Interval = 200
            If Betriebsart = 1 Then
                SetProgramCounterLabel1(String.Empty)
            Else
                SetProgramCounterLabel(String.Empty)
            End If
        End If
        _Prog27 = _Prog27 + 1
    End Sub
    Private Sub HandleTimerElapsed40(sender As System.Object, e As System.EventArgs) Handles Prog_Lok28.Elapsed

        '*** Fahrprogramm für E-Lok 111 095-6
        '*** Datum: 05.10.2025

        SetText(TextBox1, "E-Lok 111 095-6                                                         IBS: 11.10.2025 - V3 : 7")
        LoadImage(PictureBox1, "H:\\EB_Media\\LokFotos\\Baureihe_111_10.jpg")
        GeschwindikeitenSetzen(28)

        Dim Stufe1, Stufe2, Stufe3, Stufe4 As Integer
        Dim Stufe11, Stufe12, Stufe13, Stufe14, Stufe21, Stufe22, Stufe23, Stufe24 As Integer
        Dim V_100, V_130, V_160, V_180, V_500 As Integer
        Dim T_100, T_130, T_160, T_180, T_500 As Integer
        Dim G_200 As Integer

        T_100 = _Betriebsparameter.Fahrparameter(28, KlausEBspecific.Betriebsparameter.FahrparameterEnum.T_100)
        T_130 = _Betriebsparameter.Fahrparameter(28, KlausEBspecific.Betriebsparameter.FahrparameterEnum.T_130)
        T_160 = _Betriebsparameter.Fahrparameter(28, KlausEBspecific.Betriebsparameter.FahrparameterEnum.T_160)
        T_180 = _Betriebsparameter.Fahrparameter(28, KlausEBspecific.Betriebsparameter.FahrparameterEnum.T_180)
        T_500 = _Betriebsparameter.Fahrparameter(28, KlausEBspecific.Betriebsparameter.FahrparameterEnum.T_500)
        V_100 = _Betriebsparameter.Fahrparameter(28, KlausEBspecific.Betriebsparameter.FahrparameterEnum.V_100)
        V_130 = _Betriebsparameter.Fahrparameter(28, KlausEBspecific.Betriebsparameter.FahrparameterEnum.V_130)
        V_160 = _Betriebsparameter.Fahrparameter(28, KlausEBspecific.Betriebsparameter.FahrparameterEnum.V_160)
        V_180 = _Betriebsparameter.Fahrparameter(28, KlausEBspecific.Betriebsparameter.FahrparameterEnum.V_180)
        V_500 = _Betriebsparameter.Fahrparameter(28, KlausEBspecific.Betriebsparameter.FahrparameterEnum.V_500)
        G_200 = _Betriebsparameter.Fahrparameter(28, KlausEBspecific.Betriebsparameter.FahrparameterEnum.G_200)

        If A_StopB = 1 Then
            V_100 = 8000
        End If

        Stufe1 = _LokStufen.Holen(28, 1)
        Stufe2 = _LokStufen.Holen(28, 2)
        Stufe3 = _LokStufen.Holen(28, 3)
        Stufe4 = _LokStufen.Holen(28, 4)

        If Stufe2 = 1 Then
            T_100 = T_100
            T_130 = T_130
            T_160 = T_160
            V_180 = V_180
        ElseIf Stufe2 = 2 Then
            T_100 = T_100 + 300
            T_130 = T_130 + 300
            T_160 = T_160 + 300
            V_180 = V_180 + 500
        ElseIf Stufe2 = 3 Then
            T_100 = T_100 + 500
            T_130 = T_130 + 500
            T_160 = T_160 + 500
            V_180 = V_180 + 1000
        ElseIf Stufe2 = 4 Then
            T_100 = T_100 + 700
            T_130 = T_130 + 700
            T_160 = T_160 + 700
            V_180 = V_180 + 1500
        ElseIf Stufe2 = 5 Then
            T_100 = T_100 + 900
            T_130 = T_130 + 900
            T_160 = T_160 + 900
            V_180 = V_180 + 2000
        ElseIf Stufe2 = 6 Then
            T_100 = T_100 + 1200
            T_130 = T_130 + 1200
            T_160 = T_160 + 1200
            V_180 = V_180 + 2500
        Else
            T_100 = T_100 + 1200
            T_130 = T_130 + 1200
            T_160 = T_160 + 1200
            V_180 = V_180 + 2500
        End If

        Stufe2 = Stufe1

        Stufe11 = Stufe1 + 1
        If Stufe11 > Stufe3 Then
            Stufe11 = Stufe3
        End If
        Stufe12 = Stufe1 + 2
        If Stufe12 > Stufe3 Then
            Stufe12 = Stufe3
        End If
        Stufe13 = Stufe1 + 3
        If Stufe13 > Stufe3 Then
            Stufe13 = Stufe3
        End If
        Stufe14 = Stufe1 + 4
        If Stufe14 > Stufe3 Then
            Stufe14 = Stufe3
        End If

        Stufe21 = Stufe2 + 1
        If Stufe21 > Stufe3 Then
            Stufe21 = Stufe3
        End If
        Stufe22 = Stufe2 + 2
        If Stufe22 > Stufe3 Then
            Stufe22 = Stufe3
        End If
        Stufe23 = Stufe2 + 3
        If Stufe23 > Stufe3 Then
            Stufe23 = Stufe3
        End If
        Stufe24 = Stufe2 + 4
        If Stufe24 > Stufe3 Then
            Stufe24 = Stufe3
        End If
        If G_200 > 0 Then
            If G_200 < Stufe4 Then
                G_200 = Stufe4
            End If
        Else
            G_200 = Stufe4
        End If

        If Betriebsart = 1 And (_GlsL28 = 3 Or _GlsL28 = 4) Then
            SetProgramCounterLabel1(_Prog28)
        Else
            SetProgramCounterLabel(_Prog28)
        End If

        ' Lok starten - Bahnhofsausfahrt

        If _Prog28 = 0 Then
            Prog_Lok28.Interval = 2000
            _eb.lokSteuern(28, Klassen.LokEigenschaften.Geschwindigkeit, 0)
        ElseIf _Prog28 = 1 Then
            If _Fahrzeugbeleuchtung2 > 0 Then
                _eb.lokSteuern(28, Klassen.LokEigenschaften.Hauptfunktion, 1) ' Licht ein
            Else
                _eb.lokSteuern(28, Klassen.LokEigenschaften.Hauptfunktion, 0) ' Licht aus
            End If
        ElseIf _Prog28 = 2 Then
            _Betriebsparameter.RundenErhoehen(28)
        ElseIf _Prog28 = 3 Then
        ElseIf _Prog28 = 4 Then
        ElseIf _Prog28 = 5 Then
        ElseIf _Prog28 = 6 Then
        ElseIf _Prog28 = 7 Then
        ElseIf _Prog28 = 8 Then

            ' Bahnhofsausfahrt

        ElseIf _Prog28 = 9 Then
            If _AkustischeSignale > 0 Then
                If _Prog28H = 0 Then
                    _eb.lokSteuern(28, Klassen.LokEigenschaften.Funktion3, 1) ' Signal ein
                    _Prog28H = 1
                Else
                    _eb.lokSteuern(28, Klassen.LokEigenschaften.Funktion3, 0) ' Signal aus
                    _Prog28H = 0
                End If
            End If
        ElseIf _Prog28 = 10 Then
        ElseIf _Prog28 = 11 Then
            _eb.lokSteuern(28, Klassen.LokEigenschaften.Geschwindigkeit, Stufe1)
        ElseIf _Prog28 = 12 Then
            _eb.lokSteuern(28, Klassen.LokEigenschaften.Geschwindigkeit, Stufe11)
        ElseIf _Prog28 = 13 Then
            _eb.lokSteuern(28, Klassen.LokEigenschaften.Geschwindigkeit, Stufe12)
        ElseIf _Prog28 = 14 Then
            _eb.lokSteuern(28, Klassen.LokEigenschaften.Geschwindigkeit, Stufe13)
        ElseIf _Prog28 = 15 Then
            _eb.lokSteuern(28, Klassen.LokEigenschaften.Geschwindigkeit, Stufe14)
        ElseIf _Prog28 = 16 Then
            _eb.lokSteuern(28, Klassen.LokEigenschaften.Geschwindigkeit, Stufe3)

            ' Lok abstellen

        ElseIf _Prog28 = 50 Then
            Prog_Lok28.Interval = 2000
        ElseIf _Prog28 = 51 Then
        ElseIf _Prog28 = 52 Then
            If _Fahrzeugbeleuchtung2 = 2 Then
                _eb.lokSteuern(28, Klassen.LokEigenschaften.Hauptfunktion, 0) ' Licht aus
            End If

            ' Lok bremsen (Bahnhofseinfahrt Normalzug von links und von rechts)

        ElseIf _Prog28 = 100 Then
            Prog_Lok28.Interval = V_100
        ElseIf _Prog28 = 101 Then
            _eb.lokSteuern(28, Klassen.LokEigenschaften.Geschwindigkeit, Stufe24)
            Prog_Lok28.Interval = T_100
        ElseIf _Prog28 = 102 Then
            _eb.lokSteuern(28, Klassen.LokEigenschaften.Geschwindigkeit, Stufe23)
        ElseIf _Prog28 = 103 Then
            _eb.lokSteuern(28, Klassen.LokEigenschaften.Geschwindigkeit, Stufe22)
        ElseIf _Prog28 = 104 Then
            _eb.lokSteuern(28, Klassen.LokEigenschaften.Geschwindigkeit, Stufe21)
        ElseIf _Prog28 = 105 Then
            _eb.lokSteuern(28, Klassen.LokEigenschaften.Geschwindigkeit, Stufe2)

            ' Lok bremsen (Bahnhofseinfahrt Kurzzug von links)

        ElseIf _Prog28 = 130 Then
            Prog_Lok28.Interval = V_130
        ElseIf _Prog28 = 131 Then
            _eb.lokSteuern(28, Klassen.LokEigenschaften.Geschwindigkeit, Stufe24)
            Prog_Lok28.Interval = T_130
        ElseIf _Prog28 = 132 Then
            _eb.lokSteuern(28, Klassen.LokEigenschaften.Geschwindigkeit, Stufe23)
        ElseIf _Prog28 = 133 Then
            _eb.lokSteuern(28, Klassen.LokEigenschaften.Geschwindigkeit, Stufe22)
        ElseIf _Prog28 = 134 Then
            _eb.lokSteuern(28, Klassen.LokEigenschaften.Geschwindigkeit, Stufe21)
        ElseIf _Prog28 = 135 Then
            _eb.lokSteuern(28, Klassen.LokEigenschaften.Geschwindigkeit, Stufe2)
        ElseIf _Prog28 = 136 Then
            _eb.lokSteuern(28, Klassen.LokEigenschaften.Geschwindigkeit, 0)
        ElseIf _Prog28 = 137 Then
            Prog_Lok28.Interval = 2000
        ElseIf _Prog28 = 138 Then
            If _Fahrzeugbeleuchtung2 < 2 Then
                _eb.lokSteuern(28, Klassen.LokEigenschaften.Hauptfunktion, 0) ' Licht aus
            End If

            ' Lok bremsen (Bahnhofseinfahrt Kurzzug von rechts)

        ElseIf _Prog28 = 160 Then
            Prog_Lok28.Interval = V_160
        ElseIf _Prog28 = 161 Then
            _eb.lokSteuern(28, Klassen.LokEigenschaften.Geschwindigkeit, Stufe24)
            Prog_Lok28.Interval = T_160
        ElseIf _Prog28 = 162 Then
            _eb.lokSteuern(28, Klassen.LokEigenschaften.Geschwindigkeit, Stufe23)
        ElseIf _Prog28 = 163 Then
            _eb.lokSteuern(28, Klassen.LokEigenschaften.Geschwindigkeit, Stufe22)
        ElseIf _Prog28 = 164 Then
            _eb.lokSteuern(28, Klassen.LokEigenschaften.Geschwindigkeit, Stufe21)
        ElseIf _Prog28 = 165 Then
            _eb.lokSteuern(28, Klassen.LokEigenschaften.Geschwindigkeit, Stufe2)
        ElseIf _Prog28 = 166 Then
            _eb.lokSteuern(28, Klassen.LokEigenschaften.Geschwindigkeit, 0)
        ElseIf _Prog28 = 167 Then
            Prog_Lok28.Interval = 2000
        ElseIf _Prog28 = 168 Then
            If _Fahrzeugbeleuchtung2 < 2 Then
                _eb.lokSteuern(28, Klassen.LokEigenschaften.Hauptfunktion, 0) ' Licht aus
            End If

            ' Rangierzug

        ElseIf _Prog28 = 180 Then
            _eb.lokSteuern(28, Klassen.LokEigenschaften.Geschwindigkeit, Stufe2)
            Prog_Lok28.Interval = V_180
        ElseIf _Prog28 = 181 Then
            Prog_Lok28.Interval = T_180
            _eb.lokSteuern(28, Klassen.LokEigenschaften.Geschwindigkeit, 2)
        ElseIf _Prog28 = 182 Then
            _eb.lokSteuern(28, Klassen.LokEigenschaften.Geschwindigkeit, 0)

            ' Tunnelausfahrt

        ElseIf _Prog28 = 200 Then ' Kontakt 1.2 <- (bergauf)
            _eb.lokSteuern(28, Klassen.LokEigenschaften.Geschwindigkeit, G_200)
            Prog_Lok28.Interval = 2000
        ElseIf _Prog28 = 201 Then
        ElseIf _Prog28 = 202 Then
        ElseIf _Prog28 = 203 Then
        ElseIf _Prog28 = 204 Then
        ElseIf _Prog28 = 205 Then
            If Stufe4 < Stufe3 Then
                _eb.lokSteuern(28, Klassen.LokEigenschaften.Geschwindigkeit, Stufe3)
            Else
                _eb.lokSteuern(28, Klassen.LokEigenschaften.Geschwindigkeit, Stufe4)
            End If
        ElseIf _Prog28 = 206 Then
            If _AkustischeSignale > 1 Then
                If _Prog28H = 0 Then
                    _eb.lokSteuern(28, Klassen.LokEigenschaften.Funktion3, 1) ' Signal ein
                    _Prog28H = 1
                Else
                    _eb.lokSteuern(28, Klassen.LokEigenschaften.Funktion3, 0) ' Signal aus
                    _Prog28H = 0
                End If
            End If
        ElseIf _Prog28 = 207 Then

        ElseIf _Prog28 = 220 Then ' Kontakt 3.1 -> (hinter dem Martinstor bergauf)
            Prog_Lok28.Interval = 2000
        ElseIf _Prog28 = 221 Then
        ElseIf _Prog28 = 222 Then

        ElseIf _Prog28 = 240 Then ' Kontakt 3.7 <- (bergauf)
            Prog_Lok28.Interval = 2000
        ElseIf _Prog28 = 241 Then
        ElseIf _Prog28 = 242 Then
        ElseIf _Prog28 = 243 Then
            If _AkustischeSignale > 1 Then
                If _Prog28H = 0 Then
                    _eb.lokSteuern(28, Klassen.LokEigenschaften.Funktion3, 1) ' Signal ein
                    _Prog28H = 1
                Else
                    _eb.lokSteuern(28, Klassen.LokEigenschaften.Funktion3, 0) ' Signal aus
                    _Prog28H = 0
                End If
            End If
        ElseIf _Prog28 = 244 Then

        ElseIf _Prog28 = 260 Then ' Kontakt 3.3 (links bzw vor der Brücke)
            Prog_Lok28.Interval = 2000
        ElseIf _Prog28 = 261 Then
        ElseIf _Prog28 = 262 Then
            _eb.lokSteuern(28, Klassen.LokEigenschaften.Geschwindigkeit, Stufe3)

        ElseIf _Prog28 = 600 Then ' Kontakt 3.5
            Prog_Lok28.Interval = 1000
        ElseIf _Prog28 = 601 Then
            If _AkustischeSignale > 1 Then
                If _Prog28H = 0 Then
                    _eb.lokSteuern(28, Klassen.LokEigenschaften.Funktion3, 1) ' Signal ein
                    _Prog28H = 1
                Else
                    _eb.lokSteuern(28, Klassen.LokEigenschaften.Funktion3, 0) ' Signal aus
                    _Prog28H = 0
                End If
            End If
        ElseIf _Prog28 = 602 Then

        ElseIf _Prog28 = 620 Then ' Kontakt 3.7 -> Talfahrt
            Prog_Lok28.Interval = 3000
        ElseIf _Prog28 = 621 Then
            If _AkustischeSignale > 1 Then
                If _Prog28H = 0 Then
                    _eb.lokSteuern(28, Klassen.LokEigenschaften.Funktion3, 1) ' Signal ein
                    _Prog28H = 1
                Else
                    _eb.lokSteuern(28, Klassen.LokEigenschaften.Funktion3, 0) ' Signal aus
                    _Prog28H = 0
                End If
            End If
        ElseIf _Prog28 = 622 Then

        ElseIf _Prog28 = 640 Then ' Kontakt 3.1 <- Talfahrt
            Prog_Lok28.Interval = 2000
        ElseIf _Prog28 = 641 Then
        ElseIf _Prog28 = 642 Then

        ElseIf _Prog28 = 660 Then ' Kontakt 1.2 -> Talfahrt
            Prog_Lok28.Interval = 4000
        ElseIf _Prog28 = 661 Then
        ElseIf _Prog28 = 662 Then
        ElseIf _Prog28 = 663 Then
            If _AkustischeSignale > 1 Then
                If _Prog28H = 0 Then
                    _eb.lokSteuern(28, Klassen.LokEigenschaften.Funktion3, 1) ' Signal ein
                    _Prog28H = 1
                Else
                    _eb.lokSteuern(28, Klassen.LokEigenschaften.Funktion3, 0) ' Signal aus
                    _Prog28H = 0
                End If
            End If
        ElseIf _Prog28 = 664 Then

        ElseIf _Prog28 = 700 Then ' Kontakt 0.4 <- Diagonale
            Prog_Lok28.Interval = 4000
        ElseIf _Prog28 = 701 Then
        ElseIf _Prog28 = 702 Then
        ElseIf _Prog28 = 703 Then
            If _AkustischeSignale > 1 Then
                If _Prog28H = 0 Then
                    _eb.lokSteuern(28, Klassen.LokEigenschaften.Funktion3, 1) ' Signal ein
                    _Prog28H = 1
                Else
                    _eb.lokSteuern(28, Klassen.LokEigenschaften.Funktion3, 0) ' Signal aus
                    _Prog28H = 0
                End If
            End If
        ElseIf _Prog28 = 704 Then

            ' Zindelstein

        ElseIf _Prog28 = 500 Then
            Prog_Lok28.Interval = V_500
        ElseIf _Prog28 = 501 Then
            _eb.lokSteuern(28, Klassen.LokEigenschaften.Geschwindigkeit, Stufe23)
            Prog_Lok28.Interval = T_500
        ElseIf _Prog28 = 502 Then
            _eb.lokSteuern(28, Klassen.LokEigenschaften.Geschwindigkeit, Stufe22)
        ElseIf _Prog28 = 503 Then
            _eb.lokSteuern(28, Klassen.LokEigenschaften.Geschwindigkeit, Stufe21)
        ElseIf _Prog28 = 504 Then
            _eb.lokSteuern(28, Klassen.LokEigenschaften.Geschwindigkeit, Stufe2)
        ElseIf _Prog28 = 505 Then
            _eb.lokSteuern(28, Klassen.LokEigenschaften.Geschwindigkeit, 0)

        Else
            _Prog28 = 0
            Prog_Lok28.Stop()
            Prog_Lok28.Interval = 200
            If Betriebsart = 1 Then
                SetProgramCounterLabel1(String.Empty)
            Else
                SetProgramCounterLabel(String.Empty)
            End If
        End If
        _Prog28 = _Prog28 + 1
    End Sub
    Private Sub HandleTimerElapsed41(sender As System.Object, e As System.EventArgs) Handles Prog_Lok29.Elapsed

        '*** Fahrprogramm für 
        '*** Datum: 23.02.2020

        SetText(TextBox1, "Triebwagen ET91                                                         IBS: 10.12.2025 - V3 : 9")
        LoadImage(PictureBox1, "H:\\EB_Media\\LokFotos\\Baureihe_ET91_01.jpg")
        GeschwindikeitenSetzen(29)

        Dim Stufe1, Stufe2, Stufe3, Stufe4 As Integer
        Dim Stufe11, Stufe12, Stufe13, Stufe14, Stufe21, Stufe22, Stufe23, Stufe24 As Integer
        Dim V_100, V_130, V_160, V_180, V_500 As Integer
        Dim T_100, T_130, T_160, T_180, T_500 As Integer
        Dim G_200 As Integer

        T_100 = _Betriebsparameter.Fahrparameter(29, KlausEBspecific.Betriebsparameter.FahrparameterEnum.T_100)
        T_130 = _Betriebsparameter.Fahrparameter(29, KlausEBspecific.Betriebsparameter.FahrparameterEnum.T_130)
        T_160 = _Betriebsparameter.Fahrparameter(29, KlausEBspecific.Betriebsparameter.FahrparameterEnum.T_160)
        T_180 = _Betriebsparameter.Fahrparameter(29, KlausEBspecific.Betriebsparameter.FahrparameterEnum.T_180)
        T_500 = _Betriebsparameter.Fahrparameter(29, KlausEBspecific.Betriebsparameter.FahrparameterEnum.T_500)
        V_100 = _Betriebsparameter.Fahrparameter(29, KlausEBspecific.Betriebsparameter.FahrparameterEnum.V_100)
        V_130 = _Betriebsparameter.Fahrparameter(29, KlausEBspecific.Betriebsparameter.FahrparameterEnum.V_130)
        V_160 = _Betriebsparameter.Fahrparameter(29, KlausEBspecific.Betriebsparameter.FahrparameterEnum.V_160)
        V_180 = _Betriebsparameter.Fahrparameter(29, KlausEBspecific.Betriebsparameter.FahrparameterEnum.V_180)
        V_500 = _Betriebsparameter.Fahrparameter(29, KlausEBspecific.Betriebsparameter.FahrparameterEnum.V_500)
        G_200 = _Betriebsparameter.Fahrparameter(29, KlausEBspecific.Betriebsparameter.FahrparameterEnum.G_200)

        If A_StopB = 1 Then
            V_100 = 8000
        End If

        Stufe1 = _LokStufen.Holen(29, 1)
        Stufe2 = _LokStufen.Holen(29, 2)
        Stufe3 = _LokStufen.Holen(29, 3)
        Stufe4 = _LokStufen.Holen(29, 4)

        If Stufe2 = 1 Then
            T_100 = T_100
            T_130 = T_130
            T_160 = T_160
            V_180 = V_180
        ElseIf Stufe2 = 2 Then
            T_100 = T_100 + 300
            T_130 = T_130 + 300
            T_160 = T_160 + 300
            V_180 = V_180 + 500
        ElseIf Stufe2 = 3 Then
            T_100 = T_100 + 500
            T_130 = T_130 + 500
            T_160 = T_160 + 500
            V_180 = V_180 + 1000
        ElseIf Stufe2 = 4 Then
            T_100 = T_100 + 700
            T_130 = T_130 + 700
            T_160 = T_160 + 700
            V_180 = V_180 + 1500
        ElseIf Stufe2 = 5 Then
            T_100 = T_100 + 900
            T_130 = T_130 + 900
            T_160 = T_160 + 900
            V_180 = V_180 + 2000
        ElseIf Stufe2 = 6 Then
            T_100 = T_100 + 1200
            T_130 = T_130 + 1200
            T_160 = T_160 + 1200
            V_180 = V_180 + 2500
        Else
            T_100 = T_100 + 1200
            T_130 = T_130 + 1200
            T_160 = T_160 + 1200
            V_180 = V_180 + 2500
        End If

        Stufe2 = Stufe1

        Stufe11 = Stufe1 + 1
        If Stufe11 > Stufe3 Then
            Stufe11 = Stufe3
        End If
        Stufe12 = Stufe1 + 2
        If Stufe12 > Stufe3 Then
            Stufe12 = Stufe3
        End If
        Stufe13 = Stufe1 + 3
        If Stufe13 > Stufe3 Then
            Stufe13 = Stufe3
        End If
        Stufe14 = Stufe1 + 4
        If Stufe14 > Stufe3 Then
            Stufe14 = Stufe3
        End If

        Stufe21 = Stufe2 + 1
        If Stufe21 > Stufe3 Then
            Stufe21 = Stufe3
        End If
        Stufe22 = Stufe2 + 2
        If Stufe22 > Stufe3 Then
            Stufe22 = Stufe3
        End If
        Stufe23 = Stufe2 + 3
        If Stufe23 > Stufe3 Then
            Stufe23 = Stufe3
        End If
        Stufe24 = Stufe2 + 4
        If Stufe24 > Stufe3 Then
            Stufe24 = Stufe3
        End If
        If G_200 > 0 Then
            If G_200 < Stufe4 Then
                G_200 = Stufe4
            End If
        Else
            G_200 = Stufe4
        End If

        If Betriebsart = 1 And (_GlsL29 = 3 Or _GlsL29 = 4) Then
            SetProgramCounterLabel1(_Prog29)
        Else
            SetProgramCounterLabel(_Prog29)
        End If

        ' Lok starten - Bahnhofsausfahrt

        If _Prog29 = 0 Then
            Prog_Lok29.Interval = 2000
            If _Fahrzeugbeleuchtung2 > 0 Then
                _eb.lokSteuern(29, Klassen.LokEigenschaften.Hauptfunktion, 1) ' Licht ein
            End If
        ElseIf _Prog29 = 1 Then
            If _Innenbeleuchtung2 > 0 Then
                _eb.lokSteuern(29, Klassen.LokEigenschaften.Funktion1, 1) ' Innenbeleuchtung ein
            End If
        ElseIf _Prog29 = 2 Then
            If _Durchsagen = 1 Then
                _eb.lokSteuern(29, Klassen.LokEigenschaften.Funktion2, 1) ' Durchsage ein
            Else
                _Prog29 = 6
            End If
        ElseIf _Prog29 = 3 Then
            _Betriebsparameter.RundenErhoehen(29)
        ElseIf _Prog29 = 4 Then
        ElseIf _Prog29 = 5 Then
        ElseIf _Prog29 = 6 Then
        ElseIf _Prog29 = 7 Then
            _eb.lokSteuern(29, Klassen.LokEigenschaften.Funktion2, 0) ' Durchsage aus

            ' Bahnhofsausfahrt

        ElseIf _Prog29 = 8 Then
            If _AkustischeSignale > 0 Then
                _eb.lokSteuern(29, Klassen.LokEigenschaften.Funktion3, 1) ' Pfiff ein
            End If
        ElseIf _Prog29 = 9 Then
            _eb.lokSteuern(29, Klassen.LokEigenschaften.Funktion3, 0) ' Pfiff aus
        ElseIf _Prog29 = 10 Then
            _eb.lokSteuern(29, Klassen.LokEigenschaften.Geschwindigkeit, Stufe1)
        ElseIf _Prog29 = 11 Then
            _eb.lokSteuern(29, Klassen.LokEigenschaften.Geschwindigkeit, Stufe11)
        ElseIf _Prog29 = 12 Then
            _eb.lokSteuern(29, Klassen.LokEigenschaften.Geschwindigkeit, Stufe12)
        ElseIf _Prog29 = 13 Then
            _eb.lokSteuern(29, Klassen.LokEigenschaften.Geschwindigkeit, Stufe13)
        ElseIf _Prog29 = 14 Then
            _eb.lokSteuern(29, Klassen.LokEigenschaften.Geschwindigkeit, Stufe14)
        ElseIf _Prog29 = 15 Then
            _eb.lokSteuern(29, Klassen.LokEigenschaften.Geschwindigkeit, Stufe3)

            ' Lok abstellen

        ElseIf _Prog29 = 50 Then
            Prog_Lok29.Interval = 2000
        ElseIf _Prog29 = 51 Then
        ElseIf _Prog29 = 52 Then
            If _Fahrzeugbeleuchtung2 < 2 Then
                _eb.lokSteuern(29, Klassen.LokEigenschaften.Hauptfunktion, 0) ' Licht aus
            End If
        ElseIf _Prog29 = 53 Then
            If _Innenbeleuchtung2 < 2 Then
                _eb.lokSteuern(29, Klassen.LokEigenschaften.Funktion1, 0) ' Innenbeleuchtung aus
            End If


            ' Lok bremsen (Bahnhofseinfahrt Normalzug von links und von rechts)

        ElseIf _Prog29 = 100 Then
            Prog_Lok29.Interval = V_100
        ElseIf _Prog29 = 101 Then
            _eb.lokSteuern(29, Klassen.LokEigenschaften.Geschwindigkeit, Stufe24)
            Prog_Lok29.Interval = T_100
        ElseIf _Prog29 = 102 Then
            _eb.lokSteuern(29, Klassen.LokEigenschaften.Geschwindigkeit, Stufe23)
        ElseIf _Prog29 = 103 Then
            _eb.lokSteuern(29, Klassen.LokEigenschaften.Geschwindigkeit, Stufe22)
        ElseIf _Prog29 = 104 Then
            _eb.lokSteuern(29, Klassen.LokEigenschaften.Geschwindigkeit, Stufe21)
        ElseIf _Prog29 = 105 Then
            _eb.lokSteuern(29, Klassen.LokEigenschaften.Geschwindigkeit, Stufe2)

            ' Lok bremsen (Bahnhofseinfahrt Kurzzug von links)

        ElseIf _Prog29 = 130 Then
            Prog_Lok29.Interval = V_130
        ElseIf _Prog29 = 131 Then
            _eb.lokSteuern(29, Klassen.LokEigenschaften.Geschwindigkeit, Stufe24)
            Prog_Lok29.Interval = T_130
        ElseIf _Prog29 = 132 Then
            _eb.lokSteuern(29, Klassen.LokEigenschaften.Geschwindigkeit, Stufe23)
        ElseIf _Prog29 = 133 Then
            _eb.lokSteuern(29, Klassen.LokEigenschaften.Geschwindigkeit, Stufe22)
        ElseIf _Prog29 = 134 Then
            _eb.lokSteuern(29, Klassen.LokEigenschaften.Geschwindigkeit, Stufe21)
        ElseIf _Prog29 = 135 Then
            _eb.lokSteuern(29, Klassen.LokEigenschaften.Geschwindigkeit, Stufe2)
        ElseIf _Prog29 = 136 Then
            _eb.lokSteuern(29, Klassen.LokEigenschaften.Geschwindigkeit, 0)
        ElseIf _Prog29 = 137 Then
            Prog_Lok29.Interval = 2000
        ElseIf _Prog29 = 138 Then
            If _Innenbeleuchtung2 < 2 Then
                _eb.lokSteuern(29, Klassen.LokEigenschaften.Funktion1, 0) ' Innenbeleuchtung aus
            End If
        ElseIf _Prog29 = 139 Then
        ElseIf _Prog29 = 140 Then
            If _Fahrzeugbeleuchtung2 < 2 Then
                _eb.lokSteuern(29, Klassen.LokEigenschaften.Hauptfunktion, 0) ' Licht aus
            End If

            ' Lok bremsen (Bahnhofseinfahrt Kurzzug von rechts)

        ElseIf _Prog29 = 160 Then
            Prog_Lok29.Interval = V_160
        ElseIf _Prog29 = 161 Then
            _eb.lokSteuern(29, Klassen.LokEigenschaften.Geschwindigkeit, Stufe24)
            Prog_Lok29.Interval = T_160
        ElseIf _Prog29 = 162 Then
            _eb.lokSteuern(29, Klassen.LokEigenschaften.Geschwindigkeit, Stufe23)
        ElseIf _Prog29 = 163 Then
            _eb.lokSteuern(29, Klassen.LokEigenschaften.Geschwindigkeit, Stufe22)
        ElseIf _Prog29 = 164 Then
            _eb.lokSteuern(29, Klassen.LokEigenschaften.Geschwindigkeit, Stufe21)
        ElseIf _Prog29 = 165 Then
            _eb.lokSteuern(29, Klassen.LokEigenschaften.Geschwindigkeit, Stufe2)
        ElseIf _Prog29 = 166 Then
            _eb.lokSteuern(29, Klassen.LokEigenschaften.Geschwindigkeit, 0)
        ElseIf _Prog29 = 137 Then
            Prog_Lok29.Interval = 2000
        ElseIf _Prog29 = 138 Then
            If _Innenbeleuchtung2 < 2 Then
                _eb.lokSteuern(29, Klassen.LokEigenschaften.Funktion1, 0) ' Innenbeleuchtung aus
            End If
        ElseIf _Prog29 = 139 Then
        ElseIf _Prog29 = 140 Then
            If _Fahrzeugbeleuchtung2 < 2 Then
                _eb.lokSteuern(29, Klassen.LokEigenschaften.Hauptfunktion, 0) ' Licht aus
            End If

            ' Rangierzug

        ElseIf _Prog29 = 180 Then
            _eb.lokSteuern(29, Klassen.LokEigenschaften.Geschwindigkeit, 2)
            Prog_Lok29.Interval = V_180
        ElseIf _Prog29 = 181 Then
            Prog_Lok29.Interval = T_180
            _eb.lokSteuern(29, Klassen.LokEigenschaften.Geschwindigkeit, 1)
        ElseIf _Prog29 = 182 Then
            _eb.lokSteuern(29, Klassen.LokEigenschaften.Geschwindigkeit, 0)

            ' Tunnelausfahrt

        ElseIf _Prog29 = 200 Then ' Kontakt 1.2 <- (bergauf)
            _eb.lokSteuern(29, Klassen.LokEigenschaften.Geschwindigkeit, G_200)
            Prog_Lok29.Interval = 2000
        ElseIf _Prog29 = 201 Then
        ElseIf _Prog29 = 202 Then
        ElseIf _Prog29 = 203 Then
            If Stufe4 < Stufe3 Then
                _eb.lokSteuern(29, Klassen.LokEigenschaften.Geschwindigkeit, Stufe3)
            Else
                _eb.lokSteuern(29, Klassen.LokEigenschaften.Geschwindigkeit, Stufe4)
            End If
        ElseIf _Prog29 = 204 Then
        ElseIf _Prog29 = 205 Then
        ElseIf _Prog29 = 206 Then
        ElseIf _Prog29 = 207 Then
            If _AkustischeSignale > 1 Then
                _eb.lokSteuern(29, Klassen.LokEigenschaften.Funktion3, 1) ' Hupe ein
            End If
        ElseIf _Prog29 = 208 Then
            _eb.lokSteuern(29, Klassen.LokEigenschaften.Funktion3, 0) ' Hupe aus

        ElseIf _Prog29 = 220 Then ' Kontakt 3.1 -> (hinter dem Martinstor bergauf)
            Prog_Lok29.Interval = 2000
        ElseIf _Prog29 = 221 Then
        ElseIf _Prog29 = 222 Then
        ElseIf _Prog29 = 223 Then

        ElseIf _Prog29 = 240 Then ' Kontakt 3.7 <- (hinter der Brücke bergauf)
            Prog_Lok29.Interval = 2000
        ElseIf _Prog29 = 241 Then
        ElseIf _Prog29 = 242 Then
        ElseIf _Prog29 = 243 Then
            If _AkustischeSignale > 1 Then
                _eb.lokSteuern(29, Klassen.LokEigenschaften.Funktion3, 1) ' Pfiff ein
            End If
        ElseIf _Prog29 = 244 Then
            _eb.lokSteuern(29, Klassen.LokEigenschaften.Funktion3, 0) ' Pfiff aus
        ElseIf _Prog29 = 245 Then

        ElseIf _Prog29 = 260 Then ' Kontakt 3.3 (links bzw vor der Brücke)
            Prog_Lok29.Interval = 2000
        ElseIf _Prog29 = 261 Then
        ElseIf _Prog29 = 262 Then
            _eb.lokSteuern(29, Klassen.LokEigenschaften.Geschwindigkeit, Stufe3)

        ElseIf _Prog29 = 600 Then ' Kontakt 3.5 <- (unter der Burg)
            Prog_Lok29.Interval = 2000
        ElseIf _Prog29 = 601 Then
            If _AkustischeSignale > 1 Then
                _eb.lokSteuern(29, Klassen.LokEigenschaften.Funktion3, 1) ' Pfiff ein
            End If
        ElseIf _Prog29 = 602 Then
            _eb.lokSteuern(29, Klassen.LokEigenschaften.Funktion3, 0) ' Pfiff aus
        ElseIf _Prog29 = 603 Then

        ElseIf _Prog29 = 620 Then ' Kontakt 3.7 -> (hinter der Brücke bergab)
            Prog_Lok29.Interval = 2000
        ElseIf _Prog29 = 621 Then
        ElseIf _Prog29 = 622 Then
        ElseIf _Prog29 = 623 Then
            If _AkustischeSignale > 1 Then
                _eb.lokSteuern(29, Klassen.LokEigenschaften.Funktion3, 1) ' Pfiff ein
            End If
        ElseIf _Prog29 = 624 Then
            _eb.lokSteuern(29, Klassen.LokEigenschaften.Funktion3, 0) ' Pfiff aus

        ElseIf _Prog29 = 640 Then ' Kontakt 3.1 <- Talfahrt
            Prog_Lok29.Interval = 2000
        ElseIf _Prog29 = 641 Then
        ElseIf _Prog29 = 642 Then

        ElseIf _Prog29 = 660 Then ' Kontakt 1.2 -> Talfahrt
            Prog_Lok29.Interval = 2000
        ElseIf _Prog29 = 661 Then
        ElseIf _Prog29 = 662 Then
        ElseIf _Prog29 = 663 Then
        ElseIf _Prog29 = 664 Then
        ElseIf _Prog29 = 665 Then
            If _GlsL29 = 1 Or _GlsL29 = 2 Then
                If _AkustischeSignale > 0 Then
                    _eb.lokSteuern(29, Klassen.LokEigenschaften.Funktion3, 1) ' Pfiff ein
                End If
            End If
        ElseIf _Prog29 = 666 Then
            _eb.lokSteuern(29, Klassen.LokEigenschaften.Funktion3, 0) ' Pfiff aus

        ElseIf _Prog29 = 700 Then ' Kontakt 0.4 <- Diagonale
            Prog_Lok29.Interval = 2000
        ElseIf _Prog29 = 701 Then
        ElseIf _Prog29 = 702 Then
        ElseIf _Prog29 = 703 Then
        ElseIf _Prog29 = 704 Then
            If _AkustischeSignale > 0 Then
                _eb.lokSteuern(29, Klassen.LokEigenschaften.Funktion3, 1) ' Pfiff ein
            End If
        ElseIf _Prog29 = 705 Then
            _eb.lokSteuern(29, Klassen.LokEigenschaften.Funktion3, 0) ' Pfiff aus

            ' Zindelstein

        ElseIf _Prog29 = 500 Then
            Prog_Lok29.Interval = V_500
        ElseIf _Prog29 = 501 Then
            _eb.lokSteuern(29, Klassen.LokEigenschaften.Geschwindigkeit, Stufe23)
            Prog_Lok29.Interval = T_500
        ElseIf _Prog29 = 502 Then
            _eb.lokSteuern(29, Klassen.LokEigenschaften.Geschwindigkeit, Stufe22)
        ElseIf _Prog29 = 503 Then
            _eb.lokSteuern(29, Klassen.LokEigenschaften.Geschwindigkeit, Stufe21)
        ElseIf _Prog29 = 504 Then
            _eb.lokSteuern(29, Klassen.LokEigenschaften.Geschwindigkeit, Stufe2)
        ElseIf _Prog29 = 505 Then
            _eb.lokSteuern(29, Klassen.LokEigenschaften.Geschwindigkeit, 0)


        Else
            _Prog29 = 0
            Prog_Lok29.Stop()
            Prog_Lok29.Interval = 200
            If Betriebsart = 1 Then
                SetProgramCounterLabel1(String.Empty)
            Else
                SetProgramCounterLabel(String.Empty)
            End If
        End If
        _Prog29 = _Prog29 + 1
    End Sub
    Private Sub HandleTimerElapsed42(sender As System.Object, e As System.EventArgs) Handles Prog_Lok30.Elapsed

        '*** Fahrprogramm für den TEE Gottardo 
        '*** Datum: 23.02.2020

        SetText(TextBox1, "RAe TEE II Gottardo                                                     IBS: 15.01.2022 V1: 2 - V3: 7")
        LoadImage(PictureBox1, "H:\\EB_Media\\LokFotos\\Baureihe_TEE_11.jpg")
        GeschwindikeitenSetzen(30)

        Dim Stufe1, Stufe2, Stufe3, Stufe4 As Integer
        Dim Stufe11, Stufe12, Stufe13, Stufe14, Stufe21, Stufe22, Stufe23, Stufe24 As Integer
        Dim V_100, V_130, V_160, V_180, V_500 As Integer
        Dim T_100, T_130, T_160, T_180, T_500 As Integer
        Dim G_200 As Integer

        T_100 = _Betriebsparameter.Fahrparameter(30, KlausEBspecific.Betriebsparameter.FahrparameterEnum.T_100)
        T_130 = _Betriebsparameter.Fahrparameter(30, KlausEBspecific.Betriebsparameter.FahrparameterEnum.T_130)
        T_160 = _Betriebsparameter.Fahrparameter(30, KlausEBspecific.Betriebsparameter.FahrparameterEnum.T_160)
        T_180 = _Betriebsparameter.Fahrparameter(30, KlausEBspecific.Betriebsparameter.FahrparameterEnum.T_180)
        T_500 = _Betriebsparameter.Fahrparameter(30, KlausEBspecific.Betriebsparameter.FahrparameterEnum.T_500)
        V_100 = _Betriebsparameter.Fahrparameter(30, KlausEBspecific.Betriebsparameter.FahrparameterEnum.V_100)
        V_130 = _Betriebsparameter.Fahrparameter(30, KlausEBspecific.Betriebsparameter.FahrparameterEnum.V_130)
        V_160 = _Betriebsparameter.Fahrparameter(30, KlausEBspecific.Betriebsparameter.FahrparameterEnum.V_160)
        V_180 = _Betriebsparameter.Fahrparameter(30, KlausEBspecific.Betriebsparameter.FahrparameterEnum.V_180)
        V_500 = _Betriebsparameter.Fahrparameter(30, KlausEBspecific.Betriebsparameter.FahrparameterEnum.V_500)
        G_200 = _Betriebsparameter.Fahrparameter(30, KlausEBspecific.Betriebsparameter.FahrparameterEnum.G_200)

        If A_StopB = 1 Then
            V_100 = 8000
        End If

        Stufe1 = _LokStufen.Holen(30, 1)
        Stufe2 = _LokStufen.Holen(30, 2)
        Stufe3 = _LokStufen.Holen(30, 3)
        Stufe4 = _LokStufen.Holen(30, 4)

        If Stufe2 = 1 Then
            T_100 = T_100
            T_130 = T_130
            T_160 = T_160
            V_180 = V_180
        ElseIf Stufe2 = 2 Then
            T_100 = T_100 + 300
            T_130 = T_130 + 300
            T_160 = T_160 + 300
            V_180 = V_180 + 500
        ElseIf Stufe2 = 3 Then
            T_100 = T_100 + 500
            T_130 = T_130 + 500
            T_160 = T_160 + 500
            V_180 = V_180 + 1000
        ElseIf Stufe2 = 4 Then
            T_100 = T_100 + 700
            T_130 = T_130 + 700
            T_160 = T_160 + 700
            V_180 = V_180 + 1500
        ElseIf Stufe2 = 5 Then
            T_100 = T_100 + 900
            T_130 = T_130 + 900
            T_160 = T_160 + 900
            V_180 = V_180 + 2000
        ElseIf Stufe2 = 6 Then
            T_100 = T_100 + 1200
            T_130 = T_130 + 1200
            T_160 = T_160 + 1200
            V_180 = V_180 + 2500
        Else
            T_100 = T_100 + 1200
            T_130 = T_130 + 1200
            T_160 = T_160 + 1200
            V_180 = V_180 + 2500
        End If

        Stufe2 = Stufe1

        Stufe11 = Stufe1 + 1
        If Stufe11 > Stufe3 Then
            Stufe11 = Stufe3
        End If
        Stufe12 = Stufe1 + 2
        If Stufe12 > Stufe3 Then
            Stufe12 = Stufe3
        End If
        Stufe13 = Stufe1 + 3
        If Stufe13 > Stufe3 Then
            Stufe13 = Stufe3
        End If
        Stufe14 = Stufe1 + 4
        If Stufe14 > Stufe3 Then
            Stufe14 = Stufe3
        End If

        Stufe21 = Stufe2 + 1
        If Stufe21 > Stufe3 Then
            Stufe21 = Stufe3
        End If
        Stufe22 = Stufe2 + 2
        If Stufe22 > Stufe3 Then
            Stufe22 = Stufe3
        End If
        Stufe23 = Stufe2 + 3
        If Stufe23 > Stufe3 Then
            Stufe23 = Stufe3
        End If
        Stufe24 = Stufe2 + 4
        If Stufe24 > Stufe3 Then
            Stufe24 = Stufe3
        End If
        If G_200 > 0 Then
            If G_200 < Stufe4 Then
                G_200 = Stufe4
            End If
        Else
            G_200 = Stufe4
        End If

        If Betriebsart = 1 And (_GlsL30 = 3 Or _GlsL30 = 4) Then
            SetProgramCounterLabel1(_Prog30)
        Else
            SetProgramCounterLabel(_Prog30)
        End If

        ' Lok starten - Bahnhofsausfahrt

        If _Prog30 = 0 Then
            Prog_Lok30.Interval = 2000
            If _Fahrzeugbeleuchtung2 > 0 Then
                _eb.lokSteuern(30, Klassen.LokEigenschaften.Hauptfunktion, 1) ' Licht ein
            End If
            If _Durchsagen = 0 Then
                _Prog30 = 5
                If _AkustischeSignale = 0 Then
                    _Prog30 = 6
                End If
            End If
        ElseIf _Prog30 = 1 Then
            If _Durchsagen = 1 And _TypL30 = 1 Then
                _eb.lokSteuern(30, Klassen.LokEigenschaften.Funktion2, 1) ' Durchsage ein
            End If
        ElseIf _Prog30 = 2 Then
            _Betriebsparameter.RundenErhoehen(30)
        ElseIf _Prog30 = 3 Then
        ElseIf _Prog30 = 4 Then
        ElseIf _Prog30 = 5 Then
            _eb.lokSteuern(30, Klassen.LokEigenschaften.Funktion2, 0) ' Durchsage aus

            ' Bahnhofsausfahrt

        ElseIf _Prog30 = 6 Then
            If _AkustischeSignale > 0 Then
                _eb.lokSteuern(30, Klassen.LokEigenschaften.Funktion3, 1) ' Pfiff ein
            End If
        ElseIf _Prog30 = 7 Then
            _eb.lokSteuern(30, Klassen.LokEigenschaften.Funktion3, 0) ' Pfiff aus
        ElseIf _Prog30 = 8 Then
            _eb.lokSteuern(30, Klassen.LokEigenschaften.Geschwindigkeit, Stufe1)
        ElseIf _Prog30 = 9 Then
            _eb.lokSteuern(30, Klassen.LokEigenschaften.Geschwindigkeit, Stufe11)
        ElseIf _Prog30 = 10 Then
            _eb.lokSteuern(30, Klassen.LokEigenschaften.Geschwindigkeit, Stufe12)
        ElseIf _Prog30 = 11 Then
            _eb.lokSteuern(30, Klassen.LokEigenschaften.Geschwindigkeit, Stufe13)
        ElseIf _Prog30 = 12 Then
            _eb.lokSteuern(30, Klassen.LokEigenschaften.Geschwindigkeit, Stufe14)
        ElseIf _Prog30 = 13 Then
            _eb.lokSteuern(30, Klassen.LokEigenschaften.Geschwindigkeit, Stufe3)

            ' Lok abstellen

        ElseIf _Prog30 = 50 Then
            Prog_Lok30.Interval = 2000
        ElseIf _Prog30 = 51 Then
        ElseIf _Prog30 = 52 Then
            If _Fahrzeugbeleuchtung2 < 2 Then
                _eb.lokSteuern(30, Klassen.LokEigenschaften.Hauptfunktion, 0) ' Licht aus
            End If

            ' Lok bremsen (Bahnhofseinfahrt Normalzug von links und von rechts)

        ElseIf _Prog30 = 100 Then
            Prog_Lok30.Interval = V_100
        ElseIf _Prog30 = 101 Then
            _eb.lokSteuern(30, Klassen.LokEigenschaften.Geschwindigkeit, Stufe24)
            Prog_Lok30.Interval = T_100
        ElseIf _Prog30 = 102 Then
            _eb.lokSteuern(30, Klassen.LokEigenschaften.Geschwindigkeit, Stufe23)
        ElseIf _Prog30 = 103 Then
            _eb.lokSteuern(30, Klassen.LokEigenschaften.Geschwindigkeit, Stufe22)
        ElseIf _Prog30 = 104 Then
            _eb.lokSteuern(30, Klassen.LokEigenschaften.Geschwindigkeit, Stufe21)
        ElseIf _Prog30 = 105 Then
            _eb.lokSteuern(30, Klassen.LokEigenschaften.Geschwindigkeit, Stufe2)

            ' Lok bremsen (Bahnhofseinfahrt Kurzzug von links)

        ElseIf _Prog30 = 130 Then
            Prog_Lok30.Interval = V_130
        ElseIf _Prog30 = 131 Then
            _eb.lokSteuern(30, Klassen.LokEigenschaften.Geschwindigkeit, Stufe24)
            Prog_Lok30.Interval = T_130
        ElseIf _Prog30 = 132 Then
            _eb.lokSteuern(30, Klassen.LokEigenschaften.Geschwindigkeit, Stufe23)
        ElseIf _Prog30 = 133 Then
            _eb.lokSteuern(30, Klassen.LokEigenschaften.Geschwindigkeit, Stufe22)
        ElseIf _Prog30 = 134 Then
            _eb.lokSteuern(30, Klassen.LokEigenschaften.Geschwindigkeit, Stufe21)
        ElseIf _Prog30 = 135 Then
            _eb.lokSteuern(30, Klassen.LokEigenschaften.Geschwindigkeit, Stufe2)
        ElseIf _Prog30 = 136 Then
            _eb.lokSteuern(30, Klassen.LokEigenschaften.Geschwindigkeit, 0)
        ElseIf _Prog30 = 137 Then
            Prog_Lok30.Interval = 2000
        ElseIf _Prog30 = 138 Then
            If _Motor < 3 Then
                _eb.lokSteuern(30, Klassen.LokEigenschaften.Funktion2, 0) ' Motor aus
            End If
        ElseIf _Prog30 = 139 Then
        ElseIf _Prog30 = 140 Then
            If _Fahrzeugbeleuchtung2 < 2 Then
                _eb.lokSteuern(30, Klassen.LokEigenschaften.Hauptfunktion, 0) ' Licht aus
            End If

            ' Lok bremsen (Bahnhofseinfahrt Kurzzug von rechts)

        ElseIf _Prog30 = 160 Then
            Prog_Lok30.Interval = V_160
        ElseIf _Prog30 = 161 Then
            _eb.lokSteuern(30, Klassen.LokEigenschaften.Geschwindigkeit, Stufe24)
            Prog_Lok30.Interval = T_160
        ElseIf _Prog30 = 162 Then
            _eb.lokSteuern(30, Klassen.LokEigenschaften.Geschwindigkeit, Stufe23)
        ElseIf _Prog30 = 163 Then
            _eb.lokSteuern(30, Klassen.LokEigenschaften.Geschwindigkeit, Stufe22)
        ElseIf _Prog30 = 164 Then
            _eb.lokSteuern(30, Klassen.LokEigenschaften.Geschwindigkeit, Stufe21)
        ElseIf _Prog30 = 165 Then
            _eb.lokSteuern(30, Klassen.LokEigenschaften.Geschwindigkeit, Stufe2)
        ElseIf _Prog30 = 166 Then
            _eb.lokSteuern(30, Klassen.LokEigenschaften.Geschwindigkeit, 0)
        ElseIf _Prog30 = 167 Then
            Prog_Lok30.Interval = 2000
        ElseIf _Prog30 = 168 Then
            If _Motor < 3 Then
                _eb.lokSteuern(30, Klassen.LokEigenschaften.Funktion2, 0) ' Motor aus
            End If
        ElseIf _Prog30 = 169 Then
        ElseIf _Prog30 = 170 Then
            If _Fahrzeugbeleuchtung2 < 2 Then
                _eb.lokSteuern(30, Klassen.LokEigenschaften.Hauptfunktion, 0) ' Licht aus
            End If

            ' Rangierzug

        ElseIf _Prog30 = 180 Then
            _eb.lokSteuern(30, Klassen.LokEigenschaften.Geschwindigkeit, 2)
            Prog_Lok30.Interval = V_180
        ElseIf _Prog30 = 181 Then
            Prog_Lok30.Interval = T_180
            _eb.lokSteuern(30, Klassen.LokEigenschaften.Geschwindigkeit, 1)
        ElseIf _Prog30 = 182 Then
            _eb.lokSteuern(30, Klassen.LokEigenschaften.Geschwindigkeit, 0)

            ' Tunnelausfahrt

        ElseIf _Prog30 = 200 Then ' Kontakt 1.2 <- (bergauf)
            _eb.lokSteuern(30, Klassen.LokEigenschaften.Geschwindigkeit, G_200)
            Prog_Lok30.Interval = 2000
        ElseIf _Prog30 = 201 Then
        ElseIf _Prog30 = 202 Then
        ElseIf _Prog30 = 203 Then
        ElseIf _Prog30 = 204 Then
        ElseIf _Prog30 = 205 Then
            If Stufe4 < Stufe3 Then
                _eb.lokSteuern(30, Klassen.LokEigenschaften.Geschwindigkeit, Stufe3)
            Else
                _eb.lokSteuern(30, Klassen.LokEigenschaften.Geschwindigkeit, Stufe4)
            End If
        ElseIf _Prog30 = 206 Then
        ElseIf _Prog30 = 207 Then
            If _Motor > 1 Then
                _eb.lokSteuern(30, Klassen.LokEigenschaften.Funktion2, 1) ' Motor ein
            End If
        ElseIf _Prog30 = 208 Then
            Prog_Lok30.Interval = 2000
        ElseIf _Prog30 = 209 Then
            If _AkustischeSignale > 1 Then
                _eb.lokSteuern(30, Klassen.LokEigenschaften.Funktion3, 1) ' Hupe ein
            End If
        ElseIf _Prog30 = 210 Then
            _eb.lokSteuern(30, Klassen.LokEigenschaften.Funktion3, 0) ' Hupe aus

        ElseIf _Prog30 = 220 Then ' Kontakt 3.1 -> (hinter dem Martinstor bergauf)
            Prog_Lok30.Interval = 2000
        ElseIf _Prog30 = 221 Then
        ElseIf _Prog30 = 222 Then
        ElseIf _Prog30 = 223 Then
            If _Motor < 3 Then
                _eb.lokSteuern(30, Klassen.LokEigenschaften.Funktion2, 1) ' Motor aus
            End If

        ElseIf _Prog30 = 240 Then ' Kontakt 3.7 <- (hinter der Brücke bergauf)
            Prog_Lok30.Interval = 2000
        ElseIf _Prog30 = 241 Then
        ElseIf _Prog30 = 242 Then
            Prog_Lok30.Interval = 2000
        ElseIf _Prog30 = 243 Then
            If _Motor > 1 Then
                _eb.lokSteuern(30, Klassen.LokEigenschaften.Funktion2, 1) ' Motor ein
            End If
        ElseIf _Prog30 = 244 Then
            If _AkustischeSignale > 1 Then
                _eb.lokSteuern(30, Klassen.LokEigenschaften.Funktion3, 1) ' Pfiff ein
            End If
        ElseIf _Prog30 = 245 Then
            _eb.lokSteuern(30, Klassen.LokEigenschaften.Funktion3, 0) ' Pfiff aus
        ElseIf _Prog30 = 246 Then

        ElseIf _Prog30 = 260 Then ' Kontakt 3.3 (links bzw vor der Brücke)
            Prog_Lok30.Interval = 2000
        ElseIf _Prog30 = 261 Then
        ElseIf _Prog30 = 262 Then
            _eb.lokSteuern(30, Klassen.LokEigenschaften.Geschwindigkeit, Stufe3)

        ElseIf _Prog30 = 600 Then ' Kontakt 3.5 <- (unter der Burg)
            Prog_Lok30.Interval = 1000
        ElseIf _Prog30 = 601 Then
            If _AkustischeSignale > 1 Then
                _eb.lokSteuern(30, Klassen.LokEigenschaften.Funktion3, 1) ' Pfiff ein
            End If
        ElseIf _Prog30 = 602 Then
            _eb.lokSteuern(30, Klassen.LokEigenschaften.Funktion3, 0) ' Pfiff aus
        ElseIf _Prog30 = 603 Then

        ElseIf _Prog30 = 620 Then ' Kontakt 3.7 -> (hinter der Brücke bergab)
            Prog_Lok30.Interval = 2000
        ElseIf _Prog30 = 621 Then
            Prog_Lok30.Interval = 1000
        ElseIf _Prog30 = 622 Then
            If _AkustischeSignale > 1 Then
                _eb.lokSteuern(30, Klassen.LokEigenschaften.Funktion3, 1) ' Pfiff ein
            End If
        ElseIf _Prog30 = 623 Then
            _eb.lokSteuern(30, Klassen.LokEigenschaften.Funktion3, 0) ' Pfiff aus

        ElseIf _Prog30 = 640 Then ' Kontakt 3.1 <- Talfahrt
            Prog_Lok30.Interval = 2000
        ElseIf _Prog30 = 641 Then
        ElseIf _Prog30 = 642 Then
            If _Motor < 3 Then
                _eb.lokSteuern(30, Klassen.LokEigenschaften.Funktion2, 0) ' Motor aus
            End If

        ElseIf _Prog30 = 660 Then ' Kontakt 1.2 -> Talfahrt
            Prog_Lok30.Interval = 2000
        ElseIf _Prog30 = 661 Then
        ElseIf _Prog30 = 662 Then
        ElseIf _Prog30 = 663 Then
            If _GlsL30 = 1 Or _GlsL30 = 2 Then
                If _Motor > 0 Then
                    _eb.lokSteuern(27, Klassen.LokEigenschaften.Funktion2, 1) ' Motor ein
                End If
            End If
        ElseIf _Prog30 = 664 Then
            If _GlsL30 = 1 Or _GlsL30 = 2 Then
                If _AkustischeSignale > 0 Then
                    _eb.lokSteuern(30, Klassen.LokEigenschaften.Funktion3, 1) ' Pfiff ein
                End If
            End If
        ElseIf _Prog30 = 665 Then
            _eb.lokSteuern(30, Klassen.LokEigenschaften.Funktion3, 0) ' Pfiff aus

        ElseIf _Prog30 = 700 Then ' Kontakt 0.4 <- Diagonale
            Prog_Lok30.Interval = 2000
        ElseIf _Prog30 = 701 Then
        ElseIf _Prog30 = 702 Then
        ElseIf _Prog30 = 703 Then
            If _Motor > 0 Then
                _eb.lokSteuern(30, Klassen.LokEigenschaften.Funktion2, 1) ' Motor ein
            End If

        ElseIf _Prog30 = 704 Then
            Prog_Lok30.Interval = 1000
        ElseIf _Prog30 = 705 Then
            If _AkustischeSignale > 0 Then
                _eb.lokSteuern(30, Klassen.LokEigenschaften.Funktion3, 1) ' Pfiff ein
            End If
        ElseIf _Prog30 = 706 Then
            _eb.lokSteuern(30, Klassen.LokEigenschaften.Funktion3, 0) ' Pfiff aus

            ' Zindelstein

        ElseIf _Prog30 = 500 Then
            Prog_Lok30.Interval = V_500
        ElseIf _Prog30 = 501 Then
            _eb.lokSteuern(30, Klassen.LokEigenschaften.Geschwindigkeit, Stufe24)
            Prog_Lok30.Interval = T_500
        ElseIf _Prog30 = 502 Then
            _eb.lokSteuern(30, Klassen.LokEigenschaften.Geschwindigkeit, Stufe23)
        ElseIf _Prog30 = 503 Then
            _eb.lokSteuern(30, Klassen.LokEigenschaften.Geschwindigkeit, Stufe22)
        ElseIf _Prog30 = 504 Then
            _eb.lokSteuern(30, Klassen.LokEigenschaften.Geschwindigkeit, Stufe1)
        ElseIf _Prog30 = 505 Then
            _eb.lokSteuern(30, Klassen.LokEigenschaften.Geschwindigkeit, Stufe2)
        ElseIf _Prog30 = 506 Then
            _eb.lokSteuern(30, Klassen.LokEigenschaften.Geschwindigkeit, 0)

        Else
            _Prog30 = 0
            Prog_Lok30.Stop()
            Prog_Lok30.Interval = 200
            If Betriebsart = 1 Then
                SetProgramCounterLabel1(String.Empty)
            Else
                SetProgramCounterLabel(String.Empty)
            End If
        End If
        _Prog30 = _Prog30 + 1
    End Sub
    Private Sub HandleTimerElapsed43(sender As System.Object, e As System.EventArgs) Handles Prog_Lok31.Elapsed

        '*** Fahrprogramm für E194 091-5
        '*** Datum: 23.02.2020

        SetText(TextBox1, "E-Lok 194 091-5                                                         IBS: 10.09.2025 - V3 : 9")
        LoadImage(PictureBox1, "H:\\EB_Media\\LokFotos\\Baureihe_194_02.jpg")
        GeschwindikeitenSetzen(31)

        Dim Stufe1, Stufe2, Stufe3, Stufe4 As Integer
        Dim Stufe11, Stufe12, Stufe13, Stufe14, Stufe21, Stufe22, Stufe23, Stufe24 As Integer
        Dim V_100, V_130, V_160, V_180, V_500 As Integer
        Dim T_100, T_130, T_160, T_180, T_500 As Integer
        Dim G_200 As Integer

        T_100 = _Betriebsparameter.Fahrparameter(31, KlausEBspecific.Betriebsparameter.FahrparameterEnum.T_100)
        T_130 = _Betriebsparameter.Fahrparameter(31, KlausEBspecific.Betriebsparameter.FahrparameterEnum.T_130)
        T_160 = _Betriebsparameter.Fahrparameter(31, KlausEBspecific.Betriebsparameter.FahrparameterEnum.T_160)
        T_180 = _Betriebsparameter.Fahrparameter(31, KlausEBspecific.Betriebsparameter.FahrparameterEnum.T_180)
        T_500 = _Betriebsparameter.Fahrparameter(31, KlausEBspecific.Betriebsparameter.FahrparameterEnum.T_500)
        V_100 = _Betriebsparameter.Fahrparameter(31, KlausEBspecific.Betriebsparameter.FahrparameterEnum.V_100)
        V_130 = _Betriebsparameter.Fahrparameter(31, KlausEBspecific.Betriebsparameter.FahrparameterEnum.V_130)
        V_160 = _Betriebsparameter.Fahrparameter(31, KlausEBspecific.Betriebsparameter.FahrparameterEnum.V_160)
        V_180 = _Betriebsparameter.Fahrparameter(31, KlausEBspecific.Betriebsparameter.FahrparameterEnum.V_180)
        V_500 = _Betriebsparameter.Fahrparameter(31, KlausEBspecific.Betriebsparameter.FahrparameterEnum.V_500)
        G_200 = _Betriebsparameter.Fahrparameter(31, KlausEBspecific.Betriebsparameter.FahrparameterEnum.G_200)

        If A_StopB = 1 Then
            V_100 = 3000
        End If

        Stufe1 = _LokStufen.Holen(31, 1)
        Stufe2 = _LokStufen.Holen(31, 2)
        Stufe3 = _LokStufen.Holen(31, 3)
        Stufe4 = _LokStufen.Holen(31, 4)

        If Stufe2 = 1 Then
            T_100 = T_100
            T_130 = T_130
            T_160 = T_160
            V_180 = V_180
        ElseIf Stufe2 = 2 Then
            T_100 = T_100 + 300
            T_130 = T_130 + 300
            T_160 = T_160 + 300
            V_180 = V_180 + 500
        ElseIf Stufe2 = 3 Then
            T_100 = T_100 + 500
            T_130 = T_130 + 500
            T_160 = T_160 + 500
            V_180 = V_180 + 1000
        ElseIf Stufe2 = 4 Then
            T_100 = T_100 + 700
            T_130 = T_130 + 700
            T_160 = T_160 + 700
            V_180 = V_180 + 1500
        ElseIf Stufe2 = 5 Then
            T_100 = T_100 + 900
            T_130 = T_130 + 900
            T_160 = T_160 + 900
            V_180 = V_180 + 2000
        ElseIf Stufe2 = 6 Then
            T_100 = T_100 + 1200
            T_130 = T_130 + 1200
            T_160 = T_160 + 1200
            V_180 = V_180 + 2500
        Else
            T_100 = T_100 + 1200
            T_130 = T_130 + 1200
            T_160 = T_160 + 1200
            V_180 = V_180 + 2500
        End If

        Stufe2 = Stufe1

        Stufe11 = Stufe1 + 1
        If Stufe11 > Stufe3 Then
            Stufe11 = Stufe3
        End If
        Stufe12 = Stufe1 + 2
        If Stufe12 > Stufe3 Then
            Stufe12 = Stufe3
        End If
        Stufe13 = Stufe1 + 3
        If Stufe13 > Stufe3 Then
            Stufe13 = Stufe3
        End If
        Stufe14 = Stufe1 + 4
        If Stufe14 > Stufe3 Then
            Stufe14 = Stufe3
        End If

        Stufe21 = Stufe2 + 1
        If Stufe21 > Stufe3 Then
            Stufe21 = Stufe3
        End If
        Stufe22 = Stufe2 + 2
        If Stufe22 > Stufe3 Then
            Stufe22 = Stufe3
        End If
        Stufe23 = Stufe2 + 3
        If Stufe23 > Stufe3 Then
            Stufe23 = Stufe3
        End If
        Stufe24 = Stufe2 + 4
        If Stufe24 > Stufe3 Then
            Stufe24 = Stufe3
        End If
        If G_200 > 0 Then
            If G_200 < Stufe4 Then
                G_200 = Stufe4
            End If
        Else
            G_200 = Stufe4
        End If

        If Betriebsart = 1 And (_GlsL31 = 3 Or _GlsL31 = 4) Then
            SetProgramCounterLabel1(_Prog31)
        Else
            SetProgramCounterLabel(_Prog31)
        End If

        ' Lok starten - Bahnhofsausfahrt

        If _Prog31 = 0 Then
            Prog_Lok31.Interval = 2000
            If _Fahrzeugbeleuchtung2 > 0 Then
                _eb.lokSteuern(31, Klassen.LokEigenschaften.Hauptfunktion, 1) ' Licht ein
            End If
        ElseIf _Prog31 = 1 Then
        ElseIf _Prog31 = 2 Then
            _Betriebsparameter.RundenErhoehen(31)
        ElseIf _Prog31 = 3 Then
        ElseIf _Prog31 = 4 Then
        ElseIf _Prog31 = 5 Then
        ElseIf _Prog31 = 6 Then

            ' Bahnhofsausfahrt

        ElseIf _Prog31 = 7 Then
            _eb.lokSteuern(31, Klassen.LokEigenschaften.Geschwindigkeit, Stufe1)
        ElseIf _Prog31 = 8 Then
            _eb.lokSteuern(31, Klassen.LokEigenschaften.Geschwindigkeit, Stufe11)
        ElseIf _Prog31 = 9 Then
            _eb.lokSteuern(31, Klassen.LokEigenschaften.Geschwindigkeit, Stufe12)
        ElseIf _Prog31 = 10 Then
            _eb.lokSteuern(31, Klassen.LokEigenschaften.Geschwindigkeit, Stufe13)
        ElseIf _Prog31 = 11 Then
            _eb.lokSteuern(31, Klassen.LokEigenschaften.Geschwindigkeit, Stufe14)
        ElseIf _Prog31 = 12 Then
            _eb.lokSteuern(31, Klassen.LokEigenschaften.Geschwindigkeit, Stufe3)

            ' Lok abstellen

        ElseIf _Prog31 = 50 Then
            Prog_Lok31.Interval = 2000
        ElseIf _Prog31 = 51 Then
        ElseIf _Prog31 = 52 Then
            If _Fahrzeugbeleuchtung2 < 2 Then
                _eb.lokSteuern(31, Klassen.LokEigenschaften.Hauptfunktion, 0) ' Licht aus
            End If

            ' Lok bremsen (Bahnhofseinfahrt Normalzug von links und von rechts)

        ElseIf _Prog31 = 100 Then
            Prog_Lok31.Interval = V_100
        ElseIf _Prog31 = 101 Then
            _eb.lokSteuern(31, Klassen.LokEigenschaften.Geschwindigkeit, Stufe24)
            Prog_Lok31.Interval = T_100
        ElseIf _Prog31 = 102 Then
            _eb.lokSteuern(31, Klassen.LokEigenschaften.Geschwindigkeit, Stufe23)
        ElseIf _Prog31 = 103 Then
            _eb.lokSteuern(31, Klassen.LokEigenschaften.Geschwindigkeit, Stufe22)
        ElseIf _Prog31 = 104 Then
            _eb.lokSteuern(31, Klassen.LokEigenschaften.Geschwindigkeit, Stufe21)
        ElseIf _Prog31 = 105 Then
            _eb.lokSteuern(31, Klassen.LokEigenschaften.Geschwindigkeit, Stufe2)

            ' Lok bremsen (Bahnhofseinfahrt Kurzzug von links)

        ElseIf _Prog31 = 130 Then
            Prog_Lok31.Interval = V_130
        ElseIf _Prog31 = 131 Then
            _eb.lokSteuern(31, Klassen.LokEigenschaften.Geschwindigkeit, Stufe24)
            Prog_Lok31.Interval = T_130
        ElseIf _Prog31 = 132 Then
            _eb.lokSteuern(31, Klassen.LokEigenschaften.Geschwindigkeit, Stufe23)
        ElseIf _Prog31 = 133 Then
            _eb.lokSteuern(31, Klassen.LokEigenschaften.Geschwindigkeit, Stufe22)
        ElseIf _Prog31 = 134 Then
            _eb.lokSteuern(31, Klassen.LokEigenschaften.Geschwindigkeit, Stufe21)
        ElseIf _Prog31 = 135 Then
            _eb.lokSteuern(31, Klassen.LokEigenschaften.Geschwindigkeit, Stufe2)
        ElseIf _Prog31 = 136 Then
            _eb.lokSteuern(31, Klassen.LokEigenschaften.Geschwindigkeit, 0)
        ElseIf _Prog31 = 137 Then
            Prog_Lok31.Interval = 2000
        ElseIf _Prog31 = 138 Then
            If _Fahrzeugbeleuchtung2 < 2 Then
                _eb.lokSteuern(31, Klassen.LokEigenschaften.Hauptfunktion, 0) ' Licht aus
            End If

            ' Lok bremsen (Bahnhofseinfahrt Kurzzug von rechts)

        ElseIf _Prog31 = 160 Then
            Prog_Lok31.Interval = V_160
        ElseIf _Prog31 = 161 Then
            _eb.lokSteuern(31, Klassen.LokEigenschaften.Geschwindigkeit, Stufe24)
            Prog_Lok31.Interval = T_160
        ElseIf _Prog31 = 162 Then
            _eb.lokSteuern(31, Klassen.LokEigenschaften.Geschwindigkeit, Stufe23)
        ElseIf _Prog31 = 163 Then
            _eb.lokSteuern(31, Klassen.LokEigenschaften.Geschwindigkeit, Stufe22)
        ElseIf _Prog31 = 164 Then
            _eb.lokSteuern(31, Klassen.LokEigenschaften.Geschwindigkeit, Stufe21)
        ElseIf _Prog31 = 165 Then
            _eb.lokSteuern(31, Klassen.LokEigenschaften.Geschwindigkeit, Stufe2)
        ElseIf _Prog31 = 166 Then
            _eb.lokSteuern(31, Klassen.LokEigenschaften.Geschwindigkeit, 0)
        ElseIf _Prog31 = 167 Then
            Prog_Lok31.Interval = 2000
        ElseIf _Prog31 = 168 Then
            If _Fahrzeugbeleuchtung2 < 2 Then
                _eb.lokSteuern(31, Klassen.LokEigenschaften.Hauptfunktion, 0) ' Licht aus
            End If

            ' Rangierzug

        ElseIf _Prog31 = 180 Then
            _eb.lokSteuern(31, Klassen.LokEigenschaften.Geschwindigkeit, 2)
            Prog_Lok31.Interval = V_180
        ElseIf _Prog31 = 181 Then
            Prog_Lok31.Interval = T_180
            _eb.lokSteuern(31, Klassen.LokEigenschaften.Geschwindigkeit, 1)
        ElseIf _Prog31 = 182 Then
            _eb.lokSteuern(31, Klassen.LokEigenschaften.Geschwindigkeit, 0)

            ' Tunnelausfahrt

        ElseIf _Prog31 = 200 Then ' Kontakt 1.2 <- (bergauf)
            _eb.lokSteuern(31, Klassen.LokEigenschaften.Geschwindigkeit, G_200)
            Prog_Lok31.Interval = 2000
        ElseIf _Prog31 = 201 Then
        ElseIf _Prog31 = 202 Then
        ElseIf _Prog31 = 203 Then
        ElseIf _Prog31 = 204 Then
        ElseIf _Prog31 = 205 Then
            If Stufe4 < Stufe3 Then
                _eb.lokSteuern(31, Klassen.LokEigenschaften.Geschwindigkeit, Stufe3)
            Else
                _eb.lokSteuern(31, Klassen.LokEigenschaften.Geschwindigkeit, Stufe4)
            End If

        ElseIf _Prog31 = 220 Then ' Kontakt 3.1 -> (hinter dem Martinstor bergauf)
            Prog_Lok31.Interval = 2000
        ElseIf _Prog31 = 221 Then
        ElseIf _Prog31 = 222 Then

        ElseIf _Prog31 = 240 Then ' Kontakt 3.7 <- (hinter der Brücke bergauf)
            Prog_Lok31.Interval = 2000
        ElseIf _Prog31 = 241 Then
        ElseIf _Prog31 = 242 Then

        ElseIf _Prog31 = 260 Then ' Kontakt 3.3 (links bzw vor der Brücke)
            Prog_Lok31.Interval = 2000
        ElseIf _Prog31 = 261 Then
        ElseIf _Prog31 = 262 Then
            _eb.lokSteuern(31, Klassen.LokEigenschaften.Geschwindigkeit, Stufe3)

        ElseIf _Prog31 = 600 Then ' Kontakt 3.5 <- (unter der Burg)
            Prog_Lok31.Interval = 2000
        ElseIf _Prog31 = 601 Then
        ElseIf _Prog31 = 602 Then

        ElseIf _Prog31 = 620 Then ' Kontakt 3.7 -> (hinter der Brücke bergab)
            Prog_Lok31.Interval = 2000
        ElseIf _Prog31 = 621 Then
        ElseIf _Prog31 = 621 Then

        ElseIf _Prog31 = 640 Then ' Kontakt 3.1 <- Talfahrt
            Prog_Lok31.Interval = 2000
        ElseIf _Prog31 = 641 Then
        ElseIf _Prog31 = 642 Then

        ElseIf _Prog31 = 660 Then ' Kontakt 1.2 -> Talfahrt
            Prog_Lok31.Interval = 2000
        ElseIf _Prog31 = 661 Then
        ElseIf _Prog31 = 662 Then

        ElseIf _Prog31 = 700 Then ' Kontakt 0.4 <- Diagonale
            Prog_Lok31.Interval = 2000
        ElseIf _Prog31 = 701 Then
        ElseIf _Prog31 = 702 Then

            ' Zindelstein

        ElseIf _Prog31 = 500 Then
            Prog_Lok31.Interval = V_500
        ElseIf _Prog31 = 501 Then
            _eb.lokSteuern(31, Klassen.LokEigenschaften.Geschwindigkeit, Stufe24)
            Prog_Lok31.Interval = T_500
        ElseIf _Prog31 = 502 Then
            _eb.lokSteuern(31, Klassen.LokEigenschaften.Geschwindigkeit, Stufe23)
        ElseIf _Prog31 = 503 Then
            _eb.lokSteuern(31, Klassen.LokEigenschaften.Geschwindigkeit, Stufe22)
        ElseIf _Prog31 = 504 Then
            _eb.lokSteuern(31, Klassen.LokEigenschaften.Geschwindigkeit, Stufe21)
        ElseIf _Prog31 = 505 Then
            _eb.lokSteuern(31, Klassen.LokEigenschaften.Geschwindigkeit, Stufe2)
        ElseIf _Prog31 = 506 Then
            _eb.lokSteuern(31, Klassen.LokEigenschaften.Geschwindigkeit, 0)

        Else
            _Prog31 = 0
            Prog_Lok31.Stop()
            Prog_Lok31.Interval = 200
            If Betriebsart = 1 Then
                SetProgramCounterLabel1(String.Empty)
            Else
                SetProgramCounterLabel(String.Empty)
            End If
        End If
        _Prog31 = _Prog31 + 1
    End Sub
    Private Sub HandleTimerElapsed44(sender As System.Object, e As System.EventArgs) Handles Prog_Lok32.Elapsed

        '*** Fahrprogramm für Krokodil grün
        '*** Datum: 23.02.2020

        SetText(TextBox1, "E-Lok CE 6/8  13302                                                     IBS: xx.xx.xxxx - V3: 7")
        LoadImage(PictureBox1, "H:\\EB_Media\\LokFotos\\Baureihe_Krokodil_01.jpg")
        GeschwindikeitenSetzen(32)

        Dim Stufe1, Stufe2, Stufe3, Stufe4 As Integer
        Dim Stufe11, Stufe12, Stufe13, Stufe14, Stufe21, Stufe22, Stufe23, Stufe24 As Integer
        Dim V_100, V_130, V_160, V_180, V_500 As Integer
        Dim T_100, T_130, T_160, T_180, T_500 As Integer
        Dim G_200 As Integer

        T_100 = _Betriebsparameter.Fahrparameter(32, KlausEBspecific.Betriebsparameter.FahrparameterEnum.T_100)
        T_130 = _Betriebsparameter.Fahrparameter(32, KlausEBspecific.Betriebsparameter.FahrparameterEnum.T_130)
        T_160 = _Betriebsparameter.Fahrparameter(32, KlausEBspecific.Betriebsparameter.FahrparameterEnum.T_160)
        T_180 = _Betriebsparameter.Fahrparameter(32, KlausEBspecific.Betriebsparameter.FahrparameterEnum.T_180)
        T_500 = _Betriebsparameter.Fahrparameter(32, KlausEBspecific.Betriebsparameter.FahrparameterEnum.T_500)
        V_100 = _Betriebsparameter.Fahrparameter(32, KlausEBspecific.Betriebsparameter.FahrparameterEnum.V_100)
        V_130 = _Betriebsparameter.Fahrparameter(32, KlausEBspecific.Betriebsparameter.FahrparameterEnum.V_130)
        V_160 = _Betriebsparameter.Fahrparameter(32, KlausEBspecific.Betriebsparameter.FahrparameterEnum.V_160)
        V_180 = _Betriebsparameter.Fahrparameter(32, KlausEBspecific.Betriebsparameter.FahrparameterEnum.V_180)
        V_500 = _Betriebsparameter.Fahrparameter(32, KlausEBspecific.Betriebsparameter.FahrparameterEnum.V_500)
        G_200 = _Betriebsparameter.Fahrparameter(32, KlausEBspecific.Betriebsparameter.FahrparameterEnum.G_200)

        If A_StopB = 1 Then
            V_100 = 6000
        End If

        Stufe1 = _LokStufen.Holen(32, 1)
        Stufe2 = _LokStufen.Holen(32, 2)
        Stufe3 = _LokStufen.Holen(32, 3)
        Stufe4 = _LokStufen.Holen(32, 4)

        If Stufe2 = 1 Then
            T_100 = T_100
            T_130 = T_130
            T_160 = T_160
            V_180 = V_180
        ElseIf Stufe2 = 2 Then
            T_100 = T_100 + 300
            T_130 = T_130 + 300
            T_160 = T_160 + 300
            V_180 = V_180 + 500
        ElseIf Stufe2 = 3 Then
            T_100 = T_100 + 500
            T_130 = T_130 + 500
            T_160 = T_160 + 500
            V_180 = V_180 + 1000
        ElseIf Stufe2 = 4 Then
            T_100 = T_100 + 700
            T_130 = T_130 + 700
            T_160 = T_160 + 700
            V_180 = V_180 + 1500
        ElseIf Stufe2 = 5 Then
            T_100 = T_100 + 900
            T_130 = T_130 + 900
            T_160 = T_160 + 900
            V_180 = V_180 + 2000
        ElseIf Stufe2 = 6 Then
            T_100 = T_100 + 1200
            T_130 = T_130 + 1200
            T_160 = T_160 + 1200
            V_180 = V_180 + 2500
        Else
            T_100 = T_100 + 1200
            T_130 = T_130 + 1200
            T_160 = T_160 + 1200
            V_180 = V_180 + 2500
        End If

        Stufe2 = Stufe1

        Stufe11 = Stufe1 + 1
        If Stufe11 > Stufe3 Then
            Stufe11 = Stufe3
        End If
        Stufe12 = Stufe1 + 2
        If Stufe12 > Stufe3 Then
            Stufe12 = Stufe3
        End If
        Stufe13 = Stufe1 + 3
        If Stufe13 > Stufe3 Then
            Stufe13 = Stufe3
        End If
        Stufe14 = Stufe1 + 4
        If Stufe14 > Stufe3 Then
            Stufe14 = Stufe3
        End If

        Stufe21 = Stufe2 + 1
        If Stufe21 > Stufe3 Then
            Stufe21 = Stufe3
        End If
        Stufe22 = Stufe2 + 2
        If Stufe22 > Stufe3 Then
            Stufe22 = Stufe3
        End If
        Stufe23 = Stufe2 + 3
        If Stufe23 > Stufe3 Then
            Stufe23 = Stufe3
        End If
        Stufe24 = Stufe2 + 4
        If Stufe24 > Stufe3 Then
            Stufe24 = Stufe3
        End If
        If G_200 > 0 Then
            If G_200 < Stufe4 Then
                G_200 = Stufe4
            End If
        Else
            G_200 = Stufe4
        End If

        If Betriebsart = 1 And (_GlsL32 = 3 Or _GlsL32 = 4) Then
            SetProgramCounterLabel1(_Prog32)
        Else
            SetProgramCounterLabel(_Prog32)
        End If

        ' Lok starten - Bahnhofsausfahrt

        If _Prog32 = 0 Then
            Prog_Lok32.Interval = 2000
            If _Fahrzeugbeleuchtung2 > 0 Then
                _eb.lokSteuern(32, Klassen.LokEigenschaften.Hauptfunktion, 1) ' Licht ein
            End If
        ElseIf _Prog32 = 1 Then
        ElseIf _Prog32 = 2 Then
            _Betriebsparameter.RundenErhoehen(32)
        ElseIf _Prog32 = 3 Then
        ElseIf _Prog32 = 4 Then
        ElseIf _Prog32 = 5 Then
        ElseIf _Prog32 = 6 Then

            ' Bahnhofsausfahrt

        ElseIf _Prog32 = 7 Then
            _eb.lokSteuern(32, Klassen.LokEigenschaften.Geschwindigkeit, Stufe1)
        ElseIf _Prog32 = 8 Then
            _eb.lokSteuern(32, Klassen.LokEigenschaften.Geschwindigkeit, Stufe11)
        ElseIf _Prog32 = 9 Then
            _eb.lokSteuern(32, Klassen.LokEigenschaften.Geschwindigkeit, Stufe12)
        ElseIf _Prog32 = 10 Then
            _eb.lokSteuern(32, Klassen.LokEigenschaften.Geschwindigkeit, Stufe13)
        ElseIf _Prog32 = 11 Then
            _eb.lokSteuern(32, Klassen.LokEigenschaften.Geschwindigkeit, Stufe14)
        ElseIf _Prog32 = 12 Then
            _eb.lokSteuern(32, Klassen.LokEigenschaften.Geschwindigkeit, Stufe3)

            ' Lok abstellen

        ElseIf _Prog32 = 50 Then
            Prog_Lok32.Interval = 2000
        ElseIf _Prog32 = 51 Then
        ElseIf _Prog32 = 52 Then
            If _Fahrzeugbeleuchtung2 < 2 Then
                _eb.lokSteuern(32, Klassen.LokEigenschaften.Hauptfunktion, 0) ' Licht aus
            End If

            ' Lok bremsen (Bahnhofseinfahrt Normalzug von links und von rechts)

        ElseIf _Prog32 = 100 Then
            Prog_Lok32.Interval = V_100
        ElseIf _Prog32 = 101 Then
            _eb.lokSteuern(32, Klassen.LokEigenschaften.Geschwindigkeit, Stufe24)
            Prog_Lok32.Interval = T_100
        ElseIf _Prog32 = 102 Then
            _eb.lokSteuern(32, Klassen.LokEigenschaften.Geschwindigkeit, Stufe23)
        ElseIf _Prog32 = 103 Then
            _eb.lokSteuern(32, Klassen.LokEigenschaften.Geschwindigkeit, Stufe22)
        ElseIf _Prog32 = 104 Then
            _eb.lokSteuern(32, Klassen.LokEigenschaften.Geschwindigkeit, Stufe21)
        ElseIf _Prog32 = 105 Then
            _eb.lokSteuern(32, Klassen.LokEigenschaften.Geschwindigkeit, Stufe2)

            ' Lok bremsen (Bahnhofseinfahrt Kurzzug von links)

        ElseIf _Prog32 = 130 Then
            Prog_Lok32.Interval = V_130
        ElseIf _Prog32 = 131 Then
            _eb.lokSteuern(32, Klassen.LokEigenschaften.Geschwindigkeit, Stufe24)
            Prog_Lok32.Interval = T_130
        ElseIf _Prog32 = 132 Then
            _eb.lokSteuern(32, Klassen.LokEigenschaften.Geschwindigkeit, Stufe23)
        ElseIf _Prog32 = 133 Then
            _eb.lokSteuern(32, Klassen.LokEigenschaften.Geschwindigkeit, Stufe22)
        ElseIf _Prog32 = 134 Then
            _eb.lokSteuern(32, Klassen.LokEigenschaften.Geschwindigkeit, Stufe21)
        ElseIf _Prog32 = 135 Then
            _eb.lokSteuern(32, Klassen.LokEigenschaften.Geschwindigkeit, Stufe2)
        ElseIf _Prog32 = 136 Then
            _eb.lokSteuern(32, Klassen.LokEigenschaften.Geschwindigkeit, 0)
        ElseIf _Prog32 = 137 Then
            Prog_Lok32.Interval = 2000
        ElseIf _Prog32 = 138 Then
            If _Fahrzeugbeleuchtung2 < 2 Then
                _eb.lokSteuern(32, Klassen.LokEigenschaften.Hauptfunktion, 0) ' Licht aus
            End If


            ' Lok bremsen (Bahnhofseinfahrt Kurzzug von rechts)

        ElseIf _Prog32 = 160 Then
            Prog_Lok32.Interval = V_160
        ElseIf _Prog32 = 161 Then
            _eb.lokSteuern(32, Klassen.LokEigenschaften.Geschwindigkeit, Stufe24)
            Prog_Lok32.Interval = T_160
        ElseIf _Prog32 = 162 Then
            _eb.lokSteuern(32, Klassen.LokEigenschaften.Geschwindigkeit, Stufe23)
        ElseIf _Prog32 = 163 Then
            _eb.lokSteuern(32, Klassen.LokEigenschaften.Geschwindigkeit, Stufe22)
        ElseIf _Prog32 = 164 Then
            _eb.lokSteuern(32, Klassen.LokEigenschaften.Geschwindigkeit, Stufe21)
        ElseIf _Prog32 = 165 Then
            _eb.lokSteuern(32, Klassen.LokEigenschaften.Geschwindigkeit, Stufe2)
        ElseIf _Prog32 = 166 Then
            _eb.lokSteuern(32, Klassen.LokEigenschaften.Geschwindigkeit, 0)
        ElseIf _Prog32 = 167 Then
            Prog_Lok32.Interval = 2000
        ElseIf _Prog32 = 168 Then
            If _Fahrzeugbeleuchtung2 < 2 Then
                _eb.lokSteuern(32, Klassen.LokEigenschaften.Hauptfunktion, 0) ' Licht aus
            End If

            ' Rangierzug

        ElseIf _Prog32 = 180 Then
            _eb.lokSteuern(32, Klassen.LokEigenschaften.Geschwindigkeit, 2)
            Prog_Lok32.Interval = V_180
        ElseIf _Prog32 = 181 Then
            Prog_Lok32.Interval = T_180
            _eb.lokSteuern(32, Klassen.LokEigenschaften.Geschwindigkeit, 1)
        ElseIf _Prog32 = 182 Then
            _eb.lokSteuern(32, Klassen.LokEigenschaften.Geschwindigkeit, 0)

            ' Tunnelausfahrt

        ElseIf _Prog32 = 200 Then ' Kontakt 1.2 <- (bergauf)
            _eb.lokSteuern(32, Klassen.LokEigenschaften.Geschwindigkeit, G_200)
            Prog_Lok32.Interval = 2000
        ElseIf _Prog32 = 201 Then
        ElseIf _Prog32 = 202 Then
        ElseIf _Prog32 = 203 Then
        ElseIf _Prog32 = 204 Then
        ElseIf _Prog32 = 205 Then
            If Stufe4 < Stufe3 Then
                _eb.lokSteuern(32, Klassen.LokEigenschaften.Geschwindigkeit, Stufe3)
            Else
                _eb.lokSteuern(32, Klassen.LokEigenschaften.Geschwindigkeit, Stufe4)
            End If

        ElseIf _Prog32 = 220 Then ' Kontakt 3.1 -> (hinter dem Martinstor bergauf)
            Prog_Lok32.Interval = 2000
        ElseIf _Prog32 = 221 Then
        ElseIf _Prog32 = 222 Then

        ElseIf _Prog32 = 240 Then ' Kontakt 3.7 <- (hinter der Brücke bergauf)
            Prog_Lok32.Interval = 2000
        ElseIf _Prog32 = 241 Then
        ElseIf _Prog32 = 242 Then

        ElseIf _Prog32 = 260 Then ' Kontakt 3.3 (links bzw vor der Brücke)
            Prog_Lok32.Interval = 2000
        ElseIf _Prog32 = 261 Then
        ElseIf _Prog32 = 262 Then
            _eb.lokSteuern(32, Klassen.LokEigenschaften.Geschwindigkeit, Stufe3)

        ElseIf _Prog32 = 600 Then ' Kontakt 3.5 <- (unter der Burg)
            Prog_Lok32.Interval = 2000
        ElseIf _Prog32 = 601 Then
        ElseIf _Prog32 = 602 Then

        ElseIf _Prog32 = 620 Then ' Kontakt 3.7 -> (hinter der Brücke bergab)
            Prog_Lok32.Interval = 2000
        ElseIf _Prog32 = 621 Then
        ElseIf _Prog32 = 622 Then

        ElseIf _Prog32 = 640 Then ' Kontakt 3.1 <- Talfahrt
            Prog_Lok32.Interval = 2000
        ElseIf _Prog32 = 641 Then
        ElseIf _Prog32 = 642 Then

        ElseIf _Prog32 = 660 Then ' Kontakt 1.2 -> Talfahrt
            Prog_Lok32.Interval = 2000
        ElseIf _Prog32 = 661 Then
        ElseIf _Prog32 = 662 Then

        ElseIf _Prog32 = 700 Then ' Kontakt 0.4 <- Diagonale
            Prog_Lok32.Interval = 2000
        ElseIf _Prog32 = 701 Then
        ElseIf _Prog32 = 702 Then

            ' Zindelstein

        ElseIf _Prog32 = 500 Then
            Prog_Lok32.Interval = V_500
        ElseIf _Prog32 = 501 Then
            _eb.lokSteuern(32, Klassen.LokEigenschaften.Geschwindigkeit, Stufe23)
            Prog_Lok32.Interval = T_500
        ElseIf _Prog32 = 502 Then
            _eb.lokSteuern(32, Klassen.LokEigenschaften.Geschwindigkeit, Stufe22)
        ElseIf _Prog32 = 503 Then
            _eb.lokSteuern(32, Klassen.LokEigenschaften.Geschwindigkeit, Stufe21)
        ElseIf _Prog32 = 504 Then
            _eb.lokSteuern(32, Klassen.LokEigenschaften.Geschwindigkeit, Stufe2)
        ElseIf _Prog32 = 505 Then
            _eb.lokSteuern(32, Klassen.LokEigenschaften.Geschwindigkeit, 0)

        Else
            _Prog32 = 0
            Prog_Lok32.Stop()
            Prog_Lok32.Interval = 200
            If Betriebsart = 1 Then
                SetProgramCounterLabel1(String.Empty)
            Else
                SetProgramCounterLabel(String.Empty)
            End If
        End If
        _Prog32 = _Prog32 + 1
    End Sub
    Private Sub HandleTimerElapsed45(sender As System.Object, e As System.EventArgs) Handles Prog_Lok33.Elapsed

        '*** Fahrprogramm für Krokodil braun
        '*** Datum: 16.10.2023

        SetText(TextBox1, "E-Lok CE 6/8 14301                                                      IBS: xx.xx.xxxx - V3: 8")
        LoadImage(PictureBox1, "H:\\EB_Media\\LokFotos\\Baureihe_Krokodil_12.jpg")
        GeschwindikeitenSetzen(33)

        Dim Stufe1, Stufe2, Stufe3, Stufe4 As Integer
        Dim Stufe11, Stufe12, Stufe13, Stufe14, Stufe21, Stufe22, Stufe23, Stufe24 As Integer
        Dim V_100, V_130, V_160, V_180, V_500 As Integer
        Dim T_100, T_130, T_160, T_180, T_500 As Integer
        Dim G_200 As Integer

        T_100 = _Betriebsparameter.Fahrparameter(33, KlausEBspecific.Betriebsparameter.FahrparameterEnum.T_100)
        T_130 = _Betriebsparameter.Fahrparameter(33, KlausEBspecific.Betriebsparameter.FahrparameterEnum.T_130)
        T_160 = _Betriebsparameter.Fahrparameter(33, KlausEBspecific.Betriebsparameter.FahrparameterEnum.T_160)
        T_180 = _Betriebsparameter.Fahrparameter(33, KlausEBspecific.Betriebsparameter.FahrparameterEnum.T_180)
        T_500 = _Betriebsparameter.Fahrparameter(33, KlausEBspecific.Betriebsparameter.FahrparameterEnum.T_500)
        V_100 = _Betriebsparameter.Fahrparameter(33, KlausEBspecific.Betriebsparameter.FahrparameterEnum.V_100)
        V_130 = _Betriebsparameter.Fahrparameter(33, KlausEBspecific.Betriebsparameter.FahrparameterEnum.V_130)
        V_160 = _Betriebsparameter.Fahrparameter(33, KlausEBspecific.Betriebsparameter.FahrparameterEnum.V_160)
        V_180 = _Betriebsparameter.Fahrparameter(33, KlausEBspecific.Betriebsparameter.FahrparameterEnum.V_180)
        V_500 = _Betriebsparameter.Fahrparameter(33, KlausEBspecific.Betriebsparameter.FahrparameterEnum.V_500)
        G_200 = _Betriebsparameter.Fahrparameter(33, KlausEBspecific.Betriebsparameter.FahrparameterEnum.G_200)

        If A_StopB = 1 Then
            V_100 = 6000
        End If

        Stufe1 = _LokStufen.Holen(33, 1)
        Stufe2 = _LokStufen.Holen(33, 2)
        Stufe3 = _LokStufen.Holen(33, 3)
        Stufe4 = _LokStufen.Holen(33, 4)

        If Stufe2 = 1 Then
            T_100 = T_100
            T_130 = T_130
            T_160 = T_160
            V_180 = V_180
        ElseIf Stufe2 = 2 Then
            T_100 = T_100 + 300
            T_130 = T_130 + 300
            T_160 = T_160 + 300
            V_180 = V_180 + 500
        ElseIf Stufe2 = 3 Then
            T_100 = T_100 + 500
            T_130 = T_130 + 500
            T_160 = T_160 + 500
            V_180 = V_180 + 1000
        ElseIf Stufe2 = 4 Then
            T_100 = T_100 + 700
            T_130 = T_130 + 700
            T_160 = T_160 + 700
            V_180 = V_180 + 1500
        ElseIf Stufe2 = 5 Then
            T_100 = T_100 + 900
            T_130 = T_130 + 900
            T_160 = T_160 + 900
            V_180 = V_180 + 2000
        ElseIf Stufe2 = 6 Then
            T_100 = T_100 + 1200
            T_130 = T_130 + 1200
            T_160 = T_160 + 1200
            V_180 = V_180 + 2500
        Else
            T_100 = T_100 + 1200
            T_130 = T_130 + 1200
            T_160 = T_160 + 1200
            V_180 = V_180 + 2500
        End If

        Stufe2 = Stufe1

        Stufe11 = Stufe1 + 1
        If Stufe11 > Stufe3 Then
            Stufe11 = Stufe3
        End If
        Stufe12 = Stufe1 + 2
        If Stufe12 > Stufe3 Then
            Stufe12 = Stufe3
        End If
        Stufe13 = Stufe1 + 3
        If Stufe13 > Stufe3 Then
            Stufe13 = Stufe3
        End If
        Stufe14 = Stufe1 + 4
        If Stufe14 > Stufe3 Then
            Stufe14 = Stufe3
        End If

        Stufe21 = Stufe2 + 1
        If Stufe21 > Stufe3 Then
            Stufe21 = Stufe3
        End If
        Stufe22 = Stufe2 + 2
        If Stufe22 > Stufe3 Then
            Stufe22 = Stufe3
        End If
        Stufe23 = Stufe2 + 3
        If Stufe23 > Stufe3 Then
            Stufe23 = Stufe3
        End If
        Stufe24 = Stufe2 + 4
        If Stufe24 > Stufe3 Then
            Stufe24 = Stufe3
        End If
        If G_200 > 0 Then
            If G_200 < Stufe4 Then
                G_200 = Stufe4
            End If
        Else
            G_200 = Stufe4
        End If

        If Betriebsart = 1 And (_GlsL33 = 3 Or _GlsL33 = 4) Then
            SetProgramCounterLabel1(_Prog33)
        Else
            SetProgramCounterLabel(_Prog33)
        End If

        ' Lok starten - Bahnhofsausfahrt

        If _Prog33 = 0 Then
            Prog_Lok33.Interval = 2000
            If _Fahrzeugbeleuchtung2 > 0 Then
                _eb.lokSteuern(33, Klassen.LokEigenschaften.Hauptfunktion, 1) ' Licht ein
            End If
        ElseIf _Prog33 = 1 Then
        ElseIf _Prog33 = 2 Then
            _Betriebsparameter.RundenErhoehen(33)
        ElseIf _Prog33 = 3 Then
        ElseIf _Prog33 = 4 Then
        ElseIf _Prog33 = 5 Then
        ElseIf _Prog33 = 6 Then

            ' Bahnhofsausfahrt

        ElseIf _Prog33 = 7 Then
            _eb.lokSteuern(33, Klassen.LokEigenschaften.Geschwindigkeit, Stufe1)
        ElseIf _Prog33 = 8 Then
            _eb.lokSteuern(33, Klassen.LokEigenschaften.Geschwindigkeit, Stufe11)
        ElseIf _Prog33 = 9 Then
            _eb.lokSteuern(33, Klassen.LokEigenschaften.Geschwindigkeit, Stufe12)
        ElseIf _Prog33 = 10 Then
            _eb.lokSteuern(33, Klassen.LokEigenschaften.Geschwindigkeit, Stufe13)
        ElseIf _Prog33 = 11 Then
            _eb.lokSteuern(33, Klassen.LokEigenschaften.Geschwindigkeit, Stufe14)
        ElseIf _Prog33 = 12 Then
            _eb.lokSteuern(33, Klassen.LokEigenschaften.Geschwindigkeit, Stufe3)

            ' Lok abstellen

        ElseIf _Prog33 = 50 Then
            Prog_Lok33.Interval = 2000
        ElseIf _Prog33 = 51 Then
        ElseIf _Prog33 = 52 Then
            If _Fahrzeugbeleuchtung2 < 2 Then
                _eb.lokSteuern(33, Klassen.LokEigenschaften.Hauptfunktion, 0) ' Licht aus
            End If

            ' Lok bremsen (Bahnhofseinfahrt Normalzug von links und von rechts)

        ElseIf _Prog33 = 100 Then
            Prog_Lok33.Interval = V_100
        ElseIf _Prog33 = 101 Then
            _eb.lokSteuern(33, Klassen.LokEigenschaften.Geschwindigkeit, Stufe24)
            Prog_Lok33.Interval = T_100
        ElseIf _Prog33 = 102 Then
            _eb.lokSteuern(33, Klassen.LokEigenschaften.Geschwindigkeit, Stufe23)
        ElseIf _Prog33 = 103 Then
            _eb.lokSteuern(33, Klassen.LokEigenschaften.Geschwindigkeit, Stufe22)
        ElseIf _Prog33 = 104 Then
            _eb.lokSteuern(33, Klassen.LokEigenschaften.Geschwindigkeit, Stufe21)
        ElseIf _Prog33 = 105 Then
            _eb.lokSteuern(33, Klassen.LokEigenschaften.Geschwindigkeit, Stufe2)

            ' Lok bremsen (Bahnhofseinfahrt Kurzzug von links)

        ElseIf _Prog33 = 130 Then
            Prog_Lok33.Interval = V_130
        ElseIf _Prog33 = 131 Then
            _eb.lokSteuern(33, Klassen.LokEigenschaften.Geschwindigkeit, Stufe24)
            Prog_Lok33.Interval = T_130
        ElseIf _Prog33 = 132 Then
            _eb.lokSteuern(33, Klassen.LokEigenschaften.Geschwindigkeit, Stufe23)
        ElseIf _Prog33 = 133 Then
            _eb.lokSteuern(33, Klassen.LokEigenschaften.Geschwindigkeit, Stufe22)
        ElseIf _Prog33 = 134 Then
            _eb.lokSteuern(33, Klassen.LokEigenschaften.Geschwindigkeit, Stufe21)
        ElseIf _Prog33 = 135 Then
            _eb.lokSteuern(33, Klassen.LokEigenschaften.Geschwindigkeit, Stufe2)
        ElseIf _Prog33 = 136 Then
            _eb.lokSteuern(33, Klassen.LokEigenschaften.Geschwindigkeit, 0)
        ElseIf _Prog33 = 137 Then
            Prog_Lok33.Interval = 2000
        ElseIf _Prog33 = 138 Then
            If _Fahrzeugbeleuchtung2 < 2 Then
                _eb.lokSteuern(33, Klassen.LokEigenschaften.Hauptfunktion, 0) ' Licht aus
            End If

            ' Lok bremsen (Bahnhofseinfahrt Kurzzug von rechts)

        ElseIf _Prog33 = 160 Then
            Prog_Lok33.Interval = V_160
        ElseIf _Prog33 = 161 Then
            _eb.lokSteuern(33, Klassen.LokEigenschaften.Geschwindigkeit, Stufe24)
            Prog_Lok33.Interval = T_160
        ElseIf _Prog33 = 162 Then
            _eb.lokSteuern(33, Klassen.LokEigenschaften.Geschwindigkeit, Stufe23)
        ElseIf _Prog33 = 163 Then
            _eb.lokSteuern(33, Klassen.LokEigenschaften.Geschwindigkeit, Stufe22)
        ElseIf _Prog33 = 164 Then
            _eb.lokSteuern(33, Klassen.LokEigenschaften.Geschwindigkeit, Stufe21)
        ElseIf _Prog33 = 165 Then
            _eb.lokSteuern(33, Klassen.LokEigenschaften.Geschwindigkeit, Stufe2)
        ElseIf _Prog33 = 166 Then
            _eb.lokSteuern(33, Klassen.LokEigenschaften.Geschwindigkeit, 0)
        ElseIf _Prog33 = 167 Then
            Prog_Lok33.Interval = 2000
        ElseIf _Prog33 = 168 Then
            If _Fahrzeugbeleuchtung2 < 2 Then
                _eb.lokSteuern(33, Klassen.LokEigenschaften.Hauptfunktion, 0) ' Licht aus
            End If

            ' Rangierzug

        ElseIf _Prog33 = 180 Then
            _eb.lokSteuern(33, Klassen.LokEigenschaften.Geschwindigkeit, 2)
            Prog_Lok33.Interval = V_180
        ElseIf _Prog33 = 181 Then
            Prog_Lok33.Interval = T_180
            _eb.lokSteuern(33, Klassen.LokEigenschaften.Geschwindigkeit, 1)
        ElseIf _Prog33 = 182 Then
            _eb.lokSteuern(33, Klassen.LokEigenschaften.Geschwindigkeit, 0)

            ' Tunnelausfahrt

        ElseIf _Prog33 = 200 Then ' Kontakt 1.2 <- (bergauf)
            _eb.lokSteuern(33, Klassen.LokEigenschaften.Geschwindigkeit, G_200)
            Prog_Lok33.Interval = 2000
        ElseIf _Prog33 = 201 Then
        ElseIf _Prog33 = 202 Then
        ElseIf _Prog33 = 203 Then
        ElseIf _Prog33 = 204 Then
        ElseIf _Prog33 = 205 Then
            If Stufe4 < Stufe3 Then
                _eb.lokSteuern(33, Klassen.LokEigenschaften.Geschwindigkeit, Stufe3)
            Else
                _eb.lokSteuern(33, Klassen.LokEigenschaften.Geschwindigkeit, Stufe4)
            End If

        ElseIf _Prog33 = 220 Then ' Kontakt 3.1 -> (hinter dem Martinstor bergauf)
            Prog_Lok33.Interval = 2000
        ElseIf _Prog33 = 221 Then
        ElseIf _Prog33 = 222 Then

        ElseIf _Prog33 = 240 Then ' Kontakt 3.7 <- (hinter der Brücke bergauf)
            Prog_Lok33.Interval = 2000
        ElseIf _Prog33 = 241 Then
        ElseIf _Prog33 = 242 Then

        ElseIf _Prog33 = 260 Then ' Kontakt 3.3 (links bzw vor der Brücke)
            Prog_Lok33.Interval = 2000
        ElseIf _Prog33 = 261 Then
        ElseIf _Prog33 = 262 Then
            _eb.lokSteuern(33, Klassen.LokEigenschaften.Geschwindigkeit, Stufe3)

        ElseIf _Prog33 = 600 Then ' Kontakt 3.5 <- (unter der Burg)
            Prog_Lok33.Interval = 2000
        ElseIf _Prog33 = 601 Then
        ElseIf _Prog33 = 602 Then

        ElseIf _Prog33 = 620 Then ' Kontakt 3.7 -> (hinter der Brücke bergab)
            Prog_Lok33.Interval = 2000
        ElseIf _Prog33 = 621 Then
        ElseIf _Prog33 = 622 Then

        ElseIf _Prog33 = 640 Then ' Kontakt 3.1 <- Talfahrt
            Prog_Lok33.Interval = 2000
        ElseIf _Prog33 = 641 Then
        ElseIf _Prog33 = 642 Then

        ElseIf _Prog33 = 660 Then ' Kontakt 1.2 -> Talfahrt
            Prog_Lok33.Interval = 2000
        ElseIf _Prog33 = 661 Then
        ElseIf _Prog33 = 662 Then

        ElseIf _Prog33 = 700 Then ' Kontakt 0.4 <- Diagonale
            Prog_Lok33.Interval = 2000
        ElseIf _Prog33 = 701 Then
        ElseIf _Prog33 = 702 Then

            ' Zindelstein

        ElseIf _Prog33 = 500 Then
            Prog_Lok33.Interval = V_500
        ElseIf _Prog33 = 501 Then
            _eb.lokSteuern(33, Klassen.LokEigenschaften.Geschwindigkeit, Stufe23)
            Prog_Lok33.Interval = T_500
        ElseIf _Prog33 = 502 Then
            _eb.lokSteuern(33, Klassen.LokEigenschaften.Geschwindigkeit, Stufe22)
        ElseIf _Prog33 = 503 Then
            _eb.lokSteuern(33, Klassen.LokEigenschaften.Geschwindigkeit, Stufe21)
        ElseIf _Prog33 = 504 Then
            _eb.lokSteuern(33, Klassen.LokEigenschaften.Geschwindigkeit, Stufe2)
        ElseIf _Prog33 = 505 Then
            _eb.lokSteuern(33, Klassen.LokEigenschaften.Geschwindigkeit, 0)


        Else
            _Prog33 = 0
            Prog_Lok33.Stop()
            Prog_Lok33.Interval = 200
            If Betriebsart = 1 Then
                SetProgramCounterLabel1(String.Empty)
            Else
                SetProgramCounterLabel(String.Empty)
            End If
        End If
        _Prog33 = _Prog33 + 1
    End Sub
    Private Sub HandleTimerElapsed46(sender As System.Object, e As System.EventArgs) Handles Prog_Lok34.Elapsed

        '*** Fahrprogramm für E-Lok 191 099-1
        '*** Datum: 23.02.2020

        SetText(TextBox1, "E-Lok 191 099-1                                                         IBS: 10.09.2025 - V3 : 8")
        LoadImage(PictureBox1, "H:\\EB_Media\\LokFotos\\Baureihe_191_01.jpg")
        GeschwindikeitenSetzen(34)

        Dim Stufe1, Stufe2, Stufe3, Stufe4 As Integer
        Dim Stufe11, Stufe12, Stufe13, Stufe14, Stufe21, Stufe22, Stufe23, Stufe24 As Integer
        Dim V_100, V_130, V_160, V_180, V_500 As Integer
        Dim T_100, T_130, T_160, T_180, T_500 As Integer
        Dim G_200 As Integer

        T_100 = _Betriebsparameter.Fahrparameter(34, KlausEBspecific.Betriebsparameter.FahrparameterEnum.T_100)
        T_130 = _Betriebsparameter.Fahrparameter(34, KlausEBspecific.Betriebsparameter.FahrparameterEnum.T_130)
        T_160 = _Betriebsparameter.Fahrparameter(34, KlausEBspecific.Betriebsparameter.FahrparameterEnum.T_160)
        T_180 = _Betriebsparameter.Fahrparameter(34, KlausEBspecific.Betriebsparameter.FahrparameterEnum.T_180)
        T_500 = _Betriebsparameter.Fahrparameter(34, KlausEBspecific.Betriebsparameter.FahrparameterEnum.T_500)
        V_100 = _Betriebsparameter.Fahrparameter(34, KlausEBspecific.Betriebsparameter.FahrparameterEnum.V_100)
        V_130 = _Betriebsparameter.Fahrparameter(34, KlausEBspecific.Betriebsparameter.FahrparameterEnum.V_130)
        V_160 = _Betriebsparameter.Fahrparameter(34, KlausEBspecific.Betriebsparameter.FahrparameterEnum.V_160)
        V_180 = _Betriebsparameter.Fahrparameter(34, KlausEBspecific.Betriebsparameter.FahrparameterEnum.V_180)
        V_500 = _Betriebsparameter.Fahrparameter(34, KlausEBspecific.Betriebsparameter.FahrparameterEnum.V_500)
        G_200 = _Betriebsparameter.Fahrparameter(34, KlausEBspecific.Betriebsparameter.FahrparameterEnum.G_200)

        If A_StopB = 1 Then
            V_100 = 8000
        End If

        Stufe1 = _LokStufen.Holen(34, 1)
        Stufe2 = _LokStufen.Holen(34, 2)
        Stufe3 = _LokStufen.Holen(34, 3)
        Stufe4 = _LokStufen.Holen(34, 4)

        If Stufe2 = 1 Then
            T_100 = T_100
            T_130 = T_130
            T_160 = T_160
            V_180 = V_180
        ElseIf Stufe2 = 2 Then
            T_100 = T_100 + 300
            T_130 = T_130 + 300
            T_160 = T_160 + 300
            V_180 = V_180 + 500
        ElseIf Stufe2 = 3 Then
            T_100 = T_100 + 500
            T_130 = T_130 + 500
            T_160 = T_160 + 500
            V_180 = V_180 + 1000
        ElseIf Stufe2 = 4 Then
            T_100 = T_100 + 700
            T_130 = T_130 + 700
            T_160 = T_160 + 700
            V_180 = V_180 + 1500
        ElseIf Stufe2 = 5 Then
            T_100 = T_100 + 900
            T_130 = T_130 + 900
            T_160 = T_160 + 900
            V_180 = V_180 + 2000
        ElseIf Stufe2 = 6 Then
            T_100 = T_100 + 1200
            T_130 = T_130 + 1200
            T_160 = T_160 + 1200
            V_180 = V_180 + 2500
        Else
            T_100 = T_100 + 1200
            T_130 = T_130 + 1200
            T_160 = T_160 + 1200
            V_180 = V_180 + 2500
        End If

        Stufe2 = Stufe1

        Stufe11 = Stufe1 + 1
        If Stufe11 > Stufe3 Then
            Stufe11 = Stufe3
        End If
        Stufe12 = Stufe1 + 2
        If Stufe12 > Stufe3 Then
            Stufe12 = Stufe3
        End If
        Stufe13 = Stufe1 + 3
        If Stufe13 > Stufe3 Then
            Stufe13 = Stufe3
        End If
        Stufe14 = Stufe1 + 4
        If Stufe14 > Stufe3 Then
            Stufe14 = Stufe3
        End If

        Stufe21 = Stufe2 + 1
        If Stufe21 > Stufe3 Then
            Stufe21 = Stufe3
        End If
        Stufe22 = Stufe2 + 2
        If Stufe22 > Stufe3 Then
            Stufe22 = Stufe3
        End If
        Stufe23 = Stufe2 + 3
        If Stufe23 > Stufe3 Then
            Stufe23 = Stufe3
        End If
        Stufe24 = Stufe2 + 4
        If Stufe24 > Stufe3 Then
            Stufe24 = Stufe3
        End If
        If G_200 > 0 Then
            If G_200 < Stufe4 Then
                G_200 = Stufe4
            End If
        Else
            G_200 = Stufe4
        End If

        If Betriebsart = 1 And (_GlsL34 = 3 Or _GlsL34 = 4) Then
            SetProgramCounterLabel1(_Prog34)
        Else
            SetProgramCounterLabel(_Prog34)
        End If

        ' Lok starten - Bahnhofsausfahrt

        If _Prog34 = 0 Then
            Prog_Lok34.Interval = 2000
            If _Fahrzeugbeleuchtung2 > 0 Then
                _eb.lokSteuern(34, Klassen.LokEigenschaften.Hauptfunktion, 1) ' Licht ein
            End If
        ElseIf _Prog34 = 1 Then
        ElseIf _Prog34 = 2 Then
            _Betriebsparameter.RundenErhoehen(34)
        ElseIf _Prog34 = 3 Then
        ElseIf _Prog34 = 4 Then
        ElseIf _Prog34 = 5 Then
        ElseIf _Prog34 = 6 Then

            ' Bahnhofsausfahrt

        ElseIf _Prog34 = 7 Then
            _eb.lokSteuern(34, Klassen.LokEigenschaften.Geschwindigkeit, Stufe1)
        ElseIf _Prog34 = 8 Then
            _eb.lokSteuern(34, Klassen.LokEigenschaften.Geschwindigkeit, Stufe11)
        ElseIf _Prog34 = 9 Then
            _eb.lokSteuern(34, Klassen.LokEigenschaften.Geschwindigkeit, Stufe12)
        ElseIf _Prog34 = 10 Then
            _eb.lokSteuern(34, Klassen.LokEigenschaften.Geschwindigkeit, Stufe13)
        ElseIf _Prog34 = 11 Then
            _eb.lokSteuern(34, Klassen.LokEigenschaften.Geschwindigkeit, Stufe14)
        ElseIf _Prog34 = 12 Then
            _eb.lokSteuern(34, Klassen.LokEigenschaften.Geschwindigkeit, Stufe3)

            ' Lok abstellen

        ElseIf _Prog34 = 50 Then
            Prog_Lok34.Interval = 2000
        ElseIf _Prog34 = 51 Then
        ElseIf _Prog34 = 52 Then
            If _Fahrzeugbeleuchtung2 < 2 Then
                _eb.lokSteuern(34, Klassen.LokEigenschaften.Hauptfunktion, 0) ' Licht aus
            End If

            ' Lok bremsen (Bahnhofseinfahrt Normalzug von links und von rechts)

        ElseIf _Prog34 = 100 Then
            Prog_Lok34.Interval = V_100
        ElseIf _Prog34 = 101 Then
            _eb.lokSteuern(34, Klassen.LokEigenschaften.Geschwindigkeit, Stufe24)
            Prog_Lok34.Interval = T_100
        ElseIf _Prog34 = 102 Then
            _eb.lokSteuern(34, Klassen.LokEigenschaften.Geschwindigkeit, Stufe23)
        ElseIf _Prog34 = 103 Then
            _eb.lokSteuern(34, Klassen.LokEigenschaften.Geschwindigkeit, Stufe22)
        ElseIf _Prog34 = 104 Then
            _eb.lokSteuern(34, Klassen.LokEigenschaften.Geschwindigkeit, Stufe21)
        ElseIf _Prog34 = 105 Then
            _eb.lokSteuern(34, Klassen.LokEigenschaften.Geschwindigkeit, Stufe2)

            ' Lok bremsen (Bahnhofseinfahrt Kurzzug von links)

        ElseIf _Prog34 = 130 Then
            Prog_Lok34.Interval = V_130
        ElseIf _Prog34 = 131 Then
            _eb.lokSteuern(34, Klassen.LokEigenschaften.Geschwindigkeit, Stufe24)
            Prog_Lok34.Interval = T_130
        ElseIf _Prog34 = 132 Then
            _eb.lokSteuern(34, Klassen.LokEigenschaften.Geschwindigkeit, Stufe23)
        ElseIf _Prog34 = 133 Then
            _eb.lokSteuern(34, Klassen.LokEigenschaften.Geschwindigkeit, Stufe22)
        ElseIf _Prog34 = 134 Then
            _eb.lokSteuern(34, Klassen.LokEigenschaften.Geschwindigkeit, Stufe21)
        ElseIf _Prog34 = 135 Then
            _eb.lokSteuern(34, Klassen.LokEigenschaften.Geschwindigkeit, Stufe2)
        ElseIf _Prog34 = 136 Then
            _eb.lokSteuern(34, Klassen.LokEigenschaften.Geschwindigkeit, 0)
        ElseIf _Prog34 = 137 Then
            Prog_Lok34.Interval = 2000
        ElseIf _Prog34 = 138 Then
            If _Fahrzeugbeleuchtung2 < 2 Then
                _eb.lokSteuern(34, Klassen.LokEigenschaften.Hauptfunktion, 0) ' Licht aus
            End If

            ' Lok bremsen (Bahnhofseinfahrt Kurzzug von rechts)

        ElseIf _Prog34 = 160 Then
            Prog_Lok34.Interval = V_160
        ElseIf _Prog34 = 161 Then
            _eb.lokSteuern(34, Klassen.LokEigenschaften.Geschwindigkeit, Stufe24)
            Prog_Lok34.Interval = T_160
        ElseIf _Prog34 = 162 Then
            _eb.lokSteuern(34, Klassen.LokEigenschaften.Geschwindigkeit, Stufe23)
        ElseIf _Prog34 = 163 Then
            _eb.lokSteuern(34, Klassen.LokEigenschaften.Geschwindigkeit, Stufe22)
        ElseIf _Prog34 = 164 Then
            _eb.lokSteuern(34, Klassen.LokEigenschaften.Geschwindigkeit, Stufe21)
        ElseIf _Prog34 = 165 Then
            _eb.lokSteuern(34, Klassen.LokEigenschaften.Geschwindigkeit, Stufe2)
        ElseIf _Prog34 = 166 Then
            _eb.lokSteuern(34, Klassen.LokEigenschaften.Geschwindigkeit, 0)
        ElseIf _Prog34 = 167 Then
            Prog_Lok34.Interval = 2000
        ElseIf _Prog34 = 168 Then
            If _Fahrzeugbeleuchtung2 < 2 Then
                _eb.lokSteuern(34, Klassen.LokEigenschaften.Hauptfunktion, 0) ' Licht aus
            End If

            ' Rangierzug

        ElseIf _Prog34 = 180 Then
            _eb.lokSteuern(34, Klassen.LokEigenschaften.Geschwindigkeit, 2)
            Prog_Lok34.Interval = V_180
        ElseIf _Prog34 = 181 Then
            Prog_Lok34.Interval = T_180
            _eb.lokSteuern(34, Klassen.LokEigenschaften.Geschwindigkeit, 1)
        ElseIf _Prog34 = 182 Then
            _eb.lokSteuern(34, Klassen.LokEigenschaften.Geschwindigkeit, 0)

            ' Tunnelausfahrt

        ElseIf _Prog34 = 200 Then ' Kontakt 1.2 <- (bergauf)
            _eb.lokSteuern(34, Klassen.LokEigenschaften.Geschwindigkeit, G_200)
            Prog_Lok34.Interval = 2000
        ElseIf _Prog34 = 201 Then
        ElseIf _Prog34 = 202 Then
        ElseIf _Prog34 = 203 Then
        ElseIf _Prog34 = 204 Then
        ElseIf _Prog34 = 205 Then
            If Stufe4 < Stufe3 Then
                _eb.lokSteuern(34, Klassen.LokEigenschaften.Geschwindigkeit, Stufe3)
            Else
                _eb.lokSteuern(34, Klassen.LokEigenschaften.Geschwindigkeit, Stufe4)
            End If

        ElseIf _Prog34 = 220 Then ' Kontakt 3.1 -> (hinter dem Martinstor bergauf)
            Prog_Lok34.Interval = 2000
        ElseIf _Prog34 = 221 Then
        ElseIf _Prog34 = 222 Then

        ElseIf _Prog34 = 240 Then ' Kontakt 3.7 <- (hinter der Brücke bergauf)
            Prog_Lok34.Interval = 2000
        ElseIf _Prog34 = 241 Then
        ElseIf _Prog34 = 242 Then

        ElseIf _Prog34 = 260 Then ' Kontakt 3.3 (links bzw vor der Brücke)
            Prog_Lok34.Interval = 2000
        ElseIf _Prog34 = 261 Then
        ElseIf _Prog34 = 262 Then
            _eb.lokSteuern(34, Klassen.LokEigenschaften.Geschwindigkeit, Stufe3)

        ElseIf _Prog34 = 600 Then ' Kontakt 3.5 <- (unter der Burg)
            Prog_Lok34.Interval = 2000
        ElseIf _Prog34 = 601 Then
        ElseIf _Prog34 = 602 Then

        ElseIf _Prog34 = 620 Then ' Kontakt 3.7 -> (hinter der Brücke bergab)
            Prog_Lok34.Interval = 2000
        ElseIf _Prog34 = 621 Then
        ElseIf _Prog34 = 622 Then

        ElseIf _Prog34 = 640 Then ' Kontakt 3.1 <- Talfahrt
            Prog_Lok34.Interval = 2000
        ElseIf _Prog34 = 641 Then
        ElseIf _Prog34 = 642 Then

        ElseIf _Prog34 = 660 Then ' Kontakt 1.2 -> Talfahrt
            Prog_Lok34.Interval = 2000
        ElseIf _Prog34 = 661 Then
        ElseIf _Prog34 = 662 Then

        ElseIf _Prog34 = 700 Then ' Kontakt 0.4 <- Diagonale
            Prog_Lok34.Interval = 2000
        ElseIf _Prog34 = 701 Then
        ElseIf _Prog34 = 702 Then

            ' Zindelstein

        ElseIf _Prog34 = 500 Then
            Prog_Lok34.Interval = V_500
        ElseIf _Prog34 = 501 Then
            _eb.lokSteuern(34, Klassen.LokEigenschaften.Geschwindigkeit, Stufe23)
            Prog_Lok34.Interval = T_500
        ElseIf _Prog34 = 502 Then
            _eb.lokSteuern(34, Klassen.LokEigenschaften.Geschwindigkeit, Stufe22)
        ElseIf _Prog34 = 503 Then
            _eb.lokSteuern(34, Klassen.LokEigenschaften.Geschwindigkeit, Stufe21)
        ElseIf _Prog34 = 504 Then
            _eb.lokSteuern(34, Klassen.LokEigenschaften.Geschwindigkeit, Stufe2)
        ElseIf _Prog34 = 505 Then
            _eb.lokSteuern(34, Klassen.LokEigenschaften.Geschwindigkeit, 0)

        Else
            _Prog34 = 0
            Prog_Lok34.Interval = 200
            Prog_Lok34.Stop()
            If Betriebsart = 1 Then
                SetProgramCounterLabel1(String.Empty)
            Else
                SetProgramCounterLabel(String.Empty)
            End If
        End If
        _Prog34 = _Prog34 + 1
    End Sub
    Private Sub HandleTimerElapsed47(sender As System.Object, e As System.EventArgs) Handles Prog_Lok35.Elapsed

        '*** Fahrprogramm für E-Lok 44 039
        '*** Datum: 23.02.2020

        SetText(TextBox1, "E-Lok 44 039                                                            IBS: xx.xx.xxxx - V3:y ")
        LoadImage(PictureBox1, "H:\\EB_Media\\LokFotos\\Baureihe_144_11.jpg")
        GeschwindikeitenSetzen(35)

        Dim Stufe1, Stufe2, Stufe3, Stufe4 As Integer
        Dim Stufe11, Stufe12, Stufe13, Stufe14, Stufe21, Stufe22, Stufe23, Stufe24 As Integer
        Dim V_100, V_130, V_160, V_180, V_500 As Integer
        Dim T_100, T_130, T_160, T_180, T_500 As Integer
        Dim G_200 As Integer

        T_100 = _Betriebsparameter.Fahrparameter(35, KlausEBspecific.Betriebsparameter.FahrparameterEnum.T_100)
        T_130 = _Betriebsparameter.Fahrparameter(35, KlausEBspecific.Betriebsparameter.FahrparameterEnum.T_130)
        T_160 = _Betriebsparameter.Fahrparameter(35, KlausEBspecific.Betriebsparameter.FahrparameterEnum.T_160)
        T_180 = _Betriebsparameter.Fahrparameter(35, KlausEBspecific.Betriebsparameter.FahrparameterEnum.T_180)
        T_500 = _Betriebsparameter.Fahrparameter(35, KlausEBspecific.Betriebsparameter.FahrparameterEnum.T_500)
        V_100 = _Betriebsparameter.Fahrparameter(35, KlausEBspecific.Betriebsparameter.FahrparameterEnum.V_100)
        V_130 = _Betriebsparameter.Fahrparameter(35, KlausEBspecific.Betriebsparameter.FahrparameterEnum.V_130)
        V_160 = _Betriebsparameter.Fahrparameter(35, KlausEBspecific.Betriebsparameter.FahrparameterEnum.V_160)
        V_180 = _Betriebsparameter.Fahrparameter(35, KlausEBspecific.Betriebsparameter.FahrparameterEnum.V_180)
        V_500 = _Betriebsparameter.Fahrparameter(35, KlausEBspecific.Betriebsparameter.FahrparameterEnum.V_500)
        G_200 = _Betriebsparameter.Fahrparameter(35, KlausEBspecific.Betriebsparameter.FahrparameterEnum.G_200)

        If A_StopB = 1 Then
            V_100 = 6000
        End If

        Stufe1 = _LokStufen.Holen(35, 1)
        Stufe2 = _LokStufen.Holen(35, 2)
        Stufe3 = _LokStufen.Holen(35, 3)
        Stufe4 = _LokStufen.Holen(35, 4)

        If Stufe2 = 1 Then
            T_100 = T_100
            T_130 = T_130
            T_160 = T_160
            V_180 = V_180
        ElseIf Stufe2 = 2 Then
            T_100 = T_100 + 300
            T_130 = T_130 + 300
            T_160 = T_160 + 300
            V_180 = V_180 + 500
        ElseIf Stufe2 = 3 Then
            T_100 = T_100 + 500
            T_130 = T_130 + 500
            T_160 = T_160 + 500
            V_180 = V_180 + 1000
        ElseIf Stufe2 = 4 Then
            T_100 = T_100 + 700
            T_130 = T_130 + 700
            T_160 = T_160 + 700
            V_180 = V_180 + 1500
        ElseIf Stufe2 = 5 Then
            T_100 = T_100 + 900
            T_130 = T_130 + 900
            T_160 = T_160 + 900
            V_180 = V_180 + 2000
        ElseIf Stufe2 = 6 Then
            T_100 = T_100 + 1200
            T_130 = T_130 + 1200
            T_160 = T_160 + 1200
            V_180 = V_180 + 2500
        Else
            T_100 = T_100 + 1200
            T_130 = T_130 + 1200
            T_160 = T_160 + 1200
            V_180 = V_180 + 2500
        End If

        Stufe2 = Stufe1

        Stufe11 = Stufe1 + 1
        If Stufe11 > Stufe3 Then
            Stufe11 = Stufe3
        End If
        Stufe12 = Stufe1 + 2
        If Stufe12 > Stufe3 Then
            Stufe12 = Stufe3
        End If
        Stufe13 = Stufe1 + 3
        If Stufe13 > Stufe3 Then
            Stufe13 = Stufe3
        End If
        Stufe14 = Stufe1 + 4
        If Stufe14 > Stufe3 Then
            Stufe14 = Stufe3
        End If

        Stufe21 = Stufe2 + 1
        If Stufe21 > Stufe3 Then
            Stufe21 = Stufe3
        End If
        Stufe22 = Stufe2 + 2
        If Stufe22 > Stufe3 Then
            Stufe22 = Stufe3
        End If
        Stufe23 = Stufe2 + 3
        If Stufe23 > Stufe3 Then
            Stufe23 = Stufe3
        End If
        Stufe24 = Stufe2 + 4
        If Stufe24 > Stufe3 Then
            Stufe24 = Stufe3
        End If
        If G_200 > 0 Then
            If G_200 < Stufe4 Then
                G_200 = Stufe4
            End If
        Else
            G_200 = Stufe4
        End If

        If Betriebsart = 1 And (_GlsL35 = 3 Or _GlsL35 = 4) Then
            SetProgramCounterLabel1(_Prog35)
        Else
            SetProgramCounterLabel(_Prog35)
        End If

        ' Lok starten - Bahnhofsausfahrt

        If _Prog35 = 0 Then
            Prog_Lok35.Interval = 2000
            If _Fahrzeugbeleuchtung2 > 0 Then
                _eb.lokSteuern(35, Klassen.LokEigenschaften.Hauptfunktion, 1) ' Licht ein
            End If
        ElseIf _Prog35 = 1 Then
        ElseIf _Prog35 = 2 Then
            _Betriebsparameter.RundenErhoehen(35)
        ElseIf _Prog35 = 3 Then
        ElseIf _Prog35 = 4 Then
        ElseIf _Prog35 = 5 Then
        ElseIf _Prog35 = 6 Then

            ' Bahnhofsausfahrt

        ElseIf _Prog35 = 7 Then
            _eb.lokSteuern(35, Klassen.LokEigenschaften.Geschwindigkeit, Stufe1)
        ElseIf _Prog35 = 8 Then
            _eb.lokSteuern(35, Klassen.LokEigenschaften.Geschwindigkeit, Stufe11)
        ElseIf _Prog35 = 9 Then
            _eb.lokSteuern(35, Klassen.LokEigenschaften.Geschwindigkeit, Stufe12)
        ElseIf _Prog35 = 10 Then
            _eb.lokSteuern(35, Klassen.LokEigenschaften.Geschwindigkeit, Stufe13)
        ElseIf _Prog35 = 11 Then
            _eb.lokSteuern(35, Klassen.LokEigenschaften.Geschwindigkeit, Stufe14)
        ElseIf _Prog35 = 12 Then
            _eb.lokSteuern(35, Klassen.LokEigenschaften.Geschwindigkeit, Stufe3)

            ' Lok abstellen

        ElseIf _Prog35 = 50 Then
            Prog_Lok35.Interval = 2000
        ElseIf _Prog35 = 51 Then
        ElseIf _Prog35 = 52 Then
            If _Fahrzeugbeleuchtung2 < 2 Then
                _eb.lokSteuern(35, Klassen.LokEigenschaften.Hauptfunktion, 0) ' Licht aus
            End If

            ' Lok bremsen (Bahnhofseinfahrt Normalzug von links und von rechts)

        ElseIf _Prog35 = 100 Then
            Prog_Lok35.Interval = V_100
        ElseIf _Prog35 = 101 Then
            _eb.lokSteuern(35, Klassen.LokEigenschaften.Geschwindigkeit, Stufe24)
            Prog_Lok35.Interval = T_100
        ElseIf _Prog35 = 102 Then
            _eb.lokSteuern(35, Klassen.LokEigenschaften.Geschwindigkeit, Stufe23)
        ElseIf _Prog35 = 103 Then
            _eb.lokSteuern(35, Klassen.LokEigenschaften.Geschwindigkeit, Stufe22)
        ElseIf _Prog35 = 104 Then
            _eb.lokSteuern(35, Klassen.LokEigenschaften.Geschwindigkeit, Stufe21)
        ElseIf _Prog35 = 105 Then
            _eb.lokSteuern(35, Klassen.LokEigenschaften.Geschwindigkeit, Stufe2)

            ' Lok bremsen (Bahnhofseinfahrt Kurzzug von links)

        ElseIf _Prog35 = 130 Then
            Prog_Lok35.Interval = V_130
        ElseIf _Prog35 = 131 Then
            _eb.lokSteuern(35, Klassen.LokEigenschaften.Geschwindigkeit, Stufe24)
            Prog_Lok35.Interval = T_130
        ElseIf _Prog35 = 132 Then
            _eb.lokSteuern(35, Klassen.LokEigenschaften.Geschwindigkeit, Stufe23)
        ElseIf _Prog35 = 133 Then
            _eb.lokSteuern(35, Klassen.LokEigenschaften.Geschwindigkeit, Stufe22)
        ElseIf _Prog35 = 134 Then
            _eb.lokSteuern(35, Klassen.LokEigenschaften.Geschwindigkeit, Stufe21)
        ElseIf _Prog35 = 135 Then
            _eb.lokSteuern(35, Klassen.LokEigenschaften.Geschwindigkeit, Stufe2)
        ElseIf _Prog35 = 136 Then
            _eb.lokSteuern(35, Klassen.LokEigenschaften.Geschwindigkeit, 0)
        ElseIf _Prog35 = 137 Then
            Prog_Lok35.Interval = 2000
        ElseIf _Prog35 = 138 Then
            If _Fahrzeugbeleuchtung2 < 2 Then
                _eb.lokSteuern(35, Klassen.LokEigenschaften.Hauptfunktion, 0) ' Licht aus
            End If

            ' Lok bremsen (Bahnhofseinfahrt Kurzzug von rechts)

        ElseIf _Prog35 = 160 Then
            Prog_Lok35.Interval = V_160
        ElseIf _Prog35 = 161 Then
            _eb.lokSteuern(35, Klassen.LokEigenschaften.Geschwindigkeit, Stufe24)
            Prog_Lok35.Interval = T_160
        ElseIf _Prog35 = 162 Then
            _eb.lokSteuern(35, Klassen.LokEigenschaften.Geschwindigkeit, Stufe23)
        ElseIf _Prog35 = 163 Then
            _eb.lokSteuern(35, Klassen.LokEigenschaften.Geschwindigkeit, Stufe22)
        ElseIf _Prog35 = 164 Then
            _eb.lokSteuern(35, Klassen.LokEigenschaften.Geschwindigkeit, Stufe21)
        ElseIf _Prog35 = 165 Then
            _eb.lokSteuern(35, Klassen.LokEigenschaften.Geschwindigkeit, Stufe2)
        ElseIf _Prog35 = 166 Then
            _eb.lokSteuern(35, Klassen.LokEigenschaften.Geschwindigkeit, 0)
        ElseIf _Prog35 = 167 Then
            Prog_Lok35.Interval = 2000
        ElseIf _Prog35 = 168 Then
            If _Fahrzeugbeleuchtung2 < 2 Then
                _eb.lokSteuern(35, Klassen.LokEigenschaften.Hauptfunktion, 0) ' Licht aus
            End If

            ' Rangierzug

        ElseIf _Prog35 = 180 Then
            _eb.lokSteuern(35, Klassen.LokEigenschaften.Geschwindigkeit, 2)
            Prog_Lok35.Interval = V_180
        ElseIf _Prog35 = 181 Then
            Prog_Lok35.Interval = T_180
            _eb.lokSteuern(35, Klassen.LokEigenschaften.Geschwindigkeit, 1)
        ElseIf _Prog35 = 182 Then
            _eb.lokSteuern(35, Klassen.LokEigenschaften.Geschwindigkeit, 0)

            ' Tunnelausfahrt

        ElseIf _Prog35 = 200 Then ' Kontakt 1.2 <- (bergauf)
            _eb.lokSteuern(35, Klassen.LokEigenschaften.Geschwindigkeit, G_200)
            Prog_Lok35.Interval = 2000
        ElseIf _Prog35 = 201 Then
        ElseIf _Prog35 = 202 Then
        ElseIf _Prog35 = 203 Then
        ElseIf _Prog35 = 204 Then
        ElseIf _Prog35 = 205 Then
            If Stufe4 < Stufe3 Then
                _eb.lokSteuern(35, Klassen.LokEigenschaften.Geschwindigkeit, Stufe3)
            Else
                _eb.lokSteuern(35, Klassen.LokEigenschaften.Geschwindigkeit, Stufe4)
            End If

        ElseIf _Prog35 = 220 Then ' Kontakt 3.1 -> (hinter dem Martinstor bergauf)
            Prog_Lok35.Interval = 2000
        ElseIf _Prog35 = 221 Then
        ElseIf _Prog35 = 222 Then

        ElseIf _Prog35 = 240 Then ' Kontakt 3.7 <- (hinter der Brücke bergauf)
            Prog_Lok35.Interval = 2000
        ElseIf _Prog35 = 241 Then
        ElseIf _Prog35 = 242 Then

        ElseIf _Prog35 = 260 Then ' Kontakt 3.3 (links bzw vor der Brücke)
            Prog_Lok35.Interval = 2000
        ElseIf _Prog35 = 261 Then
        ElseIf _Prog35 = 262 Then
            _eb.lokSteuern(35, Klassen.LokEigenschaften.Geschwindigkeit, Stufe3)

        ElseIf _Prog35 = 600 Then ' Kontakt 3.5 <- (unter der Burg)
            Prog_Lok35.Interval = 2000
        ElseIf _Prog35 = 601 Then
        ElseIf _Prog35 = 602 Then

        ElseIf _Prog35 = 620 Then ' Kontakt 3.7 -> (hinter der Brücke bergab)
            Prog_Lok35.Interval = 2000
        ElseIf _Prog35 = 621 Then
        ElseIf _Prog35 = 622 Then

        ElseIf _Prog35 = 640 Then ' Kontakt 3.1 <- Talfahrt
            Prog_Lok35.Interval = 2000
        ElseIf _Prog35 = 641 Then
        ElseIf _Prog35 = 642 Then

        ElseIf _Prog35 = 660 Then ' Kontakt 1.2 -> Talfahrt
            Prog_Lok35.Interval = 2000
        ElseIf _Prog35 = 661 Then
        ElseIf _Prog35 = 662 Then

        ElseIf _Prog35 = 700 Then ' Kontakt 0.4 <- Diagonale
            Prog_Lok35.Interval = 2000
        ElseIf _Prog35 = 701 Then
        ElseIf _Prog35 = 702 Then

            ' Zindelstein

        ElseIf _Prog35 = 500 Then
            Prog_Lok35.Interval = V_500
        ElseIf _Prog35 = 501 Then
            _eb.lokSteuern(35, Klassen.LokEigenschaften.Geschwindigkeit, Stufe23)
            Prog_Lok35.Interval = T_500
        ElseIf _Prog35 = 502 Then
            _eb.lokSteuern(35, Klassen.LokEigenschaften.Geschwindigkeit, Stufe22)
        ElseIf _Prog35 = 503 Then
            _eb.lokSteuern(35, Klassen.LokEigenschaften.Geschwindigkeit, Stufe21)
        ElseIf _Prog35 = 504 Then
            _eb.lokSteuern(35, Klassen.LokEigenschaften.Geschwindigkeit, Stufe2)
        ElseIf _Prog35 = 505 Then
            _eb.lokSteuern(35, Klassen.LokEigenschaften.Geschwindigkeit, 0)


        Else
            _Prog35 = 0
            Prog_Lok35.Stop()
            Prog_Lok35.Interval = 200
            If Betriebsart = 1 Then
                SetProgramCounterLabel1(String.Empty)
            Else
                SetProgramCounterLabel(String.Empty)
            End If
        End If
        _Prog35 = _Prog35 + 1
    End Sub
    Private Sub HandleTimerElapsed48(sender As System.Object, e As System.EventArgs) Handles Prog_Lok36.Elapsed

        '*** Fahrprogramm für E-Lok 41 024
        '*** Datum: 23.02.2020

        SetText(TextBox1, "E-Lok 41 024                                                            IBS: 11.10.2025 - V3: 9")
        LoadImage(PictureBox1, "H:\\EB_Media\\LokFotos\\Baureihe_141_01.jpg")
        GeschwindikeitenSetzen(36)

        Dim Stufe1, Stufe2, Stufe3, Stufe4 As Integer
        Dim Stufe11, Stufe12, Stufe13, Stufe14, Stufe21, Stufe22, Stufe23, Stufe24 As Integer
        Dim V_100, V_130, V_160, V_180, V_500 As Integer
        Dim T_100, T_130, T_160, T_180, T_500 As Integer
        Dim G_200 As Integer

        T_100 = _Betriebsparameter.Fahrparameter(36, KlausEBspecific.Betriebsparameter.FahrparameterEnum.T_100)
        T_130 = _Betriebsparameter.Fahrparameter(36, KlausEBspecific.Betriebsparameter.FahrparameterEnum.T_130)
        T_160 = _Betriebsparameter.Fahrparameter(36, KlausEBspecific.Betriebsparameter.FahrparameterEnum.T_160)
        T_180 = _Betriebsparameter.Fahrparameter(36, KlausEBspecific.Betriebsparameter.FahrparameterEnum.T_180)
        T_500 = _Betriebsparameter.Fahrparameter(36, KlausEBspecific.Betriebsparameter.FahrparameterEnum.T_500)
        V_100 = _Betriebsparameter.Fahrparameter(36, KlausEBspecific.Betriebsparameter.FahrparameterEnum.V_100)
        V_130 = _Betriebsparameter.Fahrparameter(36, KlausEBspecific.Betriebsparameter.FahrparameterEnum.V_130)
        V_160 = _Betriebsparameter.Fahrparameter(36, KlausEBspecific.Betriebsparameter.FahrparameterEnum.V_160)
        V_180 = _Betriebsparameter.Fahrparameter(36, KlausEBspecific.Betriebsparameter.FahrparameterEnum.V_180)
        V_500 = _Betriebsparameter.Fahrparameter(36, KlausEBspecific.Betriebsparameter.FahrparameterEnum.V_500)
        G_200 = _Betriebsparameter.Fahrparameter(36, KlausEBspecific.Betriebsparameter.FahrparameterEnum.G_200)

        If A_StopB = 1 Then
            V_100 = 5000
        End If

        Stufe1 = _LokStufen.Holen(36, 1)
        Stufe2 = _LokStufen.Holen(36, 2)
        Stufe3 = _LokStufen.Holen(36, 3)
        Stufe4 = _LokStufen.Holen(36, 4)

        If Stufe2 = 1 Then
            T_100 = T_100
            T_130 = T_130
            T_160 = T_160
            V_180 = V_180
        ElseIf Stufe2 = 2 Then
            T_100 = T_100 + 300
            T_130 = T_130 + 300
            T_160 = T_160 + 300
            V_180 = V_180 + 500
        ElseIf Stufe2 = 3 Then
            T_100 = T_100 + 500
            T_130 = T_130 + 500
            T_160 = T_160 + 500
            V_180 = V_180 + 1000
        ElseIf Stufe2 = 4 Then
            T_100 = T_100 + 700
            T_130 = T_130 + 700
            T_160 = T_160 + 700
            V_180 = V_180 + 1500
        ElseIf Stufe2 = 5 Then
            T_100 = T_100 + 900
            T_130 = T_130 + 900
            T_160 = T_160 + 900
            V_180 = V_180 + 2000
        ElseIf Stufe2 = 6 Then
            T_100 = T_100 + 1200
            T_130 = T_130 + 1200
            T_160 = T_160 + 1200
            V_180 = V_180 + 2500
        Else
            T_100 = T_100 + 1200
            T_130 = T_130 + 1200
            T_160 = T_160 + 1200
            V_180 = V_180 + 2500
        End If

        Stufe2 = Stufe1

        Stufe11 = Stufe1 + 1
        If Stufe11 > Stufe3 Then
            Stufe11 = Stufe3
        End If
        Stufe12 = Stufe1 + 2
        If Stufe12 > Stufe3 Then
            Stufe12 = Stufe3
        End If
        Stufe13 = Stufe1 + 3
        If Stufe13 > Stufe3 Then
            Stufe13 = Stufe3
        End If
        Stufe14 = Stufe1 + 4
        If Stufe14 > Stufe3 Then
            Stufe14 = Stufe3
        End If

        Stufe21 = Stufe2 + 1
        If Stufe21 > Stufe3 Then
            Stufe21 = Stufe3
        End If
        Stufe22 = Stufe2 + 2
        If Stufe22 > Stufe3 Then
            Stufe22 = Stufe3
        End If
        Stufe23 = Stufe2 + 3
        If Stufe23 > Stufe3 Then
            Stufe23 = Stufe3
        End If
        Stufe24 = Stufe2 + 4
        If Stufe24 > Stufe3 Then
            Stufe24 = Stufe3
        End If
        If G_200 > 0 Then
            If G_200 < Stufe4 Then
                G_200 = Stufe4
            End If
        Else
            G_200 = Stufe4
        End If

        If Betriebsart = 1 And (_GlsL36 = 3 Or _GlsL36 = 4) Then
            SetProgramCounterLabel1(_Prog36)
        Else
            SetProgramCounterLabel(_Prog36)
        End If

        ' Lok starten - Bahnhofsausfahrt

        If _Prog36 = 0 Then
            Prog_Lok36.Interval = 2000
            If _Fahrzeugbeleuchtung2 > 0 Then
                _eb.lokSteuern(36, Klassen.LokEigenschaften.Hauptfunktion, 1) ' Licht ein
            End If
        ElseIf _Prog36 = 1 Then
        ElseIf _Prog36 = 2 Then
            _Betriebsparameter.RundenErhoehen(36)
        ElseIf _Prog36 = 3 Then
        ElseIf _Prog36 = 4 Then
        ElseIf _Prog36 = 5 Then
        ElseIf _Prog36 = 6 Then

            ' Bahnhofsausfahrt

        ElseIf _Prog36 = 7 Then
            _eb.lokSteuern(36, Klassen.LokEigenschaften.Geschwindigkeit, Stufe1)
        ElseIf _Prog36 = 8 Then
            _eb.lokSteuern(36, Klassen.LokEigenschaften.Geschwindigkeit, Stufe11)
        ElseIf _Prog36 = 9 Then
            _eb.lokSteuern(36, Klassen.LokEigenschaften.Geschwindigkeit, Stufe12)
        ElseIf _Prog36 = 10 Then
            _eb.lokSteuern(36, Klassen.LokEigenschaften.Geschwindigkeit, Stufe13)
        ElseIf _Prog36 = 11 Then
            _eb.lokSteuern(36, Klassen.LokEigenschaften.Geschwindigkeit, Stufe14)
        ElseIf _Prog36 = 12 Then
            _eb.lokSteuern(36, Klassen.LokEigenschaften.Geschwindigkeit, Stufe3)

            ' Lok abstellen

        ElseIf _Prog36 = 50 Then
            Prog_Lok36.Interval = 2000
        ElseIf _Prog36 = 51 Then
        ElseIf _Prog36 = 52 Then
            If _Fahrzeugbeleuchtung2 < 2 Then
                _eb.lokSteuern(36, Klassen.LokEigenschaften.Hauptfunktion, 0) ' Licht aus
            End If

            ' Lok bremsen (Bahnhofseinfahrt Normalzug von links und von rechts)

        ElseIf _Prog36 = 100 Then
            Prog_Lok36.Interval = V_100
        ElseIf _Prog36 = 101 Then
            _eb.lokSteuern(36, Klassen.LokEigenschaften.Geschwindigkeit, Stufe24)
            Prog_Lok36.Interval = T_100
        ElseIf _Prog36 = 102 Then
            _eb.lokSteuern(36, Klassen.LokEigenschaften.Geschwindigkeit, Stufe23)
        ElseIf _Prog36 = 103 Then
            _eb.lokSteuern(36, Klassen.LokEigenschaften.Geschwindigkeit, Stufe22)
        ElseIf _Prog36 = 104 Then
            _eb.lokSteuern(36, Klassen.LokEigenschaften.Geschwindigkeit, Stufe21)
        ElseIf _Prog36 = 105 Then
            _eb.lokSteuern(36, Klassen.LokEigenschaften.Geschwindigkeit, Stufe2)

            ' Lok bremsen (Bahnhofseinfahrt Kurzzug von links)

        ElseIf _Prog36 = 130 Then
            Prog_Lok36.Interval = V_130
        ElseIf _Prog36 = 131 Then
            _eb.lokSteuern(36, Klassen.LokEigenschaften.Geschwindigkeit, Stufe24)
            Prog_Lok36.Interval = T_130
        ElseIf _Prog36 = 132 Then
            _eb.lokSteuern(36, Klassen.LokEigenschaften.Geschwindigkeit, Stufe23)
        ElseIf _Prog36 = 133 Then
            _eb.lokSteuern(36, Klassen.LokEigenschaften.Geschwindigkeit, Stufe22)
        ElseIf _Prog36 = 134 Then
            _eb.lokSteuern(36, Klassen.LokEigenschaften.Geschwindigkeit, Stufe21)
        ElseIf _Prog36 = 135 Then
            _eb.lokSteuern(36, Klassen.LokEigenschaften.Geschwindigkeit, Stufe2)
        ElseIf _Prog36 = 136 Then
            _eb.lokSteuern(36, Klassen.LokEigenschaften.Geschwindigkeit, 0)
        ElseIf _Prog36 = 137 Then
            Prog_Lok36.Interval = 2000
        ElseIf _Prog36 = 138 Then
            If _Fahrzeugbeleuchtung2 < 2 Then
                _eb.lokSteuern(36, Klassen.LokEigenschaften.Hauptfunktion, 0) ' Licht aus
            End If

            ' Lok bremsen (Bahnhofseinfahrt Kurzzug von rechts)

        ElseIf _Prog36 = 160 Then
            Prog_Lok36.Interval = V_160
        ElseIf _Prog36 = 161 Then
            _eb.lokSteuern(36, Klassen.LokEigenschaften.Geschwindigkeit, Stufe24)
            Prog_Lok36.Interval = T_160
        ElseIf _Prog36 = 162 Then
            _eb.lokSteuern(36, Klassen.LokEigenschaften.Geschwindigkeit, Stufe23)
        ElseIf _Prog36 = 163 Then
            _eb.lokSteuern(36, Klassen.LokEigenschaften.Geschwindigkeit, Stufe22)
        ElseIf _Prog36 = 164 Then
            _eb.lokSteuern(36, Klassen.LokEigenschaften.Geschwindigkeit, Stufe21)
        ElseIf _Prog36 = 165 Then
            _eb.lokSteuern(36, Klassen.LokEigenschaften.Geschwindigkeit, Stufe2)
        ElseIf _Prog36 = 166 Then
            _eb.lokSteuern(36, Klassen.LokEigenschaften.Geschwindigkeit, 0)
        ElseIf _Prog36 = 167 Then
            Prog_Lok36.Interval = 2000
        ElseIf _Prog36 = 168 Then
            If _Fahrzeugbeleuchtung2 < 2 Then
                _eb.lokSteuern(36, Klassen.LokEigenschaften.Hauptfunktion, 0) ' Licht aus
            End If

            ' Rangierzug

        ElseIf _Prog36 = 180 Then
            _eb.lokSteuern(36, Klassen.LokEigenschaften.Geschwindigkeit, Stufe2)
            Prog_Lok36.Interval = V_180
        ElseIf _Prog36 = 181 Then
            Prog_Lok36.Interval = T_180
            _eb.lokSteuern(36, Klassen.LokEigenschaften.Geschwindigkeit, 3)
        ElseIf _Prog36 = 182 Then
            _eb.lokSteuern(36, Klassen.LokEigenschaften.Geschwindigkeit, 0)

            ' Tunnelausfahrt

        ElseIf _Prog36 = 200 Then ' Kontakt 1.2 <- (bergauf)
            _eb.lokSteuern(36, Klassen.LokEigenschaften.Geschwindigkeit, G_200)
            Prog_Lok36.Interval = 2000
        ElseIf _Prog36 = 201 Then
        ElseIf _Prog36 = 202 Then
        ElseIf _Prog36 = 203 Then
        ElseIf _Prog36 = 204 Then
        ElseIf _Prog36 = 205 Then
            If Stufe4 < Stufe3 Then
                _eb.lokSteuern(36, Klassen.LokEigenschaften.Geschwindigkeit, Stufe3)
            Else
                _eb.lokSteuern(36, Klassen.LokEigenschaften.Geschwindigkeit, Stufe4)
            End If

        ElseIf _Prog36 = 220 Then ' Kontakt 3.1 -> (hinter dem Martinstor bergauf)
            Prog_Lok36.Interval = 2000
        ElseIf _Prog36 = 221 Then
        ElseIf _Prog36 = 222 Then

        ElseIf _Prog36 = 240 Then ' Kontakt 3.7 <- (hinter der Brücke bergauf)
            Prog_Lok36.Interval = 2000
        ElseIf _Prog36 = 241 Then
        ElseIf _Prog36 = 242 Then

        ElseIf _Prog36 = 260 Then ' Kontakt 3.3 (links bzw vor der Brücke)
            Prog_Lok36.Interval = 2000
        ElseIf _Prog36 = 261 Then
        ElseIf _Prog36 = 262 Then
            _eb.lokSteuern(36, Klassen.LokEigenschaften.Geschwindigkeit, Stufe3)

        ElseIf _Prog36 = 600 Then ' Kontakt 3.5 <- (unter der Burg)
            Prog_Lok36.Interval = 2000
        ElseIf _Prog36 = 601 Then
        ElseIf _Prog36 = 602 Then

        ElseIf _Prog36 = 620 Then ' Kontakt 3.7 -> (hinter der Brücke bergab)
            Prog_Lok36.Interval = 2000
        ElseIf _Prog36 = 621 Then
        ElseIf _Prog36 = 622 Then

        ElseIf _Prog36 = 640 Then ' Kontakt 3.1 <- Talfahrt
            Prog_Lok36.Interval = 2000
        ElseIf _Prog36 = 641 Then
        ElseIf _Prog36 = 642 Then

        ElseIf _Prog36 = 660 Then ' Kontakt 1.2 -> Talfahrt
            Prog_Lok36.Interval = 2000
        ElseIf _Prog36 = 661 Then
        ElseIf _Prog36 = 662 Then

        ElseIf _Prog36 = 700 Then ' Kontakt 0.4 <- Diagonale
            Prog_Lok36.Interval = 2000
        ElseIf _Prog36 = 701 Then
        ElseIf _Prog36 = 702 Then

            ' Zindelstein

        ElseIf _Prog36 = 500 Then
            Prog_Lok36.Interval = V_500
        ElseIf _Prog36 = 501 Then
            _eb.lokSteuern(36, Klassen.LokEigenschaften.Geschwindigkeit, Stufe23)
            Prog_Lok36.Interval = T_500
        ElseIf _Prog36 = 502 Then
            _eb.lokSteuern(36, Klassen.LokEigenschaften.Geschwindigkeit, Stufe22)
        ElseIf _Prog36 = 503 Then
            _eb.lokSteuern(36, Klassen.LokEigenschaften.Geschwindigkeit, Stufe21)
        ElseIf _Prog36 = 504 Then
            _eb.lokSteuern(36, Klassen.LokEigenschaften.Geschwindigkeit, Stufe2)
        ElseIf _Prog36 = 505 Then
            _eb.lokSteuern(36, Klassen.LokEigenschaften.Geschwindigkeit, 0)

        Else
            _Prog36 = 0
            Prog_Lok36.Stop()
            Prog_Lok36.Interval = 200
            If Betriebsart = 1 Then
                SetProgramCounterLabel1(String.Empty)
            Else
                SetProgramCounterLabel(String.Empty)
            End If
        End If
        _Prog36 = _Prog36 + 1
    End Sub
    Private Sub HandleTimerElapsed49(sender As System.Object, e As System.EventArgs) Handles Prog_Lok37.Elapsed

        '*** Fahrprogramm für E-Lok 151 030-4
        '*** Datum: 23.02.2020 +

        SetText(TextBox1, "E-Lok 151 030-4                                                          IBS: 06.01.2022 - V3 : 7")
        LoadImage(PictureBox1, "H:\\EB_Media\\LokFotos\\Baureihe_151_04.jpg")
        GeschwindikeitenSetzen(37)

        Dim Stufe1, Stufe2, Stufe3, Stufe4 As Integer
        Dim Stufe11, Stufe12, Stufe13, Stufe14, Stufe21, Stufe22, Stufe23, Stufe24 As Integer
        Dim V_100, V_130, V_160, V_180, V_500 As Integer
        Dim T_100, T_130, T_160, T_180, T_500 As Integer
        Dim G_200 As Integer

        T_100 = _Betriebsparameter.Fahrparameter(37, KlausEBspecific.Betriebsparameter.FahrparameterEnum.T_100)
        T_130 = _Betriebsparameter.Fahrparameter(37, KlausEBspecific.Betriebsparameter.FahrparameterEnum.T_130)
        T_160 = _Betriebsparameter.Fahrparameter(37, KlausEBspecific.Betriebsparameter.FahrparameterEnum.T_160)
        T_180 = _Betriebsparameter.Fahrparameter(37, KlausEBspecific.Betriebsparameter.FahrparameterEnum.T_180)
        T_500 = _Betriebsparameter.Fahrparameter(37, KlausEBspecific.Betriebsparameter.FahrparameterEnum.T_500)
        V_100 = _Betriebsparameter.Fahrparameter(37, KlausEBspecific.Betriebsparameter.FahrparameterEnum.V_100)
        V_130 = _Betriebsparameter.Fahrparameter(37, KlausEBspecific.Betriebsparameter.FahrparameterEnum.V_130)
        V_160 = _Betriebsparameter.Fahrparameter(37, KlausEBspecific.Betriebsparameter.FahrparameterEnum.V_160)
        V_180 = _Betriebsparameter.Fahrparameter(37, KlausEBspecific.Betriebsparameter.FahrparameterEnum.V_180)
        V_500 = _Betriebsparameter.Fahrparameter(37, KlausEBspecific.Betriebsparameter.FahrparameterEnum.V_500)
        G_200 = _Betriebsparameter.Fahrparameter(37, KlausEBspecific.Betriebsparameter.FahrparameterEnum.G_200)

        If A_StopB = 1 Then
            V_100 = 8000
        End If

        Stufe1 = _LokStufen.Holen(37, 1)
        Stufe2 = _LokStufen.Holen(37, 2)
        Stufe3 = _LokStufen.Holen(37, 3)
        Stufe4 = _LokStufen.Holen(37, 4)

        If Stufe2 = 1 Then
            T_100 = T_100
            T_130 = T_130
            T_160 = T_160
            V_180 = V_180
        ElseIf Stufe2 = 2 Then
            T_100 = T_100 + 300
            T_130 = T_130 + 300
            T_160 = T_160 + 300
            V_180 = V_180 + 500
        ElseIf Stufe2 = 3 Then
            T_100 = T_100 + 500
            T_130 = T_130 + 500
            T_160 = T_160 + 500
            V_180 = V_180 + 1000
        ElseIf Stufe2 = 4 Then
            T_100 = T_100 + 700
            T_130 = T_130 + 700
            T_160 = T_160 + 700
            V_180 = V_180 + 1500
        ElseIf Stufe2 = 5 Then
            T_100 = T_100 + 900
            T_130 = T_130 + 900
            T_160 = T_160 + 900
            V_180 = V_180 + 2000
        ElseIf Stufe2 = 6 Then
            T_100 = T_100 + 1200
            T_130 = T_130 + 1200
            T_160 = T_160 + 1200
            V_180 = V_180 + 2500
        Else
            T_100 = T_100 + 1200
            T_130 = T_130 + 1200
            T_160 = T_160 + 1200
            V_180 = V_180 + 2500
        End If

        Stufe2 = Stufe1

        Stufe11 = Stufe1 + 1
        If Stufe11 > Stufe3 Then
            Stufe11 = Stufe3
        End If
        Stufe12 = Stufe1 + 2
        If Stufe12 > Stufe3 Then
            Stufe12 = Stufe3
        End If
        Stufe13 = Stufe1 + 3
        If Stufe13 > Stufe3 Then
            Stufe13 = Stufe3
        End If
        Stufe14 = Stufe1 + 4
        If Stufe14 > Stufe3 Then
            Stufe14 = Stufe3
        End If

        Stufe21 = Stufe2 + 1
        If Stufe21 > Stufe3 Then
            Stufe21 = Stufe3
        End If
        Stufe22 = Stufe2 + 2
        If Stufe22 > Stufe3 Then
            Stufe22 = Stufe3
        End If
        Stufe23 = Stufe2 + 3
        If Stufe23 > Stufe3 Then
            Stufe23 = Stufe3
        End If
        Stufe24 = Stufe2 + 4
        If Stufe24 > Stufe3 Then
            Stufe24 = Stufe3
        End If
        If G_200 > 0 Then
            If G_200 < Stufe4 Then
                G_200 = Stufe4
            End If
        Else
            G_200 = Stufe4
        End If

        If Betriebsart = 1 And (_GlsL37 = 3 Or _GlsL37 = 4) Then
            SetProgramCounterLabel1(_Prog37)
        Else
            SetProgramCounterLabel(_Prog37)
        End If

        ' Lok starten - Bahnhofsausfahrt

        If _Prog37 = 0 Then
            Prog_Lok37.Interval = 2000
            If _Fahrzeugbeleuchtung2 > 0 Then
                _eb.lokSteuern(37, Klassen.LokEigenschaften.Hauptfunktion, 1) ' Licht ein
            End If
        ElseIf _Prog37 = 1 Then
        ElseIf _Prog37 = 2 Then
            _Betriebsparameter.RundenErhoehen(37)
        ElseIf _Prog37 = 3 Then
        ElseIf _Prog37 = 4 Then
        ElseIf _Prog37 = 5 Then
        ElseIf _Prog37 = 6 Then

            ' Bahnhofsausfahrt

        ElseIf _Prog37 = 7 Then
            _eb.lokSteuern(37, Klassen.LokEigenschaften.Geschwindigkeit, Stufe1)
        ElseIf _Prog37 = 8 Then
            _eb.lokSteuern(37, Klassen.LokEigenschaften.Geschwindigkeit, Stufe11)
        ElseIf _Prog37 = 9 Then
            _eb.lokSteuern(37, Klassen.LokEigenschaften.Geschwindigkeit, Stufe12)
        ElseIf _Prog37 = 10 Then
            _eb.lokSteuern(37, Klassen.LokEigenschaften.Geschwindigkeit, Stufe13)
        ElseIf _Prog37 = 11 Then
            _eb.lokSteuern(37, Klassen.LokEigenschaften.Geschwindigkeit, Stufe14)
        ElseIf _Prog37 = 12 Then
            _eb.lokSteuern(37, Klassen.LokEigenschaften.Geschwindigkeit, Stufe3)

            ' Lok abstellen

        ElseIf _Prog37 = 50 Then
            Prog_Lok37.Interval = 2000
        ElseIf _Prog37 = 51 Then
        ElseIf _Prog37 = 52 Then
            If _Fahrzeugbeleuchtung2 < 2 Then
                _eb.lokSteuern(37, Klassen.LokEigenschaften.Hauptfunktion, 0) ' Licht aus
            End If

            ' Lok bremsen (Bahnhofseinfahrt Normalzug von links und von rechts)

        ElseIf _Prog37 = 100 Then
            Prog_Lok37.Interval = V_100
        ElseIf _Prog37 = 101 Then
            _eb.lokSteuern(37, Klassen.LokEigenschaften.Geschwindigkeit, Stufe24)
            Prog_Lok37.Interval = T_100
        ElseIf _Prog37 = 102 Then
            _eb.lokSteuern(37, Klassen.LokEigenschaften.Geschwindigkeit, Stufe23)
        ElseIf _Prog37 = 103 Then
            _eb.lokSteuern(37, Klassen.LokEigenschaften.Geschwindigkeit, Stufe22)
        ElseIf _Prog37 = 104 Then
            _eb.lokSteuern(37, Klassen.LokEigenschaften.Geschwindigkeit, Stufe21)
        ElseIf _Prog37 = 105 Then
            _eb.lokSteuern(37, Klassen.LokEigenschaften.Geschwindigkeit, Stufe2)

            ' Lok bremsen (Bahnhofseinfahrt Kurzzug von links)

        ElseIf _Prog37 = 130 Then
            Prog_Lok37.Interval = V_130
        ElseIf _Prog37 = 131 Then
            _eb.lokSteuern(37, Klassen.LokEigenschaften.Geschwindigkeit, Stufe24)
            Prog_Lok37.Interval = T_130
        ElseIf _Prog37 = 132 Then
            _eb.lokSteuern(37, Klassen.LokEigenschaften.Geschwindigkeit, Stufe23)
        ElseIf _Prog37 = 133 Then
            _eb.lokSteuern(37, Klassen.LokEigenschaften.Geschwindigkeit, Stufe22)
        ElseIf _Prog37 = 134 Then
            _eb.lokSteuern(37, Klassen.LokEigenschaften.Geschwindigkeit, Stufe21)
        ElseIf _Prog37 = 135 Then
            _eb.lokSteuern(37, Klassen.LokEigenschaften.Geschwindigkeit, Stufe2)
        ElseIf _Prog37 = 136 Then
            _eb.lokSteuern(37, Klassen.LokEigenschaften.Geschwindigkeit, 0)
        ElseIf _Prog37 = 137 Then
            Prog_Lok37.Interval = 2000
        ElseIf _Prog37 = 138 Then
            If _Fahrzeugbeleuchtung2 < 2 Then
                _eb.lokSteuern(37, Klassen.LokEigenschaften.Hauptfunktion, 0) ' Licht aus
            End If

            ' Lok bremsen (Bahnhofseinfahrt Kurzzug von rechts)

        ElseIf _Prog37 = 160 Then
            Prog_Lok37.Interval = V_160
        ElseIf _Prog37 = 161 Then
            _eb.lokSteuern(37, Klassen.LokEigenschaften.Geschwindigkeit, Stufe24)
            Prog_Lok37.Interval = T_160
        ElseIf _Prog37 = 162 Then
            _eb.lokSteuern(37, Klassen.LokEigenschaften.Geschwindigkeit, Stufe23)
        ElseIf _Prog37 = 163 Then
            _eb.lokSteuern(37, Klassen.LokEigenschaften.Geschwindigkeit, Stufe22)
        ElseIf _Prog37 = 164 Then
            _eb.lokSteuern(37, Klassen.LokEigenschaften.Geschwindigkeit, Stufe21)
        ElseIf _Prog37 = 165 Then
            _eb.lokSteuern(37, Klassen.LokEigenschaften.Geschwindigkeit, Stufe2)
        ElseIf _Prog37 = 166 Then
            _eb.lokSteuern(37, Klassen.LokEigenschaften.Geschwindigkeit, 0)
        ElseIf _Prog37 = 167 Then
            Prog_Lok37.Interval = 2000
        ElseIf _Prog37 = 168 Then
            If _Fahrzeugbeleuchtung2 < 2 Then
                _eb.lokSteuern(37, Klassen.LokEigenschaften.Hauptfunktion, 0) ' Licht aus
            End If

            ' Rangierzug

        ElseIf _Prog37 = 180 Then
            _eb.lokSteuern(37, Klassen.LokEigenschaften.Geschwindigkeit, 2)
            Prog_Lok37.Interval = V_180
        ElseIf _Prog37 = 181 Then
            Prog_Lok37.Interval = T_180
            _eb.lokSteuern(37, Klassen.LokEigenschaften.Geschwindigkeit, 1)
        ElseIf _Prog37 = 182 Then
            _eb.lokSteuern(37, Klassen.LokEigenschaften.Geschwindigkeit, 0)

            ' Tunnelausfahrt

        ElseIf _Prog37 = 200 Then ' Kontakt 1.2 <- (bergauf)
            _eb.lokSteuern(37, Klassen.LokEigenschaften.Geschwindigkeit, G_200)
            Prog_Lok37.Interval = 2000
        ElseIf _Prog37 = 201 Then
        ElseIf _Prog37 = 202 Then
        ElseIf _Prog37 = 203 Then
        ElseIf _Prog37 = 204 Then
        ElseIf _Prog37 = 205 Then
            If Stufe4 < Stufe3 Then
                _eb.lokSteuern(37, Klassen.LokEigenschaften.Geschwindigkeit, Stufe3)
            Else
                _eb.lokSteuern(37, Klassen.LokEigenschaften.Geschwindigkeit, Stufe4)
            End If

        ElseIf _Prog37 = 220 Then ' Kontakt 3.1 -> (hinter dem Martinstor bergauf)
            Prog_Lok37.Interval = 2000
        ElseIf _Prog37 = 221 Then
        ElseIf _Prog37 = 222 Then

        ElseIf _Prog37 = 240 Then ' Kontakt 3.7 <- (hinter der Brücke bergauf)
            Prog_Lok37.Interval = 2000
        ElseIf _Prog37 = 241 Then
        ElseIf _Prog37 = 242 Then

        ElseIf _Prog37 = 260 Then ' Kontakt 3.3 (links bzw vor der Brücke)
            Prog_Lok37.Interval = 2000
        ElseIf _Prog37 = 261 Then
        ElseIf _Prog37 = 262 Then
            _eb.lokSteuern(37, Klassen.LokEigenschaften.Geschwindigkeit, Stufe3)

        ElseIf _Prog37 = 600 Then ' Kontakt 3.5 <- (unter der Burg)
            Prog_Lok37.Interval = 2000
        ElseIf _Prog37 = 601 Then
        ElseIf _Prog37 = 602 Then

        ElseIf _Prog37 = 620 Then ' Kontakt 3.7 -> (hinter der Brücke bergab)
            Prog_Lok37.Interval = 2000
        ElseIf _Prog37 = 621 Then
        ElseIf _Prog37 = 622 Then

        ElseIf _Prog37 = 640 Then ' Kontakt 3.1 <- Talfahrt
            Prog_Lok37.Interval = 2000
        ElseIf _Prog37 = 641 Then
        ElseIf _Prog37 = 642 Then

        ElseIf _Prog37 = 660 Then ' Kontakt 1.2 -> Talfahrt
            Prog_Lok37.Interval = 2000
        ElseIf _Prog37 = 661 Then
        ElseIf _Prog37 = 662 Then

        ElseIf _Prog37 = 700 Then ' Kontakt 0.4 <- Diagonale
            Prog_Lok37.Interval = 2000
        ElseIf _Prog37 = 701 Then
        ElseIf _Prog37 = 702 Then

            ' Zindelstein

        ElseIf _Prog37 = 500 Then
            Prog_Lok37.Interval = V_500
        ElseIf _Prog37 = 501 Then
            _eb.lokSteuern(37, Klassen.LokEigenschaften.Geschwindigkeit, Stufe23)
            Prog_Lok37.Interval = T_500
        ElseIf _Prog37 = 502 Then
            _eb.lokSteuern(37, Klassen.LokEigenschaften.Geschwindigkeit, Stufe22)
        ElseIf _Prog37 = 503 Then
            _eb.lokSteuern(37, Klassen.LokEigenschaften.Geschwindigkeit, Stufe21)
        ElseIf _Prog37 = 504 Then
            _eb.lokSteuern(37, Klassen.LokEigenschaften.Geschwindigkeit, Stufe2)
        ElseIf _Prog37 = 505 Then
            _eb.lokSteuern(37, Klassen.LokEigenschaften.Geschwindigkeit, 0)


        Else
            _Prog37 = 0
            Prog_Lok37.Stop()
            Prog_Lok37.Interval = 200
            If Betriebsart = 1 Then
                SetProgramCounterLabel1(String.Empty)
            Else
                SetProgramCounterLabel(String.Empty)
            End If
        End If
        _Prog37 = _Prog37 + 1
    End Sub
    Private Sub HandleTimerElapsed50(sender As System.Object, e As System.EventArgs) Handles Prog_Lok38.Elapsed

        '*** Fahrprogramm für E-Lok 44 098
        '*** Datum: 23.02.2020

        SetText(TextBox1, "E-Lok 44 098                                                            IBS: 15.03.2021 - V3 : 6")
        LoadImage(PictureBox1, "H:\\EB_Media\\LokFotos\\Baureihe_144_02.jpg")
        GeschwindikeitenSetzen(38)

        Dim Stufe1, Stufe2, Stufe3, Stufe4 As Integer
        Dim Stufe11, Stufe12, Stufe13, Stufe14, Stufe21, Stufe22, Stufe23, Stufe24 As Integer
        Dim V_100, V_130, V_160, V_180, V_500 As Integer
        Dim T_100, T_130, T_160, T_180, T_500 As Integer
        Dim G_200 As Integer

        T_100 = _Betriebsparameter.Fahrparameter(38, KlausEBspecific.Betriebsparameter.FahrparameterEnum.T_100)
        T_130 = _Betriebsparameter.Fahrparameter(38, KlausEBspecific.Betriebsparameter.FahrparameterEnum.T_130)
        T_160 = _Betriebsparameter.Fahrparameter(38, KlausEBspecific.Betriebsparameter.FahrparameterEnum.T_160)
        T_180 = _Betriebsparameter.Fahrparameter(38, KlausEBspecific.Betriebsparameter.FahrparameterEnum.T_180)
        T_500 = _Betriebsparameter.Fahrparameter(38, KlausEBspecific.Betriebsparameter.FahrparameterEnum.T_500)
        V_100 = _Betriebsparameter.Fahrparameter(38, KlausEBspecific.Betriebsparameter.FahrparameterEnum.V_100)
        V_130 = _Betriebsparameter.Fahrparameter(38, KlausEBspecific.Betriebsparameter.FahrparameterEnum.V_130)
        V_160 = _Betriebsparameter.Fahrparameter(38, KlausEBspecific.Betriebsparameter.FahrparameterEnum.V_160)
        V_180 = _Betriebsparameter.Fahrparameter(38, KlausEBspecific.Betriebsparameter.FahrparameterEnum.V_180)
        V_500 = _Betriebsparameter.Fahrparameter(38, KlausEBspecific.Betriebsparameter.FahrparameterEnum.V_500)
        G_200 = _Betriebsparameter.Fahrparameter(38, KlausEBspecific.Betriebsparameter.FahrparameterEnum.G_200)

        If A_StopB = 1 Then
            V_100 = 8000
        End If

        Stufe1 = _LokStufen.Holen(38, 1)
        Stufe2 = _LokStufen.Holen(38, 2)
        Stufe3 = _LokStufen.Holen(38, 3)
        Stufe4 = _LokStufen.Holen(38, 4)

        If Stufe2 = 1 Then
            T_100 = T_100
            T_130 = T_130
            T_160 = T_160
            V_180 = V_180
        ElseIf Stufe2 = 2 Then
            T_100 = T_100 + 300
            T_130 = T_130 + 300
            T_160 = T_160 + 300
            V_180 = V_180 + 500
        ElseIf Stufe2 = 3 Then
            T_100 = T_100 + 500
            T_130 = T_130 + 500
            T_160 = T_160 + 500
            V_180 = V_180 + 1000
        ElseIf Stufe2 = 4 Then
            T_100 = T_100 + 700
            T_130 = T_130 + 700
            T_160 = T_160 + 700
            V_180 = V_180 + 1500
        ElseIf Stufe2 = 5 Then
            T_100 = T_100 + 900
            T_130 = T_130 + 900
            T_160 = T_160 + 900
            V_180 = V_180 + 2000
        ElseIf Stufe2 = 6 Then
            T_100 = T_100 + 1200
            T_130 = T_130 + 1200
            T_160 = T_160 + 1200
            V_180 = V_180 + 2500
        Else
            T_100 = T_100 + 1200
            T_130 = T_130 + 1200
            T_160 = T_160 + 1200
            V_180 = V_180 + 2500
        End If

        Stufe2 = Stufe1

        Stufe11 = Stufe1 + 1
        If Stufe11 > Stufe3 Then
            Stufe11 = Stufe3
        End If
        Stufe12 = Stufe1 + 2
        If Stufe12 > Stufe3 Then
            Stufe12 = Stufe3
        End If
        Stufe13 = Stufe1 + 3
        If Stufe13 > Stufe3 Then
            Stufe13 = Stufe3
        End If
        Stufe14 = Stufe1 + 4
        If Stufe14 > Stufe3 Then
            Stufe14 = Stufe3
        End If

        Stufe21 = Stufe2 + 1
        If Stufe21 > Stufe3 Then
            Stufe21 = Stufe3
        End If
        Stufe22 = Stufe2 + 2
        If Stufe22 > Stufe3 Then
            Stufe22 = Stufe3
        End If
        Stufe23 = Stufe2 + 3
        If Stufe23 > Stufe3 Then
            Stufe23 = Stufe3
        End If
        Stufe24 = Stufe2 + 4
        If Stufe24 > Stufe3 Then
            Stufe24 = Stufe3
        End If
        If G_200 > 0 Then
            If G_200 < Stufe4 Then
                G_200 = Stufe4
            End If
        Else
            G_200 = Stufe4
        End If

        If Betriebsart = 1 And (_GlsL38 = 3 Or _GlsL38 = 4) Then
            SetProgramCounterLabel1(_Prog38)
        Else
            SetProgramCounterLabel(_Prog38)
        End If

        ' Lok starten - Bahnhofsausfahrt

        If _Prog38 = 0 Then
            Prog_Lok38.Interval = 2000
            If _Fahrzeugbeleuchtung2 > 0 Then
                _eb.lokSteuern(38, Klassen.LokEigenschaften.Hauptfunktion, 1) ' Licht ein
            End If
        ElseIf _Prog38 = 1 Then
        ElseIf _Prog38 = 2 Then
            _Betriebsparameter.RundenErhoehen(38)
        ElseIf _Prog38 = 3 Then
        ElseIf _Prog38 = 4 Then
        ElseIf _Prog38 = 5 Then

            ' Bahnhofsausfahrt

        ElseIf _Prog38 = 6 Then
            If _AkustischeSignale > 0 Then
                _eb.lokSteuern(38, Klassen.LokEigenschaften.Funktion3, 1) ' Pfiff ein
            End If
        ElseIf _Prog38 = 7 Then
            _eb.lokSteuern(38, Klassen.LokEigenschaften.Funktion3, 0) ' Pfiff aus
        ElseIf _Prog38 = 8 Then
            _eb.lokSteuern(38, Klassen.LokEigenschaften.Geschwindigkeit, Stufe1)
        ElseIf _Prog38 = 9 Then
            _eb.lokSteuern(38, Klassen.LokEigenschaften.Geschwindigkeit, Stufe11)
        ElseIf _Prog38 = 10 Then
            _eb.lokSteuern(38, Klassen.LokEigenschaften.Geschwindigkeit, Stufe12)
        ElseIf _Prog38 = 11 Then
            _eb.lokSteuern(38, Klassen.LokEigenschaften.Geschwindigkeit, Stufe13)
        ElseIf _Prog38 = 12 Then
            _eb.lokSteuern(38, Klassen.LokEigenschaften.Geschwindigkeit, Stufe14)
        ElseIf _Prog38 = 13 Then
            _eb.lokSteuern(38, Klassen.LokEigenschaften.Geschwindigkeit, Stufe3)

            ' Lok abstellen

        ElseIf _Prog38 = 50 Then
            Prog_Lok38.Interval = 2000
        ElseIf _Prog38 = 51 Then
        ElseIf _Prog38 = 52 Then
            If _Fahrzeugbeleuchtung2 < 2 Then
                _eb.lokSteuern(38, Klassen.LokEigenschaften.Hauptfunktion, 0) ' Licht aus
            End If

            ' Lok bremsen (Bahnhofseinfahrt Normalzug von links und von rechts)

        ElseIf _Prog38 = 100 Then
            Prog_Lok38.Interval = V_100
        ElseIf _Prog38 = 101 Then
            _eb.lokSteuern(38, Klassen.LokEigenschaften.Geschwindigkeit, Stufe24)
            Prog_Lok38.Interval = T_100
        ElseIf _Prog38 = 102 Then
            _eb.lokSteuern(38, Klassen.LokEigenschaften.Geschwindigkeit, Stufe23)
        ElseIf _Prog38 = 103 Then
            _eb.lokSteuern(38, Klassen.LokEigenschaften.Geschwindigkeit, Stufe22)
        ElseIf _Prog38 = 104 Then
            _eb.lokSteuern(38, Klassen.LokEigenschaften.Geschwindigkeit, Stufe21)
        ElseIf _Prog38 = 105 Then
            _eb.lokSteuern(38, Klassen.LokEigenschaften.Geschwindigkeit, Stufe2)

            ' Lok bremsen (Bahnhofseinfahrt Kurzzug von links)

        ElseIf _Prog38 = 130 Then
            Prog_Lok38.Interval = V_130
        ElseIf _Prog38 = 131 Then
            _eb.lokSteuern(38, Klassen.LokEigenschaften.Geschwindigkeit, Stufe24)
            Prog_Lok38.Interval = T_130
        ElseIf _Prog38 = 132 Then
            _eb.lokSteuern(38, Klassen.LokEigenschaften.Geschwindigkeit, Stufe23)
        ElseIf _Prog38 = 133 Then
            _eb.lokSteuern(38, Klassen.LokEigenschaften.Geschwindigkeit, Stufe22)
        ElseIf _Prog38 = 134 Then
            _eb.lokSteuern(38, Klassen.LokEigenschaften.Geschwindigkeit, Stufe21)
        ElseIf _Prog38 = 135 Then
            _eb.lokSteuern(38, Klassen.LokEigenschaften.Geschwindigkeit, Stufe2)
        ElseIf _Prog38 = 136 Then
            _eb.lokSteuern(38, Klassen.LokEigenschaften.Geschwindigkeit, 0)
        ElseIf _Prog38 = 137 Then
            Prog_Lok38.Interval = 2000
        ElseIf _Prog38 = 138 Then
            If _Fahrzeugbeleuchtung2 < 2 Then
                _eb.lokSteuern(38, Klassen.LokEigenschaften.Hauptfunktion, 0) ' Licht aus
            End If

            ' Lok bremsen (Bahnhofseinfahrt Kurzzug von rechts)

        ElseIf _Prog38 = 160 Then
            Prog_Lok38.Interval = V_160
        ElseIf _Prog38 = 161 Then
            _eb.lokSteuern(38, Klassen.LokEigenschaften.Geschwindigkeit, Stufe24)
            Prog_Lok38.Interval = T_160
        ElseIf _Prog38 = 162 Then
            _eb.lokSteuern(38, Klassen.LokEigenschaften.Geschwindigkeit, Stufe23)
        ElseIf _Prog38 = 163 Then
            _eb.lokSteuern(38, Klassen.LokEigenschaften.Geschwindigkeit, Stufe22)
        ElseIf _Prog38 = 164 Then
            _eb.lokSteuern(38, Klassen.LokEigenschaften.Geschwindigkeit, Stufe21)
        ElseIf _Prog38 = 165 Then
            _eb.lokSteuern(38, Klassen.LokEigenschaften.Geschwindigkeit, Stufe2)
        ElseIf _Prog38 = 166 Then
            _eb.lokSteuern(38, Klassen.LokEigenschaften.Geschwindigkeit, 0)
        ElseIf _Prog38 = 167 Then
            Prog_Lok38.Interval = 2000
        ElseIf _Prog38 = 168 Then
            If _Fahrzeugbeleuchtung2 < 2 Then
                _eb.lokSteuern(38, Klassen.LokEigenschaften.Hauptfunktion, 0) ' Licht aus
            End If

            ' Rangierzug

        ElseIf _Prog38 = 180 Then
            _eb.lokSteuern(38, Klassen.LokEigenschaften.Geschwindigkeit, 2)
            Prog_Lok38.Interval = V_180
        ElseIf _Prog38 = 181 Then
            Prog_Lok38.Interval = T_180
            _eb.lokSteuern(38, Klassen.LokEigenschaften.Geschwindigkeit, 1)
        ElseIf _Prog38 = 182 Then
            _eb.lokSteuern(38, Klassen.LokEigenschaften.Geschwindigkeit, 0)

            ' Tunnelausfahrt

        ElseIf _Prog38 = 200 Then ' Kontakt 1.2 <- (bergauf)
            _eb.lokSteuern(38, Klassen.LokEigenschaften.Geschwindigkeit, G_200)
            Prog_Lok38.Interval = 2000
        ElseIf _Prog38 = 201 Then
        ElseIf _Prog38 = 202 Then
        ElseIf _Prog38 = 203 Then
        ElseIf _Prog38 = 204 Then
        ElseIf _Prog38 = 205 Then
            If Stufe4 < Stufe3 Then
                _eb.lokSteuern(38, Klassen.LokEigenschaften.Geschwindigkeit, Stufe3)
            Else
                _eb.lokSteuern(38, Klassen.LokEigenschaften.Geschwindigkeit, Stufe4)
            End If
        ElseIf _Prog38 = 206 Then
        ElseIf _Prog38 = 207 Then
            If _AkustischeSignale > 1 Then
                _eb.lokSteuern(38, Klassen.LokEigenschaften.Funktion3, 1) ' Hupe ein
            End If
        ElseIf _Prog38 = 208 Then
            _eb.lokSteuern(38, Klassen.LokEigenschaften.Funktion3, 0) ' Hupe aus

        ElseIf _Prog38 = 220 Then ' Kontakt 3.1 -> (hinter dem Martinstor bergauf)
            Prog_Lok38.Interval = 2000
        ElseIf _Prog38 = 221 Then
        ElseIf _Prog38 = 222 Then

        ElseIf _Prog38 = 240 Then ' Kontakt 3.7 <- (hinter der Brücke bergauf)
            Prog_Lok38.Interval = 2000
        ElseIf _Prog38 = 241 Then
        ElseIf _Prog38 = 242 Then
        ElseIf _Prog38 = 243 Then
        ElseIf _Prog38 = 244 Then
            If _AkustischeSignale > 1 Then
                _eb.lokSteuern(38, Klassen.LokEigenschaften.Funktion3, 1) ' Pfiff ein
            End If
        ElseIf _Prog38 = 245 Then
            _eb.lokSteuern(38, Klassen.LokEigenschaften.Funktion3, 0) ' Pfiff aus

        ElseIf _Prog38 = 260 Then ' Kontakt 3.3 (links bzw vor der Brücke)
            Prog_Lok38.Interval = 2000
        ElseIf _Prog38 = 261 Then
        ElseIf _Prog38 = 262 Then
            _eb.lokSteuern(38, Klassen.LokEigenschaften.Geschwindigkeit, Stufe3)

        ElseIf _Prog38 = 600 Then ' Kontakt 3.5 <- (unter der Burg)
            Prog_Lok38.Interval = 1000
        ElseIf _Prog38 = 601 Then
            If _AkustischeSignale > 1 Then
                _eb.lokSteuern(38, Klassen.LokEigenschaften.Funktion3, 1) ' Pfiff ein
            End If
        ElseIf _Prog38 = 602 Then
            _eb.lokSteuern(38, Klassen.LokEigenschaften.Funktion3, 0) ' Pfiff aus

        ElseIf _Prog38 = 620 Then ' Kontakt 3.7 -> (hinter der Brücke bergab)
            Prog_Lok38.Interval = 2000
        ElseIf _Prog38 = 621 Then
        ElseIf _Prog38 = 622 Then
        ElseIf _Prog38 = 623 Then
            If _AkustischeSignale > 1 Then
                _eb.lokSteuern(38, Klassen.LokEigenschaften.Funktion3, 1) ' Pfiff ein
            End If
        ElseIf _Prog38 = 624 Then
            _eb.lokSteuern(38, Klassen.LokEigenschaften.Funktion3, 0) ' Pfiff aus

        ElseIf _Prog38 = 640 Then ' Kontakt 3.1 <- Talfahrt
            Prog_Lok38.Interval = 2000
        ElseIf _Prog38 = 641 Then
        ElseIf _Prog38 = 642 Then

        ElseIf _Prog38 = 660 Then ' Kontakt 1.2 -> Talfahrt
            Prog_Lok38.Interval = 2000
        ElseIf _Prog38 = 661 Then
        ElseIf _Prog38 = 662 Then
        ElseIf _Prog38 = 663 Then
            If _GlsL38 = 1 Or _GlsL38 = 2 Then
                If _AkustischeSignale > 1 Then
                    _eb.lokSteuern(38, Klassen.LokEigenschaften.Funktion3, 1) ' Pfiff ein
                End If
            End If
        ElseIf _Prog38 = 664 Then
            _eb.lokSteuern(38, Klassen.LokEigenschaften.Funktion3, 0) ' Pfiff aus

        ElseIf _Prog38 = 700 Then ' Kontakt 0.4 <- Diagonale
            Prog_Lok38.Interval = 2000
        ElseIf _Prog38 = 701 Then
        ElseIf _Prog38 = 702 Then
        ElseIf _Prog38 = 703 Then
        ElseIf _Prog38 = 704 Then
        ElseIf _Prog38 = 705 Then
            If _AkustischeSignale > 1 Then
                _eb.lokSteuern(38, Klassen.LokEigenschaften.Funktion3, 1) ' Pfiff ein
            End If
        ElseIf _Prog38 = 706 Then
            _eb.lokSteuern(38, Klassen.LokEigenschaften.Funktion3, 0) ' Pfiff aus

            ' Zindelstein

        ElseIf _Prog38 = 500 Then
            Prog_Lok38.Interval = V_500
        ElseIf _Prog38 = 501 Then
            _eb.lokSteuern(38, Klassen.LokEigenschaften.Geschwindigkeit, Stufe23)
            Prog_Lok38.Interval = T_100
        ElseIf _Prog38 = 502 Then
            _eb.lokSteuern(38, Klassen.LokEigenschaften.Geschwindigkeit, Stufe22)
        ElseIf _Prog38 = 503 Then
            _eb.lokSteuern(38, Klassen.LokEigenschaften.Geschwindigkeit, Stufe21)
        ElseIf _Prog38 = 504 Then
            _eb.lokSteuern(38, Klassen.LokEigenschaften.Geschwindigkeit, Stufe2)
        ElseIf _Prog38 = 505 Then
            _eb.lokSteuern(38, Klassen.LokEigenschaften.Geschwindigkeit, 0)


        Else
            _Prog38 = 0
            Prog_Lok38.Stop()
            Prog_Lok38.Interval = 200
            If Betriebsart = 1 Then
                SetProgramCounterLabel1(String.Empty)
            Else
                SetProgramCounterLabel(String.Empty)
            End If
        End If
        _Prog38 = _Prog38 + 1
    End Sub
    Private Sub HandleTimerElapsed51(sender As System.Object, e As System.EventArgs) Handles Prog_Lok39.Elapsed

        '*** Fahrprogramm für E-Lok E60 10
        '*** Datum: 23.02.2020

        SetText(TextBox1, "E-Lok E60 10                                                            IBS: 18.02.2023 - V3:7")
        LoadImage(PictureBox1, "H:\\EB_Media\\LokFotos\\Baureihe_60_01.jpg")
        GeschwindikeitenSetzen(39)

        Dim Stufe1, Stufe2, Stufe3, Stufe4 As Integer
        Dim Stufe11, Stufe12, Stufe13, Stufe14, Stufe21, Stufe22, Stufe23, Stufe24 As Integer
        Dim V_100, V_130, V_160, V_180, V_500 As Integer
        Dim T_100, T_130, T_160, T_180, T_500 As Integer
        Dim G_200 As Integer

        T_100 = _Betriebsparameter.Fahrparameter(39, KlausEBspecific.Betriebsparameter.FahrparameterEnum.T_100)
        T_130 = _Betriebsparameter.Fahrparameter(39, KlausEBspecific.Betriebsparameter.FahrparameterEnum.T_130)
        T_160 = _Betriebsparameter.Fahrparameter(39, KlausEBspecific.Betriebsparameter.FahrparameterEnum.T_160)
        T_180 = _Betriebsparameter.Fahrparameter(39, KlausEBspecific.Betriebsparameter.FahrparameterEnum.T_180)
        T_500 = _Betriebsparameter.Fahrparameter(39, KlausEBspecific.Betriebsparameter.FahrparameterEnum.T_500)
        V_100 = _Betriebsparameter.Fahrparameter(39, KlausEBspecific.Betriebsparameter.FahrparameterEnum.V_100)
        V_130 = _Betriebsparameter.Fahrparameter(39, KlausEBspecific.Betriebsparameter.FahrparameterEnum.V_130)
        V_160 = _Betriebsparameter.Fahrparameter(39, KlausEBspecific.Betriebsparameter.FahrparameterEnum.V_160)
        V_180 = _Betriebsparameter.Fahrparameter(39, KlausEBspecific.Betriebsparameter.FahrparameterEnum.V_180)
        V_500 = _Betriebsparameter.Fahrparameter(39, KlausEBspecific.Betriebsparameter.FahrparameterEnum.V_500)
        G_200 = _Betriebsparameter.Fahrparameter(39, KlausEBspecific.Betriebsparameter.FahrparameterEnum.G_200)

        If A_StopB = 1 Then
            V_100 = 8000
        End If

        Stufe1 = _LokStufen.Holen(39, 1)
        Stufe2 = _LokStufen.Holen(39, 2)
        Stufe3 = _LokStufen.Holen(39, 3)
        Stufe4 = _LokStufen.Holen(39, 4)

        If Stufe2 = 1 Then
            T_100 = T_100
            T_130 = T_130
            T_160 = T_160
            V_180 = V_180
        ElseIf Stufe2 = 2 Then
            T_100 = T_100 + 300
            T_130 = T_130 + 300
            T_160 = T_160 + 300
            V_180 = V_180 + 500
        ElseIf Stufe2 = 3 Then
            T_100 = T_100 + 500
            T_130 = T_130 + 500
            T_160 = T_160 + 500
            V_180 = V_180 + 1000
        ElseIf Stufe2 = 4 Then
            T_100 = T_100 + 700
            T_130 = T_130 + 700
            T_160 = T_160 + 700
            V_180 = V_180 + 1500
        ElseIf Stufe2 = 5 Then
            T_100 = T_100 + 900
            T_130 = T_130 + 900
            T_160 = T_160 + 900
            V_180 = V_180 + 2000
        ElseIf Stufe2 = 6 Then
            T_100 = T_100 + 1200
            T_130 = T_130 + 1200
            T_160 = T_160 + 1200
            V_180 = V_180 + 2500
        Else
            T_100 = T_100 + 1200
            T_130 = T_130 + 1200
            T_160 = T_160 + 1200
            V_180 = V_180 + 2500
        End If

        Stufe2 = Stufe1

        Stufe11 = Stufe1 + 1
        If Stufe11 > Stufe3 Then
            Stufe11 = Stufe3
        End If
        Stufe12 = Stufe1 + 2
        If Stufe12 > Stufe3 Then
            Stufe12 = Stufe3
        End If
        Stufe13 = Stufe1 + 3
        If Stufe13 > Stufe3 Then
            Stufe13 = Stufe3
        End If
        Stufe14 = Stufe1 + 4
        If Stufe14 > Stufe3 Then
            Stufe14 = Stufe3
        End If

        Stufe21 = Stufe2 + 1
        If Stufe21 > Stufe3 Then
            Stufe21 = Stufe3
        End If
        Stufe22 = Stufe2 + 2
        If Stufe22 > Stufe3 Then
            Stufe22 = Stufe3
        End If
        Stufe23 = Stufe2 + 3
        If Stufe23 > Stufe3 Then
            Stufe23 = Stufe3
        End If
        Stufe24 = Stufe2 + 4
        If Stufe24 > Stufe3 Then
            Stufe24 = Stufe3
        End If
        If G_200 > 0 Then
            If G_200 < Stufe4 Then
                G_200 = Stufe4
            End If
        Else
            G_200 = Stufe4
        End If

        If Betriebsart = 1 And (_GlsL39 = 3 Or _GlsL39 = 4) Then
            SetProgramCounterLabel1(_Prog39)
        Else
            SetProgramCounterLabel(_Prog39)
        End If

        ' Lok starten - Bahnhofsausfahrt

        If _Prog39 = 0 Then
            Prog_Lok39.Interval = 2000
        ElseIf _Prog39 = 1 Then
            If _Fahrzeugbeleuchtung2 > 0 Then
                _eb.lokSteuern(39, Klassen.LokEigenschaften.Hauptfunktion, 1) ' Licht ein
            End If
        ElseIf _Prog39 = 2 Then
            _Betriebsparameter.RundenErhoehen(39)
        ElseIf _Prog39 = 3 Then
        ElseIf _Prog39 = 4 Then
        ElseIf _Prog39 = 5 Then
        ElseIf _Prog39 = 6 Then

            ' Bahnhofsausfahrt

        ElseIf _Prog39 = 7 Then
            _eb.lokSteuern(39, Klassen.LokEigenschaften.Geschwindigkeit, Stufe1)
        ElseIf _Prog39 = 8 Then
            _eb.lokSteuern(39, Klassen.LokEigenschaften.Geschwindigkeit, Stufe11)
        ElseIf _Prog39 = 9 Then
            _eb.lokSteuern(39, Klassen.LokEigenschaften.Geschwindigkeit, Stufe12)
        ElseIf _Prog39 = 10 Then
            _eb.lokSteuern(39, Klassen.LokEigenschaften.Geschwindigkeit, Stufe13)
        ElseIf _Prog39 = 11 Then
            _eb.lokSteuern(39, Klassen.LokEigenschaften.Geschwindigkeit, Stufe14)
        ElseIf _Prog39 = 12 Then
            _eb.lokSteuern(39, Klassen.LokEigenschaften.Geschwindigkeit, Stufe3)

            ' Lok abstellen

        ElseIf _Prog39 = 50 Then
            Prog_Lok39.Interval = 2000
        ElseIf _Prog39 = 51 Then
        ElseIf _Prog39 = 52 Then
            If _Fahrzeugbeleuchtung2 < 2 Then
                _eb.lokSteuern(39, Klassen.LokEigenschaften.Hauptfunktion, 0) ' Licht aus
            End If

            ' Lok bremsen (Bahnhofseinfahrt Normalzug von links und von rechts)

        ElseIf _Prog39 = 100 Then
            Prog_Lok39.Interval = V_100
        ElseIf _Prog39 = 101 Then
            _eb.lokSteuern(39, Klassen.LokEigenschaften.Geschwindigkeit, Stufe24)
            Prog_Lok39.Interval = T_100
        ElseIf _Prog39 = 102 Then
            _eb.lokSteuern(39, Klassen.LokEigenschaften.Geschwindigkeit, Stufe23)
        ElseIf _Prog39 = 103 Then
            _eb.lokSteuern(39, Klassen.LokEigenschaften.Geschwindigkeit, Stufe22)
        ElseIf _Prog39 = 104 Then
            _eb.lokSteuern(39, Klassen.LokEigenschaften.Geschwindigkeit, Stufe21)
        ElseIf _Prog39 = 105 Then
            _eb.lokSteuern(39, Klassen.LokEigenschaften.Geschwindigkeit, Stufe2)

            ' Lok bremsen (Bahnhofseinfahrt Kurzzug von links)

        ElseIf _Prog39 = 130 Then
            Prog_Lok39.Interval = V_130
        ElseIf _Prog39 = 131 Then
            _eb.lokSteuern(39, Klassen.LokEigenschaften.Geschwindigkeit, Stufe24)
            Prog_Lok39.Interval = T_130
        ElseIf _Prog39 = 132 Then
            _eb.lokSteuern(39, Klassen.LokEigenschaften.Geschwindigkeit, Stufe23)
        ElseIf _Prog39 = 133 Then
            _eb.lokSteuern(39, Klassen.LokEigenschaften.Geschwindigkeit, Stufe22)
        ElseIf _Prog39 = 134 Then
            _eb.lokSteuern(39, Klassen.LokEigenschaften.Geschwindigkeit, Stufe21)
        ElseIf _Prog39 = 135 Then
            _eb.lokSteuern(39, Klassen.LokEigenschaften.Geschwindigkeit, Stufe2)
        ElseIf _Prog39 = 136 Then
            _eb.lokSteuern(39, Klassen.LokEigenschaften.Geschwindigkeit, 0)
        ElseIf _Prog39 = 137 Then
            Prog_Lok39.Interval = 2000
        ElseIf _Prog39 = 138 Then
            If _Fahrzeugbeleuchtung2 < 2 Then
                _eb.lokSteuern(39, Klassen.LokEigenschaften.Hauptfunktion, 0) ' Licht aus
            End If

            ' Lok bremsen (Bahnhofseinfahrt Kurzzug von rechts)

        ElseIf _Prog39 = 160 Then
            Prog_Lok39.Interval = V_160
        ElseIf _Prog39 = 161 Then
            _eb.lokSteuern(39, Klassen.LokEigenschaften.Geschwindigkeit, Stufe24)
            Prog_Lok39.Interval = T_160
        ElseIf _Prog39 = 162 Then
            _eb.lokSteuern(39, Klassen.LokEigenschaften.Geschwindigkeit, Stufe23)
        ElseIf _Prog39 = 163 Then
            _eb.lokSteuern(39, Klassen.LokEigenschaften.Geschwindigkeit, Stufe22)
        ElseIf _Prog39 = 164 Then
            _eb.lokSteuern(39, Klassen.LokEigenschaften.Geschwindigkeit, Stufe21)
        ElseIf _Prog39 = 165 Then
            _eb.lokSteuern(39, Klassen.LokEigenschaften.Geschwindigkeit, Stufe2)
        ElseIf _Prog39 = 166 Then
            _eb.lokSteuern(39, Klassen.LokEigenschaften.Geschwindigkeit, 0)
        ElseIf _Prog39 = 167 Then
            Prog_Lok39.Interval = 2000
        ElseIf _Prog39 = 168 Then
            If _Fahrzeugbeleuchtung2 < 2 Then
                _eb.lokSteuern(39, Klassen.LokEigenschaften.Hauptfunktion, 0) ' Licht aus
            End If

            ' Rangierzug

        ElseIf _Prog39 = 180 Then
            _eb.lokSteuern(39, Klassen.LokEigenschaften.Geschwindigkeit, Stufe2)
            Prog_Lok39.Interval = V_180
        ElseIf _Prog39 = 181 Then
            Prog_Lok39.Interval = T_180
            _eb.lokSteuern(39, Klassen.LokEigenschaften.Geschwindigkeit, 1)
        ElseIf _Prog39 = 182 Then
            _eb.lokSteuern(39, Klassen.LokEigenschaften.Geschwindigkeit, 0)

            ' Tunnelausfahrt

        ElseIf _Prog39 = 200 Then ' Kontakt 1.2 <- (bergauf)
            _eb.lokSteuern(39, Klassen.LokEigenschaften.Geschwindigkeit, G_200)
            Prog_Lok39.Interval = 2000
        ElseIf _Prog39 = 201 Then
        ElseIf _Prog39 = 202 Then
        ElseIf _Prog39 = 203 Then
        ElseIf _Prog39 = 204 Then
        ElseIf _Prog39 = 205 Then
            If Stufe4 < Stufe3 Then
                _eb.lokSteuern(39, Klassen.LokEigenschaften.Geschwindigkeit, Stufe3)
            Else
                _eb.lokSteuern(39, Klassen.LokEigenschaften.Geschwindigkeit, Stufe4)
            End If

        ElseIf _Prog39 = 220 Then ' Kontakt 3.1 -> (hinter dem Martinstor bergauf)
            Prog_Lok39.Interval = 2000
        ElseIf _Prog39 = 221 Then
        ElseIf _Prog39 = 222 Then

        ElseIf _Prog39 = 240 Then ' Kontakt 3.7 <- (hinter der Brücke bergauf)
            Prog_Lok39.Interval = 2000
        ElseIf _Prog39 = 241 Then
        ElseIf _Prog39 = 242 Then

        ElseIf _Prog39 = 260 Then ' Kontakt 3.3 (links bzw vor der Brücke)
            Prog_Lok39.Interval = 2000
        ElseIf _Prog39 = 261 Then
        ElseIf _Prog39 = 262 Then
            _eb.lokSteuern(39, Klassen.LokEigenschaften.Geschwindigkeit, Stufe3)

        ElseIf _Prog39 = 600 Then ' Kontakt 3.5 <- (unter der Burg)
            Prog_Lok39.Interval = 2000
        ElseIf _Prog39 = 601 Then
        ElseIf _Prog39 = 602 Then

        ElseIf _Prog39 = 620 Then ' Kontakt 3.7 -> (hinter der Brücke bergab)
            Prog_Lok39.Interval = 2000
        ElseIf _Prog39 = 621 Then
        ElseIf _Prog39 = 622 Then

        ElseIf _Prog39 = 640 Then ' Kontakt 3.1 <- Talfahrt
            Prog_Lok39.Interval = 2000
        ElseIf _Prog39 = 641 Then
        ElseIf _Prog39 = 642 Then

        ElseIf _Prog39 = 660 Then ' Kontakt 1.2 -> Talfahrt
            Prog_Lok39.Interval = 2000
        ElseIf _Prog39 = 661 Then
        ElseIf _Prog39 = 662 Then

        ElseIf _Prog39 = 700 Then ' Kontakt 0.4 <- Diagonale
            Prog_Lok39.Interval = 2000
        ElseIf _Prog39 = 701 Then
        ElseIf _Prog39 = 702 Then

            ' Zindelstein

        ElseIf _Prog39 = 500 Then
            Prog_Lok39.Interval = V_500
        ElseIf _Prog39 = 501 Then
            _eb.lokSteuern(39, Klassen.LokEigenschaften.Geschwindigkeit, Stufe23)
            Prog_Lok39.Interval = T_500
        ElseIf _Prog39 = 502 Then
            _eb.lokSteuern(39, Klassen.LokEigenschaften.Geschwindigkeit, Stufe22)
        ElseIf _Prog39 = 503 Then
            _eb.lokSteuern(39, Klassen.LokEigenschaften.Geschwindigkeit, Stufe21)
        ElseIf _Prog39 = 504 Then
            _eb.lokSteuern(39, Klassen.LokEigenschaften.Geschwindigkeit, Stufe2)
        ElseIf _Prog39 = 505 Then
            _eb.lokSteuern(39, Klassen.LokEigenschaften.Geschwindigkeit, 0)


        Else
            _Prog39 = 0
            Prog_Lok39.Stop()
            Prog_Lok39.Interval = 200
            If Betriebsart = 1 Then
                SetProgramCounterLabel1(String.Empty)
            Else
                SetProgramCounterLabel(String.Empty)
            End If
        End If
        _Prog39 = _Prog39 + 1
    End Sub
    Private Sub HandleTimerElapsed52(sender As System.Object, e As System.EventArgs) Handles Prog_Lok40.Elapsed

        '*** Fahrprogramm für Triebwagen ET 87
        '*** Datum: 23.02.2020 +

        SetText(TextBox1, "Triebwagen ET 87                                                        IBS: 10.12.2025 V3: 10")
        LoadImage(PictureBox1, "H:\\EB_Media\\LokFotos\\Baureihe_ET87_01.jpg")
        GeschwindikeitenSetzen(40)

        Dim Stufe1, Stufe2, Stufe3, Stufe4 As Integer
        Dim Stufe11, Stufe12, Stufe13, Stufe14, Stufe21, Stufe22, Stufe23, Stufe24 As Integer
        Dim V_100, V_130, V_160, V_180, V_500 As Integer
        Dim T_100, T_130, T_160, T_180, T_500 As Integer
        Dim G_200 As Integer

        T_100 = _Betriebsparameter.Fahrparameter(40, KlausEBspecific.Betriebsparameter.FahrparameterEnum.T_100)
        T_130 = _Betriebsparameter.Fahrparameter(40, KlausEBspecific.Betriebsparameter.FahrparameterEnum.T_130)
        T_160 = _Betriebsparameter.Fahrparameter(40, KlausEBspecific.Betriebsparameter.FahrparameterEnum.T_160)
        T_180 = _Betriebsparameter.Fahrparameter(40, KlausEBspecific.Betriebsparameter.FahrparameterEnum.T_180)
        T_500 = _Betriebsparameter.Fahrparameter(40, KlausEBspecific.Betriebsparameter.FahrparameterEnum.T_500)
        V_100 = _Betriebsparameter.Fahrparameter(40, KlausEBspecific.Betriebsparameter.FahrparameterEnum.V_100)
        V_130 = _Betriebsparameter.Fahrparameter(40, KlausEBspecific.Betriebsparameter.FahrparameterEnum.V_130)
        V_160 = _Betriebsparameter.Fahrparameter(40, KlausEBspecific.Betriebsparameter.FahrparameterEnum.V_160)
        V_180 = _Betriebsparameter.Fahrparameter(40, KlausEBspecific.Betriebsparameter.FahrparameterEnum.V_180)
        V_500 = _Betriebsparameter.Fahrparameter(40, KlausEBspecific.Betriebsparameter.FahrparameterEnum.V_500)
        G_200 = _Betriebsparameter.Fahrparameter(40, KlausEBspecific.Betriebsparameter.FahrparameterEnum.G_200)

        If A_StopB = 1 Then
            V_100 = 8000
        End If

        Stufe1 = _LokStufen.Holen(40, 1)
        Stufe2 = _LokStufen.Holen(40, 2)
        Stufe3 = _LokStufen.Holen(40, 3)
        Stufe4 = _LokStufen.Holen(40, 4)

        If Stufe2 = 1 Then
            T_100 = T_100
            T_130 = T_130
            T_160 = T_160
            V_180 = V_180
        ElseIf Stufe2 = 2 Then
            T_100 = T_100 + 300
            T_130 = T_130 + 300
            T_160 = T_160 + 300
            V_180 = V_180 + 500
        ElseIf Stufe2 = 3 Then
            T_100 = T_100 + 500
            T_130 = T_130 + 500
            T_160 = T_160 + 500
            V_180 = V_180 + 1000
        ElseIf Stufe2 = 4 Then
            T_100 = T_100 + 700
            T_130 = T_130 + 700
            T_160 = T_160 + 700
            V_180 = V_180 + 1500
        ElseIf Stufe2 = 5 Then
            T_100 = T_100 + 900
            T_130 = T_130 + 900
            T_160 = T_160 + 900
            V_180 = V_180 + 2000
        ElseIf Stufe2 = 6 Then
            T_100 = T_100 + 1200
            T_130 = T_130 + 1200
            T_160 = T_160 + 1200
            V_180 = V_180 + 2500
        Else
            T_100 = T_100 + 1200
            T_130 = T_130 + 1200
            T_160 = T_160 + 1200
            V_180 = V_180 + 2500
        End If

        Stufe2 = Stufe1

        Stufe11 = Stufe1 + 1
        If Stufe11 > Stufe3 Then
            Stufe11 = Stufe3
        End If
        Stufe12 = Stufe1 + 2
        If Stufe12 > Stufe3 Then
            Stufe12 = Stufe3
        End If
        Stufe13 = Stufe1 + 3
        If Stufe13 > Stufe3 Then
            Stufe13 = Stufe3
        End If
        Stufe14 = Stufe1 + 4
        If Stufe14 > Stufe3 Then
            Stufe14 = Stufe3
        End If

        Stufe21 = Stufe2 + 1
        If Stufe21 > Stufe3 Then
            Stufe21 = Stufe3
        End If
        Stufe22 = Stufe2 + 2
        If Stufe22 > Stufe3 Then
            Stufe22 = Stufe3
        End If
        Stufe23 = Stufe2 + 3
        If Stufe23 > Stufe3 Then
            Stufe23 = Stufe3
        End If
        Stufe24 = Stufe2 + 4
        If Stufe24 > Stufe3 Then
            Stufe24 = Stufe3
        End If
        If G_200 > 0 Then
            If G_200 < Stufe4 Then
                G_200 = Stufe4
            End If
        Else
            G_200 = Stufe4
        End If

        If Betriebsart = 1 And (_GlsL40 = 3 Or _GlsL40 = 4) Then
            SetProgramCounterLabel1(_Prog40)
        Else
            SetProgramCounterLabel(_Prog40)
        End If

        ' Lok starten - Bahnhofsausfahrt

        If _Prog40 = 0 Then
            Prog_Lok40.Interval = 2000
        ElseIf _Prog40 = 1 Then
            _eb.lokSteuern(40, Klassen.LokEigenschaften.Geschwindigkeit, 0)
        ElseIf _Prog40 = 2 Then
            If _Fahrzeugbeleuchtung2 > 0 Then
                _eb.lokSteuern(40, Klassen.LokEigenschaften.Hauptfunktion, 1) ' Licht ein
            End If
        ElseIf _Prog40 = 3 Then
            If _Innenbeleuchtung2 > 0 Then
                _eb.lokSteuern(40, Klassen.LokEigenschaften.Funktion1, 1) ' Innenbeleuchtung ein
            End If
        ElseIf _Prog40 = 4 Then
            If _Motor = 0 Then
                _Prog40 = 7
            End If
        ElseIf _Prog40 = 5 Then
            If _Motor > 0 Then
                _eb.lokSteuern(40, Klassen.LokEigenschaften.Funktion2, 1) ' Motor ein
            Else
                _Prog40 = 7
            End If
        ElseIf _Prog40 = 6 Then
            _Betriebsparameter.RundenErhoehen(40)
        ElseIf _Prog40 = 7 Then
        ElseIf _Prog40 = 8 Then
        ElseIf _Prog40 = 9 Then
        ElseIf _Prog40 = 10 Then
        ElseIf _Prog40 = 11 Then

            ' Bahnhofsausfahrt

        ElseIf _Prog40 = 12 Then
            If _AkustischeSignale > 0 Then
                _eb.lokSteuern(40, Klassen.LokEigenschaften.Funktion3, 1) ' Pfiff ein
            End If
        ElseIf _Prog40 = 13 Then
            _eb.lokSteuern(40, Klassen.LokEigenschaften.Funktion3, 0) ' Pfiff aus
        ElseIf _Prog40 = 14 Then
            _eb.lokSteuern(40, Klassen.LokEigenschaften.Geschwindigkeit, Stufe1)
        ElseIf _Prog40 = 15 Then
            _eb.lokSteuern(40, Klassen.LokEigenschaften.Geschwindigkeit, Stufe11)
        ElseIf _Prog40 = 16 Then
            _eb.lokSteuern(40, Klassen.LokEigenschaften.Geschwindigkeit, Stufe12)
        ElseIf _Prog40 = 17 Then
            _eb.lokSteuern(40, Klassen.LokEigenschaften.Geschwindigkeit, Stufe13)
        ElseIf _Prog40 = 18 Then
            _eb.lokSteuern(40, Klassen.LokEigenschaften.Geschwindigkeit, Stufe14)
        ElseIf _Prog40 = 19 Then
            _eb.lokSteuern(40, Klassen.LokEigenschaften.Geschwindigkeit, Stufe3)
        ElseIf _Prog40 = 20 Then
        ElseIf _Prog40 = 21 Then
        ElseIf _Prog40 = 22 Then
        ElseIf _Prog40 = 23 Then
        ElseIf _Prog40 = 24 Then
        ElseIf _Prog40 = 25 Then
            If _Motor < 3 Then
                _eb.lokSteuern(40, Klassen.LokEigenschaften.Funktion2, 0) ' Motor aus
            End If

            ' Lok abstellen

        ElseIf _Prog40 = 50 Then
            Prog_Lok40.Interval = 2000
            If _Motor < 2 Then
                _eb.lokSteuern(40, Klassen.LokEigenschaften.Funktion2, 0) ' Motor aus
            End If
        ElseIf _Prog40 = 51 Then
        ElseIf _Prog40 = 52 Then
        ElseIf _Prog40 = 53 Then
        ElseIf _Prog40 = 54 Then
        ElseIf _Prog40 = 55 Then
        ElseIf _Prog40 = 56 Then
        ElseIf _Prog40 = 57 Then
            If _Innenbeleuchtung2 < 2 Then
                _eb.lokSteuern(40, Klassen.LokEigenschaften.Funktion1, 0) ' Innenbeleuchtung aus
            End If
        ElseIf _Prog40 = 58 Then
            If _Fahrzeugbeleuchtung2 < 2 Then
                _eb.lokSteuern(40, Klassen.LokEigenschaften.Hauptfunktion, 0) ' Licht aus
            End If

            ' Lok bremsen (Bahnhofseinfahrt Normalzug von links und von rechts)

        ElseIf _Prog40 = 100 Then
            Prog_Lok40.Interval = V_100
        ElseIf _Prog40 = 101 Then
            _eb.lokSteuern(40, Klassen.LokEigenschaften.Geschwindigkeit, Stufe24)
            Prog_Lok40.Interval = T_100
        ElseIf _Prog40 = 102 Then
            _eb.lokSteuern(40, Klassen.LokEigenschaften.Geschwindigkeit, Stufe23)
        ElseIf _Prog40 = 103 Then
            _eb.lokSteuern(40, Klassen.LokEigenschaften.Geschwindigkeit, Stufe22)
        ElseIf _Prog40 = 104 Then
            _eb.lokSteuern(40, Klassen.LokEigenschaften.Geschwindigkeit, Stufe21)
        ElseIf _Prog40 = 105 Then
            _eb.lokSteuern(40, Klassen.LokEigenschaften.Geschwindigkeit, Stufe2)

            ' Lok bremsen (Bahnhofseinfahrt Kurzzug von links)

        ElseIf _Prog40 = 130 Then
            Prog_Lok40.Interval = V_130
        ElseIf _Prog40 = 131 Then
            _eb.lokSteuern(40, Klassen.LokEigenschaften.Geschwindigkeit, Stufe24)
            Prog_Lok40.Interval = T_130
        ElseIf _Prog40 = 132 Then
            _eb.lokSteuern(40, Klassen.LokEigenschaften.Geschwindigkeit, Stufe23)
        ElseIf _Prog40 = 133 Then
            _eb.lokSteuern(40, Klassen.LokEigenschaften.Geschwindigkeit, Stufe22)
        ElseIf _Prog40 = 134 Then
            _eb.lokSteuern(40, Klassen.LokEigenschaften.Geschwindigkeit, Stufe21)
        ElseIf _Prog40 = 135 Then
            _eb.lokSteuern(40, Klassen.LokEigenschaften.Geschwindigkeit, Stufe2)
        ElseIf _Prog40 = 136 Then
            _eb.lokSteuern(40, Klassen.LokEigenschaften.Geschwindigkeit, 0)
        ElseIf _Prog40 = 137 Then
            Prog_Lok40.Interval = 2000
        ElseIf _Prog40 = 138 Then
            If _Motor < 3 Then
                _eb.lokSteuern(40, Klassen.LokEigenschaften.Funktion2, 0) ' Motor aus
            End If
        ElseIf _Prog40 = 139 Then
        ElseIf _Prog40 = 140 Then
        ElseIf _Prog40 = 141 Then
        ElseIf _Prog40 = 142 Then
        ElseIf _Prog40 = 143 Then
        ElseIf _Prog40 = 144 Then
        ElseIf _Prog40 = 145 Then
        ElseIf _Prog40 = 146 Then
            If _Innenbeleuchtung2 < 2 Then
                _eb.lokSteuern(40, Klassen.LokEigenschaften.Funktion1, 0) ' Innenbeleuchtung aus
            End If
        ElseIf _Prog40 = 147 Then
            If _Fahrzeugbeleuchtung2 < 2 Then
                _eb.lokSteuern(40, Klassen.LokEigenschaften.Hauptfunktion, 0) ' Licht aus
            End If

            ' Lok bremsen (Bahnhofseinfahrt Kurzzug von rechts)

        ElseIf _Prog40 = 160 Then
            Prog_Lok40.Interval = V_160
        ElseIf _Prog40 = 161 Then
            _eb.lokSteuern(40, Klassen.LokEigenschaften.Geschwindigkeit, Stufe24)
            Prog_Lok40.Interval = T_160
        ElseIf _Prog40 = 162 Then
            _eb.lokSteuern(40, Klassen.LokEigenschaften.Geschwindigkeit, Stufe23)
        ElseIf _Prog40 = 163 Then
            _eb.lokSteuern(40, Klassen.LokEigenschaften.Geschwindigkeit, Stufe22)
        ElseIf _Prog40 = 164 Then
            _eb.lokSteuern(40, Klassen.LokEigenschaften.Geschwindigkeit, Stufe21)
        ElseIf _Prog40 = 165 Then
            _eb.lokSteuern(40, Klassen.LokEigenschaften.Geschwindigkeit, Stufe2)
        ElseIf _Prog40 = 166 Then
            _eb.lokSteuern(40, Klassen.LokEigenschaften.Geschwindigkeit, 0)
        ElseIf _Prog40 = 167 Then
            Prog_Lok40.Interval = 2000
        ElseIf _Prog40 = 168 Then
            If _Motor < 3 Then
                _eb.lokSteuern(40, Klassen.LokEigenschaften.Funktion2, 0) ' Motor aus
            End If
        ElseIf _Prog40 = 169 Then
        ElseIf _Prog40 = 170 Then
        ElseIf _Prog40 = 171 Then
        ElseIf _Prog40 = 172 Then
        ElseIf _Prog40 = 173 Then
        ElseIf _Prog40 = 174 Then
        ElseIf _Prog40 = 175 Then
        ElseIf _Prog40 = 176 Then
            If _Innenbeleuchtung2 < 2 Then
                _eb.lokSteuern(40, Klassen.LokEigenschaften.Funktion1, 0) ' Innenbeleuchtung aus
            End If
        ElseIf _Prog40 = 177 Then
            If _Fahrzeugbeleuchtung2 < 2 Then
                _eb.lokSteuern(40, Klassen.LokEigenschaften.Hauptfunktion, 0) ' Licht aus
            End If

            ' Rangierzug

        ElseIf _Prog40 = 180 Then
            _eb.lokSteuern(40, Klassen.LokEigenschaften.Geschwindigkeit, 4)
            Prog_Lok40.Interval = V_180
        ElseIf _Prog40 = 181 Then
            Prog_Lok40.Interval = T_180
            _eb.lokSteuern(40, Klassen.LokEigenschaften.Geschwindigkeit, 3)
        ElseIf _Prog40 = 182 Then
            _eb.lokSteuern(40, Klassen.LokEigenschaften.Geschwindigkeit, 0)
            _Prog40 = 49

            ' Tunnelausfahrt

        ElseIf _Prog40 = 200 Then ' Kontakt 1.2 <- (bergauf)
            _eb.lokSteuern(40, Klassen.LokEigenschaften.Geschwindigkeit, G_200)
            Prog_Lok40.Interval = 2000
        ElseIf _Prog40 = 201 Then
        ElseIf _Prog40 = 202 Then
        ElseIf _Prog40 = 203 Then
        ElseIf _Prog40 = 204 Then
        ElseIf _Prog40 = 205 Then
            If Stufe4 < Stufe3 Then
                _eb.lokSteuern(40, Klassen.LokEigenschaften.Geschwindigkeit, Stufe3)
            Else
                _eb.lokSteuern(40, Klassen.LokEigenschaften.Geschwindigkeit, Stufe4)
            End If
        ElseIf _Prog40 = 206 Then
        ElseIf _Prog40 = 207 Then
            If _Motor > 1 Then
                _eb.lokSteuern(40, Klassen.LokEigenschaften.Funktion2, 1) ' Motor ein
            End If
        ElseIf _Prog40 = 208 Then
        ElseIf _Prog40 = 209 Then
        ElseIf _Prog40 = 210 Then
            If _AkustischeSignale > 1 Then
                _eb.lokSteuern(40, Klassen.LokEigenschaften.Funktion3, 1) ' Hupe ein
            End If
        ElseIf _Prog40 = 211 Then
            _eb.lokSteuern(40, Klassen.LokEigenschaften.Funktion3, 0) ' Hupe aus

        ElseIf _Prog40 = 220 Then ' Kontakt 3.1 -> (hinter dem Martinstor bergauf)
            Prog_Lok40.Interval = 2000
        ElseIf _Prog40 = 221 Then
        ElseIf _Prog40 = 222 Then
        ElseIf _Prog40 = 223 Then
        ElseIf _Prog40 = 224 Then
        ElseIf _Prog40 = 225 Then
        ElseIf _Prog40 = 226 Then
        ElseIf _Prog40 = 227 Then
        ElseIf _Prog40 = 228 Then
        ElseIf _Prog40 = 229 Then
        ElseIf _Prog40 = 230 Then
        ElseIf _Prog40 = 231 Then
        ElseIf _Prog40 = 232 Then
            If _Motor < 3 Then
                _eb.lokSteuern(40, Klassen.LokEigenschaften.Funktion2, 0) ' Motor aus
            End If

        ElseIf _Prog40 = 240 Then ' Kontakt 3.7 <- (hinter der Brücke bergauf)
            Prog_Lok40.Interval = 2000
        ElseIf _Prog40 = 241 Then
        ElseIf _Prog40 = 242 Then
        ElseIf _Prog40 = 243 Then
        ElseIf _Prog40 = 244 Then
        ElseIf _Prog40 = 245 Then
            Prog_Lok40.Interval = 1000
        ElseIf _Prog40 = 246 Then
            If _AkustischeSignale > 1 Then
                _eb.lokSteuern(40, Klassen.LokEigenschaften.Funktion3, 1) ' Pfiff ein
            End If
        ElseIf _Prog40 = 247 Then
            _eb.lokSteuern(40, Klassen.LokEigenschaften.Funktion3, 0) ' Pfiff aus
        ElseIf _Prog40 = 248 Then

        ElseIf _Prog40 = 260 Then ' Kontakt 3.3 (links bzw vor der Brücke)
            Prog_Lok40.Interval = 2000
        ElseIf _Prog40 = 261 Then
        ElseIf _Prog40 = 262 Then
            _eb.lokSteuern(40, Klassen.LokEigenschaften.Geschwindigkeit, Stufe3)

        ElseIf _Prog40 = 600 Then ' Kontakt 3.5 <- (unter der Burg)
            Prog_Lok40.Interval = 1000
        ElseIf _Prog40 = 601 Then
            If _AkustischeSignale > 1 Then
                _eb.lokSteuern(40, Klassen.LokEigenschaften.Funktion3, 1) ' Pfiff ein
            End If
        ElseIf _Prog40 = 602 Then
            _eb.lokSteuern(40, Klassen.LokEigenschaften.Funktion3, 0) ' Pfiff aus
        ElseIf _Prog40 = 603 Then
            Prog_Lok40.Interval = 2000

        ElseIf _Prog40 = 620 Then ' Kontakt 3.7 -> (hinter der Brücke bergab)
            Prog_Lok40.Interval = 2000
        ElseIf _Prog40 = 621 Then
        ElseIf _Prog40 = 622 Then
        ElseIf _Prog40 = 623 Then
            If _Motor > 1 Then
                _eb.lokSteuern(40, Klassen.LokEigenschaften.Funktion2, 1) ' Motor ein
            End If
        ElseIf _Prog40 = 624 Then
            Prog_Lok40.Interval = 1000
        ElseIf _Prog40 = 625 Then
            If _AkustischeSignale > 1 Then
                _eb.lokSteuern(40, Klassen.LokEigenschaften.Funktion3, 1) ' Pfiff ein
            End If
        ElseIf _Prog40 = 626 Then
            _eb.lokSteuern(40, Klassen.LokEigenschaften.Funktion3, 0) ' Pfiff aus

        ElseIf _Prog40 = 640 Then ' Kontakt 3.1 <- Talfahrt
            Prog_Lok40.Interval = 2000
        ElseIf _Prog40 = 641 Then
        ElseIf _Prog40 = 642 Then
        ElseIf _Prog40 = 643 Then
        ElseIf _Prog40 = 644 Then
        ElseIf _Prog40 = 645 Then
        ElseIf _Prog40 = 646 Then
        ElseIf _Prog40 = 647 Then
        ElseIf _Prog40 = 648 Then
            If _Motor < 3 Then
                _eb.lokSteuern(40, Klassen.LokEigenschaften.Funktion2, 0) ' Motor aus
            End If

        ElseIf _Prog40 = 660 Then ' Kontakt 1.2 -> Talfahrt
            Prog_Lok40.Interval = 2000
        ElseIf _Prog40 = 661 Then
        ElseIf _Prog40 = 662 Then
        ElseIf _Prog40 = 663 Then
            If _GlsL40 = 1 Or _GlsL40 = 2 Then
                If _Motor > 0 Then
                    _eb.lokSteuern(40, Klassen.LokEigenschaften.Funktion2, 1) ' Motor ein
                End If
            End If
        ElseIf _Prog40 = 664 Then
        ElseIf _Prog40 = 665 Then
        ElseIf _Prog40 = 666 Then
            If _GlsL40 = 1 Or _GlsL40 = 2 Then
                If _AkustischeSignale > 0 Then
                    _eb.lokSteuern(40, Klassen.LokEigenschaften.Funktion3, 1) ' Pfiff ein
                End If
            End If
        ElseIf _Prog40 = 667 Then
            _eb.lokSteuern(40, Klassen.LokEigenschaften.Funktion3, 0) ' Pfiff aus

        ElseIf _Prog40 = 700 Then ' Kontakt 0.4 <- Diagonale
            Prog_Lok40.Interval = 2000
        ElseIf _Prog40 = 701 Then
        ElseIf _Prog40 = 702 Then
        ElseIf _Prog40 = 703 Then
        ElseIf _Prog40 = 704 Then
            If _Motor > 1 Then
                _eb.lokSteuern(40, Klassen.LokEigenschaften.Funktion2, 1) ' Motor ein
            End If
        ElseIf _Prog40 = 705 Then
        ElseIf _Prog40 = 706 Then
            Prog_Lok40.Interval = 1000
        ElseIf _Prog40 = 707 Then
            If _AkustischeSignale > 1 Then
                _eb.lokSteuern(40, Klassen.LokEigenschaften.Funktion3, 1) ' Pfiff ein
            End If
        ElseIf _Prog40 = 708 Then
            _eb.lokSteuern(40, Klassen.LokEigenschaften.Funktion3, 0) ' Pfiff aus

            ' Zindelstein

        ElseIf _Prog40 = 500 Then
            Prog_Lok40.Interval = V_500
        ElseIf _Prog40 = 501 Then
            _eb.lokSteuern(40, Klassen.LokEigenschaften.Geschwindigkeit, Stufe24)
            Prog_Lok40.Interval = T_500
        ElseIf _Prog40 = 502 Then
            _eb.lokSteuern(40, Klassen.LokEigenschaften.Geschwindigkeit, Stufe23)
        ElseIf _Prog40 = 503 Then
            _eb.lokSteuern(40, Klassen.LokEigenschaften.Geschwindigkeit, Stufe22)
        ElseIf _Prog40 = 504 Then
            _eb.lokSteuern(40, Klassen.LokEigenschaften.Geschwindigkeit, Stufe21)
        ElseIf _Prog40 = 505 Then
            _eb.lokSteuern(40, Klassen.LokEigenschaften.Geschwindigkeit, Stufe2)
        ElseIf _Prog40 = 506 Then
            _eb.lokSteuern(40, Klassen.LokEigenschaften.Geschwindigkeit, 0)

        Else
            _Prog40 = 0
            Prog_Lok40.Interval = 200
            Prog_Lok40.Stop()
            If Betriebsart = 1 Then
                SetProgramCounterLabel1(String.Empty)
            Else
                SetProgramCounterLabel(String.Empty)
            End If
        End If
        _Prog40 = _Prog40 + 1
    End Sub
    Private Sub HandleTimerElapsed53(sender As System.Object, e As System.EventArgs) Handles Prog_Lok41.Elapsed

        '*** Fahrprogramm für "SBB RCe 2/4 604 Roter Pfeil" 
        '*** Datum: 23.02.2020

        SetText(TextBox1, "Triebwagen RCe 2/4 604 Roter Pfeil                                      IBS: 12.10.2025 - V3 : 8")
        LoadImage(PictureBox1, "H:\\EB_Media\\LokFotos\\Baureihe_RCe_01.jpg")
        GeschwindikeitenSetzen(41)

        Dim Stufe1, Stufe2, Stufe3, Stufe4 As Integer
        Dim Stufe11, Stufe12, Stufe13, Stufe14, Stufe21, Stufe22, Stufe23, Stufe24 As Integer
        Dim V_100, V_130, V_160, V_180, V_500 As Integer
        Dim T_100, T_130, T_160, T_180, T_500 As Integer
        Dim G_200 As Integer

        T_100 = _Betriebsparameter.Fahrparameter(41, KlausEBspecific.Betriebsparameter.FahrparameterEnum.T_100)
        T_130 = _Betriebsparameter.Fahrparameter(41, KlausEBspecific.Betriebsparameter.FahrparameterEnum.T_130)
        T_160 = _Betriebsparameter.Fahrparameter(41, KlausEBspecific.Betriebsparameter.FahrparameterEnum.T_160)
        T_180 = _Betriebsparameter.Fahrparameter(41, KlausEBspecific.Betriebsparameter.FahrparameterEnum.T_180)
        T_500 = _Betriebsparameter.Fahrparameter(41, KlausEBspecific.Betriebsparameter.FahrparameterEnum.T_500)
        V_100 = _Betriebsparameter.Fahrparameter(41, KlausEBspecific.Betriebsparameter.FahrparameterEnum.V_100)
        V_130 = _Betriebsparameter.Fahrparameter(41, KlausEBspecific.Betriebsparameter.FahrparameterEnum.V_130)
        V_160 = _Betriebsparameter.Fahrparameter(41, KlausEBspecific.Betriebsparameter.FahrparameterEnum.V_160)
        V_180 = _Betriebsparameter.Fahrparameter(41, KlausEBspecific.Betriebsparameter.FahrparameterEnum.V_180)
        V_500 = _Betriebsparameter.Fahrparameter(41, KlausEBspecific.Betriebsparameter.FahrparameterEnum.V_500)
        G_200 = _Betriebsparameter.Fahrparameter(41, KlausEBspecific.Betriebsparameter.FahrparameterEnum.G_200)

        If A_StopB = 1 Then
            V_100 = 4000
        End If

        Stufe1 = _LokStufen.Holen(41, 1)
        Stufe2 = _LokStufen.Holen(41, 2)
        Stufe3 = _LokStufen.Holen(41, 3)
        Stufe4 = _LokStufen.Holen(41, 4)

        If Stufe2 = 1 Then
            T_100 = T_100
            T_130 = T_130
            T_160 = T_160
            V_180 = V_180
        ElseIf Stufe2 = 2 Then
            T_100 = T_100 + 300
            T_130 = T_130 + 300
            T_160 = T_160 + 300
            V_180 = V_180 + 500
        ElseIf Stufe2 = 3 Then
            T_100 = T_100 + 500
            T_130 = T_130 + 500
            T_160 = T_160 + 500
            V_180 = V_180 + 1000
        ElseIf Stufe2 = 4 Then
            T_100 = T_100 + 700
            T_130 = T_130 + 700
            T_160 = T_160 + 700
            V_180 = V_180 + 1500
        ElseIf Stufe2 = 5 Then
            T_100 = T_100 + 900
            T_130 = T_130 + 900
            T_160 = T_160 + 900
            V_180 = V_180 + 2000
        ElseIf Stufe2 = 6 Then
            T_100 = T_100 + 1200
            T_130 = T_130 + 1200
            T_160 = T_160 + 1200
            V_180 = V_180 + 2500
        Else
            T_100 = T_100 + 1200
            T_130 = T_130 + 1200
            T_160 = T_160 + 1200
            V_180 = V_180 + 2500
        End If

        Stufe2 = Stufe1

        Stufe11 = Stufe1 + 1
        If Stufe11 > Stufe3 Then
            Stufe11 = Stufe3
        End If
        Stufe12 = Stufe1 + 2
        If Stufe12 > Stufe3 Then
            Stufe12 = Stufe3
        End If
        Stufe13 = Stufe1 + 3
        If Stufe13 > Stufe3 Then
            Stufe13 = Stufe3
        End If
        Stufe14 = Stufe1 + 4
        If Stufe14 > Stufe3 Then
            Stufe14 = Stufe3
        End If

        Stufe21 = Stufe2 + 1
        If Stufe21 > Stufe3 Then
            Stufe21 = Stufe3
        End If
        Stufe22 = Stufe2 + 2
        If Stufe22 > Stufe3 Then
            Stufe22 = Stufe3
        End If
        Stufe23 = Stufe2 + 3
        If Stufe23 > Stufe3 Then
            Stufe23 = Stufe3
        End If
        Stufe24 = Stufe2 + 4
        If Stufe24 > Stufe3 Then
            Stufe24 = Stufe3
        End If
        If G_200 > 0 Then
            If G_200 < Stufe4 Then
                G_200 = Stufe4
            End If
        Else
            G_200 = Stufe4
        End If

        If Betriebsart = 1 And (_GlsL41 = 3 Or _GlsL41 = 4) Then
            SetProgramCounterLabel1(_Prog41)
        Else
            SetProgramCounterLabel(_Prog41)
        End If

        ' Lok starten - Bahnhofsausfahrt

        If _Prog41 = 0 Then
            Prog_Lok41.Interval = 2000
            If _Fahrzeugbeleuchtung2 > 0 Then
                _eb.lokSteuern(41, Klassen.LokEigenschaften.Hauptfunktion, 1) ' Licht ein
            End If
        ElseIf _Prog41 = 1 Then
            If _Motor > 0 Then
                _eb.lokSteuern(41, Klassen.LokEigenschaften.Funktion2, 1) ' Motor ein
            End If
        ElseIf _Prog41 = 2 Then
            _Betriebsparameter.RundenErhoehen(41)
        ElseIf _Prog41 = 3 Then
            If _Innenbeleuchtung2 > 0 Then
                _eb.lokSteuern(41, Klassen.LokEigenschaften.Funktion1, 1) ' Innenbeleuchtung ein
            End If
        ElseIf _Prog41 = 4 Then
        ElseIf _Prog41 = 5 Then
        ElseIf _Prog41 = 6 Then

            ' Bahnhofsausfahrt

        ElseIf _Prog41 = 7 Then
            If _AkustischeSignale > 0 Then
                _eb.lokSteuern(41, Klassen.LokEigenschaften.Funktion3, 1) ' Pfiff ein
            End If
        ElseIf _Prog41 = 8 Then
            _eb.lokSteuern(41, Klassen.LokEigenschaften.Funktion3, 0) ' Pfiff aus
        ElseIf _Prog41 = 9 Then
            _eb.lokSteuern(41, Klassen.LokEigenschaften.Geschwindigkeit, 1)
        ElseIf _Prog41 = 10 Then
            Prog_Lok41.Interval = 2000
            _eb.lokSteuern(41, Klassen.LokEigenschaften.Geschwindigkeit, Stufe11)
        ElseIf _Prog41 = 11 Then
            _eb.lokSteuern(41, Klassen.LokEigenschaften.Geschwindigkeit, Stufe12)
        ElseIf _Prog41 = 12 Then
            _eb.lokSteuern(41, Klassen.LokEigenschaften.Geschwindigkeit, Stufe13)
        ElseIf _Prog41 = 13 Then
            _eb.lokSteuern(41, Klassen.LokEigenschaften.Geschwindigkeit, Stufe14)
        ElseIf _Prog41 = 14 Then
            _eb.lokSteuern(41, Klassen.LokEigenschaften.Geschwindigkeit, Stufe3)
        ElseIf _Prog41 = 15 Then
        ElseIf _Prog41 = 16 Then
        ElseIf _Prog41 = 17 Then
        ElseIf _Prog41 = 18 Then
            If _Motor < 3 Then
                _eb.lokSteuern(41, Klassen.LokEigenschaften.Funktion2, 0) ' Motor aus
            End If

            ' Lok abstellen

        ElseIf _Prog41 = 50 Then
            Prog_Lok41.Interval = 2000
        ElseIf _Prog41 = 51 Then
            If _Motor < 3 Then
                _eb.lokSteuern(41, Klassen.LokEigenschaften.Funktion2, 0) ' Motor aus
            End If
        ElseIf _Prog41 = 52 Then
            If _Innenbeleuchtung2 < 2 Then
                _eb.lokSteuern(41, Klassen.LokEigenschaften.Funktion1, 0) ' Innenbeleuchtung aus
            End If
        ElseIf _Prog41 = 53 Then
            If _Fahrzeugbeleuchtung2 < 2 Then
                _eb.lokSteuern(41, Klassen.LokEigenschaften.Hauptfunktion, 0) ' Licht aus
            End If

            ' Lok bremsen (Bahnhofseinfahrt Normalzug von links und von rechts)

        ElseIf _Prog41 = 100 Then
            Prog_Lok41.Interval = V_100
        ElseIf _Prog41 = 101 Then
            _eb.lokSteuern(41, Klassen.LokEigenschaften.Geschwindigkeit, Stufe24)
            Prog_Lok41.Interval = T_100
        ElseIf _Prog41 = 102 Then
            _eb.lokSteuern(41, Klassen.LokEigenschaften.Geschwindigkeit, Stufe23)
        ElseIf _Prog41 = 103 Then
            _eb.lokSteuern(41, Klassen.LokEigenschaften.Geschwindigkeit, Stufe22)
        ElseIf _Prog41 = 104 Then
            _eb.lokSteuern(41, Klassen.LokEigenschaften.Geschwindigkeit, Stufe21)
        ElseIf _Prog41 = 105 Then
            _eb.lokSteuern(41, Klassen.LokEigenschaften.Geschwindigkeit, Stufe2)

            ' Lok bremsen (Bahnhofseinfahrt Kurzzug von links)

        ElseIf _Prog41 = 130 Then
            Prog_Lok41.Interval = V_130
        ElseIf _Prog41 = 131 Then
            _eb.lokSteuern(41, Klassen.LokEigenschaften.Geschwindigkeit, Stufe24)
            Prog_Lok41.Interval = T_130
        ElseIf _Prog41 = 132 Then
            _eb.lokSteuern(41, Klassen.LokEigenschaften.Geschwindigkeit, Stufe23)
        ElseIf _Prog41 = 133 Then
            _eb.lokSteuern(41, Klassen.LokEigenschaften.Geschwindigkeit, Stufe22)
        ElseIf _Prog41 = 134 Then
            _eb.lokSteuern(41, Klassen.LokEigenschaften.Geschwindigkeit, Stufe21)
        ElseIf _Prog41 = 135 Then
            _eb.lokSteuern(41, Klassen.LokEigenschaften.Geschwindigkeit, Stufe2)
        ElseIf _Prog41 = 136 Then
            _eb.lokSteuern(41, Klassen.LokEigenschaften.Geschwindigkeit, 0)
        ElseIf _Prog41 = 137 Then
            Prog_Lok41.Interval = 2000
        ElseIf _Prog41 = 138 Then
            If _Motor < 3 Then
                _eb.lokSteuern(41, Klassen.LokEigenschaften.Funktion2, 0) ' Motor aus
            End If
        ElseIf _Prog41 = 139 Then
        ElseIf _Prog41 = 140 Then
        ElseIf _Prog41 = 141 Then
            If _Innenbeleuchtung2 < 2 Then
                _eb.lokSteuern(41, Klassen.LokEigenschaften.Funktion1, 0) ' Innenbeleuchtung aus
            End If
        ElseIf _Prog41 = 142 Then
            If _Fahrzeugbeleuchtung2 < 2 Then
                _eb.lokSteuern(41, Klassen.LokEigenschaften.Hauptfunktion, 0) ' Licht aus
            End If


            ' Lok bremsen (Bahnhofseinfahrt Kurzzug von rechts)

        ElseIf _Prog41 = 160 Then
            Prog_Lok41.Interval = V_160
        ElseIf _Prog41 = 161 Then
            _eb.lokSteuern(41, Klassen.LokEigenschaften.Geschwindigkeit, Stufe24)
            Prog_Lok41.Interval = T_160
        ElseIf _Prog41 = 162 Then
            _eb.lokSteuern(41, Klassen.LokEigenschaften.Geschwindigkeit, Stufe23)
        ElseIf _Prog41 = 163 Then
            _eb.lokSteuern(41, Klassen.LokEigenschaften.Geschwindigkeit, Stufe22)
        ElseIf _Prog41 = 164 Then
            _eb.lokSteuern(41, Klassen.LokEigenschaften.Geschwindigkeit, Stufe21)
        ElseIf _Prog41 = 165 Then
            _eb.lokSteuern(41, Klassen.LokEigenschaften.Geschwindigkeit, Stufe2)
        ElseIf _Prog41 = 166 Then
            _eb.lokSteuern(41, Klassen.LokEigenschaften.Geschwindigkeit, 0)
        ElseIf _Prog41 = 167 Then
            Prog_Lok41.Interval = 2000
        ElseIf _Prog41 = 168 Then
            If _Motor < 3 Then
                _eb.lokSteuern(41, Klassen.LokEigenschaften.Funktion2, 0) ' Motor aus
            End If
        ElseIf _Prog41 = 169 Then
        ElseIf _Prog41 = 170 Then
        ElseIf _Prog41 = 171 Then
            If _Innenbeleuchtung2 < 2 Then
                _eb.lokSteuern(41, Klassen.LokEigenschaften.Funktion1, 0) ' Innenbeleuchtung aus
            End If
        ElseIf _Prog41 = 172 Then
            If _Fahrzeugbeleuchtung2 < 2 Then
                _eb.lokSteuern(41, Klassen.LokEigenschaften.Hauptfunktion, 0) ' Licht aus
            End If

            ' Rangierzug

        ElseIf _Prog41 = 180 Then
            _eb.lokSteuern(41, Klassen.LokEigenschaften.Geschwindigkeit, 2)
            Prog_Lok41.Interval = V_180
        ElseIf _Prog41 = 181 Then
            Prog_Lok41.Interval = T_180
            _eb.lokSteuern(41, Klassen.LokEigenschaften.Geschwindigkeit, 1)
        ElseIf _Prog41 = 182 Then
            _eb.lokSteuern(41, Klassen.LokEigenschaften.Geschwindigkeit, 0)

            ' Tunnelausfahrt

        ElseIf _Prog41 = 200 Then ' Kontakt 1.2 <- (bergauf)
            _eb.lokSteuern(41, Klassen.LokEigenschaften.Geschwindigkeit, G_200)
            Prog_Lok41.Interval = 2000
        ElseIf _Prog41 = 201 Then
        ElseIf _Prog41 = 202 Then
        ElseIf _Prog41 = 203 Then
        ElseIf _Prog41 = 204 Then
        ElseIf _Prog41 = 205 Then
            If Stufe4 < Stufe3 Then
                _eb.lokSteuern(41, Klassen.LokEigenschaften.Geschwindigkeit, Stufe3)
            Else
                _eb.lokSteuern(41, Klassen.LokEigenschaften.Geschwindigkeit, Stufe4)
            End If
        ElseIf _Prog41 = 206 Then
        ElseIf _Prog41 = 207 Then
            If _Motor > 1 Then
                _eb.lokSteuern(41, Klassen.LokEigenschaften.Funktion2, 1) ' Motor ein
            End If
        ElseIf _Prog41 = 208 Then
        ElseIf _Prog41 = 209 Then
            If _AkustischeSignale > 1 Then
                _eb.lokSteuern(41, Klassen.LokEigenschaften.Funktion3, 1) ' Hupe ein
            End If
        ElseIf _Prog41 = 210 Then
            _eb.lokSteuern(41, Klassen.LokEigenschaften.Funktion3, 0) ' Hupe aus

        ElseIf _Prog41 = 220 Then ' Kontakt 3.1 -> (hinter dem Martinstor bergauf)
            Prog_Lok41.Interval = 2000
        ElseIf _Prog41 = 221 Then
        ElseIf _Prog41 = 222 Then
        ElseIf _Prog41 = 223 Then
        ElseIf _Prog41 = 224 Then
        ElseIf _Prog41 = 225 Then
            If _Motor < 3 Then
                _eb.lokSteuern(41, Klassen.LokEigenschaften.Funktion2, 0) ' Motor aus
            End If

        ElseIf _Prog41 = 240 Then ' Kontakt 3.7 <- (hinter der Brücke bergauf)
            Prog_Lok41.Interval = 2000
        ElseIf _Prog41 = 241 Then
        ElseIf _Prog41 = 242 Then
        ElseIf _Prog41 = 243 Then
            'If _Motor > 1 Then
            '    _eb.lokSteuern(41, Klassen.LokEigenschaften.Funktion2, 1) ' Motor ein
            'End If
        ElseIf _Prog41 = 244 Then
            If _AkustischeSignale > 1 Then
                _eb.lokSteuern(41, Klassen.LokEigenschaften.Funktion3, 1) ' Pfiff ein
            End If
        ElseIf _Prog41 = 245 Then
            _eb.lokSteuern(41, Klassen.LokEigenschaften.Funktion3, 0) ' Pfiff aus
        ElseIf _Prog41 = 246 Then

        ElseIf _Prog41 = 260 Then ' Kontakt 3.3 (links bzw vor der Brücke)
            Prog_Lok41.Interval = 2000
        ElseIf _Prog41 = 261 Then
        ElseIf _Prog41 = 262 Then
            _eb.lokSteuern(41, Klassen.LokEigenschaften.Geschwindigkeit, Stufe3)

        ElseIf _Prog41 = 600 Then ' Kontakt 3.5 <- (unter der Burg)
            Prog_Lok41.Interval = 2000
        ElseIf _Prog41 = 601 Then
            If _AkustischeSignale > 1 Then
                _eb.lokSteuern(41, Klassen.LokEigenschaften.Funktion3, 1) ' Pfiff ein
            End If
        ElseIf _Prog41 = 602 Then
            _eb.lokSteuern(41, Klassen.LokEigenschaften.Funktion3, 0) ' Pfiff aus
        ElseIf _Prog41 = 603 Then

        ElseIf _Prog41 = 620 Then ' Kontakt 3.7 -> (hinter der Brücke bergab)
            Prog_Lok41.Interval = 2000
        ElseIf _Prog41 = 621 Then
        ElseIf _Prog41 = 622 Then
            If _Motor > 1 Then
                _eb.lokSteuern(41, Klassen.LokEigenschaften.Funktion2, 1) ' Motor ein
            End If
        ElseIf _Prog41 = 623 Then
            If _AkustischeSignale > 1 Then
                _eb.lokSteuern(41, Klassen.LokEigenschaften.Funktion3, 1) ' Pfiff ein
            End If
        ElseIf _Prog41 = 624 Then
            _eb.lokSteuern(41, Klassen.LokEigenschaften.Funktion3, 0) ' Pfiff aus

        ElseIf _Prog41 = 640 Then ' Kontakt 3.1 <- Talfahrt
            Prog_Lok41.Interval = 2000
        ElseIf _Prog41 = 641 Then
        ElseIf _Prog41 = 642 Then
            If _Motor < 3 Then
                _eb.lokSteuern(41, Klassen.LokEigenschaften.Funktion2, 0) ' Motor aus
            End If

        ElseIf _Prog41 = 660 Then ' Kontakt 1.2 -> Talfahrt
            Prog_Lok41.Interval = 2000
        ElseIf _Prog41 = 661 Then
        ElseIf _Prog41 = 662 Then
        ElseIf _Prog41 = 663 Then
        ElseIf _Prog41 = 664 Then
            If _GlsL41 = 1 Or _GlsL41 = 2 Then
                If _Motor > 0 Then
                    _eb.lokSteuern(41, Klassen.LokEigenschaften.Funktion3, 1) ' Motor ein
                End If
            End If
        ElseIf _Prog41 = 665 Then
            If _GlsL41 = 1 Or _GlsL41 = 2 Then
                If _AkustischeSignale > 0 Then
                    _eb.lokSteuern(41, Klassen.LokEigenschaften.Funktion3, 1) ' Pfiff ein
                End If
            End If
        ElseIf _Prog41 = 666 Then
            _eb.lokSteuern(41, Klassen.LokEigenschaften.Funktion3, 0) ' Pfiff aus

        ElseIf _Prog41 = 700 Then ' Kontakt 0.4 <- Diagonale
            Prog_Lok41.Interval = 2000
        ElseIf _Prog41 = 701 Then
        ElseIf _Prog41 = 702 Then
        ElseIf _Prog41 = 703 Then
            If _Motor > 1 Then
                _eb.lokSteuern(41, Klassen.LokEigenschaften.Funktion2, 1) ' Motor ein
            End If
        ElseIf _Prog41 = 704 Then
        ElseIf _Prog41 = 705 Then
            If _AkustischeSignale > 1 Then
                _eb.lokSteuern(41, Klassen.LokEigenschaften.Funktion3, 1) ' Pfiff ein
            End If
        ElseIf _Prog41 = 706 Then
            _eb.lokSteuern(41, Klassen.LokEigenschaften.Funktion3, 0) ' Pfiff aus

            ' Zindelstein

        ElseIf _Prog41 = 500 Then
            Prog_Lok41.Interval = V_500
        ElseIf _Prog41 = 501 Then
            _eb.lokSteuern(41, Klassen.LokEigenschaften.Geschwindigkeit, Stufe24)
            Prog_Lok41.Interval = T_500
        ElseIf _Prog41 = 502 Then
            _eb.lokSteuern(41, Klassen.LokEigenschaften.Geschwindigkeit, Stufe23)
        ElseIf _Prog41 = 503 Then
            _eb.lokSteuern(41, Klassen.LokEigenschaften.Geschwindigkeit, Stufe22)
        ElseIf _Prog41 = 504 Then
            _eb.lokSteuern(41, Klassen.LokEigenschaften.Geschwindigkeit, Stufe21)
        ElseIf _Prog41 = 505 Then
            _eb.lokSteuern(41, Klassen.LokEigenschaften.Geschwindigkeit, Stufe2)
        ElseIf _Prog41 = 506 Then
            _eb.lokSteuern(41, Klassen.LokEigenschaften.Geschwindigkeit, 0)

        Else
            _Prog41 = 0
            Prog_Lok41.Stop()
            Prog_Lok41.Interval = 200
            If Betriebsart = 1 Then
                SetProgramCounterLabel1(String.Empty)
            Else
                SetProgramCounterLabel(String.Empty)
            End If
        End If
        _Prog41 = _Prog41 + 1
    End Sub
    Private Sub HandleTimerElapsed54(sender As System.Object, e As System.EventArgs) Handles Prog_Lok42.Elapsed

        '*** Fahrprogramm für Diesel-Lok V160 028
        '*** Datum: 15.10.2023

        SetText(TextBox1, "Diesel-Lok V160 028                                                     IBS: 10.12.2025 - V3 : 8")
        LoadImage(PictureBox1, "H:\\EB_Media\\LokFotos\\Baureihe_160_02.jpg")
        GeschwindikeitenSetzen(42)

        Dim Stufe1, Stufe2, Stufe3, Stufe4 As Integer
        Dim Stufe11, Stufe12, Stufe13, Stufe14, Stufe21, Stufe22, Stufe23, Stufe24 As Integer
        Dim V_100, V_130, V_160, V_180, V_500 As Integer
        Dim T_100, T_130, T_160, T_180, T_500 As Integer
        Dim G_200 As Integer

        T_100 = _Betriebsparameter.Fahrparameter(42, KlausEBspecific.Betriebsparameter.FahrparameterEnum.T_100)
        T_130 = _Betriebsparameter.Fahrparameter(42, KlausEBspecific.Betriebsparameter.FahrparameterEnum.T_130)
        T_160 = _Betriebsparameter.Fahrparameter(42, KlausEBspecific.Betriebsparameter.FahrparameterEnum.T_160)
        T_180 = _Betriebsparameter.Fahrparameter(42, KlausEBspecific.Betriebsparameter.FahrparameterEnum.T_180)
        T_500 = _Betriebsparameter.Fahrparameter(42, KlausEBspecific.Betriebsparameter.FahrparameterEnum.T_500)
        V_100 = _Betriebsparameter.Fahrparameter(42, KlausEBspecific.Betriebsparameter.FahrparameterEnum.V_100)
        V_130 = _Betriebsparameter.Fahrparameter(42, KlausEBspecific.Betriebsparameter.FahrparameterEnum.V_130)
        V_160 = _Betriebsparameter.Fahrparameter(42, KlausEBspecific.Betriebsparameter.FahrparameterEnum.V_160)
        V_180 = _Betriebsparameter.Fahrparameter(42, KlausEBspecific.Betriebsparameter.FahrparameterEnum.V_180)
        V_500 = _Betriebsparameter.Fahrparameter(42, KlausEBspecific.Betriebsparameter.FahrparameterEnum.V_500)
        G_200 = _Betriebsparameter.Fahrparameter(42, KlausEBspecific.Betriebsparameter.FahrparameterEnum.G_200)

        If A_StopB = 1 Then
            V_100 = 8000
        End If

        Stufe1 = _LokStufen.Holen(42, 1)
        Stufe2 = _LokStufen.Holen(42, 2)
        Stufe3 = _LokStufen.Holen(42, 3)
        Stufe4 = _LokStufen.Holen(42, 4)

        If Stufe2 = 1 Then
            T_100 = T_100
            T_130 = T_130
            T_160 = T_160
            V_180 = V_180
        ElseIf Stufe2 = 2 Then
            T_100 = T_100 + 300
            T_130 = T_130 + 300
            T_160 = T_160 + 300
            V_180 = V_180 + 500
        ElseIf Stufe2 = 3 Then
            T_100 = T_100 + 500
            T_130 = T_130 + 500
            T_160 = T_160 + 500
            V_180 = V_180 + 1000
        ElseIf Stufe2 = 4 Then
            T_100 = T_100 + 700
            T_130 = T_130 + 700
            T_160 = T_160 + 700
            V_180 = V_180 + 1500
        ElseIf Stufe2 = 5 Then
            T_100 = T_100 + 900
            T_130 = T_130 + 900
            T_160 = T_160 + 900
            V_180 = V_180 + 2000
        ElseIf Stufe2 = 6 Then
            T_100 = T_100 + 1200
            T_130 = T_130 + 1200
            T_160 = T_160 + 1200
            V_180 = V_180 + 2500
        Else
            T_100 = T_100 + 1200
            T_130 = T_130 + 1200
            T_160 = T_160 + 1200
            V_180 = V_180 + 2500
        End If

        Stufe2 = Stufe1

        Stufe11 = Stufe1 + 1
        If Stufe11 > Stufe3 Then
            Stufe11 = Stufe3
        End If
        Stufe12 = Stufe1 + 2
        If Stufe12 > Stufe3 Then
            Stufe12 = Stufe3
        End If
        Stufe13 = Stufe1 + 3
        If Stufe13 > Stufe3 Then
            Stufe13 = Stufe3
        End If
        Stufe14 = Stufe1 + 4
        If Stufe14 > Stufe3 Then
            Stufe14 = Stufe3
        End If

        Stufe21 = Stufe2 + 1
        If Stufe21 > Stufe3 Then
            Stufe21 = Stufe3
        End If
        Stufe22 = Stufe2 + 2
        If Stufe22 > Stufe3 Then
            Stufe22 = Stufe3
        End If
        Stufe23 = Stufe2 + 3
        If Stufe23 > Stufe3 Then
            Stufe23 = Stufe3
        End If
        Stufe24 = Stufe2 + 4
        If Stufe24 > Stufe3 Then
            Stufe24 = Stufe3
        End If
        If G_200 > 0 Then
            If G_200 < Stufe4 Then
                G_200 = Stufe4
            End If
        Else
            G_200 = Stufe4
        End If

        If Betriebsart = 1 And (_GlsL42 = 3 Or _GlsL42 = 4) Then
            SetProgramCounterLabel1(_Prog42)
        Else
            SetProgramCounterLabel(_Prog42)
        End If

        ' Lok starten - Bahnhofsausfahrt

        If _Prog42 = 0 Then
            Prog_Lok42.Interval = 2000
            _eb.lokSteuern(42, Klassen.LokEigenschaften.Geschwindigkeit, 0)
        ElseIf _Prog42 = 1 Then
            If _Fahrzeugbeleuchtung2 > 0 Then
                _eb.lokSteuern(42, Klassen.LokEigenschaften.Hauptfunktion, 1)
            Else
                _eb.lokSteuern(42, Klassen.LokEigenschaften.Hauptfunktion, 0)
            End If
        ElseIf _Prog42 = 2 Then
            _eb.lokSteuern(42, Klassen.LokEigenschaften.Geschwindigkeit, 0)
        ElseIf _Prog42 = 3 Then
            If _Motor > 0 Then
                _eb.lokSteuern(42, Klassen.LokEigenschaften.Funktion3, 1) ' Motor ein
            Else
                _eb.lokSteuern(42, Klassen.LokEigenschaften.Funktion3, 0) ' Motor aus
            End If
        ElseIf _Prog42 = 4 Then
            _Betriebsparameter.RundenErhoehen(42)
        ElseIf _Prog42 = 5 Then
        ElseIf _Prog42 = 6 Then

            ' Bahnhofsausfahrt

        ElseIf _Prog42 = 7 Then
            If _AkustischeSignale > 0 Then
                _eb.lokSteuern(43, Klassen.LokEigenschaften.Funktion1, 1) ' Hupe 1 ein
            End If
        ElseIf _Prog42 = 8 Then
            _eb.lokSteuern(43, Klassen.LokEigenschaften.Funktion1, 0) ' Hupe 1 aus
        ElseIf _Prog42 = 9 Then
            _eb.lokSteuern(42, Klassen.LokEigenschaften.Geschwindigkeit, Stufe1)
        ElseIf _Prog42 = 10 Then
            _eb.lokSteuern(42, Klassen.LokEigenschaften.Geschwindigkeit, Stufe11)
        ElseIf _Prog42 = 11 Then
            _eb.lokSteuern(42, Klassen.LokEigenschaften.Geschwindigkeit, Stufe12)
        ElseIf _Prog42 = 12 Then
            _eb.lokSteuern(42, Klassen.LokEigenschaften.Geschwindigkeit, Stufe13)
        ElseIf _Prog42 = 13 Then
            _eb.lokSteuern(42, Klassen.LokEigenschaften.Geschwindigkeit, Stufe14)
        ElseIf _Prog42 = 14 Then
            _eb.lokSteuern(42, Klassen.LokEigenschaften.Geschwindigkeit, Stufe3)
        ElseIf _Prog42 = 15 Then
        ElseIf _Prog42 = 16 Then
            If _Motor < 3 Then
                _eb.lokSteuern(42, Klassen.LokEigenschaften.Funktion3, 0) ' Motor aus
            End If

            ' Lok abstellen

        ElseIf _Prog42 = 50 Then
            Prog_Lok42.Interval = 2000
        ElseIf _Prog42 = 51 Then
        ElseIf _Prog42 = 52 Then
            If _Motor < 3 Then
                _eb.lokSteuern(42, Klassen.LokEigenschaften.Funktion3, 0) ' Motor aus
            End If
        ElseIf _Prog42 = 53 Then
        ElseIf _Prog42 = 54 Then
        ElseIf _Prog42 = 55 Then
        ElseIf _Prog42 = 56 Then
        ElseIf _Prog42 = 57 Then
        ElseIf _Prog42 = 58 Then
        ElseIf _Prog42 = 59 Then
        ElseIf _Prog42 = 60 Then
        ElseIf _Prog42 = 61 Then
        ElseIf _Prog42 = 62 Then
            If _Fahrzeugbeleuchtung2 < 2 Then
                _eb.lokSteuern(42, Klassen.LokEigenschaften.Hauptfunktion, 0) ' Licht aus
            End If

            ' Lok bremsen (Bahnhofseinfahrt Normalzug von links und von rechts)

        ElseIf _Prog42 = 100 Then
            Prog_Lok42.Interval = V_100
        ElseIf _Prog42 = 101 Then
            _eb.lokSteuern(42, Klassen.LokEigenschaften.Geschwindigkeit, Stufe24)
            Prog_Lok42.Interval = T_100
        ElseIf _Prog42 = 102 Then
            _eb.lokSteuern(42, Klassen.LokEigenschaften.Geschwindigkeit, Stufe23)
        ElseIf _Prog42 = 103 Then
            _eb.lokSteuern(42, Klassen.LokEigenschaften.Geschwindigkeit, Stufe22)
        ElseIf _Prog42 = 104 Then
            _eb.lokSteuern(42, Klassen.LokEigenschaften.Geschwindigkeit, Stufe21)
        ElseIf _Prog42 = 105 Then
            _eb.lokSteuern(42, Klassen.LokEigenschaften.Geschwindigkeit, Stufe2)
        ElseIf _Prog42 = 106 Then

            ' Lok bremsen (Bahnhofseinfahrt Kurzzug von links)

        ElseIf _Prog42 = 130 Then
            Prog_Lok42.Interval = V_130
        ElseIf _Prog42 = 131 Then
            _eb.lokSteuern(42, Klassen.LokEigenschaften.Geschwindigkeit, Stufe24)
            Prog_Lok42.Interval = T_130
        ElseIf _Prog42 = 132 Then
            _eb.lokSteuern(42, Klassen.LokEigenschaften.Geschwindigkeit, Stufe23)
        ElseIf _Prog42 = 133 Then
            _eb.lokSteuern(42, Klassen.LokEigenschaften.Geschwindigkeit, Stufe22)
        ElseIf _Prog42 = 134 Then
            _eb.lokSteuern(42, Klassen.LokEigenschaften.Geschwindigkeit, Stufe21)
        ElseIf _Prog42 = 135 Then
            _eb.lokSteuern(42, Klassen.LokEigenschaften.Geschwindigkeit, Stufe2)
        ElseIf _Prog42 = 136 Then
            _eb.lokSteuern(42, Klassen.LokEigenschaften.Geschwindigkeit, 0)
        ElseIf _Prog42 = 137 Then
            Prog_Lok42.Interval = 2000
        ElseIf _Prog42 = 138 Then
            If _Motor < 3 Then
                _eb.lokSteuern(42, Klassen.LokEigenschaften.Funktion3, 0) ' Motor aus
            End If
        ElseIf _Prog42 = 139 Then
        ElseIf _Prog42 = 140 Then
            If _Fahrzeugbeleuchtung2 < 2 Then
                _eb.lokSteuern(42, Klassen.LokEigenschaften.Hauptfunktion, 0) ' Licht aus
            End If

            ' Lok bremsen (Bahnhofseinfahrt Kurzzug von rechts)

        ElseIf _Prog42 = 160 Then
            Prog_Lok42.Interval = V_160
        ElseIf _Prog42 = 161 Then
            _eb.lokSteuern(42, Klassen.LokEigenschaften.Geschwindigkeit, Stufe24)
            Prog_Lok42.Interval = T_160
        ElseIf _Prog42 = 162 Then
            _eb.lokSteuern(42, Klassen.LokEigenschaften.Geschwindigkeit, Stufe23)
        ElseIf _Prog42 = 163 Then
            _eb.lokSteuern(42, Klassen.LokEigenschaften.Geschwindigkeit, Stufe22)
        ElseIf _Prog42 = 164 Then
            _eb.lokSteuern(42, Klassen.LokEigenschaften.Geschwindigkeit, Stufe21)
        ElseIf _Prog42 = 165 Then
            _eb.lokSteuern(42, Klassen.LokEigenschaften.Geschwindigkeit, Stufe2)
        ElseIf _Prog42 = 166 Then
            _eb.lokSteuern(42, Klassen.LokEigenschaften.Geschwindigkeit, 0)
        ElseIf _Prog42 = 167 Then
            If _Motor < 3 Then
                _eb.lokSteuern(42, Klassen.LokEigenschaften.Funktion3, 0) ' Motor aus
            End If
        ElseIf _Prog42 = 168 Then

            ' Rangierzug

        ElseIf _Prog42 = 180 Then
            _eb.lokSteuern(42, Klassen.LokEigenschaften.Geschwindigkeit, Stufe2)
            Prog_Lok42.Interval = V_180
        ElseIf _Prog42 = 181 Then
            Prog_Lok42.Interval = T_180
            _eb.lokSteuern(42, Klassen.LokEigenschaften.Geschwindigkeit, 2)
        ElseIf _Prog42 = 182 Then
            _eb.lokSteuern(42, Klassen.LokEigenschaften.Geschwindigkeit, 0)

            ' Tunnelausfahrt

        ElseIf _Prog42 = 200 Then ' Kontakt 1.2 <- (bergauf)
            _eb.lokSteuern(42, Klassen.LokEigenschaften.Geschwindigkeit, G_200)
            Prog_Lok42.Interval = 2000
        ElseIf _Prog42 = 201 Then
        ElseIf _Prog42 = 202 Then
        ElseIf _Prog42 = 203 Then
            If _Motor > 1 Then
                _eb.lokSteuern(42, Klassen.LokEigenschaften.Funktion3, 1) ' Motor ein
            End If
        ElseIf _Prog42 = 204 Then
        ElseIf _Prog42 = 205 Then
            If Stufe4 < Stufe3 Then
                _eb.lokSteuern(42, Klassen.LokEigenschaften.Geschwindigkeit, Stufe3)
            Else
                _eb.lokSteuern(42, Klassen.LokEigenschaften.Geschwindigkeit, Stufe4)
            End If
        ElseIf _Prog42 = 206 Then
        ElseIf _Prog42 = 207 Then
            Prog_Lok42.Interval = 1000
        ElseIf _Prog42 = 208 Then
            If _AkustischeSignale > 1 Then
                _eb.lokSteuern(43, Klassen.LokEigenschaften.Funktion1, 1) ' Hupe 1 ein
            End If
        ElseIf _Prog42 = 209 Then
            _eb.lokSteuern(43, Klassen.LokEigenschaften.Funktion1, 0) ' Hupe 1 aus

        ElseIf _Prog42 = 220 Then ' Kontakt 3.1 -> (hinter dem Martinstor bergauf)
            Prog_Lok42.Interval = 2000
        ElseIf _Prog42 = 221 Then
        ElseIf _Prog42 = 222 Then
        ElseIf _Prog42 = 223 Then
        ElseIf _Prog42 = 224 Then
        ElseIf _Prog42 = 225 Then
        ElseIf _Prog42 = 226 Then
            If _Motor < 3 Then
                _eb.lokSteuern(42, Klassen.LokEigenschaften.Funktion3, 0) ' Motor aus
            End If

        ElseIf _Prog42 = 240 Then ' Kontakt 3.7 <- (hinter der Brücke bergauf)
            Prog_Lok42.Interval = 2000
        ElseIf _Prog42 = 241 Then
        ElseIf _Prog42 = 242 Then
            'If _Motor > 1 Then
            '    _eb.lokSteuern(42, Klassen.LokEigenschaften.Funktion3, 1) ' Motor ein
            'End If
        ElseIf _Prog42 = 243 Then
            Prog_Lok42.Interval = 1000
        ElseIf _Prog42 = 244 Then
            If _AkustischeSignale > 1 Then
                _eb.lokSteuern(43, Klassen.LokEigenschaften.Funktion1, 1) ' Hupe ein
            End If
        ElseIf _Prog42 = 245 Then
            _eb.lokSteuern(43, Klassen.LokEigenschaften.Funktion1, 0) ' Hupe aus
        ElseIf _Prog42 = 246 Then
            Prog_Lok42.Interval = 2000
        ElseIf _Prog42 = 245 Then
        ElseIf _Prog42 = 246 Then
        ElseIf _Prog42 = 247 Then
            If _Motor < 3 Then
                _eb.lokSteuern(42, Klassen.LokEigenschaften.Funktion3, 0) ' Motor aus
            End If

        ElseIf _Prog42 = 260 Then ' Kontakt 3.3 (links bzw vor der Brücke)
            Prog_Lok42.Interval = 2000
        ElseIf _Prog42 = 261 Then
        ElseIf _Prog42 = 262 Then
            _eb.lokSteuern(42, Klassen.LokEigenschaften.Geschwindigkeit, Stufe3)

        ElseIf _Prog42 = 600 Then ' Kontakt 3.5 <- (unter der Burg)
            Prog_Lok42.Interval = 1000
        ElseIf _Prog42 = 601 Then
            If _AkustischeSignale > 1 Then
                _eb.lokSteuern(43, Klassen.LokEigenschaften.Funktion1, 1) ' Hupe ein
            End If
        ElseIf _Prog42 = 602 Then
            _eb.lokSteuern(43, Klassen.LokEigenschaften.Funktion1, 0) ' Hupe aus
        ElseIf _Prog42 = 603 Then

        ElseIf _Prog42 = 620 Then ' Kontakt 3.7 -> (hinter der Brücke bergab)
            Prog_Lok42.Interval = 2000
        ElseIf _Prog42 = 621 Then
        ElseIf _Prog42 = 622 Then
            If _Motor > 1 Then
                _eb.lokSteuern(42, Klassen.LokEigenschaften.Funktion3, 1) ' Motor ein
            End If
        ElseIf _Prog42 = 623 Then
            Prog_Lok42.Interval = 1000
        ElseIf _Prog42 = 624 Then
            If _AkustischeSignale > 1 Then
                _eb.lokSteuern(43, Klassen.LokEigenschaften.Funktion1, 1) ' Hupe ein
            End If
        ElseIf _Prog42 = 625 Then
            _eb.lokSteuern(43, Klassen.LokEigenschaften.Funktion1, 0) ' Hupe aus

        ElseIf _Prog42 = 640 Then ' Kontakt 3.1 <- Talfahrt
            Prog_Lok42.Interval = 2000
        ElseIf _Prog42 = 641 Then
        ElseIf _Prog42 = 642 Then
        ElseIf _Prog42 = 643 Then
        ElseIf _Prog42 = 644 Then
            If _Motor < 3 Then
                _eb.lokSteuern(42, Klassen.LokEigenschaften.Funktion3, 0) ' Motor aus
            End If

        ElseIf _Prog42 = 660 Then ' Kontakt 1.2 -> Talfahrt
            Prog_Lok42.Interval = 2000
        ElseIf _Prog42 = 661 Then
        ElseIf _Prog42 = 662 Then
            If _GlsL42 = 1 Or _GlsL42 = 2 Then
                If _Motor > 0 Then
                    _eb.lokSteuern(42, Klassen.LokEigenschaften.Funktion3, 1) ' Motor ein
                End If
            End If
        ElseIf _Prog42 = 663 Then
        ElseIf _Prog42 = 664 Then
            Prog_Lok42.Interval = 1000
        ElseIf _Prog42 = 665 Then
            If _GlsL42 = 1 Or _GlsL42 = 2 Then
                If _AkustischeSignale > 0 Then
                    _eb.lokSteuern(43, Klassen.LokEigenschaften.Funktion1, 1) ' Hupe ein
                End If
            End If
        ElseIf _Prog42 = 666 Then
            _eb.lokSteuern(43, Klassen.LokEigenschaften.Funktion1, 0) ' Hupe aus

        ElseIf _Prog42 = 700 Then ' Kontakt 0.4 <- Diagonale
            Prog_Lok42.Interval = 3000
        ElseIf _Prog42 = 701 Then
        ElseIf _Prog42 = 702 Then
        ElseIf _Prog42 = 703 Then
            If _Motor > 1 Then
                _eb.lokSteuern(42, Klassen.LokEigenschaften.Funktion3, 1) ' Motor ein
            End If
        ElseIf _Prog42 = 704 Then
            Prog_Lok42.Interval = 1000
        ElseIf _Prog42 = 705 Then
            If _AkustischeSignale > 0 Then
                _eb.lokSteuern(43, Klassen.LokEigenschaften.Funktion1, 1) ' Hupe ein
            End If
        ElseIf _Prog42 = 706 Then
            _eb.lokSteuern(43, Klassen.LokEigenschaften.Funktion1, 0) ' Hupe aus

            ' Zindelstein

        ElseIf _Prog42 = 500 Then
            Prog_Lok42.Interval = V_500
        ElseIf _Prog42 = 501 Then
            _eb.lokSteuern(42, Klassen.LokEigenschaften.Geschwindigkeit, Stufe23)
            Prog_Lok42.Interval = T_500
        ElseIf _Prog42 = 502 Then
            _eb.lokSteuern(42, Klassen.LokEigenschaften.Geschwindigkeit, Stufe22)
        ElseIf _Prog42 = 503 Then
            _eb.lokSteuern(42, Klassen.LokEigenschaften.Geschwindigkeit, Stufe21)
        ElseIf _Prog42 = 504 Then
            _eb.lokSteuern(42, Klassen.LokEigenschaften.Geschwindigkeit, Stufe2)
        ElseIf _Prog42 = 505 Then
            _eb.lokSteuern(42, Klassen.LokEigenschaften.Geschwindigkeit, 0)

        Else
            _Prog42 = 0
            Prog_Lok42.Stop()
            Prog_Lok42.Interval = 200
            If Betriebsart = 1 Then
                SetProgramCounterLabel1(String.Empty)
            Else
                SetProgramCounterLabel(String.Empty)
            End If
        End If
        _Prog42 = _Prog42 + 1
    End Sub
    Private Sub HandleTimerElapsed55(sender As System.Object, e As System.EventArgs) Handles Prog_Lok43.Elapsed

        '*** Fahrprogramm für "zweite Adresse für Lok 42"
        '*** Datum: 23.02.2020

        SetText(TextBox1, "Diesel-Lok V160 028                                             zweite Adresse für Lok 42")
        LoadImage(PictureBox1, "H:\\EB_Media\\LokFotos\\Baureihe_160_02.jpg")
        GeschwindikeitenSetzen(43)

        Dim Stufe1, Stufe2, Stufe3, Stufe4 As Integer
        Dim Stufe11, Stufe12, Stufe13, Stufe14, Stufe21, Stufe22, Stufe23, Stufe24 As Integer
        Dim V_100, V_130, V_160, V_180, V_500 As Integer
        Dim T_100, T_130, T_160, T_180, T_500 As Integer
        Dim G_200 As Integer

        T_100 = _Betriebsparameter.Fahrparameter(43, KlausEBspecific.Betriebsparameter.FahrparameterEnum.T_100)
        T_130 = _Betriebsparameter.Fahrparameter(43, KlausEBspecific.Betriebsparameter.FahrparameterEnum.T_130)
        T_160 = _Betriebsparameter.Fahrparameter(43, KlausEBspecific.Betriebsparameter.FahrparameterEnum.T_160)
        T_180 = _Betriebsparameter.Fahrparameter(43, KlausEBspecific.Betriebsparameter.FahrparameterEnum.T_180)
        T_500 = _Betriebsparameter.Fahrparameter(43, KlausEBspecific.Betriebsparameter.FahrparameterEnum.T_500)
        V_100 = _Betriebsparameter.Fahrparameter(43, KlausEBspecific.Betriebsparameter.FahrparameterEnum.V_100)
        V_130 = _Betriebsparameter.Fahrparameter(43, KlausEBspecific.Betriebsparameter.FahrparameterEnum.V_130)
        V_160 = _Betriebsparameter.Fahrparameter(43, KlausEBspecific.Betriebsparameter.FahrparameterEnum.V_160)
        V_180 = _Betriebsparameter.Fahrparameter(43, KlausEBspecific.Betriebsparameter.FahrparameterEnum.V_180)
        V_500 = _Betriebsparameter.Fahrparameter(43, KlausEBspecific.Betriebsparameter.FahrparameterEnum.V_500)
        G_200 = _Betriebsparameter.Fahrparameter(43, KlausEBspecific.Betriebsparameter.FahrparameterEnum.G_200)

        If A_StopB = 1 Then
            V_100 = 8000
        End If

        Stufe1 = _LokStufen.Holen(43, 1)
        Stufe2 = _LokStufen.Holen(43, 2)
        Stufe3 = _LokStufen.Holen(43, 3)
        Stufe4 = _LokStufen.Holen(43, 4)

        If Stufe2 = 1 Then
            T_100 = T_100
            T_130 = T_130
            T_160 = T_160
            V_180 = V_180
        ElseIf Stufe2 = 2 Then
            T_100 = T_100 + 300
            T_130 = T_130 + 300
            T_160 = T_160 + 300
            V_180 = V_180 + 500
        ElseIf Stufe2 = 3 Then
            T_100 = T_100 + 500
            T_130 = T_130 + 500
            T_160 = T_160 + 500
            V_180 = V_180 + 1000
        ElseIf Stufe2 = 4 Then
            T_100 = T_100 + 700
            T_130 = T_130 + 700
            T_160 = T_160 + 700
            V_180 = V_180 + 1500
        ElseIf Stufe2 = 5 Then
            T_100 = T_100 + 900
            T_130 = T_130 + 900
            T_160 = T_160 + 900
            V_180 = V_180 + 2000
        ElseIf Stufe2 = 6 Then
            T_100 = T_100 + 1200
            T_130 = T_130 + 1200
            T_160 = T_160 + 1200
            V_180 = V_180 + 2500
        Else
            T_100 = T_100 + 1200
            T_130 = T_130 + 1200
            T_160 = T_160 + 1200
            V_180 = V_180 + 2500
        End If

        Stufe2 = Stufe1

        Stufe11 = Stufe1 + 1
        If Stufe11 > Stufe3 Then
            Stufe11 = Stufe3
        End If
        Stufe12 = Stufe1 + 2
        If Stufe12 > Stufe3 Then
            Stufe12 = Stufe3
        End If
        Stufe13 = Stufe1 + 3
        If Stufe13 > Stufe3 Then
            Stufe13 = Stufe3
        End If
        Stufe14 = Stufe1 + 4
        If Stufe14 > Stufe3 Then
            Stufe14 = Stufe3
        End If

        Stufe21 = Stufe2 + 1
        If Stufe21 > Stufe3 Then
            Stufe21 = Stufe3
        End If
        Stufe22 = Stufe2 + 2
        If Stufe22 > Stufe3 Then
            Stufe22 = Stufe3
        End If
        Stufe23 = Stufe2 + 3
        If Stufe23 > Stufe3 Then
            Stufe23 = Stufe3
        End If
        Stufe24 = Stufe2 + 4
        If Stufe24 > Stufe3 Then
            Stufe24 = Stufe3
        End If
        If G_200 > 0 Then
            If G_200 < Stufe4 Then
                G_200 = Stufe4
            End If
        Else
            G_200 = Stufe4
        End If

        If Betriebsart = 1 And (_GlsL43 = 3 Or _GlsL43 = 4) Then
            SetProgramCounterLabel1(_Prog43)
        Else
            SetProgramCounterLabel(_Prog43)
        End If

        ' Lok starten - Bahnhofsausfahrt

        If _Prog43 = 0 Then
            Prog_Lok43.Interval = 2000
        ElseIf _Prog43 = 1 Then
        ElseIf _Prog43 = 2 Then
            _Betriebsparameter.RundenErhoehen(43)
        ElseIf _Prog43 = 3 Then
        ElseIf _Prog43 = 4 Then
        ElseIf _Prog43 = 5 Then
        ElseIf _Prog43 = 6 Then

            ' Bahnhofsausfahrt

        ElseIf _Prog43 = 7 Then
            _eb.lokSteuern(43, Klassen.LokEigenschaften.Geschwindigkeit, Stufe1)
        ElseIf _Prog43 = 8 Then
            _eb.lokSteuern(43, Klassen.LokEigenschaften.Geschwindigkeit, Stufe11)
        ElseIf _Prog43 = 9 Then
            _eb.lokSteuern(43, Klassen.LokEigenschaften.Geschwindigkeit, Stufe12)
        ElseIf _Prog43 = 10 Then
            _eb.lokSteuern(43, Klassen.LokEigenschaften.Geschwindigkeit, Stufe13)
        ElseIf _Prog43 = 11 Then
            _eb.lokSteuern(43, Klassen.LokEigenschaften.Geschwindigkeit, Stufe14)
        ElseIf _Prog43 = 12 Then
            _eb.lokSteuern(43, Klassen.LokEigenschaften.Geschwindigkeit, Stufe3)

            ' Lok abstellen

        ElseIf _Prog43 = 50 Then
            Prog_Lok43.Interval = 2000
        ElseIf _Prog43 = 51 Then
        ElseIf _Prog43 = 52 Then
            If _Fahrzeugbeleuchtung2 < 2 Then
                _eb.lokSteuern(43, Klassen.LokEigenschaften.Hauptfunktion, 0) ' Licht aus
            End If

            ' Lok bremsen (Bahnhofseinfahrt Normalzug von links und von rechts)

        ElseIf _Prog43 = 100 Then
            Prog_Lok43.Interval = V_100
        ElseIf _Prog43 = 101 Then
            _eb.lokSteuern(43, Klassen.LokEigenschaften.Geschwindigkeit, Stufe24)
            Prog_Lok43.Interval = T_100
        ElseIf _Prog43 = 102 Then
            _eb.lokSteuern(43, Klassen.LokEigenschaften.Geschwindigkeit, Stufe23)
        ElseIf _Prog43 = 103 Then
            _eb.lokSteuern(43, Klassen.LokEigenschaften.Geschwindigkeit, Stufe22)
        ElseIf _Prog43 = 104 Then
            _eb.lokSteuern(43, Klassen.LokEigenschaften.Geschwindigkeit, Stufe21)
        ElseIf _Prog43 = 105 Then
            _eb.lokSteuern(43, Klassen.LokEigenschaften.Geschwindigkeit, Stufe2)

            ' Lok bremsen (Bahnhofseinfahrt Kurzzug von links)

        ElseIf _Prog43 = 130 Then
            Prog_Lok43.Interval = V_130
        ElseIf _Prog43 = 131 Then
            _eb.lokSteuern(43, Klassen.LokEigenschaften.Geschwindigkeit, Stufe24)
            Prog_Lok43.Interval = T_130
        ElseIf _Prog43 = 132 Then
            _eb.lokSteuern(43, Klassen.LokEigenschaften.Geschwindigkeit, Stufe23)
        ElseIf _Prog43 = 133 Then
            _eb.lokSteuern(43, Klassen.LokEigenschaften.Geschwindigkeit, Stufe22)
        ElseIf _Prog43 = 134 Then
            _eb.lokSteuern(43, Klassen.LokEigenschaften.Geschwindigkeit, Stufe21)
        ElseIf _Prog43 = 135 Then
            _eb.lokSteuern(43, Klassen.LokEigenschaften.Geschwindigkeit, Stufe2)
        ElseIf _Prog43 = 136 Then
            _eb.lokSteuern(43, Klassen.LokEigenschaften.Geschwindigkeit, 0)
        ElseIf _Prog43 = 137 Then
            Prog_Lok43.Interval = 2000
        ElseIf _Prog43 = 138 Then
            If _Fahrzeugbeleuchtung2 < 2 Then
                _eb.lokSteuern(43, Klassen.LokEigenschaften.Hauptfunktion, 0) ' Licht aus
            End If

            ' Lok bremsen (Bahnhofseinfahrt Kurzzug von rechts)

        ElseIf _Prog43 = 160 Then
            Prog_Lok43.Interval = V_160
        ElseIf _Prog43 = 161 Then
            _eb.lokSteuern(43, Klassen.LokEigenschaften.Geschwindigkeit, Stufe24)
            Prog_Lok43.Interval = T_160
        ElseIf _Prog43 = 162 Then
            _eb.lokSteuern(43, Klassen.LokEigenschaften.Geschwindigkeit, Stufe23)
        ElseIf _Prog43 = 163 Then
            _eb.lokSteuern(43, Klassen.LokEigenschaften.Geschwindigkeit, Stufe22)
        ElseIf _Prog43 = 164 Then
            _eb.lokSteuern(43, Klassen.LokEigenschaften.Geschwindigkeit, Stufe21)
        ElseIf _Prog43 = 165 Then
            _eb.lokSteuern(43, Klassen.LokEigenschaften.Geschwindigkeit, Stufe2)
        ElseIf _Prog43 = 166 Then
            _eb.lokSteuern(43, Klassen.LokEigenschaften.Geschwindigkeit, 0)
        ElseIf _Prog43 = 167 Then
            Prog_Lok43.Interval = 2000
        ElseIf _Prog43 = 168 Then
            If _Fahrzeugbeleuchtung2 < 2 Then
                _eb.lokSteuern(43, Klassen.LokEigenschaften.Hauptfunktion, 0) ' Licht aus
            End If

            ' Rangierzug

        ElseIf _Prog43 = 180 Then
            _eb.lokSteuern(43, Klassen.LokEigenschaften.Geschwindigkeit, 2)
            Prog_Lok43.Interval = V_180
        ElseIf _Prog43 = 181 Then
            Prog_Lok43.Interval = T_180
            _eb.lokSteuern(43, Klassen.LokEigenschaften.Geschwindigkeit, 1)
        ElseIf _Prog43 = 182 Then
            _eb.lokSteuern(43, Klassen.LokEigenschaften.Geschwindigkeit, 0)

            ' Tunnelausfahrt

        ElseIf _Prog43 = 200 Then ' Kontakt 1.2 <- (bergauf)
            _eb.lokSteuern(43, Klassen.LokEigenschaften.Geschwindigkeit, G_200)
            Prog_Lok43.Interval = 2000
        ElseIf _Prog43 = 201 Then
        ElseIf _Prog43 = 202 Then
        ElseIf _Prog43 = 203 Then
        ElseIf _Prog43 = 204 Then
        ElseIf _Prog43 = 205 Then
            If Stufe4 < Stufe3 Then
                _eb.lokSteuern(43, Klassen.LokEigenschaften.Geschwindigkeit, Stufe3)
            Else
                _eb.lokSteuern(43, Klassen.LokEigenschaften.Geschwindigkeit, Stufe4)
            End If

        ElseIf _Prog43 = 220 Then ' Kontakt 3.1 -> (hinter dem Martinstor bergauf)
            Prog_Lok43.Interval = 2000
        ElseIf _Prog43 = 221 Then
        ElseIf _Prog43 = 222 Then

        ElseIf _Prog43 = 240 Then ' Kontakt 3.7 <- (hinter der Brücke bergauf)
            Prog_Lok43.Interval = 2000
        ElseIf _Prog43 = 241 Then
        ElseIf _Prog43 = 242 Then

        ElseIf _Prog43 = 260 Then ' Kontakt 3.3 (links bzw vor der Brücke)
            Prog_Lok43.Interval = 2000
        ElseIf _Prog43 = 261 Then
        ElseIf _Prog43 = 262 Then
            _eb.lokSteuern(43, Klassen.LokEigenschaften.Geschwindigkeit, Stufe3)

        ElseIf _Prog43 = 600 Then ' Kontakt 3.5 <- (unter der Burg)
            Prog_Lok43.Interval = 2000
        ElseIf _Prog43 = 601 Then
        ElseIf _Prog43 = 602 Then

        ElseIf _Prog43 = 620 Then ' Kontakt 3.7 -> (hinter der Brücke bergab)
            Prog_Lok43.Interval = 2000
        ElseIf _Prog43 = 621 Then
        ElseIf _Prog43 = 622 Then

        ElseIf _Prog43 = 640 Then ' Kontakt 3.1 <- Talfahrt
            Prog_Lok43.Interval = 2000
        ElseIf _Prog43 = 641 Then
        ElseIf _Prog43 = 642 Then

        ElseIf _Prog43 = 660 Then ' Kontakt 1.2 -> Talfahrt
            Prog_Lok43.Interval = 2000
        ElseIf _Prog43 = 661 Then
        ElseIf _Prog43 = 662 Then

        ElseIf _Prog43 = 700 Then ' Kontakt 0.4 <- Diagonale
            Prog_Lok43.Interval = 2000
        ElseIf _Prog43 = 701 Then
        ElseIf _Prog43 = 702 Then

            ' Zindelstein

        ElseIf _Prog43 = 500 Then
            Prog_Lok43.Interval = V_500
        ElseIf _Prog43 = 501 Then
            _eb.lokSteuern(43, Klassen.LokEigenschaften.Geschwindigkeit, Stufe23)
            Prog_Lok43.Interval = T_500
        ElseIf _Prog43 = 502 Then
            _eb.lokSteuern(43, Klassen.LokEigenschaften.Geschwindigkeit, Stufe22)
        ElseIf _Prog43 = 503 Then
            _eb.lokSteuern(43, Klassen.LokEigenschaften.Geschwindigkeit, Stufe21)
        ElseIf _Prog43 = 504 Then
            _eb.lokSteuern(43, Klassen.LokEigenschaften.Geschwindigkeit, Stufe2)
        ElseIf _Prog43 = 505 Then
            _eb.lokSteuern(43, Klassen.LokEigenschaften.Geschwindigkeit, 0)

        Else
            _Prog43 = 0
            Prog_Lok43.Stop()
            Prog_Lok43.Interval = 200
            If Betriebsart = 1 Then
                SetProgramCounterLabel1(String.Empty)
            Else
                SetProgramCounterLabel(String.Empty)
            End If
        End If
        _Prog43 = _Prog43 + 1
    End Sub
    Private Sub HandleTimerElapsed56(sender As System.Object, e As System.EventArgs) Handles Prog_Lok44.Elapsed

        '*** Fahrprogramm für Diesel-Lok 216 090-1
        '*** Datum: 23.02.2020

        SetText(TextBox1, "Diesel-Lok 216 090-1                                                    IBS: 24.11.2023 - V3 : 8")
        LoadImage(PictureBox1, "H:\\EB_Media\\LokFotos\\Baureihe_216_03.jpg")
        GeschwindikeitenSetzen(44)

        Dim Stufe1, Stufe2, Stufe3, Stufe4 As Integer
        Dim Stufe11, Stufe12, Stufe13, Stufe14, Stufe21, Stufe22, Stufe23, Stufe24 As Integer
        Dim V_100, V_130, V_160, V_180, V_500 As Integer
        Dim T_100, T_130, T_160, T_180, T_500 As Integer
        Dim G_200 As Integer

        T_100 = _Betriebsparameter.Fahrparameter(44, KlausEBspecific.Betriebsparameter.FahrparameterEnum.T_100)
        T_130 = _Betriebsparameter.Fahrparameter(44, KlausEBspecific.Betriebsparameter.FahrparameterEnum.T_130)
        T_160 = _Betriebsparameter.Fahrparameter(44, KlausEBspecific.Betriebsparameter.FahrparameterEnum.T_160)
        T_180 = _Betriebsparameter.Fahrparameter(44, KlausEBspecific.Betriebsparameter.FahrparameterEnum.T_180)
        T_500 = _Betriebsparameter.Fahrparameter(44, KlausEBspecific.Betriebsparameter.FahrparameterEnum.T_500)
        V_100 = _Betriebsparameter.Fahrparameter(44, KlausEBspecific.Betriebsparameter.FahrparameterEnum.V_100)
        V_130 = _Betriebsparameter.Fahrparameter(44, KlausEBspecific.Betriebsparameter.FahrparameterEnum.V_130)
        V_160 = _Betriebsparameter.Fahrparameter(44, KlausEBspecific.Betriebsparameter.FahrparameterEnum.V_160)
        V_180 = _Betriebsparameter.Fahrparameter(44, KlausEBspecific.Betriebsparameter.FahrparameterEnum.V_180)
        V_500 = _Betriebsparameter.Fahrparameter(44, KlausEBspecific.Betriebsparameter.FahrparameterEnum.V_500)
        G_200 = _Betriebsparameter.Fahrparameter(44, KlausEBspecific.Betriebsparameter.FahrparameterEnum.G_200)

        If A_StopB = 1 Then
            V_100 = 8000
        End If

        Stufe1 = _LokStufen.Holen(44, 1)
        Stufe2 = _LokStufen.Holen(44, 2)
        Stufe3 = _LokStufen.Holen(44, 3)
        Stufe4 = _LokStufen.Holen(44, 4)

        If Stufe2 = 1 Then
            T_100 = T_100
            T_130 = T_130
            T_160 = T_160
            V_180 = V_180
        ElseIf Stufe2 = 2 Then
            T_100 = T_100 + 300
            T_130 = T_130 + 300
            T_160 = T_160 + 300
            V_180 = V_180 + 500
        ElseIf Stufe2 = 3 Then
            T_100 = T_100 + 500
            T_130 = T_130 + 500
            T_160 = T_160 + 500
            V_180 = V_180 + 1000
        ElseIf Stufe2 = 4 Then
            T_100 = T_100 + 700
            T_130 = T_130 + 700
            T_160 = T_160 + 700
            V_180 = V_180 + 1500
        ElseIf Stufe2 = 5 Then
            T_100 = T_100 + 900
            T_130 = T_130 + 900
            T_160 = T_160 + 900
            V_180 = V_180 + 2000
        ElseIf Stufe2 = 6 Then
            T_100 = T_100 + 1200
            T_130 = T_130 + 1200
            T_160 = T_160 + 1200
            V_180 = V_180 + 2500
        Else
            T_100 = T_100 + 1200
            T_130 = T_130 + 1200
            T_160 = T_160 + 1200
            V_180 = V_180 + 2500
        End If

        Stufe2 = Stufe1

        Stufe11 = Stufe1 + 1
        If Stufe11 > Stufe3 Then
            Stufe11 = Stufe3
        End If
        Stufe12 = Stufe1 + 2
        If Stufe12 > Stufe3 Then
            Stufe12 = Stufe3
        End If
        Stufe13 = Stufe1 + 3
        If Stufe13 > Stufe3 Then
            Stufe13 = Stufe3
        End If
        Stufe14 = Stufe1 + 4
        If Stufe14 > Stufe3 Then
            Stufe14 = Stufe3
        End If

        Stufe21 = Stufe2 + 1
        If Stufe21 > Stufe3 Then
            Stufe21 = Stufe3
        End If
        Stufe22 = Stufe2 + 2
        If Stufe22 > Stufe3 Then
            Stufe22 = Stufe3
        End If
        Stufe23 = Stufe2 + 3
        If Stufe23 > Stufe3 Then
            Stufe23 = Stufe3
        End If
        Stufe24 = Stufe2 + 4
        If Stufe24 > Stufe3 Then
            Stufe24 = Stufe3
        End If
        If G_200 > 0 Then
            If G_200 < Stufe4 Then
                G_200 = Stufe4
            End If
        Else
            G_200 = Stufe4
        End If

        If Betriebsart = 1 And (_GlsL44 = 3 Or _GlsL44 = 4) Then
            SetProgramCounterLabel1(_Prog44)
        Else
            SetProgramCounterLabel(_Prog44)
        End If

        ' Lok starten - Bahnhofsausfahrt

        If _Prog44 = 0 Then
            Prog_Lok44.Interval = 2000
            If _Fahrzeugbeleuchtung2 > 0 Then
                _eb.lokSteuern(44, Klassen.LokEigenschaften.Hauptfunktion, 1) ' Licht ein
            End If
        ElseIf _Prog44 = 1 Then
        ElseIf _Prog44 = 2 Then
            _Betriebsparameter.RundenErhoehen(44)
        ElseIf _Prog44 = 3 Then
        ElseIf _Prog44 = 4 Then
        ElseIf _Prog44 = 5 Then
        ElseIf _Prog44 = 6 Then

            ' Bahnhofsausfahrt

        ElseIf _Prog44 = 7 Then
            _eb.lokSteuern(44, Klassen.LokEigenschaften.Geschwindigkeit, Stufe1)
        ElseIf _Prog44 = 8 Then
            _eb.lokSteuern(44, Klassen.LokEigenschaften.Geschwindigkeit, Stufe11)
        ElseIf _Prog44 = 9 Then
            _eb.lokSteuern(44, Klassen.LokEigenschaften.Geschwindigkeit, Stufe12)
        ElseIf _Prog44 = 10 Then
            _eb.lokSteuern(44, Klassen.LokEigenschaften.Geschwindigkeit, Stufe13)
        ElseIf _Prog44 = 11 Then
            _eb.lokSteuern(44, Klassen.LokEigenschaften.Geschwindigkeit, Stufe14)
        ElseIf _Prog44 = 12 Then
            _eb.lokSteuern(44, Klassen.LokEigenschaften.Geschwindigkeit, Stufe3)

            ' Lok abstellen

        ElseIf _Prog44 = 50 Then
            Prog_Lok44.Interval = 2000
        ElseIf _Prog44 = 51 Then
        ElseIf _Prog44 = 52 Then
            If _Fahrzeugbeleuchtung2 < 2 Then
                _eb.lokSteuern(44, Klassen.LokEigenschaften.Hauptfunktion, 0) ' Licht aus
            End If

            ' Lok bremsen (Bahnhofseinfahrt Normalzug von links und von rechts)

        ElseIf _Prog44 = 100 Then
            Prog_Lok44.Interval = V_100
        ElseIf _Prog44 = 101 Then
            _eb.lokSteuern(44, Klassen.LokEigenschaften.Geschwindigkeit, Stufe24)
            Prog_Lok44.Interval = T_100
        ElseIf _Prog44 = 102 Then
            _eb.lokSteuern(44, Klassen.LokEigenschaften.Geschwindigkeit, Stufe23)
        ElseIf _Prog44 = 103 Then
            _eb.lokSteuern(44, Klassen.LokEigenschaften.Geschwindigkeit, Stufe22)
        ElseIf _Prog44 = 104 Then
            _eb.lokSteuern(44, Klassen.LokEigenschaften.Geschwindigkeit, Stufe21)
        ElseIf _Prog44 = 105 Then
            _eb.lokSteuern(44, Klassen.LokEigenschaften.Geschwindigkeit, Stufe2)

            ' Lok bremsen (Bahnhofseinfahrt Kurzzug von links)

        ElseIf _Prog44 = 130 Then
            Prog_Lok44.Interval = V_130
        ElseIf _Prog44 = 131 Then
            _eb.lokSteuern(44, Klassen.LokEigenschaften.Geschwindigkeit, Stufe24)
            Prog_Lok44.Interval = T_130
        ElseIf _Prog44 = 132 Then
            _eb.lokSteuern(44, Klassen.LokEigenschaften.Geschwindigkeit, Stufe23)
        ElseIf _Prog44 = 133 Then
            _eb.lokSteuern(44, Klassen.LokEigenschaften.Geschwindigkeit, Stufe22)
        ElseIf _Prog44 = 134 Then
            _eb.lokSteuern(44, Klassen.LokEigenschaften.Geschwindigkeit, Stufe21)
        ElseIf _Prog44 = 135 Then
            _eb.lokSteuern(44, Klassen.LokEigenschaften.Geschwindigkeit, Stufe2)
        ElseIf _Prog44 = 136 Then
            _eb.lokSteuern(44, Klassen.LokEigenschaften.Geschwindigkeit, 0)
        ElseIf _Prog44 = 137 Then
            Prog_Lok44.Interval = 2000
        ElseIf _Prog44 = 138 Then
            If _Fahrzeugbeleuchtung2 < 2 Then
                _eb.lokSteuern(44, Klassen.LokEigenschaften.Hauptfunktion, 0) ' Licht aus
            End If

            ' Lok bremsen (Bahnhofseinfahrt Kurzzug von rechts)

        ElseIf _Prog44 = 160 Then
            Prog_Lok44.Interval = V_160
        ElseIf _Prog44 = 161 Then
            _eb.lokSteuern(44, Klassen.LokEigenschaften.Geschwindigkeit, Stufe24)
            Prog_Lok44.Interval = T_160
        ElseIf _Prog44 = 162 Then
            _eb.lokSteuern(44, Klassen.LokEigenschaften.Geschwindigkeit, Stufe23)
        ElseIf _Prog44 = 163 Then
            _eb.lokSteuern(44, Klassen.LokEigenschaften.Geschwindigkeit, Stufe22)
        ElseIf _Prog44 = 164 Then
            _eb.lokSteuern(44, Klassen.LokEigenschaften.Geschwindigkeit, Stufe21)
        ElseIf _Prog44 = 165 Then
            _eb.lokSteuern(44, Klassen.LokEigenschaften.Geschwindigkeit, Stufe2)
        ElseIf _Prog44 = 166 Then
            _eb.lokSteuern(44, Klassen.LokEigenschaften.Geschwindigkeit, 0)
        ElseIf _Prog44 = 167 Then
            Prog_Lok44.Interval = 2000
        ElseIf _Prog44 = 168 Then
            If _Fahrzeugbeleuchtung2 < 2 Then
                _eb.lokSteuern(44, Klassen.LokEigenschaften.Hauptfunktion, 0) ' Licht aus
            End If

            ' Rangierzug

        ElseIf _Prog44 = 180 Then
            _eb.lokSteuern(44, Klassen.LokEigenschaften.Geschwindigkeit, Stufe2)
            Prog_Lok44.Interval = V_180
        ElseIf _Prog44 = 181 Then
            Prog_Lok44.Interval = T_180
            _eb.lokSteuern(44, Klassen.LokEigenschaften.Geschwindigkeit, 3)
        ElseIf _Prog44 = 182 Then
            _eb.lokSteuern(44, Klassen.LokEigenschaften.Geschwindigkeit, 0)

            ' Tunnelausfahrt

        ElseIf _Prog44 = 200 Then ' Kontakt 1.2 <- (bergauf)
            _eb.lokSteuern(44, Klassen.LokEigenschaften.Geschwindigkeit, G_200)
            Prog_Lok44.Interval = 2000
        ElseIf _Prog44 = 201 Then
        ElseIf _Prog44 = 202 Then
        ElseIf _Prog44 = 203 Then
        ElseIf _Prog44 = 204 Then
        ElseIf _Prog44 = 205 Then
            If Stufe4 < Stufe3 Then
                _eb.lokSteuern(44, Klassen.LokEigenschaften.Geschwindigkeit, Stufe3)
            Else
                _eb.lokSteuern(44, Klassen.LokEigenschaften.Geschwindigkeit, Stufe4)
            End If

        ElseIf _Prog44 = 220 Then ' Kontakt 3.1 -> (hinter dem Martinstor bergauf)
            Prog_Lok44.Interval = 2000
        ElseIf _Prog44 = 221 Then
        ElseIf _Prog44 = 222 Then

        ElseIf _Prog44 = 240 Then ' Kontakt 3.7 <- (hinter der Brücke bergauf)
            Prog_Lok44.Interval = 2000
        ElseIf _Prog44 = 241 Then
        ElseIf _Prog44 = 242 Then

        ElseIf _Prog44 = 260 Then ' Kontakt 3.3 (links bzw vor der Brücke)
            Prog_Lok44.Interval = 2000
        ElseIf _Prog44 = 261 Then
        ElseIf _Prog44 = 262 Then
            _eb.lokSteuern(44, Klassen.LokEigenschaften.Geschwindigkeit, Stufe3)

        ElseIf _Prog44 = 600 Then ' Kontakt 3.5 <- (unter der Burg)
            Prog_Lok44.Interval = 2000
        ElseIf _Prog44 = 601 Then
        ElseIf _Prog44 = 602 Then

        ElseIf _Prog44 = 620 Then ' Kontakt 3.7 -> (hinter der Brücke bergab)
            Prog_Lok44.Interval = 2000
        ElseIf _Prog44 = 621 Then
        ElseIf _Prog44 = 622 Then

        ElseIf _Prog44 = 640 Then ' Kontakt 3.1 <- Talfahrt
            Prog_Lok44.Interval = 2000
        ElseIf _Prog44 = 641 Then
        ElseIf _Prog44 = 642 Then

        ElseIf _Prog44 = 660 Then ' Kontakt 1.2 -> Talfahrt
            Prog_Lok44.Interval = 2000
        ElseIf _Prog44 = 661 Then
        ElseIf _Prog44 = 662 Then

        ElseIf _Prog44 = 700 Then ' Kontakt 0.4 <- Diagonale
            Prog_Lok44.Interval = 2000
        ElseIf _Prog44 = 701 Then
        ElseIf _Prog44 = 702 Then

            ' Zindelstein

        ElseIf _Prog44 = 500 Then
            Prog_Lok44.Interval = 1000
        ElseIf _Prog44 = 501 Then
            _eb.lokSteuern(44, Klassen.LokEigenschaften.Geschwindigkeit, Stufe23)
            Prog_Lok44.Interval = 1000
        ElseIf _Prog44 = 502 Then
            _eb.lokSteuern(44, Klassen.LokEigenschaften.Geschwindigkeit, Stufe22)
        ElseIf _Prog44 = 503 Then
            _eb.lokSteuern(44, Klassen.LokEigenschaften.Geschwindigkeit, Stufe21)
        ElseIf _Prog44 = 504 Then
            _eb.lokSteuern(44, Klassen.LokEigenschaften.Geschwindigkeit, Stufe2)
        ElseIf _Prog44 = 505 Then
            _eb.lokSteuern(44, Klassen.LokEigenschaften.Geschwindigkeit, 0)

        Else
            _Prog44 = 0
            Prog_Lok44.Stop()
            Prog_Lok44.Interval = 200
            If Betriebsart = 1 Then
                SetProgramCounterLabel1(String.Empty)
            Else
                SetProgramCounterLabel(String.Empty)
            End If
        End If
        _Prog44 = _Prog44 + 1
    End Sub
    Private Sub HandleTimerElapsed57(sender As System.Object, e As System.EventArgs) Handles Prog_Lok45.Elapsed

        '*** Fahrprogramm für Diesel-Lok 212 215-8
        '*** Datum: 23.02.2020

        SetText(TextBox1, "Diesel-Lok 212 215-8                                                    IBS: 02.04.2021 - V3 : 10")
        LoadImage(PictureBox1, "H:\\EB_Media\\LokFotos\\Baureihe_212_10.jpg")
        GeschwindikeitenSetzen(45)

        Dim Stufe1, Stufe2, Stufe3, Stufe4 As Integer
        Dim Stufe11, Stufe12, Stufe13, Stufe14, Stufe21, Stufe22, Stufe23, Stufe24 As Integer
        Dim V_100, V_130, V_160, V_180, V_500 As Integer
        Dim T_100, T_130, T_160, T_180, T_500 As Integer
        Dim G_200 As Integer

        T_100 = _Betriebsparameter.Fahrparameter(45, KlausEBspecific.Betriebsparameter.FahrparameterEnum.T_100)
        T_130 = _Betriebsparameter.Fahrparameter(45, KlausEBspecific.Betriebsparameter.FahrparameterEnum.T_130)
        T_160 = _Betriebsparameter.Fahrparameter(45, KlausEBspecific.Betriebsparameter.FahrparameterEnum.T_160)
        T_180 = _Betriebsparameter.Fahrparameter(45, KlausEBspecific.Betriebsparameter.FahrparameterEnum.T_180)
        T_500 = _Betriebsparameter.Fahrparameter(45, KlausEBspecific.Betriebsparameter.FahrparameterEnum.T_500)
        V_100 = _Betriebsparameter.Fahrparameter(45, KlausEBspecific.Betriebsparameter.FahrparameterEnum.V_100)
        V_130 = _Betriebsparameter.Fahrparameter(45, KlausEBspecific.Betriebsparameter.FahrparameterEnum.V_130)
        V_160 = _Betriebsparameter.Fahrparameter(45, KlausEBspecific.Betriebsparameter.FahrparameterEnum.V_160)
        V_180 = _Betriebsparameter.Fahrparameter(45, KlausEBspecific.Betriebsparameter.FahrparameterEnum.V_180)
        V_500 = _Betriebsparameter.Fahrparameter(45, KlausEBspecific.Betriebsparameter.FahrparameterEnum.V_500)
        G_200 = _Betriebsparameter.Fahrparameter(45, KlausEBspecific.Betriebsparameter.FahrparameterEnum.G_200)

        If A_StopB = 1 Then
            V_100 = 8000
        End If

        Stufe1 = _LokStufen.Holen(45, 1)
        Stufe2 = _LokStufen.Holen(45, 2)
        Stufe3 = _LokStufen.Holen(45, 3)
        Stufe4 = _LokStufen.Holen(45, 4)

        If Stufe2 = 1 Then
            T_100 = T_100
            T_130 = T_130
            T_160 = T_160
            V_180 = V_180
        ElseIf Stufe2 = 2 Then
            T_100 = T_100 + 300
            T_130 = T_130 + 300
            T_160 = T_160 + 300
            V_180 = V_180 + 500
        ElseIf Stufe2 = 3 Then
            T_100 = T_100 + 500
            T_130 = T_130 + 500
            T_160 = T_160 + 500
            V_180 = V_180 + 1000
        ElseIf Stufe2 = 4 Then
            T_100 = T_100 + 700
            T_130 = T_130 + 700
            T_160 = T_160 + 700
            V_180 = V_180 + 1500
        ElseIf Stufe2 = 5 Then
            T_100 = T_100 + 900
            T_130 = T_130 + 900
            T_160 = T_160 + 900
            V_180 = V_180 + 2000
        ElseIf Stufe2 = 6 Then
            T_100 = T_100 + 1200
            T_130 = T_130 + 1200
            T_160 = T_160 + 1200
            V_180 = V_180 + 2500
        Else
            T_100 = T_100 + 1200
            T_130 = T_130 + 1200
            T_160 = T_160 + 1200
            V_180 = V_180 + 2500
        End If

        Stufe2 = Stufe1

        Stufe11 = Stufe1 + 1
        If Stufe11 > Stufe3 Then
            Stufe11 = Stufe3
        End If
        Stufe12 = Stufe1 + 2
        If Stufe12 > Stufe3 Then
            Stufe12 = Stufe3
        End If
        Stufe13 = Stufe1 + 3
        If Stufe13 > Stufe3 Then
            Stufe13 = Stufe3
        End If
        Stufe14 = Stufe1 + 4
        If Stufe14 > Stufe3 Then
            Stufe14 = Stufe3
        End If

        Stufe21 = Stufe2 + 1
        If Stufe21 > Stufe3 Then
            Stufe21 = Stufe3
        End If
        Stufe22 = Stufe2 + 2
        If Stufe22 > Stufe3 Then
            Stufe22 = Stufe3
        End If
        Stufe23 = Stufe2 + 3
        If Stufe23 > Stufe3 Then
            Stufe23 = Stufe3
        End If
        Stufe24 = Stufe2 + 4
        If Stufe24 > Stufe3 Then
            Stufe24 = Stufe3
        End If
        If G_200 > 0 Then
            If G_200 < Stufe4 Then
                G_200 = Stufe4
            End If
        Else
            G_200 = Stufe4
        End If

        If Betriebsart = 1 And (_GlsL45 = 3 Or _GlsL45 = 4) Then
            SetProgramCounterLabel1(_Prog45)
        Else
            SetProgramCounterLabel(_Prog45)
        End If

        ' Lok starten - Bahnhofsausfahrt

        If _Prog45 = 0 Then
            Prog_Lok45.Interval = 2000
            If _Fahrzeugbeleuchtung2 > 0 Then
                _eb.lokSteuern(45, Klassen.LokEigenschaften.Hauptfunktion, 1) ' Licht ein
            End If
        ElseIf _Prog45 = 1 Then
        ElseIf _Prog45 = 2 Then
            _Betriebsparameter.RundenErhoehen(45)
        ElseIf _Prog45 = 3 Then
        ElseIf _Prog45 = 4 Then
        ElseIf _Prog45 = 5 Then
        ElseIf _Prog45 = 6 Then

            ' Bahnhofsausfahrt

        ElseIf _Prog45 = 7 Then
            _eb.lokSteuern(45, Klassen.LokEigenschaften.Geschwindigkeit, Stufe1)
        ElseIf _Prog45 = 8 Then
            _eb.lokSteuern(45, Klassen.LokEigenschaften.Geschwindigkeit, Stufe11)
        ElseIf _Prog45 = 9 Then
            _eb.lokSteuern(45, Klassen.LokEigenschaften.Geschwindigkeit, Stufe12)
        ElseIf _Prog45 = 10 Then
            _eb.lokSteuern(45, Klassen.LokEigenschaften.Geschwindigkeit, Stufe13)
        ElseIf _Prog45 = 11 Then
            _eb.lokSteuern(45, Klassen.LokEigenschaften.Geschwindigkeit, Stufe14)
        ElseIf _Prog45 = 12 Then
            _eb.lokSteuern(45, Klassen.LokEigenschaften.Geschwindigkeit, Stufe3)

            ' Lok abstellen

        ElseIf _Prog45 = 50 Then
            Prog_Lok45.Interval = 2000
        ElseIf _Prog45 = 51 Then
        ElseIf _Prog45 = 52 Then
            If _Fahrzeugbeleuchtung2 < 2 Then
                _eb.lokSteuern(45, Klassen.LokEigenschaften.Hauptfunktion, 0) ' Licht aus
            End If

            ' Lok bremsen (Bahnhofseinfahrt Normalzug von links und von rechts)

        ElseIf _Prog45 = 100 Then
            Prog_Lok45.Interval = V_100
        ElseIf _Prog45 = 101 Then
            _eb.lokSteuern(45, Klassen.LokEigenschaften.Geschwindigkeit, Stufe24)
            Prog_Lok45.Interval = T_100
        ElseIf _Prog45 = 102 Then
            _eb.lokSteuern(45, Klassen.LokEigenschaften.Geschwindigkeit, Stufe23)
        ElseIf _Prog45 = 103 Then
            _eb.lokSteuern(45, Klassen.LokEigenschaften.Geschwindigkeit, Stufe22)
        ElseIf _Prog45 = 104 Then
            _eb.lokSteuern(45, Klassen.LokEigenschaften.Geschwindigkeit, Stufe21)
        ElseIf _Prog45 = 105 Then
            _eb.lokSteuern(45, Klassen.LokEigenschaften.Geschwindigkeit, Stufe2)

            ' Lok bremsen (Bahnhofseinfahrt Kurzzug von links)

        ElseIf _Prog45 = 130 Then
            Prog_Lok45.Interval = V_130
        ElseIf _Prog45 = 131 Then
            _eb.lokSteuern(45, Klassen.LokEigenschaften.Geschwindigkeit, Stufe24)
            Prog_Lok45.Interval = T_130
        ElseIf _Prog45 = 132 Then
            _eb.lokSteuern(45, Klassen.LokEigenschaften.Geschwindigkeit, Stufe23)
        ElseIf _Prog45 = 133 Then
            _eb.lokSteuern(45, Klassen.LokEigenschaften.Geschwindigkeit, Stufe22)
        ElseIf _Prog45 = 134 Then
            _eb.lokSteuern(45, Klassen.LokEigenschaften.Geschwindigkeit, Stufe21)
        ElseIf _Prog45 = 135 Then
            _eb.lokSteuern(45, Klassen.LokEigenschaften.Geschwindigkeit, Stufe2)
        ElseIf _Prog45 = 136 Then
            _eb.lokSteuern(45, Klassen.LokEigenschaften.Geschwindigkeit, 0)
        ElseIf _Prog45 = 137 Then
            Prog_Lok45.Interval = 2000
        ElseIf _Prog45 = 138 Then
            If _Fahrzeugbeleuchtung2 < 2 Then
                _eb.lokSteuern(45, Klassen.LokEigenschaften.Hauptfunktion, 0) ' Licht aus
            End If

            ' Lok bremsen (Bahnhofseinfahrt Kurzzug von rechts)

        ElseIf _Prog45 = 160 Then
            Prog_Lok45.Interval = V_160
        ElseIf _Prog45 = 161 Then
            _eb.lokSteuern(45, Klassen.LokEigenschaften.Geschwindigkeit, Stufe24)
            Prog_Lok45.Interval = T_160
        ElseIf _Prog45 = 162 Then
            _eb.lokSteuern(45, Klassen.LokEigenschaften.Geschwindigkeit, Stufe23)
        ElseIf _Prog45 = 163 Then
            _eb.lokSteuern(45, Klassen.LokEigenschaften.Geschwindigkeit, Stufe22)
        ElseIf _Prog45 = 164 Then
            _eb.lokSteuern(45, Klassen.LokEigenschaften.Geschwindigkeit, Stufe21)
        ElseIf _Prog45 = 165 Then
            _eb.lokSteuern(45, Klassen.LokEigenschaften.Geschwindigkeit, Stufe2)
        ElseIf _Prog45 = 166 Then
            _eb.lokSteuern(45, Klassen.LokEigenschaften.Geschwindigkeit, 0)
        ElseIf _Prog45 = 167 Then
            Prog_Lok45.Interval = 2000
        ElseIf _Prog45 = 168 Then
            If _Fahrzeugbeleuchtung2 < 2 Then
                _eb.lokSteuern(45, Klassen.LokEigenschaften.Hauptfunktion, 0) ' Licht aus
            End If

            ' Rangierzug

        ElseIf _Prog45 = 180 Then
            _eb.lokSteuern(45, Klassen.LokEigenschaften.Geschwindigkeit, 6)
            Prog_Lok45.Interval = V_180
        ElseIf _Prog45 = 181 Then
            Prog_Lok45.Interval = T_180
            _eb.lokSteuern(45, Klassen.LokEigenschaften.Geschwindigkeit, 4)
        ElseIf _Prog45 = 182 Then
            _eb.lokSteuern(45, Klassen.LokEigenschaften.Geschwindigkeit, 0)

            ' Tunnelausfahrt

        ElseIf _Prog45 = 200 Then ' Kontakt 1.2 <- (bergauf)
            _eb.lokSteuern(45, Klassen.LokEigenschaften.Geschwindigkeit, G_200)
            Prog_Lok45.Interval = 2000
        ElseIf _Prog45 = 201 Then
        ElseIf _Prog45 = 202 Then
        ElseIf _Prog45 = 203 Then
        ElseIf _Prog45 = 204 Then
        ElseIf _Prog45 = 205 Then
            If Stufe4 < Stufe3 Then
                _eb.lokSteuern(45, Klassen.LokEigenschaften.Geschwindigkeit, Stufe3)
            Else
                _eb.lokSteuern(45, Klassen.LokEigenschaften.Geschwindigkeit, Stufe4)
            End If

        ElseIf _Prog45 = 220 Then ' Kontakt 3.1 -> (hinter dem Martinstor bergauf)
            Prog_Lok45.Interval = 2000
        ElseIf _Prog45 = 221 Then
        ElseIf _Prog45 = 222 Then

        ElseIf _Prog45 = 240 Then ' Kontakt 3.7 <- (hinter der Brücke bergauf)
            Prog_Lok45.Interval = 2000
        ElseIf _Prog45 = 241 Then
        ElseIf _Prog45 = 242 Then

        ElseIf _Prog45 = 260 Then ' Kontakt 3.3 (links bzw vor der Brücke)
            Prog_Lok45.Interval = 2000
        ElseIf _Prog45 = 261 Then
        ElseIf _Prog45 = 262 Then
            _eb.lokSteuern(45, Klassen.LokEigenschaften.Geschwindigkeit, Stufe3)

        ElseIf _Prog45 = 600 Then ' Kontakt 3.5 <- (unter der Burg)
            Prog_Lok45.Interval = 2000
        ElseIf _Prog45 = 601 Then
        ElseIf _Prog45 = 602 Then

        ElseIf _Prog45 = 620 Then ' Kontakt 3.7 -> (hinter der Brücke bergab)
            Prog_Lok45.Interval = 2000
        ElseIf _Prog45 = 621 Then
        ElseIf _Prog45 = 622 Then

        ElseIf _Prog45 = 640 Then ' Kontakt 3.1 <- Talfahrt
            Prog_Lok45.Interval = 2000
        ElseIf _Prog45 = 641 Then
        ElseIf _Prog45 = 642 Then

        ElseIf _Prog45 = 660 Then ' Kontakt 1.2 -> Talfahrt
            Prog_Lok45.Interval = 2000
        ElseIf _Prog45 = 661 Then
        ElseIf _Prog45 = 662 Then

        ElseIf _Prog45 = 700 Then ' Kontakt 0.4 <- Diagonale
            Prog_Lok45.Interval = 2000
        ElseIf _Prog45 = 701 Then
        ElseIf _Prog45 = 702 Then

            ' Zindelstein

        ElseIf _Prog45 = 500 Then
            Prog_Lok45.Interval = V_500
        ElseIf _Prog45 = 501 Then
            _eb.lokSteuern(45, Klassen.LokEigenschaften.Geschwindigkeit, Stufe23)
            Prog_Lok45.Interval = T_500
        ElseIf _Prog45 = 502 Then
            _eb.lokSteuern(45, Klassen.LokEigenschaften.Geschwindigkeit, Stufe22)
        ElseIf _Prog45 = 503 Then
            _eb.lokSteuern(45, Klassen.LokEigenschaften.Geschwindigkeit, Stufe21)
        ElseIf _Prog45 = 504 Then
            _eb.lokSteuern(45, Klassen.LokEigenschaften.Geschwindigkeit, Stufe2)
        ElseIf _Prog45 = 505 Then
            _eb.lokSteuern(45, Klassen.LokEigenschaften.Geschwindigkeit, 0)

        Else
            _Prog45 = 0
            Prog_Lok45.Stop()
            Prog_Lok45.Interval = 200
            If Betriebsart = 1 Then
                SetProgramCounterLabel1(String.Empty)
            Else
                SetProgramCounterLabel(String.Empty)
            End If
        End If
        _Prog45 = _Prog45 + 1
    End Sub
    Private Sub HandleTimerElapsed58(sender As System.Object, e As System.EventArgs) Handles Prog_Lok46.Elapsed

        '*** Fahrprogramm für Diesel-Lok V200 056
        '*** Datum: 23.02.2020

        SetText(TextBox1, "Diesel-Lok V200 056                                                     IBS: 25.01.2022 V1: 6 - V3: 9")
        LoadImage(PictureBox1, "H:\\EB_Media\\LokFotos\\Baureihe_V200_01.jpg")
        GeschwindikeitenSetzen(46)

        Dim Stufe1, Stufe2, Stufe3, Stufe4 As Integer
        Dim Stufe11, Stufe12, Stufe13, Stufe14, Stufe21, Stufe22, Stufe23, Stufe24 As Integer
        Dim V_100, V_130, V_160, V_180, V_500 As Integer
        Dim T_100, T_130, T_160, T_180, T_500 As Integer
        Dim G_200 As Integer

        T_100 = _Betriebsparameter.Fahrparameter(46, KlausEBspecific.Betriebsparameter.FahrparameterEnum.T_100)
        T_130 = _Betriebsparameter.Fahrparameter(46, KlausEBspecific.Betriebsparameter.FahrparameterEnum.T_130)
        T_160 = _Betriebsparameter.Fahrparameter(46, KlausEBspecific.Betriebsparameter.FahrparameterEnum.T_160)
        T_180 = _Betriebsparameter.Fahrparameter(46, KlausEBspecific.Betriebsparameter.FahrparameterEnum.T_180)
        T_500 = _Betriebsparameter.Fahrparameter(46, KlausEBspecific.Betriebsparameter.FahrparameterEnum.T_500)
        V_100 = _Betriebsparameter.Fahrparameter(46, KlausEBspecific.Betriebsparameter.FahrparameterEnum.V_100)
        V_130 = _Betriebsparameter.Fahrparameter(46, KlausEBspecific.Betriebsparameter.FahrparameterEnum.V_130)
        V_160 = _Betriebsparameter.Fahrparameter(46, KlausEBspecific.Betriebsparameter.FahrparameterEnum.V_160)
        V_180 = _Betriebsparameter.Fahrparameter(46, KlausEBspecific.Betriebsparameter.FahrparameterEnum.V_180)
        V_500 = _Betriebsparameter.Fahrparameter(46, KlausEBspecific.Betriebsparameter.FahrparameterEnum.V_500)
        G_200 = _Betriebsparameter.Fahrparameter(46, KlausEBspecific.Betriebsparameter.FahrparameterEnum.G_200)

        If A_StopB = 1 Then
            V_100 = 8000
        End If

        Stufe1 = _LokStufen.Holen(46, 1)
        Stufe2 = _LokStufen.Holen(46, 2)
        Stufe3 = _LokStufen.Holen(46, 3)
        Stufe4 = _LokStufen.Holen(46, 4)

        If Stufe2 = 1 Then
            T_100 = T_100
            T_130 = T_130
            T_160 = T_160
            V_180 = V_180
        ElseIf Stufe2 = 2 Then
            T_100 = T_100 + 300
            T_130 = T_130 + 300
            T_160 = T_160 + 300
            V_180 = V_180 + 500
        ElseIf Stufe2 = 3 Then
            T_100 = T_100 + 500
            T_130 = T_130 + 500
            T_160 = T_160 + 500
            V_180 = V_180 + 1000
        ElseIf Stufe2 = 4 Then
            T_100 = T_100 + 700
            T_130 = T_130 + 700
            T_160 = T_160 + 700
            V_180 = V_180 + 1500
        ElseIf Stufe2 = 5 Then
            T_100 = T_100 + 900
            T_130 = T_130 + 900
            T_160 = T_160 + 900
            V_180 = V_180 + 2000
        ElseIf Stufe2 = 6 Then
            T_100 = T_100 + 1200
            T_130 = T_130 + 1200
            T_160 = T_160 + 1200
            V_180 = V_180 + 2500
        Else
            T_100 = T_100 + 1200
            T_130 = T_130 + 1200
            T_160 = T_160 + 1200
            V_180 = V_180 + 2500
        End If

        Stufe2 = Stufe1

        Stufe11 = Stufe1 + 1
        If Stufe11 > Stufe3 Then
            Stufe11 = Stufe3
        End If
        Stufe12 = Stufe1 + 2
        If Stufe12 > Stufe3 Then
            Stufe12 = Stufe3
        End If
        Stufe13 = Stufe1 + 3
        If Stufe13 > Stufe3 Then
            Stufe13 = Stufe3
        End If
        Stufe14 = Stufe1 + 4
        If Stufe14 > Stufe3 Then
            Stufe14 = Stufe3
        End If

        Stufe21 = Stufe2 + 1
        If Stufe21 > Stufe3 Then
            Stufe21 = Stufe3
        End If
        Stufe22 = Stufe2 + 2
        If Stufe22 > Stufe3 Then
            Stufe22 = Stufe3
        End If
        Stufe23 = Stufe2 + 3
        If Stufe23 > Stufe3 Then
            Stufe23 = Stufe3
        End If
        Stufe24 = Stufe2 + 4
        If Stufe24 > Stufe3 Then
            Stufe24 = Stufe3
        End If
        If G_200 > 0 Then
            If G_200 < Stufe4 Then
                G_200 = Stufe4
            End If
        Else
            G_200 = Stufe4
        End If

        If Betriebsart = 1 And (_GlsL46 = 3 Or _GlsL46 = 4) Then
            SetProgramCounterLabel1(_Prog46)
        Else
            SetProgramCounterLabel(_Prog46)
        End If

        ' Lok starten - Bahnhofsausfahrt

        If _Prog46 = 0 Then
            Prog_Lok46.Interval = 2000
            If _Fahrzeugbeleuchtung2 > 0 Then
                _eb.lokSteuern(46, Klassen.LokEigenschaften.Hauptfunktion, 1) ' Licht ein
            End If
        ElseIf _Prog46 = 1 Then
        ElseIf _Prog46 = 2 Then
            _Betriebsparameter.RundenErhoehen(46)
        ElseIf _Prog46 = 3 Then
        ElseIf _Prog46 = 4 Then
        ElseIf _Prog46 = 5 Then
        ElseIf _Prog46 = 6 Then

            ' Bahnhofsausfahrt

        ElseIf _Prog46 = 7 Then
            _eb.lokSteuern(46, Klassen.LokEigenschaften.Geschwindigkeit, Stufe1)
        ElseIf _Prog46 = 8 Then
            _eb.lokSteuern(46, Klassen.LokEigenschaften.Geschwindigkeit, Stufe11)
        ElseIf _Prog46 = 9 Then
            _eb.lokSteuern(46, Klassen.LokEigenschaften.Geschwindigkeit, Stufe12)
        ElseIf _Prog46 = 10 Then
            _eb.lokSteuern(46, Klassen.LokEigenschaften.Geschwindigkeit, Stufe13)
        ElseIf _Prog46 = 11 Then
            _eb.lokSteuern(46, Klassen.LokEigenschaften.Geschwindigkeit, Stufe14)
        ElseIf _Prog46 = 12 Then
            _eb.lokSteuern(46, Klassen.LokEigenschaften.Geschwindigkeit, Stufe3)

            ' Lok abstellen

        ElseIf _Prog46 = 50 Then
            Prog_Lok46.Interval = 2000
        ElseIf _Prog46 = 51 Then
        ElseIf _Prog46 = 52 Then
            If _Fahrzeugbeleuchtung2 < 2 Then
                _eb.lokSteuern(46, Klassen.LokEigenschaften.Hauptfunktion, 0) ' Licht aus
            End If

            ' Lok bremsen (Bahnhofseinfahrt Normalzug von links und von rechts)

        ElseIf _Prog46 = 100 Then
            Prog_Lok46.Interval = V_100
        ElseIf _Prog46 = 101 Then
            _eb.lokSteuern(46, Klassen.LokEigenschaften.Geschwindigkeit, Stufe24)
            Prog_Lok46.Interval = T_100
        ElseIf _Prog46 = 102 Then
            _eb.lokSteuern(46, Klassen.LokEigenschaften.Geschwindigkeit, Stufe23)
        ElseIf _Prog46 = 103 Then
            _eb.lokSteuern(46, Klassen.LokEigenschaften.Geschwindigkeit, Stufe22)
        ElseIf _Prog46 = 104 Then
            _eb.lokSteuern(46, Klassen.LokEigenschaften.Geschwindigkeit, Stufe21)
        ElseIf _Prog46 = 105 Then
            _eb.lokSteuern(46, Klassen.LokEigenschaften.Geschwindigkeit, Stufe2)

            ' Lok bremsen (Bahnhofseinfahrt Kurzzug von links)

        ElseIf _Prog46 = 130 Then
            Prog_Lok46.Interval = V_130
        ElseIf _Prog46 = 131 Then
            _eb.lokSteuern(46, Klassen.LokEigenschaften.Geschwindigkeit, Stufe24)
            Prog_Lok46.Interval = T_130
        ElseIf _Prog46 = 132 Then
            _eb.lokSteuern(46, Klassen.LokEigenschaften.Geschwindigkeit, Stufe23)
        ElseIf _Prog46 = 133 Then
            _eb.lokSteuern(46, Klassen.LokEigenschaften.Geschwindigkeit, Stufe22)
        ElseIf _Prog46 = 134 Then
            _eb.lokSteuern(46, Klassen.LokEigenschaften.Geschwindigkeit, Stufe21)
        ElseIf _Prog46 = 135 Then
            _eb.lokSteuern(46, Klassen.LokEigenschaften.Geschwindigkeit, Stufe2)
        ElseIf _Prog46 = 136 Then
            _eb.lokSteuern(46, Klassen.LokEigenschaften.Geschwindigkeit, 0)
        ElseIf _Prog46 = 137 Then
            Prog_Lok46.Interval = 2000
        ElseIf _Prog46 = 138 Then
            If _Fahrzeugbeleuchtung2 < 2 Then
                _eb.lokSteuern(46, Klassen.LokEigenschaften.Hauptfunktion, 0) ' Licht aus
            End If

            ' Lok bremsen (Bahnhofseinfahrt Kurzzug von rechts)

        ElseIf _Prog46 = 160 Then
            Prog_Lok46.Interval = V_160
        ElseIf _Prog46 = 161 Then
            _eb.lokSteuern(46, Klassen.LokEigenschaften.Geschwindigkeit, Stufe24)
            Prog_Lok46.Interval = T_160
        ElseIf _Prog46 = 162 Then
            _eb.lokSteuern(46, Klassen.LokEigenschaften.Geschwindigkeit, Stufe23)
        ElseIf _Prog46 = 163 Then
            _eb.lokSteuern(46, Klassen.LokEigenschaften.Geschwindigkeit, Stufe22)
        ElseIf _Prog46 = 164 Then
            _eb.lokSteuern(46, Klassen.LokEigenschaften.Geschwindigkeit, Stufe21)
        ElseIf _Prog46 = 165 Then
            _eb.lokSteuern(46, Klassen.LokEigenschaften.Geschwindigkeit, Stufe2)
        ElseIf _Prog46 = 166 Then
            _eb.lokSteuern(46, Klassen.LokEigenschaften.Geschwindigkeit, 0)
        ElseIf _Prog46 = 167 Then
            Prog_Lok46.Interval = 2000
        ElseIf _Prog46 = 168 Then
            If _Fahrzeugbeleuchtung2 < 2 Then
                _eb.lokSteuern(46, Klassen.LokEigenschaften.Hauptfunktion, 0) ' Licht aus
            End If

            ' Rangierzug

        ElseIf _Prog46 = 180 Then
            _eb.lokSteuern(46, Klassen.LokEigenschaften.Geschwindigkeit, 2)
            Prog_Lok46.Interval = V_180
        ElseIf _Prog46 = 181 Then
            Prog_Lok46.Interval = T_180
            _eb.lokSteuern(46, Klassen.LokEigenschaften.Geschwindigkeit, 1)
        ElseIf _Prog46 = 182 Then
            _eb.lokSteuern(46, Klassen.LokEigenschaften.Geschwindigkeit, 0)

            ' Tunnelausfahrt

        ElseIf _Prog46 = 200 Then ' Kontakt 1.2 <- (bergauf)
            _eb.lokSteuern(46, Klassen.LokEigenschaften.Geschwindigkeit, G_200)
            Prog_Lok46.Interval = 2000
        ElseIf _Prog46 = 201 Then
        ElseIf _Prog46 = 202 Then
        ElseIf _Prog46 = 203 Then
        ElseIf _Prog46 = 204 Then
        ElseIf _Prog46 = 205 Then
            If Stufe4 < Stufe3 Then
                _eb.lokSteuern(46, Klassen.LokEigenschaften.Geschwindigkeit, Stufe3)
            Else
                _eb.lokSteuern(46, Klassen.LokEigenschaften.Geschwindigkeit, Stufe4)
            End If

        ElseIf _Prog46 = 220 Then ' Kontakt 3.1 -> (hinter dem Martinstor bergauf)
            Prog_Lok46.Interval = 2000
        ElseIf _Prog46 = 221 Then
        ElseIf _Prog46 = 222 Then

        ElseIf _Prog46 = 240 Then ' Kontakt 3.7 <- (hinter der Brücke bergauf)
            Prog_Lok46.Interval = 2000
        ElseIf _Prog46 = 241 Then
        ElseIf _Prog46 = 242 Then

        ElseIf _Prog46 = 260 Then ' Kontakt 3.3 (links bzw vor der Brücke)
            Prog_Lok46.Interval = 2000
        ElseIf _Prog46 = 261 Then
        ElseIf _Prog46 = 262 Then
            _eb.lokSteuern(46, Klassen.LokEigenschaften.Geschwindigkeit, Stufe3)

        ElseIf _Prog46 = 600 Then ' Kontakt 3.5 <- (unter der Burg)
            Prog_Lok46.Interval = 2000
        ElseIf _Prog46 = 601 Then
        ElseIf _Prog46 = 602 Then

        ElseIf _Prog46 = 620 Then ' Kontakt 3.7 -> (hinter der Brücke bergab)
            Prog_Lok46.Interval = 2000
        ElseIf _Prog46 = 621 Then
        ElseIf _Prog46 = 622 Then

        ElseIf _Prog46 = 640 Then ' Kontakt 3.1 <- Talfahrt
            Prog_Lok46.Interval = 2000
        ElseIf _Prog46 = 641 Then
        ElseIf _Prog46 = 642 Then

        ElseIf _Prog46 = 660 Then ' Kontakt 1.2 -> Talfahrt
            Prog_Lok46.Interval = 2000
        ElseIf _Prog46 = 661 Then
        ElseIf _Prog46 = 662 Then

        ElseIf _Prog46 = 700 Then ' Kontakt 0.4 <- Diagonale
            Prog_Lok46.Interval = 2000
        ElseIf _Prog46 = 701 Then
        ElseIf _Prog46 = 702 Then

            ' Zindelstein

        ElseIf _Prog46 = 500 Then
            Prog_Lok46.Interval = V_500
        ElseIf _Prog46 = 501 Then
            _eb.lokSteuern(46, Klassen.LokEigenschaften.Geschwindigkeit, Stufe23)
            Prog_Lok46.Interval = T_500
        ElseIf _Prog46 = 502 Then
            _eb.lokSteuern(46, Klassen.LokEigenschaften.Geschwindigkeit, Stufe22)
        ElseIf _Prog46 = 503 Then
            _eb.lokSteuern(46, Klassen.LokEigenschaften.Geschwindigkeit, Stufe21)
        ElseIf _Prog46 = 504 Then
            _eb.lokSteuern(46, Klassen.LokEigenschaften.Geschwindigkeit, Stufe2)
        ElseIf _Prog46 = 505 Then
            _eb.lokSteuern(46, Klassen.LokEigenschaften.Geschwindigkeit, 0)

        Else
            _Prog46 = 0
            Prog_Lok46.Stop()
            Prog_Lok46.Interval = 200
            If Betriebsart = 1 Then
                SetProgramCounterLabel1(String.Empty)
            Else
                SetProgramCounterLabel(String.Empty)
            End If
        End If
        _Prog46 = _Prog46 + 1
    End Sub
    Private Sub HandleTimerElapsed59(sender As System.Object, e As System.EventArgs) Handles Prog_Lok47.Elapsed

        '*** Fahrprogramm für Diesellok 220 007-9
        '*** Datum: 23.02.2020

        SetText(TextBox1, "Diesellok 220 007-9                                                     IBS: 04.02.2021 - V3 : 8")
        LoadImage(PictureBox1, "H:\\EB_Media\\LokFotos\\Baureihe_V200_02.jpg")
        GeschwindikeitenSetzen(47)

        Dim Stufe1, Stufe2, Stufe3, Stufe4 As Integer
        Dim Stufe11, Stufe12, Stufe13, Stufe14, Stufe21, Stufe22, Stufe23, Stufe24 As Integer
        Dim V_100, V_130, V_160, V_180, V_500 As Integer
        Dim T_100, T_130, T_160, T_180, T_500 As Integer
        Dim G_200 As Integer

        T_100 = _Betriebsparameter.Fahrparameter(47, KlausEBspecific.Betriebsparameter.FahrparameterEnum.T_100)
        T_130 = _Betriebsparameter.Fahrparameter(47, KlausEBspecific.Betriebsparameter.FahrparameterEnum.T_130)
        T_160 = _Betriebsparameter.Fahrparameter(47, KlausEBspecific.Betriebsparameter.FahrparameterEnum.T_160)
        T_180 = _Betriebsparameter.Fahrparameter(47, KlausEBspecific.Betriebsparameter.FahrparameterEnum.T_180)
        T_500 = _Betriebsparameter.Fahrparameter(47, KlausEBspecific.Betriebsparameter.FahrparameterEnum.T_500)
        V_100 = _Betriebsparameter.Fahrparameter(47, KlausEBspecific.Betriebsparameter.FahrparameterEnum.V_100)
        V_130 = _Betriebsparameter.Fahrparameter(47, KlausEBspecific.Betriebsparameter.FahrparameterEnum.V_130)
        V_160 = _Betriebsparameter.Fahrparameter(47, KlausEBspecific.Betriebsparameter.FahrparameterEnum.V_160)
        V_180 = _Betriebsparameter.Fahrparameter(47, KlausEBspecific.Betriebsparameter.FahrparameterEnum.V_180)
        V_500 = _Betriebsparameter.Fahrparameter(47, KlausEBspecific.Betriebsparameter.FahrparameterEnum.V_500)
        G_200 = _Betriebsparameter.Fahrparameter(47, KlausEBspecific.Betriebsparameter.FahrparameterEnum.G_200)

        If A_StopB = 1 Then
            V_100 = 8000
        End If

        Stufe1 = _LokStufen.Holen(47, 1)
        Stufe2 = _LokStufen.Holen(47, 2)
        Stufe3 = _LokStufen.Holen(47, 3)
        Stufe4 = _LokStufen.Holen(47, 4)

        If Stufe2 = 1 Then
            T_100 = T_100
            T_130 = T_130
            T_160 = T_160
            V_180 = V_180
        ElseIf Stufe2 = 2 Then
            T_100 = T_100 + 300
            T_130 = T_130 + 300
            T_160 = T_160 + 300
            V_180 = V_180 + 500
        ElseIf Stufe2 = 3 Then
            T_100 = T_100 + 500
            T_130 = T_130 + 500
            T_160 = T_160 + 500
            V_180 = V_180 + 1000
        ElseIf Stufe2 = 4 Then
            T_100 = T_100 + 700
            T_130 = T_130 + 700
            T_160 = T_160 + 700
            V_180 = V_180 + 1500
        ElseIf Stufe2 = 5 Then
            T_100 = T_100 + 900
            T_130 = T_130 + 900
            T_160 = T_160 + 900
            V_180 = V_180 + 2000
        ElseIf Stufe2 = 6 Then
            T_100 = T_100 + 1200
            T_130 = T_130 + 1200
            T_160 = T_160 + 1200
            V_180 = V_180 + 2500
        Else
            T_100 = T_100 + 1200
            T_130 = T_130 + 1200
            T_160 = T_160 + 1200
            V_180 = V_180 + 2500
        End If

        Stufe2 = Stufe1

        Stufe11 = Stufe1 + 2
        If Stufe11 > Stufe3 Then
            Stufe11 = Stufe3
        End If
        Stufe12 = Stufe1 + 4
        If Stufe12 > Stufe3 Then
            Stufe12 = Stufe3
        End If
        Stufe13 = Stufe1 + 6
        If Stufe13 > Stufe3 Then
            Stufe13 = Stufe3
        End If
        Stufe14 = Stufe1 + 8
        If Stufe14 > Stufe3 Then
            Stufe14 = Stufe3
        End If

        Stufe21 = Stufe2 + 2
        If Stufe21 > Stufe3 Then
            Stufe21 = Stufe3
        End If
        Stufe22 = Stufe2 + 4
        If Stufe22 > Stufe3 Then
            Stufe22 = Stufe3
        End If
        Stufe23 = Stufe2 + 6
        If Stufe23 > Stufe3 Then
            Stufe23 = Stufe3
        End If
        Stufe24 = Stufe1 + 8
        If Stufe24 > Stufe3 Then
            Stufe24 = Stufe3
        End If
        If G_200 > 0 Then
            If G_200 < Stufe4 Then
                G_200 = Stufe4
            End If
        Else
            G_200 = Stufe4
        End If

        If Betriebsart = 7 And (_GlsL47 = 3 Or _GlsL47 = 4) Then
            SetProgramCounterLabel1(_Prog47)
        Else
            SetProgramCounterLabel(_Prog47)
        End If

        ' Lok starten - Bahnhofsausfahrt

        If _Prog47 = 0 Then
            Prog_Lok47.Interval = 2000
        ElseIf _Prog47 = 1 Then
            If _Fahrzeugbeleuchtung2 > 0 Then
                _eb.lokSteuern(47, Klassen.LokEigenschaften.Hauptfunktion, 1) ' Licht ein
            End If
        ElseIf _Prog47 = 2 Then
        ElseIf _Prog47 = 3 Then
            _Betriebsparameter.RundenErhoehen(47)
        ElseIf _Prog47 = 4 Then
        ElseIf _Prog47 = 5 Then
        ElseIf _Prog47 = 6 Then

            ' Bahnhofsausfahrt

        ElseIf _Prog47 = 7 Then
            _eb.lokSteuern(47, Klassen.LokEigenschaften.Geschwindigkeit, Stufe1)
        ElseIf _Prog47 = 8 Then
            _eb.lokSteuern(47, Klassen.LokEigenschaften.Geschwindigkeit, Stufe11)
        ElseIf _Prog47 = 9 Then
            _eb.lokSteuern(47, Klassen.LokEigenschaften.Geschwindigkeit, Stufe12)
        ElseIf _Prog47 = 10 Then
            _eb.lokSteuern(47, Klassen.LokEigenschaften.Geschwindigkeit, Stufe13)
        ElseIf _Prog47 = 11 Then
            _eb.lokSteuern(47, Klassen.LokEigenschaften.Geschwindigkeit, Stufe14)
        ElseIf _Prog47 = 12 Then
            _eb.lokSteuern(47, Klassen.LokEigenschaften.Geschwindigkeit, Stufe3)

            ' Lok abstellen

        ElseIf _Prog47 = 50 Then
            Prog_Lok47.Interval = 2000
        ElseIf _Prog47 = 51 Then
        ElseIf _Prog47 = 52 Then
            If _Fahrzeugbeleuchtung2 < 2 Then
                _eb.lokSteuern(47, Klassen.LokEigenschaften.Hauptfunktion, 0) ' Licht aus
            End If

            ' Lok bremsen (Bahnhofseinfahrt Normalzug von links und von rechts)

        ElseIf _Prog47 = 100 Then
            Prog_Lok47.Interval = V_100
        ElseIf _Prog47 = 101 Then
            _eb.lokSteuern(47, Klassen.LokEigenschaften.Geschwindigkeit, Stufe24)
            Prog_Lok47.Interval = T_100
        ElseIf _Prog47 = 102 Then
            _eb.lokSteuern(47, Klassen.LokEigenschaften.Geschwindigkeit, Stufe23)
        ElseIf _Prog47 = 103 Then
            _eb.lokSteuern(47, Klassen.LokEigenschaften.Geschwindigkeit, Stufe22)
        ElseIf _Prog47 = 104 Then
            _eb.lokSteuern(47, Klassen.LokEigenschaften.Geschwindigkeit, Stufe21)
        ElseIf _Prog47 = 105 Then
            _eb.lokSteuern(47, Klassen.LokEigenschaften.Geschwindigkeit, Stufe2)

            ' Lok bremsen (Bahnhofseinfahrt Kurzzug von links)

        ElseIf _Prog47 = 130 Then
            Prog_Lok47.Interval = V_130
        ElseIf _Prog47 = 131 Then
            _eb.lokSteuern(47, Klassen.LokEigenschaften.Geschwindigkeit, Stufe24)
            Prog_Lok47.Interval = T_130
        ElseIf _Prog47 = 132 Then
            _eb.lokSteuern(47, Klassen.LokEigenschaften.Geschwindigkeit, Stufe23)
        ElseIf _Prog47 = 133 Then
            _eb.lokSteuern(47, Klassen.LokEigenschaften.Geschwindigkeit, Stufe22)
        ElseIf _Prog47 = 134 Then
            _eb.lokSteuern(47, Klassen.LokEigenschaften.Geschwindigkeit, Stufe21)
        ElseIf _Prog47 = 135 Then
            _eb.lokSteuern(47, Klassen.LokEigenschaften.Geschwindigkeit, Stufe2)
        ElseIf _Prog47 = 136 Then
            _eb.lokSteuern(47, Klassen.LokEigenschaften.Geschwindigkeit, 0)
        ElseIf _Prog47 = 137 Then
            Prog_Lok47.Interval = 2000
        ElseIf _Prog47 = 138 Then
            If _Fahrzeugbeleuchtung2 < 2 Then
                _eb.lokSteuern(47, Klassen.LokEigenschaften.Hauptfunktion, 0) ' Licht aus
            End If

            ' Lok bremsen (Bahnhofseinfahrt Kurzzug von rechts)

        ElseIf _Prog47 = 160 Then
            Prog_Lok47.Interval = V_160
        ElseIf _Prog47 = 161 Then
            _eb.lokSteuern(47, Klassen.LokEigenschaften.Geschwindigkeit, Stufe24)
            Prog_Lok47.Interval = T_160
        ElseIf _Prog47 = 162 Then
            _eb.lokSteuern(47, Klassen.LokEigenschaften.Geschwindigkeit, Stufe23)
        ElseIf _Prog47 = 163 Then
            _eb.lokSteuern(47, Klassen.LokEigenschaften.Geschwindigkeit, Stufe22)
        ElseIf _Prog47 = 164 Then
            _eb.lokSteuern(47, Klassen.LokEigenschaften.Geschwindigkeit, Stufe21)
        ElseIf _Prog47 = 165 Then
            _eb.lokSteuern(47, Klassen.LokEigenschaften.Geschwindigkeit, Stufe2)
        ElseIf _Prog47 = 166 Then
            _eb.lokSteuern(47, Klassen.LokEigenschaften.Geschwindigkeit, 0)
        ElseIf _Prog47 = 167 Then
            Prog_Lok47.Interval = 2000
        ElseIf _Prog47 = 168 Then
            If _Fahrzeugbeleuchtung2 < 2 Then
                _eb.lokSteuern(47, Klassen.LokEigenschaften.Hauptfunktion, 0) ' Licht aus
            End If

            ' Rangierzug

        ElseIf _Prog47 = 180 Then
            _eb.lokSteuern(47, Klassen.LokEigenschaften.Geschwindigkeit, 2)
            Prog_Lok47.Interval = V_180
        ElseIf _Prog47 = 181 Then
            Prog_Lok47.Interval = T_180
            _eb.lokSteuern(47, Klassen.LokEigenschaften.Geschwindigkeit, 1)
        ElseIf _Prog47 = 182 Then
            _eb.lokSteuern(47, Klassen.LokEigenschaften.Geschwindigkeit, 0)

            ' Tunnelausfahrt

        ElseIf _Prog47 = 200 Then ' Kontakt 1.2 <- (bergauf)
            _eb.lokSteuern(47, Klassen.LokEigenschaften.Geschwindigkeit, G_200)
            Prog_Lok47.Interval = 2000
        ElseIf _Prog47 = 201 Then
        ElseIf _Prog47 = 202 Then
        ElseIf _Prog47 = 203 Then
        ElseIf _Prog47 = 204 Then
        ElseIf _Prog47 = 205 Then
            If Stufe4 < Stufe3 Then
                _eb.lokSteuern(47, Klassen.LokEigenschaften.Geschwindigkeit, Stufe3)
            Else
                _eb.lokSteuern(47, Klassen.LokEigenschaften.Geschwindigkeit, Stufe4)
            End If

        ElseIf _Prog47 = 220 Then ' Kontakt 3.1 -> (hinter dem Martinstor bergauf)
            Prog_Lok47.Interval = 2000
        ElseIf _Prog47 = 221 Then
        ElseIf _Prog47 = 222 Then

        ElseIf _Prog47 = 240 Then ' Kontakt 3.7 <- (hinter der Brücke bergauf)
            Prog_Lok47.Interval = 2000
        ElseIf _Prog47 = 241 Then
        ElseIf _Prog47 = 242 Then

        ElseIf _Prog47 = 260 Then ' Kontakt 3.3 (links bzw vor der Brücke)
            Prog_Lok47.Interval = 2000
        ElseIf _Prog47 = 261 Then
        ElseIf _Prog47 = 262 Then
            _eb.lokSteuern(47, Klassen.LokEigenschaften.Geschwindigkeit, Stufe3)

        ElseIf _Prog47 = 600 Then ' Kontakt 3.5 <- (unter der Burg)
            Prog_Lok47.Interval = 2000
        ElseIf _Prog47 = 601 Then
        ElseIf _Prog47 = 602 Then

        ElseIf _Prog47 = 620 Then ' Kontakt 3.7 -> (hinter der Brücke bergab)
            Prog_Lok47.Interval = 2000
        ElseIf _Prog47 = 621 Then
        ElseIf _Prog47 = 622 Then

        ElseIf _Prog47 = 640 Then ' Kontakt 3.1 <- Talfahrt
            Prog_Lok47.Interval = 2000
        ElseIf _Prog47 = 641 Then
        ElseIf _Prog47 = 642 Then

        ElseIf _Prog47 = 660 Then ' Kontakt 1.2 -> Talfahrt
            Prog_Lok47.Interval = 2000
        ElseIf _Prog47 = 661 Then
        ElseIf _Prog47 = 662 Then

        ElseIf _Prog47 = 700 Then ' Kontakt 0.4 <- Diagonale
            Prog_Lok47.Interval = 2000
        ElseIf _Prog47 = 701 Then
        ElseIf _Prog47 = 702 Then

            ' Zindelstein

        ElseIf _Prog47 = 500 Then
            Prog_Lok47.Interval = V_500
        ElseIf _Prog47 = 501 Then
            _eb.lokSteuern(47, Klassen.LokEigenschaften.Geschwindigkeit, Stufe24)
            Prog_Lok47.Interval = T_500
        ElseIf _Prog47 = 502 Then
            _eb.lokSteuern(47, Klassen.LokEigenschaften.Geschwindigkeit, Stufe23)
        ElseIf _Prog47 = 503 Then
            _eb.lokSteuern(47, Klassen.LokEigenschaften.Geschwindigkeit, Stufe22)
        ElseIf _Prog47 = 504 Then
            _eb.lokSteuern(47, Klassen.LokEigenschaften.Geschwindigkeit, Stufe21)
        ElseIf _Prog47 = 505 Then
            _eb.lokSteuern(47, Klassen.LokEigenschaften.Geschwindigkeit, Stufe2)
        ElseIf _Prog47 = 506 Then
            _eb.lokSteuern(47, Klassen.LokEigenschaften.Geschwindigkeit, 0)

        Else
            _Prog47 = 0
            Prog_Lok47.Stop()
            Prog_Lok47.Interval = 200
            If Betriebsart = 1 Then
                SetProgramCounterLabel1(String.Empty)
            Else
                SetProgramCounterLabel(String.Empty)
            End If
        End If
        _Prog47 = _Prog47 + 1
    End Sub
    Private Sub HandleTimerElapsed60(sender As System.Object, e As System.EventArgs) Handles Prog_Lok48.Elapsed

        '*** Fahrprogramm für Diesel-Lok F7
        '*** Datum: 23.02.2020

        SetText(TextBox1, "Diesel-Lok F7                                                           IBS: 15.05.2021 - V3 : 7")
        LoadImage(PictureBox1, "H:\\EB_Media\\LokFotos\\Baureihe_F7_01.jpg")
        GeschwindikeitenSetzen(48)

        Dim Stufe1, Stufe2, Stufe3, Stufe4 As Integer
        Dim Stufe11, Stufe12, Stufe13, Stufe14, Stufe21, Stufe22, Stufe23, Stufe24 As Integer
        Dim V_100, V_130, V_160, V_180, V_500 As Integer
        Dim T_100, T_130, T_160, T_180, T_500 As Integer
        Dim G_200 As Integer

        T_100 = _Betriebsparameter.Fahrparameter(48, KlausEBspecific.Betriebsparameter.FahrparameterEnum.T_100)
        T_130 = _Betriebsparameter.Fahrparameter(48, KlausEBspecific.Betriebsparameter.FahrparameterEnum.T_130)
        T_160 = _Betriebsparameter.Fahrparameter(48, KlausEBspecific.Betriebsparameter.FahrparameterEnum.T_160)
        T_180 = _Betriebsparameter.Fahrparameter(48, KlausEBspecific.Betriebsparameter.FahrparameterEnum.T_180)
        T_500 = _Betriebsparameter.Fahrparameter(48, KlausEBspecific.Betriebsparameter.FahrparameterEnum.T_500)
        V_100 = _Betriebsparameter.Fahrparameter(48, KlausEBspecific.Betriebsparameter.FahrparameterEnum.V_100)
        V_130 = _Betriebsparameter.Fahrparameter(48, KlausEBspecific.Betriebsparameter.FahrparameterEnum.V_130)
        V_160 = _Betriebsparameter.Fahrparameter(48, KlausEBspecific.Betriebsparameter.FahrparameterEnum.V_160)
        V_180 = _Betriebsparameter.Fahrparameter(48, KlausEBspecific.Betriebsparameter.FahrparameterEnum.V_180)
        V_500 = _Betriebsparameter.Fahrparameter(48, KlausEBspecific.Betriebsparameter.FahrparameterEnum.V_500)
        G_200 = _Betriebsparameter.Fahrparameter(48, KlausEBspecific.Betriebsparameter.FahrparameterEnum.G_200)

        If A_StopB = 1 Then
            V_100 = 8000
        End If

        Stufe1 = _LokStufen.Holen(48, 1)
        Stufe2 = _LokStufen.Holen(48, 2)
        Stufe3 = _LokStufen.Holen(48, 3)
        Stufe4 = _LokStufen.Holen(48, 4)

        If Stufe2 = 1 Then
            T_100 = T_100
            T_130 = T_130
            T_160 = T_160
            V_180 = V_180
        ElseIf Stufe2 = 2 Then
            T_100 = T_100 + 300
            T_130 = T_130 + 300
            T_160 = T_160 + 300
            V_180 = V_180 + 500
        ElseIf Stufe2 = 3 Then
            T_100 = T_100 + 500
            T_130 = T_130 + 500
            T_160 = T_160 + 500
            V_180 = V_180 + 1000
        ElseIf Stufe2 = 4 Then
            T_100 = T_100 + 700
            T_130 = T_130 + 700
            T_160 = T_160 + 700
            V_180 = V_180 + 1500
        ElseIf Stufe2 = 5 Then
            T_100 = T_100 + 900
            T_130 = T_130 + 900
            T_160 = T_160 + 900
            V_180 = V_180 + 2000
        ElseIf Stufe2 = 6 Then
            T_100 = T_100 + 1200
            T_130 = T_130 + 1200
            T_160 = T_160 + 1200
            V_180 = V_180 + 2500
        Else
            T_100 = T_100 + 1200
            T_130 = T_130 + 1200
            T_160 = T_160 + 1200
            V_180 = V_180 + 2500
        End If

        Stufe2 = Stufe1

        Stufe11 = Stufe1 + 1
        If Stufe11 > Stufe3 Then
            Stufe11 = Stufe3
        End If
        Stufe12 = Stufe1 + 2
        If Stufe12 > Stufe3 Then
            Stufe12 = Stufe3
        End If
        Stufe13 = Stufe1 + 3
        If Stufe13 > Stufe3 Then
            Stufe13 = Stufe3
        End If
        Stufe14 = Stufe1 + 4
        If Stufe14 > Stufe3 Then
            Stufe14 = Stufe3
        End If

        Stufe21 = Stufe2 + 1
        If Stufe21 > Stufe3 Then
            Stufe21 = Stufe3
        End If
        Stufe22 = Stufe2 + 2
        If Stufe22 > Stufe3 Then
            Stufe22 = Stufe3
        End If
        Stufe23 = Stufe2 + 3
        If Stufe23 > Stufe3 Then
            Stufe23 = Stufe3
        End If
        Stufe24 = Stufe2 + 4
        If Stufe24 > Stufe3 Then
            Stufe24 = Stufe3
        End If
        If G_200 > 0 Then
            If G_200 < Stufe4 Then
                G_200 = Stufe4
            End If
        Else
            G_200 = Stufe4
        End If

        If Betriebsart = 1 And (_GlsL48 = 3 Or _GlsL48 = 4) Then
            SetProgramCounterLabel1(_Prog48)
        Else
            SetProgramCounterLabel(_Prog48)
        End If

        ' Lok starten - Bahnhofsausfahrt

        If _Prog48 = 0 Then
            Prog_Lok48.Interval = 2000
            If _Fahrzeugbeleuchtung2 > 0 Then
                _eb.lokSteuern(48, Klassen.LokEigenschaften.Hauptfunktion, 1) ' Licht ein
            End If
        ElseIf _Prog48 = 1 Then
            If _Motor > 0 Then
                _eb.lokSteuern(48, Klassen.LokEigenschaften.Funktion1, 1) ' Motor ein
            End If
        ElseIf _Prog48 = 2 Then
            _Betriebsparameter.RundenErhoehen(48)
        ElseIf _Prog48 = 3 Then
        ElseIf _Prog48 = 4 Then
        ElseIf _Prog48 = 5 Then
        ElseIf _Prog48 = 6 Then
        ElseIf _Prog48 = 7 Then
        ElseIf _Prog48 = 8 Then
        ElseIf _Prog48 = 9 Then

            ' Bahnhofsausfahrt

        ElseIf _Prog48 = 10 Then
            If _AkustischeSignale > 0 Then
                _eb.lokSteuern(48, Klassen.LokEigenschaften.Funktion3, 1) ' Hupen ein
            End If
        ElseIf _Prog48 = 11 Then
        ElseIf _Prog48 = 12 Then
            _eb.lokSteuern(48, Klassen.LokEigenschaften.Funktion3, 0) ' Hupen aus
        ElseIf _Prog48 = 13 Then
        ElseIf _Prog48 = 14 Then
            _eb.lokSteuern(48, Klassen.LokEigenschaften.Geschwindigkeit, Stufe1)
        ElseIf _Prog48 = 15 Then
            _eb.lokSteuern(48, Klassen.LokEigenschaften.Geschwindigkeit, Stufe11)
        ElseIf _Prog48 = 16 Then
            _eb.lokSteuern(48, Klassen.LokEigenschaften.Geschwindigkeit, Stufe12)
        ElseIf _Prog48 = 17 Then
            _eb.lokSteuern(48, Klassen.LokEigenschaften.Geschwindigkeit, Stufe13)
        ElseIf _Prog48 = 18 Then
            _eb.lokSteuern(48, Klassen.LokEigenschaften.Geschwindigkeit, Stufe14)
        ElseIf _Prog48 = 19 Then
            _eb.lokSteuern(48, Klassen.LokEigenschaften.Geschwindigkeit, Stufe3)

            ' Bahnhofseinfahrt

        ElseIf _Prog48 = 50 Then
            _eb.lokSteuern(48, Klassen.LokEigenschaften.Funktion4, 1) ' AnfahrBremsbeschleunigung ein
            If _Motor = 0 Or _Motor = 2 Then
                _eb.lokSteuern(48, Klassen.LokEigenschaften.Funktion1, 0) ' Motor aus
            End If

            ' Lok abstellen

        ElseIf _Prog48 = 51 Then
            Prog_Lok48.Interval = 2000
        ElseIf _Prog48 = 52 Then
            If _Motor < 3 Then
                _eb.lokSteuern(48, Klassen.LokEigenschaften.Funktion1, 0) ' Motor aus
            End If
        ElseIf _Prog48 = 53 Then
        ElseIf _Prog48 = 54 Then
            _eb.lokSteuern(48, Klassen.LokEigenschaften.Funktion4, 0) ' AnfahrBremsbeschleunigung aus
            If _Fahrzeugbeleuchtung2 = 2 Then
                _eb.lokSteuern(48, Klassen.LokEigenschaften.Hauptfunktion, 0) ' Licht aus
            End If

            ' Lok bremsen (Bahnhofseinfahrt Normalzug von links und von rechts)

        ElseIf _Prog48 = 100 Then
            Prog_Lok48.Interval = V_100
        ElseIf _Prog48 = 101 Then
            _eb.lokSteuern(48, Klassen.LokEigenschaften.Geschwindigkeit, Stufe24)
            Prog_Lok48.Interval = T_100
        ElseIf _Prog48 = 102 Then
            _eb.lokSteuern(48, Klassen.LokEigenschaften.Geschwindigkeit, Stufe23)
        ElseIf _Prog48 = 103 Then
            _eb.lokSteuern(48, Klassen.LokEigenschaften.Geschwindigkeit, Stufe22)
        ElseIf _Prog48 = 104 Then
            _eb.lokSteuern(48, Klassen.LokEigenschaften.Geschwindigkeit, Stufe21)
        ElseIf _Prog48 = 105 Then
            _eb.lokSteuern(48, Klassen.LokEigenschaften.Geschwindigkeit, Stufe2)

            ' Lok bremsen (Bahnhofseinfahrt Kurzzug von links)

        ElseIf _Prog48 = 130 Then
            Prog_Lok48.Interval = V_130
        ElseIf _Prog48 = 131 Then
            _eb.lokSteuern(48, Klassen.LokEigenschaften.Geschwindigkeit, Stufe24)
            Prog_Lok48.Interval = T_130
        ElseIf _Prog48 = 132 Then
            _eb.lokSteuern(48, Klassen.LokEigenschaften.Geschwindigkeit, Stufe23)
        ElseIf _Prog48 = 133 Then
            _eb.lokSteuern(48, Klassen.LokEigenschaften.Geschwindigkeit, Stufe22)
        ElseIf _Prog48 = 134 Then
            _eb.lokSteuern(48, Klassen.LokEigenschaften.Geschwindigkeit, Stufe21)
        ElseIf _Prog48 = 135 Then
            _eb.lokSteuern(48, Klassen.LokEigenschaften.Geschwindigkeit, Stufe2)
        ElseIf _Prog48 = 136 Then
            _eb.lokSteuern(48, Klassen.LokEigenschaften.Geschwindigkeit, 0)
        ElseIf _Prog48 = 137 Then
            Prog_Lok48.Interval = 2000
        ElseIf _Prog48 = 138 Then
            If _Motor < 3 Then
                _eb.lokSteuern(48, Klassen.LokEigenschaften.Funktion3, 0) ' Motor aus
            End If
        ElseIf _Prog48 = 139 Then
        ElseIf _Prog48 = 140 Then
            If _Fahrzeugbeleuchtung2 < 2 Then
                _eb.lokSteuern(48, Klassen.LokEigenschaften.Hauptfunktion, 0) ' Licht aus
            End If

            ' Lok bremsen (Bahnhofseinfahrt Kurzzug von rechts)

        ElseIf _Prog48 = 160 Then
            Prog_Lok48.Interval = V_160
        ElseIf _Prog48 = 161 Then
            _eb.lokSteuern(48, Klassen.LokEigenschaften.Geschwindigkeit, Stufe24)
            Prog_Lok48.Interval = T_160
        ElseIf _Prog48 = 162 Then
            _eb.lokSteuern(48, Klassen.LokEigenschaften.Geschwindigkeit, Stufe23)
        ElseIf _Prog48 = 163 Then
            _eb.lokSteuern(48, Klassen.LokEigenschaften.Geschwindigkeit, Stufe22)
        ElseIf _Prog48 = 164 Then
            _eb.lokSteuern(48, Klassen.LokEigenschaften.Geschwindigkeit, Stufe21)
        ElseIf _Prog48 = 165 Then
            _eb.lokSteuern(48, Klassen.LokEigenschaften.Geschwindigkeit, Stufe2)
        ElseIf _Prog48 = 166 Then
            _eb.lokSteuern(48, Klassen.LokEigenschaften.Geschwindigkeit, 0)
        ElseIf _Prog48 = 167 Then
            Prog_Lok48.Interval = 2000
        ElseIf _Prog48 = 168 Then
            If _Motor < 3 Then
                _eb.lokSteuern(48, Klassen.LokEigenschaften.Funktion3, 0) ' Motor aus
            End If
        ElseIf _Prog48 = 169 Then
        ElseIf _Prog48 = 170 Then
            If _Fahrzeugbeleuchtung2 < 2 Then
                _eb.lokSteuern(48, Klassen.LokEigenschaften.Hauptfunktion, 0) ' Licht aus
            End If

            ' Rangierzug

        ElseIf _Prog48 = 180 Then
            _eb.lokSteuern(48, Klassen.LokEigenschaften.Geschwindigkeit, 2)
            Prog_Lok48.Interval = V_180
        ElseIf _Prog48 = 181 Then
            Prog_Lok48.Interval = T_180
            _eb.lokSteuern(48, Klassen.LokEigenschaften.Geschwindigkeit, 1)
        ElseIf _Prog48 = 182 Then
            _eb.lokSteuern(48, Klassen.LokEigenschaften.Geschwindigkeit, 0)

            ' Tunnelausfahrt

        ElseIf _Prog48 = 200 Then ' Kontakt 1.2 <- (bergauf)
            _eb.lokSteuern(48, Klassen.LokEigenschaften.Geschwindigkeit, G_200)
            Prog_Lok48.Interval = 2000
        ElseIf _Prog48 = 201 Then
        ElseIf _Prog48 = 202 Then
        ElseIf _Prog48 = 203 Then
        ElseIf _Prog48 = 204 Then
        ElseIf _Prog48 = 205 Then
            If Stufe4 < Stufe3 Then
                _eb.lokSteuern(48, Klassen.LokEigenschaften.Geschwindigkeit, Stufe3)
            Else
                _eb.lokSteuern(48, Klassen.LokEigenschaften.Geschwindigkeit, Stufe4)
            End If
        ElseIf _Prog48 = 206 Then
        ElseIf _Prog48 = 207 Then
            If _Motor > 1 Then
                _eb.lokSteuern(48, Klassen.LokEigenschaften.Funktion2, 1) ' Motor ein
            End If
        ElseIf _Prog48 = 208 Then
            Prog_Lok48.Interval = 2000
        ElseIf _Prog48 = 209 Then
            If _AkustischeSignale > 1 Then
                _eb.lokSteuern(48, Klassen.LokEigenschaften.Funktion3, 1) ' Hupe ein
            End If
        ElseIf _Prog48 = 210 Then
            _eb.lokSteuern(48, Klassen.LokEigenschaften.Funktion3, 0) ' Hupe aus

        ElseIf _Prog48 = 220 Then ' Kontakt 3.1 -> (hinter dem Martinstor bergauf)
            Prog_Lok48.Interval = 2000
        ElseIf _Prog48 = 221 Then
        ElseIf _Prog48 = 222 Then
        ElseIf _Prog48 = 223 Then
            If _Motor < 3 Then
                _eb.lokSteuern(48, Klassen.LokEigenschaften.Funktion2, 1) ' Motor aus
            End If

        ElseIf _Prog48 = 240 Then ' Kontakt 3.7 <- (hinter der Brücke bergauf)
            Prog_Lok48.Interval = 2000
        ElseIf _Prog48 = 241 Then
        ElseIf _Prog48 = 242 Then
            Prog_Lok48.Interval = 1000
        ElseIf _Prog48 = 243 Then
            If _Motor > 1 Then
                _eb.lokSteuern(48, Klassen.LokEigenschaften.Funktion2, 1) ' Motor ein
            End If
        ElseIf _Prog48 = 244 Then
            If _AkustischeSignale > 1 Then
                _eb.lokSteuern(48, Klassen.LokEigenschaften.Funktion3, 1) ' Pfiff ein
            End If
        ElseIf _Prog48 = 245 Then
            _eb.lokSteuern(48, Klassen.LokEigenschaften.Funktion3, 0) ' Pfiff aus
        ElseIf _Prog48 = 246 Then
        ElseIf _Prog48 = 247 Then
        ElseIf _Prog48 = 248 Then
            If _Motor < 3 Then
                _eb.lokSteuern(48, Klassen.LokEigenschaften.Funktion2, 0) ' Motor aus
            End If

        ElseIf _Prog48 = 260 Then ' Kontakt 3.3 (links bzw vor der Brücke)
            Prog_Lok48.Interval = 2000
        ElseIf _Prog48 = 261 Then
        ElseIf _Prog48 = 262 Then
            _eb.lokSteuern(48, Klassen.LokEigenschaften.Geschwindigkeit, Stufe3)

        ElseIf _Prog48 = 600 Then ' Kontakt 3.5 <- (unter der Burg)
            Prog_Lok48.Interval = 2000
        ElseIf _Prog48 = 601 Then
        ElseIf _Prog48 = 602 Then
            'If _AkustischeSignale > 1 Then
            '    _eb.lokSteuern(48, Klassen.LokEigenschaften.Funktion3, 1) ' Hupe ein
            'End If
        ElseIf _Prog48 = 603 Then
            '_eb.lokSteuern(48, Klassen.LokEigenschaften.Funktion3, 0) ' Hupe aus
        ElseIf _Prog48 = 604 Then

        ElseIf _Prog48 = 620 Then ' Kontakt 3.7 -> (hinter der Brücke bergab)
            Prog_Lok48.Interval = 2000
        ElseIf _Prog48 = 621 Then
        ElseIf _Prog48 = 622 Then
            If _Motor > 1 Then
                _eb.lokSteuern(48, Klassen.LokEigenschaften.Funktion2, 1) ' Motor ein
            End If
        ElseIf _Prog48 = 623 Then
        ElseIf _Prog48 = 624 Then
            If _AkustischeSignale > 1 Then
                _eb.lokSteuern(48, Klassen.LokEigenschaften.Funktion3, 1) ' Hupe ein
            End If
        ElseIf _Prog48 = 625 Then
            _eb.lokSteuern(48, Klassen.LokEigenschaften.Funktion3, 0) ' Hupe aus

        ElseIf _Prog48 = 640 Then ' Kontakt 3.1 <- Talfahrt
            Prog_Lok48.Interval = 5000
        ElseIf _Prog48 = 641 Then
        ElseIf _Prog48 = 642 Then
        ElseIf _Prog48 = 643 Then
        ElseIf _Prog48 = 644 Then
            If _Motor < 3 Then
                _eb.lokSteuern(48, Klassen.LokEigenschaften.Funktion2, 0) ' Motor aus
            End If

        ElseIf _Prog48 = 660 Then ' Kontakt 1.2 -> Talfahrt
            Prog_Lok48.Interval = 2000
        ElseIf _Prog48 = 661 Then
        ElseIf _Prog48 = 662 Then
        ElseIf _Prog48 = 663 Then
        ElseIf _Prog48 = 664 Then
        ElseIf _Prog48 = 665 Then
            If _GlsL48 = 1 Or _GlsL48 = 2 Then
                If _Motor > 0 Then
                    _eb.lokSteuern(48, Klassen.LokEigenschaften.Funktion2, 1) ' Motor ein
                End If
            End If
        ElseIf _Prog48 = 666 Then
        ElseIf _Prog48 = 667 Then
        ElseIf _Prog48 = 668 Then
        ElseIf _Prog48 = 669 Then
        ElseIf _Prog48 = 670 Then
            If _GlsL48 = 1 Or _GlsL48 = 2 Then
                If _AkustischeSignale > 0 Then
                    _eb.lokSteuern(48, Klassen.LokEigenschaften.Funktion3, 1) ' Hupe ein
                End If
            End If
        ElseIf _Prog48 = 671 Then
            _eb.lokSteuern(48, Klassen.LokEigenschaften.Funktion3, 0) ' Hupe aus

        ElseIf _Prog48 = 700 Then ' Kontakt 0.4 <- Diagonale
            Prog_Lok48.Interval = 2000
        ElseIf _Prog48 = 701 Then
        ElseIf _Prog48 = 702 Then
        ElseIf _Prog48 = 703 Then
        ElseIf _Prog48 = 704 Then
            If _Motor > 0 Then
                _eb.lokSteuern(48, Klassen.LokEigenschaften.Funktion2, 1) ' Motor ein
            End If
        ElseIf _Prog48 = 705 Then
            If _AkustischeSignale > 0 Then
                _eb.lokSteuern(48, Klassen.LokEigenschaften.Funktion3, 1) ' Hupe ein
            End If
        ElseIf _Prog48 = 706 Then
            _eb.lokSteuern(48, Klassen.LokEigenschaften.Funktion3, 0) ' Hupe aus

            ' Zindelstein

        ElseIf _Prog48 = 500 Then
            Prog_Lok48.Interval = V_500
        ElseIf _Prog48 = 501 Then
            _eb.lokSteuern(48, Klassen.LokEigenschaften.Geschwindigkeit, Stufe23)
            Prog_Lok48.Interval = T_500
        ElseIf _Prog48 = 502 Then
            _eb.lokSteuern(48, Klassen.LokEigenschaften.Geschwindigkeit, Stufe22)
        ElseIf _Prog48 = 503 Then
            _eb.lokSteuern(48, Klassen.LokEigenschaften.Geschwindigkeit, Stufe21)
        ElseIf _Prog48 = 504 Then
            _eb.lokSteuern(48, Klassen.LokEigenschaften.Geschwindigkeit, Stufe2)
        ElseIf _Prog48 = 505 Then
            _eb.lokSteuern(48, Klassen.LokEigenschaften.Geschwindigkeit, 0)


        Else
            _Prog48 = 0
            Prog_Lok48.Stop()
            Prog_Lok48.Interval = 200
            If Betriebsart = 1 Then
                SetProgramCounterLabel1(String.Empty)
            Else
                SetProgramCounterLabel(String.Empty)
            End If
        End If
        _Prog48 = _Prog48 + 1
    End Sub
    Private Sub HandleTimerElapsed61(sender As System.Object, e As System.EventArgs) Handles Prog_Lok49.Elapsed

        '*** Fahrprogramm für Diesel-Lok 212 276-0
        '*** Datum: 20.12.2020

        SetText(TextBox1, "Diesel-Lok 212 276-0                                                    IBS: 10.09.2025 - V3 : 9")
        LoadImage(PictureBox1, "H:\\EB_Media\\LokFotos\\Baureihe_212_01.jpg")
        GeschwindikeitenSetzen(49)

        Dim Stufe1, Stufe2, Stufe3, Stufe4 As Integer
        Dim Stufe11, Stufe12, Stufe13, Stufe14, Stufe21, Stufe22, Stufe23, Stufe24 As Integer
        Dim V_100, V_130, V_160, V_180, V_500 As Integer
        Dim T_100, T_130, T_160, T_180, T_500 As Integer
        Dim G_200 As Integer

        T_100 = _Betriebsparameter.Fahrparameter(49, KlausEBspecific.Betriebsparameter.FahrparameterEnum.T_100)
        T_130 = _Betriebsparameter.Fahrparameter(49, KlausEBspecific.Betriebsparameter.FahrparameterEnum.T_130)
        T_160 = _Betriebsparameter.Fahrparameter(49, KlausEBspecific.Betriebsparameter.FahrparameterEnum.T_160)
        T_180 = _Betriebsparameter.Fahrparameter(49, KlausEBspecific.Betriebsparameter.FahrparameterEnum.T_180)
        T_500 = _Betriebsparameter.Fahrparameter(49, KlausEBspecific.Betriebsparameter.FahrparameterEnum.T_500)
        V_100 = _Betriebsparameter.Fahrparameter(49, KlausEBspecific.Betriebsparameter.FahrparameterEnum.V_100)
        V_130 = _Betriebsparameter.Fahrparameter(49, KlausEBspecific.Betriebsparameter.FahrparameterEnum.V_130)
        V_160 = _Betriebsparameter.Fahrparameter(49, KlausEBspecific.Betriebsparameter.FahrparameterEnum.V_160)
        V_180 = _Betriebsparameter.Fahrparameter(49, KlausEBspecific.Betriebsparameter.FahrparameterEnum.V_180)
        V_500 = _Betriebsparameter.Fahrparameter(49, KlausEBspecific.Betriebsparameter.FahrparameterEnum.V_500)
        G_200 = _Betriebsparameter.Fahrparameter(49, KlausEBspecific.Betriebsparameter.FahrparameterEnum.G_200)

        If A_StopB = 1 Then
            V_100 = 8000
        End If

        Stufe1 = _LokStufen.Holen(49, 1)
        Stufe2 = _LokStufen.Holen(49, 2)
        Stufe3 = _LokStufen.Holen(49, 3)
        Stufe4 = _LokStufen.Holen(49, 4)

        If Stufe2 = 1 Then
            T_100 = T_100
            T_130 = T_130
            T_160 = T_160
            V_180 = V_180
        ElseIf Stufe2 = 2 Then
            T_100 = T_100 + 300
            T_130 = T_130 + 300
            T_160 = T_160 + 300
            V_180 = V_180 + 500
        ElseIf Stufe2 = 3 Then
            T_100 = T_100 + 500
            T_130 = T_130 + 500
            T_160 = T_160 + 500
            V_180 = V_180 + 1000
        ElseIf Stufe2 = 4 Then
            T_100 = T_100 + 700
            T_130 = T_130 + 700
            T_160 = T_160 + 700
            V_180 = V_180 + 1500
        ElseIf Stufe2 = 5 Then
            T_100 = T_100 + 900
            T_130 = T_130 + 900
            T_160 = T_160 + 900
            V_180 = V_180 + 2000
        ElseIf Stufe2 = 6 Then
            T_100 = T_100 + 1200
            T_130 = T_130 + 1200
            T_160 = T_160 + 1200
            V_180 = V_180 + 2500
        Else
            T_100 = T_100 + 1200
            T_130 = T_130 + 1200
            T_160 = T_160 + 1200
            V_180 = V_180 + 2500
        End If

        Stufe2 = Stufe1

        Stufe11 = Stufe1 + 1
        If Stufe11 > Stufe3 Then
            Stufe11 = Stufe3
        End If
        Stufe12 = Stufe1 + 2
        If Stufe12 > Stufe3 Then
            Stufe12 = Stufe3
        End If
        Stufe13 = Stufe1 + 3
        If Stufe13 > Stufe3 Then
            Stufe13 = Stufe3
        End If
        Stufe14 = Stufe1 + 4
        If Stufe14 > Stufe3 Then
            Stufe14 = Stufe3
        End If

        Stufe21 = Stufe2 + 1
        If Stufe21 > Stufe3 Then
            Stufe21 = Stufe3
        End If
        Stufe22 = Stufe2 + 2
        If Stufe22 > Stufe3 Then
            Stufe22 = Stufe3
        End If
        Stufe23 = Stufe2 + 3
        If Stufe23 > Stufe3 Then
            Stufe23 = Stufe3
        End If
        Stufe24 = Stufe2 + 4
        If Stufe24 > Stufe3 Then
            Stufe24 = Stufe3
        End If
        If G_200 > 0 Then
            If G_200 < Stufe4 Then
                G_200 = Stufe4
            End If
        Else
            G_200 = Stufe4
        End If

        If Betriebsart = 1 And (_GlsL49 = 3 Or _GlsL49 = 4) Then
            SetProgramCounterLabel1(_Prog49)
        Else
            SetProgramCounterLabel(_Prog49)
        End If

        ' Lok starten - Bahnhofsausfahrt

        If _Prog49 = 0 Then
            Prog_Lok49.Interval = 2000
        ElseIf _Prog49 = 1 Then
            If _Fahrzeugbeleuchtung2 > 0 Then
                _eb.lokSteuern(49, Klassen.LokEigenschaften.Hauptfunktion, 1) ' Licht ein
            End If
        ElseIf _Prog49 = 2 Then
            _Betriebsparameter.RundenErhoehen(49)
        ElseIf _Prog49 = 3 Then
        ElseIf _Prog49 = 4 Then
        ElseIf _Prog49 = 5 Then
        ElseIf _Prog49 = 6 Then
        ElseIf _Prog49 = 7 Then

            ' Bahnhofsausfahrt

        ElseIf _Prog49 = 8 Then
            _eb.lokSteuern(49, Klassen.LokEigenschaften.Geschwindigkeit, Stufe1)
        ElseIf _Prog49 = 9 Then
            _eb.lokSteuern(49, Klassen.LokEigenschaften.Geschwindigkeit, Stufe11)
        ElseIf _Prog49 = 10 Then
            _eb.lokSteuern(49, Klassen.LokEigenschaften.Geschwindigkeit, Stufe12)
        ElseIf _Prog49 = 11 Then
            _eb.lokSteuern(49, Klassen.LokEigenschaften.Geschwindigkeit, Stufe13)
        ElseIf _Prog49 = 12 Then
            _eb.lokSteuern(49, Klassen.LokEigenschaften.Geschwindigkeit, Stufe14)
        ElseIf _Prog49 = 13 Then
            _eb.lokSteuern(49, Klassen.LokEigenschaften.Geschwindigkeit, Stufe3)

            ' Lok abstellen

        ElseIf _Prog49 = 50 Then
            Prog_Lok49.Interval = 2000
        ElseIf _Prog49 = 51 Then
        ElseIf _Prog49 = 52 Then
            If _Fahrzeugbeleuchtung2 < 2 Then
                _eb.lokSteuern(49, Klassen.LokEigenschaften.Hauptfunktion, 0) ' Licht aus
            End If

            ' Lok bremsen (Bahnhofseinfahrt Normalzug von links und von rechts)

        ElseIf _Prog49 = 100 Then
            Prog_Lok49.Interval = V_100
        ElseIf _Prog49 = 101 Then
            _eb.lokSteuern(49, Klassen.LokEigenschaften.Geschwindigkeit, Stufe24)
            Prog_Lok49.Interval = T_100
        ElseIf _Prog49 = 102 Then
            _eb.lokSteuern(49, Klassen.LokEigenschaften.Geschwindigkeit, Stufe23)
        ElseIf _Prog49 = 103 Then
            _eb.lokSteuern(49, Klassen.LokEigenschaften.Geschwindigkeit, Stufe22)
        ElseIf _Prog49 = 104 Then
            _eb.lokSteuern(49, Klassen.LokEigenschaften.Geschwindigkeit, Stufe21)
        ElseIf _Prog49 = 105 Then
            _eb.lokSteuern(49, Klassen.LokEigenschaften.Geschwindigkeit, Stufe2)

            ' Lok bremsen (Bahnhofseinfahrt Kurzzug von links)

        ElseIf _Prog49 = 130 Then
            Prog_Lok49.Interval = V_130
        ElseIf _Prog49 = 131 Then
            _eb.lokSteuern(49, Klassen.LokEigenschaften.Geschwindigkeit, Stufe24)
            Prog_Lok49.Interval = T_130
        ElseIf _Prog49 = 132 Then
            _eb.lokSteuern(49, Klassen.LokEigenschaften.Geschwindigkeit, Stufe23)
        ElseIf _Prog49 = 133 Then
            _eb.lokSteuern(49, Klassen.LokEigenschaften.Geschwindigkeit, Stufe22)
        ElseIf _Prog49 = 134 Then
            _eb.lokSteuern(49, Klassen.LokEigenschaften.Geschwindigkeit, Stufe21)
        ElseIf _Prog49 = 135 Then
            _eb.lokSteuern(49, Klassen.LokEigenschaften.Geschwindigkeit, Stufe2)
        ElseIf _Prog49 = 136 Then
            _eb.lokSteuern(49, Klassen.LokEigenschaften.Geschwindigkeit, 0)
        ElseIf _Prog49 = 137 Then
            Prog_Lok49.Interval = 2000
        ElseIf _Prog49 = 138 Then
            If _Fahrzeugbeleuchtung2 < 2 Then
                _eb.lokSteuern(49, Klassen.LokEigenschaften.Hauptfunktion, 0) ' Licht aus
            End If

            ' Lok bremsen (Bahnhofseinfahrt Kurzzug von rechts)

        ElseIf _Prog49 = 160 Then
            Prog_Lok49.Interval = V_160
        ElseIf _Prog49 = 161 Then
            _eb.lokSteuern(49, Klassen.LokEigenschaften.Geschwindigkeit, Stufe24)
            Prog_Lok49.Interval = T_160
        ElseIf _Prog49 = 162 Then
            _eb.lokSteuern(49, Klassen.LokEigenschaften.Geschwindigkeit, Stufe23)
        ElseIf _Prog49 = 163 Then
            _eb.lokSteuern(49, Klassen.LokEigenschaften.Geschwindigkeit, Stufe22)
        ElseIf _Prog49 = 164 Then
            _eb.lokSteuern(49, Klassen.LokEigenschaften.Geschwindigkeit, Stufe21)
        ElseIf _Prog49 = 165 Then
            _eb.lokSteuern(49, Klassen.LokEigenschaften.Geschwindigkeit, Stufe2)
        ElseIf _Prog49 = 166 Then
            _eb.lokSteuern(49, Klassen.LokEigenschaften.Geschwindigkeit, 0)
        ElseIf _Prog49 = 167 Then
            Prog_Lok49.Interval = 2000
        ElseIf _Prog49 = 168 Then
            If _Fahrzeugbeleuchtung2 < 2 Then
                _eb.lokSteuern(49, Klassen.LokEigenschaften.Hauptfunktion, 0) ' Licht aus
            End If

            ' Rangierzug

        ElseIf _Prog49 = 180 Then
            _eb.lokSteuern(49, Klassen.LokEigenschaften.Geschwindigkeit, 2)
            Prog_Lok49.Interval = V_180
        ElseIf _Prog49 = 181 Then
            Prog_Lok49.Interval = T_180
            _eb.lokSteuern(49, Klassen.LokEigenschaften.Geschwindigkeit, 1)
        ElseIf _Prog49 = 182 Then
            _eb.lokSteuern(49, Klassen.LokEigenschaften.Geschwindigkeit, 0)

            ' Tunnelausfahrt

        ElseIf _Prog49 = 200 Then ' Kontakt 1.2 <- (bergauf)
            _eb.lokSteuern(49, Klassen.LokEigenschaften.Geschwindigkeit, G_200)
            Prog_Lok49.Interval = 2000
        ElseIf _Prog49 = 201 Then
        ElseIf _Prog49 = 202 Then
        ElseIf _Prog49 = 203 Then
        ElseIf _Prog49 = 204 Then
        ElseIf _Prog49 = 205 Then
            If Stufe4 < Stufe3 Then
                _eb.lokSteuern(49, Klassen.LokEigenschaften.Geschwindigkeit, Stufe3)
            Else
                _eb.lokSteuern(49, Klassen.LokEigenschaften.Geschwindigkeit, Stufe4)
            End If

        ElseIf _Prog49 = 220 Then ' Kontakt 3.1 -> (hinter dem Martinstor bergauf)
            Prog_Lok49.Interval = 2000
        ElseIf _Prog49 = 221 Then
        ElseIf _Prog49 = 222 Then

        ElseIf _Prog49 = 240 Then ' Kontakt 3.7 <- (hinter der Brücke bergauf)
            Prog_Lok49.Interval = 2000
        ElseIf _Prog49 = 241 Then
        ElseIf _Prog49 = 242 Then

        ElseIf _Prog49 = 260 Then ' Kontakt 3.3 (links bzw vor der Brücke)
            Prog_Lok49.Interval = 2000
        ElseIf _Prog49 = 261 Then
        ElseIf _Prog49 = 262 Then
            _eb.lokSteuern(49, Klassen.LokEigenschaften.Geschwindigkeit, Stufe3)

        ElseIf _Prog49 = 600 Then ' Kontakt 3.5 <- (unter der Burg)
            Prog_Lok49.Interval = 2000
        ElseIf _Prog49 = 601 Then
        ElseIf _Prog49 = 602 Then

        ElseIf _Prog49 = 620 Then ' Kontakt 3.7 -> (hinter der Brücke bergab)
            Prog_Lok49.Interval = 2000
        ElseIf _Prog49 = 621 Then
        ElseIf _Prog49 = 622 Then

        ElseIf _Prog49 = 640 Then ' Kontakt 3.1 <- Talfahrt
            Prog_Lok49.Interval = 2000
        ElseIf _Prog49 = 641 Then
        ElseIf _Prog49 = 642 Then

        ElseIf _Prog49 = 660 Then ' Kontakt 1.2 -> Talfahrt
            Prog_Lok49.Interval = 2000
        ElseIf _Prog49 = 661 Then
        ElseIf _Prog49 = 662 Then

        ElseIf _Prog49 = 700 Then ' Kontakt 0.4 <- Diagonale
            Prog_Lok49.Interval = 2000
        ElseIf _Prog49 = 701 Then
        ElseIf _Prog49 = 702 Then

            ' Zindelstein

        ElseIf _Prog49 = 500 Then
            Prog_Lok49.Interval = V_500
        ElseIf _Prog49 = 501 Then
            _eb.lokSteuern(49, Klassen.LokEigenschaften.Geschwindigkeit, Stufe23)
            Prog_Lok49.Interval = T_500
        ElseIf _Prog49 = 502 Then
            _eb.lokSteuern(49, Klassen.LokEigenschaften.Geschwindigkeit, Stufe22)
        ElseIf _Prog49 = 503 Then
            _eb.lokSteuern(49, Klassen.LokEigenschaften.Geschwindigkeit, Stufe21)
        ElseIf _Prog49 = 504 Then
            _eb.lokSteuern(49, Klassen.LokEigenschaften.Geschwindigkeit, Stufe2)
        ElseIf _Prog49 = 505 Then
            _eb.lokSteuern(49, Klassen.LokEigenschaften.Geschwindigkeit, 0)


        Else
            _Prog49 = 0
            Prog_Lok49.Stop()
            Prog_Lok49.Interval = 200
            If Betriebsart = 1 Then
                SetProgramCounterLabel1(String.Empty)
            Else
                SetProgramCounterLabel(String.Empty)
            End If
        End If
        _Prog49 = _Prog49 + 1
    End Sub
    Private Sub HandleTimerElapsed62(sender As System.Object, e As System.EventArgs) Handles Prog_Lok50.Elapsed

        '*** Fahrprogramm für "nicht verwendet"
        '*** Datum: 23.02.2020

        'SetText(TextBox1, "E-Lok CE 6/8                                                           IBS: nein")
        'LoadImage(PictureBox1, "H:\\EB_Media\\LokFotos\\Baureihe_CE68b_01.jpg")
        GeschwindikeitenSetzen(50)

        Dim Stufe1, Stufe2, Stufe3, Stufe4 As Integer
        Dim Stufe11, Stufe12, Stufe13, Stufe14, Stufe21, Stufe22, Stufe23, Stufe24 As Integer
        Dim V_100, V_130, V_160, V_180, V_500 As Integer
        Dim T_100, T_130, T_160, T_180, T_500 As Integer
        Dim G_200 As Integer

        T_100 = _Betriebsparameter.Fahrparameter(50, KlausEBspecific.Betriebsparameter.FahrparameterEnum.T_100)
        T_130 = _Betriebsparameter.Fahrparameter(50, KlausEBspecific.Betriebsparameter.FahrparameterEnum.T_130)
        T_160 = _Betriebsparameter.Fahrparameter(50, KlausEBspecific.Betriebsparameter.FahrparameterEnum.T_160)
        T_180 = _Betriebsparameter.Fahrparameter(50, KlausEBspecific.Betriebsparameter.FahrparameterEnum.T_180)
        T_500 = _Betriebsparameter.Fahrparameter(50, KlausEBspecific.Betriebsparameter.FahrparameterEnum.T_500)
        V_100 = _Betriebsparameter.Fahrparameter(50, KlausEBspecific.Betriebsparameter.FahrparameterEnum.V_100)
        V_130 = _Betriebsparameter.Fahrparameter(50, KlausEBspecific.Betriebsparameter.FahrparameterEnum.V_130)
        V_160 = _Betriebsparameter.Fahrparameter(50, KlausEBspecific.Betriebsparameter.FahrparameterEnum.V_160)
        V_180 = _Betriebsparameter.Fahrparameter(50, KlausEBspecific.Betriebsparameter.FahrparameterEnum.V_180)
        V_500 = _Betriebsparameter.Fahrparameter(50, KlausEBspecific.Betriebsparameter.FahrparameterEnum.V_500)
        G_200 = _Betriebsparameter.Fahrparameter(50, KlausEBspecific.Betriebsparameter.FahrparameterEnum.G_200)

        If A_StopB = 1 Then
            V_100 = 8000
        End If

        Stufe1 = _LokStufen.Holen(50, 1)
        Stufe2 = _LokStufen.Holen(50, 2)
        Stufe3 = _LokStufen.Holen(50, 3)
        Stufe4 = _LokStufen.Holen(50, 4)

        If Stufe2 = 1 Then
            T_100 = T_100
            T_130 = T_130
            T_160 = T_160
            V_180 = V_180
        ElseIf Stufe2 = 2 Then
            T_100 = T_100 + 300
            T_130 = T_130 + 300
            T_160 = T_160 + 300
            V_180 = V_180 + 500
        ElseIf Stufe2 = 3 Then
            T_100 = T_100 + 500
            T_130 = T_130 + 500
            T_160 = T_160 + 500
            V_180 = V_180 + 1000
        ElseIf Stufe2 = 4 Then
            T_100 = T_100 + 700
            T_130 = T_130 + 700
            T_160 = T_160 + 700
            V_180 = V_180 + 1500
        ElseIf Stufe2 = 5 Then
            T_100 = T_100 + 900
            T_130 = T_130 + 900
            T_160 = T_160 + 900
            V_180 = V_180 + 2000
        ElseIf Stufe2 = 6 Then
            T_100 = T_100 + 1200
            T_130 = T_130 + 1200
            T_160 = T_160 + 1200
            V_180 = V_180 + 2500
        Else
            T_100 = T_100 + 1200
            T_130 = T_130 + 1200
            T_160 = T_160 + 1200
            V_180 = V_180 + 2500
        End If

        Stufe2 = Stufe1

        Stufe11 = Stufe1 + 1
        If Stufe11 > Stufe3 Then
            Stufe11 = Stufe3
        End If
        Stufe12 = Stufe1 + 2
        If Stufe12 > Stufe3 Then
            Stufe12 = Stufe3
        End If
        Stufe13 = Stufe1 + 3
        If Stufe13 > Stufe3 Then
            Stufe13 = Stufe3
        End If
        Stufe14 = Stufe1 + 4
        If Stufe14 > Stufe3 Then
            Stufe14 = Stufe3
        End If

        Stufe21 = Stufe2 + 1
        If Stufe21 > Stufe3 Then
            Stufe21 = Stufe3
        End If
        Stufe22 = Stufe2 + 2
        If Stufe22 > Stufe3 Then
            Stufe22 = Stufe3
        End If
        Stufe23 = Stufe2 + 3
        If Stufe23 > Stufe3 Then
            Stufe23 = Stufe3
        End If
        Stufe24 = Stufe2 + 4
        If Stufe24 > Stufe3 Then
            Stufe24 = Stufe3
        End If
        If G_200 > 0 Then
            If G_200 < Stufe4 Then
                G_200 = Stufe4
            End If
        Else
            G_200 = Stufe4
        End If

        If Betriebsart = 1 And (_GlsL50 = 3 Or _GlsL50 = 4) Then
            SetProgramCounterLabel1(_Prog50)
        Else
            SetProgramCounterLabel(_Prog50)
        End If

        ' Lok starten - Bahnhofsausfahrt

        If _Prog50 = 0 Then
            Prog_Lok50.Interval = 2000
        ElseIf _Prog50 = 1 Then
        ElseIf _Prog50 = 2 Then
            _Betriebsparameter.RundenErhoehen(50)
        ElseIf _Prog50 = 3 Then
        ElseIf _Prog50 = 4 Then
        ElseIf _Prog50 = 5 Then
        ElseIf _Prog50 = 6 Then

            ' Bahnhofsausfahrt

        ElseIf _Prog50 = 7 Then
            _eb.lokSteuern(50, Klassen.LokEigenschaften.Geschwindigkeit, Stufe1)
        ElseIf _Prog50 = 8 Then
            _eb.lokSteuern(50, Klassen.LokEigenschaften.Geschwindigkeit, Stufe11)
        ElseIf _Prog50 = 9 Then
            _eb.lokSteuern(50, Klassen.LokEigenschaften.Geschwindigkeit, Stufe12)
        ElseIf _Prog50 = 10 Then
            _eb.lokSteuern(50, Klassen.LokEigenschaften.Geschwindigkeit, Stufe13)
        ElseIf _Prog50 = 11 Then
            _eb.lokSteuern(50, Klassen.LokEigenschaften.Geschwindigkeit, Stufe14)
        ElseIf _Prog50 = 12 Then
            _eb.lokSteuern(50, Klassen.LokEigenschaften.Geschwindigkeit, Stufe3)

            ' Lok abstellen

        ElseIf _Prog50 = 50 Then
            Prog_Lok50.Interval = 2000
        ElseIf _Prog50 = 51 Then
        ElseIf _Prog50 = 52 Then
            If _Fahrzeugbeleuchtung2 < 2 Then
                _eb.lokSteuern(50, Klassen.LokEigenschaften.Hauptfunktion, 0) ' Licht aus
            End If

            ' Lok bremsen (Bahnhofseinfahrt Normalzug von links und von rechts)

        ElseIf _Prog50 = 100 Then
            Prog_Lok50.Interval = V_100
        ElseIf _Prog50 = 101 Then
            _eb.lokSteuern(50, Klassen.LokEigenschaften.Geschwindigkeit, Stufe24)
            Prog_Lok50.Interval = T_100
        ElseIf _Prog50 = 102 Then
            _eb.lokSteuern(50, Klassen.LokEigenschaften.Geschwindigkeit, Stufe23)
        ElseIf _Prog50 = 103 Then
            _eb.lokSteuern(50, Klassen.LokEigenschaften.Geschwindigkeit, Stufe22)
        ElseIf _Prog50 = 104 Then
            _eb.lokSteuern(50, Klassen.LokEigenschaften.Geschwindigkeit, Stufe21)
        ElseIf _Prog50 = 105 Then
            _eb.lokSteuern(50, Klassen.LokEigenschaften.Geschwindigkeit, Stufe2)

            ' Lok bremsen (Bahnhofseinfahrt Kurzzug von links)

        ElseIf _Prog50 = 130 Then
            Prog_Lok50.Interval = V_130
        ElseIf _Prog50 = 131 Then
            _eb.lokSteuern(50, Klassen.LokEigenschaften.Geschwindigkeit, Stufe24)
            Prog_Lok50.Interval = T_130
        ElseIf _Prog50 = 132 Then
            _eb.lokSteuern(50, Klassen.LokEigenschaften.Geschwindigkeit, Stufe23)
        ElseIf _Prog50 = 133 Then
            _eb.lokSteuern(50, Klassen.LokEigenschaften.Geschwindigkeit, Stufe22)
        ElseIf _Prog50 = 134 Then
            _eb.lokSteuern(50, Klassen.LokEigenschaften.Geschwindigkeit, Stufe21)
        ElseIf _Prog50 = 135 Then
            _eb.lokSteuern(50, Klassen.LokEigenschaften.Geschwindigkeit, Stufe2)
            Prog_Lok50.Interval = 1000
        ElseIf _Prog50 = 136 Then
            _eb.lokSteuern(50, Klassen.LokEigenschaften.Geschwindigkeit, 0)
        ElseIf _Prog50 = 137 Then
            Prog_Lok50.Interval = 2000
        ElseIf _Prog50 = 138 Then
            If _Fahrzeugbeleuchtung2 < 2 Then
                _eb.lokSteuern(50, Klassen.LokEigenschaften.Hauptfunktion, 0) ' Licht aus
            End If

            ' Lok bremsen (Bahnhofseinfahrt Kurzzug von rechts)

        ElseIf _Prog50 = 160 Then
            Prog_Lok50.Interval = V_160
        ElseIf _Prog50 = 161 Then
            _eb.lokSteuern(49, Klassen.LokEigenschaften.Geschwindigkeit, Stufe24)
            Prog_Lok50.Interval = T_160
        ElseIf _Prog50 = 162 Then
            _eb.lokSteuern(50, Klassen.LokEigenschaften.Geschwindigkeit, Stufe23)
        ElseIf _Prog50 = 163 Then
            _eb.lokSteuern(50, Klassen.LokEigenschaften.Geschwindigkeit, Stufe22)
        ElseIf _Prog50 = 164 Then
            _eb.lokSteuern(50, Klassen.LokEigenschaften.Geschwindigkeit, Stufe21)
        ElseIf _Prog50 = 165 Then
            _eb.lokSteuern(50, Klassen.LokEigenschaften.Geschwindigkeit, Stufe2)
        ElseIf _Prog50 = 166 Then
            _eb.lokSteuern(50, Klassen.LokEigenschaften.Geschwindigkeit, 0)
        ElseIf _Prog50 = 167 Then
            Prog_Lok50.Interval = 2000
        ElseIf _Prog50 = 168 Then
            If _Fahrzeugbeleuchtung2 < 2 Then
                _eb.lokSteuern(50, Klassen.LokEigenschaften.Hauptfunktion, 0) ' Licht aus
            End If

            ' Rangierzug

        ElseIf _Prog50 = 180 Then
            _eb.lokSteuern(50, Klassen.LokEigenschaften.Geschwindigkeit, 2)
            Prog_Lok50.Interval = V_180
        ElseIf _Prog50 = 181 Then
            Prog_Lok50.Interval = T_180
            _eb.lokSteuern(50, Klassen.LokEigenschaften.Geschwindigkeit, 1)
        ElseIf _Prog50 = 182 Then
            _eb.lokSteuern(50, Klassen.LokEigenschaften.Geschwindigkeit, 0)

            ' Tunnelausfahrt

        ElseIf _Prog50 = 200 Then ' Kontakt 1.2 <- (bergauf)
            _eb.lokSteuern(50, Klassen.LokEigenschaften.Geschwindigkeit, G_200)
            Prog_Lok50.Interval = 2000
        ElseIf _Prog50 = 201 Then
        ElseIf _Prog50 = 202 Then
        ElseIf _Prog50 = 203 Then
        ElseIf _Prog50 = 204 Then
        ElseIf _Prog50 = 205 Then
            If Stufe4 < Stufe3 Then
                _eb.lokSteuern(50, Klassen.LokEigenschaften.Geschwindigkeit, Stufe3)
            Else
                _eb.lokSteuern(50, Klassen.LokEigenschaften.Geschwindigkeit, Stufe4)
            End If

        ElseIf _Prog50 = 220 Then ' Kontakt 3.1 -> (hinter dem Martinstor bergauf)
            Prog_Lok50.Interval = 2000
        ElseIf _Prog50 = 221 Then
        ElseIf _Prog50 = 222 Then

        ElseIf _Prog50 = 240 Then ' Kontakt 3.7 <- (hinter der Brücke bergauf)
            Prog_Lok50.Interval = 2000
        ElseIf _Prog50 = 241 Then
        ElseIf _Prog50 = 242 Then

        ElseIf _Prog50 = 260 Then ' Kontakt 3.3 (links bzw vor der Brücke)
            Prog_Lok50.Interval = 2000
        ElseIf _Prog50 = 261 Then
        ElseIf _Prog50 = 262 Then
            _eb.lokSteuern(50, Klassen.LokEigenschaften.Geschwindigkeit, Stufe3)

        ElseIf _Prog50 = 600 Then ' Kontakt 3.5 <- (unter der Burg)
            Prog_Lok50.Interval = 2000
        ElseIf _Prog50 = 601 Then
        ElseIf _Prog50 = 602 Then

        ElseIf _Prog50 = 620 Then ' Kontakt 3.7 -> (hinter der Brücke bergab)
            Prog_Lok50.Interval = 2000
        ElseIf _Prog50 = 621 Then
        ElseIf _Prog50 = 622 Then

        ElseIf _Prog50 = 640 Then ' Kontakt 3.1 <- Talfahrt
            Prog_Lok50.Interval = 2000
        ElseIf _Prog50 = 641 Then
        ElseIf _Prog50 = 642 Then

        ElseIf _Prog50 = 660 Then ' Kontakt 1.2 -> Talfahrt
            Prog_Lok50.Interval = 2000
        ElseIf _Prog50 = 661 Then
        ElseIf _Prog50 = 662 Then

        ElseIf _Prog50 = 700 Then ' Kontakt 0.4 <- Diagonale
            Prog_Lok50.Interval = 2000
        ElseIf _Prog50 = 701 Then
        ElseIf _Prog50 = 702 Then

            ' Zindelstein

        ElseIf _Prog50 = 500 Then
            Prog_Lok50.Interval = V_500
        ElseIf _Prog50 = 501 Then
            _eb.lokSteuern(49, Klassen.LokEigenschaften.Geschwindigkeit, Stufe23)
            Prog_Lok50.Interval = T_500
        ElseIf _Prog50 = 502 Then
            _eb.lokSteuern(49, Klassen.LokEigenschaften.Geschwindigkeit, Stufe22)
        ElseIf _Prog50 = 503 Then
            _eb.lokSteuern(49, Klassen.LokEigenschaften.Geschwindigkeit, Stufe21)
        ElseIf _Prog50 = 504 Then
            _eb.lokSteuern(50, Klassen.LokEigenschaften.Geschwindigkeit, Stufe2)
        ElseIf _Prog50 = 505 Then
            _eb.lokSteuern(50, Klassen.LokEigenschaften.Geschwindigkeit, 0)

        Else
            _Prog50 = 0
            Prog_Lok50.Stop()
            Prog_Lok51.Interval = 200
            If Betriebsart = 1 Then
                SetProgramCounterLabel1(String.Empty)
            Else
                SetProgramCounterLabel(String.Empty)
            End If
        End If
        _Prog50 = _Prog50 + 1
    End Sub
    Private Sub HandleTimerElapsed63(sender As System.Object, e As System.EventArgs) Handles Prog_Lok51.Elapsed

        '*** Fahrprogramm für "nicht verwendet"
        '*** Datum: 23.02.2020

        'SetText(TextBox1, "E-Lok CE 6/8                                                                  IBS: nein")
        'LoadImage(PictureBox1, "H:\\EB_Media\\LokFotos\\Baureihe_CE68b_01.jpg")
        GeschwindikeitenSetzen(51)

        Dim Stufe1, Stufe2, Stufe3, Stufe4 As Integer
        Dim Stufe11, Stufe12, Stufe13, Stufe14, Stufe21, Stufe22, Stufe23, Stufe24 As Integer
        Dim V_100, V_130, V_160, V_180, V_500 As Integer
        Dim T_100, T_130, T_160, T_180, T_500 As Integer
        Dim G_200 As Integer

        T_100 = _Betriebsparameter.Fahrparameter(51, KlausEBspecific.Betriebsparameter.FahrparameterEnum.T_100)
        T_130 = _Betriebsparameter.Fahrparameter(51, KlausEBspecific.Betriebsparameter.FahrparameterEnum.T_130)
        T_160 = _Betriebsparameter.Fahrparameter(51, KlausEBspecific.Betriebsparameter.FahrparameterEnum.T_160)
        T_180 = _Betriebsparameter.Fahrparameter(51, KlausEBspecific.Betriebsparameter.FahrparameterEnum.T_180)
        T_500 = _Betriebsparameter.Fahrparameter(51, KlausEBspecific.Betriebsparameter.FahrparameterEnum.T_500)
        V_100 = _Betriebsparameter.Fahrparameter(51, KlausEBspecific.Betriebsparameter.FahrparameterEnum.V_100)
        V_130 = _Betriebsparameter.Fahrparameter(51, KlausEBspecific.Betriebsparameter.FahrparameterEnum.V_130)
        V_160 = _Betriebsparameter.Fahrparameter(51, KlausEBspecific.Betriebsparameter.FahrparameterEnum.V_160)
        V_180 = _Betriebsparameter.Fahrparameter(51, KlausEBspecific.Betriebsparameter.FahrparameterEnum.V_180)
        V_500 = _Betriebsparameter.Fahrparameter(51, KlausEBspecific.Betriebsparameter.FahrparameterEnum.V_500)
        G_200 = _Betriebsparameter.Fahrparameter(51, KlausEBspecific.Betriebsparameter.FahrparameterEnum.G_200)

        If A_StopB = 1 Then
            V_100 = 8000
        End If

        Stufe1 = _LokStufen.Holen(51, 1)
        Stufe2 = _LokStufen.Holen(51, 2)
        Stufe3 = _LokStufen.Holen(51, 3)
        Stufe4 = _LokStufen.Holen(51, 4)

        If Stufe2 = 1 Then
            T_100 = T_100
            T_130 = T_130
            T_160 = T_160
            V_180 = V_180
        ElseIf Stufe2 = 2 Then
            T_100 = T_100 + 300
            T_130 = T_130 + 300
            T_160 = T_160 + 300
            V_180 = V_180 + 500
        ElseIf Stufe2 = 3 Then
            T_100 = T_100 + 500
            T_130 = T_130 + 500
            T_160 = T_160 + 500
            V_180 = V_180 + 1000
        ElseIf Stufe2 = 4 Then
            T_100 = T_100 + 700
            T_130 = T_130 + 700
            T_160 = T_160 + 700
            V_180 = V_180 + 1500
        ElseIf Stufe2 = 5 Then
            T_100 = T_100 + 900
            T_130 = T_130 + 900
            T_160 = T_160 + 900
            V_180 = V_180 + 2000
        ElseIf Stufe2 = 6 Then
            T_100 = T_100 + 1200
            T_130 = T_130 + 1200
            T_160 = T_160 + 1200
            V_180 = V_180 + 2500
        Else
            T_100 = T_100 + 1200
            T_130 = T_130 + 1200
            T_160 = T_160 + 1200
            V_180 = V_180 + 2500
        End If

        Stufe2 = Stufe1

        Stufe11 = Stufe1 + 1
        If Stufe11 > Stufe3 Then
            Stufe11 = Stufe3
        End If
        Stufe12 = Stufe1 + 2
        If Stufe12 > Stufe3 Then
            Stufe12 = Stufe3
        End If
        Stufe13 = Stufe1 + 3
        If Stufe13 > Stufe3 Then
            Stufe13 = Stufe3
        End If
        Stufe14 = Stufe1 + 4
        If Stufe14 > Stufe3 Then
            Stufe14 = Stufe3
        End If

        Stufe21 = Stufe2 + 1
        If Stufe21 > Stufe3 Then
            Stufe21 = Stufe3
        End If
        Stufe22 = Stufe2 + 2
        If Stufe22 > Stufe3 Then
            Stufe22 = Stufe3
        End If
        Stufe23 = Stufe2 + 3
        If Stufe23 > Stufe3 Then
            Stufe23 = Stufe3
        End If
        Stufe24 = Stufe2 + 4
        If Stufe24 > Stufe3 Then
            Stufe24 = Stufe3
        End If
        If G_200 > 0 Then
            If G_200 < Stufe4 Then
                G_200 = Stufe4
            End If
        Else
            G_200 = Stufe4
        End If

        If Betriebsart = 1 And (_GlsL51 = 3 Or _GlsL51 = 4) Then
            SetProgramCounterLabel1(_Prog51)
        Else
            SetProgramCounterLabel(_Prog51)
        End If

        ' Lok starten - Bahnhofsausfahrt

        If _Prog51 = 0 Then
            Prog_Lok51.Interval = 2000
        ElseIf _Prog51 = 1 Then
        ElseIf _Prog51 = 2 Then
            _Betriebsparameter.RundenErhoehen(51)
        ElseIf _Prog51 = 3 Then
        ElseIf _Prog51 = 4 Then
        ElseIf _Prog51 = 5 Then
        ElseIf _Prog51 = 6 Then

            ' Bahnhofsausfahrt

        ElseIf _Prog51 = 7 Then
            _eb.lokSteuern(51, Klassen.LokEigenschaften.Geschwindigkeit, Stufe1)
        ElseIf _Prog51 = 8 Then
            _eb.lokSteuern(51, Klassen.LokEigenschaften.Geschwindigkeit, Stufe11)
        ElseIf _Prog51 = 9 Then
            _eb.lokSteuern(51, Klassen.LokEigenschaften.Geschwindigkeit, Stufe12)
        ElseIf _Prog51 = 10 Then
            _eb.lokSteuern(51, Klassen.LokEigenschaften.Geschwindigkeit, Stufe13)
        ElseIf _Prog51 = 11 Then
            _eb.lokSteuern(51, Klassen.LokEigenschaften.Geschwindigkeit, Stufe14)
        ElseIf _Prog51 = 12 Then
            _eb.lokSteuern(51, Klassen.LokEigenschaften.Geschwindigkeit, Stufe3)

            ' Lok abstellen

        ElseIf _Prog51 = 50 Then
            Prog_Lok51.Interval = 2000
        ElseIf _Prog51 = 51 Then
        ElseIf _Prog51 = 52 Then
            If _Fahrzeugbeleuchtung2 < 2 Then
                _eb.lokSteuern(51, Klassen.LokEigenschaften.Hauptfunktion, 0) ' Licht aus
            End If

            ' Lok bremsen (Bahnhofseinfahrt Normalzug von links und von rechts)

        ElseIf _Prog51 = 100 Then
            Prog_Lok51.Interval = V_100
        ElseIf _Prog51 = 101 Then
            _eb.lokSteuern(51, Klassen.LokEigenschaften.Geschwindigkeit, Stufe24)
            Prog_Lok51.Interval = T_100
        ElseIf _Prog51 = 102 Then
            _eb.lokSteuern(51, Klassen.LokEigenschaften.Geschwindigkeit, Stufe23)
        ElseIf _Prog51 = 103 Then
            _eb.lokSteuern(51, Klassen.LokEigenschaften.Geschwindigkeit, Stufe22)
        ElseIf _Prog51 = 104 Then
            _eb.lokSteuern(51, Klassen.LokEigenschaften.Geschwindigkeit, Stufe21)
        ElseIf _Prog51 = 105 Then
            _eb.lokSteuern(51, Klassen.LokEigenschaften.Geschwindigkeit, Stufe2)

            ' Lok bremsen (Bahnhofseinfahrt Kurzzug von links)

        ElseIf _Prog51 = 130 Then
            Prog_Lok51.Interval = V_130
        ElseIf _Prog51 = 131 Then
            _eb.lokSteuern(51, Klassen.LokEigenschaften.Geschwindigkeit, Stufe24)
            Prog_Lok51.Interval = T_130
        ElseIf _Prog51 = 132 Then
            _eb.lokSteuern(51, Klassen.LokEigenschaften.Geschwindigkeit, Stufe21)
        ElseIf _Prog51 = 133 Then
            _eb.lokSteuern(51, Klassen.LokEigenschaften.Geschwindigkeit, Stufe22)
        ElseIf _Prog51 = 134 Then
            _eb.lokSteuern(51, Klassen.LokEigenschaften.Geschwindigkeit, Stufe21)
        ElseIf _Prog51 = 135 Then
            _eb.lokSteuern(51, Klassen.LokEigenschaften.Geschwindigkeit, Stufe2)
        ElseIf _Prog51 = 136 Then
            _eb.lokSteuern(51, Klassen.LokEigenschaften.Geschwindigkeit, 0)
        ElseIf _Prog51 = 137 Then
            Prog_Lok51.Interval = 2000
        ElseIf _Prog51 = 138 Then
            If _Fahrzeugbeleuchtung2 < 2 Then
                _eb.lokSteuern(51, Klassen.LokEigenschaften.Hauptfunktion, 0) ' Licht aus
            End If

            ' Lok bremsen (Bahnhofseinfahrt Kurzzug von rechts)

        ElseIf _Prog51 = 160 Then
            Prog_Lok51.Interval = V_160
        ElseIf _Prog51 = 161 Then
            _eb.lokSteuern(49, Klassen.LokEigenschaften.Geschwindigkeit, Stufe24)
            Prog_Lok51.Interval = T_160
        ElseIf _Prog51 = 162 Then
            _eb.lokSteuern(51, Klassen.LokEigenschaften.Geschwindigkeit, Stufe23)
        ElseIf _Prog51 = 163 Then
            _eb.lokSteuern(51, Klassen.LokEigenschaften.Geschwindigkeit, Stufe22)
        ElseIf _Prog51 = 164 Then
            _eb.lokSteuern(51, Klassen.LokEigenschaften.Geschwindigkeit, Stufe21)
        ElseIf _Prog51 = 165 Then
            _eb.lokSteuern(51, Klassen.LokEigenschaften.Geschwindigkeit, Stufe2)
        ElseIf _Prog51 = 166 Then
            _eb.lokSteuern(51, Klassen.LokEigenschaften.Geschwindigkeit, 0)
        ElseIf _Prog51 = 167 Then
            Prog_Lok51.Interval = 2000
        ElseIf _Prog51 = 168 Then
            If _Fahrzeugbeleuchtung2 < 2 Then
                _eb.lokSteuern(51, Klassen.LokEigenschaften.Hauptfunktion, 0) ' Licht aus
            End If

            ' Rangierzug

        ElseIf _Prog51 = 180 Then
            _eb.lokSteuern(51, Klassen.LokEigenschaften.Geschwindigkeit, 2)
            Prog_Lok51.Interval = V_180
        ElseIf _Prog51 = 181 Then
            Prog_Lok51.Interval = T_180
            _eb.lokSteuern(51, Klassen.LokEigenschaften.Geschwindigkeit, 1)
        ElseIf _Prog51 = 182 Then
            _eb.lokSteuern(51, Klassen.LokEigenschaften.Geschwindigkeit, 0)

            ' Tunnelausfahrt

        ElseIf _Prog51 = 200 Then ' Kontakt 1.2 <- (bergauf)
            _eb.lokSteuern(51, Klassen.LokEigenschaften.Geschwindigkeit, G_200)
            Prog_Lok51.Interval = 2000
        ElseIf _Prog51 = 201 Then
        ElseIf _Prog51 = 202 Then
        ElseIf _Prog51 = 203 Then
        ElseIf _Prog51 = 204 Then
        ElseIf _Prog51 = 205 Then
            If Stufe4 < Stufe3 Then
                _eb.lokSteuern(51, Klassen.LokEigenschaften.Geschwindigkeit, Stufe3)
            Else
                _eb.lokSteuern(51, Klassen.LokEigenschaften.Geschwindigkeit, Stufe4)
            End If

        ElseIf _Prog51 = 220 Then ' Kontakt 3.1 -> (hinter dem Martinstor bergauf)
            Prog_Lok51.Interval = 2000
        ElseIf _Prog51 = 221 Then
        ElseIf _Prog51 = 222 Then

        ElseIf _Prog51 = 240 Then ' Kontakt 3.7 <- (hinter der Brücke bergauf)
            Prog_Lok51.Interval = 2000
        ElseIf _Prog51 = 241 Then
        ElseIf _Prog51 = 242 Then

        ElseIf _Prog51 = 260 Then ' Kontakt 3.3 (links bzw vor der Brücke)
            Prog_Lok51.Interval = 2000
        ElseIf _Prog51 = 261 Then
        ElseIf _Prog51 = 262 Then
            _eb.lokSteuern(51, Klassen.LokEigenschaften.Geschwindigkeit, Stufe3)

        ElseIf _Prog51 = 600 Then ' Kontakt 3.5 <- (unter der Burg)
            Prog_Lok51.Interval = 2000
        ElseIf _Prog51 = 601 Then
        ElseIf _Prog51 = 602 Then

        ElseIf _Prog51 = 620 Then ' Kontakt 3.7 -> (hinter der Brücke bergab)
            Prog_Lok51.Interval = 2000
        ElseIf _Prog51 = 621 Then
        ElseIf _Prog51 = 622 Then

        ElseIf _Prog51 = 640 Then ' Kontakt 3.1 <- Talfahrt
            Prog_Lok51.Interval = 2000
        ElseIf _Prog51 = 641 Then
        ElseIf _Prog51 = 642 Then

        ElseIf _Prog51 = 660 Then ' Kontakt 1.2 -> Talfahrt
            Prog_Lok51.Interval = 2000
        ElseIf _Prog51 = 661 Then
        ElseIf _Prog51 = 662 Then

        ElseIf _Prog51 = 700 Then ' Kontakt 0.4 <- Diagonale
            Prog_Lok51.Interval = 2000
        ElseIf _Prog51 = 701 Then
        ElseIf _Prog51 = 702 Then

            ' Zindelstein

        ElseIf _Prog51 = 500 Then
            Prog_Lok51.Interval = V_500
        ElseIf _Prog51 = 501 Then
            _eb.lokSteuern(49, Klassen.LokEigenschaften.Geschwindigkeit, Stufe23)
            Prog_Lok51.Interval = T_500
        ElseIf _Prog51 = 502 Then
            _eb.lokSteuern(49, Klassen.LokEigenschaften.Geschwindigkeit, Stufe22)
        ElseIf _Prog51 = 503 Then
            _eb.lokSteuern(49, Klassen.LokEigenschaften.Geschwindigkeit, Stufe21)
        ElseIf _Prog51 = 504 Then
            _eb.lokSteuern(49, Klassen.LokEigenschaften.Geschwindigkeit, Stufe2)
        ElseIf _Prog51 = 505 Then
            _eb.lokSteuern(51, Klassen.LokEigenschaften.Geschwindigkeit, 0)

        Else
            _Prog51 = 0
            Prog_Lok51.Stop()
            Prog_Lok51.Interval = 200
            If Betriebsart = 1 Then
                SetProgramCounterLabel1(String.Empty)
            Else
                SetProgramCounterLabel(String.Empty)
            End If
        End If
        _Prog51 = _Prog51 + 1
    End Sub
    Private Sub HandleTimerElapsed64(sender As System.Object, e As System.EventArgs) Handles Prog_Lok52.Elapsed

        '*** Fahrprogramm für "nicht verwendet"
        '*** Datum: 23.02.2020

        'SetText(TextBox1, "E-Lok CE 6/8                                                               IBS: nein")
        'LoadImage(PictureBox1, "H:\\EB_Media\\LokFotos\\Baureihe_CE68b_01.jpg")
        GeschwindikeitenSetzen(52)

        Dim Stufe1, Stufe2, Stufe3, Stufe4 As Integer
        Dim Stufe11, Stufe12, Stufe13, Stufe14, Stufe21, Stufe22, Stufe23, Stufe24 As Integer
        Dim V_100, V_130, V_160, V_180, V_500 As Integer
        Dim T_100, T_130, T_160, T_180, T_500 As Integer
        Dim G_200 As Integer

        T_100 = _Betriebsparameter.Fahrparameter(52, KlausEBspecific.Betriebsparameter.FahrparameterEnum.T_100)
        T_130 = _Betriebsparameter.Fahrparameter(52, KlausEBspecific.Betriebsparameter.FahrparameterEnum.T_130)
        T_160 = _Betriebsparameter.Fahrparameter(52, KlausEBspecific.Betriebsparameter.FahrparameterEnum.T_160)
        T_180 = _Betriebsparameter.Fahrparameter(52, KlausEBspecific.Betriebsparameter.FahrparameterEnum.T_180)
        T_500 = _Betriebsparameter.Fahrparameter(52, KlausEBspecific.Betriebsparameter.FahrparameterEnum.T_500)
        V_100 = _Betriebsparameter.Fahrparameter(52, KlausEBspecific.Betriebsparameter.FahrparameterEnum.V_100)
        V_130 = _Betriebsparameter.Fahrparameter(52, KlausEBspecific.Betriebsparameter.FahrparameterEnum.V_130)
        V_160 = _Betriebsparameter.Fahrparameter(52, KlausEBspecific.Betriebsparameter.FahrparameterEnum.V_160)
        V_180 = _Betriebsparameter.Fahrparameter(52, KlausEBspecific.Betriebsparameter.FahrparameterEnum.V_180)
        V_500 = _Betriebsparameter.Fahrparameter(52, KlausEBspecific.Betriebsparameter.FahrparameterEnum.V_500)
        G_200 = _Betriebsparameter.Fahrparameter(52, KlausEBspecific.Betriebsparameter.FahrparameterEnum.G_200)

        If A_StopB = 1 Then
            V_100 = 8000
        End If

        Stufe1 = _LokStufen.Holen(52, 1)
        Stufe2 = _LokStufen.Holen(52, 2)
        Stufe3 = _LokStufen.Holen(52, 3)
        Stufe4 = _LokStufen.Holen(52, 4)

        If Stufe2 = 1 Then
            T_100 = T_100
            T_130 = T_130
            T_160 = T_160
            V_180 = V_180
        ElseIf Stufe2 = 2 Then
            T_100 = T_100 + 300
            T_130 = T_130 + 300
            T_160 = T_160 + 300
            V_180 = V_180 + 500
        ElseIf Stufe2 = 3 Then
            T_100 = T_100 + 500
            T_130 = T_130 + 500
            T_160 = T_160 + 500
            V_180 = V_180 + 1000
        ElseIf Stufe2 = 4 Then
            T_100 = T_100 + 700
            T_130 = T_130 + 700
            T_160 = T_160 + 700
            V_180 = V_180 + 1500
        ElseIf Stufe2 = 5 Then
            T_100 = T_100 + 900
            T_130 = T_130 + 900
            T_160 = T_160 + 900
            V_180 = V_180 + 2000
        ElseIf Stufe2 = 6 Then
            T_100 = T_100 + 1200
            T_130 = T_130 + 1200
            T_160 = T_160 + 1200
            V_180 = V_180 + 2500
        Else
            T_100 = T_100 + 1200
            T_130 = T_130 + 1200
            T_160 = T_160 + 1200
            V_180 = V_180 + 2500
        End If

        Stufe2 = Stufe1

        Stufe11 = Stufe1 + 1
        If Stufe11 > Stufe3 Then
            Stufe11 = Stufe3
        End If
        Stufe12 = Stufe1 + 2
        If Stufe12 > Stufe3 Then
            Stufe12 = Stufe3
        End If
        Stufe13 = Stufe1 + 3
        If Stufe13 > Stufe3 Then
            Stufe13 = Stufe3
        End If
        Stufe14 = Stufe1 + 4
        If Stufe14 > Stufe3 Then
            Stufe14 = Stufe3
        End If

        Stufe21 = Stufe2 + 1
        If Stufe21 > Stufe3 Then
            Stufe21 = Stufe3
        End If
        Stufe22 = Stufe2 + 2
        If Stufe22 > Stufe3 Then
            Stufe22 = Stufe3
        End If
        Stufe23 = Stufe2 + 3
        If Stufe23 > Stufe3 Then
            Stufe23 = Stufe3
        End If
        Stufe24 = Stufe2 + 4
        If Stufe24 > Stufe3 Then
            Stufe24 = Stufe3
        End If
        If G_200 > 0 Then
            If G_200 < Stufe4 Then
                G_200 = Stufe4
            End If
        Else
            G_200 = Stufe4
        End If

        If Betriebsart = 1 And (_GlsL52 = 3 Or _GlsL52 = 4) Then
            SetProgramCounterLabel1(_Prog52)
        Else
            SetProgramCounterLabel(_Prog52)
        End If

        ' Lok starten - Bahnhofsausfahrt

        If _Prog52 = 0 Then
            Prog_Lok52.Interval = 2000
        ElseIf _Prog52 = 1 Then
        ElseIf _Prog52 = 2 Then
            _Betriebsparameter.RundenErhoehen(52)
        ElseIf _Prog52 = 3 Then
        ElseIf _Prog52 = 4 Then
        ElseIf _Prog52 = 5 Then
        ElseIf _Prog52 = 6 Then

            ' Bahnhofsausfahrt

        ElseIf _Prog52 = 7 Then
            _eb.lokSteuern(52, Klassen.LokEigenschaften.Geschwindigkeit, Stufe1)
        ElseIf _Prog52 = 8 Then
            _eb.lokSteuern(52, Klassen.LokEigenschaften.Geschwindigkeit, Stufe11)
        ElseIf _Prog52 = 9 Then
            _eb.lokSteuern(52, Klassen.LokEigenschaften.Geschwindigkeit, Stufe12)
        ElseIf _Prog52 = 10 Then
            _eb.lokSteuern(52, Klassen.LokEigenschaften.Geschwindigkeit, Stufe13)
        ElseIf _Prog52 = 11 Then
            _eb.lokSteuern(52, Klassen.LokEigenschaften.Geschwindigkeit, Stufe14)
        ElseIf _Prog52 = 12 Then
            _eb.lokSteuern(52, Klassen.LokEigenschaften.Geschwindigkeit, Stufe3)

            ' Lok abstellen

        ElseIf _Prog52 = 50 Then
            Prog_Lok52.Interval = 2000
        ElseIf _Prog52 = 51 Then
        ElseIf _Prog52 = 52 Then
            If _Fahrzeugbeleuchtung2 < 2 Then
                _eb.lokSteuern(52, Klassen.LokEigenschaften.Hauptfunktion, 0) ' Licht aus
            End If

            ' Lok bremsen (Bahnhofseinfahrt Normalzug von links und von rechts)

        ElseIf _Prog52 = 100 Then
            Prog_Lok52.Interval = V_100
        ElseIf _Prog52 = 101 Then
            _eb.lokSteuern(52, Klassen.LokEigenschaften.Geschwindigkeit, Stufe24)
            Prog_Lok52.Interval = T_100
        ElseIf _Prog52 = 102 Then
            _eb.lokSteuern(52, Klassen.LokEigenschaften.Geschwindigkeit, Stufe23)
        ElseIf _Prog52 = 103 Then
            _eb.lokSteuern(52, Klassen.LokEigenschaften.Geschwindigkeit, Stufe22)
        ElseIf _Prog52 = 104 Then
            _eb.lokSteuern(52, Klassen.LokEigenschaften.Geschwindigkeit, Stufe21)
        ElseIf _Prog52 = 105 Then
            _eb.lokSteuern(52, Klassen.LokEigenschaften.Geschwindigkeit, Stufe2)

            ' Lok bremsen (Bahnhofseinfahrt Kurzzug von links)

        ElseIf _Prog52 = 130 Then
            Prog_Lok52.Interval = V_130
        ElseIf _Prog52 = 131 Then
            _eb.lokSteuern(52, Klassen.LokEigenschaften.Geschwindigkeit, Stufe24)
            Prog_Lok52.Interval = T_130
        ElseIf _Prog52 = 132 Then
            _eb.lokSteuern(52, Klassen.LokEigenschaften.Geschwindigkeit, Stufe23)
        ElseIf _Prog52 = 133 Then
            _eb.lokSteuern(52, Klassen.LokEigenschaften.Geschwindigkeit, Stufe22)
        ElseIf _Prog52 = 134 Then
            _eb.lokSteuern(52, Klassen.LokEigenschaften.Geschwindigkeit, Stufe21)
        ElseIf _Prog52 = 135 Then
            _eb.lokSteuern(52, Klassen.LokEigenschaften.Geschwindigkeit, Stufe2)
        ElseIf _Prog52 = 136 Then
            _eb.lokSteuern(52, Klassen.LokEigenschaften.Geschwindigkeit, 0)
        ElseIf _Prog52 = 137 Then
            Prog_Lok52.Interval = 2000
        ElseIf _Prog52 = 138 Then
            If _Fahrzeugbeleuchtung2 < 2 Then
                _eb.lokSteuern(52, Klassen.LokEigenschaften.Hauptfunktion, 0) ' Licht aus
            End If

            ' Lok bremsen (Bahnhofseinfahrt Kurzzug von rechts)

        ElseIf _Prog52 = 160 Then
            Prog_Lok52.Interval = V_160
        ElseIf _Prog52 = 161 Then
            _eb.lokSteuern(52, Klassen.LokEigenschaften.Geschwindigkeit, Stufe24)
            Prog_Lok52.Interval = T_160
        ElseIf _Prog52 = 162 Then
            _eb.lokSteuern(52, Klassen.LokEigenschaften.Geschwindigkeit, Stufe23)
        ElseIf _Prog52 = 163 Then
            _eb.lokSteuern(52, Klassen.LokEigenschaften.Geschwindigkeit, Stufe22)
        ElseIf _Prog52 = 164 Then
            _eb.lokSteuern(52, Klassen.LokEigenschaften.Geschwindigkeit, Stufe21)
        ElseIf _Prog52 = 165 Then
            _eb.lokSteuern(52, Klassen.LokEigenschaften.Geschwindigkeit, Stufe2)
        ElseIf _Prog52 = 166 Then
            _eb.lokSteuern(52, Klassen.LokEigenschaften.Geschwindigkeit, 0)
        ElseIf _Prog52 = 167 Then
            Prog_Lok52.Interval = 2000
        ElseIf _Prog52 = 168 Then
            If _Fahrzeugbeleuchtung2 < 2 Then
                _eb.lokSteuern(52, Klassen.LokEigenschaften.Hauptfunktion, 0) ' Licht aus
            End If

            ' Rangierzug

        ElseIf _Prog52 = 180 Then
            _eb.lokSteuern(52, Klassen.LokEigenschaften.Geschwindigkeit, 2)
            Prog_Lok52.Interval = V_180
        ElseIf _Prog52 = 181 Then
            Prog_Lok52.Interval = T_180
            _eb.lokSteuern(52, Klassen.LokEigenschaften.Geschwindigkeit, 1)
        ElseIf _Prog52 = 182 Then
            _eb.lokSteuern(52, Klassen.LokEigenschaften.Geschwindigkeit, 0)

            ' Tunnelausfahrt

        ElseIf _Prog52 = 200 Then ' Kontakt 1.2 <- (bergauf)
            _eb.lokSteuern(52, Klassen.LokEigenschaften.Geschwindigkeit, G_200)
            Prog_Lok52.Interval = 2000
        ElseIf _Prog52 = 201 Then
        ElseIf _Prog52 = 202 Then
        ElseIf _Prog52 = 203 Then
        ElseIf _Prog52 = 204 Then
        ElseIf _Prog52 = 205 Then
            If Stufe4 < Stufe3 Then
                _eb.lokSteuern(52, Klassen.LokEigenschaften.Geschwindigkeit, Stufe3)
            Else
                _eb.lokSteuern(52, Klassen.LokEigenschaften.Geschwindigkeit, Stufe4)
            End If

        ElseIf _Prog52 = 220 Then ' Kontakt 3.1 -> (hinter dem Martinstor bergauf)
            Prog_Lok52.Interval = 2000
        ElseIf _Prog52 = 221 Then
        ElseIf _Prog52 = 222 Then

        ElseIf _Prog52 = 240 Then ' Kontakt 3.7 <- (hinter der Brücke bergauf)
            Prog_Lok52.Interval = 2000
        ElseIf _Prog52 = 241 Then
        ElseIf _Prog52 = 242 Then

        ElseIf _Prog52 = 260 Then ' Kontakt 3.3 (links bzw vor der Brücke)
            Prog_Lok52.Interval = 2000
        ElseIf _Prog52 = 261 Then
        ElseIf _Prog52 = 262 Then

        ElseIf _Prog52 = 600 Then ' Kontakt 3.5 <- (unter der Burg)
            Prog_Lok52.Interval = 2000
        ElseIf _Prog52 = 601 Then
        ElseIf _Prog52 = 602 Then
            _eb.lokSteuern(52, Klassen.LokEigenschaften.Geschwindigkeit, Stufe3)

        ElseIf _Prog52 = 620 Then ' Kontakt 3.7 -> (hinter der Brücke bergab)
            Prog_Lok52.Interval = 2000
        ElseIf _Prog52 = 621 Then
        ElseIf _Prog52 = 622 Then

        ElseIf _Prog52 = 640 Then ' Kontakt 3.1 <- Talfahrt
            Prog_Lok52.Interval = 2000
        ElseIf _Prog52 = 641 Then
        ElseIf _Prog52 = 642 Then

        ElseIf _Prog52 = 660 Then ' Kontakt 1.2 -> Talfahrt
            Prog_Lok52.Interval = 2000
        ElseIf _Prog52 = 661 Then
        ElseIf _Prog52 = 662 Then

        ElseIf _Prog52 = 700 Then ' Kontakt 0.4 <- Diagonale
            Prog_Lok52.Interval = 2000
        ElseIf _Prog52 = 701 Then
        ElseIf _Prog52 = 702 Then

            ' Zindelstein

        ElseIf _Prog52 = 500 Then
            Prog_Lok52.Interval = V_500
        ElseIf _Prog52 = 501 Then
            _eb.lokSteuern(52, Klassen.LokEigenschaften.Geschwindigkeit, Stufe23)
            Prog_Lok52.Interval = T_500
        ElseIf _Prog52 = 502 Then
            _eb.lokSteuern(52, Klassen.LokEigenschaften.Geschwindigkeit, Stufe22)
        ElseIf _Prog52 = 503 Then
            _eb.lokSteuern(52, Klassen.LokEigenschaften.Geschwindigkeit, Stufe21)
        ElseIf _Prog52 = 504 Then
            _eb.lokSteuern(52, Klassen.LokEigenschaften.Geschwindigkeit, Stufe2)
        ElseIf _Prog52 = 505 Then
            _eb.lokSteuern(52, Klassen.LokEigenschaften.Geschwindigkeit, 0)

        Else
            _Prog52 = 0
            Prog_Lok52.Stop()
            Prog_Lok52.Interval = 200
            If Betriebsart = 1 Then
                SetProgramCounterLabel1(String.Empty)
            Else
                SetProgramCounterLabel(String.Empty)
            End If
        End If
        _Prog52 = _Prog52 + 1
    End Sub
    Private Sub HandleTimerElapsed65(sender As System.Object, e As System.EventArgs) Handles Prog_Lok53.Elapsed

        '*** Fahrprogramm "nicht verwendet"
        '*** Datum: 23.02.2020

        'SetText(TextBox1, "E-Lok CE 6/8                                                         IBS: nein")
        'LoadImage(PictureBox1, "H:\\EB_Media\\LokFotos\\Baureihe_CE68b_01.jpg")
        GeschwindikeitenSetzen(53)

        Dim Stufe1, Stufe2, Stufe3, Stufe4 As Integer
        Dim Stufe11, Stufe12, Stufe13, Stufe14, Stufe21, Stufe22, Stufe23, Stufe24 As Integer
        Dim V_100, V_130, V_160, V_180, V_500 As Integer
        Dim T_100, T_130, T_160, T_180, T_500 As Integer
        Dim G_200 As Integer

        T_100 = _Betriebsparameter.Fahrparameter(53, KlausEBspecific.Betriebsparameter.FahrparameterEnum.T_100)
        T_130 = _Betriebsparameter.Fahrparameter(53, KlausEBspecific.Betriebsparameter.FahrparameterEnum.T_130)
        T_160 = _Betriebsparameter.Fahrparameter(53, KlausEBspecific.Betriebsparameter.FahrparameterEnum.T_160)
        T_180 = _Betriebsparameter.Fahrparameter(53, KlausEBspecific.Betriebsparameter.FahrparameterEnum.T_180)
        T_500 = _Betriebsparameter.Fahrparameter(53, KlausEBspecific.Betriebsparameter.FahrparameterEnum.T_500)
        V_100 = _Betriebsparameter.Fahrparameter(53, KlausEBspecific.Betriebsparameter.FahrparameterEnum.V_100)
        V_130 = _Betriebsparameter.Fahrparameter(53, KlausEBspecific.Betriebsparameter.FahrparameterEnum.V_130)
        V_160 = _Betriebsparameter.Fahrparameter(53, KlausEBspecific.Betriebsparameter.FahrparameterEnum.V_160)
        V_180 = _Betriebsparameter.Fahrparameter(53, KlausEBspecific.Betriebsparameter.FahrparameterEnum.V_180)
        V_500 = _Betriebsparameter.Fahrparameter(53, KlausEBspecific.Betriebsparameter.FahrparameterEnum.V_500)
        G_200 = _Betriebsparameter.Fahrparameter(53, KlausEBspecific.Betriebsparameter.FahrparameterEnum.G_200)

        If A_StopB = 1 Then
            V_100 = 8000
        End If

        Stufe1 = _LokStufen.Holen(53, 1)
        Stufe2 = _LokStufen.Holen(53, 2)
        Stufe3 = _LokStufen.Holen(53, 3)
        Stufe4 = _LokStufen.Holen(53, 4)

        If Stufe2 = 1 Then
            T_100 = T_100
            T_130 = T_130
            T_160 = T_160
            V_180 = V_180
        ElseIf Stufe2 = 2 Then
            T_100 = T_100 + 300
            T_130 = T_130 + 300
            T_160 = T_160 + 300
            V_180 = V_180 + 500
        ElseIf Stufe2 = 3 Then
            T_100 = T_100 + 500
            T_130 = T_130 + 500
            T_160 = T_160 + 500
            V_180 = V_180 + 1000
        ElseIf Stufe2 = 4 Then
            T_100 = T_100 + 700
            T_130 = T_130 + 700
            T_160 = T_160 + 700
            V_180 = V_180 + 1500
        ElseIf Stufe2 = 5 Then
            T_100 = T_100 + 900
            T_130 = T_130 + 900
            T_160 = T_160 + 900
            V_180 = V_180 + 2000
        ElseIf Stufe2 = 6 Then
            T_100 = T_100 + 1200
            T_130 = T_130 + 1200
            T_160 = T_160 + 1200
            V_180 = V_180 + 2500
        Else
            T_100 = T_100 + 1200
            T_130 = T_130 + 1200
            T_160 = T_160 + 1200
            V_180 = V_180 + 2500
        End If

        Stufe2 = Stufe1

        Stufe11 = Stufe1 + 1
        If Stufe11 > Stufe3 Then
            Stufe11 = Stufe3
        End If
        Stufe12 = Stufe1 + 2
        If Stufe12 > Stufe3 Then
            Stufe12 = Stufe3
        End If
        Stufe13 = Stufe1 + 3
        If Stufe13 > Stufe3 Then
            Stufe13 = Stufe3
        End If
        Stufe14 = Stufe1 + 4
        If Stufe14 > Stufe3 Then
            Stufe14 = Stufe3
        End If

        Stufe21 = Stufe2 + 1
        If Stufe21 > Stufe3 Then
            Stufe21 = Stufe3
        End If
        Stufe22 = Stufe2 + 2
        If Stufe22 > Stufe3 Then
            Stufe22 = Stufe3
        End If
        Stufe23 = Stufe2 + 3
        If Stufe23 > Stufe3 Then
            Stufe23 = Stufe3
        End If
        Stufe24 = Stufe2 + 4
        If Stufe24 > Stufe3 Then
            Stufe24 = Stufe3
        End If
        If G_200 > 0 Then
            If G_200 < Stufe4 Then
                G_200 = Stufe4
            End If
        Else
            G_200 = Stufe4
        End If

        If Betriebsart = 1 And (_GlsL53 = 3 Or _GlsL53 = 4) Then
            SetProgramCounterLabel1(_Prog53)
        Else
            SetProgramCounterLabel(_Prog53)
        End If

        ' Lok starten - Bahnhofsausfahrt

        If _Prog53 = 0 Then
            Prog_Lok53.Interval = 2000
        ElseIf _Prog53 = 1 Then
        ElseIf _Prog53 = 2 Then
            _Betriebsparameter.RundenErhoehen(53)
        ElseIf _Prog53 = 3 Then
        ElseIf _Prog53 = 4 Then
        ElseIf _Prog53 = 5 Then
        ElseIf _Prog53 = 6 Then

            ' Bahnhofsausfahrt

        ElseIf _Prog53 = 7 Then
            _eb.lokSteuern(53, Klassen.LokEigenschaften.Geschwindigkeit, Stufe1)
        ElseIf _Prog53 = 8 Then
            _eb.lokSteuern(53, Klassen.LokEigenschaften.Geschwindigkeit, Stufe11)
        ElseIf _Prog53 = 9 Then
            _eb.lokSteuern(53, Klassen.LokEigenschaften.Geschwindigkeit, Stufe12)
        ElseIf _Prog53 = 10 Then
            _eb.lokSteuern(53, Klassen.LokEigenschaften.Geschwindigkeit, Stufe13)
        ElseIf _Prog53 = 11 Then
            _eb.lokSteuern(53, Klassen.LokEigenschaften.Geschwindigkeit, Stufe14)
        ElseIf _Prog53 = 12 Then
            _eb.lokSteuern(53, Klassen.LokEigenschaften.Geschwindigkeit, Stufe3)

            ' Lok abstellen

        ElseIf _Prog53 = 50 Then
            Prog_Lok53.Interval = 2000
        ElseIf _Prog53 = 51 Then
        ElseIf _Prog53 = 52 Then
            If _Fahrzeugbeleuchtung2 < 2 Then
                _eb.lokSteuern(53, Klassen.LokEigenschaften.Hauptfunktion, 0) ' Licht aus
            End If

            ' Lok bremsen (Bahnhofseinfahrt Normalzug von links und von rechts)

        ElseIf _Prog53 = 100 Then
            Prog_Lok53.Interval = V_100
        ElseIf _Prog53 = 101 Then
            _eb.lokSteuern(53, Klassen.LokEigenschaften.Geschwindigkeit, Stufe24)
            Prog_Lok53.Interval = T_100
        ElseIf _Prog53 = 102 Then
            _eb.lokSteuern(53, Klassen.LokEigenschaften.Geschwindigkeit, Stufe23)
        ElseIf _Prog53 = 103 Then
            _eb.lokSteuern(53, Klassen.LokEigenschaften.Geschwindigkeit, Stufe22)
        ElseIf _Prog53 = 104 Then
            _eb.lokSteuern(53, Klassen.LokEigenschaften.Geschwindigkeit, Stufe21)
        ElseIf _Prog53 = 105 Then
            _eb.lokSteuern(53, Klassen.LokEigenschaften.Geschwindigkeit, Stufe2)

            ' Lok bremsen (Bahnhofseinfahrt Kurzzug von links)

        ElseIf _Prog53 = 130 Then
            Prog_Lok53.Interval = V_130
        ElseIf _Prog53 = 131 Then
            _eb.lokSteuern(53, Klassen.LokEigenschaften.Geschwindigkeit, Stufe24)
            Prog_Lok53.Interval = T_130
        ElseIf _Prog53 = 132 Then
            _eb.lokSteuern(53, Klassen.LokEigenschaften.Geschwindigkeit, Stufe23)
        ElseIf _Prog53 = 133 Then
            _eb.lokSteuern(53, Klassen.LokEigenschaften.Geschwindigkeit, Stufe22)
        ElseIf _Prog53 = 134 Then
            _eb.lokSteuern(53, Klassen.LokEigenschaften.Geschwindigkeit, Stufe21)
        ElseIf _Prog53 = 135 Then
            _eb.lokSteuern(53, Klassen.LokEigenschaften.Geschwindigkeit, Stufe2)
        ElseIf _Prog53 = 136 Then
            _eb.lokSteuern(53, Klassen.LokEigenschaften.Geschwindigkeit, 0)
        ElseIf _Prog53 = 137 Then
            Prog_Lok53.Interval = 2000
        ElseIf _Prog53 = 138 Then
            If _Fahrzeugbeleuchtung2 < 2 Then
                _eb.lokSteuern(53, Klassen.LokEigenschaften.Hauptfunktion, 0) ' Licht aus
            End If

            ' Lok bremsen (Bahnhofseinfahrt Kurzzug von rechts)

        ElseIf _Prog53 = 160 Then
            Prog_Lok53.Interval = V_160
        ElseIf _Prog53 = 161 Then
            _eb.lokSteuern(53, Klassen.LokEigenschaften.Geschwindigkeit, Stufe24)
            Prog_Lok53.Interval = T_160
        ElseIf _Prog53 = 162 Then
            _eb.lokSteuern(53, Klassen.LokEigenschaften.Geschwindigkeit, Stufe23)
        ElseIf _Prog53 = 163 Then
            _eb.lokSteuern(53, Klassen.LokEigenschaften.Geschwindigkeit, Stufe22)
        ElseIf _Prog53 = 164 Then
            _eb.lokSteuern(53, Klassen.LokEigenschaften.Geschwindigkeit, Stufe21)
        ElseIf _Prog53 = 165 Then
            _eb.lokSteuern(53, Klassen.LokEigenschaften.Geschwindigkeit, Stufe2)
        ElseIf _Prog53 = 166 Then
            _eb.lokSteuern(53, Klassen.LokEigenschaften.Geschwindigkeit, 0)
        ElseIf _Prog53 = 167 Then
            Prog_Lok53.Interval = 2000
        ElseIf _Prog53 = 168 Then
            If _Fahrzeugbeleuchtung2 < 2 Then
                _eb.lokSteuern(53, Klassen.LokEigenschaften.Hauptfunktion, 0) ' Licht aus
            End If

            ' Rangierzug

        ElseIf _Prog53 = 180 Then
            _eb.lokSteuern(53, Klassen.LokEigenschaften.Geschwindigkeit, 2)
            Prog_Lok53.Interval = V_180
        ElseIf _Prog53 = 181 Then
            Prog_Lok53.Interval = T_180
            _eb.lokSteuern(53, Klassen.LokEigenschaften.Geschwindigkeit, 1)
        ElseIf _Prog53 = 182 Then
            _eb.lokSteuern(53, Klassen.LokEigenschaften.Geschwindigkeit, 0)

            ' Tunnelausfahrt

        ElseIf _Prog53 = 200 Then ' Kontakt 1.2 <- (bergauf)
            _eb.lokSteuern(53, Klassen.LokEigenschaften.Geschwindigkeit, G_200)
            Prog_Lok53.Interval = 2000
        ElseIf _Prog53 = 201 Then
        ElseIf _Prog53 = 202 Then
        ElseIf _Prog53 = 203 Then
        ElseIf _Prog53 = 204 Then
        ElseIf _Prog53 = 205 Then
            If Stufe4 < Stufe3 Then
                _eb.lokSteuern(53, Klassen.LokEigenschaften.Geschwindigkeit, Stufe3)
            Else
                _eb.lokSteuern(53, Klassen.LokEigenschaften.Geschwindigkeit, Stufe4)
            End If

        ElseIf _Prog53 = 220 Then ' Kontakt 3.1 -> (hinter dem Martinstor bergauf)
            Prog_Lok53.Interval = 2000
        ElseIf _Prog53 = 221 Then
        ElseIf _Prog53 = 222 Then

        ElseIf _Prog53 = 240 Then ' Kontakt 3.7 <- (hinter der Brücke bergauf)
            Prog_Lok53.Interval = 2000
        ElseIf _Prog53 = 241 Then
        ElseIf _Prog53 = 242 Then

        ElseIf _Prog53 = 260 Then ' Kontakt 3.3 (links bzw vor der Brücke)
            Prog_Lok53.Interval = 2000
        ElseIf _Prog53 = 261 Then
        ElseIf _Prog53 = 262 Then
            _eb.lokSteuern(53, Klassen.LokEigenschaften.Geschwindigkeit, Stufe3)

        ElseIf _Prog53 = 600 Then ' Kontakt 3.5 <- (unter der Burg)
            Prog_Lok53.Interval = 2000
        ElseIf _Prog53 = 601 Then
        ElseIf _Prog53 = 602 Then

        ElseIf _Prog53 = 620 Then ' Kontakt 3.7 -> (hinter der Brücke bergab)
            Prog_Lok53.Interval = 2000
        ElseIf _Prog53 = 621 Then
        ElseIf _Prog53 = 622 Then

        ElseIf _Prog53 = 640 Then ' Kontakt 3.1 <- Talfahrt
            Prog_Lok53.Interval = 2000
        ElseIf _Prog53 = 641 Then
        ElseIf _Prog53 = 642 Then

        ElseIf _Prog53 = 660 Then ' Kontakt 1.2 -> Talfahrt
            Prog_Lok53.Interval = 2000
        ElseIf _Prog53 = 661 Then
        ElseIf _Prog53 = 662 Then

        ElseIf _Prog53 = 700 Then ' Kontakt 0.4 <- Diagonale
            Prog_Lok53.Interval = 2000
        ElseIf _Prog53 = 701 Then
        ElseIf _Prog53 = 702 Then

            ' Zindelstein

        ElseIf _Prog53 = 500 Then
            Prog_Lok53.Interval = V_500
        ElseIf _Prog53 = 501 Then
            _eb.lokSteuern(53, Klassen.LokEigenschaften.Geschwindigkeit, Stufe23)
            Prog_Lok53.Interval = T_500
        ElseIf _Prog53 = 502 Then
            _eb.lokSteuern(53, Klassen.LokEigenschaften.Geschwindigkeit, Stufe22)
        ElseIf _Prog53 = 503 Then
            _eb.lokSteuern(53, Klassen.LokEigenschaften.Geschwindigkeit, Stufe21)
        ElseIf _Prog53 = 504 Then
            _eb.lokSteuern(53, Klassen.LokEigenschaften.Geschwindigkeit, Stufe2)
        ElseIf _Prog53 = 505 Then
            _eb.lokSteuern(53, Klassen.LokEigenschaften.Geschwindigkeit, 0)

        Else
            _Prog53 = 0
            Prog_Lok53.Stop()
            Prog_Lok53.Interval = 200
            If Betriebsart = 1 Then
                SetProgramCounterLabel1(String.Empty)
            Else
                SetProgramCounterLabel(String.Empty)
            End If
        End If
        _Prog53 = _Prog53 + 1
    End Sub
    Private Sub HandleTimerElapsed66(sender As System.Object, e As System.EventArgs) Handles Prog_Lok54.Elapsed

        '*** Fahrprogramm Triebwagen 133 009
        '*** Datum: 23.02.2020

        SetText(TextBox1, "Triebwagen 133 009                                                      IBS: nein")
        LoadImage(PictureBox1, "H:\\EB_Media\\LokFotos\\Baureihe_133_04.jpg")
        GeschwindikeitenSetzen(54)

        Dim Stufe1, Stufe2, Stufe3, Stufe4 As Integer
        Dim Stufe11, Stufe12, Stufe13, Stufe14, Stufe21, Stufe22, Stufe23, Stufe24 As Integer
        Dim V_100, V_130, V_160, V_180, V_500 As Integer
        Dim T_100, T_130, T_160, T_180, T_500 As Integer
        Dim G_200 As Integer

        T_100 = _Betriebsparameter.Fahrparameter(54, KlausEBspecific.Betriebsparameter.FahrparameterEnum.T_100)
        T_130 = _Betriebsparameter.Fahrparameter(54, KlausEBspecific.Betriebsparameter.FahrparameterEnum.T_130)
        T_160 = _Betriebsparameter.Fahrparameter(54, KlausEBspecific.Betriebsparameter.FahrparameterEnum.T_160)
        T_180 = _Betriebsparameter.Fahrparameter(54, KlausEBspecific.Betriebsparameter.FahrparameterEnum.T_180)
        T_500 = _Betriebsparameter.Fahrparameter(54, KlausEBspecific.Betriebsparameter.FahrparameterEnum.T_500)
        V_100 = _Betriebsparameter.Fahrparameter(54, KlausEBspecific.Betriebsparameter.FahrparameterEnum.V_100)
        V_130 = _Betriebsparameter.Fahrparameter(54, KlausEBspecific.Betriebsparameter.FahrparameterEnum.V_130)
        V_160 = _Betriebsparameter.Fahrparameter(54, KlausEBspecific.Betriebsparameter.FahrparameterEnum.V_160)
        V_180 = _Betriebsparameter.Fahrparameter(54, KlausEBspecific.Betriebsparameter.FahrparameterEnum.V_180)
        V_500 = _Betriebsparameter.Fahrparameter(54, KlausEBspecific.Betriebsparameter.FahrparameterEnum.V_500)
        G_200 = _Betriebsparameter.Fahrparameter(54, KlausEBspecific.Betriebsparameter.FahrparameterEnum.G_200)

        If A_StopB = 1 Then
            V_100 = 8000
        End If

        Stufe1 = _LokStufen.Holen(54, 1)
        Stufe2 = _LokStufen.Holen(54, 2)
        Stufe3 = _LokStufen.Holen(54, 3)
        Stufe4 = _LokStufen.Holen(54, 4)

        If Stufe2 = 1 Then
            T_100 = T_100
            T_130 = T_130
            T_160 = T_160
            V_180 = V_180
        ElseIf Stufe2 = 2 Then
            T_100 = T_100 + 300
            T_130 = T_130 + 300
            T_160 = T_160 + 300
            V_180 = V_180 + 500
        ElseIf Stufe2 = 3 Then
            T_100 = T_100 + 500
            T_130 = T_130 + 500
            T_160 = T_160 + 500
            V_180 = V_180 + 1000
        ElseIf Stufe2 = 4 Then
            T_100 = T_100 + 700
            T_130 = T_130 + 700
            T_160 = T_160 + 700
            V_180 = V_180 + 1500
        ElseIf Stufe2 = 5 Then
            T_100 = T_100 + 900
            T_130 = T_130 + 900
            T_160 = T_160 + 900
            V_180 = V_180 + 2000
        ElseIf Stufe2 = 6 Then
            T_100 = T_100 + 1200
            T_130 = T_130 + 1200
            T_160 = T_160 + 1200
            V_180 = V_180 + 2500
        Else
            T_100 = T_100 + 1200
            T_130 = T_130 + 1200
            T_160 = T_160 + 1200
            V_180 = V_180 + 2500
        End If

        Stufe2 = Stufe1

        Stufe11 = Stufe1 + 1
        If Stufe11 > Stufe3 Then
            Stufe11 = Stufe3
        End If
        Stufe12 = Stufe1 + 2
        If Stufe12 > Stufe3 Then
            Stufe12 = Stufe3
        End If
        Stufe13 = Stufe1 + 3
        If Stufe13 > Stufe3 Then
            Stufe13 = Stufe3
        End If
        Stufe14 = Stufe1 + 4
        If Stufe14 > Stufe3 Then
            Stufe14 = Stufe3
        End If

        Stufe21 = Stufe2 + 1
        If Stufe21 > Stufe3 Then
            Stufe21 = Stufe3
        End If
        Stufe22 = Stufe2 + 2
        If Stufe22 > Stufe3 Then
            Stufe22 = Stufe3
        End If
        Stufe23 = Stufe2 + 3
        If Stufe23 > Stufe3 Then
            Stufe23 = Stufe3
        End If
        Stufe24 = Stufe2 + 4
        If Stufe24 > Stufe3 Then
            Stufe24 = Stufe3
        End If
        If G_200 > 0 Then
            If G_200 < Stufe4 Then
                G_200 = Stufe4
            End If
        Else
            G_200 = Stufe4
        End If

        If Betriebsart = 1 And (_GlsL54 = 3 Or _GlsL54 = 4) Then
            SetProgramCounterLabel1(_Prog54)
        Else
            SetProgramCounterLabel(_Prog54)
        End If

        ' Lok starten - Bahnhofsausfahrt

        If _Prog54 = 0 Then
            Prog_Lok54.Interval = 2000
        ElseIf _Prog54 = 1 Then
        ElseIf _Prog54 = 2 Then
            _Betriebsparameter.RundenErhoehen(54)
        ElseIf _Prog54 = 3 Then
        ElseIf _Prog54 = 4 Then
        ElseIf _Prog54 = 5 Then
        ElseIf _Prog54 = 6 Then

            ' Bahnhofsausfahrt

        ElseIf _Prog54 = 7 Then
            _eb.lokSteuern(54, Klassen.LokEigenschaften.Geschwindigkeit, Stufe1)
        ElseIf _Prog54 = 8 Then
            _eb.lokSteuern(54, Klassen.LokEigenschaften.Geschwindigkeit, Stufe11)
        ElseIf _Prog54 = 9 Then
            _eb.lokSteuern(54, Klassen.LokEigenschaften.Geschwindigkeit, Stufe12)
        ElseIf _Prog54 = 10 Then
            _eb.lokSteuern(54, Klassen.LokEigenschaften.Geschwindigkeit, Stufe13)
        ElseIf _Prog54 = 11 Then
            _eb.lokSteuern(54, Klassen.LokEigenschaften.Geschwindigkeit, Stufe14)
        ElseIf _Prog54 = 12 Then
            _eb.lokSteuern(54, Klassen.LokEigenschaften.Geschwindigkeit, Stufe3)

            ' Lok abstellen

        ElseIf _Prog54 = 50 Then
            Prog_Lok54.Interval = 2000
        ElseIf _Prog54 = 51 Then ' *** Lok hat keine Lichtfunktion
        ElseIf _Prog54 = 52 Then

            ' Lok bremsen (Bahnhofseinfahrt Normalzug von links und von rechts)

        ElseIf _Prog54 = 100 Then
            Prog_Lok54.Interval = V_100
        ElseIf _Prog54 = 101 Then
            _eb.lokSteuern(54, Klassen.LokEigenschaften.Geschwindigkeit, Stufe24)
            Prog_Lok54.Interval = T_100
        ElseIf _Prog54 = 102 Then
            _eb.lokSteuern(54, Klassen.LokEigenschaften.Geschwindigkeit, Stufe23)
        ElseIf _Prog54 = 103 Then
            _eb.lokSteuern(54, Klassen.LokEigenschaften.Geschwindigkeit, Stufe22)
        ElseIf _Prog54 = 104 Then
            _eb.lokSteuern(54, Klassen.LokEigenschaften.Geschwindigkeit, Stufe21)
        ElseIf _Prog54 = 105 Then
            _eb.lokSteuern(54, Klassen.LokEigenschaften.Geschwindigkeit, Stufe2)

            ' Lok bremsen (Bahnhofseinfahrt Kurzzug von links)

        ElseIf _Prog54 = 130 Then
            Prog_Lok54.Interval = V_130
        ElseIf _Prog54 = 131 Then
            _eb.lokSteuern(54, Klassen.LokEigenschaften.Geschwindigkeit, Stufe24)
            Prog_Lok54.Interval = T_130
        ElseIf _Prog54 = 132 Then
            _eb.lokSteuern(54, Klassen.LokEigenschaften.Geschwindigkeit, Stufe23)
        ElseIf _Prog54 = 133 Then
            _eb.lokSteuern(54, Klassen.LokEigenschaften.Geschwindigkeit, Stufe22)
        ElseIf _Prog54 = 134 Then
            _eb.lokSteuern(54, Klassen.LokEigenschaften.Geschwindigkeit, Stufe21)
        ElseIf _Prog54 = 135 Then
            _eb.lokSteuern(54, Klassen.LokEigenschaften.Geschwindigkeit, Stufe2)
        ElseIf _Prog54 = 136 Then
            _eb.lokSteuern(54, Klassen.LokEigenschaften.Geschwindigkeit, 0)
        ElseIf _Prog54 = 137 Then
            Prog_Lok54.Interval = 2000
        ElseIf _Prog54 = 138 Then
            If _Fahrzeugbeleuchtung2 < 2 Then
                _eb.lokSteuern(54, Klassen.LokEigenschaften.Hauptfunktion, 0) ' Licht aus
            End If

            ' Lok bremsen (Bahnhofseinfahrt Kurzzug von rechts)

        ElseIf _Prog54 = 160 Then
            Prog_Lok54.Interval = V_160
        ElseIf _Prog54 = 161 Then
            _eb.lokSteuern(54, Klassen.LokEigenschaften.Geschwindigkeit, Stufe24)
            Prog_Lok54.Interval = T_160
        ElseIf _Prog54 = 162 Then
            _eb.lokSteuern(54, Klassen.LokEigenschaften.Geschwindigkeit, Stufe23)
        ElseIf _Prog54 = 163 Then
            _eb.lokSteuern(54, Klassen.LokEigenschaften.Geschwindigkeit, Stufe22)
        ElseIf _Prog54 = 164 Then
            _eb.lokSteuern(54, Klassen.LokEigenschaften.Geschwindigkeit, Stufe21)
        ElseIf _Prog54 = 165 Then
            _eb.lokSteuern(54, Klassen.LokEigenschaften.Geschwindigkeit, Stufe2)
        ElseIf _Prog54 = 166 Then
            _eb.lokSteuern(54, Klassen.LokEigenschaften.Geschwindigkeit, 0)
        ElseIf _Prog54 = 167 Then
            Prog_Lok54.Interval = 2000
        ElseIf _Prog54 = 168 Then
            If _Fahrzeugbeleuchtung2 < 2 Then
                _eb.lokSteuern(54, Klassen.LokEigenschaften.Hauptfunktion, 0) ' Licht aus
            End If

            ' Rangierzug

        ElseIf _Prog54 = 180 Then
            _eb.lokSteuern(54, Klassen.LokEigenschaften.Geschwindigkeit, 2)
            Prog_Lok54.Interval = V_180
        ElseIf _Prog54 = 181 Then
            Prog_Lok54.Interval = T_180
            _eb.lokSteuern(54, Klassen.LokEigenschaften.Geschwindigkeit, 1)
        ElseIf _Prog54 = 182 Then
            _eb.lokSteuern(54, Klassen.LokEigenschaften.Geschwindigkeit, 0)

            ' Tunnelausfahrt

        ElseIf _Prog54 = 200 Then ' Kontakt 1.2 <- (bergauf)
            _eb.lokSteuern(54, Klassen.LokEigenschaften.Geschwindigkeit, G_200)
            Prog_Lok54.Interval = 2000
        ElseIf _Prog54 = 201 Then
        ElseIf _Prog54 = 202 Then
        ElseIf _Prog54 = 203 Then
        ElseIf _Prog54 = 204 Then
        ElseIf _Prog54 = 205 Then
            If Stufe4 < Stufe3 Then
                _eb.lokSteuern(54, Klassen.LokEigenschaften.Geschwindigkeit, Stufe3)
            Else
                _eb.lokSteuern(54, Klassen.LokEigenschaften.Geschwindigkeit, Stufe4)
            End If

        ElseIf _Prog54 = 220 Then ' Kontakt 3.1 -> (hinter dem Martinstor bergauf)
            Prog_Lok54.Interval = 2000
        ElseIf _Prog54 = 221 Then
        ElseIf _Prog54 = 222 Then

        ElseIf _Prog54 = 240 Then ' Kontakt 3.7 <- (hinter der Brücke bergauf)
            Prog_Lok54.Interval = 2000
        ElseIf _Prog54 = 241 Then
        ElseIf _Prog54 = 242 Then

        ElseIf _Prog54 = 260 Then ' Kontakt 3.3 (links bzw vor der Brücke)
            Prog_Lok54.Interval = 2000
        ElseIf _Prog54 = 261 Then
        ElseIf _Prog54 = 262 Then
            _eb.lokSteuern(54, Klassen.LokEigenschaften.Geschwindigkeit, Stufe3)

        ElseIf _Prog54 = 600 Then ' Kontakt 3.5 <- (unter der Burg)
            Prog_Lok54.Interval = 2000
        ElseIf _Prog54 = 601 Then
        ElseIf _Prog54 = 602 Then

        ElseIf _Prog54 = 620 Then ' Kontakt 3.7 -> (hinter der Brücke bergab)
            Prog_Lok54.Interval = 2000
        ElseIf _Prog54 = 621 Then
        ElseIf _Prog54 = 622 Then

        ElseIf _Prog54 = 640 Then ' Kontakt 3.1 <- Talfahrt
            Prog_Lok54.Interval = 2000
        ElseIf _Prog54 = 641 Then
        ElseIf _Prog54 = 642 Then

        ElseIf _Prog54 = 660 Then ' Kontakt 1.2 -> Talfahrt
            Prog_Lok54.Interval = 2000
        ElseIf _Prog54 = 661 Then
        ElseIf _Prog54 = 662 Then

        ElseIf _Prog54 = 700 Then ' Kontakt 0.4 <- Diagonale
            Prog_Lok54.Interval = 2000
        ElseIf _Prog54 = 701 Then
        ElseIf _Prog54 = 702 Then

            ' Zindelstein

        ElseIf _Prog54 = 500 Then
            Prog_Lok54.Interval = V_500
        ElseIf _Prog54 = 501 Then
            _eb.lokSteuern(54, Klassen.LokEigenschaften.Geschwindigkeit, Stufe23)
            Prog_Lok54.Interval = T_500
        ElseIf _Prog54 = 502 Then
            _eb.lokSteuern(54, Klassen.LokEigenschaften.Geschwindigkeit, Stufe22)
        ElseIf _Prog54 = 503 Then
            _eb.lokSteuern(54, Klassen.LokEigenschaften.Geschwindigkeit, Stufe21)
        ElseIf _Prog54 = 504 Then
            _eb.lokSteuern(54, Klassen.LokEigenschaften.Geschwindigkeit, Stufe2)
        ElseIf _Prog54 = 505 Then
            _eb.lokSteuern(54, Klassen.LokEigenschaften.Geschwindigkeit, 0)

        Else
            _Prog54 = 0
            Prog_Lok54.Stop()
            Prog_Lok54.Interval = 200
            If Betriebsart = 1 Then
                SetProgramCounterLabel1(String.Empty)
            Else
                SetProgramCounterLabel(String.Empty)
            End If
        End If
        _Prog54 = _Prog54 + 1
    End Sub
    Private Sub HandleTimerElapsed67(sender As System.Object, e As System.EventArgs) Handles Prog_Lok55.Elapsed

        '*** Fahrprogramm für Diesel-Lok 260 787-7
        '*** Datum: 23.02.2020

        SetText(TextBox1, "Diesel-Lok 260 787-7                                                    IBS: 24.05.2021 - V3 : 12")
        LoadImage(PictureBox1, "H:\\EB_Media\\LokFotos\\Baureihe_260_01.jpg")
        GeschwindikeitenSetzen(55)

        Dim Stufe1, Stufe2, Stufe3, Stufe4 As Integer
        Dim Stufe11, Stufe12, Stufe13, Stufe14, Stufe21, Stufe22, Stufe23, Stufe24 As Integer
        Dim V_100, V_130, V_160, V_180, V_500 As Integer
        Dim T_100, T_130, T_160, T_180, T_500 As Integer
        Dim G_200 As Integer

        T_100 = _Betriebsparameter.Fahrparameter(55, KlausEBspecific.Betriebsparameter.FahrparameterEnum.T_100)
        T_130 = _Betriebsparameter.Fahrparameter(55, KlausEBspecific.Betriebsparameter.FahrparameterEnum.T_130)
        T_160 = _Betriebsparameter.Fahrparameter(55, KlausEBspecific.Betriebsparameter.FahrparameterEnum.T_160)
        T_180 = _Betriebsparameter.Fahrparameter(55, KlausEBspecific.Betriebsparameter.FahrparameterEnum.T_180)
        T_500 = _Betriebsparameter.Fahrparameter(55, KlausEBspecific.Betriebsparameter.FahrparameterEnum.T_500)
        V_100 = _Betriebsparameter.Fahrparameter(55, KlausEBspecific.Betriebsparameter.FahrparameterEnum.V_100)
        V_130 = _Betriebsparameter.Fahrparameter(55, KlausEBspecific.Betriebsparameter.FahrparameterEnum.V_130)
        V_160 = _Betriebsparameter.Fahrparameter(55, KlausEBspecific.Betriebsparameter.FahrparameterEnum.V_160)
        V_180 = _Betriebsparameter.Fahrparameter(55, KlausEBspecific.Betriebsparameter.FahrparameterEnum.V_180)
        V_500 = _Betriebsparameter.Fahrparameter(55, KlausEBspecific.Betriebsparameter.FahrparameterEnum.V_500)
        G_200 = _Betriebsparameter.Fahrparameter(55, KlausEBspecific.Betriebsparameter.FahrparameterEnum.G_200)

        If A_StopB = 1 Then
            V_100 = 8000
        End If

        Stufe1 = _LokStufen.Holen(55, 1)
        Stufe2 = _LokStufen.Holen(55, 2)
        Stufe3 = _LokStufen.Holen(55, 3)
        Stufe4 = _LokStufen.Holen(55, 4)

        If Stufe2 = 1 Then
            T_100 = T_100
            T_130 = T_130
            T_160 = T_160
            V_180 = V_180
        ElseIf Stufe2 = 2 Then
            T_100 = T_100 + 300
            T_130 = T_130 + 300
            T_160 = T_160 + 300
            V_180 = V_180 + 500
        ElseIf Stufe2 = 3 Then
            T_100 = T_100 + 500
            T_130 = T_130 + 500
            T_160 = T_160 + 500
            V_180 = V_180 + 1000
        ElseIf Stufe2 = 4 Then
            T_100 = T_100 + 700
            T_130 = T_130 + 700
            T_160 = T_160 + 700
            V_180 = V_180 + 1500
        ElseIf Stufe2 = 5 Then
            T_100 = T_100 + 900
            T_130 = T_130 + 900
            T_160 = T_160 + 900
            V_180 = V_180 + 2000
        ElseIf Stufe2 = 6 Then
            T_100 = T_100 + 1200
            T_130 = T_130 + 1200
            T_160 = T_160 + 1200
            V_180 = V_180 + 2500
        Else
            T_100 = T_100 + 1200
            T_130 = T_130 + 1200
            T_160 = T_160 + 1200
            V_180 = V_180 + 2500
        End If

        Stufe2 = Stufe1

        Stufe11 = Stufe1 + 1
        If Stufe11 > Stufe3 Then
            Stufe11 = Stufe3
        End If
        Stufe12 = Stufe1 + 2
        If Stufe12 > Stufe3 Then
            Stufe12 = Stufe3
        End If
        Stufe13 = Stufe1 + 3
        If Stufe13 > Stufe3 Then
            Stufe13 = Stufe3
        End If
        Stufe14 = Stufe1 + 4
        If Stufe14 > Stufe3 Then
            Stufe14 = Stufe3
        End If

        Stufe21 = Stufe2 + 1
        If Stufe21 > Stufe3 Then
            Stufe21 = Stufe3
        End If
        Stufe22 = Stufe2 + 2
        If Stufe22 > Stufe3 Then
            Stufe22 = Stufe3
        End If
        Stufe23 = Stufe2 + 3
        If Stufe23 > Stufe3 Then
            Stufe23 = Stufe3
        End If
        Stufe24 = Stufe2 + 4
        If Stufe24 > Stufe3 Then
            Stufe24 = Stufe3
        End If
        If G_200 > 0 Then
            If G_200 < Stufe4 Then
                G_200 = Stufe4
            End If
        Else
            G_200 = Stufe4
        End If

        If Betriebsart = 1 And (_GlsL55 = 3 Or _GlsL55 = 4) Then
            SetProgramCounterLabel1(_Prog55)
        Else
            SetProgramCounterLabel(_Prog55)
        End If

        ' Lok starten - Bahnhofsausfahrt

        If _Prog55 = 0 Then
            Prog_Lok55.Interval = 2000
        ElseIf _Prog55 = 1 Then
        ElseIf _Prog55 = 2 Then
            _Betriebsparameter.RundenErhoehen(55)
        ElseIf _Prog55 = 3 Then
        ElseIf _Prog55 = 4 Then
        ElseIf _Prog55 = 5 Then
        ElseIf _Prog55 = 6 Then

            ' Bahnhofsausfahrt

        ElseIf _Prog55 = 7 Then
            _eb.lokSteuern(55, Klassen.LokEigenschaften.Geschwindigkeit, Stufe1)
        ElseIf _Prog55 = 8 Then
            _eb.lokSteuern(55, Klassen.LokEigenschaften.Geschwindigkeit, Stufe11)
        ElseIf _Prog55 = 9 Then
            _eb.lokSteuern(55, Klassen.LokEigenschaften.Geschwindigkeit, Stufe12)
        ElseIf _Prog55 = 10 Then
            _eb.lokSteuern(55, Klassen.LokEigenschaften.Geschwindigkeit, Stufe13)
        ElseIf _Prog55 = 11 Then
            _eb.lokSteuern(55, Klassen.LokEigenschaften.Geschwindigkeit, Stufe14)
        ElseIf _Prog55 = 12 Then
            _eb.lokSteuern(55, Klassen.LokEigenschaften.Geschwindigkeit, Stufe3)

            ' Lok abstellen

        ElseIf _Prog55 = 50 Then
            Prog_Lok55.Interval = 2000
        ElseIf _Prog55 = 51 Then ' *** Lok hat keine Lichtfunktion
        ElseIf _Prog55 = 52 Then

            ' Lok bremsen (Bahnhofseinfahrt Normalzug von links und von rechts)

        ElseIf _Prog55 = 100 Then
            Prog_Lok55.Interval = V_100
        ElseIf _Prog55 = 101 Then
            _eb.lokSteuern(55, Klassen.LokEigenschaften.Geschwindigkeit, Stufe24)
            Prog_Lok55.Interval = T_100
        ElseIf _Prog55 = 102 Then
            _eb.lokSteuern(55, Klassen.LokEigenschaften.Geschwindigkeit, Stufe23)
        ElseIf _Prog55 = 103 Then
            _eb.lokSteuern(55, Klassen.LokEigenschaften.Geschwindigkeit, Stufe22)
        ElseIf _Prog55 = 104 Then
            _eb.lokSteuern(55, Klassen.LokEigenschaften.Geschwindigkeit, Stufe21)
        ElseIf _Prog55 = 105 Then
            _eb.lokSteuern(55, Klassen.LokEigenschaften.Geschwindigkeit, Stufe2)

            ' Lok bremsen (Bahnhofseinfahrt Kurzzug von links)

        ElseIf _Prog55 = 130 Then
            Prog_Lok55.Interval = V_130
        ElseIf _Prog55 = 131 Then
            _eb.lokSteuern(55, Klassen.LokEigenschaften.Geschwindigkeit, Stufe24)
            Prog_Lok55.Interval = T_130
        ElseIf _Prog55 = 132 Then
            _eb.lokSteuern(55, Klassen.LokEigenschaften.Geschwindigkeit, Stufe23)
        ElseIf _Prog55 = 133 Then
            _eb.lokSteuern(55, Klassen.LokEigenschaften.Geschwindigkeit, Stufe22)
        ElseIf _Prog55 = 134 Then
            _eb.lokSteuern(55, Klassen.LokEigenschaften.Geschwindigkeit, Stufe21)
        ElseIf _Prog55 = 135 Then
            _eb.lokSteuern(55, Klassen.LokEigenschaften.Geschwindigkeit, Stufe2)
        ElseIf _Prog55 = 136 Then
            _eb.lokSteuern(55, Klassen.LokEigenschaften.Geschwindigkeit, 0)
        ElseIf _Prog55 = 137 Then
            Prog_Lok55.Interval = 2000
        ElseIf _Prog55 = 138 Then

            ' Lok bremsen (Bahnhofseinfahrt Kurzzug von rechts)

        ElseIf _Prog55 = 160 Then
            Prog_Lok55.Interval = V_160
        ElseIf _Prog55 = 161 Then
            _eb.lokSteuern(55, Klassen.LokEigenschaften.Geschwindigkeit, Stufe24)
            Prog_Lok55.Interval = T_160
        ElseIf _Prog55 = 162 Then
            _eb.lokSteuern(55, Klassen.LokEigenschaften.Geschwindigkeit, Stufe23)
        ElseIf _Prog55 = 163 Then
            _eb.lokSteuern(55, Klassen.LokEigenschaften.Geschwindigkeit, Stufe22)
        ElseIf _Prog55 = 164 Then
            _eb.lokSteuern(55, Klassen.LokEigenschaften.Geschwindigkeit, Stufe21)
        ElseIf _Prog55 = 165 Then
            _eb.lokSteuern(55, Klassen.LokEigenschaften.Geschwindigkeit, Stufe2)
        ElseIf _Prog55 = 166 Then
            _eb.lokSteuern(55, Klassen.LokEigenschaften.Geschwindigkeit, 0)
        ElseIf _Prog55 = 167 Then
            Prog_Lok55.Interval = 2000
        ElseIf _Prog55 = 168 Then

            ' Rangierzug

        ElseIf _Prog55 = 180 Then
            _eb.lokSteuern(55, Klassen.LokEigenschaften.Geschwindigkeit, 5)
            Prog_Lok55.Interval = V_180
        ElseIf _Prog55 = 181 Then
            Prog_Lok55.Interval = T_180
            _eb.lokSteuern(55, Klassen.LokEigenschaften.Geschwindigkeit, 4)
        ElseIf _Prog55 = 182 Then
            _eb.lokSteuern(55, Klassen.LokEigenschaften.Geschwindigkeit, 0)

            ' Tunnelausfahrt

        ElseIf _Prog55 = 200 Then ' Kontakt 1.2 <- (bergauf)
            _eb.lokSteuern(55, Klassen.LokEigenschaften.Geschwindigkeit, G_200)
            Prog_Lok55.Interval = 2000
        ElseIf _Prog55 = 201 Then
        ElseIf _Prog55 = 202 Then
        ElseIf _Prog55 = 203 Then
        ElseIf _Prog55 = 204 Then
        ElseIf _Prog55 = 205 Then
            If Stufe4 < Stufe3 Then
                _eb.lokSteuern(55, Klassen.LokEigenschaften.Geschwindigkeit, Stufe3)
            Else
                _eb.lokSteuern(55, Klassen.LokEigenschaften.Geschwindigkeit, Stufe4)
            End If

        ElseIf _Prog55 = 220 Then ' Kontakt 3.1 -> (hinter dem Martinstor bergauf)
            Prog_Lok55.Interval = 2000
        ElseIf _Prog55 = 221 Then
        ElseIf _Prog55 = 222 Then

        ElseIf _Prog55 = 240 Then ' Kontakt 3.7 <- (hinter der Brücke bergauf)
            Prog_Lok55.Interval = 2000
        ElseIf _Prog55 = 241 Then
        ElseIf _Prog55 = 242 Then

        ElseIf _Prog55 = 260 Then ' Kontakt 3.3 (links bzw vor der Brücke)
            Prog_Lok55.Interval = 2000
        ElseIf _Prog55 = 261 Then
        ElseIf _Prog55 = 262 Then
            _eb.lokSteuern(55, Klassen.LokEigenschaften.Geschwindigkeit, Stufe3)

        ElseIf _Prog55 = 600 Then ' Kontakt 3.5 <- (unter der Burg)
            Prog_Lok55.Interval = 2000
        ElseIf _Prog55 = 601 Then
        ElseIf _Prog55 = 602 Then

        ElseIf _Prog55 = 620 Then ' Kontakt 3.7 -> (hinter der Brücke bergab)
            Prog_Lok55.Interval = 2000
        ElseIf _Prog55 = 621 Then
        ElseIf _Prog55 = 622 Then

        ElseIf _Prog55 = 640 Then ' Kontakt 3.1 <- Talfahrt
            Prog_Lok55.Interval = 2000
        ElseIf _Prog55 = 641 Then
        ElseIf _Prog55 = 642 Then

        ElseIf _Prog55 = 660 Then ' Kontakt 1.2 -> Talfahrt
            Prog_Lok55.Interval = 2000
        ElseIf _Prog55 = 661 Then
        ElseIf _Prog55 = 662 Then

        ElseIf _Prog55 = 700 Then ' Kontakt 0.4 <- Diagonale
            Prog_Lok55.Interval = 2000
        ElseIf _Prog55 = 701 Then
        ElseIf _Prog55 = 702 Then

            ' Zindelstein

        ElseIf _Prog55 = 500 Then
            Prog_Lok55.Interval = V_500
        ElseIf _Prog55 = 501 Then
            _eb.lokSteuern(55, Klassen.LokEigenschaften.Geschwindigkeit, Stufe24)
            Prog_Lok55.Interval = T_500
        ElseIf _Prog55 = 502 Then
            _eb.lokSteuern(55, Klassen.LokEigenschaften.Geschwindigkeit, Stufe23)
        ElseIf _Prog55 = 503 Then
            _eb.lokSteuern(55, Klassen.LokEigenschaften.Geschwindigkeit, Stufe22)
        ElseIf _Prog55 = 504 Then
            _eb.lokSteuern(55, Klassen.LokEigenschaften.Geschwindigkeit, Stufe21)
        ElseIf _Prog55 = 505 Then
            _eb.lokSteuern(55, Klassen.LokEigenschaften.Geschwindigkeit, Stufe2)
        ElseIf _Prog55 = 506 Then
            _eb.lokSteuern(55, Klassen.LokEigenschaften.Geschwindigkeit, 0)

        Else
            _Prog55 = 0
            Prog_Lok55.Stop()
            Prog_Lok55.Interval = 200
            If Betriebsart = 1 Then
                SetProgramCounterLabel1(String.Empty)
            Else
                SetProgramCounterLabel(String.Empty)
            End If
        End If
        _Prog55 = _Prog55 + 1
    End Sub
    Private Sub HandleTimerElapsed68(sender As System.Object, e As System.EventArgs) Handles Prog_Lok56.Elapsed

        '*** Fahrprogramm für Dampflok Limmat
        '*** Datum: 23.02.2020

        SetText(TextBox1, "Dampflokomotive Limmat                                                  IBS: nein")
        LoadImage(PictureBox1, "H:\\EB_Media\\LokFotos\\Baureihe_Limmat_01.jpg")
        GeschwindikeitenSetzen(56)

        Dim Stufe1, Stufe2, Stufe3, Stufe4 As Integer
        Dim Stufe11, Stufe12, Stufe13, Stufe14, Stufe21, Stufe22, Stufe23, Stufe24 As Integer
        Dim V_100, V_130, V_160, V_180, V_500 As Integer
        Dim T_100, T_130, T_160, T_180, T_500 As Integer
        Dim G_200 As Integer

        T_100 = _Betriebsparameter.Fahrparameter(56, KlausEBspecific.Betriebsparameter.FahrparameterEnum.T_100)
        T_130 = _Betriebsparameter.Fahrparameter(56, KlausEBspecific.Betriebsparameter.FahrparameterEnum.T_130)
        T_160 = _Betriebsparameter.Fahrparameter(56, KlausEBspecific.Betriebsparameter.FahrparameterEnum.T_160)
        T_180 = _Betriebsparameter.Fahrparameter(56, KlausEBspecific.Betriebsparameter.FahrparameterEnum.T_180)
        T_500 = _Betriebsparameter.Fahrparameter(56, KlausEBspecific.Betriebsparameter.FahrparameterEnum.T_500)
        V_100 = _Betriebsparameter.Fahrparameter(56, KlausEBspecific.Betriebsparameter.FahrparameterEnum.V_100)
        V_130 = _Betriebsparameter.Fahrparameter(56, KlausEBspecific.Betriebsparameter.FahrparameterEnum.V_130)
        V_160 = _Betriebsparameter.Fahrparameter(56, KlausEBspecific.Betriebsparameter.FahrparameterEnum.V_160)
        V_180 = _Betriebsparameter.Fahrparameter(56, KlausEBspecific.Betriebsparameter.FahrparameterEnum.V_180)
        V_500 = _Betriebsparameter.Fahrparameter(56, KlausEBspecific.Betriebsparameter.FahrparameterEnum.V_500)
        G_200 = _Betriebsparameter.Fahrparameter(56, KlausEBspecific.Betriebsparameter.FahrparameterEnum.G_200)

        If A_StopB = 1 Then
            V_100 = 8000
        End If

        Stufe1 = _LokStufen.Holen(56, 1)
        Stufe2 = _LokStufen.Holen(56, 2)
        Stufe3 = _LokStufen.Holen(56, 3)
        Stufe4 = _LokStufen.Holen(56, 4)

        If Stufe2 = 1 Then
            T_100 = T_100
            T_130 = T_130
            T_160 = T_160
            V_180 = V_180
        ElseIf Stufe2 = 2 Then
            T_100 = T_100 + 300
            T_130 = T_130 + 300
            T_160 = T_160 + 300
            V_180 = V_180 + 500
        ElseIf Stufe2 = 3 Then
            T_100 = T_100 + 500
            T_130 = T_130 + 500
            T_160 = T_160 + 500
            V_180 = V_180 + 1000
        ElseIf Stufe2 = 4 Then
            T_100 = T_100 + 700
            T_130 = T_130 + 700
            T_160 = T_160 + 700
            V_180 = V_180 + 1500
        ElseIf Stufe2 = 5 Then
            T_100 = T_100 + 900
            T_130 = T_130 + 900
            T_160 = T_160 + 900
            V_180 = V_180 + 2000
        ElseIf Stufe2 = 6 Then
            T_100 = T_100 + 1200
            T_130 = T_130 + 1200
            T_160 = T_160 + 1200
            V_180 = V_180 + 2500
        Else
            T_100 = T_100 + 1200
            T_130 = T_130 + 1200
            T_160 = T_160 + 1200
            V_180 = V_180 + 2500
        End If

        Stufe2 = Stufe1

        Stufe11 = Stufe1 + 1
        If Stufe11 > Stufe3 Then
            Stufe11 = Stufe3
        End If
        Stufe12 = Stufe1 + 2
        If Stufe12 > Stufe3 Then
            Stufe12 = Stufe3
        End If
        Stufe13 = Stufe1 + 3
        If Stufe13 > Stufe3 Then
            Stufe13 = Stufe3
        End If
        Stufe14 = Stufe1 + 4
        If Stufe14 > Stufe3 Then
            Stufe14 = Stufe3
        End If

        Stufe21 = Stufe2 + 1
        If Stufe21 > Stufe3 Then
            Stufe21 = Stufe3
        End If
        Stufe22 = Stufe2 + 2
        If Stufe22 > Stufe3 Then
            Stufe22 = Stufe3
        End If
        Stufe23 = Stufe2 + 3
        If Stufe23 > Stufe3 Then
            Stufe23 = Stufe3
        End If
        Stufe24 = Stufe2 + 4
        If Stufe24 > Stufe3 Then
            Stufe24 = Stufe3
        End If
        If G_200 > 0 Then
            If G_200 < Stufe4 Then
                G_200 = Stufe4
            End If
        Else
            G_200 = Stufe4
        End If

        If Betriebsart = 1 And (_GlsL56 = 3 Or _GlsL56 = 4) Then
            SetProgramCounterLabel1(_Prog56)
        Else
            SetProgramCounterLabel(_Prog56)
        End If

        ' Lok starten - Bahnhofsausfahrt

        If _Prog56 = 0 Then
            Prog_Lok56.Interval = 2000
        ElseIf _Prog56 = 1 Then
        ElseIf _Prog56 = 2 Then
            _Betriebsparameter.RundenErhoehen(56)
        ElseIf _Prog56 = 3 Then
        ElseIf _Prog56 = 4 Then
        ElseIf _Prog56 = 5 Then
        ElseIf _Prog56 = 6 Then

            ' Bahnhofsausfahrt

        ElseIf _Prog56 = 7 Then
            _eb.lokSteuern(56, Klassen.LokEigenschaften.Geschwindigkeit, Stufe1)
        ElseIf _Prog56 = 8 Then
            _eb.lokSteuern(56, Klassen.LokEigenschaften.Geschwindigkeit, Stufe11)
        ElseIf _Prog56 = 9 Then
            _eb.lokSteuern(56, Klassen.LokEigenschaften.Geschwindigkeit, Stufe12)
        ElseIf _Prog56 = 10 Then
            _eb.lokSteuern(56, Klassen.LokEigenschaften.Geschwindigkeit, Stufe13)
        ElseIf _Prog56 = 11 Then
            _eb.lokSteuern(56, Klassen.LokEigenschaften.Geschwindigkeit, Stufe14)
        ElseIf _Prog56 = 12 Then
            _eb.lokSteuern(56, Klassen.LokEigenschaften.Geschwindigkeit, Stufe3)

            ' Lok abstellen

        ElseIf _Prog56 = 50 Then
            Prog_Lok56.Interval = 2000
        ElseIf _Prog56 = 51 Then ' *** Lok hat keine Lichtfunktion
        ElseIf _Prog56 = 52 Then

            ' Lok bremsen (Bahnhofseinfahrt Normalzug von links und von rechts)

        ElseIf _Prog56 = 100 Then
            Prog_Lok56.Interval = V_100
        ElseIf _Prog56 = 101 Then
            _eb.lokSteuern(56, Klassen.LokEigenschaften.Geschwindigkeit, Stufe24)
            Prog_Lok56.Interval = T_100
        ElseIf _Prog56 = 102 Then
            _eb.lokSteuern(56, Klassen.LokEigenschaften.Geschwindigkeit, Stufe23)
        ElseIf _Prog56 = 103 Then
            _eb.lokSteuern(56, Klassen.LokEigenschaften.Geschwindigkeit, Stufe22)
        ElseIf _Prog56 = 104 Then
            _eb.lokSteuern(56, Klassen.LokEigenschaften.Geschwindigkeit, Stufe21)
        ElseIf _Prog56 = 105 Then
            _eb.lokSteuern(56, Klassen.LokEigenschaften.Geschwindigkeit, Stufe2)

            ' Lok bremsen (Bahnhofseinfahrt Kurzzug von links)

        ElseIf _Prog56 = 130 Then
            Prog_Lok56.Interval = V_130
        ElseIf _Prog56 = 131 Then
            _eb.lokSteuern(56, Klassen.LokEigenschaften.Geschwindigkeit, Stufe24)
            Prog_Lok56.Interval = T_130
        ElseIf _Prog56 = 132 Then
            _eb.lokSteuern(56, Klassen.LokEigenschaften.Geschwindigkeit, Stufe23)
        ElseIf _Prog56 = 133 Then
            _eb.lokSteuern(56, Klassen.LokEigenschaften.Geschwindigkeit, Stufe22)
        ElseIf _Prog56 = 134 Then
            _eb.lokSteuern(56, Klassen.LokEigenschaften.Geschwindigkeit, Stufe21)
        ElseIf _Prog56 = 135 Then
            _eb.lokSteuern(56, Klassen.LokEigenschaften.Geschwindigkeit, Stufe2)
        ElseIf _Prog56 = 136 Then
            _eb.lokSteuern(56, Klassen.LokEigenschaften.Geschwindigkeit, 0)
        ElseIf _Prog56 = 137 Then
            Prog_Lok56.Interval = 2000
        ElseIf _Prog56 = 138 Then
            If _Fahrzeugbeleuchtung2 < 2 Then
                _eb.lokSteuern(56, Klassen.LokEigenschaften.Hauptfunktion, 0) ' Licht aus
            End If

            ' Lok bremsen (Bahnhofseinfahrt Kurzzug von rechts)

        ElseIf _Prog56 = 160 Then
            Prog_Lok56.Interval = V_160
        ElseIf _Prog56 = 161 Then
            _eb.lokSteuern(56, Klassen.LokEigenschaften.Geschwindigkeit, Stufe24)
            Prog_Lok56.Interval = T_160
        ElseIf _Prog56 = 162 Then
            _eb.lokSteuern(56, Klassen.LokEigenschaften.Geschwindigkeit, Stufe23)
        ElseIf _Prog56 = 163 Then
            _eb.lokSteuern(56, Klassen.LokEigenschaften.Geschwindigkeit, Stufe22)
        ElseIf _Prog56 = 164 Then
            _eb.lokSteuern(56, Klassen.LokEigenschaften.Geschwindigkeit, Stufe21)
        ElseIf _Prog56 = 165 Then
            _eb.lokSteuern(56, Klassen.LokEigenschaften.Geschwindigkeit, Stufe2)
        ElseIf _Prog56 = 166 Then
            _eb.lokSteuern(56, Klassen.LokEigenschaften.Geschwindigkeit, 0)
        ElseIf _Prog56 = 167 Then
            Prog_Lok56.Interval = 2000
        ElseIf _Prog56 = 168 Then
            If _Fahrzeugbeleuchtung2 < 2 Then
                _eb.lokSteuern(56, Klassen.LokEigenschaften.Hauptfunktion, 0) ' Licht aus
            End If

            ' Rangierzug

        ElseIf _Prog56 = 180 Then
            _eb.lokSteuern(56, Klassen.LokEigenschaften.Geschwindigkeit, 2)
            Prog_Lok56.Interval = V_180
        ElseIf _Prog56 = 181 Then
            Prog_Lok56.Interval = T_180
            _eb.lokSteuern(56, Klassen.LokEigenschaften.Geschwindigkeit, 1)
        ElseIf _Prog56 = 182 Then
            _eb.lokSteuern(56, Klassen.LokEigenschaften.Geschwindigkeit, 0)

            ' Tunnelausfahrt

        ElseIf _Prog56 = 200 Then ' Kontakt 1.2 <- (bergauf)
            _eb.lokSteuern(56, Klassen.LokEigenschaften.Geschwindigkeit, G_200)
            Prog_Lok56.Interval = 2000
        ElseIf _Prog56 = 201 Then
        ElseIf _Prog56 = 202 Then
        ElseIf _Prog56 = 203 Then
        ElseIf _Prog56 = 204 Then
        ElseIf _Prog56 = 205 Then
            If Stufe4 < Stufe3 Then
                _eb.lokSteuern(56, Klassen.LokEigenschaften.Geschwindigkeit, Stufe3)
            Else
                _eb.lokSteuern(56, Klassen.LokEigenschaften.Geschwindigkeit, Stufe4)
            End If

        ElseIf _Prog56 = 220 Then ' Kontakt 3.1 -> (hinter dem Martinstor bergauf)
            Prog_Lok56.Interval = 2000
        ElseIf _Prog56 = 221 Then
        ElseIf _Prog56 = 222 Then

        ElseIf _Prog56 = 240 Then ' Kontakt 3.7 <- (hinter der Brücke bergauf)
            Prog_Lok56.Interval = 2000
        ElseIf _Prog56 = 241 Then
        ElseIf _Prog56 = 242 Then

        ElseIf _Prog56 = 260 Then ' Kontakt 3.3 (links bzw vor der Brücke)
            Prog_Lok56.Interval = 2000
        ElseIf _Prog56 = 261 Then
        ElseIf _Prog56 = 262 Then
            _eb.lokSteuern(56, Klassen.LokEigenschaften.Geschwindigkeit, Stufe3)

        ElseIf _Prog56 = 600 Then ' Kontakt 3.5 <- (unter der Burg)
            Prog_Lok56.Interval = 2000
        ElseIf _Prog56 = 601 Then
        ElseIf _Prog56 = 602 Then

        ElseIf _Prog56 = 620 Then ' Kontakt 3.7 -> (hinter der Brücke bergab)
            Prog_Lok56.Interval = 2000
        ElseIf _Prog56 = 621 Then
        ElseIf _Prog56 = 622 Then

        ElseIf _Prog56 = 640 Then ' Kontakt 3.1 <- Talfahrt
            Prog_Lok56.Interval = 2000
        ElseIf _Prog56 = 641 Then
        ElseIf _Prog56 = 642 Then

        ElseIf _Prog56 = 660 Then ' Kontakt 1.2 -> Talfahrt
            Prog_Lok56.Interval = 2000
        ElseIf _Prog56 = 661 Then
        ElseIf _Prog56 = 662 Then

        ElseIf _Prog56 = 700 Then ' Kontakt 0.4 <- Diagonale
            Prog_Lok56.Interval = 2000
        ElseIf _Prog56 = 701 Then
        ElseIf _Prog56 = 702 Then

            ' Zindelstein

        ElseIf _Prog56 = 500 Then
            Prog_Lok56.Interval = V_500
        ElseIf _Prog56 = 501 Then
            _eb.lokSteuern(56, Klassen.LokEigenschaften.Geschwindigkeit, Stufe23)
            Prog_Lok56.Interval = T_500
        ElseIf _Prog56 = 502 Then
            _eb.lokSteuern(56, Klassen.LokEigenschaften.Geschwindigkeit, Stufe22)
        ElseIf _Prog56 = 503 Then
            _eb.lokSteuern(56, Klassen.LokEigenschaften.Geschwindigkeit, Stufe21)
        ElseIf _Prog56 = 504 Then
            _eb.lokSteuern(56, Klassen.LokEigenschaften.Geschwindigkeit, Stufe2)
        ElseIf _Prog56 = 505 Then
            _eb.lokSteuern(56, Klassen.LokEigenschaften.Geschwindigkeit, 0)

        Else
            _Prog56 = 0
            Prog_Lok56.Stop()
            Prog_Lok56.Interval = 200
            If Betriebsart = 1 Then
                SetProgramCounterLabel1(String.Empty)
            Else
                SetProgramCounterLabel(String.Empty)
            End If
        End If
        _Prog56 = _Prog56 + 1
    End Sub
    Private Sub HandleTimerElapsed69(sender As System.Object, e As System.EventArgs) Handles Prog_Lok57.Elapsed

        '*** Fahrprogramm für bayerische Gattung B VI
        '*** Datum: 23.02.2020

        SetText(TextBox1, "bayerische B VI                                                         IBS: 16.09.2025")
        LoadImage(PictureBox1, "H:\\EB_Media\\LokFotos\\Baureihe_BVI_10.jpg")
        GeschwindikeitenSetzen(57)

        Dim Stufe1, Stufe2, Stufe3, Stufe4 As Integer
        Dim Stufe11, Stufe12, Stufe13, Stufe14, Stufe21, Stufe22, Stufe23, Stufe24 As Integer
        Dim V_100, V_130, V_160, V_180, V_500 As Integer
        Dim T_100, T_130, T_160, T_180, T_500 As Integer
        Dim G_200 As Integer

        T_100 = _Betriebsparameter.Fahrparameter(57, KlausEBspecific.Betriebsparameter.FahrparameterEnum.T_100)
        T_130 = _Betriebsparameter.Fahrparameter(57, KlausEBspecific.Betriebsparameter.FahrparameterEnum.T_130)
        T_160 = _Betriebsparameter.Fahrparameter(57, KlausEBspecific.Betriebsparameter.FahrparameterEnum.T_160)
        T_180 = _Betriebsparameter.Fahrparameter(57, KlausEBspecific.Betriebsparameter.FahrparameterEnum.T_180)
        T_500 = _Betriebsparameter.Fahrparameter(57, KlausEBspecific.Betriebsparameter.FahrparameterEnum.T_500)
        V_100 = _Betriebsparameter.Fahrparameter(57, KlausEBspecific.Betriebsparameter.FahrparameterEnum.V_100)
        V_130 = _Betriebsparameter.Fahrparameter(57, KlausEBspecific.Betriebsparameter.FahrparameterEnum.V_130)
        V_160 = _Betriebsparameter.Fahrparameter(57, KlausEBspecific.Betriebsparameter.FahrparameterEnum.V_160)
        V_180 = _Betriebsparameter.Fahrparameter(57, KlausEBspecific.Betriebsparameter.FahrparameterEnum.V_180)
        V_500 = _Betriebsparameter.Fahrparameter(57, KlausEBspecific.Betriebsparameter.FahrparameterEnum.V_500)
        G_200 = _Betriebsparameter.Fahrparameter(57, KlausEBspecific.Betriebsparameter.FahrparameterEnum.G_200)

        If A_StopB = 1 Then
            V_100 = 8000
        End If

        Stufe1 = _LokStufen.Holen(57, 1)
        Stufe2 = _LokStufen.Holen(57, 2)
        Stufe3 = _LokStufen.Holen(57, 3)
        Stufe4 = _LokStufen.Holen(57, 4)

        If Stufe2 = 1 Then
            T_100 = T_100
            T_130 = T_130
            T_160 = T_160
            V_180 = V_180
        ElseIf Stufe2 = 2 Then
            T_100 = T_100 + 300
            T_130 = T_130 + 300
            T_160 = T_160 + 300
            V_180 = V_180 + 500
        ElseIf Stufe2 = 3 Then
            T_100 = T_100 + 500
            T_130 = T_130 + 500
            T_160 = T_160 + 500
            V_180 = V_180 + 1000
        ElseIf Stufe2 = 4 Then
            T_100 = T_100 + 700
            T_130 = T_130 + 700
            T_160 = T_160 + 700
            V_180 = V_180 + 1500
        ElseIf Stufe2 = 5 Then
            T_100 = T_100 + 900
            T_130 = T_130 + 900
            T_160 = T_160 + 900
            V_180 = V_180 + 2000
        ElseIf Stufe2 = 6 Then
            T_100 = T_100 + 1200
            T_130 = T_130 + 1200
            T_160 = T_160 + 1200
            V_180 = V_180 + 2500
        Else
            T_100 = T_100 + 1200
            T_130 = T_130 + 1200
            T_160 = T_160 + 1200
            V_180 = V_180 + 2500
        End If

        Stufe2 = Stufe1

        Stufe11 = Stufe1 + 1
        If Stufe11 > Stufe3 Then
            Stufe11 = Stufe3
        End If
        Stufe12 = Stufe1 + 2
        If Stufe12 > Stufe3 Then
            Stufe12 = Stufe3
        End If
        Stufe13 = Stufe1 + 3
        If Stufe13 > Stufe3 Then
            Stufe13 = Stufe3
        End If
        Stufe14 = Stufe1 + 4
        If Stufe14 > Stufe3 Then
            Stufe14 = Stufe3
        End If

        Stufe21 = Stufe2 + 1
        If Stufe21 > Stufe3 Then
            Stufe21 = Stufe3
        End If
        Stufe22 = Stufe2 + 2
        If Stufe22 > Stufe3 Then
            Stufe22 = Stufe3
        End If
        Stufe23 = Stufe2 + 3
        If Stufe23 > Stufe3 Then
            Stufe23 = Stufe3
        End If
        Stufe24 = Stufe2 + 4
        If Stufe24 > Stufe3 Then
            Stufe24 = Stufe3
        End If
        If G_200 > 0 Then
            If G_200 < Stufe4 Then
                G_200 = Stufe4
            End If
        Else
            G_200 = Stufe4
        End If

        If Betriebsart = 1 And (_GlsL57 = 3 Or _GlsL57 = 4) Then
            SetProgramCounterLabel1(_Prog57)
        Else
            SetProgramCounterLabel(_Prog57)
        End If

        ' Lok starten - Bahnhofsausfahrt

        If _Prog57 = 0 Then
            Prog_Lok57.Interval = 2000
            If _Fahrzeugbeleuchtung2 > 0 Then
                _eb.lokSteuern(57, Klassen.LokEigenschaften.Hauptfunktion, 1) ' Licht ein
            End If
        ElseIf _Prog57 = 1 Then
        ElseIf _Prog57 = 2 Then
            _Betriebsparameter.RundenErhoehen(57)
        ElseIf _Prog57 = 3 Then
        ElseIf _Prog57 = 4 Then
        ElseIf _Prog57 = 5 Then
        ElseIf _Prog57 = 6 Then

            ' Bahnhofsausfahrt

        ElseIf _Prog57 = 7 Then
            _eb.lokSteuern(57, Klassen.LokEigenschaften.Geschwindigkeit, Stufe1)
        ElseIf _Prog57 = 8 Then
            _eb.lokSteuern(57, Klassen.LokEigenschaften.Geschwindigkeit, Stufe11)
        ElseIf _Prog57 = 9 Then
            _eb.lokSteuern(57, Klassen.LokEigenschaften.Geschwindigkeit, Stufe12)
        ElseIf _Prog57 = 10 Then
            _eb.lokSteuern(57, Klassen.LokEigenschaften.Geschwindigkeit, Stufe13)
        ElseIf _Prog57 = 11 Then
            _eb.lokSteuern(57, Klassen.LokEigenschaften.Geschwindigkeit, Stufe14)
        ElseIf _Prog57 = 12 Then
            _eb.lokSteuern(57, Klassen.LokEigenschaften.Geschwindigkeit, Stufe3)

            ' Lok abstellen

        ElseIf _Prog57 = 50 Then
            Prog_Lok57.Interval = 2000
        ElseIf _Prog57 = 51 Then
        ElseIf _Prog57 = 52 Then
            If _Fahrzeugbeleuchtung2 < 2 Then
                _eb.lokSteuern(57, Klassen.LokEigenschaften.Hauptfunktion, 0) ' Licht aus
            End If

            ' Lok bremsen (Bahnhofseinfahrt Normalzug von links und von rechts)

        ElseIf _Prog57 = 100 Then
            Prog_Lok57.Interval = V_100
        ElseIf _Prog57 = 101 Then
            _eb.lokSteuern(57, Klassen.LokEigenschaften.Geschwindigkeit, Stufe24)
            Prog_Lok57.Interval = T_100
        ElseIf _Prog57 = 102 Then
            _eb.lokSteuern(57, Klassen.LokEigenschaften.Geschwindigkeit, Stufe23)
        ElseIf _Prog57 = 103 Then
            _eb.lokSteuern(57, Klassen.LokEigenschaften.Geschwindigkeit, Stufe22)
        ElseIf _Prog57 = 104 Then
            _eb.lokSteuern(57, Klassen.LokEigenschaften.Geschwindigkeit, Stufe21)
        ElseIf _Prog57 = 105 Then
            _eb.lokSteuern(57, Klassen.LokEigenschaften.Geschwindigkeit, Stufe2)

            ' Lok bremsen (Bahnhofseinfahrt Kurzzug von links)

        ElseIf _Prog57 = 130 Then
            Prog_Lok57.Interval = V_130
        ElseIf _Prog57 = 131 Then
            _eb.lokSteuern(57, Klassen.LokEigenschaften.Geschwindigkeit, Stufe24)
            Prog_Lok57.Interval = T_130
        ElseIf _Prog57 = 132 Then
            _eb.lokSteuern(57, Klassen.LokEigenschaften.Geschwindigkeit, Stufe23)
        ElseIf _Prog57 = 133 Then
            _eb.lokSteuern(57, Klassen.LokEigenschaften.Geschwindigkeit, Stufe22)
        ElseIf _Prog57 = 134 Then
            _eb.lokSteuern(57, Klassen.LokEigenschaften.Geschwindigkeit, Stufe21)
        ElseIf _Prog57 = 135 Then
            _eb.lokSteuern(57, Klassen.LokEigenschaften.Geschwindigkeit, Stufe2)
        ElseIf _Prog57 = 136 Then
            _eb.lokSteuern(57, Klassen.LokEigenschaften.Geschwindigkeit, 0)
        ElseIf _Prog57 = 137 Then
            Prog_Lok57.Interval = 2000
        ElseIf _Prog57 = 138 Then
            If _Fahrzeugbeleuchtung2 < 2 Then
                _eb.lokSteuern(57, Klassen.LokEigenschaften.Hauptfunktion, 0) ' Licht aus
            End If

            ' Lok bremsen (Bahnhofseinfahrt Kurzzug von rechts)

        ElseIf _Prog57 = 160 Then
            Prog_Lok57.Interval = V_160
        ElseIf _Prog57 = 161 Then
            _eb.lokSteuern(57, Klassen.LokEigenschaften.Geschwindigkeit, Stufe24)
            Prog_Lok57.Interval = T_160
        ElseIf _Prog57 = 162 Then
            _eb.lokSteuern(57, Klassen.LokEigenschaften.Geschwindigkeit, Stufe23)
        ElseIf _Prog57 = 163 Then
            _eb.lokSteuern(57, Klassen.LokEigenschaften.Geschwindigkeit, Stufe22)
        ElseIf _Prog57 = 164 Then
            _eb.lokSteuern(57, Klassen.LokEigenschaften.Geschwindigkeit, Stufe21)
        ElseIf _Prog57 = 165 Then
            _eb.lokSteuern(57, Klassen.LokEigenschaften.Geschwindigkeit, Stufe2)
        ElseIf _Prog57 = 166 Then
            _eb.lokSteuern(57, Klassen.LokEigenschaften.Geschwindigkeit, 0)
        ElseIf _Prog57 = 167 Then
            Prog_Lok57.Interval = 2000
        ElseIf _Prog57 = 168 Then
            If _Fahrzeugbeleuchtung2 < 2 Then
                _eb.lokSteuern(57, Klassen.LokEigenschaften.Hauptfunktion, 0) ' Licht aus
            End If

            ' Rangierzug

        ElseIf _Prog57 = 180 Then
            _eb.lokSteuern(57, Klassen.LokEigenschaften.Geschwindigkeit, 2)
            Prog_Lok57.Interval = V_180
        ElseIf _Prog57 = 181 Then
            Prog_Lok57.Interval = T_180
            _eb.lokSteuern(57, Klassen.LokEigenschaften.Geschwindigkeit, 1)
        ElseIf _Prog57 = 182 Then
            _eb.lokSteuern(57, Klassen.LokEigenschaften.Geschwindigkeit, 0)

            ' Tunnelausfahrt

        ElseIf _Prog57 = 200 Then ' Kontakt 1.2 <- (bergauf)
            _eb.lokSteuern(57, Klassen.LokEigenschaften.Geschwindigkeit, G_200)
            Prog_Lok57.Interval = 2000
        ElseIf _Prog57 = 201 Then
        ElseIf _Prog57 = 202 Then
        ElseIf _Prog57 = 203 Then
        ElseIf _Prog57 = 204 Then
        ElseIf _Prog57 = 205 Then
            If Stufe4 < Stufe3 Then
                _eb.lokSteuern(57, Klassen.LokEigenschaften.Geschwindigkeit, Stufe3)
            Else
                _eb.lokSteuern(57, Klassen.LokEigenschaften.Geschwindigkeit, Stufe4)
            End If

        ElseIf _Prog57 = 220 Then ' Kontakt 3.1 -> (hinter dem Martinstor bergauf)
            Prog_Lok57.Interval = 2000
        ElseIf _Prog57 = 221 Then
        ElseIf _Prog57 = 222 Then

        ElseIf _Prog57 = 240 Then ' Kontakt 3.7 <- (hinter der Brücke bergauf)
            Prog_Lok57.Interval = 2000
        ElseIf _Prog57 = 241 Then
        ElseIf _Prog57 = 242 Then

        ElseIf _Prog57 = 260 Then ' Kontakt 3.3 (links bzw vor der Brücke)
            Prog_Lok57.Interval = 2000
        ElseIf _Prog57 = 261 Then
        ElseIf _Prog57 = 262 Then
            _eb.lokSteuern(57, Klassen.LokEigenschaften.Geschwindigkeit, Stufe3)

        ElseIf _Prog57 = 600 Then ' Kontakt 3.5 <- (unter der Burg)
            Prog_Lok57.Interval = 2000
        ElseIf _Prog57 = 601 Then
        ElseIf _Prog57 = 602 Then

        ElseIf _Prog57 = 620 Then ' Kontakt 3.7 -> (hinter der Brücke bergab)
            Prog_Lok57.Interval = 2000
        ElseIf _Prog57 = 621 Then
        ElseIf _Prog57 = 622 Then

        ElseIf _Prog57 = 640 Then ' Kontakt 3.1 <- Talfahrt
            Prog_Lok57.Interval = 2000
        ElseIf _Prog57 = 641 Then
        ElseIf _Prog57 = 642 Then

        ElseIf _Prog57 = 660 Then ' Kontakt 1.2 -> Talfahrt
            Prog_Lok57.Interval = 2000
        ElseIf _Prog57 = 661 Then
        ElseIf _Prog57 = 662 Then

        ElseIf _Prog57 = 700 Then ' Kontakt 0.4 <- Diagonale
            Prog_Lok57.Interval = 2000
        ElseIf _Prog57 = 701 Then
        ElseIf _Prog57 = 702 Then

            ' Zindelstein

        ElseIf _Prog57 = 500 Then
            Prog_Lok57.Interval = V_500
        ElseIf _Prog57 = 501 Then
            _eb.lokSteuern(57, Klassen.LokEigenschaften.Geschwindigkeit, Stufe23)
            Prog_Lok57.Interval = T_500
        ElseIf _Prog57 = 502 Then
            _eb.lokSteuern(57, Klassen.LokEigenschaften.Geschwindigkeit, Stufe22)
        ElseIf _Prog57 = 503 Then
            _eb.lokSteuern(57, Klassen.LokEigenschaften.Geschwindigkeit, Stufe21)
        ElseIf _Prog57 = 504 Then
            _eb.lokSteuern(57, Klassen.LokEigenschaften.Geschwindigkeit, Stufe2)
        ElseIf _Prog57 = 505 Then
            _eb.lokSteuern(57, Klassen.LokEigenschaften.Geschwindigkeit, 0)

        Else
            _Prog57 = 0
            Prog_Lok57.Stop()
            Prog_Lok57.Interval = 200
            If Betriebsart = 1 Then
                SetProgramCounterLabel1(String.Empty)
            Else
                SetProgramCounterLabel(String.Empty)
            End If
        End If
        _Prog57 = _Prog57 + 1
    End Sub
    Private Sub HandleTimerElapsed70(sender As System.Object, e As System.EventArgs) Handles Prog_Lok58.Elapsed

        '*** Fahrprogramm für bayerische Gattung B VI
        '*** Datum: 23.02.2020

        SetText(TextBox1, "bayerische B VI                                                         IBS: 16.09.2025")
        LoadImage(PictureBox1, "H:\\EB_Media\\LokFotos\\Baureihe_BVI_01.jpg")
        GeschwindikeitenSetzen(58)

        Dim Stufe1, Stufe2, Stufe3, Stufe4 As Integer
        Dim Stufe11, Stufe12, Stufe13, Stufe14, Stufe21, Stufe22, Stufe23, Stufe24 As Integer
        Dim V_100, V_130, V_160, V_180, V_500 As Integer
        Dim T_100, T_130, T_160, T_180, T_500 As Integer
        Dim G_200 As Integer

        T_100 = _Betriebsparameter.Fahrparameter(58, KlausEBspecific.Betriebsparameter.FahrparameterEnum.T_100)
        T_130 = _Betriebsparameter.Fahrparameter(58, KlausEBspecific.Betriebsparameter.FahrparameterEnum.T_130)
        T_160 = _Betriebsparameter.Fahrparameter(58, KlausEBspecific.Betriebsparameter.FahrparameterEnum.T_160)
        T_180 = _Betriebsparameter.Fahrparameter(58, KlausEBspecific.Betriebsparameter.FahrparameterEnum.T_180)
        T_500 = _Betriebsparameter.Fahrparameter(58, KlausEBspecific.Betriebsparameter.FahrparameterEnum.T_500)
        V_100 = _Betriebsparameter.Fahrparameter(58, KlausEBspecific.Betriebsparameter.FahrparameterEnum.V_100)
        V_130 = _Betriebsparameter.Fahrparameter(58, KlausEBspecific.Betriebsparameter.FahrparameterEnum.V_130)
        V_160 = _Betriebsparameter.Fahrparameter(58, KlausEBspecific.Betriebsparameter.FahrparameterEnum.V_160)
        V_180 = _Betriebsparameter.Fahrparameter(58, KlausEBspecific.Betriebsparameter.FahrparameterEnum.V_180)
        V_500 = _Betriebsparameter.Fahrparameter(58, KlausEBspecific.Betriebsparameter.FahrparameterEnum.V_500)
        G_200 = _Betriebsparameter.Fahrparameter(58, KlausEBspecific.Betriebsparameter.FahrparameterEnum.G_200)

        If A_StopB = 1 Then
            V_100 = 8000
        End If

        Stufe1 = _LokStufen.Holen(58, 1)
        Stufe2 = _LokStufen.Holen(58, 2)
        Stufe3 = _LokStufen.Holen(58, 3)
        Stufe4 = _LokStufen.Holen(58, 4)

        If Stufe2 = 1 Then
            T_100 = T_100
            T_130 = T_130
            T_160 = T_160
            V_180 = V_180
        ElseIf Stufe2 = 2 Then
            T_100 = T_100 + 300
            T_130 = T_130 + 300
            T_160 = T_160 + 300
            V_180 = V_180 + 500
        ElseIf Stufe2 = 3 Then
            T_100 = T_100 + 500
            T_130 = T_130 + 500
            T_160 = T_160 + 500
            V_180 = V_180 + 1000
        ElseIf Stufe2 = 4 Then
            T_100 = T_100 + 700
            T_130 = T_130 + 700
            T_160 = T_160 + 700
            V_180 = V_180 + 1500
        ElseIf Stufe2 = 5 Then
            T_100 = T_100 + 900
            T_130 = T_130 + 900
            T_160 = T_160 + 900
            V_180 = V_180 + 2000
        ElseIf Stufe2 = 6 Then
            T_100 = T_100 + 1200
            T_130 = T_130 + 1200
            T_160 = T_160 + 1200
            V_180 = V_180 + 2500
        Else
            T_100 = T_100 + 1200
            T_130 = T_130 + 1200
            T_160 = T_160 + 1200
            V_180 = V_180 + 2500
        End If

        Stufe2 = Stufe1

        Stufe11 = Stufe1 + 1
        If Stufe11 > Stufe3 Then
            Stufe11 = Stufe3
        End If
        Stufe12 = Stufe1 + 2
        If Stufe12 > Stufe3 Then
            Stufe12 = Stufe3
        End If
        Stufe13 = Stufe1 + 3
        If Stufe13 > Stufe3 Then
            Stufe13 = Stufe3
        End If
        Stufe14 = Stufe1 + 4
        If Stufe14 > Stufe3 Then
            Stufe14 = Stufe3
        End If

        Stufe21 = Stufe2 + 1
        If Stufe21 > Stufe3 Then
            Stufe21 = Stufe3
        End If
        Stufe22 = Stufe2 + 2
        If Stufe22 > Stufe3 Then
            Stufe22 = Stufe3
        End If
        Stufe23 = Stufe2 + 3
        If Stufe23 > Stufe3 Then
            Stufe23 = Stufe3
        End If
        Stufe24 = Stufe2 + 4
        If Stufe24 > Stufe3 Then
            Stufe24 = Stufe3
        End If
        If G_200 > 0 Then
            If G_200 < Stufe4 Then
                G_200 = Stufe4
            End If
        Else
            G_200 = Stufe4
        End If

        If Betriebsart = 1 And (_GlsL58 = 3 Or _GlsL58 = 4) Then
            SetProgramCounterLabel1(_Prog58)
        Else
            SetProgramCounterLabel(_Prog58)
        End If

        ' Lok starten - Bahnhofsausfahrt

        If _Prog58 = 0 Then
            If _Fahrzeugbeleuchtung2 > 0 Then
                _eb.lokSteuern(58, Klassen.LokEigenschaften.Hauptfunktion, 1) ' Licht ein
            End If
            Prog_Lok58.Interval = 2000
        ElseIf _Prog58 = 1 Then
            If _Motor > 0 Then
                _eb.lokSteuern(58, Klassen.LokEigenschaften.Funktion2, 1) ' Motor ein
            End If
        ElseIf _Prog58 = 2 Then
            _Betriebsparameter.RundenErhoehen(58)
        ElseIf _Prog58 = 3 Then
        ElseIf _Prog58 = 4 Then
        ElseIf _Prog58 = 5 Then
        ElseIf _Prog58 = 6 Then
        ElseIf _Prog58 = 7 Then
        ElseIf _Prog58 = 8 Then

            ' Bahnhofsausfahrt

        ElseIf _Prog58 = 9 Then
            _eb.lokSteuern(58, Klassen.LokEigenschaften.Geschwindigkeit, Stufe1)
        ElseIf _Prog58 = 10 Then
            _eb.lokSteuern(58, Klassen.LokEigenschaften.Geschwindigkeit, Stufe11)
        ElseIf _Prog58 = 11 Then
            _eb.lokSteuern(58, Klassen.LokEigenschaften.Geschwindigkeit, Stufe12)
        ElseIf _Prog58 = 12 Then
            _eb.lokSteuern(58, Klassen.LokEigenschaften.Geschwindigkeit, Stufe13)
        ElseIf _Prog58 = 13 Then
            _eb.lokSteuern(58, Klassen.LokEigenschaften.Geschwindigkeit, Stufe14)
        ElseIf _Prog58 = 14 Then
            _eb.lokSteuern(58, Klassen.LokEigenschaften.Geschwindigkeit, Stufe3)
        ElseIf _Prog58 = 15 Then
            Prog_Lok58.Interval = 2000
        ElseIf _Prog58 = 16 Then
        ElseIf _Prog58 = 17 Then
            If _Motor < 2 Then
                _eb.lokSteuern(58, Klassen.LokEigenschaften.Funktion2, 0) ' Motor aus
            End If

            ' Lok abstellen

        ElseIf _Prog58 = 50 Then
            If _Motor < 3 Then
                _eb.lokSteuern(58, Klassen.LokEigenschaften.Funktion2, 0) ' Motor aus
            End If
            Prog_Lok58.Interval = 2000
        ElseIf _Prog58 = 51 Then
        ElseIf _Prog58 = 52 Then
            If _Fahrzeugbeleuchtung2 < 2 Then
                _eb.lokSteuern(58, Klassen.LokEigenschaften.Hauptfunktion, 0) ' Licht aus
            End If

            ' Lok bremsen (Bahnhofseinfahrt Normalzug von links und von rechts)

        ElseIf _Prog58 = 100 Then
            Prog_Lok58.Interval = V_100
        ElseIf _Prog58 = 101 Then
            _eb.lokSteuern(58, Klassen.LokEigenschaften.Geschwindigkeit, Stufe24)
            Prog_Lok58.Interval = T_100
        ElseIf _Prog58 = 102 Then
            _eb.lokSteuern(58, Klassen.LokEigenschaften.Geschwindigkeit, Stufe23)
        ElseIf _Prog58 = 103 Then
            _eb.lokSteuern(58, Klassen.LokEigenschaften.Geschwindigkeit, Stufe22)
        ElseIf _Prog58 = 104 Then
            _eb.lokSteuern(58, Klassen.LokEigenschaften.Geschwindigkeit, Stufe21)
        ElseIf _Prog58 = 105 Then
            _eb.lokSteuern(58, Klassen.LokEigenschaften.Geschwindigkeit, Stufe2)

            ' Lok bremsen (Bahnhofseinfahrt Kurzzug von links)

        ElseIf _Prog58 = 130 Then
            If _Motor > 0 Then
                _eb.lokSteuern(58, Klassen.LokEigenschaften.Funktion2, 1) ' Motor ein
            End If
            Prog_Lok58.Interval = V_130
        ElseIf _Prog58 = 131 Then
            _eb.lokSteuern(58, Klassen.LokEigenschaften.Geschwindigkeit, Stufe24)
            Prog_Lok58.Interval = T_130
        ElseIf _Prog58 = 132 Then
            _eb.lokSteuern(58, Klassen.LokEigenschaften.Geschwindigkeit, Stufe23)
        ElseIf _Prog58 = 133 Then
            _eb.lokSteuern(58, Klassen.LokEigenschaften.Geschwindigkeit, Stufe22)
        ElseIf _Prog58 = 134 Then
            _eb.lokSteuern(58, Klassen.LokEigenschaften.Geschwindigkeit, Stufe21)
        ElseIf _Prog58 = 135 Then
            _eb.lokSteuern(58, Klassen.LokEigenschaften.Geschwindigkeit, Stufe2)
        ElseIf _Prog58 = 136 Then
            _eb.lokSteuern(58, Klassen.LokEigenschaften.Geschwindigkeit, 0)
            Prog_Lok58.Interval = 2000
        ElseIf _Prog58 = 137 Then
            If _Motor < 3 Then
                _eb.lokSteuern(58, Klassen.LokEigenschaften.Funktion2, 0) ' Motor aus
            End If
        ElseIf _Prog58 = 138 Then
        ElseIf _Prog58 = 139 Then
            If _Fahrzeugbeleuchtung2 < 2 Then
                _eb.lokSteuern(58, Klassen.LokEigenschaften.Hauptfunktion, 0) ' Licht aus
            End If

            ' Lok bremsen (Bahnhofseinfahrt Kurzzug von rechts)

        ElseIf _Prog58 = 160 Then
            Prog_Lok58.Interval = V_160
        ElseIf _Prog58 = 161 Then
            _eb.lokSteuern(58, Klassen.LokEigenschaften.Geschwindigkeit, Stufe24)
            Prog_Lok58.Interval = T_160
        ElseIf _Prog58 = 162 Then
            _eb.lokSteuern(58, Klassen.LokEigenschaften.Geschwindigkeit, Stufe23)
        ElseIf _Prog58 = 163 Then
            _eb.lokSteuern(58, Klassen.LokEigenschaften.Geschwindigkeit, Stufe22)
        ElseIf _Prog58 = 164 Then
            _eb.lokSteuern(58, Klassen.LokEigenschaften.Geschwindigkeit, Stufe21)
        ElseIf _Prog58 = 165 Then
            _eb.lokSteuern(58, Klassen.LokEigenschaften.Geschwindigkeit, Stufe2)
        ElseIf _Prog58 = 166 Then
            _eb.lokSteuern(58, Klassen.LokEigenschaften.Geschwindigkeit, 0)
            Prog_Lok58.Interval = 2000
        ElseIf _Prog58 = 167 Then
            If _Motor < 3 Then
                _eb.lokSteuern(58, Klassen.LokEigenschaften.Funktion2, 0) ' Motor aus
            End If
        ElseIf _Prog58 = 168 Then
        ElseIf _Prog58 = 169 Then
            If _Fahrzeugbeleuchtung2 < 2 Then
                _eb.lokSteuern(58, Klassen.LokEigenschaften.Hauptfunktion, 0) ' Licht aus
            End If

            ' Rangierzug

        ElseIf _Prog58 = 180 Then
            _eb.lokSteuern(58, Klassen.LokEigenschaften.Geschwindigkeit, 2)
            Prog_Lok58.Interval = V_180
        ElseIf _Prog58 = 181 Then
            Prog_Lok58.Interval = T_180
            _eb.lokSteuern(58, Klassen.LokEigenschaften.Geschwindigkeit, 1)
        ElseIf _Prog58 = 182 Then
            _eb.lokSteuern(58, Klassen.LokEigenschaften.Geschwindigkeit, 0)

            ' Tunnelausfahrt

        ElseIf _Prog58 = 200 Then ' Kontakt 1.2 <- (bergauf)
            _eb.lokSteuern(58, Klassen.LokEigenschaften.Geschwindigkeit, G_200)
            Prog_Lok58.Interval = 2000
        ElseIf _Prog58 = 201 Then
        ElseIf _Prog58 = 202 Then
        ElseIf _Prog58 = 203 Then
        ElseIf _Prog58 = 204 Then
        ElseIf _Prog58 = 205 Then
            If Stufe4 < Stufe3 Then
                _eb.lokSteuern(58, Klassen.LokEigenschaften.Geschwindigkeit, Stufe3)
            Else
                _eb.lokSteuern(58, Klassen.LokEigenschaften.Geschwindigkeit, Stufe4)
            End If

        ElseIf _Prog58 = 220 Then ' Kontakt 3.1 -> (hinter dem Martinstor bergauf)
            Prog_Lok58.Interval = 2000
        ElseIf _Prog58 = 221 Then
        ElseIf _Prog58 = 222 Then

        ElseIf _Prog58 = 240 Then ' Kontakt 3.7 <- (hinter der Brücke bergauf)
            Prog_Lok58.Interval = 2000
        ElseIf _Prog58 = 241 Then
        ElseIf _Prog58 = 242 Then

        ElseIf _Prog58 = 260 Then ' Kontakt 3.3 (links bzw vor der Brücke)
            Prog_Lok58.Interval = 2000
        ElseIf _Prog58 = 261 Then
        ElseIf _Prog58 = 262 Then
            _eb.lokSteuern(58, Klassen.LokEigenschaften.Geschwindigkeit, Stufe3)

        ElseIf _Prog58 = 600 Then ' Kontakt 3.5 <- (unter der Burg)
            Prog_Lok58.Interval = 2000
        ElseIf _Prog58 = 601 Then
        ElseIf _Prog58 = 602 Then

        ElseIf _Prog58 = 620 Then ' Kontakt 3.7 -> (hinter der Brücke bergab)
            Prog_Lok58.Interval = 2000
        ElseIf _Prog58 = 621 Then
        ElseIf _Prog58 = 622 Then

        ElseIf _Prog58 = 640 Then ' Kontakt 3.1 <- Talfahrt
            Prog_Lok58.Interval = 2000
        ElseIf _Prog58 = 641 Then
        ElseIf _Prog58 = 642 Then

        ElseIf _Prog58 = 660 Then ' Kontakt 1.2 -> Talfahrt
            Prog_Lok58.Interval = 2000
        ElseIf _Prog58 = 661 Then
        ElseIf _Prog58 = 662 Then

        ElseIf _Prog58 = 700 Then ' Kontakt 0.4 <- Diagonale
            Prog_Lok58.Interval = 2000
        ElseIf _Prog58 = 701 Then
        ElseIf _Prog58 = 702 Then

            ' Zindelstein

        ElseIf _Prog58 = 500 Then
            Prog_Lok58.Interval = V_500
        ElseIf _Prog58 = 501 Then
            _eb.lokSteuern(58, Klassen.LokEigenschaften.Geschwindigkeit, Stufe23)
            Prog_Lok58.Interval = T_500
        ElseIf _Prog58 = 502 Then
            _eb.lokSteuern(58, Klassen.LokEigenschaften.Geschwindigkeit, Stufe22)
        ElseIf _Prog58 = 503 Then
            _eb.lokSteuern(58, Klassen.LokEigenschaften.Geschwindigkeit, Stufe21)
        ElseIf _Prog58 = 504 Then
            _eb.lokSteuern(58, Klassen.LokEigenschaften.Geschwindigkeit, Stufe2)
        ElseIf _Prog58 = 505 Then
            _eb.lokSteuern(58, Klassen.LokEigenschaften.Geschwindigkeit, 0)

        Else
            _Prog58 = 0
            Prog_Lok58.Stop()
            Prog_Lok58.Interval = 200
            If Betriebsart = 1 Then
                SetProgramCounterLabel1(String.Empty)
            Else
                SetProgramCounterLabel(String.Empty)
            End If
        End If
        _Prog58 = _Prog58 + 1
    End Sub
    Private Sub HandleTimerElapsed71(sender As System.Object, e As System.EventArgs) Handles Prog_Lok59.Elapsed

        '*** Fahrprogramm für "Glaskasten" 4541
        '*** Datum: 23.02.2020

        SetText(TextBox1, "Dampflok Glaskasten 4541                                                IBS: 20.09.2025 V3: ")
        LoadImage(PictureBox1, "H:\\EB_Media\\LokFotos\\Baureihe_Glas_01.jpg")
        GeschwindikeitenSetzen(59)

        Dim Stufe1, Stufe2, Stufe3, Stufe4 As Integer
        Dim Stufe11, Stufe12, Stufe13, Stufe14, Stufe21, Stufe22, Stufe23, Stufe24 As Integer
        Dim V_100, V_130, V_160, V_180, V_500 As Integer
        Dim T_100, T_130, T_160, T_180, T_500 As Integer
        Dim G_200 As Integer

        T_100 = _Betriebsparameter.Fahrparameter(59, KlausEBspecific.Betriebsparameter.FahrparameterEnum.T_100)
        T_130 = _Betriebsparameter.Fahrparameter(59, KlausEBspecific.Betriebsparameter.FahrparameterEnum.T_130)
        T_160 = _Betriebsparameter.Fahrparameter(59, KlausEBspecific.Betriebsparameter.FahrparameterEnum.T_160)
        T_180 = _Betriebsparameter.Fahrparameter(59, KlausEBspecific.Betriebsparameter.FahrparameterEnum.T_180)
        T_500 = _Betriebsparameter.Fahrparameter(59, KlausEBspecific.Betriebsparameter.FahrparameterEnum.T_500)
        V_100 = _Betriebsparameter.Fahrparameter(59, KlausEBspecific.Betriebsparameter.FahrparameterEnum.V_100)
        V_130 = _Betriebsparameter.Fahrparameter(59, KlausEBspecific.Betriebsparameter.FahrparameterEnum.V_130)
        V_160 = _Betriebsparameter.Fahrparameter(59, KlausEBspecific.Betriebsparameter.FahrparameterEnum.V_160)
        V_180 = _Betriebsparameter.Fahrparameter(59, KlausEBspecific.Betriebsparameter.FahrparameterEnum.V_180)
        V_500 = _Betriebsparameter.Fahrparameter(59, KlausEBspecific.Betriebsparameter.FahrparameterEnum.V_500)
        G_200 = _Betriebsparameter.Fahrparameter(59, KlausEBspecific.Betriebsparameter.FahrparameterEnum.G_200)

        If A_StopB = 1 Then
            V_100 = 8000
        End If

        Stufe1 = _LokStufen.Holen(59, 1)
        Stufe2 = _LokStufen.Holen(59, 2)
        Stufe3 = _LokStufen.Holen(59, 3)
        Stufe4 = _LokStufen.Holen(59, 4)

        If Stufe2 = 1 Then
            T_100 = T_100
            T_130 = T_130
            T_160 = T_160
            V_180 = V_180
        ElseIf Stufe2 = 2 Then
            T_100 = T_100 + 300
            T_130 = T_130 + 300
            T_160 = T_160 + 300
            V_180 = V_180 + 500
        ElseIf Stufe2 = 3 Then
            T_100 = T_100 + 500
            T_130 = T_130 + 500
            T_160 = T_160 + 500
            V_180 = V_180 + 1000
        ElseIf Stufe2 = 4 Then
            T_100 = T_100 + 700
            T_130 = T_130 + 700
            T_160 = T_160 + 700
            V_180 = V_180 + 1500
        ElseIf Stufe2 = 5 Then
            T_100 = T_100 + 900
            T_130 = T_130 + 900
            T_160 = T_160 + 900
            V_180 = V_180 + 2000
        ElseIf Stufe2 = 6 Then
            T_100 = T_100 + 1200
            T_130 = T_130 + 1200
            T_160 = T_160 + 1200
            V_180 = V_180 + 2500
        Else
            T_100 = T_100 + 1200
            T_130 = T_130 + 1200
            T_160 = T_160 + 1200
            V_180 = V_180 + 2500
        End If

        Stufe2 = Stufe1

        Stufe11 = Stufe1 + 1
        If Stufe11 > Stufe3 Then
            Stufe11 = Stufe3
        End If
        Stufe12 = Stufe1 + 2
        If Stufe12 > Stufe3 Then
            Stufe12 = Stufe3
        End If
        Stufe13 = Stufe1 + 3
        If Stufe13 > Stufe3 Then
            Stufe13 = Stufe3
        End If
        Stufe14 = Stufe1 + 4
        If Stufe14 > Stufe3 Then
            Stufe14 = Stufe3
        End If

        Stufe21 = Stufe2 + 1
        If Stufe21 > Stufe3 Then
            Stufe21 = Stufe3
        End If
        Stufe22 = Stufe2 + 2
        If Stufe22 > Stufe3 Then
            Stufe22 = Stufe3
        End If
        Stufe23 = Stufe2 + 3
        If Stufe23 > Stufe3 Then
            Stufe23 = Stufe3
        End If
        Stufe24 = Stufe2 + 5
        If Stufe24 > Stufe3 Then
            Stufe24 = Stufe3
        End If
        If G_200 > 0 Then
            If G_200 < Stufe4 Then
                G_200 = Stufe4
            End If
        Else
            G_200 = Stufe4
        End If

        If Betriebsart = 1 And (_GlsL59 = 3 Or _GlsL59 = 4) Then
            SetProgramCounterLabel1(_Prog59)
        Else
            SetProgramCounterLabel(_Prog59)
        End If

        ' Lok starten - Bahnhofsausfahrt

        If _Prog59 = 0 Then
            Prog_Lok59.Interval = 2000
            If _Fahrzeugbeleuchtung2 > 0 Then
                _eb.lokSteuern(59, Klassen.LokEigenschaften.Hauptfunktion, 1) ' Licht ein
            End If
        ElseIf _Prog59 = 1 Then
        ElseIf _Prog59 = 2 Then
            _Betriebsparameter.RundenErhoehen(59)
        ElseIf _Prog59 = 3 Then
        ElseIf _Prog59 = 4 Then
        ElseIf _Prog59 = 5 Then

            ' Bahnhofsausfahrt

        ElseIf _Prog59 = 6 Then
            _eb.lokSteuern(59, Klassen.LokEigenschaften.Geschwindigkeit, Stufe1)
        ElseIf _Prog59 = 7 Then
            _eb.lokSteuern(59, Klassen.LokEigenschaften.Geschwindigkeit, Stufe11)
        ElseIf _Prog59 = 8 Then
            _eb.lokSteuern(59, Klassen.LokEigenschaften.Geschwindigkeit, Stufe12)
        ElseIf _Prog59 = 9 Then
            _eb.lokSteuern(59, Klassen.LokEigenschaften.Geschwindigkeit, Stufe13)
        ElseIf _Prog59 = 10 Then
            _eb.lokSteuern(59, Klassen.LokEigenschaften.Geschwindigkeit, Stufe14)
        ElseIf _Prog59 = 11 Then
            _eb.lokSteuern(59, Klassen.LokEigenschaften.Geschwindigkeit, Stufe3)

            ' Lok abstellen

        ElseIf _Prog59 = 50 Then
            Prog_Lok59.Interval = 2000
        ElseIf _Prog59 = 51 Then
        ElseIf _Prog59 = 52 Then
            If _Fahrzeugbeleuchtung2 < 2 Then
                _eb.lokSteuern(59, Klassen.LokEigenschaften.Hauptfunktion, 0) ' Licht aus
            End If

            ' Lok bremsen (Bahnhofseinfahrt Normalzug von links und von rechts)

        ElseIf _Prog59 = 100 Then
            Prog_Lok59.Interval = V_100
        ElseIf _Prog59 = 101 Then
            _eb.lokSteuern(59, Klassen.LokEigenschaften.Geschwindigkeit, Stufe24)
            Prog_Lok59.Interval = T_100
        ElseIf _Prog59 = 102 Then
            _eb.lokSteuern(59, Klassen.LokEigenschaften.Geschwindigkeit, Stufe23)
        ElseIf _Prog59 = 103 Then
            _eb.lokSteuern(59, Klassen.LokEigenschaften.Geschwindigkeit, Stufe22)
        ElseIf _Prog59 = 104 Then
            _eb.lokSteuern(59, Klassen.LokEigenschaften.Geschwindigkeit, Stufe21)
        ElseIf _Prog59 = 105 Then
            _eb.lokSteuern(59, Klassen.LokEigenschaften.Geschwindigkeit, Stufe2)

            ' Lok bremsen (Bahnhofseinfahrt Kurzzug von links)

        ElseIf _Prog59 = 130 Then
            Prog_Lok59.Interval = V_130
        ElseIf _Prog59 = 131 Then
            _eb.lokSteuern(59, Klassen.LokEigenschaften.Geschwindigkeit, Stufe24)
            Prog_Lok59.Interval = T_130
        ElseIf _Prog59 = 132 Then
            _eb.lokSteuern(59, Klassen.LokEigenschaften.Geschwindigkeit, Stufe23)
        ElseIf _Prog59 = 133 Then
            _eb.lokSteuern(59, Klassen.LokEigenschaften.Geschwindigkeit, Stufe22)
        ElseIf _Prog59 = 134 Then
            _eb.lokSteuern(59, Klassen.LokEigenschaften.Geschwindigkeit, Stufe21)
        ElseIf _Prog59 = 135 Then
            _eb.lokSteuern(59, Klassen.LokEigenschaften.Geschwindigkeit, Stufe2)
        ElseIf _Prog59 = 136 Then
            _eb.lokSteuern(59, Klassen.LokEigenschaften.Geschwindigkeit, 0)
        ElseIf _Prog59 = 137 Then
            Prog_Lok59.Interval = 2000
        ElseIf _Prog59 = 138 Then
            If _Fahrzeugbeleuchtung2 < 2 Then
                _eb.lokSteuern(59, Klassen.LokEigenschaften.Hauptfunktion, 0) ' Licht aus
            End If

            ' Lok bremsen (Bahnhofseinfahrt Kurzzug von rechts)

        ElseIf _Prog59 = 160 Then
            Prog_Lok59.Interval = V_160
        ElseIf _Prog59 = 161 Then
            _eb.lokSteuern(59, Klassen.LokEigenschaften.Geschwindigkeit, Stufe24)
            Prog_Lok59.Interval = T_160
        ElseIf _Prog59 = 162 Then
            _eb.lokSteuern(59, Klassen.LokEigenschaften.Geschwindigkeit, Stufe23)
        ElseIf _Prog59 = 163 Then
            _eb.lokSteuern(59, Klassen.LokEigenschaften.Geschwindigkeit, Stufe22)
        ElseIf _Prog59 = 164 Then
            _eb.lokSteuern(59, Klassen.LokEigenschaften.Geschwindigkeit, Stufe21)
        ElseIf _Prog59 = 165 Then
            _eb.lokSteuern(59, Klassen.LokEigenschaften.Geschwindigkeit, Stufe2)
        ElseIf _Prog59 = 166 Then
            _eb.lokSteuern(59, Klassen.LokEigenschaften.Geschwindigkeit, 0)
        ElseIf _Prog59 = 167 Then
            Prog_Lok59.Interval = 2000
        ElseIf _Prog59 = 168 Then
            If _Fahrzeugbeleuchtung2 < 2 Then
                _eb.lokSteuern(59, Klassen.LokEigenschaften.Hauptfunktion, 0) ' Licht aus
            End If

            ' Rangierzug

        ElseIf _Prog59 = 180 Then
            _eb.lokSteuern(59, Klassen.LokEigenschaften.Geschwindigkeit, 2)
            Prog_Lok59.Interval = V_180
        ElseIf _Prog59 = 181 Then
            Prog_Lok59.Interval = T_180
            _eb.lokSteuern(59, Klassen.LokEigenschaften.Geschwindigkeit, 1)
        ElseIf _Prog59 = 182 Then
            _eb.lokSteuern(59, Klassen.LokEigenschaften.Geschwindigkeit, 0)

            ' Tunnelausfahrt

        ElseIf _Prog59 = 200 Then ' Kontakt 1.2 <- (bergauf)
            _eb.lokSteuern(59, Klassen.LokEigenschaften.Geschwindigkeit, G_200)
            Prog_Lok59.Interval = 2000
        ElseIf _Prog59 = 201 Then
        ElseIf _Prog59 = 202 Then
        ElseIf _Prog59 = 203 Then
        ElseIf _Prog59 = 204 Then
        ElseIf _Prog59 = 205 Then
            If Stufe4 < Stufe3 Then
                _eb.lokSteuern(59, Klassen.LokEigenschaften.Geschwindigkeit, Stufe3)
            Else
                _eb.lokSteuern(59, Klassen.LokEigenschaften.Geschwindigkeit, Stufe4)
            End If

        ElseIf _Prog59 = 220 Then ' Kontakt 3.1 -> (hinter dem Martinstor bergauf)
            Prog_Lok59.Interval = 2000
        ElseIf _Prog59 = 221 Then
        ElseIf _Prog59 = 222 Then

        ElseIf _Prog59 = 240 Then ' Kontakt 3.7 <- (hinter der Brücke bergauf)
            Prog_Lok59.Interval = 2000
        ElseIf _Prog59 = 241 Then
        ElseIf _Prog59 = 242 Then

        ElseIf _Prog59 = 260 Then ' Kontakt 3.3 (links bzw vor der Brücke)
            Prog_Lok59.Interval = 2000
        ElseIf _Prog59 = 261 Then
        ElseIf _Prog59 = 262 Then
            _eb.lokSteuern(59, Klassen.LokEigenschaften.Geschwindigkeit, Stufe3)

        ElseIf _Prog59 = 600 Then ' Kontakt 3.5 <- (unter der Burg)
            Prog_Lok59.Interval = 2000
        ElseIf _Prog59 = 601 Then
        ElseIf _Prog59 = 602 Then

        ElseIf _Prog59 = 620 Then ' Kontakt 3.7 -> (hinter der Brücke bergab)
            Prog_Lok59.Interval = 2000
        ElseIf _Prog59 = 621 Then
        ElseIf _Prog59 = 622 Then

        ElseIf _Prog59 = 640 Then ' Kontakt 3.1 <- Talfahrt
            Prog_Lok59.Interval = 2000
        ElseIf _Prog59 = 641 Then
        ElseIf _Prog59 = 642 Then

        ElseIf _Prog59 = 660 Then ' Kontakt 1.2 -> Talfahrt
            Prog_Lok59.Interval = 2000
        ElseIf _Prog59 = 661 Then
        ElseIf _Prog59 = 662 Then

        ElseIf _Prog59 = 700 Then ' Kontakt 0.4 <- Diagonale
            Prog_Lok59.Interval = 2000
        ElseIf _Prog59 = 701 Then
        ElseIf _Prog59 = 702 Then

            ' Zindelstein

        ElseIf _Prog59 = 500 Then
            Prog_Lok59.Interval = V_500
        ElseIf _Prog59 = 501 Then
            _eb.lokSteuern(59, Klassen.LokEigenschaften.Geschwindigkeit, Stufe23)
            Prog_Lok59.Interval = T_500
        ElseIf _Prog59 = 502 Then
            _eb.lokSteuern(59, Klassen.LokEigenschaften.Geschwindigkeit, Stufe22)
        ElseIf _Prog59 = 503 Then
            _eb.lokSteuern(59, Klassen.LokEigenschaften.Geschwindigkeit, Stufe21)
        ElseIf _Prog59 = 504 Then
            _eb.lokSteuern(59, Klassen.LokEigenschaften.Geschwindigkeit, Stufe2)
        ElseIf _Prog59 = 505 Then
            _eb.lokSteuern(59, Klassen.LokEigenschaften.Geschwindigkeit, 0)

        Else
            _Prog59 = 0
            Prog_Lok59.Stop()
            Prog_Lok59.Interval = 200
            If Betriebsart = 1 Then
                SetProgramCounterLabel1(String.Empty)
            Else
                SetProgramCounterLabel(String.Empty)
            End If
        End If
        _Prog59 = _Prog59 + 1
    End Sub
    Private Sub HandleTimerElapsed72(sender As System.Object, e As System.EventArgs) Handles Prog_Lok60.Elapsed

        '*** Fahrprogramm für Schienenbus 798 716-7
        '*** Datum: 17.07.2020

        SetText(TextBox1, "Schienenbus 798 716-7                                                   IBS: 11.10.2021 - V3 : 9")
        LoadImage(PictureBox1, "H:\\EB_Media\\LokFotos\\Baureihe_798_02.jpg")
        GeschwindikeitenSetzen(60)

        Dim Stufe1, Stufe2, Stufe3, Stufe4 As Integer
        Dim Stufe11, Stufe12, Stufe13, Stufe14, Stufe21, Stufe22, Stufe23, Stufe24 As Integer
        Dim V_100, V_130, V_160, V_180, V_500 As Integer
        Dim T_100, T_130, T_160, T_180, T_500 As Integer
        Dim G_200 As Integer

        T_100 = _Betriebsparameter.Fahrparameter(60, KlausEBspecific.Betriebsparameter.FahrparameterEnum.T_100)
        T_130 = _Betriebsparameter.Fahrparameter(60, KlausEBspecific.Betriebsparameter.FahrparameterEnum.T_130)
        T_160 = _Betriebsparameter.Fahrparameter(60, KlausEBspecific.Betriebsparameter.FahrparameterEnum.T_160)
        T_180 = _Betriebsparameter.Fahrparameter(60, KlausEBspecific.Betriebsparameter.FahrparameterEnum.T_180)
        T_500 = _Betriebsparameter.Fahrparameter(60, KlausEBspecific.Betriebsparameter.FahrparameterEnum.T_500)
        V_100 = _Betriebsparameter.Fahrparameter(60, KlausEBspecific.Betriebsparameter.FahrparameterEnum.V_100)
        V_130 = _Betriebsparameter.Fahrparameter(60, KlausEBspecific.Betriebsparameter.FahrparameterEnum.V_130)
        V_160 = _Betriebsparameter.Fahrparameter(60, KlausEBspecific.Betriebsparameter.FahrparameterEnum.V_160)
        V_180 = _Betriebsparameter.Fahrparameter(60, KlausEBspecific.Betriebsparameter.FahrparameterEnum.V_180)
        V_500 = _Betriebsparameter.Fahrparameter(60, KlausEBspecific.Betriebsparameter.FahrparameterEnum.V_500)
        G_200 = _Betriebsparameter.Fahrparameter(60, KlausEBspecific.Betriebsparameter.FahrparameterEnum.G_200)

        If A_StopB = 1 Then
            V_100 = 8000
        End If

        Stufe1 = _LokStufen.Holen(60, 1)
        Stufe2 = _LokStufen.Holen(60, 2)
        Stufe3 = _LokStufen.Holen(60, 3)
        Stufe4 = _LokStufen.Holen(60, 4)

        If Stufe2 = 1 Then
            T_100 = T_100
            T_130 = T_130
            T_160 = T_160
            V_180 = V_180
        ElseIf Stufe2 = 2 Then
            T_100 = T_100 + 300
            T_130 = T_130 + 300
            T_160 = T_160 + 300
            V_180 = V_180 + 500
        ElseIf Stufe2 = 3 Then
            T_100 = T_100 + 500
            T_130 = T_130 + 500
            T_160 = T_160 + 500
            V_180 = V_180 + 1000
        ElseIf Stufe2 = 4 Then
            T_100 = T_100 + 700
            T_130 = T_130 + 700
            T_160 = T_160 + 700
            V_180 = V_180 + 1500
        ElseIf Stufe2 = 5 Then
            T_100 = T_100 + 900
            T_130 = T_130 + 900
            T_160 = T_160 + 900
            V_180 = V_180 + 2000
        ElseIf Stufe2 = 6 Then
            T_100 = T_100 + 1200
            T_130 = T_130 + 1200
            T_160 = T_160 + 1200
            V_180 = V_180 + 2500
        Else
            T_100 = T_100 + 1200
            T_130 = T_130 + 1200
            T_160 = T_160 + 1200
            V_180 = V_180 + 2500
        End If

        Stufe2 = Stufe1

        Stufe11 = Stufe1 + 1
        If Stufe11 > Stufe3 Then
            Stufe11 = Stufe3
        End If
        Stufe12 = Stufe1 + 2
        If Stufe12 > Stufe3 Then
            Stufe12 = Stufe3
        End If
        Stufe13 = Stufe1 + 3
        If Stufe13 > Stufe3 Then
            Stufe13 = Stufe3
        End If
        Stufe14 = Stufe1 + 4
        If Stufe14 > Stufe3 Then
            Stufe14 = Stufe3
        End If

        Stufe21 = Stufe2 + 1
        If Stufe21 > Stufe3 Then
            Stufe21 = Stufe3
        End If
        Stufe22 = Stufe2 + 2
        If Stufe22 > Stufe3 Then
            Stufe22 = Stufe3
        End If
        Stufe23 = Stufe2 + 3
        If Stufe23 > Stufe3 Then
            Stufe23 = Stufe3
        End If
        Stufe24 = Stufe2 + 4
        If Stufe24 > Stufe3 Then
            Stufe24 = Stufe3
        End If
        If G_200 > 0 Then
            If G_200 < Stufe4 Then
                G_200 = Stufe4
            End If
        Else
            G_200 = Stufe4
        End If

        If Betriebsart = 1 And (_GlsL60 = 3 Or _GlsL60 = 4) Then
            SetProgramCounterLabel1(_Prog60)
        Else
            SetProgramCounterLabel(_Prog60)
        End If

        ' Lok starten - Bahnhofsausfahrt

        If _Prog60 = 0 Then
            Prog_Lok60.Interval = 2000
        ElseIf _Prog60 = 1 Then
            _eb.lokSteuern(60, Klassen.LokEigenschaften.Geschwindigkeit, 0)
        ElseIf _Prog60 = 2 Then
            _eb.lokSteuern(60, Klassen.LokEigenschaften.Funktion1, 1) ' rotes Rücklicht aus
        ElseIf _Prog60 = 3 Then
            If _Fahrzeugbeleuchtung2 > 0 Then
                _eb.lokSteuern(60, Klassen.LokEigenschaften.Hauptfunktion, 1) ' Licht ein
            End If
        ElseIf _Prog60 = 4 Then
            If _Motor > 0 Then
                _eb.lokSteuern(60, Klassen.LokEigenschaften.Funktion2, 1) ' Motor ein
            Else
                _eb.lokSteuern(60, Klassen.LokEigenschaften.Funktion2, 0) ' Motor aus
            End If
        ElseIf _Prog60 = 5 Then
            _Betriebsparameter.RundenErhoehen(60)
        ElseIf _Prog60 = 6 Then
        ElseIf _Prog60 = 7 Then
        ElseIf _Prog60 = 8 Then
        ElseIf _Prog60 = 9 Then
        ElseIf _Prog60 = 10 Then
        ElseIf _Prog60 = 11 Then
            If _AkustischeSignale > 0 Then
                _eb.lokSteuern(60, Klassen.LokEigenschaften.Funktion3, 1) ' Hupe ein
            End If
        ElseIf _Prog60 = 12 Then
            _eb.lokSteuern(60, Klassen.LokEigenschaften.Funktion3, 0) ' Hupe aus

            ' Bahnhofsausfahrt

        ElseIf _Prog60 = 13 Then
            _eb.lokSteuern(34, Klassen.LokEigenschaften.Geschwindigkeit, Stufe1)
        ElseIf _Prog60 = 14 Then
            _eb.lokSteuern(60, Klassen.LokEigenschaften.Geschwindigkeit, Stufe11)
        ElseIf _Prog60 = 15 Then
            _eb.lokSteuern(60, Klassen.LokEigenschaften.Geschwindigkeit, Stufe12)
        ElseIf _Prog60 = 16 Then
            _eb.lokSteuern(60, Klassen.LokEigenschaften.Geschwindigkeit, Stufe13)
        ElseIf _Prog60 = 17 Then
            _eb.lokSteuern(60, Klassen.LokEigenschaften.Geschwindigkeit, Stufe14)
        ElseIf _Prog60 = 18 Then
            _eb.lokSteuern(60, Klassen.LokEigenschaften.Geschwindigkeit, Stufe3)
        ElseIf _Prog60 = 19 Then
        ElseIf _Prog60 = 20 Then
        ElseIf _Prog60 = 21 Then
        ElseIf _Prog60 = 22 Then
        ElseIf _Prog60 = 23 Then
        ElseIf _Prog60 = 24 Then
            If _Motor < 3 Then
                _eb.lokSteuern(60, Klassen.LokEigenschaften.Funktion2, 0) ' Motor aus
            End If

            ' Lok abstellen

        ElseIf _Prog60 = 50 Then
            Prog_Lok60.Interval = 2000
        ElseIf _Prog60 = 51 Then
            If _Motor < 3 Then
                _eb.lokSteuern(60, Klassen.LokEigenschaften.Funktion2, 0) ' Motor aus
            End If
        ElseIf _Prog60 = 52 Then
            If _Fahrzeugbeleuchtung2 < 2 Then
                _eb.lokSteuern(60, Klassen.LokEigenschaften.Hauptfunktion, 0) ' Licht aus
            End If

            ' Lok bremsen (Bahnhofseinfahrt Normalzug von links und von rechts)

        ElseIf _Prog60 = 100 Then
            Prog_Lok60.Interval = V_100
        ElseIf _Prog60 = 101 Then
            Prog_Lok60.Interval = T_100
        ElseIf _Prog60 = 102 Then
            _eb.lokSteuern(60, Klassen.LokEigenschaften.Geschwindigkeit, Stufe24)
        ElseIf _Prog60 = 103 Then
            _eb.lokSteuern(60, Klassen.LokEigenschaften.Geschwindigkeit, Stufe23)
        ElseIf _Prog60 = 104 Then
            _eb.lokSteuern(60, Klassen.LokEigenschaften.Geschwindigkeit, Stufe22)
        ElseIf _Prog60 = 105 Then
            _eb.lokSteuern(60, Klassen.LokEigenschaften.Geschwindigkeit, Stufe21)
        ElseIf _Prog60 = 106 Then
            _eb.lokSteuern(60, Klassen.LokEigenschaften.Geschwindigkeit, Stufe2)

            ' Lok bremsen (Bahnhofseinfahrt Kurzzug von links)

        ElseIf _Prog60 = 130 Then
            Prog_Lok60.Interval = V_130
        ElseIf _Prog60 = 131 Then
            Prog_Lok60.Interval = T_130
        ElseIf _Prog60 = 132 Then
            _eb.lokSteuern(60, Klassen.LokEigenschaften.Geschwindigkeit, Stufe24)
        ElseIf _Prog60 = 133 Then
            _eb.lokSteuern(60, Klassen.LokEigenschaften.Geschwindigkeit, Stufe23)
        ElseIf _Prog60 = 134 Then
            _eb.lokSteuern(60, Klassen.LokEigenschaften.Geschwindigkeit, Stufe22)
        ElseIf _Prog60 = 135 Then
            _eb.lokSteuern(60, Klassen.LokEigenschaften.Geschwindigkeit, Stufe21)
        ElseIf _Prog60 = 136 Then
            _eb.lokSteuern(60, Klassen.LokEigenschaften.Geschwindigkeit, Stufe2)
        ElseIf _Prog60 = 137 Then
            _eb.lokSteuern(60, Klassen.LokEigenschaften.Geschwindigkeit, 0)
        ElseIf _Prog60 = 138 Then
            Prog_Lok60.Interval = 2000
        ElseIf _Prog60 = 139 Then
            If _Motor < 3 Then
                _eb.lokSteuern(60, Klassen.LokEigenschaften.Funktion2, 0) ' Motor aus
            End If
        ElseIf _Prog60 = 140 Then
        ElseIf _Prog60 = 141 Then
            If _Fahrzeugbeleuchtung2 < 2 Then
                _eb.lokSteuern(60, Klassen.LokEigenschaften.Hauptfunktion, 0) ' Licht aus
            End If

            ' Lok bremsen (Bahnhofseinfahrt Kurzzug von rechts)

        ElseIf _Prog60 = 160 Then
            Prog_Lok60.Interval = V_160
        ElseIf _Prog60 = 161 Then
            Prog_Lok60.Interval = T_160
        ElseIf _Prog60 = 162 Then
            _eb.lokSteuern(60, Klassen.LokEigenschaften.Geschwindigkeit, Stufe24)
        ElseIf _Prog60 = 163 Then
            _eb.lokSteuern(60, Klassen.LokEigenschaften.Geschwindigkeit, Stufe23)
        ElseIf _Prog60 = 164 Then
            _eb.lokSteuern(60, Klassen.LokEigenschaften.Geschwindigkeit, Stufe22)
        ElseIf _Prog60 = 165 Then
            _eb.lokSteuern(60, Klassen.LokEigenschaften.Geschwindigkeit, Stufe21)
        ElseIf _Prog60 = 166 Then
            _eb.lokSteuern(60, Klassen.LokEigenschaften.Geschwindigkeit, Stufe2)
        ElseIf _Prog60 = 167 Then
            _eb.lokSteuern(60, Klassen.LokEigenschaften.Geschwindigkeit, 0)
        ElseIf _Prog60 = 168 Then
            Prog_Lok60.Interval = 2000
        ElseIf _Prog60 = 169 Then
            If _Motor < 3 Then
                _eb.lokSteuern(60, Klassen.LokEigenschaften.Funktion2, 0) ' Motor aus
            End If
        ElseIf _Prog60 = 170 Then
        ElseIf _Prog60 = 171 Then
            If _Fahrzeugbeleuchtung2 < 2 Then
                _eb.lokSteuern(60, Klassen.LokEigenschaften.Hauptfunktion, 0) ' Licht aus
            End If

            ' Rangierzug

        ElseIf _Prog60 = 180 Then
            _eb.lokSteuern(60, Klassen.LokEigenschaften.Geschwindigkeit, Stufe2)
            Prog_Lok60.Interval = V_180
        ElseIf _Prog60 = 181 Then
            Prog_Lok60.Interval = T_180
            _eb.lokSteuern(60, Klassen.LokEigenschaften.Geschwindigkeit, 0)
        ElseIf _Prog60 = 182 Then
            _eb.lokSteuern(60, Klassen.LokEigenschaften.Geschwindigkeit, 0)

            ' Tunnelausfahrt

        ElseIf _Prog60 = 200 Then ' Kontakt 1.2 <- (bergauf)
            _eb.lokSteuern(60, Klassen.LokEigenschaften.Geschwindigkeit, G_200)
        ElseIf _Prog60 = 201 Then
            Prog_Lok60.Interval = 2000
        ElseIf _Prog60 = 202 Then
        ElseIf _Prog60 = 203 Then
        ElseIf _Prog60 = 204 Then
        ElseIf _Prog60 = 205 Then
            If Stufe4 < Stufe3 Then
                _eb.lokSteuern(60, Klassen.LokEigenschaften.Geschwindigkeit, Stufe3)
            Else
                _eb.lokSteuern(60, Klassen.LokEigenschaften.Geschwindigkeit, Stufe4)
            End If
        ElseIf _Prog60 = 206 Then
        ElseIf _Prog60 = 207 Then
            If _Motor > 1 Then
                _eb.lokSteuern(60, Klassen.LokEigenschaften.Funktion2, 1) ' Motor ein
            End If
        ElseIf _Prog60 = 208 Then
            Prog_Lok60.Interval = 2000
        ElseIf _Prog60 = 209 Then
            If _AkustischeSignale > 1 Then
                _eb.lokSteuern(60, Klassen.LokEigenschaften.Funktion3, 1) ' Hupe ein
            End If
        ElseIf _Prog60 = 210 Then
            _eb.lokSteuern(60, Klassen.LokEigenschaften.Funktion3, 0) ' Hupe aus

        ElseIf _Prog60 = 220 Then ' Kontakt 3.1 -> (hinter dem Martinstor bergauf)
            Prog_Lok60.Interval = 2000
        ElseIf _Prog60 = 221 Then
        ElseIf _Prog60 = 222 Then
        ElseIf _Prog60 = 223 Then
        ElseIf _Prog60 = 224 Then
        ElseIf _Prog60 = 225 Then
        ElseIf _Prog60 = 226 Then
        ElseIf _Prog60 = 227 Then
        ElseIf _Prog60 = 228 Then
            If _Motor < 3 Then
                _eb.lokSteuern(60, Klassen.LokEigenschaften.Funktion2, 0) ' Motor aus
            End If

        ElseIf _Prog60 = 240 Then ' Kontakt 3.7 <- (hinter der Brücke bergauf)
            Prog_Lok60.Interval = 2000
        ElseIf _Prog60 = 241 Then
        ElseIf _Prog60 = 242 Then
        ElseIf _Prog60 = 243 Then
        ElseIf _Prog60 = 244 Then
            If _Motor > 1 Then
                '_eb.lokSteuern(60, Klassen.LokEigenschaften.Funktion2, 1) ' Motor ein
                _eb.lokSteuern(60, Klassen.LokEigenschaften.Funktion2, 0) ' Motor aus
            End If
        ElseIf _Prog60 = 245 Then
            If _AkustischeSignale > 1 Then
                '_eb.lokSteuern(60, Klassen.LokEigenschaften.Funktion3, 1) ' Hupe ein
            End If
        ElseIf _Prog60 = 246 Then
            _eb.lokSteuern(60, Klassen.LokEigenschaften.Funktion3, 0) ' Hupe aus
        ElseIf _Prog60 = 247 Then
        ElseIf _Prog60 = 248 Then
        ElseIf _Prog60 = 249 Then
        ElseIf _Prog60 = 250 Then
            If _Motor < 3 Then
                _eb.lokSteuern(60, Klassen.LokEigenschaften.Funktion2, 0) ' Motor aus
            End If

        ElseIf _Prog60 = 260 Then ' Kontakt 3.3 (links bzw vor der Brücke)
            Prog_Lok60.Interval = 2000
        ElseIf _Prog60 = 261 Then
        ElseIf _Prog60 = 262 Then
            _eb.lokSteuern(60, Klassen.LokEigenschaften.Geschwindigkeit, Stufe3)

        ElseIf _Prog60 = 600 Then ' Kontakt 3.5 <- (unter der Burg)
            Prog_Lok60.Interval = 2000
        ElseIf _Prog60 = 601 Then
        ElseIf _Prog60 = 602 Then
            'If _AkustischeSignale > 1 Then
            '    _eb.lokSteuern(60, Klassen.LokEigenschaften.Funktion3, 1) ' Hupe ein
            'End If
        ElseIf _Prog60 = 603 Then
            '_eb.lokSteuern(60, Klassen.LokEigenschaften.Funktion3, 0) ' Hupe aus
        ElseIf _Prog60 = 604 Then

        ElseIf _Prog60 = 620 Then ' Kontakt 3.7 -> (hinter der Brücke bergab)
            Prog_Lok60.Interval = 2000
        ElseIf _Prog60 = 621 Then
        ElseIf _Prog60 = 622 Then
            If _Motor > 1 Then
                _eb.lokSteuern(60, Klassen.LokEigenschaften.Funktion2, 1) ' Motor ein
            End If
        ElseIf _Prog60 = 623 Then
        ElseIf _Prog60 = 624 Then
            If _AkustischeSignale > 1 Then
                _eb.lokSteuern(60, Klassen.LokEigenschaften.Funktion3, 1) ' Hupe ein
            End If
        ElseIf _Prog60 = 625 Then
            _eb.lokSteuern(60, Klassen.LokEigenschaften.Funktion3, 0) ' Hupe aus


        ElseIf _Prog60 = 640 Then ' Kontakt 3.1 <- Talfahrt
            Prog_Lok60.Interval = 5000
        ElseIf _Prog60 = 641 Then
        ElseIf _Prog60 = 642 Then
        ElseIf _Prog60 = 643 Then
        ElseIf _Prog60 = 644 Then
            If _Motor < 3 Then
                _eb.lokSteuern(60, Klassen.LokEigenschaften.Funktion2, 0) ' Motor aus
            End If

        ElseIf _Prog60 = 660 Then ' Kontakt 1.2 -> Talfahrt
            Prog_Lok60.Interval = 2000
        ElseIf _Prog60 = 661 Then
        ElseIf _Prog60 = 662 Then
        ElseIf _Prog60 = 663 Then
        ElseIf _Prog60 = 664 Then
        ElseIf _Prog60 = 665 Then
            If _GlsL60 = 1 Or _GlsL60 = 2 Then
                If _Motor > 0 Then
                    _eb.lokSteuern(60, Klassen.LokEigenschaften.Funktion2, 1) ' Motor ein
                End If
            End If
        ElseIf _Prog60 = 666 Then
        ElseIf _Prog60 = 667 Then
        ElseIf _Prog60 = 668 Then
        ElseIf _Prog60 = 669 Then
        ElseIf _Prog60 = 670 Then
            If _GlsL60 = 1 Or _GlsL60 = 2 Then
                If _AkustischeSignale > 0 Then
                    _eb.lokSteuern(60, Klassen.LokEigenschaften.Funktion3, 1) ' Hupe ein
                End If
            End If
        ElseIf _Prog60 = 671 Then
            _eb.lokSteuern(60, Klassen.LokEigenschaften.Funktion3, 0) ' Hupe aus

        ElseIf _Prog60 = 700 Then ' Kontakt 0.4 <- Diagonale
            Prog_Lok60.Interval = 2000
        ElseIf _Prog60 = 701 Then
        ElseIf _Prog60 = 702 Then
        ElseIf _Prog60 = 703 Then
        ElseIf _Prog60 = 704 Then
            If _Motor > 0 Then
                _eb.lokSteuern(60, Klassen.LokEigenschaften.Funktion2, 1) ' Motor ein
            End If
        ElseIf _Prog60 = 705 Then
            If _AkustischeSignale > 0 Then
                _eb.lokSteuern(60, Klassen.LokEigenschaften.Funktion3, 1) ' Hupe ein
            End If
        ElseIf _Prog60 = 706 Then
            _eb.lokSteuern(60, Klassen.LokEigenschaften.Funktion3, 0) ' Hupe aus

            ' Zindelstein

        ElseIf _Prog60 = 500 Then
            Prog_Lok60.Interval = V_500
        ElseIf _Prog60 = 501 Then
            _eb.lokSteuern(60, Klassen.LokEigenschaften.Geschwindigkeit, Stufe24)
        ElseIf _Prog60 = 502 Then
            _eb.lokSteuern(60, Klassen.LokEigenschaften.Geschwindigkeit, Stufe23)
            'ElseIf _Prog60 = 503 Then
            '    _eb.lokSteuern(60, Klassen.LokEigenschaften.Geschwindigkeit, Stufe23)
        ElseIf _Prog60 = 504 Then
            Prog_Lok60.Interval = T_500
            _eb.lokSteuern(60, Klassen.LokEigenschaften.Geschwindigkeit, Stufe22)
        ElseIf _Prog60 = 505 Then
            _eb.lokSteuern(60, Klassen.LokEigenschaften.Geschwindigkeit, Stufe21)
        ElseIf _Prog60 = 506 Then
            _eb.lokSteuern(60, Klassen.LokEigenschaften.Geschwindigkeit, Stufe2)
        ElseIf _Prog60 = 507 Then
            _eb.lokSteuern(60, Klassen.LokEigenschaften.Geschwindigkeit, 0)


        Else
            _Prog60 = 0
            Prog_Lok60.Stop()
            Prog_Lok60.Interval = 200
            If Betriebsart = 1 Then
                SetProgramCounterLabel1(String.Empty)
            Else
                SetProgramCounterLabel(String.Empty)
            End If
        End If
        _Prog60 = _Prog60 + 1
    End Sub
    Private Sub HandleTimerElapsed73(sender As System.Object, e As System.EventArgs) Handles Prog_Lok61.Elapsed

        '*** Fahrprogramm für Schienenbus 795 299-7
        '*** Datum: 23.02.2020

        SetText(TextBox1, "Schienenbus 795 299-7                                                   IBS: 29.12.2025 - V3 : 8")
        LoadImage(PictureBox1, "H:\\EB_Media\\LokFotos\\Baureihe_795_01.jpg")
        GeschwindikeitenSetzen(61)

        Dim Stufe1, Stufe2, Stufe3, Stufe4 As Integer
        Dim Stufe11, Stufe12, Stufe13, Stufe14, Stufe21, Stufe22, Stufe23, Stufe24 As Integer
        Dim V_100, V_130, V_160, V_180, V_500 As Integer
        Dim T_100, T_130, T_160, T_180, T_500 As Integer
        Dim G_200 As Integer

        T_100 = _Betriebsparameter.Fahrparameter(61, KlausEBspecific.Betriebsparameter.FahrparameterEnum.T_100)
        T_130 = _Betriebsparameter.Fahrparameter(61, KlausEBspecific.Betriebsparameter.FahrparameterEnum.T_130)
        T_160 = _Betriebsparameter.Fahrparameter(61, KlausEBspecific.Betriebsparameter.FahrparameterEnum.T_160)
        T_180 = _Betriebsparameter.Fahrparameter(61, KlausEBspecific.Betriebsparameter.FahrparameterEnum.T_180)
        T_500 = _Betriebsparameter.Fahrparameter(61, KlausEBspecific.Betriebsparameter.FahrparameterEnum.T_500)
        V_100 = _Betriebsparameter.Fahrparameter(61, KlausEBspecific.Betriebsparameter.FahrparameterEnum.V_100)
        V_130 = _Betriebsparameter.Fahrparameter(61, KlausEBspecific.Betriebsparameter.FahrparameterEnum.V_130)
        V_160 = _Betriebsparameter.Fahrparameter(61, KlausEBspecific.Betriebsparameter.FahrparameterEnum.V_160)
        V_180 = _Betriebsparameter.Fahrparameter(61, KlausEBspecific.Betriebsparameter.FahrparameterEnum.V_180)
        V_500 = _Betriebsparameter.Fahrparameter(61, KlausEBspecific.Betriebsparameter.FahrparameterEnum.V_500)
        G_200 = _Betriebsparameter.Fahrparameter(61, KlausEBspecific.Betriebsparameter.FahrparameterEnum.G_200)

        If A_StopB = 1 Then
            V_100 = 8000
        End If

        Stufe1 = _LokStufen.Holen(61, 1)
        Stufe2 = _LokStufen.Holen(61, 2)
        Stufe3 = _LokStufen.Holen(61, 3)
        Stufe4 = _LokStufen.Holen(61, 4)

        If Stufe2 = 1 Then
            T_100 = T_100
            T_130 = T_130
            T_160 = T_160
            V_180 = V_180
        ElseIf Stufe2 = 2 Then
            T_100 = T_100 + 150
            T_130 = T_130 + 150
            T_160 = T_160 + 150
            V_180 = V_180 + 500
        ElseIf Stufe2 = 3 Then
            T_100 = T_100 + 300
            T_130 = T_130 + 300
            T_160 = T_160 + 300
            V_180 = V_180 + 1000
        ElseIf Stufe2 = 4 Then
            T_100 = T_100 + 450
            T_130 = T_130 + 450
            T_160 = T_160 + 450
            V_180 = V_180 + 1500
        ElseIf Stufe2 = 5 Then
            T_100 = T_100 + 600
            T_130 = T_130 + 600
            T_160 = T_160 + 600
            V_180 = V_180 + 2000
        ElseIf Stufe2 = 6 Then
            T_100 = T_100 + 750
            T_130 = T_130 + 750
            T_160 = T_160 + 7500
            V_180 = V_180 + 2500
        Else
            T_100 = T_100 + 900
            T_130 = T_130 + 900
            T_160 = T_160 + 900
            V_180 = V_180 + 2500
        End If

        Stufe2 = Stufe1

        Stufe11 = Stufe1 + 1
        If Stufe11 > Stufe3 Then
            Stufe11 = Stufe3
        End If
        Stufe12 = Stufe1 + 2
        If Stufe12 > Stufe3 Then
            Stufe12 = Stufe3
        End If
        Stufe13 = Stufe1 + 3
        If Stufe13 > Stufe3 Then
            Stufe13 = Stufe3
        End If
        Stufe14 = Stufe1 + 4
        If Stufe14 > Stufe3 Then
            Stufe14 = Stufe3
        End If

        Stufe21 = Stufe2 + 1
        If Stufe21 > Stufe3 Then
            Stufe21 = Stufe3
        End If
        Stufe22 = Stufe2 + 2
        If Stufe22 > Stufe3 Then
            Stufe22 = Stufe3
        End If
        Stufe23 = Stufe2 + 3
        If Stufe23 > Stufe3 Then
            Stufe23 = Stufe3
        End If
        Stufe24 = Stufe2 + 4
        If Stufe24 > Stufe3 Then
            Stufe24 = Stufe3
        End If
        If G_200 > 0 Then
            If G_200 < Stufe4 Then
                G_200 = Stufe4
            End If
        Else
            G_200 = Stufe4
        End If

        If Betriebsart = 1 And (_GlsL61 = 3 Or _GlsL61 = 4) Then
            SetProgramCounterLabel1(_Prog61)
        Else
            SetProgramCounterLabel(_Prog61)
        End If

        ' Lok starten - Bahnhofsausfahrt

        If _Prog61 = 0 Then
            Prog_Lok61.Interval = 2000
        ElseIf _Prog61 = 1 Then
            _Betriebsparameter.RundenErhoehen(61)
        ElseIf _Prog61 = 2 Then
        ElseIf _Prog61 = 3 Then
        ElseIf _Prog61 = 4 Then
        ElseIf _Prog61 = 5 Then
        ElseIf _Prog61 = 6 Then

            ' Bahnhofsausfahrt

        ElseIf _Prog61 = 7 Then
            _eb.lokSteuern(61, Klassen.LokEigenschaften.Geschwindigkeit, Stufe1)
        ElseIf _Prog61 = 8 Then
            _eb.lokSteuern(61, Klassen.LokEigenschaften.Geschwindigkeit, Stufe11)
        ElseIf _Prog61 = 9 Then
            _eb.lokSteuern(61, Klassen.LokEigenschaften.Geschwindigkeit, Stufe12)
        ElseIf _Prog61 = 10 Then
            _eb.lokSteuern(61, Klassen.LokEigenschaften.Geschwindigkeit, Stufe13)
        ElseIf _Prog61 = 11 Then
            _eb.lokSteuern(61, Klassen.LokEigenschaften.Geschwindigkeit, Stufe14)
        ElseIf _Prog61 = 12 Then
            _eb.lokSteuern(61, Klassen.LokEigenschaften.Geschwindigkeit, Stufe3)

            ' Lok abstellen

        ElseIf _Prog61 = 50 Then
            Prog_Lok61.Interval = 2000
        ElseIf _Prog61 = 51 Then
        ElseIf _Prog61 = 52 Then

            ' Lok bremsen (Bahnhofseinfahrt Normalzug von links und von rechts)

        ElseIf _Prog61 = 100 Then
            Prog_Lok61.Interval = V_100
        ElseIf _Prog61 = 101 Then
            _eb.lokSteuern(61, Klassen.LokEigenschaften.Geschwindigkeit, Stufe24)
            Prog_Lok61.Interval = T_100
        ElseIf _Prog61 = 102 Then
            _eb.lokSteuern(61, Klassen.LokEigenschaften.Geschwindigkeit, Stufe23)
        ElseIf _Prog61 = 103 Then
            _eb.lokSteuern(61, Klassen.LokEigenschaften.Geschwindigkeit, Stufe22)
        ElseIf _Prog61 = 104 Then
            _eb.lokSteuern(61, Klassen.LokEigenschaften.Geschwindigkeit, Stufe21)
        ElseIf _Prog61 = 105 Then
            _eb.lokSteuern(61, Klassen.LokEigenschaften.Geschwindigkeit, Stufe2)

            ' Lok bremsen (Bahnhofseinfahrt Kurzzug von links)

        ElseIf _Prog61 = 130 Then
            Prog_Lok61.Interval = V_130
        ElseIf _Prog61 = 131 Then
            _eb.lokSteuern(61, Klassen.LokEigenschaften.Geschwindigkeit, Stufe24)
            Prog_Lok61.Interval = T_130
        ElseIf _Prog61 = 132 Then
            _eb.lokSteuern(61, Klassen.LokEigenschaften.Geschwindigkeit, Stufe23)
        ElseIf _Prog61 = 133 Then
            _eb.lokSteuern(61, Klassen.LokEigenschaften.Geschwindigkeit, Stufe22)
        ElseIf _Prog61 = 134 Then
            _eb.lokSteuern(61, Klassen.LokEigenschaften.Geschwindigkeit, Stufe21)
        ElseIf _Prog61 = 135 Then
            _eb.lokSteuern(61, Klassen.LokEigenschaften.Geschwindigkeit, Stufe2)
        ElseIf _Prog61 = 136 Then
            _eb.lokSteuern(61, Klassen.LokEigenschaften.Geschwindigkeit, 0)
        ElseIf _Prog61 = 137 Then
            Prog_Lok61.Interval = 2000
        ElseIf _Prog61 = 138 Then

            ' Lok bremsen (Bahnhofseinfahrt Kurzzug von rechts)

        ElseIf _Prog61 = 160 Then
            Prog_Lok61.Interval = V_160
        ElseIf _Prog61 = 161 Then
            _eb.lokSteuern(61, Klassen.LokEigenschaften.Geschwindigkeit, Stufe24)
            Prog_Lok61.Interval = T_160
        ElseIf _Prog61 = 162 Then
            _eb.lokSteuern(61, Klassen.LokEigenschaften.Geschwindigkeit, Stufe23)
        ElseIf _Prog61 = 163 Then
            _eb.lokSteuern(61, Klassen.LokEigenschaften.Geschwindigkeit, Stufe22)
        ElseIf _Prog61 = 164 Then
            _eb.lokSteuern(61, Klassen.LokEigenschaften.Geschwindigkeit, Stufe21)
        ElseIf _Prog61 = 165 Then
            _eb.lokSteuern(61, Klassen.LokEigenschaften.Geschwindigkeit, Stufe2)
        ElseIf _Prog61 = 166 Then
            _eb.lokSteuern(61, Klassen.LokEigenschaften.Geschwindigkeit, 0)
        ElseIf _Prog61 = 167 Then
            Prog_Lok61.Interval = 2000
        ElseIf _Prog61 = 168 Then

            ' Rangierzug

        ElseIf _Prog61 = 180 Then
            _eb.lokSteuern(61, Klassen.LokEigenschaften.Geschwindigkeit, 2)
            Prog_Lok61.Interval = V_180
        ElseIf _Prog61 = 181 Then
            Prog_Lok61.Interval = T_180
            _eb.lokSteuern(61, Klassen.LokEigenschaften.Geschwindigkeit, 1)
        ElseIf _Prog61 = 182 Then
            _eb.lokSteuern(61, Klassen.LokEigenschaften.Geschwindigkeit, 0)

            ' Tunnelausfahrt

        ElseIf _Prog61 = 200 Then ' Kontakt 1.2 <- (bergauf)
            _eb.lokSteuern(61, Klassen.LokEigenschaften.Geschwindigkeit, G_200)
            Prog_Lok61.Interval = 2000
        ElseIf _Prog61 = 201 Then
        ElseIf _Prog61 = 202 Then
        ElseIf _Prog61 = 203 Then
        ElseIf _Prog61 = 204 Then
        ElseIf _Prog61 = 205 Then
            If Stufe4 < Stufe3 Then
                _eb.lokSteuern(61, Klassen.LokEigenschaften.Geschwindigkeit, Stufe3)
            Else
                _eb.lokSteuern(61, Klassen.LokEigenschaften.Geschwindigkeit, Stufe4)
            End If

        ElseIf _Prog61 = 220 Then ' Kontakt 3.1 -> (hinter dem Martinstor bergauf)
            Prog_Lok61.Interval = 2000
        ElseIf _Prog61 = 221 Then
        ElseIf _Prog61 = 222 Then

        ElseIf _Prog61 = 240 Then ' Kontakt 3.7 <- (hinter der Brücke bergauf)
            Prog_Lok61.Interval = 2000
        ElseIf _Prog61 = 241 Then
        ElseIf _Prog61 = 242 Then

        ElseIf _Prog61 = 260 Then ' Kontakt 3.3 (links bzw vor der Brücke)
            Prog_Lok61.Interval = 2000
        ElseIf _Prog61 = 261 Then
        ElseIf _Prog61 = 262 Then
            _eb.lokSteuern(61, Klassen.LokEigenschaften.Geschwindigkeit, Stufe3)

        ElseIf _Prog61 = 600 Then ' Kontakt 3.5 <- (unter der Burg)
            Prog_Lok61.Interval = 2000
        ElseIf _Prog61 = 601 Then
        ElseIf _Prog61 = 602 Then

        ElseIf _Prog61 = 620 Then ' Kontakt 3.7 -> (hinter der Brücke bergab)
            Prog_Lok61.Interval = 2000
        ElseIf _Prog61 = 621 Then
        ElseIf _Prog61 = 622 Then

        ElseIf _Prog61 = 640 Then ' Kontakt 3.1 <- Talfahrt
            Prog_Lok61.Interval = 2000
        ElseIf _Prog61 = 641 Then
        ElseIf _Prog61 = 642 Then

        ElseIf _Prog61 = 660 Then ' Kontakt 1.2 -> Talfahrt
            Prog_Lok61.Interval = 2000
        ElseIf _Prog61 = 661 Then
        ElseIf _Prog61 = 662 Then

        ElseIf _Prog61 = 700 Then ' Kontakt 0.4 <- Diagonale
            Prog_Lok61.Interval = 2000
        ElseIf _Prog61 = 701 Then
        ElseIf _Prog61 = 702 Then

            ' Zindelstein

        ElseIf _Prog61 = 500 Then
            Prog_Lok61.Interval = V_500
        ElseIf _Prog61 = 501 Then
            _eb.lokSteuern(61, Klassen.LokEigenschaften.Geschwindigkeit, 23)
            Prog_Lok61.Interval = T_500
        ElseIf _Prog61 = 502 Then
            _eb.lokSteuern(61, Klassen.LokEigenschaften.Geschwindigkeit, 22)
        ElseIf _Prog61 = 503 Then
            _eb.lokSteuern(61, Klassen.LokEigenschaften.Geschwindigkeit, 21)
        ElseIf _Prog61 = 504 Then
            _eb.lokSteuern(61, Klassen.LokEigenschaften.Geschwindigkeit, Stufe2)
        ElseIf _Prog61 = 505 Then
            _eb.lokSteuern(61, Klassen.LokEigenschaften.Geschwindigkeit, 0)

        Else
            _Prog61 = 0
            Prog_Lok61.Stop()
            Prog_Lok61.Interval = 200
            If Betriebsart = 1 Then
                SetProgramCounterLabel1(String.Empty)
            Else
                SetProgramCounterLabel(String.Empty)
            End If
        End If
        _Prog61 = _Prog61 + 1
    End Sub
    Private Sub HandleTimerElapsed74(sender As System.Object, e As System.EventArgs) Handles Prog_Lok62.Elapsed

        '*** Fahrprogramm für Schienenzeppelin
        '*** Datum: 23.02.2020

        SetText(TextBox1, "Schienenzeppelin                                                        IBS: nein)")
        LoadImage(PictureBox1, "H:\\EB_Media\\LokFotos\\Baureihe_Schienenzeppelin_01.jpg")
        GeschwindikeitenSetzen(62)

        Dim Stufe1, Stufe2, Stufe3, Stufe4 As Integer
        Dim Stufe11, Stufe12, Stufe13, Stufe14, Stufe21, Stufe22, Stufe23, Stufe24 As Integer
        Dim V_100, V_130, V_160, V_180, V_500 As Integer
        Dim T_100, T_130, T_160, T_180, T_500 As Integer
        Dim G_200 As Integer

        T_100 = _Betriebsparameter.Fahrparameter(62, KlausEBspecific.Betriebsparameter.FahrparameterEnum.T_100)
        T_130 = _Betriebsparameter.Fahrparameter(62, KlausEBspecific.Betriebsparameter.FahrparameterEnum.T_130)
        T_160 = _Betriebsparameter.Fahrparameter(62, KlausEBspecific.Betriebsparameter.FahrparameterEnum.T_160)
        T_180 = _Betriebsparameter.Fahrparameter(62, KlausEBspecific.Betriebsparameter.FahrparameterEnum.T_180)
        T_500 = _Betriebsparameter.Fahrparameter(62, KlausEBspecific.Betriebsparameter.FahrparameterEnum.T_500)
        V_100 = _Betriebsparameter.Fahrparameter(62, KlausEBspecific.Betriebsparameter.FahrparameterEnum.V_100)
        V_130 = _Betriebsparameter.Fahrparameter(62, KlausEBspecific.Betriebsparameter.FahrparameterEnum.V_130)
        V_160 = _Betriebsparameter.Fahrparameter(62, KlausEBspecific.Betriebsparameter.FahrparameterEnum.V_160)
        V_180 = _Betriebsparameter.Fahrparameter(62, KlausEBspecific.Betriebsparameter.FahrparameterEnum.V_180)
        V_500 = _Betriebsparameter.Fahrparameter(62, KlausEBspecific.Betriebsparameter.FahrparameterEnum.V_500)
        G_200 = _Betriebsparameter.Fahrparameter(62, KlausEBspecific.Betriebsparameter.FahrparameterEnum.G_200)

        If A_StopB = 1 Then
            V_100 = 8000
        End If

        Stufe1 = _LokStufen.Holen(62, 1)
        Stufe2 = _LokStufen.Holen(62, 2)
        Stufe3 = _LokStufen.Holen(62, 3)
        Stufe4 = _LokStufen.Holen(62, 4)

        If Stufe2 = 1 Then
            T_100 = T_100
            T_130 = T_130
            T_160 = T_160
            V_180 = V_180
        ElseIf Stufe2 = 2 Then
            T_100 = T_100 + 300
            T_130 = T_130 + 300
            T_160 = T_160 + 300
            V_180 = V_180 + 500
        ElseIf Stufe2 = 3 Then
            T_100 = T_100 + 500
            T_130 = T_130 + 500
            T_160 = T_160 + 500
            V_180 = V_180 + 1000
        ElseIf Stufe2 = 4 Then
            T_100 = T_100 + 700
            T_130 = T_130 + 700
            T_160 = T_160 + 700
            V_180 = V_180 + 1500
        ElseIf Stufe2 = 5 Then
            T_100 = T_100 + 900
            T_130 = T_130 + 900
            T_160 = T_160 + 900
            V_180 = V_180 + 2000
        ElseIf Stufe2 = 6 Then
            T_100 = T_100 + 1200
            T_130 = T_130 + 1200
            T_160 = T_160 + 1200
            V_180 = V_180 + 2500
        Else
            T_100 = T_100 + 1200
            T_130 = T_130 + 1200
            T_160 = T_160 + 1200
            V_180 = V_180 + 2500
        End If

        Stufe2 = Stufe1

        Stufe11 = Stufe1 + 1
        If Stufe11 > Stufe3 Then
            Stufe11 = Stufe3
        End If
        Stufe12 = Stufe1 + 2
        If Stufe12 > Stufe3 Then
            Stufe12 = Stufe3
        End If
        Stufe13 = Stufe1 + 3
        If Stufe13 > Stufe3 Then
            Stufe13 = Stufe3
        End If
        Stufe14 = Stufe1 + 4
        If Stufe14 > Stufe3 Then
            Stufe14 = Stufe3
        End If

        Stufe21 = Stufe2 + 1
        If Stufe21 > Stufe3 Then
            Stufe21 = Stufe3
        End If
        Stufe22 = Stufe2 + 2
        If Stufe22 > Stufe3 Then
            Stufe22 = Stufe3
        End If
        Stufe23 = Stufe2 + 3
        If Stufe23 > Stufe3 Then
            Stufe23 = Stufe3
        End If
        Stufe24 = Stufe2 + 4
        If Stufe24 > Stufe3 Then
            Stufe24 = Stufe3
        End If
        If G_200 > 0 Then
            If G_200 < Stufe4 Then
                G_200 = Stufe4
            End If
        Else
            G_200 = Stufe4
        End If

        If Betriebsart = 1 And (_GlsL62 = 3 Or _GlsL62 = 4) Then
            SetProgramCounterLabel1(_Prog62)
        Else
            SetProgramCounterLabel(_Prog62)
        End If

        ' Lok starten - Bahnhofsausfahrt

        If _Prog62 = 0 Then
            Prog_Lok62.Interval = 2000
        ElseIf _Prog62 = 1 Then
        ElseIf _Prog62 = 2 Then
            _Betriebsparameter.RundenErhoehen(62)
        ElseIf _Prog62 = 3 Then
        ElseIf _Prog62 = 4 Then
        ElseIf _Prog62 = 5 Then
        ElseIf _Prog62 = 6 Then

            ' Bahnhofsausfahrt

        ElseIf _Prog62 = 7 Then
            _eb.lokSteuern(62, Klassen.LokEigenschaften.Geschwindigkeit, Stufe1)
        ElseIf _Prog62 = 8 Then
            _eb.lokSteuern(62, Klassen.LokEigenschaften.Geschwindigkeit, Stufe11)
        ElseIf _Prog62 = 9 Then
            _eb.lokSteuern(62, Klassen.LokEigenschaften.Geschwindigkeit, Stufe12)
        ElseIf _Prog62 = 10 Then
            _eb.lokSteuern(62, Klassen.LokEigenschaften.Geschwindigkeit, Stufe13)
        ElseIf _Prog62 = 11 Then
            _eb.lokSteuern(62, Klassen.LokEigenschaften.Geschwindigkeit, Stufe14)
        ElseIf _Prog62 = 12 Then
            _eb.lokSteuern(62, Klassen.LokEigenschaften.Geschwindigkeit, Stufe3)

            ' Lok abstellen

        ElseIf _Prog62 = 50 Then
            Prog_Lok62.Interval = 2000
        ElseIf _Prog62 = 51 Then
        ElseIf _Prog62 = 52 Then
            If _Fahrzeugbeleuchtung2 < 2 Then
                _eb.lokSteuern(62, Klassen.LokEigenschaften.Hauptfunktion, 0) ' Licht aus
            End If

            ' Lok bremsen (Bahnhofseinfahrt Normalzug von links und von rechts)

        ElseIf _Prog62 = 100 Then
            Prog_Lok62.Interval = V_100
        ElseIf _Prog62 = 101 Then
            _eb.lokSteuern(62, Klassen.LokEigenschaften.Geschwindigkeit, Stufe24)
            Prog_Lok62.Interval = T_100
        ElseIf _Prog62 = 102 Then
            _eb.lokSteuern(62, Klassen.LokEigenschaften.Geschwindigkeit, Stufe23)
        ElseIf _Prog62 = 103 Then
            _eb.lokSteuern(62, Klassen.LokEigenschaften.Geschwindigkeit, Stufe22)
        ElseIf _Prog62 = 104 Then
            _eb.lokSteuern(62, Klassen.LokEigenschaften.Geschwindigkeit, Stufe21)
        ElseIf _Prog62 = 105 Then
            _eb.lokSteuern(62, Klassen.LokEigenschaften.Geschwindigkeit, Stufe2)

            ' Lok bremsen (Bahnhofseinfahrt Kurzzug von links)

        ElseIf _Prog62 = 130 Then
            Prog_Lok62.Interval = V_130
        ElseIf _Prog62 = 131 Then
            _eb.lokSteuern(62, Klassen.LokEigenschaften.Geschwindigkeit, Stufe24)
            Prog_Lok62.Interval = T_130
        ElseIf _Prog62 = 132 Then
            _eb.lokSteuern(62, Klassen.LokEigenschaften.Geschwindigkeit, Stufe23)
        ElseIf _Prog62 = 133 Then
            _eb.lokSteuern(62, Klassen.LokEigenschaften.Geschwindigkeit, Stufe22)
        ElseIf _Prog62 = 134 Then
            _eb.lokSteuern(62, Klassen.LokEigenschaften.Geschwindigkeit, Stufe21)
        ElseIf _Prog62 = 135 Then
            _eb.lokSteuern(62, Klassen.LokEigenschaften.Geschwindigkeit, Stufe2)
        ElseIf _Prog62 = 136 Then
            _eb.lokSteuern(62, Klassen.LokEigenschaften.Geschwindigkeit, 0)
        ElseIf _Prog62 = 137 Then
            Prog_Lok62.Interval = 2000
        ElseIf _Prog62 = 138 Then
            If _Fahrzeugbeleuchtung2 < 2 Then
                _eb.lokSteuern(62, Klassen.LokEigenschaften.Hauptfunktion, 0) ' Licht aus
            End If

            ' Lok bremsen (Bahnhofseinfahrt Kurzzug von rechts)

        ElseIf _Prog62 = 160 Then
            Prog_Lok62.Interval = V_160
        ElseIf _Prog62 = 161 Then
            _eb.lokSteuern(62, Klassen.LokEigenschaften.Geschwindigkeit, Stufe24)
            Prog_Lok62.Interval = T_160
        ElseIf _Prog62 = 162 Then
            _eb.lokSteuern(62, Klassen.LokEigenschaften.Geschwindigkeit, Stufe23)
        ElseIf _Prog62 = 163 Then
            _eb.lokSteuern(62, Klassen.LokEigenschaften.Geschwindigkeit, Stufe22)
        ElseIf _Prog62 = 164 Then
            _eb.lokSteuern(62, Klassen.LokEigenschaften.Geschwindigkeit, Stufe21)
        ElseIf _Prog62 = 165 Then
            _eb.lokSteuern(62, Klassen.LokEigenschaften.Geschwindigkeit, Stufe2)
        ElseIf _Prog62 = 166 Then
            _eb.lokSteuern(62, Klassen.LokEigenschaften.Geschwindigkeit, 0)
        ElseIf _Prog62 = 167 Then
            Prog_Lok62.Interval = 2000
        ElseIf _Prog62 = 168 Then
            If _Fahrzeugbeleuchtung2 < 2 Then
                _eb.lokSteuern(62, Klassen.LokEigenschaften.Hauptfunktion, 0) ' Licht aus
            End If

            ' Rangierzug

        ElseIf _Prog62 = 180 Then
            _eb.lokSteuern(62, Klassen.LokEigenschaften.Geschwindigkeit, 2)
            Prog_Lok62.Interval = V_180
        ElseIf _Prog62 = 181 Then
            Prog_Lok62.Interval = T_180
            _eb.lokSteuern(62, Klassen.LokEigenschaften.Geschwindigkeit, 1)
        ElseIf _Prog62 = 182 Then
            _eb.lokSteuern(62, Klassen.LokEigenschaften.Geschwindigkeit, 0)

            ' Tunnelausfahrt

        ElseIf _Prog62 = 200 Then ' Kontakt 1.2 <- (bergauf)
            _eb.lokSteuern(62, Klassen.LokEigenschaften.Geschwindigkeit, G_200)
            Prog_Lok62.Interval = 2000
        ElseIf _Prog62 = 201 Then
        ElseIf _Prog62 = 202 Then
        ElseIf _Prog62 = 203 Then
        ElseIf _Prog62 = 204 Then
        ElseIf _Prog62 = 205 Then
            If Stufe4 < Stufe3 Then
                _eb.lokSteuern(62, Klassen.LokEigenschaften.Geschwindigkeit, Stufe3)
            Else
                _eb.lokSteuern(62, Klassen.LokEigenschaften.Geschwindigkeit, Stufe4)
            End If

        ElseIf _Prog62 = 220 Then ' Kontakt 3.1 -> (hinter dem Martinstor bergauf)
            Prog_Lok62.Interval = 2000
        ElseIf _Prog62 = 221 Then
        ElseIf _Prog62 = 222 Then

        ElseIf _Prog62 = 240 Then ' Kontakt 3.7 <- (hinter der Brücke bergauf)
            Prog_Lok62.Interval = 2000
        ElseIf _Prog62 = 241 Then
        ElseIf _Prog62 = 242 Then

        ElseIf _Prog62 = 260 Then ' Kontakt 3.3 (links bzw vor der Brücke)
            Prog_Lok62.Interval = 2000
        ElseIf _Prog62 = 261 Then
        ElseIf _Prog62 = 262 Then
            _eb.lokSteuern(62, Klassen.LokEigenschaften.Geschwindigkeit, Stufe3)

        ElseIf _Prog62 = 600 Then ' Kontakt 3.5 <- (unter der Burg)
            Prog_Lok62.Interval = 2000
        ElseIf _Prog62 = 601 Then
        ElseIf _Prog62 = 602 Then

        ElseIf _Prog62 = 620 Then ' Kontakt 3.7 -> (hinter der Brücke bergab)
            Prog_Lok62.Interval = 2000
        ElseIf _Prog62 = 621 Then
        ElseIf _Prog62 = 622 Then

        ElseIf _Prog62 = 640 Then ' Kontakt 3.1 <- Talfahrt
            Prog_Lok62.Interval = 2000
        ElseIf _Prog62 = 641 Then
        ElseIf _Prog62 = 642 Then

        ElseIf _Prog62 = 660 Then ' Kontakt 1.2 -> Talfahrt
            Prog_Lok62.Interval = 2000
        ElseIf _Prog62 = 661 Then
        ElseIf _Prog62 = 662 Then

        ElseIf _Prog62 = 700 Then ' Kontakt 0.4 <- Diagonale
            Prog_Lok62.Interval = 2000
        ElseIf _Prog62 = 701 Then
        ElseIf _Prog62 = 702 Then

            ' Zindelstein

        ElseIf _Prog62 = 500 Then
            Prog_Lok62.Interval = V_500
        ElseIf _Prog62 = 501 Then
            _eb.lokSteuern(62, Klassen.LokEigenschaften.Geschwindigkeit, Stufe23)
            Prog_Lok62.Interval = T_500
        ElseIf _Prog62 = 502 Then
            _eb.lokSteuern(62, Klassen.LokEigenschaften.Geschwindigkeit, Stufe22)
        ElseIf _Prog62 = 503 Then
            _eb.lokSteuern(62, Klassen.LokEigenschaften.Geschwindigkeit, Stufe21)
        ElseIf _Prog62 = 504 Then
            _eb.lokSteuern(62, Klassen.LokEigenschaften.Geschwindigkeit, Stufe2)
        ElseIf _Prog62 = 505 Then
            _eb.lokSteuern(62, Klassen.LokEigenschaften.Geschwindigkeit, 0)

        Else
            _Prog62 = 0
            Prog_Lok62.Stop()
            Prog_Lok62.Interval = 200
            If Betriebsart = 1 Then
                SetProgramCounterLabel1(String.Empty)
            Else
                SetProgramCounterLabel(String.Empty)
            End If
        End If
        _Prog62 = _Prog62 + 1
    End Sub
    Private Sub HandleTimerElapsed75(sender As System.Object, e As System.EventArgs) Handles Prog_Lok63.Elapsed

        '*** Fahrprogramm Fahrprogramm für Dampflok 80 030
        '*** Datum: 23.02.2020

        SetText(TextBox1, "Damf-Lok 80 030                                                         IBS: 30.04.2021 - V3 : 7")
        LoadImage(PictureBox1, "H:\\EB_Media\\LokFotos\\Baureihe_80_02.jpg")
        GeschwindikeitenSetzen(63)

        Dim Stufe1, Stufe2, Stufe3, Stufe4 As Integer
        Dim Stufe11, Stufe12, Stufe13, Stufe14, Stufe21, Stufe22, Stufe23, Stufe24 As Integer
        Dim V_100, V_130, V_160, V_180, V_500 As Integer
        Dim T_100, T_130, T_160, T_180, T_500 As Integer
        Dim G_200 As Integer

        T_100 = _Betriebsparameter.Fahrparameter(63, KlausEBspecific.Betriebsparameter.FahrparameterEnum.T_100)
        T_130 = _Betriebsparameter.Fahrparameter(63, KlausEBspecific.Betriebsparameter.FahrparameterEnum.T_130)
        T_160 = _Betriebsparameter.Fahrparameter(63, KlausEBspecific.Betriebsparameter.FahrparameterEnum.T_160)
        T_180 = _Betriebsparameter.Fahrparameter(63, KlausEBspecific.Betriebsparameter.FahrparameterEnum.T_180)
        T_500 = _Betriebsparameter.Fahrparameter(63, KlausEBspecific.Betriebsparameter.FahrparameterEnum.T_500)
        V_100 = _Betriebsparameter.Fahrparameter(63, KlausEBspecific.Betriebsparameter.FahrparameterEnum.V_100)
        V_130 = _Betriebsparameter.Fahrparameter(63, KlausEBspecific.Betriebsparameter.FahrparameterEnum.V_130)
        V_160 = _Betriebsparameter.Fahrparameter(63, KlausEBspecific.Betriebsparameter.FahrparameterEnum.V_160)
        V_180 = _Betriebsparameter.Fahrparameter(63, KlausEBspecific.Betriebsparameter.FahrparameterEnum.V_180)
        V_500 = _Betriebsparameter.Fahrparameter(63, KlausEBspecific.Betriebsparameter.FahrparameterEnum.V_500)
        G_200 = _Betriebsparameter.Fahrparameter(63, KlausEBspecific.Betriebsparameter.FahrparameterEnum.G_200)

        If A_StopB = 1 Then
            V_100 = 8000
        End If

        Stufe1 = _LokStufen.Holen(63, 1)
        Stufe2 = _LokStufen.Holen(63, 2)
        Stufe3 = _LokStufen.Holen(63, 3)
        Stufe4 = _LokStufen.Holen(63, 4)

        If Stufe2 = 1 Then
            T_100 = T_100
            T_130 = T_130
            T_160 = T_160
            V_180 = V_180
        ElseIf Stufe2 = 2 Then
            T_100 = T_100 + 300
            T_130 = T_130 + 300
            T_160 = T_160 + 300
            V_180 = V_180 + 500
        ElseIf Stufe2 = 3 Then
            T_100 = T_100 + 500
            T_130 = T_130 + 500
            T_160 = T_160 + 500
            V_180 = V_180 + 1000
        ElseIf Stufe2 = 4 Then
            T_100 = T_100 + 700
            T_130 = T_130 + 700
            T_160 = T_160 + 700
            V_180 = V_180 + 1500
        ElseIf Stufe2 = 5 Then
            T_100 = T_100 + 900
            T_130 = T_130 + 900
            T_160 = T_160 + 900
            V_180 = V_180 + 2000
        ElseIf Stufe2 = 6 Then
            T_100 = T_100 + 1200
            T_130 = T_130 + 1200
            T_160 = T_160 + 1200
            V_180 = V_180 + 2500
        Else
            T_100 = T_100 + 1200
            T_130 = T_130 + 1200
            T_160 = T_160 + 1200
            V_180 = V_180 + 2500
        End If

        Stufe2 = Stufe1

        Stufe11 = Stufe1 + 1
        If Stufe11 > Stufe3 Then
            Stufe11 = Stufe3
        End If
        Stufe12 = Stufe1 + 2
        If Stufe12 > Stufe3 Then
            Stufe12 = Stufe3
        End If
        Stufe13 = Stufe1 + 3
        If Stufe13 > Stufe3 Then
            Stufe13 = Stufe3
        End If
        Stufe14 = Stufe1 + 4
        If Stufe14 > Stufe3 Then
            Stufe14 = Stufe3
        End If

        Stufe21 = Stufe2 + 1
        If Stufe21 > Stufe3 Then
            Stufe21 = Stufe3
        End If
        Stufe22 = Stufe2 + 2
        If Stufe22 > Stufe3 Then
            Stufe22 = Stufe3
        End If
        Stufe23 = Stufe2 + 3
        If Stufe23 > Stufe3 Then
            Stufe23 = Stufe3
        End If
        Stufe24 = Stufe2 + 4
        If Stufe24 > Stufe3 Then
            Stufe24 = Stufe3
        End If
        If G_200 > 0 Then
            If G_200 < Stufe4 Then
                G_200 = Stufe4
            End If
        Else
            G_200 = Stufe4
        End If

        If Betriebsart = 1 And (_GlsL63 = 3 Or _GlsL63 = 4) Then
            SetProgramCounterLabel1(_Prog63)
        Else
            SetProgramCounterLabel(_Prog63)
        End If

        ' Lok starten - Bahnhofsausfahrt

        If _Prog63 = 0 Then
            Prog_Lok63.Interval = 2000
            If _Fahrzeugbeleuchtung2 > 0 Then
                _eb.lokSteuern(63, Klassen.LokEigenschaften.Hauptfunktion, 1) ' Licht ein
            End If
        ElseIf _Prog63 = 1 Then
        ElseIf _Prog63 = 2 Then
            _Betriebsparameter.RundenErhoehen(63)
        ElseIf _Prog63 = 3 Then
        ElseIf _Prog63 = 4 Then
        ElseIf _Prog63 = 5 Then
        ElseIf _Prog63 = 6 Then

            ' Bahnhofsausfahrt

        ElseIf _Prog63 = 7 Then
            _eb.lokSteuern(63, Klassen.LokEigenschaften.Geschwindigkeit, Stufe1)
        ElseIf _Prog63 = 8 Then
            _eb.lokSteuern(63, Klassen.LokEigenschaften.Geschwindigkeit, Stufe11)
        ElseIf _Prog63 = 9 Then
            _eb.lokSteuern(63, Klassen.LokEigenschaften.Geschwindigkeit, Stufe12)
        ElseIf _Prog63 = 10 Then
            _eb.lokSteuern(63, Klassen.LokEigenschaften.Geschwindigkeit, Stufe13)
        ElseIf _Prog63 = 11 Then
            _eb.lokSteuern(63, Klassen.LokEigenschaften.Geschwindigkeit, Stufe14)
        ElseIf _Prog63 = 12 Then
            _eb.lokSteuern(63, Klassen.LokEigenschaften.Geschwindigkeit, Stufe3)

            ' Lok abstellen

        ElseIf _Prog63 = 50 Then
            Prog_Lok63.Interval = 2000
        ElseIf _Prog63 = 51 Then
        ElseIf _Prog63 = 52 Then
            If _Fahrzeugbeleuchtung2 < 2 Then
                _eb.lokSteuern(63, Klassen.LokEigenschaften.Hauptfunktion, 0) ' Licht aus
            End If

            ' Lok bremsen (Bahnhofseinfahrt Normalzug von links und von rechts)

        ElseIf _Prog63 = 100 Then
            Prog_Lok63.Interval = V_100
        ElseIf _Prog63 = 101 Then
            _eb.lokSteuern(63, Klassen.LokEigenschaften.Geschwindigkeit, Stufe24)
            Prog_Lok63.Interval = T_100
        ElseIf _Prog63 = 102 Then
            _eb.lokSteuern(63, Klassen.LokEigenschaften.Geschwindigkeit, Stufe23)
        ElseIf _Prog63 = 103 Then
            _eb.lokSteuern(63, Klassen.LokEigenschaften.Geschwindigkeit, Stufe22)
        ElseIf _Prog63 = 104 Then
            _eb.lokSteuern(63, Klassen.LokEigenschaften.Geschwindigkeit, Stufe21)
        ElseIf _Prog63 = 105 Then
            _eb.lokSteuern(63, Klassen.LokEigenschaften.Geschwindigkeit, Stufe2)

            ' Lok bremsen (Bahnhofseinfahrt Kurzzug von links)

        ElseIf _Prog63 = 130 Then
            Prog_Lok63.Interval = V_130
        ElseIf _Prog63 = 131 Then
            _eb.lokSteuern(63, Klassen.LokEigenschaften.Geschwindigkeit, Stufe24)
            Prog_Lok63.Interval = T_130
        ElseIf _Prog63 = 132 Then
            _eb.lokSteuern(63, Klassen.LokEigenschaften.Geschwindigkeit, Stufe23)
        ElseIf _Prog63 = 133 Then
            _eb.lokSteuern(63, Klassen.LokEigenschaften.Geschwindigkeit, Stufe22)
        ElseIf _Prog63 = 134 Then
            _eb.lokSteuern(63, Klassen.LokEigenschaften.Geschwindigkeit, Stufe21)
        ElseIf _Prog63 = 135 Then
            _eb.lokSteuern(63, Klassen.LokEigenschaften.Geschwindigkeit, Stufe2)
        ElseIf _Prog63 = 136 Then
            _eb.lokSteuern(63, Klassen.LokEigenschaften.Geschwindigkeit, 0)
        ElseIf _Prog63 = 137 Then
            Prog_Lok63.Interval = 2000
        ElseIf _Prog63 = 138 Then
            If _Fahrzeugbeleuchtung2 < 2 Then
                _eb.lokSteuern(63, Klassen.LokEigenschaften.Hauptfunktion, 0) ' Licht aus
            End If

            ' Lok bremsen (Bahnhofseinfahrt Kurzzug von rechts)

        ElseIf _Prog63 = 160 Then
            Prog_Lok63.Interval = V_160
        ElseIf _Prog63 = 161 Then
            _eb.lokSteuern(63, Klassen.LokEigenschaften.Geschwindigkeit, Stufe24)
            Prog_Lok63.Interval = T_160
        ElseIf _Prog63 = 162 Then
            _eb.lokSteuern(63, Klassen.LokEigenschaften.Geschwindigkeit, Stufe23)
        ElseIf _Prog63 = 163 Then
            _eb.lokSteuern(63, Klassen.LokEigenschaften.Geschwindigkeit, Stufe22)
        ElseIf _Prog63 = 164 Then
            _eb.lokSteuern(63, Klassen.LokEigenschaften.Geschwindigkeit, Stufe21)
        ElseIf _Prog63 = 165 Then
            _eb.lokSteuern(63, Klassen.LokEigenschaften.Geschwindigkeit, Stufe2)
        ElseIf _Prog63 = 166 Then
            _eb.lokSteuern(63, Klassen.LokEigenschaften.Geschwindigkeit, 0)
        ElseIf _Prog63 = 167 Then
            Prog_Lok63.Interval = 2000
        ElseIf _Prog63 = 168 Then
            If _Fahrzeugbeleuchtung2 < 2 Then
                _eb.lokSteuern(63, Klassen.LokEigenschaften.Hauptfunktion, 0) ' Licht aus
            End If

            ' Rangierzug

        ElseIf _Prog63 = 180 Then
            _eb.lokSteuern(63, Klassen.LokEigenschaften.Geschwindigkeit, 2)
            Prog_Lok63.Interval = V_180
        ElseIf _Prog63 = 181 Then
            Prog_Lok63.Interval = T_180
            _eb.lokSteuern(63, Klassen.LokEigenschaften.Geschwindigkeit, 1)
        ElseIf _Prog63 = 182 Then
            _eb.lokSteuern(63, Klassen.LokEigenschaften.Geschwindigkeit, 0)

            ' Tunnelausfahrt

        ElseIf _Prog63 = 200 Then ' Kontakt 1.2 <- (bergauf)
            _eb.lokSteuern(63, Klassen.LokEigenschaften.Geschwindigkeit, G_200)
            Prog_Lok63.Interval = 2000
        ElseIf _Prog63 = 201 Then
        ElseIf _Prog63 = 202 Then
        ElseIf _Prog63 = 203 Then
        ElseIf _Prog63 = 204 Then
        ElseIf _Prog63 = 205 Then
            If Stufe4 < Stufe3 Then
                _eb.lokSteuern(63, Klassen.LokEigenschaften.Geschwindigkeit, Stufe3)
            Else
                _eb.lokSteuern(63, Klassen.LokEigenschaften.Geschwindigkeit, Stufe4)
            End If

        ElseIf _Prog63 = 220 Then ' Kontakt 3.1 -> (hinter dem Martinstor bergauf)
            Prog_Lok63.Interval = 2000
        ElseIf _Prog63 = 221 Then
        ElseIf _Prog63 = 222 Then

        ElseIf _Prog63 = 240 Then ' Kontakt 3.7 <- (hinter der Brücke bergauf)
            Prog_Lok63.Interval = 2000
        ElseIf _Prog63 = 241 Then
        ElseIf _Prog63 = 242 Then

        ElseIf _Prog63 = 260 Then ' Kontakt 3.3 (links bzw vor der Brücke)
            Prog_Lok63.Interval = 2000
        ElseIf _Prog63 = 261 Then
        ElseIf _Prog63 = 262 Then
            _eb.lokSteuern(63, Klassen.LokEigenschaften.Geschwindigkeit, Stufe3)

        ElseIf _Prog63 = 600 Then ' Kontakt 3.5 <- (unter der Burg)
            Prog_Lok63.Interval = 2000
        ElseIf _Prog63 = 601 Then
        ElseIf _Prog63 = 602 Then

        ElseIf _Prog63 = 620 Then ' Kontakt 3.7 -> (hinter der Brücke bergab)
            Prog_Lok63.Interval = 2000
        ElseIf _Prog63 = 621 Then
        ElseIf _Prog63 = 622 Then

        ElseIf _Prog63 = 640 Then ' Kontakt 3.1 <- Talfahrt
            Prog_Lok63.Interval = 2000
        ElseIf _Prog63 = 641 Then
        ElseIf _Prog63 = 642 Then

        ElseIf _Prog63 = 660 Then ' Kontakt 1.2 -> Talfahrt
            Prog_Lok63.Interval = 2000
        ElseIf _Prog63 = 661 Then
        ElseIf _Prog63 = 662 Then

        ElseIf _Prog63 = 700 Then ' Kontakt 0.4 <- Diagonale
            Prog_Lok63.Interval = 2000
        ElseIf _Prog63 = 701 Then
        ElseIf _Prog63 = 702 Then

            ' Zindelstein

        ElseIf _Prog63 = 500 Then
            Prog_Lok63.Interval = V_500
        ElseIf _Prog63 = 501 Then
            _eb.lokSteuern(63, Klassen.LokEigenschaften.Geschwindigkeit, Stufe23)
            Prog_Lok63.Interval = T_500
        ElseIf _Prog63 = 502 Then
            _eb.lokSteuern(63, Klassen.LokEigenschaften.Geschwindigkeit, Stufe22)
        ElseIf _Prog63 = 503 Then
            _eb.lokSteuern(63, Klassen.LokEigenschaften.Geschwindigkeit, Stufe21)
        ElseIf _Prog63 = 504 Then
            _eb.lokSteuern(63, Klassen.LokEigenschaften.Geschwindigkeit, Stufe2)
        ElseIf _Prog63 = 505 Then
            _eb.lokSteuern(63, Klassen.LokEigenschaften.Geschwindigkeit, 0)

        Else
            _Prog63 = 0
            Prog_Lok63.Stop()
            Prog_Lok63.Interval = 200
            If Betriebsart = 1 Then
                SetProgramCounterLabel1(String.Empty)
            Else
                SetProgramCounterLabel(String.Empty)
            End If
        End If
        _Prog63 = _Prog63 + 1
    End Sub
    Private Sub HandleTimerElapsed76(sender As System.Object, e As System.EventArgs) Handles Prog_Lok64.Elapsed

        '*** Fahrprogramm für Triebwagen 628 203-2
        '*** Datum: 23.02.2020

        SetText(TextBox1, "Triebwagen 628 203-2                                                    IBS: nein")
        LoadImage(PictureBox1, "H:\\EB_Media\\LokFotos\\Baureihe_628_01.jpg")
        GeschwindikeitenSetzen(64)

        Dim Stufe1, Stufe2, Stufe3, Stufe4 As Integer
        Dim Stufe11, Stufe12, Stufe13, Stufe14, Stufe21, Stufe22, Stufe23, Stufe24 As Integer
        Dim V_100, V_130, V_160, V_180, V_500 As Integer
        Dim T_100, T_130, T_160, T_180, T_500 As Integer
        Dim G_200 As Integer

        T_100 = _Betriebsparameter.Fahrparameter(64, KlausEBspecific.Betriebsparameter.FahrparameterEnum.T_100)
        T_130 = _Betriebsparameter.Fahrparameter(64, KlausEBspecific.Betriebsparameter.FahrparameterEnum.T_130)
        T_160 = _Betriebsparameter.Fahrparameter(64, KlausEBspecific.Betriebsparameter.FahrparameterEnum.T_160)
        T_180 = _Betriebsparameter.Fahrparameter(64, KlausEBspecific.Betriebsparameter.FahrparameterEnum.T_180)
        T_500 = _Betriebsparameter.Fahrparameter(64, KlausEBspecific.Betriebsparameter.FahrparameterEnum.T_500)
        V_100 = _Betriebsparameter.Fahrparameter(64, KlausEBspecific.Betriebsparameter.FahrparameterEnum.V_100)
        V_130 = _Betriebsparameter.Fahrparameter(64, KlausEBspecific.Betriebsparameter.FahrparameterEnum.V_130)
        V_160 = _Betriebsparameter.Fahrparameter(64, KlausEBspecific.Betriebsparameter.FahrparameterEnum.V_160)
        V_180 = _Betriebsparameter.Fahrparameter(64, KlausEBspecific.Betriebsparameter.FahrparameterEnum.V_180)
        V_500 = _Betriebsparameter.Fahrparameter(64, KlausEBspecific.Betriebsparameter.FahrparameterEnum.V_500)
        G_200 = _Betriebsparameter.Fahrparameter(64, KlausEBspecific.Betriebsparameter.FahrparameterEnum.G_200)

        If A_StopB = 1 Then
            V_100 = 8000
        End If

        Stufe1 = _LokStufen.Holen(64, 1)
        Stufe2 = _LokStufen.Holen(64, 2)
        Stufe3 = _LokStufen.Holen(64, 3)
        Stufe4 = _LokStufen.Holen(64, 4)

        If Stufe2 = 1 Then
            T_100 = T_100
            T_130 = T_130
            T_160 = T_160
            V_180 = V_180
        ElseIf Stufe2 = 2 Then
            T_100 = T_100 + 300
            T_130 = T_130 + 300
            T_160 = T_160 + 300
            V_180 = V_180 + 500
        ElseIf Stufe2 = 3 Then
            T_100 = T_100 + 500
            T_130 = T_130 + 500
            T_160 = T_160 + 500
            V_180 = V_180 + 1000
        ElseIf Stufe2 = 4 Then
            T_100 = T_100 + 700
            T_130 = T_130 + 700
            T_160 = T_160 + 700
            V_180 = V_180 + 1500
        ElseIf Stufe2 = 5 Then
            T_100 = T_100 + 900
            T_130 = T_130 + 900
            T_160 = T_160 + 900
            V_180 = V_180 + 2000
        ElseIf Stufe2 = 6 Then
            T_100 = T_100 + 1200
            T_130 = T_130 + 1200
            T_160 = T_160 + 1200
            V_180 = V_180 + 2500
        Else
            T_100 = T_100 + 1200
            T_130 = T_130 + 1200
            T_160 = T_160 + 1200
            V_180 = V_180 + 2500
        End If

        Stufe2 = Stufe1

        Stufe11 = Stufe1 + 1
        If Stufe11 > Stufe3 Then
            Stufe11 = Stufe3
        End If
        Stufe12 = Stufe1 + 2
        If Stufe12 > Stufe3 Then
            Stufe12 = Stufe3
        End If
        Stufe13 = Stufe1 + 3
        If Stufe13 > Stufe3 Then
            Stufe13 = Stufe3
        End If
        Stufe14 = Stufe1 + 4
        If Stufe14 > Stufe3 Then
            Stufe14 = Stufe3
        End If

        Stufe21 = Stufe2 + 1
        If Stufe21 > Stufe3 Then
            Stufe21 = Stufe3
        End If
        Stufe22 = Stufe2 + 2
        If Stufe22 > Stufe3 Then
            Stufe22 = Stufe3
        End If
        Stufe23 = Stufe2 + 3
        If Stufe23 > Stufe3 Then
            Stufe23 = Stufe3
        End If
        Stufe24 = Stufe2 + 4
        If Stufe24 > Stufe3 Then
            Stufe24 = Stufe3
        End If
        If G_200 > 0 Then
            If G_200 < Stufe4 Then
                G_200 = Stufe4
            End If
        Else
            G_200 = Stufe4
        End If

        If Betriebsart = 1 And (_GlsL64 = 3 Or _GlsL64 = 4) Then
            SetProgramCounterLabel1(_Prog64)
        Else
            SetProgramCounterLabel(_Prog64)
        End If

        ' Lok starten - Bahnhofsausfahrt

        If _Prog64 = 0 Then
            Prog_Lok64.Interval = 2000
        ElseIf _Prog64 = 1 Then
            If _Fahrzeugbeleuchtung2 > 0 Then
                _eb.lokSteuern(64, Klassen.LokEigenschaften.Hauptfunktion, 1) ' Licht ein
            End If
        ElseIf _Prog64 = 2 Then
            _Betriebsparameter.RundenErhoehen(64)
        ElseIf _Prog64 = 3 Then
        ElseIf _Prog64 = 4 Then
        ElseIf _Prog64 = 5 Then
        ElseIf _Prog64 = 6 Then
        ElseIf _Prog64 = 7 Then

            ' Bahnhofsausfahrt

        ElseIf _Prog64 = 8 Then
            _eb.lokSteuern(64, Klassen.LokEigenschaften.Geschwindigkeit, Stufe1)
        ElseIf _Prog64 = 9 Then
            _eb.lokSteuern(64, Klassen.LokEigenschaften.Geschwindigkeit, Stufe11)
        ElseIf _Prog64 = 10 Then
            _eb.lokSteuern(64, Klassen.LokEigenschaften.Geschwindigkeit, Stufe12)
        ElseIf _Prog64 = 11 Then
            _eb.lokSteuern(64, Klassen.LokEigenschaften.Geschwindigkeit, Stufe13)
        ElseIf _Prog64 = 12 Then
            _eb.lokSteuern(64, Klassen.LokEigenschaften.Geschwindigkeit, Stufe14)
        ElseIf _Prog64 = 13 Then
            _eb.lokSteuern(64, Klassen.LokEigenschaften.Geschwindigkeit, Stufe3)

            ' Lok abstellen

        ElseIf _Prog64 = 50 Then
            Prog_Lok64.Interval = 2000
        ElseIf _Prog64 = 51 Then
        ElseIf _Prog64 = 52 Then
            If _Fahrzeugbeleuchtung2 < 2 Then
                _eb.lokSteuern(64, Klassen.LokEigenschaften.Hauptfunktion, 0) ' Licht aus
            End If

            ' Lok bremsen (Bahnhofseinfahrt Normalzug von links und von rechts)

        ElseIf _Prog64 = 100 Then
            Prog_Lok64.Interval = V_100
        ElseIf _Prog64 = 101 Then
            _eb.lokSteuern(64, Klassen.LokEigenschaften.Geschwindigkeit, Stufe24)
            Prog_Lok64.Interval = T_100
        ElseIf _Prog64 = 102 Then
            _eb.lokSteuern(64, Klassen.LokEigenschaften.Geschwindigkeit, Stufe23)
        ElseIf _Prog64 = 103 Then
            _eb.lokSteuern(64, Klassen.LokEigenschaften.Geschwindigkeit, Stufe22)
        ElseIf _Prog64 = 104 Then
            _eb.lokSteuern(64, Klassen.LokEigenschaften.Geschwindigkeit, Stufe21)
        ElseIf _Prog64 = 105 Then
            _eb.lokSteuern(64, Klassen.LokEigenschaften.Geschwindigkeit, Stufe2)


            ' Lok bremsen (Bahnhofseinfahrt Kurzzug von links)

        ElseIf _Prog64 = 130 Then
            Prog_Lok64.Interval = V_130
        ElseIf _Prog64 = 131 Then
            _eb.lokSteuern(64, Klassen.LokEigenschaften.Geschwindigkeit, Stufe24)
            Prog_Lok64.Interval = T_130
        ElseIf _Prog64 = 132 Then
            _eb.lokSteuern(64, Klassen.LokEigenschaften.Geschwindigkeit, Stufe23)
        ElseIf _Prog64 = 133 Then
            _eb.lokSteuern(64, Klassen.LokEigenschaften.Geschwindigkeit, Stufe22)
        ElseIf _Prog64 = 134 Then
            _eb.lokSteuern(64, Klassen.LokEigenschaften.Geschwindigkeit, Stufe21)
        ElseIf _Prog64 = 135 Then
            _eb.lokSteuern(64, Klassen.LokEigenschaften.Geschwindigkeit, Stufe2)
        ElseIf _Prog64 = 136 Then
            _eb.lokSteuern(64, Klassen.LokEigenschaften.Geschwindigkeit, 0)
        ElseIf _Prog64 = 137 Then
            Prog_Lok64.Interval = 2000
        ElseIf _Prog64 = 138 Then
            If _Fahrzeugbeleuchtung2 < 2 Then
                _eb.lokSteuern(64, Klassen.LokEigenschaften.Hauptfunktion, 0) ' Licht aus
            End If

            ' Lok bremsen (Bahnhofseinfahrt Kurzzug von rechts)

        ElseIf _Prog64 = 160 Then
            Prog_Lok64.Interval = V_160
        ElseIf _Prog64 = 161 Then
            _eb.lokSteuern(64, Klassen.LokEigenschaften.Geschwindigkeit, Stufe24)
            Prog_Lok64.Interval = T_160
        ElseIf _Prog64 = 162 Then
            _eb.lokSteuern(64, Klassen.LokEigenschaften.Geschwindigkeit, Stufe23)
        ElseIf _Prog64 = 163 Then
            _eb.lokSteuern(64, Klassen.LokEigenschaften.Geschwindigkeit, Stufe22)
        ElseIf _Prog64 = 164 Then
            _eb.lokSteuern(64, Klassen.LokEigenschaften.Geschwindigkeit, Stufe21)
        ElseIf _Prog64 = 165 Then
            _eb.lokSteuern(64, Klassen.LokEigenschaften.Geschwindigkeit, Stufe2)
        ElseIf _Prog64 = 166 Then
            _eb.lokSteuern(64, Klassen.LokEigenschaften.Geschwindigkeit, 0)
        ElseIf _Prog64 = 167 Then
            Prog_Lok64.Interval = 2000
        ElseIf _Prog64 = 168 Then
            If _Fahrzeugbeleuchtung2 < 2 Then
                _eb.lokSteuern(64, Klassen.LokEigenschaften.Hauptfunktion, 0) ' Licht aus
            End If

            ' Rangierzug

        ElseIf _Prog64 = 180 Then
            _eb.lokSteuern(64, Klassen.LokEigenschaften.Geschwindigkeit, 2)
            Prog_Lok64.Interval = V_180
        ElseIf _Prog64 = 181 Then
            Prog_Lok64.Interval = T_180
            _eb.lokSteuern(64, Klassen.LokEigenschaften.Geschwindigkeit, 1)
        ElseIf _Prog64 = 182 Then
            _eb.lokSteuern(64, Klassen.LokEigenschaften.Geschwindigkeit, 0)

            ' Tunnelausfahrt

        ElseIf _Prog64 = 200 Then ' Kontakt 1.2 <- (bergauf)
            _eb.lokSteuern(64, Klassen.LokEigenschaften.Geschwindigkeit, G_200)
            Prog_Lok64.Interval = 2000
        ElseIf _Prog64 = 201 Then
        ElseIf _Prog64 = 202 Then
        ElseIf _Prog64 = 203 Then
        ElseIf _Prog64 = 204 Then
        ElseIf _Prog64 = 205 Then
            If Stufe4 < Stufe3 Then
                _eb.lokSteuern(64, Klassen.LokEigenschaften.Geschwindigkeit, Stufe3)
            Else
                _eb.lokSteuern(64, Klassen.LokEigenschaften.Geschwindigkeit, Stufe4)
            End If

        ElseIf _Prog64 = 220 Then ' Kontakt 3.1 -> (hinter dem Martinstor bergauf)
            Prog_Lok64.Interval = 2000
        ElseIf _Prog64 = 221 Then
        ElseIf _Prog64 = 222 Then

        ElseIf _Prog64 = 240 Then ' Kontakt 3.7 <- (hinter der Brücke bergauf)
            Prog_Lok64.Interval = 2000
        ElseIf _Prog64 = 241 Then
        ElseIf _Prog64 = 242 Then

        ElseIf _Prog64 = 260 Then ' Kontakt 3.3 (links bzw vor der Brücke)
            Prog_Lok64.Interval = 2000
        ElseIf _Prog64 = 261 Then
        ElseIf _Prog64 = 262 Then
            _eb.lokSteuern(64, Klassen.LokEigenschaften.Geschwindigkeit, Stufe3)

        ElseIf _Prog64 = 600 Then ' Kontakt 3.5 <- (unter der Burg)
            Prog_Lok64.Interval = 2000
        ElseIf _Prog64 = 601 Then
        ElseIf _Prog64 = 602 Then

        ElseIf _Prog64 = 620 Then ' Kontakt 3.7 -> (hinter der Brücke bergab)
            Prog_Lok64.Interval = 2000
        ElseIf _Prog64 = 621 Then
        ElseIf _Prog64 = 622 Then

        ElseIf _Prog64 = 640 Then ' Kontakt 3.1 <- Talfahrt
            Prog_Lok64.Interval = 2000
        ElseIf _Prog64 = 641 Then
        ElseIf _Prog64 = 642 Then

        ElseIf _Prog64 = 660 Then ' Kontakt 1.2 -> Talfahrt
            Prog_Lok64.Interval = 2000
        ElseIf _Prog64 = 661 Then
        ElseIf _Prog64 = 662 Then

        ElseIf _Prog64 = 700 Then ' Kontakt 0.4 <- Diagonale
            Prog_Lok64.Interval = 2000
        ElseIf _Prog64 = 701 Then
        ElseIf _Prog64 = 702 Then

            ' Zindelstein

        ElseIf _Prog64 = 500 Then
            Prog_Lok64.Interval = V_500
        ElseIf _Prog64 = 501 Then
            _eb.lokSteuern(64, Klassen.LokEigenschaften.Geschwindigkeit, Stufe23)
            Prog_Lok64.Interval = T_500
        ElseIf _Prog64 = 502 Then
            _eb.lokSteuern(64, Klassen.LokEigenschaften.Geschwindigkeit, Stufe22)
        ElseIf _Prog64 = 503 Then
            _eb.lokSteuern(64, Klassen.LokEigenschaften.Geschwindigkeit, Stufe21)
        ElseIf _Prog64 = 504 Then
            _eb.lokSteuern(64, Klassen.LokEigenschaften.Geschwindigkeit, Stufe2)
        ElseIf _Prog64 = 505 Then
            _eb.lokSteuern(64, Klassen.LokEigenschaften.Geschwindigkeit, 0)

        Else
            _Prog64 = 0
            Prog_Lok64.Stop()
            Prog_Lok64.Interval = 200
            If Betriebsart = 1 Then
                SetProgramCounterLabel1(String.Empty)
            Else
                SetProgramCounterLabel(String.Empty)
            End If
        End If
        _Prog64 = _Prog64 + 1
    End Sub
    Private Sub HandleTimerElapsed77(sender As System.Object, e As System.EventArgs) Handles Prog_Lok65.Elapsed

        '*** Fahrprogramm für Baureihe 89 7314
        '*** Datum: 23.02.2020 +

        SetText(TextBox1, "Dampflok 89 7314                                                        IBS: nein")
        LoadImage(PictureBox1, "H:\\EB_Media\\LokFotos\\Baureihe_89_01.jpg")
        GeschwindikeitenSetzen(65)

        Dim Stufe1, Stufe2, Stufe3, Stufe4 As Integer
        Dim Stufe11, Stufe12, Stufe13, Stufe14, Stufe21, Stufe22, Stufe23, Stufe24 As Integer
        Dim V_100, V_130, V_160, V_180, V_500 As Integer
        Dim T_100, T_130, T_160, T_180, T_500 As Integer
        Dim G_200 As Integer

        T_100 = _Betriebsparameter.Fahrparameter(65, KlausEBspecific.Betriebsparameter.FahrparameterEnum.T_100)
        T_130 = _Betriebsparameter.Fahrparameter(65, KlausEBspecific.Betriebsparameter.FahrparameterEnum.T_130)
        T_160 = _Betriebsparameter.Fahrparameter(65, KlausEBspecific.Betriebsparameter.FahrparameterEnum.T_160)
        T_180 = _Betriebsparameter.Fahrparameter(65, KlausEBspecific.Betriebsparameter.FahrparameterEnum.T_180)
        T_500 = _Betriebsparameter.Fahrparameter(65, KlausEBspecific.Betriebsparameter.FahrparameterEnum.T_500)
        V_100 = _Betriebsparameter.Fahrparameter(65, KlausEBspecific.Betriebsparameter.FahrparameterEnum.V_100)
        V_130 = _Betriebsparameter.Fahrparameter(65, KlausEBspecific.Betriebsparameter.FahrparameterEnum.V_130)
        V_160 = _Betriebsparameter.Fahrparameter(65, KlausEBspecific.Betriebsparameter.FahrparameterEnum.V_160)
        V_180 = _Betriebsparameter.Fahrparameter(65, KlausEBspecific.Betriebsparameter.FahrparameterEnum.V_180)
        V_500 = _Betriebsparameter.Fahrparameter(65, KlausEBspecific.Betriebsparameter.FahrparameterEnum.V_500)
        G_200 = _Betriebsparameter.Fahrparameter(65, KlausEBspecific.Betriebsparameter.FahrparameterEnum.G_200)

        If A_StopB = 1 Then
            V_100 = 8000
        End If

        Stufe1 = _LokStufen.Holen(65, 1)
        Stufe2 = _LokStufen.Holen(65, 2)
        Stufe3 = _LokStufen.Holen(65, 3)
        Stufe4 = _LokStufen.Holen(65, 4)

        If Stufe2 = 1 Then
            T_100 = T_100
            T_130 = T_130
            T_160 = T_160
            V_180 = V_180
        ElseIf Stufe2 = 2 Then
            T_100 = T_100 + 300
            T_130 = T_130 + 300
            T_160 = T_160 + 300
            V_180 = V_180 + 500
        ElseIf Stufe2 = 3 Then
            T_100 = T_100 + 500
            T_130 = T_130 + 500
            T_160 = T_160 + 500
            V_180 = V_180 + 1000
        ElseIf Stufe2 = 4 Then
            T_100 = T_100 + 700
            T_130 = T_130 + 700
            T_160 = T_160 + 700
            V_180 = V_180 + 1500
        ElseIf Stufe2 = 5 Then
            T_100 = T_100 + 900
            T_130 = T_130 + 900
            T_160 = T_160 + 900
            V_180 = V_180 + 2000
        ElseIf Stufe2 = 6 Then
            T_100 = T_100 + 1200
            T_130 = T_130 + 1200
            T_160 = T_160 + 1200
            V_180 = V_180 + 2500
        Else
            T_100 = T_100 + 1200
            T_130 = T_130 + 1200
            T_160 = T_160 + 1200
            V_180 = V_180 + 2500
        End If

        Stufe2 = Stufe1

        Stufe11 = Stufe1 + 1
        If Stufe11 > Stufe3 Then
            Stufe11 = Stufe3
        End If
        Stufe12 = Stufe1 + 2
        If Stufe12 > Stufe3 Then
            Stufe12 = Stufe3
        End If
        Stufe13 = Stufe1 + 3
        If Stufe13 > Stufe3 Then
            Stufe13 = Stufe3
        End If
        Stufe14 = Stufe1 + 4
        If Stufe14 > Stufe3 Then
            Stufe14 = Stufe3
        End If

        Stufe21 = Stufe2 + 1
        If Stufe21 > Stufe3 Then
            Stufe21 = Stufe3
        End If
        Stufe22 = Stufe2 + 2
        If Stufe22 > Stufe3 Then
            Stufe22 = Stufe3
        End If
        Stufe23 = Stufe2 + 3
        If Stufe23 > Stufe3 Then
            Stufe23 = Stufe3
        End If
        Stufe24 = Stufe2 + 4
        If Stufe24 > Stufe3 Then
            Stufe24 = Stufe3
        End If
        If G_200 > 0 Then
            If G_200 < Stufe4 Then
                G_200 = Stufe4
            End If
        Else
            G_200 = Stufe4
        End If

        If Betriebsart = 1 And (_GlsL65 = 3 Or _GlsL65 = 4) Then
            SetProgramCounterLabel1(_Prog65)
        Else
            SetProgramCounterLabel(_Prog65)
        End If

        ' Lok starten - Bahnhofsausfahrt

        If _Prog65 = 0 Then
            Prog_Lok65.Interval = 2000
        ElseIf _Prog65 = 1 Then
        ElseIf _Prog65 = 2 Then
            _Betriebsparameter.RundenErhoehen(65)
        ElseIf _Prog65 = 3 Then
        ElseIf _Prog65 = 4 Then
        ElseIf _Prog65 = 5 Then
        ElseIf _Prog65 = 6 Then

            ' Bahnhofsausfahrt

        ElseIf _Prog65 = 7 Then
            _eb.lokSteuern(65, Klassen.LokEigenschaften.Geschwindigkeit, Stufe1)
        ElseIf _Prog65 = 8 Then
            _eb.lokSteuern(65, Klassen.LokEigenschaften.Geschwindigkeit, Stufe11)
        ElseIf _Prog65 = 9 Then
            _eb.lokSteuern(65, Klassen.LokEigenschaften.Geschwindigkeit, Stufe12)
        ElseIf _Prog65 = 10 Then
            _eb.lokSteuern(65, Klassen.LokEigenschaften.Geschwindigkeit, Stufe13)
        ElseIf _Prog65 = 11 Then
            _eb.lokSteuern(65, Klassen.LokEigenschaften.Geschwindigkeit, Stufe14)
        ElseIf _Prog65 = 12 Then
            _eb.lokSteuern(65, Klassen.LokEigenschaften.Geschwindigkeit, Stufe3)

            ' Lok abstellen

        ElseIf _Prog65 = 50 Then
            Prog_Lok65.Interval = 2000
        ElseIf _Prog65 = 51 Then
        ElseIf _Prog65 = 52 Then
            If _Fahrzeugbeleuchtung2 < 2 Then
                _eb.lokSteuern(65, Klassen.LokEigenschaften.Hauptfunktion, 0) ' Licht aus
            End If

            ' Lok bremsen (Bahnhofseinfahrt Normalzug von links und von rechts)

        ElseIf _Prog65 = 100 Then
            Prog_Lok65.Interval = V_100
        ElseIf _Prog65 = 101 Then
            _eb.lokSteuern(65, Klassen.LokEigenschaften.Geschwindigkeit, Stufe24)
            Prog_Lok65.Interval = T_100
        ElseIf _Prog65 = 102 Then
            _eb.lokSteuern(65, Klassen.LokEigenschaften.Geschwindigkeit, Stufe23)
        ElseIf _Prog65 = 103 Then
            _eb.lokSteuern(65, Klassen.LokEigenschaften.Geschwindigkeit, Stufe22)
        ElseIf _Prog65 = 104 Then
            _eb.lokSteuern(65, Klassen.LokEigenschaften.Geschwindigkeit, Stufe21)
        ElseIf _Prog65 = 105 Then
            _eb.lokSteuern(65, Klassen.LokEigenschaften.Geschwindigkeit, Stufe2)

            ' Lok bremsen (Bahnhofseinfahrt Kurzzug von links)

        ElseIf _Prog65 = 130 Then
            Prog_Lok65.Interval = V_130
        ElseIf _Prog65 = 131 Then
            _eb.lokSteuern(65, Klassen.LokEigenschaften.Geschwindigkeit, Stufe24)
            Prog_Lok65.Interval = T_130
        ElseIf _Prog65 = 132 Then
            _eb.lokSteuern(65, Klassen.LokEigenschaften.Geschwindigkeit, Stufe23)
        ElseIf _Prog65 = 133 Then
            _eb.lokSteuern(65, Klassen.LokEigenschaften.Geschwindigkeit, Stufe22)
        ElseIf _Prog65 = 134 Then
            _eb.lokSteuern(65, Klassen.LokEigenschaften.Geschwindigkeit, Stufe21)
        ElseIf _Prog65 = 135 Then
            _eb.lokSteuern(65, Klassen.LokEigenschaften.Geschwindigkeit, Stufe2)
        ElseIf _Prog65 = 136 Then
            _eb.lokSteuern(65, Klassen.LokEigenschaften.Geschwindigkeit, 0)
        ElseIf _Prog65 = 137 Then
            Prog_Lok65.Interval = 2000
        ElseIf _Prog65 = 138 Then
            If _Fahrzeugbeleuchtung2 < 2 Then
                _eb.lokSteuern(65, Klassen.LokEigenschaften.Hauptfunktion, 0) ' Licht aus
            End If

            ' Lok bremsen (Bahnhofseinfahrt Kurzzug von rechts)

        ElseIf _Prog65 = 160 Then
            Prog_Lok65.Interval = V_160
        ElseIf _Prog65 = 161 Then
            _eb.lokSteuern(65, Klassen.LokEigenschaften.Geschwindigkeit, Stufe24)
            Prog_Lok65.Interval = T_160
        ElseIf _Prog65 = 162 Then
            _eb.lokSteuern(65, Klassen.LokEigenschaften.Geschwindigkeit, Stufe23)
        ElseIf _Prog65 = 163 Then
            _eb.lokSteuern(65, Klassen.LokEigenschaften.Geschwindigkeit, Stufe22)
        ElseIf _Prog65 = 164 Then
            _eb.lokSteuern(65, Klassen.LokEigenschaften.Geschwindigkeit, Stufe21)
        ElseIf _Prog65 = 165 Then
            _eb.lokSteuern(65, Klassen.LokEigenschaften.Geschwindigkeit, Stufe2)
        ElseIf _Prog65 = 166 Then
            _eb.lokSteuern(65, Klassen.LokEigenschaften.Geschwindigkeit, 0)
        ElseIf _Prog65 = 167 Then
            Prog_Lok65.Interval = 2000
        ElseIf _Prog65 = 168 Then
            If _Fahrzeugbeleuchtung2 < 2 Then
                _eb.lokSteuern(65, Klassen.LokEigenschaften.Hauptfunktion, 0) ' Licht aus
            End If

            ' Rangierzug

        ElseIf _Prog65 = 180 Then
            _eb.lokSteuern(65, Klassen.LokEigenschaften.Geschwindigkeit, 2)
            Prog_Lok65.Interval = V_180
        ElseIf _Prog65 = 181 Then
            Prog_Lok65.Interval = T_180
            _eb.lokSteuern(65, Klassen.LokEigenschaften.Geschwindigkeit, 1)
        ElseIf _Prog65 = 182 Then
            _eb.lokSteuern(65, Klassen.LokEigenschaften.Geschwindigkeit, 0)

            ' Rangierzug

        ElseIf _Prog65 = 180 Then
            Prog_Lok65.Interval = V_180
        ElseIf _Prog65 = 181 Then
            Prog_Lok65.Interval = T_180
            _eb.lokSteuern(65, Klassen.LokEigenschaften.Geschwindigkeit, 0)
        ElseIf _Prog65 = 182 Then
            _eb.lokSteuern(65, Klassen.LokEigenschaften.Geschwindigkeit, 0)

            ' Tunnelausfahrt

        ElseIf _Prog65 = 200 Then ' Kontakt 1.2 <- (bergauf)
            _eb.lokSteuern(65, Klassen.LokEigenschaften.Geschwindigkeit, G_200)
            Prog_Lok65.Interval = 2000
        ElseIf _Prog65 = 201 Then
        ElseIf _Prog65 = 202 Then
        ElseIf _Prog65 = 203 Then
        ElseIf _Prog65 = 204 Then
        ElseIf _Prog65 = 205 Then
            If Stufe4 < Stufe3 Then
                _eb.lokSteuern(65, Klassen.LokEigenschaften.Geschwindigkeit, Stufe3)
            Else
                _eb.lokSteuern(65, Klassen.LokEigenschaften.Geschwindigkeit, Stufe4)
            End If

        ElseIf _Prog65 = 220 Then ' Kontakt 3.1 -> (hinter dem Martinstor bergauf)
            Prog_Lok65.Interval = 2000
        ElseIf _Prog65 = 221 Then
        ElseIf _Prog65 = 222 Then

        ElseIf _Prog65 = 240 Then ' Kontakt 3.7 <- (hinter der Brücke bergauf)
            Prog_Lok65.Interval = 2000
        ElseIf _Prog65 = 241 Then
        ElseIf _Prog65 = 242 Then

        ElseIf _Prog65 = 260 Then ' Kontakt 3.3 (links bzw vor der Brücke)
            Prog_Lok65.Interval = 2000
        ElseIf _Prog65 = 261 Then
        ElseIf _Prog65 = 262 Then
            _eb.lokSteuern(65, Klassen.LokEigenschaften.Geschwindigkeit, Stufe3)

        ElseIf _Prog65 = 600 Then ' Kontakt 3.5 <- (unter der Burg)
            Prog_Lok65.Interval = 2000
        ElseIf _Prog65 = 601 Then
        ElseIf _Prog65 = 602 Then

        ElseIf _Prog65 = 620 Then ' Kontakt 3.7 -> (hinter der Brücke bergab)
            Prog_Lok65.Interval = 2000
        ElseIf _Prog65 = 621 Then
        ElseIf _Prog65 = 622 Then

        ElseIf _Prog65 = 640 Then ' Kontakt 3.1 <- Talfahrt
            Prog_Lok65.Interval = 2000
        ElseIf _Prog65 = 641 Then
        ElseIf _Prog65 = 642 Then

        ElseIf _Prog65 = 660 Then ' Kontakt 1.2 -> Talfahrt
            Prog_Lok65.Interval = 2000
        ElseIf _Prog65 = 661 Then
        ElseIf _Prog65 = 662 Then

        ElseIf _Prog65 = 700 Then ' Kontakt 0.4 <- Diagonale
            Prog_Lok65.Interval = 2000
        ElseIf _Prog65 = 701 Then
        ElseIf _Prog65 = 702 Then

            ' Zindelstein

        ElseIf _Prog65 = 500 Then
            Prog_Lok65.Interval = V_500
        ElseIf _Prog65 = 501 Then
            _eb.lokSteuern(65, Klassen.LokEigenschaften.Geschwindigkeit, Stufe23)
            Prog_Lok65.Interval = T_500
        ElseIf _Prog65 = 502 Then
            _eb.lokSteuern(65, Klassen.LokEigenschaften.Geschwindigkeit, Stufe22)
        ElseIf _Prog65 = 503 Then
            _eb.lokSteuern(65, Klassen.LokEigenschaften.Geschwindigkeit, Stufe21)
        ElseIf _Prog65 = 504 Then
            _eb.lokSteuern(65, Klassen.LokEigenschaften.Geschwindigkeit, Stufe2)
        ElseIf _Prog65 = 505 Then
            _eb.lokSteuern(65, Klassen.LokEigenschaften.Geschwindigkeit, 0)

        Else
            _Prog65 = 0
            Prog_Lok65.Stop()
            Prog_Lok65.Interval = 200
            If Betriebsart = 1 Then
                SetProgramCounterLabel1(String.Empty)
            Else
                SetProgramCounterLabel(String.Empty)
            End If
        End If
        _Prog65 = _Prog65 + 1
    End Sub
    Private Sub HandleTimerElapsed78(sender As System.Object, e As System.EventArgs) Handles Prog_Lok66.Elapsed

        '*** Fahrprogramm für Dampflok 23 003
        '*** Datum: 17.07.2020

        SetText(TextBox1, "Dampf-Lok 23 003                                                        IBS: 11.10.2025 - V3 : 8")
        LoadImage(PictureBox1, "H:\\EB_Media\\LokFotos\\Baureihe_023_03.jpg")
        GeschwindikeitenSetzen(66)

        Dim Stufe1, Stufe2, Stufe3, Stufe4 As Integer
        Dim Stufe11, Stufe12, Stufe13, Stufe14, Stufe21, Stufe22, Stufe23, Stufe24 As Integer
        Dim V_100, V_130, V_160, V_180, V_500 As Integer
        Dim T_100, T_130, T_160, T_180, T_500 As Integer
        Dim G_200 As Integer

        T_100 = _Betriebsparameter.Fahrparameter(66, KlausEBspecific.Betriebsparameter.FahrparameterEnum.T_100)
        T_130 = _Betriebsparameter.Fahrparameter(66, KlausEBspecific.Betriebsparameter.FahrparameterEnum.T_130)
        T_160 = _Betriebsparameter.Fahrparameter(66, KlausEBspecific.Betriebsparameter.FahrparameterEnum.T_160)
        T_180 = _Betriebsparameter.Fahrparameter(66, KlausEBspecific.Betriebsparameter.FahrparameterEnum.T_180)
        T_500 = _Betriebsparameter.Fahrparameter(66, KlausEBspecific.Betriebsparameter.FahrparameterEnum.T_500)
        V_100 = _Betriebsparameter.Fahrparameter(66, KlausEBspecific.Betriebsparameter.FahrparameterEnum.V_100)
        V_130 = _Betriebsparameter.Fahrparameter(66, KlausEBspecific.Betriebsparameter.FahrparameterEnum.V_130)
        V_160 = _Betriebsparameter.Fahrparameter(66, KlausEBspecific.Betriebsparameter.FahrparameterEnum.V_160)
        V_180 = _Betriebsparameter.Fahrparameter(66, KlausEBspecific.Betriebsparameter.FahrparameterEnum.V_180)
        V_500 = _Betriebsparameter.Fahrparameter(66, KlausEBspecific.Betriebsparameter.FahrparameterEnum.V_500)
        G_200 = _Betriebsparameter.Fahrparameter(66, KlausEBspecific.Betriebsparameter.FahrparameterEnum.G_200)

        If A_StopB = 1 Then
            V_100 = 8000
        End If

        Stufe1 = _LokStufen.Holen(66, 1)
        Stufe2 = _LokStufen.Holen(66, 2)
        Stufe3 = _LokStufen.Holen(66, 3)
        Stufe4 = _LokStufen.Holen(66, 4)

        If Stufe2 = 1 Then
            T_100 = T_100
            T_130 = T_130
            T_160 = T_160
            V_180 = V_180
        ElseIf Stufe2 = 2 Then
            T_100 = T_100 + 300
            T_130 = T_130 + 300
            T_160 = T_160 + 300
            V_180 = V_180 + 500
        ElseIf Stufe2 = 3 Then
            T_100 = T_100 + 500
            T_130 = T_130 + 500
            T_160 = T_160 + 500
            V_180 = V_180 + 1000
        ElseIf Stufe2 = 4 Then
            T_100 = T_100 + 700
            T_130 = T_130 + 700
            T_160 = T_160 + 700
            V_180 = V_180 + 1500
        ElseIf Stufe2 = 5 Then
            T_100 = T_100 + 900
            T_130 = T_130 + 900
            T_160 = T_160 + 900
            V_180 = V_180 + 2000
        ElseIf Stufe2 = 6 Then
            T_100 = T_100 + 1200
            T_130 = T_130 + 1200
            T_160 = T_160 + 1200
            V_180 = V_180 + 2500
        Else
            T_100 = T_100 + 1200
            T_130 = T_130 + 1200
            T_160 = T_160 + 1200
            V_180 = V_180 + 2500
        End If

        Stufe2 = Stufe1

        Stufe11 = Stufe1 + 1
        If Stufe11 > Stufe3 Then
            Stufe11 = Stufe3
        End If
        Stufe12 = Stufe1 + 2
        If Stufe12 > Stufe3 Then
            Stufe12 = Stufe3
        End If
        Stufe13 = Stufe1 + 3
        If Stufe13 > Stufe3 Then
            Stufe13 = Stufe3
        End If
        Stufe14 = Stufe1 + 4
        If Stufe14 > Stufe3 Then
            Stufe14 = Stufe3
        End If

        Stufe21 = Stufe2 + 1
        If Stufe21 > Stufe3 Then
            Stufe21 = Stufe3
        End If
        Stufe22 = Stufe2 + 2
        If Stufe22 > Stufe3 Then
            Stufe22 = Stufe3
        End If
        Stufe23 = Stufe2 + 3
        If Stufe23 > Stufe3 Then
            Stufe23 = Stufe3
        End If
        Stufe24 = Stufe2 + 4
        If Stufe24 > Stufe3 Then
            Stufe24 = Stufe3
        End If
        If G_200 > 0 Then
            If G_200 < Stufe4 Then
                G_200 = Stufe4
            End If
        Else
            G_200 = Stufe4
        End If

        If Betriebsart = 1 And (_GlsL66 = 3 Or _GlsL66 = 4) Then
            SetProgramCounterLabel1(_Prog66)
        Else
            SetProgramCounterLabel(_Prog66)
        End If

        ' Lok starten - Bahnhofsausfahrt

        If _Prog66 = 0 Then
            Prog_Lok66.Interval = 2000
            _eb.lokSteuern(66, Klassen.LokEigenschaften.Geschwindigkeit, 0)
        ElseIf _Prog66 = 1 Then
            If _Fahrzeugbeleuchtung2 > 0 Then
                _eb.lokSteuern(66, Klassen.LokEigenschaften.Hauptfunktion, 1) ' Licht ein
            Else
                _eb.lokSteuern(66, Klassen.LokEigenschaften.Hauptfunktion, 0) ' Licht aus
            End If
        ElseIf _Prog66 = 2 Then
            If _Motor > 0 Then
                _eb.lokSteuern(66, Klassen.LokEigenschaften.Funktion2, 1) ' Dampfgeräusch ein
            Else
                _eb.lokSteuern(66, Klassen.LokEigenschaften.Funktion2, 0) ' Dampfgeräusch aus
            End If
        ElseIf _Prog66 = 3 Then
            _Betriebsparameter.RundenErhoehen(66)
        ElseIf _Prog66 = 4 Then
        ElseIf _Prog66 = 5 Then
        ElseIf _Prog66 = 6 Then
            If _Dampf > 0 Then
                _eb.lokSteuern(66, Klassen.LokEigenschaften.Funktion1, 1) ' Dampf ein
            Else
                _eb.lokSteuern(66, Klassen.LokEigenschaften.Funktion1, 0) ' Dampf aus
            End If
        ElseIf _Prog66 = 7 Then
        ElseIf _Prog66 = 8 Then
        ElseIf _Prog66 = 9 Then
        ElseIf _Prog66 = 10 Then
            If _AkustischeSignale > 0 Then
                _eb.lokSteuern(66, Klassen.LokEigenschaften.Funktion3, 1) ' Pfiff ein
            End If
        ElseIf _Prog66 = 11 Then
            _eb.lokSteuern(66, Klassen.LokEigenschaften.Funktion3, 0) ' Pfiff aus
        ElseIf _Prog66 = 12 Then

            ' Bahnhofsausfahrt

        ElseIf _Prog66 = 13 Then
            _eb.lokSteuern(66, Klassen.LokEigenschaften.Geschwindigkeit, Stufe1)
        ElseIf _Prog66 = 14 Then
            _eb.lokSteuern(66, Klassen.LokEigenschaften.Geschwindigkeit, Stufe11)
        ElseIf _Prog66 = 15 Then
            _eb.lokSteuern(66, Klassen.LokEigenschaften.Geschwindigkeit, Stufe12)
        ElseIf _Prog66 = 16 Then
            _eb.lokSteuern(66, Klassen.LokEigenschaften.Geschwindigkeit, Stufe13)
        ElseIf _Prog66 = 17 Then
            _eb.lokSteuern(66, Klassen.LokEigenschaften.Geschwindigkeit, Stufe14)
        ElseIf _Prog66 = 18 Then
            _eb.lokSteuern(66, Klassen.LokEigenschaften.Geschwindigkeit, Stufe3)
            If _Dampf < 3 Then
                _eb.lokSteuern(66, Klassen.LokEigenschaften.Funktion1, 0) ' Dampf aus
            End If
        ElseIf _Prog66 = 19 Then
            If _Motor < 3 Then
                _eb.lokSteuern(66, Klassen.LokEigenschaften.Funktion2, 0) ' Dampfgeräusch aus
            End If

            ' Lok abstellen

        ElseIf _Prog66 = 50 Then
            Prog_Lok66.Interval = 2000
        ElseIf _Prog66 = 51 Then
            If _Dampf < 3 Then
                _eb.lokSteuern(66, Klassen.LokEigenschaften.Funktion1, 0) ' Dampf aus
            End If
        ElseIf _Prog66 = 52 Then
            If _Motor < 3 Then
                _eb.lokSteuern(66, Klassen.LokEigenschaften.Funktion2, 0) ' Dampfgeräusch aus
            End If
        ElseIf _Prog66 = 53 Then
            If _Fahrzeugbeleuchtung2 < 2 Then
                _eb.lokSteuern(66, Klassen.LokEigenschaften.Hauptfunktion, 0) ' Licht aus
            End If

            ' Lok bremsen (Bahnhofseinfahrt Normalzug von links und von rechts)

        ElseIf _Prog66 = 100 Then
            Prog_Lok66.Interval = V_100
            If _Motor > 0 Then
                _eb.lokSteuern(66, Klassen.LokEigenschaften.Funktion2, 1) ' Dampfgeräusch ein
            End If
        ElseIf _Prog66 = 101 Then
            _eb.lokSteuern(66, Klassen.LokEigenschaften.Geschwindigkeit, Stufe24)
            Prog_Lok66.Interval = T_100
        ElseIf _Prog66 = 102 Then
            _eb.lokSteuern(66, Klassen.LokEigenschaften.Geschwindigkeit, Stufe23)
        ElseIf _Prog66 = 103 Then
            _eb.lokSteuern(66, Klassen.LokEigenschaften.Geschwindigkeit, Stufe22)
        ElseIf _Prog66 = 104 Then
            _eb.lokSteuern(66, Klassen.LokEigenschaften.Geschwindigkeit, Stufe21)
        ElseIf _Prog66 = 105 Then
            _eb.lokSteuern(66, Klassen.LokEigenschaften.Geschwindigkeit, Stufe2)
            _Prog66 = 49

            ' Lok bremsen (Bahnhofseinfahrt Kurzzug von links)

        ElseIf _Prog66 = 130 Then
            Prog_Lok66.Interval = V_130
        ElseIf _Prog66 = 131 Then
            _eb.lokSteuern(66, Klassen.LokEigenschaften.Geschwindigkeit, Stufe24)
            Prog_Lok66.Interval = T_130
        ElseIf _Prog66 = 132 Then
            _eb.lokSteuern(66, Klassen.LokEigenschaften.Geschwindigkeit, Stufe22)
        ElseIf _Prog66 = 133 Then
            _eb.lokSteuern(66, Klassen.LokEigenschaften.Geschwindigkeit, Stufe23)
        ElseIf _Prog66 = 134 Then
            _eb.lokSteuern(66, Klassen.LokEigenschaften.Geschwindigkeit, Stufe21)
        ElseIf _Prog66 = 135 Then
            _eb.lokSteuern(66, Klassen.LokEigenschaften.Geschwindigkeit, Stufe2)
        ElseIf _Prog66 = 136 Then
            _eb.lokSteuern(66, Klassen.LokEigenschaften.Geschwindigkeit, 0)
        ElseIf _Prog66 = 137 Then
            Prog_Lok66.Interval = 2000
            If _Dampf < 3 Then
                _eb.lokSteuern(66, Klassen.LokEigenschaften.Funktion1, 0) ' Dampf aus
            End If
        ElseIf _Prog66 = 138 Then
            If _Motor < 3 Then
                _eb.lokSteuern(66, Klassen.LokEigenschaften.Funktion2, 0) ' Dampfgeräusch aus
            End If
        ElseIf _Prog66 = 139 Then
            If _Fahrzeugbeleuchtung2 < 2 Then
                _eb.lokSteuern(66, Klassen.LokEigenschaften.Hauptfunktion, 0) ' Licht aus
            End If

            ' Lok bremsen (Bahnhofseinfahrt Kurzzug von rechts)

        ElseIf _Prog66 = 160 Then
            Prog_Lok66.Interval = V_160
        ElseIf _Prog66 = 161 Then
            _eb.lokSteuern(66, Klassen.LokEigenschaften.Geschwindigkeit, Stufe24)
            Prog_Lok66.Interval = T_160
        ElseIf _Prog66 = 162 Then
            _eb.lokSteuern(66, Klassen.LokEigenschaften.Geschwindigkeit, Stufe23)
        ElseIf _Prog66 = 163 Then
            _eb.lokSteuern(66, Klassen.LokEigenschaften.Geschwindigkeit, Stufe22)
        ElseIf _Prog66 = 164 Then
            _eb.lokSteuern(66, Klassen.LokEigenschaften.Geschwindigkeit, Stufe21)
        ElseIf _Prog66 = 165 Then
            _eb.lokSteuern(66, Klassen.LokEigenschaften.Geschwindigkeit, Stufe2)
        ElseIf _Prog66 = 166 Then
            _eb.lokSteuern(66, Klassen.LokEigenschaften.Geschwindigkeit, 0)
        ElseIf _Prog66 = 167 Then
            Prog_Lok66.Interval = 2000
            If _Dampf < 3 Then
                _eb.lokSteuern(66, Klassen.LokEigenschaften.Funktion1, 0) ' Dampf aus
            End If
        ElseIf _Prog66 = 168 Then
            If _Motor < 3 Then
                _eb.lokSteuern(66, Klassen.LokEigenschaften.Funktion2, 0) ' Dampfgeräusch aus
            End If
        ElseIf _Prog66 = 169 Then
            If _Fahrzeugbeleuchtung2 < 2 Then
                _eb.lokSteuern(66, Klassen.LokEigenschaften.Hauptfunktion, 0) ' Licht aus
            End If

            ' Rangierzug

        ElseIf _Prog66 = 180 Then
            _eb.lokSteuern(66, Klassen.LokEigenschaften.Geschwindigkeit, 2)
            Prog_Lok66.Interval = V_180
        ElseIf _Prog66 = 181 Then
            Prog_Lok66.Interval = T_180
            _eb.lokSteuern(66, Klassen.LokEigenschaften.Geschwindigkeit, 1)
        ElseIf _Prog66 = 182 Then
            _eb.lokSteuern(66, Klassen.LokEigenschaften.Geschwindigkeit, 0)

            ' Tunnelausfahrt

        ElseIf _Prog66 = 200 Then ' Kontakt 1.2 <- (bergauf)
            _eb.lokSteuern(66, Klassen.LokEigenschaften.Geschwindigkeit, G_200)
            Prog_Lok66.Interval = 3000
        ElseIf _Prog66 = 201 Then
        ElseIf _Prog66 = 202 Then
        ElseIf _Prog66 = 203 Then
            If _Dampf > 1 Then
                _eb.lokSteuern(66, Klassen.LokEigenschaften.Funktion1, 1) ' Dampf ein
            End If
        ElseIf _Prog66 = 204 Then
            Prog_Lok66.Interval = 1000
        ElseIf _Prog66 = 205 Then
            If Stufe4 < Stufe3 Then
                _eb.lokSteuern(66, Klassen.LokEigenschaften.Geschwindigkeit, Stufe3)
            Else
                _eb.lokSteuern(66, Klassen.LokEigenschaften.Geschwindigkeit, Stufe4)
            End If
        ElseIf _Prog66 = 206 Then
            If _Motor > 1 Then
                _eb.lokSteuern(66, Klassen.LokEigenschaften.Funktion2, 1) ' Dampfgeräusch ein
            End If
        ElseIf _Prog66 = 207 Then
            If _AkustischeSignale > 1 Then
                _eb.lokSteuern(66, Klassen.LokEigenschaften.Funktion3, 1) ' Pfiff ein
            End If
        ElseIf _Prog66 = 208 Then
            _eb.lokSteuern(66, Klassen.LokEigenschaften.Funktion3, 0) ' Pfiff aus

        ElseIf _Prog66 = 220 Then ' Kontakt 3.1 -> (hinter dem Martinstor bergauf)
            Prog_Lok66.Interval = 3000
        ElseIf _Prog66 = 221 Then
        ElseIf _Prog66 = 222 Then
            If _Dampf < 3 Then
                _eb.lokSteuern(66, Klassen.LokEigenschaften.Funktion1, 0) ' Dampf aus
            End If
        ElseIf _Prog66 = 223 Then
            If _Motor < 3 Then
                _eb.lokSteuern(66, Klassen.LokEigenschaften.Funktion2, 1) ' Dampfgeräusch aus
            End If

        ElseIf _Prog66 = 240 Then ' Kontakt 3.7 <- (hinter der Brücke bergauf)
            Prog_Lok66.Interval = 3000
        ElseIf _Prog66 = 241 Then
            If _Dampf > 1 Then
                _eb.lokSteuern(66, Klassen.LokEigenschaften.Funktion1, 1) ' Dampf ein
            End If
        ElseIf _Prog66 = 242 Then
            Prog_Lok66.Interval = 1000
        ElseIf _Prog66 = 243 Then
            If _Motor > 1 Then
                _eb.lokSteuern(66, Klassen.LokEigenschaften.Funktion2, 1) ' Dampfgeräusch ein
            End If
        ElseIf _Prog66 = 244 Then
            If _AkustischeSignale > 1 Then
                _eb.lokSteuern(66, Klassen.LokEigenschaften.Funktion3, 1) ' Pfiff ein
            End If
        ElseIf _Prog66 = 245 Then
            _eb.lokSteuern(66, Klassen.LokEigenschaften.Funktion3, 0) ' Pfiff aus
        ElseIf _Prog66 = 246 Then
        ElseIf _Prog66 = 247 Then
            If _Dampf < 3 Then
                _eb.lokSteuern(66, Klassen.LokEigenschaften.Funktion1, 0) ' Dampf aus
            End If
        ElseIf _Prog66 = 248 Then
            If _Motor > 1 Then
                _eb.lokSteuern(66, Klassen.LokEigenschaften.Funktion2, 0) ' Dampfgeräusch aus
            End If

        ElseIf _Prog66 = 260 Then ' Kontakt 3.3 (links bzw vor der Brücke)
            Prog_Lok66.Interval = 2000
        ElseIf _Prog66 = 261 Then
        ElseIf _Prog66 = 262 Then
            _eb.lokSteuern(66, Klassen.LokEigenschaften.Geschwindigkeit, Stufe3)

        ElseIf _Prog66 = 600 Then ' Kontakt 3.5 <- (unter der Burg)
            Prog_Lok66.Interval = 1000
        ElseIf _Prog66 = 601 Then
            If _AkustischeSignale > 1 Then
                _eb.lokSteuern(66, Klassen.LokEigenschaften.Funktion3, 1) ' Pfiff ein
            End If
        ElseIf _Prog66 = 602 Then
            _eb.lokSteuern(66, Klassen.LokEigenschaften.Funktion3, 0) ' Pfiff aus
        ElseIf _Prog66 = 603 Then

        ElseIf _Prog66 = 620 Then ' Kontakt 3.7 -> (hinter der Brücke bergab)
            Prog_Lok66.Interval = 3000
        ElseIf _Prog66 = 621 Then
            Prog_Lok66.Interval = 1000
        ElseIf _Prog66 = 622 Then
            If _AkustischeSignale > 1 Then
                _eb.lokSteuern(66, Klassen.LokEigenschaften.Funktion3, 1) ' Pfiff ein
            End If
        ElseIf _Prog66 = 623 Then
            _eb.lokSteuern(66, Klassen.LokEigenschaften.Funktion3, 0) ' Pfiff aus

        ElseIf _Prog66 = 640 Then ' Kontakt 3.1 <- Talfahrt
            Prog_Lok66.Interval = 2000
        ElseIf _Prog66 = 641 Then
        ElseIf _Prog66 = 642 Then
            If _Motor < 3 Then
                _eb.lokSteuern(66, Klassen.LokEigenschaften.Funktion2, 0) ' Dampfgeräusch aus
            End If

        ElseIf _Prog66 = 660 Then ' Kontakt 1.2 -> Talfahrt
            Prog_Lok66.Interval = 4000
        ElseIf _Prog66 = 661 Then
        ElseIf _Prog66 = 662 Then
            Prog_Lok66.Interval = 1000
        ElseIf _Prog66 = 663 Then
            If _AkustischeSignale > 1 Then
                _eb.lokSteuern(66, Klassen.LokEigenschaften.Funktion3, 1) ' Pfiff ein
            End If
        ElseIf _Prog66 = 664 Then
            _eb.lokSteuern(66, Klassen.LokEigenschaften.Funktion3, 0) ' Pfiff aus

        ElseIf _Prog66 = 700 Then ' Kontakt 0.4 <- Diagonale
            Prog_Lok66.Interval = 3000
        ElseIf _Prog66 = 701 Then
        ElseIf _Prog66 = 702 Then
        ElseIf _Prog66 = 703 Then
            If _Motor > 1 Then
                _eb.lokSteuern(66, Klassen.LokEigenschaften.Funktion2, 1) ' Dampfgeräusch ein
            End If
        ElseIf _Prog66 = 704 Then
            Prog_Lok66.Interval = 1000
        ElseIf _Prog66 = 705 Then
            If _AkustischeSignale > 1 Then
                _eb.lokSteuern(66, Klassen.LokEigenschaften.Funktion3, 1) ' Pfiff ein
            End If
        ElseIf _Prog66 = 706 Then
            _eb.lokSteuern(66, Klassen.LokEigenschaften.Funktion3, 0) ' Pfiff aus

            ' Zindelstein

        ElseIf _Prog66 = 500 Then
            Prog_Lok66.Interval = V_500
        ElseIf _Prog66 = 501 Then
            _eb.lokSteuern(66, Klassen.LokEigenschaften.Geschwindigkeit, Stufe24)
            Prog_Lok66.Interval = T_500
        ElseIf _Prog66 = 502 Then
            _eb.lokSteuern(66, Klassen.LokEigenschaften.Geschwindigkeit, Stufe23)
        ElseIf _Prog66 = 503 Then
            _eb.lokSteuern(66, Klassen.LokEigenschaften.Geschwindigkeit, Stufe22)
        ElseIf _Prog66 = 504 Then
            _eb.lokSteuern(66, Klassen.LokEigenschaften.Geschwindigkeit, Stufe22)
        ElseIf _Prog66 = 505 Then
            _eb.lokSteuern(66, Klassen.LokEigenschaften.Geschwindigkeit, Stufe2)
        ElseIf _Prog66 = 506 Then
            _eb.lokSteuern(66, Klassen.LokEigenschaften.Geschwindigkeit, 0)


        Else
            _Prog66 = 0
            Prog_Lok66.Stop()
            Prog_Lok66.Interval = 200
            If Betriebsart = 1 Then
                SetProgramCounterLabel1(String.Empty)
            Else
                SetProgramCounterLabel(String.Empty)
            End If
        End If
        _Prog66 = _Prog66 + 1
    End Sub
    Private Sub HandleTimerElapsed79(sender As System.Object, e As System.EventArgs) Handles Prog_Lok67.Elapsed

        '*** Fahrprogramm Baureihe 38 (382581)
        '*** Datum: 23.02.2020

        SetText(TextBox1, "Dampflok 38 2581                                                        IBS: 10.01.2024 - V3 : 6")
        'PictureBox1.Visible = True
        LoadImage(PictureBox1, "H:\\EB_Media\\LokFotos\\Baureihe_38_01.jpg")
        GeschwindikeitenSetzen(67)

        Dim Stufe1, Stufe2, Stufe3, Stufe4 As Integer
        Dim Stufe11, Stufe12, Stufe13, Stufe14, Stufe21, Stufe22, Stufe23, Stufe24 As Integer
        Dim V_100, V_130, V_160, V_180, V_500 As Integer
        Dim T_100, T_130, T_160, T_180, T_500 As Integer
        Dim G_200 As Integer

        T_100 = _Betriebsparameter.Fahrparameter(67, KlausEBspecific.Betriebsparameter.FahrparameterEnum.T_100)
        T_130 = _Betriebsparameter.Fahrparameter(67, KlausEBspecific.Betriebsparameter.FahrparameterEnum.T_130)
        T_160 = _Betriebsparameter.Fahrparameter(67, KlausEBspecific.Betriebsparameter.FahrparameterEnum.T_160)
        T_180 = _Betriebsparameter.Fahrparameter(67, KlausEBspecific.Betriebsparameter.FahrparameterEnum.T_180)
        T_500 = _Betriebsparameter.Fahrparameter(67, KlausEBspecific.Betriebsparameter.FahrparameterEnum.T_500)
        V_100 = _Betriebsparameter.Fahrparameter(67, KlausEBspecific.Betriebsparameter.FahrparameterEnum.V_100)
        V_130 = _Betriebsparameter.Fahrparameter(67, KlausEBspecific.Betriebsparameter.FahrparameterEnum.V_130)
        V_160 = _Betriebsparameter.Fahrparameter(67, KlausEBspecific.Betriebsparameter.FahrparameterEnum.V_160)
        V_180 = _Betriebsparameter.Fahrparameter(67, KlausEBspecific.Betriebsparameter.FahrparameterEnum.V_180)
        V_500 = _Betriebsparameter.Fahrparameter(67, KlausEBspecific.Betriebsparameter.FahrparameterEnum.V_500)
        G_200 = _Betriebsparameter.Fahrparameter(67, KlausEBspecific.Betriebsparameter.FahrparameterEnum.G_200)

        If A_StopB = 1 Then
            V_100 = 8000
        End If

        Stufe1 = _LokStufen.Holen(67, 1)
        Stufe2 = _LokStufen.Holen(67, 2)
        Stufe3 = _LokStufen.Holen(67, 3)
        Stufe4 = _LokStufen.Holen(67, 4)

        If Stufe2 = 1 Then
            T_100 = T_100
            T_130 = T_130
            T_160 = T_160
            V_180 = V_180
        ElseIf Stufe2 = 2 Then
            T_100 = T_100 + 300
            T_130 = T_130 + 300
            T_160 = T_160 + 300
            V_180 = V_180 + 500
        ElseIf Stufe2 = 3 Then
            T_100 = T_100 + 500
            T_130 = T_130 + 500
            T_160 = T_160 + 500
            V_180 = V_180 + 1000
        ElseIf Stufe2 = 4 Then
            T_100 = T_100 + 700
            T_130 = T_130 + 700
            T_160 = T_160 + 700
            V_180 = V_180 + 1500
        ElseIf Stufe2 = 5 Then
            T_100 = T_100 + 900
            T_130 = T_130 + 900
            T_160 = T_160 + 900
            V_180 = V_180 + 2000
        ElseIf Stufe2 = 6 Then
            T_100 = T_100 + 1200
            T_130 = T_130 + 1200
            T_160 = T_160 + 1200
            V_180 = V_180 + 2500
        Else
            T_100 = T_100 + 1200
            T_130 = T_130 + 1200
            T_160 = T_160 + 1200
            V_180 = V_180 + 2500
        End If

        Stufe2 = Stufe1

        Stufe11 = Stufe1 + 1
        If Stufe11 > Stufe3 Then
            Stufe11 = Stufe3
        End If
        Stufe12 = Stufe1 + 2
        If Stufe12 > Stufe3 Then
            Stufe12 = Stufe3
        End If
        Stufe13 = Stufe1 + 3
        If Stufe13 > Stufe3 Then
            Stufe13 = Stufe3
        End If
        Stufe14 = Stufe1 + 4
        If Stufe14 > Stufe3 Then
            Stufe14 = Stufe3
        End If

        Stufe21 = Stufe2 + 1
        If Stufe21 > Stufe3 Then
            Stufe21 = Stufe3
        End If
        Stufe22 = Stufe2 + 2
        If Stufe22 > Stufe3 Then
            Stufe22 = Stufe3
        End If
        Stufe23 = Stufe2 + 3
        If Stufe23 > Stufe3 Then
            Stufe23 = Stufe3
        End If
        Stufe24 = Stufe2 + 4
        If Stufe24 > Stufe3 Then
            Stufe24 = Stufe3
        End If
        If G_200 > 0 Then
            If G_200 < Stufe4 Then
                G_200 = Stufe4
            End If
        Else
            G_200 = Stufe4
        End If

        If Betriebsart = 1 And (_GlsL67 = 3 Or _GlsL67 = 4) Then
            SetProgramCounterLabel1(_Prog67)
        Else
            SetProgramCounterLabel(_Prog67)
        End If

        ' Lok starten - Bahnhofsausfahrt

        If _Prog67 = 0 Then
            Prog_Lok67.Interval = 2000
            If _Fahrzeugbeleuchtung2 > 0 Then
                _eb.lokSteuern(67, Klassen.LokEigenschaften.Hauptfunktion, 1) ' Licht ein
            End If
        ElseIf _Prog67 = 1 Then
            If _Dampf > 0 Then
                _eb.lokSteuern(67, Klassen.LokEigenschaften.Funktion1, 1) ' Dampf ein
            End If
        ElseIf _Prog67 = 2 Then
            _Betriebsparameter.RundenErhoehen(67)
        ElseIf _Prog67 = 3 Then
        ElseIf _Prog67 = 4 Then
        ElseIf _Prog67 = 5 Then
        ElseIf _Prog67 = 6 Then

            ' Bahnhofsausfahrt

        ElseIf _Prog67 = 7 Then
            _eb.lokSteuern(67, Klassen.LokEigenschaften.Geschwindigkeit, Stufe1)
        ElseIf _Prog67 = 8 Then
            _eb.lokSteuern(67, Klassen.LokEigenschaften.Geschwindigkeit, Stufe11)
        ElseIf _Prog67 = 9 Then
            _eb.lokSteuern(67, Klassen.LokEigenschaften.Geschwindigkeit, Stufe12)
        ElseIf _Prog67 = 10 Then
            _eb.lokSteuern(67, Klassen.LokEigenschaften.Geschwindigkeit, Stufe13)
        ElseIf _Prog67 = 11 Then
            _eb.lokSteuern(67, Klassen.LokEigenschaften.Geschwindigkeit, Stufe14)
        ElseIf _Prog67 = 12 Then
            _eb.lokSteuern(67, Klassen.LokEigenschaften.Geschwindigkeit, Stufe3)
        ElseIf _Prog67 = 13 Then
            If _Dampf = 1 Then
                _eb.lokSteuern(67, Klassen.LokEigenschaften.Funktion1, 0) ' Dampf aus
            End If

            ' Lok abstellen

        ElseIf _Prog67 = 50 Then
            Prog_Lok67.Interval = 2000
            If _Dampf < 2 Then
                _eb.lokSteuern(67, Klassen.LokEigenschaften.Funktion1, 0) ' Dampf aus
            End If
        ElseIf _Prog67 = 51 Then
        ElseIf _Prog67 = 52 Then
            If _Fahrzeugbeleuchtung2 < 2 Then
                _eb.lokSteuern(67, Klassen.LokEigenschaften.Hauptfunktion, 0) ' Licht aus
            End If

            ' Lok bremsen (Bahnhofseinfahrt Normalzug von links und von rechts)

        ElseIf _Prog67 = 100 Then
            Prog_Lok67.Interval = V_100
        ElseIf _Prog67 = 101 Then
            _eb.lokSteuern(67, Klassen.LokEigenschaften.Geschwindigkeit, Stufe24)
            Prog_Lok67.Interval = T_100
        ElseIf _Prog67 = 102 Then
            _eb.lokSteuern(67, Klassen.LokEigenschaften.Geschwindigkeit, Stufe23)
        ElseIf _Prog67 = 103 Then
            _eb.lokSteuern(67, Klassen.LokEigenschaften.Geschwindigkeit, Stufe22)
        ElseIf _Prog67 = 104 Then
            _eb.lokSteuern(67, Klassen.LokEigenschaften.Geschwindigkeit, Stufe21)
        ElseIf _Prog67 = 105 Then
            _eb.lokSteuern(67, Klassen.LokEigenschaften.Geschwindigkeit, Stufe2)


            ' Lok bremsen (Bahnhofseinfahrt Kurzzug von links)

        ElseIf _Prog67 = 130 Then
            Prog_Lok67.Interval = V_130
        ElseIf _Prog67 = 131 Then
            _eb.lokSteuern(67, Klassen.LokEigenschaften.Geschwindigkeit, Stufe24)
            Prog_Lok67.Interval = T_130
        ElseIf _Prog67 = 132 Then
            _eb.lokSteuern(67, Klassen.LokEigenschaften.Geschwindigkeit, Stufe23)
        ElseIf _Prog67 = 133 Then
            _eb.lokSteuern(67, Klassen.LokEigenschaften.Geschwindigkeit, Stufe22)
        ElseIf _Prog67 = 134 Then
            _eb.lokSteuern(67, Klassen.LokEigenschaften.Geschwindigkeit, Stufe21)
        ElseIf _Prog67 = 135 Then
            _eb.lokSteuern(67, Klassen.LokEigenschaften.Geschwindigkeit, Stufe2)
        ElseIf _Prog67 = 136 Then
            _eb.lokSteuern(67, Klassen.LokEigenschaften.Geschwindigkeit, 0)
        ElseIf _Prog67 = 137 Then
            Prog_Lok67.Interval = 2000
        ElseIf _Prog67 = 138 Then
            If _Fahrzeugbeleuchtung2 < 2 Then
                _eb.lokSteuern(67, Klassen.LokEigenschaften.Hauptfunktion, 0) ' Licht aus
            End If

            ' Lok bremsen (Bahnhofseinfahrt Kurzzug von rechts)

        ElseIf _Prog67 = 160 Then
            Prog_Lok67.Interval = V_160
        ElseIf _Prog67 = 161 Then
            _eb.lokSteuern(67, Klassen.LokEigenschaften.Geschwindigkeit, Stufe24)
            Prog_Lok67.Interval = T_160
        ElseIf _Prog67 = 162 Then
            _eb.lokSteuern(67, Klassen.LokEigenschaften.Geschwindigkeit, Stufe23)
        ElseIf _Prog67 = 163 Then
            _eb.lokSteuern(67, Klassen.LokEigenschaften.Geschwindigkeit, Stufe22)
        ElseIf _Prog67 = 164 Then
            _eb.lokSteuern(67, Klassen.LokEigenschaften.Geschwindigkeit, Stufe21)
        ElseIf _Prog67 = 165 Then
            _eb.lokSteuern(67, Klassen.LokEigenschaften.Geschwindigkeit, Stufe2)
        ElseIf _Prog67 = 166 Then
            _eb.lokSteuern(67, Klassen.LokEigenschaften.Geschwindigkeit, 0)
        ElseIf _Prog67 = 167 Then
            Prog_Lok67.Interval = 2000
        ElseIf _Prog67 = 168 Then
            If _Fahrzeugbeleuchtung2 < 2 Then
                _eb.lokSteuern(67, Klassen.LokEigenschaften.Hauptfunktion, 0) ' Licht aus
            End If

            ' Rangierzug

        ElseIf _Prog67 = 180 Then
            _eb.lokSteuern(67, Klassen.LokEigenschaften.Geschwindigkeit, 2)
            Prog_Lok67.Interval = V_180
        ElseIf _Prog67 = 181 Then
            Prog_Lok67.Interval = T_180
            _eb.lokSteuern(67, Klassen.LokEigenschaften.Geschwindigkeit, 1)
        ElseIf _Prog67 = 182 Then
            _eb.lokSteuern(67, Klassen.LokEigenschaften.Geschwindigkeit, 0)

            ' Tunnelausfahrt

        ElseIf _Prog67 = 200 Then ' Kontakt 1.2 <- (bergauf)
            _eb.lokSteuern(67, Klassen.LokEigenschaften.Geschwindigkeit, G_200)
            Prog_Lok67.Interval = 2000
        ElseIf _Prog67 = 201 Then
        ElseIf _Prog67 = 202 Then
        ElseIf _Prog67 = 203 Then
        ElseIf _Prog67 = 204 Then
        ElseIf _Prog67 = 205 Then
            If Stufe4 < Stufe3 Then
                _eb.lokSteuern(67, Klassen.LokEigenschaften.Geschwindigkeit, Stufe3)
            Else
                _eb.lokSteuern(67, Klassen.LokEigenschaften.Geschwindigkeit, Stufe4)
            End If
        ElseIf _Prog67 = 206 Then
        ElseIf _Prog67 = 207 Then
            If _Motor > 1 Then
                _eb.lokSteuern(67, Klassen.LokEigenschaften.Funktion2, 1) ' Motor ein
            End If
        ElseIf _Prog67 = 208 Then
            Prog_Lok67.Interval = 2000
        ElseIf _Prog67 = 209 Then
            If _AkustischeSignale > 1 Then
                _eb.lokSteuern(67, Klassen.LokEigenschaften.Funktion3, 1) ' Hupe ein
            End If
        ElseIf _Prog67 = 210 Then
            _eb.lokSteuern(67, Klassen.LokEigenschaften.Funktion3, 0) ' Hupe aus

        ElseIf _Prog67 = 220 Then ' Kontakt 3.1 -> (hinter dem Martinstor bergauf)
            Prog_Lok67.Interval = 2000
        ElseIf _Prog67 = 221 Then
        ElseIf _Prog67 = 222 Then

        ElseIf _Prog67 = 240 Then ' Kontakt 3.7 <- (hinter der Brücke bergauf)
            Prog_Lok67.Interval = 2000
        ElseIf _Prog67 = 241 Then
        ElseIf _Prog67 = 242 Then

        ElseIf _Prog67 = 260 Then ' Kontakt 3.3 (links bzw vor der Brücke)
            Prog_Lok67.Interval = 2000
        ElseIf _Prog67 = 261 Then
        ElseIf _Prog67 = 262 Then
            _eb.lokSteuern(67, Klassen.LokEigenschaften.Geschwindigkeit, Stufe3)


        ElseIf _Prog67 = 600 Then ' Kontakt 3.5 <- (unter der Burg)
            Prog_Lok67.Interval = 2000
        ElseIf _Prog67 = 601 Then
        ElseIf _Prog67 = 602 Then

        ElseIf _Prog67 = 620 Then ' Kontakt 3.7 -> (hinter der Brücke bergab)
            Prog_Lok67.Interval = 2000
        ElseIf _Prog67 = 621 Then
        ElseIf _Prog67 = 622 Then

        ElseIf _Prog67 = 640 Then ' Kontakt 3.1 <- Talfahrt
            Prog_Lok67.Interval = 2000
        ElseIf _Prog67 = 641 Then
        ElseIf _Prog67 = 642 Then

        ElseIf _Prog67 = 660 Then ' Kontakt 1.2 -> Talfahrt
            Prog_Lok67.Interval = 2000
        ElseIf _Prog67 = 661 Then
        ElseIf _Prog67 = 662 Then

        ElseIf _Prog67 = 700 Then ' Kontakt 0.4 <- Diagonale
            Prog_Lok67.Interval = 2000
        ElseIf _Prog67 = 701 Then
        ElseIf _Prog67 = 702 Then

            ' Zindelstein

        ElseIf _Prog67 = 500 Then
            Prog_Lok67.Interval = V_500
        ElseIf _Prog67 = 501 Then
            _eb.lokSteuern(67, Klassen.LokEigenschaften.Geschwindigkeit, Stufe23)
            Prog_Lok67.Interval = T_500
        ElseIf _Prog67 = 502 Then
            _eb.lokSteuern(67, Klassen.LokEigenschaften.Geschwindigkeit, Stufe22)
        ElseIf _Prog67 = 503 Then
            _eb.lokSteuern(67, Klassen.LokEigenschaften.Geschwindigkeit, Stufe21)
        ElseIf _Prog67 = 504 Then
            _eb.lokSteuern(67, Klassen.LokEigenschaften.Geschwindigkeit, Stufe2)
        ElseIf _Prog67 = 505 Then
            _eb.lokSteuern(67, Klassen.LokEigenschaften.Geschwindigkeit, 0)

        Else
            _Prog67 = 0
            Prog_Lok67.Stop()
            Prog_Lok67.Interval = 200
            If Betriebsart = 1 Then
                SetProgramCounterLabel1(String.Empty)
            Else
                SetProgramCounterLabel(String.Empty)
            End If
        End If
        _Prog67 = _Prog67 + 1
    End Sub
    Private Sub HandleTimerElapsed80(sender As System.Object, e As System.EventArgs) Handles Prog_Lok68.Elapsed

        '*** Fahrprogramm für Dampflok 01 1057
        '*** Datum: 23.02.2020

        SetText(TextBox1, "Dampflok 01 1057                                                        IBS: 10.12.2025 - V3: 8")
        LoadImage(PictureBox1, "H:\\EB_Media\\LokFotos\\Baureihe_01_01.jpg")
        GeschwindikeitenSetzen(68)

        Dim Stufe1, Stufe2, Stufe3, Stufe4 As Integer
        Dim Stufe11, Stufe12, Stufe13, Stufe14, Stufe21, Stufe22, Stufe23, Stufe24 As Integer
        Dim V_100, V_130, V_160, V_180, V_500 As Integer
        Dim T_100, T_130, T_160, T_180, T_500 As Integer
        Dim G_200 As Integer

        T_100 = _Betriebsparameter.Fahrparameter(68, KlausEBspecific.Betriebsparameter.FahrparameterEnum.T_100)
        T_130 = _Betriebsparameter.Fahrparameter(68, KlausEBspecific.Betriebsparameter.FahrparameterEnum.T_130)
        T_160 = _Betriebsparameter.Fahrparameter(68, KlausEBspecific.Betriebsparameter.FahrparameterEnum.T_160)
        T_180 = _Betriebsparameter.Fahrparameter(68, KlausEBspecific.Betriebsparameter.FahrparameterEnum.T_180)
        T_500 = _Betriebsparameter.Fahrparameter(68, KlausEBspecific.Betriebsparameter.FahrparameterEnum.T_500)
        V_100 = _Betriebsparameter.Fahrparameter(68, KlausEBspecific.Betriebsparameter.FahrparameterEnum.V_100)
        V_130 = _Betriebsparameter.Fahrparameter(68, KlausEBspecific.Betriebsparameter.FahrparameterEnum.V_130)
        V_160 = _Betriebsparameter.Fahrparameter(68, KlausEBspecific.Betriebsparameter.FahrparameterEnum.V_160)
        V_180 = _Betriebsparameter.Fahrparameter(68, KlausEBspecific.Betriebsparameter.FahrparameterEnum.V_180)
        V_500 = _Betriebsparameter.Fahrparameter(68, KlausEBspecific.Betriebsparameter.FahrparameterEnum.V_500)
        G_200 = _Betriebsparameter.Fahrparameter(68, KlausEBspecific.Betriebsparameter.FahrparameterEnum.G_200)

        If A_StopB = 1 Then
            V_100 = 8000
        End If

        Stufe1 = _LokStufen.Holen(68, 1)
        Stufe2 = _LokStufen.Holen(68, 2)
        Stufe3 = _LokStufen.Holen(68, 3)
        Stufe4 = _LokStufen.Holen(68, 4)

        If Stufe2 = 1 Then
            T_100 = T_100
            T_130 = T_130
            T_160 = T_160
            V_180 = V_180
        ElseIf Stufe2 = 2 Then
            T_100 = T_100 + 300
            T_130 = T_130 + 300
            T_160 = T_160 + 300
            V_180 = V_180 + 500
        ElseIf Stufe2 = 3 Then
            T_100 = T_100 + 500
            T_130 = T_130 + 500
            T_160 = T_160 + 500
            V_180 = V_180 + 1000
        ElseIf Stufe2 = 4 Then
            T_100 = T_100 + 700
            T_130 = T_130 + 700
            T_160 = T_160 + 700
            V_180 = V_180 + 1500
        ElseIf Stufe2 = 5 Then
            T_100 = T_100 + 900
            T_130 = T_130 + 900
            T_160 = T_160 + 900
            V_180 = V_180 + 2000
        ElseIf Stufe2 = 6 Then
            T_100 = T_100 + 1200
            T_130 = T_130 + 1200
            T_160 = T_160 + 1200
            V_180 = V_180 + 2500
        Else
            T_100 = T_100 + 1200
            T_130 = T_130 + 1200
            T_160 = T_160 + 1200
            V_180 = V_180 + 2500
        End If

        Stufe2 = Stufe1

        Stufe11 = Stufe1 + 1
        If Stufe11 > Stufe3 Then
            Stufe11 = Stufe3
        End If
        Stufe12 = Stufe1 + 2
        If Stufe12 > Stufe3 Then
            Stufe12 = Stufe3
        End If
        Stufe13 = Stufe1 + 3
        If Stufe13 > Stufe3 Then
            Stufe13 = Stufe3
        End If
        Stufe14 = Stufe1 + 4
        If Stufe14 > Stufe3 Then
            Stufe14 = Stufe3
        End If

        Stufe21 = Stufe2 + 1
        If Stufe21 > Stufe3 Then
            Stufe21 = Stufe3
        End If
        Stufe22 = Stufe2 + 2
        If Stufe22 > Stufe3 Then
            Stufe22 = Stufe3
        End If
        Stufe23 = Stufe2 + 3
        If Stufe23 > Stufe3 Then
            Stufe23 = Stufe3
        End If
        Stufe24 = Stufe2 + 4
        If Stufe24 > Stufe3 Then
            Stufe24 = Stufe3
        End If
        If G_200 > 0 Then
            If G_200 < Stufe4 Then
                G_200 = Stufe4
            End If
        Else
            G_200 = Stufe4
        End If

        If Betriebsart = 1 And (_GlsL68 = 3 Or _GlsL68 = 4) Then
            SetProgramCounterLabel1(_Prog68)
        Else
            SetProgramCounterLabel(_Prog68)
        End If

        ' Lok starten - Bahnhofsausfahrt

        If _Prog68 = 0 Then
            Prog_Lok68.Interval = 2000
            If _Fahrzeugbeleuchtung2 > 0 Then
                If _Fahrzeugbeleuchtung2 > 0 Then
                    _eb.lokSteuern(68, Klassen.LokEigenschaften.Hauptfunktion, 1) ' Licht ein
                End If
            End If
        ElseIf _Prog68 = 1 Then
            _eb.lokSteuern(68, Klassen.LokEigenschaften.Funktion2, 0) ' Fahrwerkbeleuchtung aus
        ElseIf _Prog68 = 2 Then
            If _Motor > 0 Then
                _eb.lokSteuern(68, Klassen.LokEigenschaften.Funktion4, 1) ' Dampfgeräusch ein
            End If
        ElseIf _Prog68 = 3 Then
            If _Dampf > 0 Then
                _eb.lokSteuern(68, Klassen.LokEigenschaften.Funktion1, 1) ' Dampf ein
            End If
        ElseIf _Prog68 = 4 Then
            _Betriebsparameter.RundenErhoehen(68)
        ElseIf _Prog68 = 5 Then
        ElseIf _Prog68 = 6 Then

            ' Bahnhofsausfahrt

        ElseIf _Prog68 = 7 Then
            If _AkustischeSignale > 0 Then
                _eb.lokSteuern(68, Klassen.LokEigenschaften.Funktion3, 1) ' Pfiff ein
            End If
        ElseIf _Prog68 = 8 Then
            _eb.lokSteuern(68, Klassen.LokEigenschaften.Funktion3, 0) ' Pfiff aus
        ElseIf _Prog68 = 9 Then
            _eb.lokSteuern(68, Klassen.LokEigenschaften.Geschwindigkeit, Stufe1)
        ElseIf _Prog68 = 10 Then
            _eb.lokSteuern(68, Klassen.LokEigenschaften.Geschwindigkeit, Stufe11)
        ElseIf _Prog68 = 11 Then
            _eb.lokSteuern(68, Klassen.LokEigenschaften.Geschwindigkeit, Stufe12)
        ElseIf _Prog68 = 12 Then
            _eb.lokSteuern(68, Klassen.LokEigenschaften.Geschwindigkeit, Stufe13)
        ElseIf _Prog68 = 13 Then
            _eb.lokSteuern(68, Klassen.LokEigenschaften.Geschwindigkeit, Stufe14)
        ElseIf _Prog68 = 14 Then
            _eb.lokSteuern(68, Klassen.LokEigenschaften.Geschwindigkeit, Stufe3)
        ElseIf _Prog68 = 15 Then
            If _Dampf < 3 Then
                _eb.lokSteuern(68, Klassen.LokEigenschaften.Funktion1, 0) ' Dampf aus
            End If
        ElseIf _Prog68 = 16 Then
        ElseIf _Prog68 = 17 Then
        ElseIf _Prog68 = 18 Then
            If _Motor < 3 Then
                _eb.lokSteuern(68, Klassen.LokEigenschaften.Funktion4, 0) ' Dampfgeräusch aus
            End If

            ' Lok abstellen

        ElseIf _Prog68 = 50 Then
            Prog_Lok68.Interval = 2000
            _eb.lokSteuern(68, Klassen.LokEigenschaften.Funktion1, 0) ' Dampf aus
        ElseIf _Prog68 = 51 Then
            If _Motor < 3 Then
                _eb.lokSteuern(68, Klassen.LokEigenschaften.Funktion4, 0) ' Dampfgeräusch aus
            End If
        ElseIf _Prog68 = 52 Then
            If _Fahrzeugbeleuchtung2 < 2 Then
                _eb.lokSteuern(68, Klassen.LokEigenschaften.Hauptfunktion, 0) ' Licht aus
            End If
        ElseIf _Prog68 = 53 Then
            If _Fahrzeugbeleuchtung2 > 0 Then
                _eb.lokSteuern(68, Klassen.LokEigenschaften.Funktion2, 1) ' Fahrwerkbeleuchtung ein
            End If
        ElseIf _Prog68 = 54 Then
        ElseIf _Prog68 = 55 Then


            ' Lok bremsen (Bahnhofseinfahrt Normalzug von links und von rechts)

        ElseIf _Prog68 = 100 Then
            Prog_Lok68.Interval = V_100
        ElseIf _Prog68 = 101 Then
            _eb.lokSteuern(68, Klassen.LokEigenschaften.Geschwindigkeit, Stufe24)
            Prog_Lok68.Interval = T_100
        ElseIf _Prog68 = 102 Then
            _eb.lokSteuern(68, Klassen.LokEigenschaften.Geschwindigkeit, Stufe23)
        ElseIf _Prog68 = 103 Then
            _eb.lokSteuern(68, Klassen.LokEigenschaften.Geschwindigkeit, Stufe22)
        ElseIf _Prog68 = 104 Then
            _eb.lokSteuern(68, Klassen.LokEigenschaften.Geschwindigkeit, Stufe21)
        ElseIf _Prog68 = 105 Then
            _eb.lokSteuern(68, Klassen.LokEigenschaften.Geschwindigkeit, Stufe2)


            ' Lok bremsen (Bahnhofseinfahrt Kurzzug von links)

        ElseIf _Prog68 = 130 Then
            Prog_Lok68.Interval = V_130
        ElseIf _Prog68 = 131 Then
            _eb.lokSteuern(68, Klassen.LokEigenschaften.Geschwindigkeit, Stufe24)
            Prog_Lok68.Interval = T_130
        ElseIf _Prog68 = 132 Then
            _eb.lokSteuern(68, Klassen.LokEigenschaften.Geschwindigkeit, Stufe23)
        ElseIf _Prog68 = 133 Then
            _eb.lokSteuern(68, Klassen.LokEigenschaften.Geschwindigkeit, Stufe22)
        ElseIf _Prog68 = 134 Then
            _eb.lokSteuern(68, Klassen.LokEigenschaften.Geschwindigkeit, Stufe21)
        ElseIf _Prog68 = 135 Then
            _eb.lokSteuern(68, Klassen.LokEigenschaften.Geschwindigkeit, Stufe2)
        ElseIf _Prog68 = 136 Then
            _eb.lokSteuern(68, Klassen.LokEigenschaften.Geschwindigkeit, 0)
        ElseIf _Prog68 = 137 Then
            Prog_Lok68.Interval = 2000
        ElseIf _Prog68 = 138 Then
            If _Dampf < 3 Then
                _eb.lokSteuern(68, Klassen.LokEigenschaften.Funktion1, 0) ' Dampf aus
            End If
        ElseIf _Prog68 = 139 Then
            If _Motor < 3 Then
                _eb.lokSteuern(68, Klassen.LokEigenschaften.Funktion4, 0) ' Dampfgeräusch aus
            End If
        ElseIf _Prog68 = 140 Then
            If _Fahrzeugbeleuchtung2 < 2 Then
                _eb.lokSteuern(68, Klassen.LokEigenschaften.Hauptfunktion, 0) ' Licht aus
            End If
        ElseIf _Prog68 = 141 Then
            If _Fahrzeugbeleuchtung2 > 0 Then
                _eb.lokSteuern(68, Klassen.LokEigenschaften.Funktion2, 1) ' Fahrwerkbeleuchtung ein
            End If
        ElseIf _Prog68 = 142 Then


            ' Lok bremsen (Bahnhofseinfahrt Kurzzug von rechts)

        ElseIf _Prog68 = 160 Then
            Prog_Lok68.Interval = V_160
        ElseIf _Prog68 = 161 Then
            _eb.lokSteuern(68, Klassen.LokEigenschaften.Geschwindigkeit, Stufe24)
            Prog_Lok68.Interval = T_160
        ElseIf _Prog68 = 162 Then
            _eb.lokSteuern(68, Klassen.LokEigenschaften.Geschwindigkeit, Stufe23)
        ElseIf _Prog68 = 163 Then
            _eb.lokSteuern(68, Klassen.LokEigenschaften.Geschwindigkeit, Stufe22)
        ElseIf _Prog68 = 164 Then
            _eb.lokSteuern(68, Klassen.LokEigenschaften.Geschwindigkeit, Stufe21)
        ElseIf _Prog68 = 165 Then
            _eb.lokSteuern(68, Klassen.LokEigenschaften.Geschwindigkeit, Stufe2)
        ElseIf _Prog68 = 166 Then
            _eb.lokSteuern(68, Klassen.LokEigenschaften.Geschwindigkeit, 0)
        ElseIf _Prog68 = 167 Then
            Prog_Lok68.Interval = 2000
        ElseIf _Prog68 = 168 Then
            If _Dampf < 3 Then
                _eb.lokSteuern(68, Klassen.LokEigenschaften.Funktion1, 0) ' Dampf aus
            End If
        ElseIf _Prog68 = 169 Then
            If _Motor < 3 Then
                _eb.lokSteuern(68, Klassen.LokEigenschaften.Funktion4, 0) ' Dampfgeräusch aus
            End If
        ElseIf _Prog68 = 170 Then
            If _Fahrzeugbeleuchtung2 < 2 Then
                _eb.lokSteuern(68, Klassen.LokEigenschaften.Hauptfunktion, 0) ' Licht aus
            End If
        ElseIf _Prog68 = 171 Then
            If _Fahrzeugbeleuchtung2 > 0 Then
                _eb.lokSteuern(68, Klassen.LokEigenschaften.Funktion2, 1) ' Fahrwerkbeleuchtung ein
            End If
        ElseIf _Prog68 = 172 Then

            ' Rangierzug

        ElseIf _Prog68 = 180 Then
            _eb.lokSteuern(68, Klassen.LokEigenschaften.Geschwindigkeit, 2)
            Prog_Lok68.Interval = V_180
        ElseIf _Prog68 = 181 Then
            Prog_Lok68.Interval = T_180
            _eb.lokSteuern(68, Klassen.LokEigenschaften.Geschwindigkeit, 1)
        ElseIf _Prog68 = 182 Then
            _eb.lokSteuern(68, Klassen.LokEigenschaften.Geschwindigkeit, 0)

            ' Tunnelausfahrt

        ElseIf _Prog68 = 200 Then ' Kontakt 1.2 <- (bergauf)
            _eb.lokSteuern(68, Klassen.LokEigenschaften.Geschwindigkeit, G_200)
            Prog_Lok68.Interval = 2000
        ElseIf _Prog68 = 201 Then
        ElseIf _Prog68 = 202 Then
        ElseIf _Prog68 = 203 Then
        ElseIf _Prog68 = 204 Then
        ElseIf _Prog68 = 205 Then
            If Stufe4 < Stufe3 Then
                _eb.lokSteuern(68, Klassen.LokEigenschaften.Geschwindigkeit, Stufe3)
            Else
                _eb.lokSteuern(68, Klassen.LokEigenschaften.Geschwindigkeit, Stufe4)
            End If
        ElseIf _Prog68 = 206 Then
        ElseIf _Prog68 = 207 Then
            If _Motor > 1 Then
                _eb.lokSteuern(68, Klassen.LokEigenschaften.Funktion4, 1) ' Dampfgeräusch ein
            End If
        ElseIf _Prog68 = 208 Then
            If _Dampf > 1 Then
                _eb.lokSteuern(68, Klassen.LokEigenschaften.Funktion1, 1) ' Dampf ein
            End If
        ElseIf _Prog68 = 209 Then
            If _AkustischeSignale > 1 Then
                _eb.lokSteuern(68, Klassen.LokEigenschaften.Funktion3, 1) ' Pfiff ein
            End If
        ElseIf _Prog68 = 210 Then
            _eb.lokSteuern(68, Klassen.LokEigenschaften.Funktion3, 0) ' Pfiff aus

        ElseIf _Prog68 = 220 Then ' Kontakt 3.1 -> (hinter dem Martinstor bergauf)
            Prog_Lok68.Interval = 2000
        ElseIf _Prog68 = 221 Then
        ElseIf _Prog68 = 222 Then
        ElseIf _Prog68 = 223 Then
        ElseIf _Prog68 = 224 Then
        ElseIf _Prog68 = 225 Then
            If _Dampf < 3 Then
                _eb.lokSteuern(68, Klassen.LokEigenschaften.Funktion1, 0) ' Dampf aus
            End If
        ElseIf _Prog68 = 226 Then
        ElseIf _Prog68 = 227 Then
        ElseIf _Prog68 = 228 Then
        ElseIf _Prog68 = 229 Then
            If _Motor < 3 Then
                _eb.lokSteuern(68, Klassen.LokEigenschaften.Funktion4, 0) ' Dampfgeräusch aus
            End If

        ElseIf _Prog68 = 240 Then ' Kontakt 3.7 <- (hinter der Brücke bergauf)
            Prog_Lok68.Interval = 2000
        ElseIf _Prog68 = 241 Then
        ElseIf _Prog68 = 242 Then
        ElseIf _Prog68 = 243 Then
            If _Dampf > 1 Then
                _eb.lokSteuern(68, Klassen.LokEigenschaften.Funktion1, 1) ' Dampf ein
            End If
        ElseIf _Prog68 = 244 Then
            If _AkustischeSignale > 1 Then
                _eb.lokSteuern(68, Klassen.LokEigenschaften.Funktion3, 1) ' Pfiff ein
            End If
        ElseIf _Prog68 = 245 Then
            _eb.lokSteuern(68, Klassen.LokEigenschaften.Funktion3, 0) ' Pfiff aus
        ElseIf _Prog68 = 246 Then
        ElseIf _Prog68 = 247 Then
        ElseIf _Prog68 = 248 Then
            If _Dampf < 3 Then
                _eb.lokSteuern(68, Klassen.LokEigenschaften.Funktion1, 0) ' Dampf aus
            End If

        ElseIf _Prog68 = 260 Then ' Kontakt 3.3 (links bzw vor der Brücke)
            Prog_Lok68.Interval = 2000
        ElseIf _Prog68 = 261 Then
        ElseIf _Prog68 = 262 Then
            _eb.lokSteuern(68, Klassen.LokEigenschaften.Geschwindigkeit, Stufe3)

        ElseIf _Prog68 = 600 Then ' Kontakt 3.5 <- (unter der Burg)
            Prog_Lok68.Interval = 2000
            If _AkustischeSignale > 1 Then
                _eb.lokSteuern(68, Klassen.LokEigenschaften.Funktion3, 1) ' Pfiff ein
            End If
        ElseIf _Prog68 = 601 Then
            _eb.lokSteuern(68, Klassen.LokEigenschaften.Funktion3, 0) ' Pfiff aus
        ElseIf _Prog68 = 602 Then
        ElseIf _Prog68 = 603 Then
        ElseIf _Prog68 = 604 Then

        ElseIf _Prog68 = 620 Then ' Kontakt 3.7 -> (hinter der Brücke bergab)
            Prog_Lok68.Interval = 2000
        ElseIf _Prog68 = 621 Then
        ElseIf _Prog68 = 622 Then
            If _Motor > 1 Then
                _eb.lokSteuern(68, Klassen.LokEigenschaften.Funktion4, 1) ' Dampfgeräusch ein
            End If
        ElseIf _Prog68 = 623 Then
        ElseIf _Prog68 = 624 Then
            If _AkustischeSignale > 1 Then
                _eb.lokSteuern(68, Klassen.LokEigenschaften.Funktion3, 1) ' Hupe ein
            End If
        ElseIf _Prog68 = 625 Then
            _eb.lokSteuern(68, Klassen.LokEigenschaften.Funktion3, 0) ' Hupe aus

        ElseIf _Prog68 = 640 Then ' Kontakt 3.1 <- Talfahrt
            Prog_Lok68.Interval = 2000
        ElseIf _Prog68 = 641 Then
        ElseIf _Prog68 = 642 Then
        ElseIf _Prog68 = 643 Then
        ElseIf _Prog68 = 644 Then
        ElseIf _Prog68 = 645 Then
        ElseIf _Prog68 = 646 Then
        ElseIf _Prog68 = 647 Then
        ElseIf _Prog68 = 648 Then
            If _Motor < 3 Then
                _eb.lokSteuern(68, Klassen.LokEigenschaften.Funktion4, 0) ' Dampfgeräusch aus
            End If

        ElseIf _Prog68 = 660 Then ' Kontakt 1.2 -> Talfahrt
            Prog_Lok68.Interval = 2000
        ElseIf _Prog68 = 661 Then
        ElseIf _Prog68 = 662 Then
            If _GlsL68 = 1 Or _GlsL68 = 2 Then
                If _Motor > 0 Then
                    _eb.lokSteuern(68, Klassen.LokEigenschaften.Funktion3, 1) ' Dampfgeräusch ein
                End If
            End If
        ElseIf _Prog68 = 663 Then
            If _GlsL68 = 1 Or _GlsL68 = 2 Then
                If _AkustischeSignale > 0 Then
                    _eb.lokSteuern(68, Klassen.LokEigenschaften.Funktion3, 1) ' Pfiff ein
                End If
            End If
        ElseIf _Prog68 = 664 Then
            _eb.lokSteuern(68, Klassen.LokEigenschaften.Funktion3, 0) ' Pfiff aus

        ElseIf _Prog68 = 700 Then ' Kontakt 0.4 <- Diagonale
            Prog_Lok68.Interval = 3000
        ElseIf _Prog68 = 701 Then
        ElseIf _Prog68 = 702 Then
            If _Motor > 0 Then
                _eb.lokSteuern(68, Klassen.LokEigenschaften.Funktion4, 1) ' Dampfgeräusch ein
            End If
        ElseIf _Prog68 = 703 Then
            If _Dampf > 0 Then
                _eb.lokSteuern(68, Klassen.LokEigenschaften.Funktion1, 1) ' Dampf ein
            End If
        ElseIf _Prog68 = 704 Then
            Prog_Lok68.Interval = 1000
        ElseIf _Prog68 = 705 Then
            If _AkustischeSignale > 0 Then
                _eb.lokSteuern(68, Klassen.LokEigenschaften.Funktion3, 1) ' Pfiff ein
            End If
        ElseIf _Prog68 = 706 Then
            _eb.lokSteuern(68, Klassen.LokEigenschaften.Funktion3, 0) ' Pfiff aus


            ' Zindelstein

        ElseIf _Prog68 = 500 Then
            Prog_Lok68.Interval = V_500
        ElseIf _Prog68 = 501 Then
            _eb.lokSteuern(68, Klassen.LokEigenschaften.Geschwindigkeit, Stufe23)
            Prog_Lok68.Interval = T_500
        ElseIf _Prog68 = 502 Then
            _eb.lokSteuern(68, Klassen.LokEigenschaften.Geschwindigkeit, Stufe22)
        ElseIf _Prog68 = 503 Then
            _eb.lokSteuern(68, Klassen.LokEigenschaften.Geschwindigkeit, Stufe21)
        ElseIf _Prog68 = 504 Then
            _eb.lokSteuern(68, Klassen.LokEigenschaften.Geschwindigkeit, Stufe2)
        ElseIf _Prog68 = 505 Then
            _eb.lokSteuern(68, Klassen.LokEigenschaften.Geschwindigkeit, 0)

        Else
            _Prog68 = 0
            Prog_Lok68.Stop()
            Prog_Lok68.Interval = 200
            If Betriebsart = 1 Then
                SetProgramCounterLabel1(String.Empty)
            Else
                SetProgramCounterLabel(String.Empty)
            End If
        End If
        _Prog68 = _Prog68 + 1
    End Sub
    Private Sub HandleTimerElapsed81(sender As System.Object, e As System.EventArgs) Handles Prog_Lok69.Elapsed

        '*** Fahrprogramm Dampflok 55 5555
        '*** Datum: 23.02.2020

        SetText(TextBox1, "Dampflok 55 5555                                                        IBS: 06.01.2022 - V3: 6")
        LoadImage(PictureBox1, "H:\\EB_Media\\LokFotos\\Baureihe_55_01.jpg")
        GeschwindikeitenSetzen(69)

        Dim Stufe1, Stufe2, Stufe3, Stufe4 As Integer
        Dim Stufe11, Stufe12, Stufe13, Stufe14, Stufe21, Stufe22, Stufe23, Stufe24 As Integer
        Dim V_100, V_130, V_160, V_180, V_500 As Integer
        Dim T_100, T_130, T_160, T_180, T_500 As Integer
        Dim G_200 As Integer

        T_100 = _Betriebsparameter.Fahrparameter(69, KlausEBspecific.Betriebsparameter.FahrparameterEnum.T_100)
        T_130 = _Betriebsparameter.Fahrparameter(69, KlausEBspecific.Betriebsparameter.FahrparameterEnum.T_130)
        T_160 = _Betriebsparameter.Fahrparameter(69, KlausEBspecific.Betriebsparameter.FahrparameterEnum.T_160)
        T_180 = _Betriebsparameter.Fahrparameter(69, KlausEBspecific.Betriebsparameter.FahrparameterEnum.T_180)
        T_500 = _Betriebsparameter.Fahrparameter(69, KlausEBspecific.Betriebsparameter.FahrparameterEnum.T_500)
        V_100 = _Betriebsparameter.Fahrparameter(69, KlausEBspecific.Betriebsparameter.FahrparameterEnum.V_100)
        V_130 = _Betriebsparameter.Fahrparameter(69, KlausEBspecific.Betriebsparameter.FahrparameterEnum.V_130)
        V_160 = _Betriebsparameter.Fahrparameter(69, KlausEBspecific.Betriebsparameter.FahrparameterEnum.V_160)
        V_180 = _Betriebsparameter.Fahrparameter(69, KlausEBspecific.Betriebsparameter.FahrparameterEnum.V_180)
        V_500 = _Betriebsparameter.Fahrparameter(69, KlausEBspecific.Betriebsparameter.FahrparameterEnum.V_500)
        G_200 = _Betriebsparameter.Fahrparameter(69, KlausEBspecific.Betriebsparameter.FahrparameterEnum.G_200)

        If A_StopB = 1 Then
            V_100 = 8000
        End If

        Stufe1 = _LokStufen.Holen(69, 1)
        Stufe2 = _LokStufen.Holen(69, 2)
        Stufe3 = _LokStufen.Holen(69, 3)
        Stufe4 = _LokStufen.Holen(69, 4)

        If Stufe2 = 1 Then
            T_100 = T_100
            T_130 = T_130
            T_160 = T_160
            V_180 = V_180
        ElseIf Stufe2 = 2 Then
            T_100 = T_100 + 300
            T_130 = T_130 + 300
            T_160 = T_160 + 300
            V_180 = V_180 + 500
        ElseIf Stufe2 = 3 Then
            T_100 = T_100 + 500
            T_130 = T_130 + 500
            T_160 = T_160 + 500
            V_180 = V_180 + 1000
        ElseIf Stufe2 = 4 Then
            T_100 = T_100 + 700
            T_130 = T_130 + 700
            T_160 = T_160 + 700
            V_180 = V_180 + 1500
        ElseIf Stufe2 = 5 Then
            T_100 = T_100 + 900
            T_130 = T_130 + 900
            T_160 = T_160 + 900
            V_180 = V_180 + 2000
        ElseIf Stufe2 = 6 Then
            T_100 = T_100 + 1200
            T_130 = T_130 + 1200
            T_160 = T_160 + 1200
            V_180 = V_180 + 2500
        Else
            T_100 = T_100 + 1200
            T_130 = T_130 + 1200
            T_160 = T_160 + 1200
            V_180 = V_180 + 2500
        End If

        Stufe2 = Stufe1

        Stufe11 = Stufe1 + 1
        If Stufe11 > Stufe3 Then
            Stufe11 = Stufe3
        End If
        Stufe12 = Stufe1 + 2
        If Stufe12 > Stufe3 Then
            Stufe12 = Stufe3
        End If
        Stufe13 = Stufe1 + 3
        If Stufe13 > Stufe3 Then
            Stufe13 = Stufe3
        End If
        Stufe14 = Stufe1 + 4
        If Stufe14 > Stufe3 Then
            Stufe14 = Stufe3
        End If

        Stufe21 = Stufe2 + 1
        If Stufe21 > Stufe3 Then
            Stufe21 = Stufe3
        End If
        Stufe22 = Stufe2 + 2
        If Stufe22 > Stufe3 Then
            Stufe22 = Stufe3
        End If
        Stufe23 = Stufe2 + 3
        If Stufe23 > Stufe3 Then
            Stufe23 = Stufe3
        End If
        Stufe24 = Stufe2 + 4
        If Stufe24 > Stufe3 Then
            Stufe24 = Stufe3
        End If
        If G_200 > 0 Then
            If G_200 < Stufe4 Then
                G_200 = Stufe4
            End If
        Else
            G_200 = Stufe4
        End If

        If Betriebsart = 1 And (_GlsL69 = 3 Or _GlsL69 = 4) Then
            SetProgramCounterLabel1(_Prog69)
        Else
            SetProgramCounterLabel(_Prog69)
        End If

        ' Lok starten - Bahnhofsausfahrt

        If _Prog69 = 0 Then
            Prog_Lok69.Interval = 2000
            If _Fahrzeugbeleuchtung2 > 0 Then
                _eb.lokSteuern(69, Klassen.LokEigenschaften.Hauptfunktion, 1) ' Licht ein
            End If
        ElseIf _Prog69 = 1 Then
            If _Dampf > 0 Then
                _eb.lokSteuern(69, Klassen.LokEigenschaften.Funktion1, 1) ' Dampf ein
            End If
        ElseIf _Prog69 = 2 Then
            _Betriebsparameter.RundenErhoehen(69)
        ElseIf _Prog69 = 3 Then
        ElseIf _Prog69 = 4 Then
        ElseIf _Prog69 = 5 Then
        ElseIf _Prog69 = 6 Then
        ElseIf _Prog69 = 7 Then

            ' Bahnhofsausfahrt

        ElseIf _Prog69 = 8 Then
            _eb.lokSteuern(69, Klassen.LokEigenschaften.Geschwindigkeit, Stufe1)
        ElseIf _Prog69 = 9 Then
            _eb.lokSteuern(69, Klassen.LokEigenschaften.Geschwindigkeit, Stufe11)
        ElseIf _Prog69 = 10 Then
            _eb.lokSteuern(69, Klassen.LokEigenschaften.Geschwindigkeit, Stufe12)
        ElseIf _Prog69 = 11 Then
            _eb.lokSteuern(69, Klassen.LokEigenschaften.Geschwindigkeit, Stufe13)
        ElseIf _Prog69 = 12 Then
            _eb.lokSteuern(69, Klassen.LokEigenschaften.Geschwindigkeit, Stufe14)
        ElseIf _Prog69 = 13 Then
            _eb.lokSteuern(69, Klassen.LokEigenschaften.Geschwindigkeit, Stufe3)
        ElseIf _Prog69 = 14 Then
            If _Dampf = 1 Then
                _eb.lokSteuern(69, Klassen.LokEigenschaften.Funktion1, 0) ' Dampf aus
            End If

            ' Lok abstellen

        ElseIf _Prog69 = 50 Then
            Prog_Lok69.Interval = 2000
            If _Dampf < 2 Then
                _eb.lokSteuern(69, Klassen.LokEigenschaften.Funktion1, 0) ' Dampf aus
            End If
        ElseIf _Prog69 = 51 Then
        ElseIf _Prog69 = 52 Then
            If _Fahrzeugbeleuchtung2 < 2 Then
                _eb.lokSteuern(69, Klassen.LokEigenschaften.Hauptfunktion, 0) ' Licht aus
            End If

            ' Lok bremsen (Bahnhofseinfahrt Normalzug von links und von rechts)

        ElseIf _Prog69 = 100 Then
            Prog_Lok69.Interval = V_100
        ElseIf _Prog69 = 101 Then
            _eb.lokSteuern(69, Klassen.LokEigenschaften.Geschwindigkeit, Stufe24)
            Prog_Lok69.Interval = T_100
        ElseIf _Prog69 = 102 Then
            _eb.lokSteuern(69, Klassen.LokEigenschaften.Geschwindigkeit, Stufe23)
        ElseIf _Prog69 = 103 Then
            _eb.lokSteuern(69, Klassen.LokEigenschaften.Geschwindigkeit, Stufe22)
        ElseIf _Prog69 = 104 Then
            _eb.lokSteuern(69, Klassen.LokEigenschaften.Geschwindigkeit, Stufe21)
        ElseIf _Prog69 = 105 Then
            _eb.lokSteuern(69, Klassen.LokEigenschaften.Geschwindigkeit, Stufe2)

            ' Lok bremsen (Bahnhofseinfahrt Kurzzug von links)

        ElseIf _Prog69 = 130 Then
            Prog_Lok69.Interval = V_130
        ElseIf _Prog69 = 131 Then
            _eb.lokSteuern(69, Klassen.LokEigenschaften.Geschwindigkeit, Stufe24)
            Prog_Lok69.Interval = T_130
        ElseIf _Prog69 = 132 Then
            _eb.lokSteuern(69, Klassen.LokEigenschaften.Geschwindigkeit, Stufe23)
        ElseIf _Prog69 = 133 Then
            _eb.lokSteuern(69, Klassen.LokEigenschaften.Geschwindigkeit, Stufe22)
        ElseIf _Prog69 = 134 Then
            _eb.lokSteuern(69, Klassen.LokEigenschaften.Geschwindigkeit, Stufe21)
        ElseIf _Prog69 = 135 Then
            _eb.lokSteuern(69, Klassen.LokEigenschaften.Geschwindigkeit, Stufe2)
        ElseIf _Prog69 = 136 Then
            _eb.lokSteuern(69, Klassen.LokEigenschaften.Geschwindigkeit, 0)
        ElseIf _Prog69 = 137 Then
            Prog_Lok69.Interval = 2000
        ElseIf _Prog69 = 138 Then
            If _Fahrzeugbeleuchtung2 < 2 Then
                _eb.lokSteuern(69, Klassen.LokEigenschaften.Hauptfunktion, 0) ' Licht aus
            End If

            ' Lok bremsen (Bahnhofseinfahrt Kurzzug von rechts)

        ElseIf _Prog69 = 160 Then
            Prog_Lok69.Interval = V_160
        ElseIf _Prog69 = 161 Then
            _eb.lokSteuern(69, Klassen.LokEigenschaften.Geschwindigkeit, Stufe24)
            Prog_Lok69.Interval = T_160
        ElseIf _Prog69 = 162 Then
            _eb.lokSteuern(69, Klassen.LokEigenschaften.Geschwindigkeit, Stufe23)
        ElseIf _Prog69 = 163 Then
            _eb.lokSteuern(69, Klassen.LokEigenschaften.Geschwindigkeit, Stufe22)
        ElseIf _Prog69 = 164 Then
            _eb.lokSteuern(69, Klassen.LokEigenschaften.Geschwindigkeit, Stufe21)
        ElseIf _Prog69 = 165 Then
            _eb.lokSteuern(69, Klassen.LokEigenschaften.Geschwindigkeit, Stufe2)
        ElseIf _Prog69 = 166 Then
            _eb.lokSteuern(69, Klassen.LokEigenschaften.Geschwindigkeit, 0)
        ElseIf _Prog69 = 167 Then
            Prog_Lok69.Interval = 2000
        ElseIf _Prog69 = 168 Then
            If _Fahrzeugbeleuchtung2 < 2 Then
                _eb.lokSteuern(69, Klassen.LokEigenschaften.Hauptfunktion, 0) ' Licht aus
            End If

            ' Rangierzug

        ElseIf _Prog69 = 180 Then
            _eb.lokSteuern(69, Klassen.LokEigenschaften.Geschwindigkeit, 2)
            Prog_Lok69.Interval = V_180
        ElseIf _Prog69 = 181 Then
            Prog_Lok69.Interval = T_180
            _eb.lokSteuern(69, Klassen.LokEigenschaften.Geschwindigkeit, 1)
        ElseIf _Prog69 = 182 Then
            _eb.lokSteuern(69, Klassen.LokEigenschaften.Geschwindigkeit, 0)

            ' Tunnelausfahrt

        ElseIf _Prog69 = 200 Then ' Kontakt 1.2 <- (bergauf)
            _eb.lokSteuern(69, Klassen.LokEigenschaften.Geschwindigkeit, G_200)
            Prog_Lok69.Interval = 2000
        ElseIf _Prog69 = 201 Then
        ElseIf _Prog69 = 202 Then
        ElseIf _Prog69 = 203 Then
        ElseIf _Prog69 = 204 Then
        ElseIf _Prog69 = 205 Then
            If Stufe4 < Stufe3 Then
                _eb.lokSteuern(69, Klassen.LokEigenschaften.Geschwindigkeit, Stufe3)
            Else
                _eb.lokSteuern(69, Klassen.LokEigenschaften.Geschwindigkeit, Stufe4)
            End If

        ElseIf _Prog69 = 220 Then ' Kontakt 3.1 -> (hinter dem Martinstor bergauf)
            Prog_Lok69.Interval = 2000
        ElseIf _Prog69 = 221 Then
        ElseIf _Prog69 = 222 Then

        ElseIf _Prog69 = 240 Then ' Kontakt 3.7 <- (hinter der Brücke bergauf)
            Prog_Lok69.Interval = 2000
        ElseIf _Prog69 = 241 Then
        ElseIf _Prog69 = 242 Then

        ElseIf _Prog69 = 260 Then ' Kontakt 3.3 (links bzw vor der Brücke)
            Prog_Lok69.Interval = 2000
        ElseIf _Prog69 = 261 Then
        ElseIf _Prog69 = 262 Then
            _eb.lokSteuern(69, Klassen.LokEigenschaften.Geschwindigkeit, Stufe3)

        ElseIf _Prog69 = 600 Then ' Kontakt 3.5 <- (unter der Burg)
            Prog_Lok69.Interval = 2000
        ElseIf _Prog69 = 601 Then
        ElseIf _Prog69 = 602 Then

        ElseIf _Prog69 = 620 Then ' Kontakt 3.7 -> (hinter der Brücke bergab)
            Prog_Lok69.Interval = 2000
        ElseIf _Prog69 = 621 Then
        ElseIf _Prog69 = 622 Then

        ElseIf _Prog69 = 640 Then ' Kontakt 3.1 <- Talfahrt
            Prog_Lok69.Interval = 2000
        ElseIf _Prog69 = 641 Then
        ElseIf _Prog69 = 642 Then

        ElseIf _Prog69 = 660 Then ' Kontakt 1.2 -> Talfahrt
            Prog_Lok69.Interval = 2000
        ElseIf _Prog69 = 661 Then
        ElseIf _Prog69 = 662 Then

        ElseIf _Prog69 = 700 Then ' Kontakt 0.4 <- Diagonale
            Prog_Lok69.Interval = 2000
        ElseIf _Prog69 = 701 Then
        ElseIf _Prog69 = 702 Then

            ' Zindelstein

        ElseIf _Prog69 = 500 Then
            Prog_Lok69.Interval = V_500
        ElseIf _Prog69 = 501 Then
            _eb.lokSteuern(69, Klassen.LokEigenschaften.Geschwindigkeit, Stufe23)
            Prog_Lok69.Interval = T_500
        ElseIf _Prog69 = 502 Then
            _eb.lokSteuern(69, Klassen.LokEigenschaften.Geschwindigkeit, Stufe22)
        ElseIf _Prog69 = 503 Then
            _eb.lokSteuern(69, Klassen.LokEigenschaften.Geschwindigkeit, Stufe21)
        ElseIf _Prog69 = 504 Then
            _eb.lokSteuern(69, Klassen.LokEigenschaften.Geschwindigkeit, Stufe2)
        ElseIf _Prog69 = 505 Then
            _eb.lokSteuern(69, Klassen.LokEigenschaften.Geschwindigkeit, 0)

        Else
            _Prog69 = 0
            Prog_Lok69.Stop()
            Prog_Lok69.Interval = 200
            If Betriebsart = 1 Then
                SetProgramCounterLabel1(String.Empty)
            Else
                SetProgramCounterLabel(String.Empty)
            End If
        End If
        _Prog69 = _Prog69 + 1
    End Sub
    Private Sub HandleTimerElapsed82(sender As System.Object, e As System.EventArgs) Handles Prog_Lok70.Elapsed

        '*** Fahrprogramm für Dampflok 18 427
        '*** Datum: 11.01.2023

        SetText(TextBox1, "Dampflok 18 427                                                         IBS: 11.01.2023 - V3 : 6")
        LoadImage(PictureBox1, "H:\\EB_Media\\LokFotos\\Baureihe_18_02.jpg")
        GeschwindikeitenSetzen(70)

        Dim Stufe1, Stufe2, Stufe3, Stufe4 As Integer
        Dim Stufe11, Stufe12, Stufe13, Stufe14, Stufe21, Stufe22, Stufe23, Stufe24 As Integer
        Dim V_100, V_130, V_160, V_180, V_500 As Integer
        Dim T_100, T_130, T_160, T_180, T_500 As Integer
        Dim G_200 As Integer

        T_100 = _Betriebsparameter.Fahrparameter(70, KlausEBspecific.Betriebsparameter.FahrparameterEnum.T_100)
        T_130 = _Betriebsparameter.Fahrparameter(70, KlausEBspecific.Betriebsparameter.FahrparameterEnum.T_130)
        T_160 = _Betriebsparameter.Fahrparameter(70, KlausEBspecific.Betriebsparameter.FahrparameterEnum.T_160)
        T_180 = _Betriebsparameter.Fahrparameter(70, KlausEBspecific.Betriebsparameter.FahrparameterEnum.T_180)
        T_500 = _Betriebsparameter.Fahrparameter(70, KlausEBspecific.Betriebsparameter.FahrparameterEnum.T_500)
        V_100 = _Betriebsparameter.Fahrparameter(70, KlausEBspecific.Betriebsparameter.FahrparameterEnum.V_100)
        V_130 = _Betriebsparameter.Fahrparameter(70, KlausEBspecific.Betriebsparameter.FahrparameterEnum.V_130)
        V_160 = _Betriebsparameter.Fahrparameter(70, KlausEBspecific.Betriebsparameter.FahrparameterEnum.V_160)
        V_180 = _Betriebsparameter.Fahrparameter(70, KlausEBspecific.Betriebsparameter.FahrparameterEnum.V_180)
        V_500 = _Betriebsparameter.Fahrparameter(70, KlausEBspecific.Betriebsparameter.FahrparameterEnum.V_500)
        G_200 = _Betriebsparameter.Fahrparameter(70, KlausEBspecific.Betriebsparameter.FahrparameterEnum.G_200)

        If A_StopB = 1 Then
            V_100 = 8000
        End If

        Stufe1 = _LokStufen.Holen(70, 1)
        Stufe2 = _LokStufen.Holen(70, 2)
        Stufe3 = _LokStufen.Holen(70, 3)
        Stufe4 = _LokStufen.Holen(70, 4)

        If Stufe2 = 1 Then
            T_100 = T_100
            T_130 = T_130
            T_160 = T_160
            V_180 = V_180
        ElseIf Stufe2 = 2 Then
            T_100 = T_100 + 300
            T_130 = T_130 + 300
            T_160 = T_160 + 300
            V_180 = V_180 + 500
        ElseIf Stufe2 = 3 Then
            T_100 = T_100 + 500
            T_130 = T_130 + 500
            T_160 = T_160 + 500
            V_180 = V_180 + 1000
        ElseIf Stufe2 = 4 Then
            T_100 = T_100 + 700
            T_130 = T_130 + 700
            T_160 = T_160 + 700
            V_180 = V_180 + 1500
        ElseIf Stufe2 = 5 Then
            T_100 = T_100 + 900
            T_130 = T_130 + 900
            T_160 = T_160 + 900
            V_180 = V_180 + 2000
        ElseIf Stufe2 = 6 Then
            T_100 = T_100 + 1200
            T_130 = T_130 + 1200
            T_160 = T_160 + 1200
            V_180 = V_180 + 2500
        Else
            T_100 = T_100 + 1200
            T_130 = T_130 + 1200
            T_160 = T_160 + 1200
            V_180 = V_180 + 2500
        End If

        Stufe2 = Stufe1

        Stufe11 = Stufe1 + 1
        If Stufe11 > Stufe3 Then
            Stufe11 = Stufe3
        End If
        Stufe12 = Stufe1 + 2
        If Stufe12 > Stufe3 Then
            Stufe12 = Stufe3
        End If
        Stufe13 = Stufe1 + 3
        If Stufe13 > Stufe3 Then
            Stufe13 = Stufe3
        End If
        Stufe14 = Stufe1 + 4
        If Stufe14 > Stufe3 Then
            Stufe14 = Stufe3
        End If

        Stufe21 = Stufe2 + 1
        If Stufe21 > Stufe3 Then
            Stufe21 = Stufe3
        End If
        Stufe22 = Stufe2 + 2
        If Stufe22 > Stufe3 Then
            Stufe22 = Stufe3
        End If
        Stufe23 = Stufe2 + 3
        If Stufe23 > Stufe3 Then
            Stufe23 = Stufe3
        End If
        Stufe24 = Stufe2 + 4
        If Stufe24 > Stufe3 Then
            Stufe24 = Stufe3
        End If
        If G_200 > 0 Then
            If G_200 < Stufe4 Then
                G_200 = Stufe4
            End If
        Else
            G_200 = Stufe4
        End If

        If Betriebsart = 1 And (_GlsL70 = 3 Or _GlsL70 = 4) Then
            SetProgramCounterLabel1(_Prog70)
        Else
            SetProgramCounterLabel(_Prog70)
        End If

        ' Lok starten - Bahnhofsausfahrt

        If _Prog70 = 0 Then
            Prog_Lok70.Interval = 2000
        ElseIf _Prog70 = 1 Then
            If _Fahrzeugbeleuchtung2 > 0 Then
                _eb.lokSteuern(70, Klassen.LokEigenschaften.Hauptfunktion, 1) ' Licht ein
            End If
        ElseIf _Prog70 = 2 Then
            If _Dampf > 0 Then
                _eb.lokSteuern(70, Klassen.LokEigenschaften.Funktion1, 1) ' Dampf ein
            End If
        ElseIf _Prog70 = 3 Then
            _Betriebsparameter.RundenErhoehen(70)
        ElseIf _Prog70 = 4 Then
        ElseIf _Prog70 = 5 Then
        ElseIf _Prog70 = 6 Then
        ElseIf _Prog70 = 7 Then
        ElseIf _Prog70 = 8 Then

            ' Bahnhofsausfahrt

        ElseIf _Prog70 = 9 Then
            If _AkustischeSignale > 0 Then
                _eb.lokSteuern(70, Klassen.LokEigenschaften.Funktion3, 1) ' Pfiff ein
            End If
        ElseIf _Prog70 = 10 Then
            _eb.lokSteuern(70, Klassen.LokEigenschaften.Funktion3, 0) ' Pfiff aus
        ElseIf _Prog70 = 11 Then
            _eb.lokSteuern(70, Klassen.LokEigenschaften.Geschwindigkeit, Stufe1)
        ElseIf _Prog70 = 12 Then
            _eb.lokSteuern(70, Klassen.LokEigenschaften.Geschwindigkeit, Stufe11)
        ElseIf _Prog70 = 13 Then
            _eb.lokSteuern(70, Klassen.LokEigenschaften.Geschwindigkeit, Stufe12)
        ElseIf _Prog70 = 14 Then
            _eb.lokSteuern(70, Klassen.LokEigenschaften.Geschwindigkeit, Stufe13)
        ElseIf _Prog70 = 15 Then
            _eb.lokSteuern(70, Klassen.LokEigenschaften.Geschwindigkeit, Stufe14)
        ElseIf _Prog70 = 16 Then
            _eb.lokSteuern(70, Klassen.LokEigenschaften.Geschwindigkeit, Stufe3)
        ElseIf _Prog70 = 17 Then
            If _Dampf < 2 Then
                _eb.lokSteuern(70, Klassen.LokEigenschaften.Funktion1, 0) ' Dampf aus
            End If
        ElseIf _Prog70 = 18 Then

            ' Lok abstellen

        ElseIf _Prog70 = 50 Then
            Prog_Lok70.Interval = 2000
        ElseIf _Prog70 = 51 Then
            If _Dampf < 3 Then
                _eb.lokSteuern(70, Klassen.LokEigenschaften.Funktion1, 0) ' Dampf aus
            End If
        ElseIf _Prog70 = 52 Then
            If _Fahrzeugbeleuchtung2 = 2 Then
                _eb.lokSteuern(70, Klassen.LokEigenschaften.Hauptfunktion, 0) ' Licht aus
            End If

            ' Lok bremsen (Bahnhofseinfahrt Normalzug von links und von rechts)

        ElseIf _Prog70 = 100 Then
            Prog_Lok70.Interval = V_100
        ElseIf _Prog70 = 101 Then
            _eb.lokSteuern(70, Klassen.LokEigenschaften.Geschwindigkeit, Stufe24)
            Prog_Lok70.Interval = T_100
        ElseIf _Prog70 = 102 Then
            _eb.lokSteuern(70, Klassen.LokEigenschaften.Geschwindigkeit, Stufe23)
        ElseIf _Prog70 = 103 Then
            _eb.lokSteuern(70, Klassen.LokEigenschaften.Geschwindigkeit, Stufe22)
        ElseIf _Prog70 = 104 Then
            _eb.lokSteuern(70, Klassen.LokEigenschaften.Geschwindigkeit, Stufe21)
        ElseIf _Prog70 = 105 Then
            _eb.lokSteuern(70, Klassen.LokEigenschaften.Geschwindigkeit, Stufe2)

            ' Lok bremsen (Bahnhofseinfahrt Kurzzug von links)

        ElseIf _Prog70 = 130 Then
            Prog_Lok70.Interval = V_130
        ElseIf _Prog70 = 131 Then
            _eb.lokSteuern(70, Klassen.LokEigenschaften.Geschwindigkeit, Stufe24)
            Prog_Lok70.Interval = T_130
        ElseIf _Prog70 = 132 Then
            _eb.lokSteuern(70, Klassen.LokEigenschaften.Geschwindigkeit, Stufe23)
        ElseIf _Prog70 = 133 Then
            _eb.lokSteuern(70, Klassen.LokEigenschaften.Geschwindigkeit, Stufe22)
        ElseIf _Prog70 = 134 Then
            _eb.lokSteuern(70, Klassen.LokEigenschaften.Geschwindigkeit, Stufe21)
        ElseIf _Prog70 = 135 Then
            _eb.lokSteuern(70, Klassen.LokEigenschaften.Geschwindigkeit, Stufe2)
        ElseIf _Prog70 = 136 Then
            _eb.lokSteuern(70, Klassen.LokEigenschaften.Geschwindigkeit, 0)
        ElseIf _Prog70 = 137 Then
            Prog_Lok70.Interval = 2000
        ElseIf _Prog70 = 138 Then
            If _Dampf < 3 Then
                _eb.lokSteuern(70, Klassen.LokEigenschaften.Funktion1, 0) ' Dampf aus
            End If
        ElseIf _Prog70 = 139 Then
            If _Fahrzeugbeleuchtung2 < 2 Then
                _eb.lokSteuern(70, Klassen.LokEigenschaften.Hauptfunktion, 0) ' Licht aus
            End If

            ' Lok bremsen (Bahnhofseinfahrt Kurzzug von rechts)

        ElseIf _Prog70 = 160 Then
            Prog_Lok70.Interval = V_160
        ElseIf _Prog70 = 161 Then
            _eb.lokSteuern(70, Klassen.LokEigenschaften.Geschwindigkeit, Stufe24)
            Prog_Lok70.Interval = T_160
        ElseIf _Prog70 = 162 Then
            _eb.lokSteuern(68, Klassen.LokEigenschaften.Geschwindigkeit, Stufe23)
        ElseIf _Prog70 = 163 Then
            _eb.lokSteuern(68, Klassen.LokEigenschaften.Geschwindigkeit, Stufe22)
        ElseIf _Prog70 = 164 Then
            _eb.lokSteuern(68, Klassen.LokEigenschaften.Geschwindigkeit, Stufe21)
        ElseIf _Prog70 = 165 Then
            _eb.lokSteuern(70, Klassen.LokEigenschaften.Geschwindigkeit, Stufe2)
        ElseIf _Prog70 = 166 Then
            _eb.lokSteuern(70, Klassen.LokEigenschaften.Geschwindigkeit, 0)
        ElseIf _Prog70 = 167 Then
            Prog_Lok70.Interval = 2000
        ElseIf _Prog70 = 168 Then
            If _Dampf < 3 Then
                _eb.lokSteuern(70, Klassen.LokEigenschaften.Funktion1, 0) ' Dampf aus
            End If
        ElseIf _Prog70 = 169 Then
            If _Fahrzeugbeleuchtung2 < 2 Then
                _eb.lokSteuern(70, Klassen.LokEigenschaften.Hauptfunktion, 0) ' Licht aus
            End If

            ' Rangierzug

        ElseIf _Prog70 = 180 Then
            Prog_Lok70.Interval = V_180
            If _TypL70 < 5 Then
                _eb.lokSteuern(70, Klassen.LokEigenschaften.Geschwindigkeit, 0)
                _Prog70 = 181
            Else
                _eb.lokSteuern(70, Klassen.LokEigenschaften.Geschwindigkeit, 2)
            End If
        ElseIf _Prog70 = 181 Then
            Prog_Lok70.Interval = T_180
            _eb.lokSteuern(70, Klassen.LokEigenschaften.Geschwindigkeit, 1)
        ElseIf _Prog70 = 182 Then
            _eb.lokSteuern(70, Klassen.LokEigenschaften.Geschwindigkeit, 0)

            ' Tunnelausfahrt

        ElseIf _Prog70 = 200 Then ' Kontakt 1.2 <- (bergauf)
            _eb.lokSteuern(70, Klassen.LokEigenschaften.Geschwindigkeit, G_200)
            Prog_Lok70.Interval = 2000
        ElseIf _Prog70 = 201 Then
            If _Dampf > 1 Then
                _eb.lokSteuern(70, Klassen.LokEigenschaften.Funktion1, 1) ' Dampf ein
            End If
        ElseIf _Prog70 = 202 Then
        ElseIf _Prog70 = 203 Then
        ElseIf _Prog70 = 204 Then
        ElseIf _Prog70 = 205 Then
            If Stufe4 < Stufe3 Then
                _eb.lokSteuern(70, Klassen.LokEigenschaften.Geschwindigkeit, Stufe3)
            Else
                _eb.lokSteuern(70, Klassen.LokEigenschaften.Geschwindigkeit, Stufe4)
            End If
        ElseIf _Prog70 = 206 Then
        ElseIf _Prog70 = 207 Then
            If _AkustischeSignale > 1 Then
                _eb.lokSteuern(70, Klassen.LokEigenschaften.Funktion4, 1) ' Läuten ein
            End If
        ElseIf _Prog70 = 208 Then
        ElseIf _Prog70 = 209 Then
            _eb.lokSteuern(70, Klassen.LokEigenschaften.Funktion4, 0) ' Läuten aus
        ElseIf _Prog70 = 210 Then

        ElseIf _Prog70 = 220 Then ' Kontakt 3.1 -> (hinter dem Martinstor bergauf)
            Prog_Lok70.Interval = 2000
        ElseIf _Prog70 = 221 Then
        ElseIf _Prog70 = 222 Then
            If _Dampf < 3 Then
                _eb.lokSteuern(70, Klassen.LokEigenschaften.Funktion1, 0) ' Dampf aus
            End If
        ElseIf _Prog70 = 223 Then

        ElseIf _Prog70 = 240 Then ' Kontakt 3.7 <- (hinter der Brücke bergauf)
            Prog_Lok70.Interval = 2000
        ElseIf _Prog70 = 241 Then
            If _Dampf > 1 Then
                _eb.lokSteuern(70, Klassen.LokEigenschaften.Funktion1, 1) ' Dampf ein
            End If
        ElseIf _Prog70 = 242 Then
        ElseIf _Prog70 = 243 Then
        ElseIf _Prog70 = 244 Then
            If _AkustischeSignale > 1 Then
                _eb.lokSteuern(70, Klassen.LokEigenschaften.Funktion3, 1) ' Pfiff ein
            End If
        ElseIf _Prog70 = 245 Then
            _eb.lokSteuern(70, Klassen.LokEigenschaften.Funktion3, 0) ' Pfiff aus
        ElseIf _Prog70 = 246 Then
            If _Dampf < 3 Then
                _eb.lokSteuern(70, Klassen.LokEigenschaften.Funktion1, 0) ' Dampf aus
            End If

        ElseIf _Prog70 = 260 Then ' Kontakt 3.3 (links bzw vor der Brücke)
            Prog_Lok70.Interval = 2000
        ElseIf _Prog70 = 261 Then
        ElseIf _Prog70 = 262 Then
            _eb.lokSteuern(70, Klassen.LokEigenschaften.Geschwindigkeit, Stufe3)

        ElseIf _Prog70 = 600 Then ' Kontakt 3.5 <- (unter der Burg)
            Prog_Lok70.Interval = 2000
            If _AkustischeSignale > 1 Then
                _eb.lokSteuern(70, Klassen.LokEigenschaften.Funktion3, 1) ' Pfiff ein
            End If
        ElseIf _Prog70 = 601 Then
            _eb.lokSteuern(70, Klassen.LokEigenschaften.Funktion3, 0) ' Pfiff aus
        ElseIf _Prog70 = 602 Then
        ElseIf _Prog70 = 603 Then

        ElseIf _Prog70 = 620 Then ' Kontakt 3.7 -> (hinter der Brücke bergab)
            Prog_Lok70.Interval = 2000
        ElseIf _Prog70 = 621 Then
        ElseIf _Prog70 = 622 Then
        ElseIf _Prog70 = 623 Then
        ElseIf _Prog70 = 624 Then
            If _AkustischeSignale > 1 Then
                _eb.lokSteuern(70, Klassen.LokEigenschaften.Funktion4, 1) ' Läuten ein
            End If

        ElseIf _Prog70 = 640 Then ' Kontakt 3.1 <- Talfahrt
            Prog_Lok70.Interval = 2000
        ElseIf _Prog70 = 641 Then
        ElseIf _Prog70 = 642 Then
            _eb.lokSteuern(70, Klassen.LokEigenschaften.Funktion4, 0) ' Läuten aus

        ElseIf _Prog70 = 660 Then ' Kontakt 1.2 -> Talfahrt
            Prog_Lok70.Interval = 2000
        ElseIf _Prog70 = 661 Then
        ElseIf _Prog70 = 662 Then
        ElseIf _Prog70 = 663 Then
            If _GlsL70 = 1 Or _GlsL70 = 2 Then
                If _Dampf > 0 Then
                    _eb.lokSteuern(70, Klassen.LokEigenschaften.Funktion1, 1) ' Dampf ein
                End If
            End If
        ElseIf _Prog70 = 663 Then
            If _GlsL70 = 1 Or _GlsL70 = 2 Then
                If _AkustischeSignale > 0 Then
                    _eb.lokSteuern(70, Klassen.LokEigenschaften.Funktion3, 1) ' Pfiff ein
                End If
            End If
        ElseIf _Prog70 = 664 Then
            _eb.lokSteuern(70, Klassen.LokEigenschaften.Funktion3, 0) ' Pfiff aus

        ElseIf _Prog70 = 700 Then ' Kontakt 0.4 <- Diagonale
            Prog_Lok70.Interval = 3000
        ElseIf _Prog70 = 701 Then
        ElseIf _Prog70 = 702 Then
        ElseIf _Prog70 = 703 Then
            If _Dampf > 0 Then
                _eb.lokSteuern(70, Klassen.LokEigenschaften.Funktion1, 1) ' Dampf ein
            End If
        ElseIf _Prog70 = 704 Then
        ElseIf _Prog70 = 705 Then
            If _AkustischeSignale > 1 Then
                _eb.lokSteuern(70, Klassen.LokEigenschaften.Funktion3, 1) ' Pfiff ein
            End If
        ElseIf _Prog70 = 706 Then
            _eb.lokSteuern(70, Klassen.LokEigenschaften.Funktion3, 0) ' Pfiff aus

            ' Zindelstein

        ElseIf _Prog70 = 500 Then
            Prog_Lok70.Interval = V_500
        ElseIf _Prog70 = 501 Then
            _eb.lokSteuern(70, Klassen.LokEigenschaften.Geschwindigkeit, Stufe23)
            Prog_Lok70.Interval = T_500
        ElseIf _Prog70 = 502 Then
            _eb.lokSteuern(70, Klassen.LokEigenschaften.Geschwindigkeit, Stufe22)
        ElseIf _Prog70 = 503 Then
            _eb.lokSteuern(70, Klassen.LokEigenschaften.Geschwindigkeit, Stufe21)
        ElseIf _Prog70 = 504 Then
            _eb.lokSteuern(70, Klassen.LokEigenschaften.Geschwindigkeit, Stufe2)
        ElseIf _Prog70 = 505 Then
            _eb.lokSteuern(70, Klassen.LokEigenschaften.Geschwindigkeit, 0)

        Else
            _Prog70 = 0
            Prog_Lok70.Stop()
            Prog_Lok70.Interval = 200
            If Betriebsart = 1 Then
                SetProgramCounterLabel1(String.Empty)
            Else
                SetProgramCounterLabel(String.Empty)
            End If
        End If
        _Prog70 = _Prog70 + 1
    End Sub
    Private Sub HandleTimerElapsed83(sender As System.Object, e As System.EventArgs) Handles Prog_Lok71.Elapsed

        '*** Fahrprogramm für Dampflok 85 007
        '*** Datum: 08.10.2021

        SetText(TextBox1, "Dampf-Lok 85 007                                                        IBS: 10.12.2025 - V3 : 8")
        LoadImage(PictureBox1, "H:\\EB_Media\\LokFotos\\Baureihe_85_01.jpg")
        GeschwindikeitenSetzen(71)

        Dim Stufe1, Stufe2, Stufe3, Stufe4 As Integer
        Dim Stufe11, Stufe12, Stufe13, Stufe14, Stufe21, Stufe22, Stufe23, Stufe24 As Integer
        Dim V_100, V_130, V_160, V_180, V_500 As Integer
        Dim T_100, T_130, T_160, T_180, T_500 As Integer
        Dim G_200 As Integer

        T_100 = _Betriebsparameter.Fahrparameter(71, KlausEBspecific.Betriebsparameter.FahrparameterEnum.T_100)
        T_130 = _Betriebsparameter.Fahrparameter(71, KlausEBspecific.Betriebsparameter.FahrparameterEnum.T_130)
        T_160 = _Betriebsparameter.Fahrparameter(71, KlausEBspecific.Betriebsparameter.FahrparameterEnum.T_160)
        T_180 = _Betriebsparameter.Fahrparameter(71, KlausEBspecific.Betriebsparameter.FahrparameterEnum.T_180)
        T_500 = _Betriebsparameter.Fahrparameter(71, KlausEBspecific.Betriebsparameter.FahrparameterEnum.T_500)
        V_100 = _Betriebsparameter.Fahrparameter(71, KlausEBspecific.Betriebsparameter.FahrparameterEnum.V_100)
        V_130 = _Betriebsparameter.Fahrparameter(71, KlausEBspecific.Betriebsparameter.FahrparameterEnum.V_130)
        V_160 = _Betriebsparameter.Fahrparameter(71, KlausEBspecific.Betriebsparameter.FahrparameterEnum.V_160)
        V_180 = _Betriebsparameter.Fahrparameter(71, KlausEBspecific.Betriebsparameter.FahrparameterEnum.V_180)
        V_500 = _Betriebsparameter.Fahrparameter(71, KlausEBspecific.Betriebsparameter.FahrparameterEnum.V_500)
        G_200 = _Betriebsparameter.Fahrparameter(71, KlausEBspecific.Betriebsparameter.FahrparameterEnum.G_200)

        If A_StopB = 1 Then
            V_100 = 8000
        End If

        Stufe1 = _LokStufen.Holen(71, 1)
        Stufe2 = _LokStufen.Holen(71, 2)
        Stufe3 = _LokStufen.Holen(71, 3)
        Stufe4 = _LokStufen.Holen(71, 4)

        If Stufe2 = 1 Then
            T_100 = T_100
            T_130 = T_130
            T_160 = T_160
            V_180 = V_180
        ElseIf Stufe2 = 2 Then
            T_100 = T_100 + 300
            T_130 = T_130 + 300
            T_160 = T_160 + 300
            V_180 = V_180 + 500
        ElseIf Stufe2 = 3 Then
            T_100 = T_100 + 500
            T_130 = T_130 + 500
            T_160 = T_160 + 500
            V_180 = V_180 + 1000
        ElseIf Stufe2 = 4 Then
            T_100 = T_100 + 700
            T_130 = T_130 + 700
            T_160 = T_160 + 700
            V_180 = V_180 + 1500
        ElseIf Stufe2 = 5 Then
            T_100 = T_100 + 900
            T_130 = T_130 + 900
            T_160 = T_160 + 900
            V_180 = V_180 + 2000
        ElseIf Stufe2 = 6 Then
            T_100 = T_100 + 1200
            T_130 = T_130 + 1200
            T_160 = T_160 + 1200
            V_180 = V_180 + 2500
        Else
            T_100 = T_100 + 1200
            T_130 = T_130 + 1200
            T_160 = T_160 + 1200
            V_180 = V_180 + 2500
        End If

        Stufe2 = Stufe1

        Stufe11 = Stufe1 + 1
        If Stufe11 > Stufe3 Then
            Stufe11 = Stufe3
        End If
        Stufe12 = Stufe1 + 2
        If Stufe12 > Stufe3 Then
            Stufe12 = Stufe3
        End If
        Stufe13 = Stufe1 + 3
        If Stufe13 > Stufe3 Then
            Stufe13 = Stufe3
        End If
        Stufe14 = Stufe1 + 4
        If Stufe14 > Stufe3 Then
            Stufe14 = Stufe3
        End If

        Stufe21 = Stufe2 + 1
        If Stufe21 > Stufe3 Then
            Stufe21 = Stufe3
        End If
        Stufe22 = Stufe2 + 2
        If Stufe22 > Stufe3 Then
            Stufe22 = Stufe3
        End If
        Stufe23 = Stufe2 + 3
        If Stufe23 > Stufe3 Then
            Stufe23 = Stufe3
        End If
        Stufe24 = Stufe2 + 4
        If Stufe24 > Stufe3 Then
            Stufe24 = Stufe3
        End If
        If G_200 > 0 Then
            If G_200 < Stufe4 Then
                G_200 = Stufe4
            End If
        Else
            G_200 = Stufe4
        End If

        If Betriebsart = 1 And (_GlsL71 = 3 Or _GlsL71 = 4) Then
            SetProgramCounterLabel1(_Prog71)
        Else
            SetProgramCounterLabel(_Prog71)
        End If

        ' Lok starten - Bahnhofsausfahrt

        If _Prog71 = 0 Then
            Prog_Lok71.Interval = 2000
        ElseIf _Prog71 = 1 Then
            _Betriebsparameter.RundenErhoehen(71)
        ElseIf _Prog71 = 2 Then

            ' Bahnhofsausfahrt

        ElseIf _Prog71 = 3 Then
            _eb.lokSteuern(71, Klassen.LokEigenschaften.Geschwindigkeit, Stufe1)
        ElseIf _Prog71 = 4 Then
            _eb.lokSteuern(71, Klassen.LokEigenschaften.Geschwindigkeit, Stufe11)
        ElseIf _Prog71 = 5 Then
            _eb.lokSteuern(71, Klassen.LokEigenschaften.Geschwindigkeit, Stufe12)
        ElseIf _Prog71 = 6 Then
            _eb.lokSteuern(71, Klassen.LokEigenschaften.Geschwindigkeit, Stufe13)
        ElseIf _Prog71 = 7 Then
            _eb.lokSteuern(71, Klassen.LokEigenschaften.Geschwindigkeit, Stufe14)
        ElseIf _Prog71 = 8 Then
            _eb.lokSteuern(71, Klassen.LokEigenschaften.Geschwindigkeit, Stufe3)

            ' Lok abstellen

        ElseIf _Prog71 = 50 Then
            Prog_Lok71.Interval = 2000
        ElseIf _Prog71 = 51 Then ' *** Lok hat keine Lichtfunktion
        ElseIf _Prog71 = 52 Then

            ' Lok bremsen (Bahnhofseinfahrt Normalzug von links und von rechts)

        ElseIf _Prog71 = 100 Then
            Prog_Lok71.Interval = V_100
        ElseIf _Prog71 = 101 Then
            _eb.lokSteuern(71, Klassen.LokEigenschaften.Geschwindigkeit, Stufe24)
            Prog_Lok71.Interval = T_100
        ElseIf _Prog71 = 102 Then
            _eb.lokSteuern(71, Klassen.LokEigenschaften.Geschwindigkeit, Stufe23)
        ElseIf _Prog71 = 103 Then
            _eb.lokSteuern(71, Klassen.LokEigenschaften.Geschwindigkeit, Stufe22)
        ElseIf _Prog71 = 104 Then
            _eb.lokSteuern(71, Klassen.LokEigenschaften.Geschwindigkeit, Stufe21)
        ElseIf _Prog71 = 105 Then
            _eb.lokSteuern(71, Klassen.LokEigenschaften.Geschwindigkeit, Stufe2)

            ' Lok bremsen (Bahnhofseinfahrt Kurzzug von links)

        ElseIf _Prog71 = 130 Then
            Prog_Lok71.Interval = V_130
        ElseIf _Prog71 = 131 Then
            _eb.lokSteuern(71, Klassen.LokEigenschaften.Geschwindigkeit, Stufe24)
            Prog_Lok71.Interval = T_130
        ElseIf _Prog71 = 132 Then
            _eb.lokSteuern(71, Klassen.LokEigenschaften.Geschwindigkeit, Stufe23)
        ElseIf _Prog71 = 133 Then
            _eb.lokSteuern(71, Klassen.LokEigenschaften.Geschwindigkeit, Stufe22)
        ElseIf _Prog71 = 134 Then
            _eb.lokSteuern(71, Klassen.LokEigenschaften.Geschwindigkeit, Stufe21)
        ElseIf _Prog71 = 135 Then
            _eb.lokSteuern(71, Klassen.LokEigenschaften.Geschwindigkeit, Stufe2)
        ElseIf _Prog71 = 136 Then
            _eb.lokSteuern(71, Klassen.LokEigenschaften.Geschwindigkeit, 0)
        ElseIf _Prog71 = 137 Then
            Prog_Lok71.Interval = 2000
        ElseIf _Prog71 = 138 Then
            If _Fahrzeugbeleuchtung2 < 2 Then
                _eb.lokSteuern(71, Klassen.LokEigenschaften.Hauptfunktion, 0) ' Licht aus
            End If

            ' Lok bremsen (Bahnhofseinfahrt Kurzzug von rechts)

        ElseIf _Prog71 = 160 Then
            Prog_Lok71.Interval = V_160
        ElseIf _Prog71 = 161 Then
            _eb.lokSteuern(71, Klassen.LokEigenschaften.Geschwindigkeit, Stufe24)
            Prog_Lok71.Interval = T_160
        ElseIf _Prog71 = 162 Then
            _eb.lokSteuern(71, Klassen.LokEigenschaften.Geschwindigkeit, Stufe23)
        ElseIf _Prog71 = 163 Then
            _eb.lokSteuern(71, Klassen.LokEigenschaften.Geschwindigkeit, Stufe22)
        ElseIf _Prog71 = 164 Then
            _eb.lokSteuern(71, Klassen.LokEigenschaften.Geschwindigkeit, Stufe21)
        ElseIf _Prog71 = 165 Then
            _eb.lokSteuern(71, Klassen.LokEigenschaften.Geschwindigkeit, Stufe2)
        ElseIf _Prog71 = 166 Then
            _eb.lokSteuern(71, Klassen.LokEigenschaften.Geschwindigkeit, 0)
        ElseIf _Prog71 = 167 Then
            Prog_Lok71.Interval = 2000
        ElseIf _Prog71 = 168 Then
            If _Fahrzeugbeleuchtung2 < 2 Then
                _eb.lokSteuern(71, Klassen.LokEigenschaften.Hauptfunktion, 0) ' Licht aus
            End If

            ' Rangierzug

        ElseIf _Prog71 = 180 Then
            _eb.lokSteuern(71, Klassen.LokEigenschaften.Geschwindigkeit, 2)
            Prog_Lok71.Interval = V_180
        ElseIf _Prog71 = 181 Then
            Prog_Lok71.Interval = T_180
            _eb.lokSteuern(71, Klassen.LokEigenschaften.Geschwindigkeit, 1)
        ElseIf _Prog71 = 182 Then
            _eb.lokSteuern(71, Klassen.LokEigenschaften.Geschwindigkeit, 0)

            ' Tunnelausfahrt

        ElseIf _Prog71 = 200 Then ' Kontakt 1.2 <- (bergauf)
            Prog_Lok71.Interval = 2000
            _eb.lokSteuern(71, Klassen.LokEigenschaften.Geschwindigkeit, G_200)
        ElseIf _Prog71 = 201 Then
        ElseIf _Prog71 = 202 Then
        ElseIf _Prog71 = 203 Then
        ElseIf _Prog71 = 204 Then
        ElseIf _Prog71 = 205 Then
            If Stufe4 < Stufe3 Then
                _eb.lokSteuern(71, Klassen.LokEigenschaften.Geschwindigkeit, Stufe3)
            Else
                _eb.lokSteuern(71, Klassen.LokEigenschaften.Geschwindigkeit, Stufe4)
            End If

        ElseIf _Prog71 = 220 Then ' Kontakt 3.1 -> (hinter dem Martinstor bergauf)
            Prog_Lok71.Interval = 2000
        ElseIf _Prog71 = 221 Then
        ElseIf _Prog71 = 222 Then

        ElseIf _Prog71 = 240 Then ' Kontakt 3.7 <- (hinter der Brücke bergauf)
            Prog_Lok71.Interval = 2000
        ElseIf _Prog71 = 241 Then
        ElseIf _Prog71 = 242 Then

        ElseIf _Prog71 = 260 Then ' Kontakt 3.3 (links bzw vor der Brücke)
            Prog_Lok71.Interval = 2000
        ElseIf _Prog71 = 261 Then
        ElseIf _Prog71 = 262 Then
            _eb.lokSteuern(71, Klassen.LokEigenschaften.Geschwindigkeit, Stufe3)

        ElseIf _Prog71 = 600 Then ' Kontakt 3.5 <- (unter der Burg)
            Prog_Lok71.Interval = 2000
        ElseIf _Prog71 = 601 Then
        ElseIf _Prog71 = 602 Then

        ElseIf _Prog71 = 620 Then ' Kontakt 3.7 -> (hinter der Brücke bergab)
            Prog_Lok71.Interval = 2000
        ElseIf _Prog71 = 621 Then
        ElseIf _Prog71 = 622 Then

        ElseIf _Prog71 = 640 Then ' Kontakt 3.1 <- Talfahrt
            Prog_Lok71.Interval = 2000
        ElseIf _Prog71 = 641 Then
        ElseIf _Prog71 = 642 Then

        ElseIf _Prog71 = 660 Then ' Kontakt 1.2 -> Talfahrt
            Prog_Lok71.Interval = 2000
        ElseIf _Prog71 = 661 Then
        ElseIf _Prog71 = 662 Then

        ElseIf _Prog71 = 700 Then ' Kontakt 0.4 <- Diagonale
            Prog_Lok71.Interval = 2000
        ElseIf _Prog71 = 701 Then
        ElseIf _Prog71 = 702 Then

            ' Zindelstein

        ElseIf _Prog71 = 500 Then
            Prog_Lok71.Interval = V_500
        ElseIf _Prog71 = 501 Then
            _eb.lokSteuern(71, Klassen.LokEigenschaften.Geschwindigkeit, Stufe23)
            Prog_Lok71.Interval = T_500
        ElseIf _Prog71 = 502 Then
            _eb.lokSteuern(71, Klassen.LokEigenschaften.Geschwindigkeit, Stufe22)
        ElseIf _Prog71 = 503 Then
            _eb.lokSteuern(71, Klassen.LokEigenschaften.Geschwindigkeit, Stufe21)
        ElseIf _Prog71 = 504 Then
            _eb.lokSteuern(71, Klassen.LokEigenschaften.Geschwindigkeit, Stufe2)
        ElseIf _Prog71 = 505 Then
            _eb.lokSteuern(71, Klassen.LokEigenschaften.Geschwindigkeit, 0)

        Else
            _Prog71 = 0
            Prog_Lok71.Stop()
            Prog_Lok71.Interval = 200
            If Betriebsart = 1 Then
                SetProgramCounterLabel1(String.Empty)
            Else
                SetProgramCounterLabel(String.Empty)
            End If
        End If
        _Prog71 = _Prog71 + 1

    End Sub
    Private Sub HandleTimerElapsed84(sender As System.Object, e As System.EventArgs) Handles Prog_Lok72.Elapsed

        '*** Fahrprogramm für Dampflok KLVM 3087
        '*** Datum: 23.02.2020

        SetText(TextBox1, "Dampflok KLVM 3087                                                      IBS: nein")
        LoadImage(PictureBox1, "H:\\EB_Media\\LokFotos\\Baureihe_KLVM_01.jpg")
        GeschwindikeitenSetzen(72)

        Dim Stufe1, Stufe2, Stufe3, Stufe4 As Integer
        Dim Stufe11, Stufe12, Stufe13, Stufe14, Stufe21, Stufe22, Stufe23, Stufe24 As Integer
        Dim V_100, V_130, V_160, V_180, V_500 As Integer
        Dim T_100, T_130, T_160, T_180, T_500 As Integer
        Dim G_200 As Integer

        T_100 = _Betriebsparameter.Fahrparameter(72, KlausEBspecific.Betriebsparameter.FahrparameterEnum.T_100)
        T_130 = _Betriebsparameter.Fahrparameter(72, KlausEBspecific.Betriebsparameter.FahrparameterEnum.T_130)
        T_160 = _Betriebsparameter.Fahrparameter(72, KlausEBspecific.Betriebsparameter.FahrparameterEnum.T_160)
        T_180 = _Betriebsparameter.Fahrparameter(72, KlausEBspecific.Betriebsparameter.FahrparameterEnum.T_180)
        T_500 = _Betriebsparameter.Fahrparameter(72, KlausEBspecific.Betriebsparameter.FahrparameterEnum.T_500)
        V_100 = _Betriebsparameter.Fahrparameter(72, KlausEBspecific.Betriebsparameter.FahrparameterEnum.V_100)
        V_130 = _Betriebsparameter.Fahrparameter(72, KlausEBspecific.Betriebsparameter.FahrparameterEnum.V_130)
        V_160 = _Betriebsparameter.Fahrparameter(72, KlausEBspecific.Betriebsparameter.FahrparameterEnum.V_160)
        V_180 = _Betriebsparameter.Fahrparameter(72, KlausEBspecific.Betriebsparameter.FahrparameterEnum.V_180)
        V_500 = _Betriebsparameter.Fahrparameter(72, KlausEBspecific.Betriebsparameter.FahrparameterEnum.V_500)
        G_200 = _Betriebsparameter.Fahrparameter(72, KlausEBspecific.Betriebsparameter.FahrparameterEnum.G_200)

        If A_StopB = 1 Then
            V_100 = 8000
        End If

        Stufe1 = _LokStufen.Holen(72, 1)
        Stufe2 = _LokStufen.Holen(72, 2)
        Stufe3 = _LokStufen.Holen(72, 3)
        Stufe4 = _LokStufen.Holen(72, 4)

        If Stufe2 = 1 Then
            T_100 = T_100
            T_130 = T_130
            T_160 = T_160
            V_180 = V_180
        ElseIf Stufe2 = 2 Then
            T_100 = T_100 + 300
            T_130 = T_130 + 300
            T_160 = T_160 + 300
            V_180 = V_180 + 500
        ElseIf Stufe2 = 3 Then
            T_100 = T_100 + 500
            T_130 = T_130 + 500
            T_160 = T_160 + 500
            V_180 = V_180 + 1000
        ElseIf Stufe2 = 4 Then
            T_100 = T_100 + 700
            T_130 = T_130 + 700
            T_160 = T_160 + 700
            V_180 = V_180 + 1500
        ElseIf Stufe2 = 5 Then
            T_100 = T_100 + 900
            T_130 = T_130 + 900
            T_160 = T_160 + 900
            V_180 = V_180 + 2000
        ElseIf Stufe2 = 6 Then
            T_100 = T_100 + 1200
            T_130 = T_130 + 1200
            T_160 = T_160 + 1200
            V_180 = V_180 + 2500
        Else
            T_100 = T_100 + 1200
            T_130 = T_130 + 1200
            T_160 = T_160 + 1200
            V_180 = V_180 + 2500
        End If

        Stufe2 = Stufe1

        Stufe11 = Stufe1 + 1
        If Stufe11 > Stufe3 Then
            Stufe11 = Stufe3
        End If
        Stufe12 = Stufe1 + 2
        If Stufe12 > Stufe3 Then
            Stufe12 = Stufe3
        End If
        Stufe13 = Stufe1 + 3
        If Stufe13 > Stufe3 Then
            Stufe13 = Stufe3
        End If
        Stufe14 = Stufe1 + 4
        If Stufe14 > Stufe3 Then
            Stufe14 = Stufe3
        End If

        Stufe21 = Stufe2 + 1
        If Stufe21 > Stufe3 Then
            Stufe21 = Stufe3
        End If
        Stufe22 = Stufe2 + 2
        If Stufe22 > Stufe3 Then
            Stufe22 = Stufe3
        End If
        Stufe23 = Stufe2 + 3
        If Stufe23 > Stufe3 Then
            Stufe23 = Stufe3
        End If
        Stufe24 = Stufe2 + 4
        If Stufe24 > Stufe3 Then
            Stufe24 = Stufe3
        End If
        If G_200 > 0 Then
            If G_200 < Stufe4 Then
                G_200 = Stufe4
            End If
        Else
            G_200 = Stufe4
        End If

        If Betriebsart = 1 And (_GlsL72 = 3 Or _GlsL72 = 4) Then
            SetProgramCounterLabel1(_Prog72)
        Else
            SetProgramCounterLabel(_Prog72)
        End If

        ' Lok starten - Bahnhofsausfahrt

        If _Prog72 = 0 Then
            Prog_Lok72.Interval = 2000
        ElseIf _Prog72 = 1 Then
        ElseIf _Prog72 = 2 Then
            _Betriebsparameter.RundenErhoehen(72)
        ElseIf _Prog72 = 3 Then
        ElseIf _Prog72 = 4 Then
        ElseIf _Prog72 = 5 Then
        ElseIf _Prog72 = 6 Then

            ' Bahnhofsausfahrt

        ElseIf _Prog72 = 7 Then
            _eb.lokSteuern(72, Klassen.LokEigenschaften.Geschwindigkeit, Stufe1)
        ElseIf _Prog72 = 8 Then
            _eb.lokSteuern(72, Klassen.LokEigenschaften.Geschwindigkeit, Stufe11)
        ElseIf _Prog72 = 9 Then
            _eb.lokSteuern(72, Klassen.LokEigenschaften.Geschwindigkeit, Stufe12)
        ElseIf _Prog72 = 10 Then
            _eb.lokSteuern(72, Klassen.LokEigenschaften.Geschwindigkeit, Stufe13)
        ElseIf _Prog72 = 11 Then
            _eb.lokSteuern(72, Klassen.LokEigenschaften.Geschwindigkeit, Stufe14)
        ElseIf _Prog72 = 12 Then
            _eb.lokSteuern(72, Klassen.LokEigenschaften.Geschwindigkeit, Stufe3)

            ' Lok abstellen

        ElseIf _Prog72 = 50 Then
            Prog_Lok72.Interval = 2000
        ElseIf _Prog72 = 51 Then
        ElseIf _Prog72 = 52 Then
            If _Fahrzeugbeleuchtung2 < 2 Then
                _eb.lokSteuern(72, Klassen.LokEigenschaften.Hauptfunktion, 0) ' Licht aus
            End If

            ' Lok bremsen (Bahnhofseinfahrt Normalzug von links und von rechts)

        ElseIf _Prog72 = 100 Then
            Prog_Lok72.Interval = V_100
        ElseIf _Prog72 = 101 Then
            _eb.lokSteuern(72, Klassen.LokEigenschaften.Geschwindigkeit, Stufe24)
            Prog_Lok72.Interval = T_100
        ElseIf _Prog72 = 102 Then
            _eb.lokSteuern(72, Klassen.LokEigenschaften.Geschwindigkeit, Stufe23)
        ElseIf _Prog72 = 103 Then
            _eb.lokSteuern(72, Klassen.LokEigenschaften.Geschwindigkeit, Stufe22)
        ElseIf _Prog72 = 104 Then
            _eb.lokSteuern(72, Klassen.LokEigenschaften.Geschwindigkeit, Stufe21)
        ElseIf _Prog72 = 105 Then
            _eb.lokSteuern(72, Klassen.LokEigenschaften.Geschwindigkeit, Stufe2)

            ' Lok bremsen (Bahnhofseinfahrt Kurzzug von links)

        ElseIf _Prog72 = 130 Then
            Prog_Lok72.Interval = V_130
        ElseIf _Prog72 = 131 Then
            _eb.lokSteuern(72, Klassen.LokEigenschaften.Geschwindigkeit, Stufe24)
            Prog_Lok72.Interval = T_130
        ElseIf _Prog72 = 132 Then
            _eb.lokSteuern(72, Klassen.LokEigenschaften.Geschwindigkeit, Stufe23)
        ElseIf _Prog72 = 133 Then
            _eb.lokSteuern(72, Klassen.LokEigenschaften.Geschwindigkeit, Stufe22)
        ElseIf _Prog72 = 134 Then
            _eb.lokSteuern(72, Klassen.LokEigenschaften.Geschwindigkeit, Stufe21)
        ElseIf _Prog72 = 135 Then
            _eb.lokSteuern(72, Klassen.LokEigenschaften.Geschwindigkeit, Stufe2)
        ElseIf _Prog72 = 136 Then
            _eb.lokSteuern(72, Klassen.LokEigenschaften.Geschwindigkeit, 0)
        ElseIf _Prog72 = 137 Then
            Prog_Lok72.Interval = 2000
        ElseIf _Prog72 = 138 Then
            If _Fahrzeugbeleuchtung2 < 2 Then
                _eb.lokSteuern(72, Klassen.LokEigenschaften.Hauptfunktion, 0) ' Licht aus
            End If

            ' Lok bremsen (Bahnhofseinfahrt Kurzzug von rechts)

        ElseIf _Prog72 = 160 Then
            Prog_Lok72.Interval = V_160
        ElseIf _Prog72 = 161 Then
            _eb.lokSteuern(72, Klassen.LokEigenschaften.Geschwindigkeit, Stufe24)
            Prog_Lok72.Interval = T_160
        ElseIf _Prog72 = 162 Then
            _eb.lokSteuern(72, Klassen.LokEigenschaften.Geschwindigkeit, Stufe23)
        ElseIf _Prog72 = 163 Then
            _eb.lokSteuern(72, Klassen.LokEigenschaften.Geschwindigkeit, Stufe22)
        ElseIf _Prog72 = 164 Then
            _eb.lokSteuern(72, Klassen.LokEigenschaften.Geschwindigkeit, Stufe21)
        ElseIf _Prog72 = 165 Then
            _eb.lokSteuern(72, Klassen.LokEigenschaften.Geschwindigkeit, Stufe2)
        ElseIf _Prog72 = 166 Then
            _eb.lokSteuern(72, Klassen.LokEigenschaften.Geschwindigkeit, 0)
        ElseIf _Prog72 = 167 Then
            Prog_Lok72.Interval = 2000
        ElseIf _Prog72 = 168 Then
            If _Fahrzeugbeleuchtung2 < 2 Then
                _eb.lokSteuern(72, Klassen.LokEigenschaften.Hauptfunktion, 0) ' Licht aus
            End If

            ' Rangierzug

        ElseIf _Prog72 = 180 Then
            _eb.lokSteuern(72, Klassen.LokEigenschaften.Geschwindigkeit, 2)
            Prog_Lok72.Interval = V_180
        ElseIf _Prog72 = 181 Then
            Prog_Lok72.Interval = T_180
            _eb.lokSteuern(72, Klassen.LokEigenschaften.Geschwindigkeit, 1)
        ElseIf _Prog72 = 182 Then
            _eb.lokSteuern(72, Klassen.LokEigenschaften.Geschwindigkeit, 0)

            ' Tunnelausfahrt

        ElseIf _Prog72 = 200 Then ' Kontakt 1.2 <- (bergauf)
            _eb.lokSteuern(72, Klassen.LokEigenschaften.Geschwindigkeit, G_200)
            Prog_Lok72.Interval = 2000
        ElseIf _Prog72 = 201 Then
        ElseIf _Prog72 = 202 Then
        ElseIf _Prog72 = 203 Then
        ElseIf _Prog72 = 204 Then
        ElseIf _Prog72 = 205 Then
            If Stufe4 < Stufe3 Then
                _eb.lokSteuern(72, Klassen.LokEigenschaften.Geschwindigkeit, Stufe3)
            Else
                _eb.lokSteuern(72, Klassen.LokEigenschaften.Geschwindigkeit, Stufe4)
            End If

        ElseIf _Prog72 = 220 Then ' Kontakt 3.1 -> (hinter dem Martinstor bergauf)
            Prog_Lok72.Interval = 2000
        ElseIf _Prog72 = 221 Then
        ElseIf _Prog72 = 222 Then

        ElseIf _Prog72 = 240 Then ' Kontakt 3.7 <- (hinter der Brücke bergauf)
            Prog_Lok72.Interval = 2000
        ElseIf _Prog72 = 241 Then
        ElseIf _Prog72 = 242 Then

        ElseIf _Prog72 = 260 Then ' Kontakt 3.3 (links bzw vor der Brücke)
            Prog_Lok72.Interval = 2000
        ElseIf _Prog72 = 261 Then
        ElseIf _Prog72 = 262 Then
            _eb.lokSteuern(72, Klassen.LokEigenschaften.Geschwindigkeit, Stufe3)

        ElseIf _Prog72 = 600 Then ' Kontakt 3.5 <- (unter der Burg)
            Prog_Lok72.Interval = 2000
        ElseIf _Prog72 = 601 Then
        ElseIf _Prog72 = 602 Then

        ElseIf _Prog72 = 620 Then ' Kontakt 3.7 -> (hinter der Brücke bergab)
            Prog_Lok72.Interval = 2000
        ElseIf _Prog72 = 621 Then
        ElseIf _Prog72 = 622 Then

        ElseIf _Prog72 = 640 Then ' Kontakt 3.1 <- Talfahrt
            Prog_Lok72.Interval = 2000
        ElseIf _Prog72 = 641 Then
        ElseIf _Prog72 = 642 Then

        ElseIf _Prog72 = 660 Then ' Kontakt 1.2 -> Talfahrt
            Prog_Lok72.Interval = 2000
        ElseIf _Prog72 = 661 Then
        ElseIf _Prog72 = 662 Then

        ElseIf _Prog72 = 700 Then ' Kontakt 0.4 <- Diagonale
            Prog_Lok72.Interval = 2000
        ElseIf _Prog72 = 701 Then
        ElseIf _Prog72 = 702 Then

            ' Zindelstein

        ElseIf _Prog72 = 500 Then
            Prog_Lok72.Interval = V_500
        ElseIf _Prog72 = 501 Then
            _eb.lokSteuern(72, Klassen.LokEigenschaften.Geschwindigkeit, Stufe23)
            Prog_Lok72.Interval = T_500
        ElseIf _Prog72 = 502 Then
            _eb.lokSteuern(72, Klassen.LokEigenschaften.Geschwindigkeit, Stufe22)
        ElseIf _Prog72 = 503 Then
            _eb.lokSteuern(72, Klassen.LokEigenschaften.Geschwindigkeit, Stufe21)
        ElseIf _Prog72 = 504 Then
            _eb.lokSteuern(72, Klassen.LokEigenschaften.Geschwindigkeit, Stufe2)
        ElseIf _Prog72 = 505 Then
            _eb.lokSteuern(72, Klassen.LokEigenschaften.Geschwindigkeit, 0)

        Else
            _Prog72 = 0
            Prog_Lok72.Stop()
            Prog_Lok72.Interval = 200
            If Betriebsart = 1 Then
                SetProgramCounterLabel1(String.Empty)
            Else
                SetProgramCounterLabel(String.Empty)
            End If
        End If
        _Prog72 = _Prog72 + 1

    End Sub
    Private Sub HandleTimerElapsed85(sender As System.Object, e As System.EventArgs) Handles Prog_Lok73.Elapsed

        '*** Fahrprogramm für Dampflok AC/DC
        '*** Datum: 08.11.2025

        SetText(TextBox1, "Damf-Lok Black Ice                                                      IBS: 06.11.2025 - V3 : 7")
        LoadImage(PictureBox1, "H:\\EB_Media\\LokFotos\\BlackIce.jpeg")
        GeschwindikeitenSetzen(73)

        Dim Stufe1, Stufe2, Stufe3, Stufe4 As Integer
        Dim Stufe11, Stufe12, Stufe13, Stufe14, Stufe21, Stufe22, Stufe23, Stufe24 As Integer
        Dim V_100, V_130, V_160, V_180, V_500 As Integer
        Dim T_100, T_130, T_160, T_180, T_500 As Integer
        Dim G_200 As Integer

        T_100 = _Betriebsparameter.Fahrparameter(73, KlausEBspecific.Betriebsparameter.FahrparameterEnum.T_100)
        T_130 = _Betriebsparameter.Fahrparameter(73, KlausEBspecific.Betriebsparameter.FahrparameterEnum.T_130)
        T_160 = _Betriebsparameter.Fahrparameter(73, KlausEBspecific.Betriebsparameter.FahrparameterEnum.T_160)
        T_180 = _Betriebsparameter.Fahrparameter(73, KlausEBspecific.Betriebsparameter.FahrparameterEnum.T_180)
        T_500 = _Betriebsparameter.Fahrparameter(73, KlausEBspecific.Betriebsparameter.FahrparameterEnum.T_500)
        V_100 = _Betriebsparameter.Fahrparameter(73, KlausEBspecific.Betriebsparameter.FahrparameterEnum.V_100)
        V_130 = _Betriebsparameter.Fahrparameter(73, KlausEBspecific.Betriebsparameter.FahrparameterEnum.V_130)
        V_160 = _Betriebsparameter.Fahrparameter(73, KlausEBspecific.Betriebsparameter.FahrparameterEnum.V_160)
        V_180 = _Betriebsparameter.Fahrparameter(73, KlausEBspecific.Betriebsparameter.FahrparameterEnum.V_180)
        V_500 = _Betriebsparameter.Fahrparameter(73, KlausEBspecific.Betriebsparameter.FahrparameterEnum.V_500)
        G_200 = _Betriebsparameter.Fahrparameter(73, KlausEBspecific.Betriebsparameter.FahrparameterEnum.G_200)

        If A_StopB = 1 Then
            V_100 = 8000
        End If

        Stufe1 = _LokStufen.Holen(73, 1)
        Stufe2 = _LokStufen.Holen(73, 2)
        Stufe3 = _LokStufen.Holen(73, 3)
        Stufe4 = _LokStufen.Holen(73, 4)

        If Stufe2 = 1 Then
            T_100 = T_100
            T_130 = T_130
            T_160 = T_160
            V_180 = V_180
        ElseIf Stufe2 = 2 Then
            T_100 = T_100 + 300
            T_130 = T_130 + 300
            T_160 = T_160 + 300
            V_180 = V_180 + 500
        ElseIf Stufe2 = 3 Then
            T_100 = T_100 + 500
            T_130 = T_130 + 500
            T_160 = T_160 + 500
            V_180 = V_180 + 1000
        ElseIf Stufe2 = 4 Then
            T_100 = T_100 + 700
            T_130 = T_130 + 700
            T_160 = T_160 + 700
            V_180 = V_180 + 1500
        ElseIf Stufe2 = 5 Then
            T_100 = T_100 + 900
            T_130 = T_130 + 900
            T_160 = T_160 + 900
            V_180 = V_180 + 2000
        ElseIf Stufe2 = 6 Then
            T_100 = T_100 + 1200
            T_130 = T_130 + 1200
            T_160 = T_160 + 1200
            V_180 = V_180 + 2500
        Else
            T_100 = T_100 + 1200
            T_130 = T_130 + 1200
            T_160 = T_160 + 1200
            V_180 = V_180 + 2500
        End If

        Stufe2 = Stufe1

        Stufe11 = Stufe1 + 1
        If Stufe11 > Stufe3 Then
            Stufe11 = Stufe3
        End If
        Stufe12 = Stufe1 + 3
        If Stufe12 > Stufe3 Then
            Stufe12 = Stufe3
        End If
        Stufe13 = Stufe1 + 5
        If Stufe13 > Stufe3 Then
            Stufe13 = Stufe3
        End If
        Stufe14 = Stufe1 + 6
        If Stufe14 > Stufe3 Then
            Stufe14 = Stufe3
        End If

        Stufe21 = Stufe2 + 1
        If Stufe21 > Stufe3 Then
            Stufe21 = Stufe3
        End If
        Stufe22 = Stufe2 + 2
        If Stufe22 > Stufe3 Then
            Stufe22 = Stufe3
        End If
        Stufe23 = Stufe2 + 3
        If Stufe23 > Stufe3 Then
            Stufe23 = Stufe3
        End If
        Stufe24 = Stufe2 + 4
        If Stufe24 > Stufe3 Then
            Stufe24 = Stufe3
        End If
        If G_200 > 0 Then
            If G_200 < Stufe4 Then
                G_200 = Stufe4
            End If
        Else
            G_200 = Stufe4
        End If

        If Betriebsart = 1 And (_GlsL73 = 3 Or _GlsL73 = 4) Then
            SetProgramCounterLabel1(_Prog73)
        Else
            SetProgramCounterLabel(_Prog73)
        End If

        ' Lok starten - Bahnhofsausfahrt

        If _Prog73 = 0 Then
            Prog_Lok73.Interval = 2000
            _eb.lokSteuern(73, Klassen.LokEigenschaften.Geschwindigkeit, 0)
        ElseIf _Prog73 = 1 Then
            If _Fahrzeugbeleuchtung2 > 0 Then
                _eb.lokSteuern(73, Klassen.LokEigenschaften.Hauptfunktion, 1) ' Licht ein
            Else
                _eb.lokSteuern(73, Klassen.LokEigenschaften.Hauptfunktion, 0) ' Licht aus
            End If
        ElseIf _Prog73 = 2 Then
            If _Motor > 0 Then
                _eb.lokSteuern(73, Klassen.LokEigenschaften.Funktion2, 1) ' Dampfgeräusch ein
            Else
                _eb.lokSteuern(73, Klassen.LokEigenschaften.Funktion2, 0) ' Dampfgeräusch aus
            End If
        ElseIf _Prog73 = 3 Then
            _Betriebsparameter.RundenErhoehen(73)
        ElseIf _Prog73 = 4 Then
        ElseIf _Prog73 = 5 Then
        ElseIf _Prog73 = 6 Then
            If _Dampf > 0 Then
                _eb.lokSteuern(73, Klassen.LokEigenschaften.Funktion1, 1) ' Dampf ein
            Else
                _eb.lokSteuern(73, Klassen.LokEigenschaften.Funktion1, 0) ' Dampf aus
            End If
        ElseIf _Prog73 = 7 Then
            If _Durchsagen = 1 And (_TypL73 = 1 Or _TypL73 = 3) Then
                PlayMusic("H:\\EB_Media\\Durchsagen\\Ansage Türen Mann.wav")
            Else
                _Prog73 = 9
            End If
        ElseIf _Prog73 = 8 Then
        ElseIf _Prog73 = 9 Then
            Prog_Lok73.Interval = 1000
        ElseIf _Prog73 = 10 Then
            If _AkustischeSignale > 0 Then
                _eb.lokSteuern(73, Klassen.LokEigenschaften.Funktion3, 1) ' Pfiff ein
            End If
        ElseIf _Prog73 = 11 Then
            _eb.lokSteuern(73, Klassen.LokEigenschaften.Funktion3, 0) ' Pfiff aus
        ElseIf _Prog73 = 12 Then
            Prog_Lok73.Interval = 2000

            ' Bahnhofsausfahrt

        ElseIf _Prog73 = 13 Then
            _eb.lokSteuern(73, Klassen.LokEigenschaften.Geschwindigkeit, Stufe1)
        ElseIf _Prog73 = 14 Then
            _eb.lokSteuern(73, Klassen.LokEigenschaften.Geschwindigkeit, Stufe11)
        ElseIf _Prog73 = 15 Then
            _eb.lokSteuern(73, Klassen.LokEigenschaften.Geschwindigkeit, Stufe12)
        ElseIf _Prog73 = 16 Then
            _eb.lokSteuern(73, Klassen.LokEigenschaften.Geschwindigkeit, Stufe13)
        ElseIf _Prog73 = 17 Then
            _eb.lokSteuern(73, Klassen.LokEigenschaften.Geschwindigkeit, Stufe14)
        ElseIf _Prog73 = 18 Then
            _eb.lokSteuern(73, Klassen.LokEigenschaften.Geschwindigkeit, Stufe3)
        ElseIf _Prog73 = 19 Then
        ElseIf _Prog73 = 20 Then
        ElseIf _Prog73 = 21 Then
        ElseIf _Prog73 = 22 Then
        ElseIf _Prog73 = 23 Then
            If _Dampf < 3 Then
                _eb.lokSteuern(73, Klassen.LokEigenschaften.Funktion1, 0) ' Dampf aus
            End If
        ElseIf _Prog73 = 24 Then
            If _Motor < 3 Then
                _eb.lokSteuern(73, Klassen.LokEigenschaften.Funktion2, 0) ' Dampfgeräusch aus
            End If


            ' Lok abstellen

        ElseIf _Prog73 = 50 Then
            Prog_Lok73.Interval = 2000
        ElseIf _Prog73 = 51 Then
            If _Dampf < 3 Then
                _eb.lokSteuern(73, Klassen.LokEigenschaften.Funktion1, 0) ' Dampf aus
            End If
        ElseIf _Prog73 = 52 Then
            If _Motor < 3 Then
                _eb.lokSteuern(73, Klassen.LokEigenschaften.Funktion2, 0) ' Dampfgeräusch aus
            End If
        ElseIf _Prog73 = 53 Then
            If _Fahrzeugbeleuchtung2 < 2 Then
                _eb.lokSteuern(73, Klassen.LokEigenschaften.Hauptfunktion, 0) ' Licht aus
            End If

            ' Lok bremsen (Bahnhofseinfahrt Normalzug von links und von rechts)

        ElseIf _Prog73 = 100 Then
            Prog_Lok73.Interval = V_100
            If _Motor > 0 Then
                _eb.lokSteuern(73, Klassen.LokEigenschaften.Funktion2, 1) ' Dampfgeräusch ein
            End If
        ElseIf _Prog73 = 101 Then
            _eb.lokSteuern(73, Klassen.LokEigenschaften.Geschwindigkeit, Stufe24)
            Prog_Lok73.Interval = T_100
        ElseIf _Prog73 = 102 Then
            _eb.lokSteuern(73, Klassen.LokEigenschaften.Geschwindigkeit, Stufe23)
        ElseIf _Prog73 = 103 Then
            _eb.lokSteuern(73, Klassen.LokEigenschaften.Geschwindigkeit, Stufe22)
        ElseIf _Prog73 = 104 Then
            _eb.lokSteuern(73, Klassen.LokEigenschaften.Geschwindigkeit, Stufe21)
        ElseIf _Prog73 = 105 Then
            _eb.lokSteuern(73, Klassen.LokEigenschaften.Geschwindigkeit, Stufe2)

            ' Lok bremsen (Bahnhofseinfahrt Kurzzug von links)

        ElseIf _Prog73 = 130 Then
            Prog_Lok73.Interval = V_130
        ElseIf _Prog73 = 131 Then
            Prog_Lok73.Interval = T_130
        ElseIf _Prog73 = 132 Then
            _eb.lokSteuern(73, Klassen.LokEigenschaften.Geschwindigkeit, Stufe24)
        ElseIf _Prog73 = 133 Then
            _eb.lokSteuern(73, Klassen.LokEigenschaften.Geschwindigkeit, Stufe23)
        ElseIf _Prog73 = 134 Then
            _eb.lokSteuern(73, Klassen.LokEigenschaften.Geschwindigkeit, Stufe22)
        ElseIf _Prog73 = 135 Then
            _eb.lokSteuern(73, Klassen.LokEigenschaften.Geschwindigkeit, Stufe21)
        ElseIf _Prog73 = 136 Then
            _eb.lokSteuern(73, Klassen.LokEigenschaften.Geschwindigkeit, Stufe2)
        ElseIf _Prog73 = 137 Then
            _eb.lokSteuern(73, Klassen.LokEigenschaften.Geschwindigkeit, 0)
        ElseIf _Prog73 = 138 Then
            Prog_Lok73.Interval = 2000
            If _Dampf < 3 Then
                _eb.lokSteuern(73, Klassen.LokEigenschaften.Funktion1, 0) ' Dampf aus
            End If
        ElseIf _Prog73 = 139 Then
            If _Motor < 3 Then
                _eb.lokSteuern(73, Klassen.LokEigenschaften.Funktion2, 0) ' Dampfgeräusch aus
            End If
        ElseIf _Prog73 = 140 Then
            If _Fahrzeugbeleuchtung2 < 2 Then
                _eb.lokSteuern(73, Klassen.LokEigenschaften.Hauptfunktion, 0) ' Licht aus
            End If

            ' Lok bremsen (Bahnhofseinfahrt Kurzzug von rechts)

        ElseIf _Prog73 = 160 Then
            Prog_Lok73.Interval = V_160
        ElseIf _Prog73 = 161 Then
            Prog_Lok73.Interval = T_160
        ElseIf _Prog73 = 162 Then
            _eb.lokSteuern(73, Klassen.LokEigenschaften.Geschwindigkeit, Stufe24)
        ElseIf _Prog73 = 163 Then
            _eb.lokSteuern(73, Klassen.LokEigenschaften.Geschwindigkeit, Stufe23)
        ElseIf _Prog73 = 164 Then
            _eb.lokSteuern(73, Klassen.LokEigenschaften.Geschwindigkeit, Stufe22)
        ElseIf _Prog73 = 165 Then
            _eb.lokSteuern(73, Klassen.LokEigenschaften.Geschwindigkeit, Stufe21)
        ElseIf _Prog73 = 166 Then
            _eb.lokSteuern(73, Klassen.LokEigenschaften.Geschwindigkeit, Stufe2)
        ElseIf _Prog73 = 167 Then
            _eb.lokSteuern(73, Klassen.LokEigenschaften.Geschwindigkeit, 0)
        ElseIf _Prog73 = 168 Then
            Prog_Lok73.Interval = 2000
            If _Dampf < 3 Then
                _eb.lokSteuern(73, Klassen.LokEigenschaften.Funktion1, 0) ' Dampf aus
            End If
        ElseIf _Prog73 = 169 Then
            If _Motor < 3 Then
                _eb.lokSteuern(73, Klassen.LokEigenschaften.Funktion2, 0) ' Dampfgeräusch aus
            End If
        ElseIf _Prog73 = 170 Then
            If _Fahrzeugbeleuchtung2 < 2 Then
                _eb.lokSteuern(73, Klassen.LokEigenschaften.Hauptfunktion, 0) ' Licht aus
            End If

            ' Rangierzug

        ElseIf _Prog73 = 180 Then
            _eb.lokSteuern(73, Klassen.LokEigenschaften.Geschwindigkeit, 2)
            Prog_Lok73.Interval = V_180
        ElseIf _Prog73 = 181 Then
            Prog_Lok73.Interval = T_180
            _eb.lokSteuern(73, Klassen.LokEigenschaften.Geschwindigkeit, 1)
        ElseIf _Prog73 = 182 Then
            _eb.lokSteuern(73, Klassen.LokEigenschaften.Geschwindigkeit, 0)

            ' Tunnelausfahrt

        ElseIf _Prog73 = 200 Then ' Kontakt 1.2 <- (bergauf)
            _eb.lokSteuern(73, Klassen.LokEigenschaften.Geschwindigkeit, G_200)
        ElseIf _Prog73 = 201 Then
            Prog_Lok73.Interval = 2000
        ElseIf _Prog73 = 202 Then
        ElseIf _Prog73 = 203 Then
        ElseIf _Prog73 = 204 Then
        ElseIf _Prog73 = 205 Then
        ElseIf _Prog73 = 206 Then
            If Stufe4 < Stufe3 Then
                _eb.lokSteuern(73, Klassen.LokEigenschaften.Geschwindigkeit, Stufe3)
            Else
                _eb.lokSteuern(73, Klassen.LokEigenschaften.Geschwindigkeit, Stufe4)
            End If
        ElseIf _Prog73 = 207 Then
            If _Dampf > 1 Then
                _eb.lokSteuern(73, Klassen.LokEigenschaften.Funktion1, 1) ' Dampf ein
            End If
        ElseIf _Prog73 = 208 Then
        ElseIf _Prog73 = 209 Then
            If _Motor > 1 Then
                _eb.lokSteuern(73, Klassen.LokEigenschaften.Funktion2, 1) ' Dampfgeräusch ein
            End If
        ElseIf _Prog73 = 210 Then
            If _AkustischeSignale > 1 Then
                _eb.lokSteuern(73, Klassen.LokEigenschaften.Funktion3, 1) ' Pfiff ein
            End If
        ElseIf _Prog73 = 211 Then
            _eb.lokSteuern(73, Klassen.LokEigenschaften.Funktion3, 0) ' Pfiff aus

        ElseIf _Prog73 = 220 Then ' Kontakt 3.1 -> (hinter dem Martinstor bergauf)
            Prog_Lok73.Interval = 4000
        ElseIf _Prog73 = 221 Then
        ElseIf _Prog73 = 222 Then
        ElseIf _Prog73 = 223 Then
            If _Dampf < 3 Then
                _eb.lokSteuern(73, Klassen.LokEigenschaften.Funktion1, 0) ' Dampf aus
            End If
        ElseIf _Prog73 = 224 Then
        ElseIf _Prog73 = 225 Then
            If _Motor < 3 Then
                _eb.lokSteuern(73, Klassen.LokEigenschaften.Funktion2, 0) ' Dampfgeräusch aus
            End If

        ElseIf _Prog73 = 240 Then ' Kontakt 3.7 <- (hinter der Brücke bergauf)
            Prog_Lok73.Interval = 3000
        ElseIf _Prog73 = 241 Then
            If _Dampf > 1 Then
                _eb.lokSteuern(73, Klassen.LokEigenschaften.Funktion1, 1) ' Dampf ein
            End If
        ElseIf _Prog73 = 242 Then
            Prog_Lok73.Interval = 1000
        ElseIf _Prog73 = 243 Then
            If _Motor > 1 Then
                _eb.lokSteuern(73, Klassen.LokEigenschaften.Funktion2, 1) ' Dampfgeräusch ein
            End If
        ElseIf _Prog73 = 244 Then
            If _AkustischeSignale > 1 Then
                _eb.lokSteuern(73, Klassen.LokEigenschaften.Funktion3, 1) ' Pfiff ein
            End If
        ElseIf _Prog73 = 245 Then
            _eb.lokSteuern(73, Klassen.LokEigenschaften.Funktion3, 0) ' Pfiff aus
        ElseIf _Prog73 = 246 Then
        ElseIf _Prog73 = 247 Then
            If _Motor < 3 Then
                _eb.lokSteuern(73, Klassen.LokEigenschaften.Funktion2, 0) ' Dampfgeräusch aus
            ElseIf _Prog73 = 248 Then
                If _Dampf < 3 Then
                    _eb.lokSteuern(73, Klassen.LokEigenschaften.Funktion1, 0) ' Dampf aus
                End If
            End If

        ElseIf _Prog73 = 260 Then ' Kontakt 3.3 (links bzw vor der Brücke)
            Prog_Lok73.Interval = 2000
        ElseIf _Prog73 = 261 Then
        ElseIf _Prog73 = 262 Then
            _eb.lokSteuern(73, Klassen.LokEigenschaften.Geschwindigkeit, Stufe3)

        ElseIf _Prog73 = 600 Then ' Kontakt 3.5 <- (unter der Burg)
            Prog_Lok73.Interval = 1000
        ElseIf _Prog73 = 601 Then
            If _AkustischeSignale > 1 Then
                _eb.lokSteuern(73, Klassen.LokEigenschaften.Funktion3, 1) ' Pfiff ein
            End If
        ElseIf _Prog73 = 602 Then
            _eb.lokSteuern(73, Klassen.LokEigenschaften.Funktion3, 0) ' Pfiff aus
        ElseIf _Prog73 = 603 Then

        ElseIf _Prog73 = 620 Then ' Kontakt 3.7 -> (hinter der Brücke bergab)
            Prog_Lok73.Interval = 3000
        ElseIf _Prog73 = 621 Then
            Prog_Lok73.Interval = 1000
        ElseIf _Prog73 = 622 Then
            If _AkustischeSignale > 1 Then
                _eb.lokSteuern(73, Klassen.LokEigenschaften.Funktion3, 1) ' Pfiff ein
            End If
        ElseIf _Prog73 = 623 Then
            _eb.lokSteuern(73, Klassen.LokEigenschaften.Funktion3, 0) ' Pfiff aus

        ElseIf _Prog73 = 640 Then ' Kontakt 3.1 <- Talfahrt
            Prog_Lok73.Interval = 2000
        ElseIf _Prog73 = 641 Then
        ElseIf _Prog73 = 642 Then


        ElseIf _Prog73 = 660 Then ' Kontakt 1.2 -> Talfahrt
            Prog_Lok73.Interval = 2000
        ElseIf _Prog73 = 661 Then
        ElseIf _Prog73 = 662 Then
        ElseIf _Prog73 = 663 Then
        ElseIf _Prog73 = 664 Then
            If _GlsL73 = 1 Or _GlsL73 = 2 Then
                If _Motor > 1 Then
                    _eb.lokSteuern(73, Klassen.LokEigenschaften.Funktion2, 1) ' Dampfgeräusch ein
                End If
            End If
        ElseIf _Prog73 = 665 Then
            If _GlsL73 = 1 Or _GlsL73 = 2 Then
                If _AkustischeSignale > 1 Then
                    _eb.lokSteuern(73, Klassen.LokEigenschaften.Funktion3, 1) ' Pfiff ein
                End If
            End If
        ElseIf _Prog73 = 667 Then
            _eb.lokSteuern(73, Klassen.LokEigenschaften.Funktion3, 0) ' Pfiff aus

        ElseIf _Prog73 = 700 Then ' Kontakt 0.4 <- Diagonale
            Prog_Lok73.Interval = 2000
        ElseIf _Prog73 = 701 Then
        ElseIf _Prog73 = 702 Then
        ElseIf _Prog73 = 703 Then
        ElseIf _Prog73 = 704 Then
            If _Motor > 0 Then
                _eb.lokSteuern(73, Klassen.LokEigenschaften.Funktion2, 1) ' Dampfgeräusch ein
            End If
        ElseIf _Prog73 = 705 Then
            Prog_Lok73.Interval = 1000
        ElseIf _Prog73 = 706 Then
            If _AkustischeSignale > 0 Then
                _eb.lokSteuern(73, Klassen.LokEigenschaften.Funktion3, 1) ' Pfiff ein
            End If
        ElseIf _Prog73 = 707 Then
            _eb.lokSteuern(73, Klassen.LokEigenschaften.Funktion3, 0) ' Pfiff aus
        ElseIf _Prog73 = 708 Then
            Prog_Lok73.Interval = 2000

            ' Zindelstein

        ElseIf _Prog73 = 500 Then
            Prog_Lok73.Interval = V_500
        ElseIf _Prog73 = 501 Then
            _eb.lokSteuern(73, Klassen.LokEigenschaften.Geschwindigkeit, Stufe23)
            Prog_Lok73.Interval = T_500
        ElseIf _Prog73 = 502 Then
            _eb.lokSteuern(73, Klassen.LokEigenschaften.Geschwindigkeit, Stufe22)
        ElseIf _Prog73 = 503 Then
            _eb.lokSteuern(73, Klassen.LokEigenschaften.Geschwindigkeit, Stufe21)
        ElseIf _Prog73 = 504 Then
            _eb.lokSteuern(73, Klassen.LokEigenschaften.Geschwindigkeit, Stufe2)
        ElseIf _Prog73 = 505 Then
            _eb.lokSteuern(73, Klassen.LokEigenschaften.Geschwindigkeit, 0)


        Else
            _Prog73 = 0
            Prog_Lok73.Stop()
            Prog_Lok73.Interval = 200
            If Betriebsart = 1 Then
                SetProgramCounterLabel1(String.Empty)
            Else
                SetProgramCounterLabel(String.Empty)
            End If
        End If
        _Prog73 = _Prog73 + 1

    End Sub
    Private Sub HandleTimerElapsed86(sender As System.Object, e As System.EventArgs) Handles Prog_Lok74.Elapsed

        '*** Fahrprogramm für Dampflok Baureihe 23
        '*** Datum: 23.02.2020

        SetText(TextBox1, "Dampflok Baureihe 23                                                    IBS: nein")
        LoadImage(PictureBox1, "H:\\EB_Media\\LokFotos\\Baureihe_023_01.jpg")
        GeschwindikeitenSetzen(74)

        Dim Stufe1, Stufe2, Stufe3, Stufe4 As Integer
        Dim Stufe11, Stufe12, Stufe13, Stufe14, Stufe21, Stufe22, Stufe23, Stufe24 As Integer
        Dim V_100, V_130, V_160, V_180, V_500 As Integer
        Dim T_100, T_130, T_160, T_180, T_500 As Integer
        Dim G_200 As Integer

        T_100 = _Betriebsparameter.Fahrparameter(74, KlausEBspecific.Betriebsparameter.FahrparameterEnum.T_100)
        T_130 = _Betriebsparameter.Fahrparameter(74, KlausEBspecific.Betriebsparameter.FahrparameterEnum.T_130)
        T_160 = _Betriebsparameter.Fahrparameter(74, KlausEBspecific.Betriebsparameter.FahrparameterEnum.T_160)
        T_180 = _Betriebsparameter.Fahrparameter(74, KlausEBspecific.Betriebsparameter.FahrparameterEnum.T_180)
        T_500 = _Betriebsparameter.Fahrparameter(74, KlausEBspecific.Betriebsparameter.FahrparameterEnum.T_500)
        V_100 = _Betriebsparameter.Fahrparameter(74, KlausEBspecific.Betriebsparameter.FahrparameterEnum.V_100)
        V_130 = _Betriebsparameter.Fahrparameter(74, KlausEBspecific.Betriebsparameter.FahrparameterEnum.V_130)
        V_160 = _Betriebsparameter.Fahrparameter(74, KlausEBspecific.Betriebsparameter.FahrparameterEnum.V_160)
        V_180 = _Betriebsparameter.Fahrparameter(74, KlausEBspecific.Betriebsparameter.FahrparameterEnum.V_180)
        V_500 = _Betriebsparameter.Fahrparameter(74, KlausEBspecific.Betriebsparameter.FahrparameterEnum.V_500)
        G_200 = _Betriebsparameter.Fahrparameter(74, KlausEBspecific.Betriebsparameter.FahrparameterEnum.G_200)

        If A_StopB = 1 Then
            V_100 = 8000
        End If

        Stufe1 = _LokStufen.Holen(74, 1)
        Stufe2 = _LokStufen.Holen(74, 2)
        Stufe3 = _LokStufen.Holen(74, 3)
        Stufe4 = _LokStufen.Holen(74, 4)

        If Stufe2 = 1 Then
            T_100 = T_100
            T_130 = T_130
            T_160 = T_160
            V_180 = V_180
        ElseIf Stufe2 = 2 Then
            T_100 = T_100 + 300
            T_130 = T_130 + 300
            T_160 = T_160 + 300
            V_180 = V_180 + 500
        ElseIf Stufe2 = 3 Then
            T_100 = T_100 + 500
            T_130 = T_130 + 500
            T_160 = T_160 + 500
            V_180 = V_180 + 1000
        ElseIf Stufe2 = 4 Then
            T_100 = T_100 + 700
            T_130 = T_130 + 700
            T_160 = T_160 + 700
            V_180 = V_180 + 1500
        ElseIf Stufe2 = 5 Then
            T_100 = T_100 + 900
            T_130 = T_130 + 900
            T_160 = T_160 + 900
            V_180 = V_180 + 2000
        ElseIf Stufe2 = 6 Then
            T_100 = T_100 + 1200
            T_130 = T_130 + 1200
            T_160 = T_160 + 1200
            V_180 = V_180 + 2500
        Else
            T_100 = T_100 + 1200
            T_130 = T_130 + 1200
            T_160 = T_160 + 1200
            V_180 = V_180 + 2500
        End If

        Stufe2 = Stufe1

        Stufe11 = Stufe1 + 1
        If Stufe11 > Stufe3 Then
            Stufe11 = Stufe3
        End If
        Stufe12 = Stufe1 + 2
        If Stufe12 > Stufe3 Then
            Stufe12 = Stufe3
        End If
        Stufe13 = Stufe1 + 3
        If Stufe13 > Stufe3 Then
            Stufe13 = Stufe3
        End If
        Stufe14 = Stufe1 + 4
        If Stufe14 > Stufe3 Then
            Stufe14 = Stufe3
        End If

        Stufe21 = Stufe2 + 1
        If Stufe21 > Stufe3 Then
            Stufe21 = Stufe3
        End If
        Stufe22 = Stufe2 + 2
        If Stufe22 > Stufe3 Then
            Stufe22 = Stufe3
        End If
        Stufe23 = Stufe2 + 3
        If Stufe23 > Stufe3 Then
            Stufe23 = Stufe3
        End If
        Stufe24 = Stufe2 + 4
        If Stufe24 > Stufe3 Then
            Stufe24 = Stufe3
        End If
        If G_200 > 0 Then
            If G_200 < Stufe4 Then
                G_200 = Stufe4
            End If
        Else
            G_200 = Stufe4
        End If

        If Betriebsart = 1 And (_GlsL74 = 3 Or _GlsL74 = 4) Then
            SetProgramCounterLabel1(_Prog74)
        Else
            SetProgramCounterLabel(_Prog74)
        End If

        ' Lok starten - Bahnhofsausfahrt

        If _Prog74 = 0 Then
            Prog_Lok74.Interval = 2000
        ElseIf _Prog74 = 1 Then
        ElseIf _Prog74 = 2 Then
            _Betriebsparameter.RundenErhoehen(74)
        ElseIf _Prog74 = 3 Then
        ElseIf _Prog74 = 4 Then
        ElseIf _Prog74 = 5 Then
        ElseIf _Prog74 = 6 Then

            ' Bahnhofsausfahrt

        ElseIf _Prog74 = 7 Then
            _eb.lokSteuern(74, Klassen.LokEigenschaften.Geschwindigkeit, Stufe1)
        ElseIf _Prog74 = 8 Then
            _eb.lokSteuern(74, Klassen.LokEigenschaften.Geschwindigkeit, Stufe11)
        ElseIf _Prog74 = 9 Then
            _eb.lokSteuern(74, Klassen.LokEigenschaften.Geschwindigkeit, Stufe12)
        ElseIf _Prog74 = 10 Then
            _eb.lokSteuern(74, Klassen.LokEigenschaften.Geschwindigkeit, Stufe13)
        ElseIf _Prog74 = 11 Then
            _eb.lokSteuern(74, Klassen.LokEigenschaften.Geschwindigkeit, Stufe14)
        ElseIf _Prog74 = 12 Then
            _eb.lokSteuern(74, Klassen.LokEigenschaften.Geschwindigkeit, Stufe3)

            ' Lok abstellen

        ElseIf _Prog74 = 50 Then
            Prog_Lok74.Interval = 2000
        ElseIf _Prog74 = 51 Then
        ElseIf _Prog74 = 52 Then
            If _Fahrzeugbeleuchtung2 < 2 Then
                _eb.lokSteuern(74, Klassen.LokEigenschaften.Hauptfunktion, 0) ' Licht aus
            End If

            ' Lok bremsen (Bahnhofseinfahrt Normalzug von links und von rechts)

        ElseIf _Prog74 = 100 Then
            Prog_Lok74.Interval = V_100
        ElseIf _Prog74 = 101 Then
            _eb.lokSteuern(74, Klassen.LokEigenschaften.Geschwindigkeit, Stufe24)
            Prog_Lok74.Interval = T_100
        ElseIf _Prog74 = 102 Then
            _eb.lokSteuern(74, Klassen.LokEigenschaften.Geschwindigkeit, Stufe23)
        ElseIf _Prog74 = 103 Then
            _eb.lokSteuern(74, Klassen.LokEigenschaften.Geschwindigkeit, Stufe22)
        ElseIf _Prog74 = 104 Then
            _eb.lokSteuern(74, Klassen.LokEigenschaften.Geschwindigkeit, Stufe21)
        ElseIf _Prog74 = 105 Then
            _eb.lokSteuern(74, Klassen.LokEigenschaften.Geschwindigkeit, Stufe2)

            ' Lok bremsen (Bahnhofseinfahrt Kurzzug von links)

        ElseIf _Prog74 = 130 Then
            Prog_Lok74.Interval = V_130
        ElseIf _Prog74 = 131 Then
            _eb.lokSteuern(74, Klassen.LokEigenschaften.Geschwindigkeit, Stufe24)
            Prog_Lok74.Interval = T_130
        ElseIf _Prog74 = 132 Then
            _eb.lokSteuern(74, Klassen.LokEigenschaften.Geschwindigkeit, Stufe23)
        ElseIf _Prog74 = 133 Then
            _eb.lokSteuern(74, Klassen.LokEigenschaften.Geschwindigkeit, Stufe22)
        ElseIf _Prog74 = 134 Then
            _eb.lokSteuern(74, Klassen.LokEigenschaften.Geschwindigkeit, Stufe21)
        ElseIf _Prog74 = 135 Then
            _eb.lokSteuern(64, Klassen.LokEigenschaften.Geschwindigkeit, Stufe2)
        ElseIf _Prog74 = 136 Then
            _eb.lokSteuern(74, Klassen.LokEigenschaften.Geschwindigkeit, 0)
        ElseIf _Prog74 = 137 Then
            Prog_Lok74.Interval = 2000
        ElseIf _Prog74 = 138 Then
            If _Fahrzeugbeleuchtung2 < 2 Then
                _eb.lokSteuern(74, Klassen.LokEigenschaften.Hauptfunktion, 0) ' Licht aus
            End If

            ' Lok bremsen (Bahnhofseinfahrt Kurzzug von rechts)

        ElseIf _Prog74 = 160 Then
            Prog_Lok74.Interval = V_160
        ElseIf _Prog74 = 161 Then
            _eb.lokSteuern(74, Klassen.LokEigenschaften.Geschwindigkeit, Stufe24)
            Prog_Lok74.Interval = T_160
        ElseIf _Prog74 = 162 Then
            _eb.lokSteuern(74, Klassen.LokEigenschaften.Geschwindigkeit, Stufe23)
        ElseIf _Prog74 = 163 Then
            _eb.lokSteuern(74, Klassen.LokEigenschaften.Geschwindigkeit, Stufe22)
        ElseIf _Prog74 = 164 Then
            _eb.lokSteuern(74, Klassen.LokEigenschaften.Geschwindigkeit, Stufe21)
        ElseIf _Prog74 = 165 Then
            _eb.lokSteuern(74, Klassen.LokEigenschaften.Geschwindigkeit, Stufe2)
        ElseIf _Prog74 = 166 Then
            _eb.lokSteuern(74, Klassen.LokEigenschaften.Geschwindigkeit, 0)
        ElseIf _Prog74 = 167 Then
            Prog_Lok74.Interval = 2000
        ElseIf _Prog74 = 168 Then
            If _Fahrzeugbeleuchtung2 < 2 Then
                _eb.lokSteuern(74, Klassen.LokEigenschaften.Hauptfunktion, 0) ' Licht aus
            End If

            ' Rangierzug

        ElseIf _Prog74 = 180 Then
            _eb.lokSteuern(74, Klassen.LokEigenschaften.Geschwindigkeit, 2)
            Prog_Lok74.Interval = V_180
        ElseIf _Prog74 = 181 Then
            Prog_Lok74.Interval = T_180
            _eb.lokSteuern(74, Klassen.LokEigenschaften.Geschwindigkeit, 1)
        ElseIf _Prog74 = 182 Then
            _eb.lokSteuern(74, Klassen.LokEigenschaften.Geschwindigkeit, 0)

            ' Tunnelausfahrt

        ElseIf _Prog74 = 200 Then ' Kontakt 1.2 <- (bergauf)
            _eb.lokSteuern(74, Klassen.LokEigenschaften.Geschwindigkeit, G_200)
            Prog_Lok74.Interval = 2000
        ElseIf _Prog74 = 201 Then
        ElseIf _Prog74 = 202 Then
        ElseIf _Prog74 = 203 Then
        ElseIf _Prog74 = 204 Then
        ElseIf _Prog74 = 205 Then
            If Stufe4 < Stufe3 Then
                _eb.lokSteuern(74, Klassen.LokEigenschaften.Geschwindigkeit, Stufe3)
            Else
                _eb.lokSteuern(74, Klassen.LokEigenschaften.Geschwindigkeit, Stufe4)
            End If

        ElseIf _Prog74 = 220 Then ' Kontakt 3.1 -> (hinter dem Martinstor bergauf)
            Prog_Lok74.Interval = 2000
        ElseIf _Prog74 = 221 Then
        ElseIf _Prog74 = 222 Then

        ElseIf _Prog74 = 240 Then ' Kontakt 3.7 <- (hinter der Brücke bergauf)
            Prog_Lok74.Interval = 2000
        ElseIf _Prog74 = 241 Then
        ElseIf _Prog74 = 242 Then

        ElseIf _Prog74 = 260 Then ' Kontakt 3.3 (links bzw vor der Brücke)
            Prog_Lok74.Interval = 2000
        ElseIf _Prog74 = 261 Then
        ElseIf _Prog74 = 262 Then
            _eb.lokSteuern(74, Klassen.LokEigenschaften.Geschwindigkeit, Stufe3)


        ElseIf _Prog74 = 600 Then ' Kontakt 3.5 <- (unter der Burg)
            Prog_Lok74.Interval = 2000
        ElseIf _Prog74 = 601 Then
        ElseIf _Prog74 = 602 Then

        ElseIf _Prog74 = 620 Then ' Kontakt 3.7 -> (hinter der Brücke bergab)
            Prog_Lok74.Interval = 2000
        ElseIf _Prog74 = 621 Then
        ElseIf _Prog74 = 622 Then

        ElseIf _Prog74 = 640 Then ' Kontakt 3.1 <- Talfahrt
            Prog_Lok74.Interval = 2000
        ElseIf _Prog74 = 641 Then
        ElseIf _Prog74 = 642 Then

        ElseIf _Prog74 = 660 Then ' Kontakt 1.2 -> Talfahrt
            Prog_Lok74.Interval = 2000
        ElseIf _Prog74 = 661 Then
        ElseIf _Prog74 = 662 Then

        ElseIf _Prog74 = 700 Then ' Kontakt 0.4 <- Diagonale
            Prog_Lok74.Interval = 2000
        ElseIf _Prog74 = 701 Then
        ElseIf _Prog74 = 702 Then

            ' Zindelstein

        ElseIf _Prog74 = 500 Then
            Prog_Lok74.Interval = V_500
        ElseIf _Prog74 = 501 Then
            _eb.lokSteuern(74, Klassen.LokEigenschaften.Geschwindigkeit, Stufe23)
            Prog_Lok74.Interval = T_500
        ElseIf _Prog74 = 502 Then
            _eb.lokSteuern(74, Klassen.LokEigenschaften.Geschwindigkeit, Stufe22)
        ElseIf _Prog74 = 503 Then
            _eb.lokSteuern(74, Klassen.LokEigenschaften.Geschwindigkeit, Stufe21)
        ElseIf _Prog74 = 504 Then
            _eb.lokSteuern(74, Klassen.LokEigenschaften.Geschwindigkeit, Stufe2)
        ElseIf _Prog74 = 505 Then
            _eb.lokSteuern(74, Klassen.LokEigenschaften.Geschwindigkeit, 0)

        Else
            _Prog74 = 0
            Prog_Lok74.Stop()
            Prog_Lok74.Interval = 200
            If Betriebsart = 1 Then
                SetProgramCounterLabel1(String.Empty)
            Else
                SetProgramCounterLabel(String.Empty)
            End If
        End If
        _Prog74 = _Prog74 + 1

    End Sub
    Private Sub HandleTimerElapsed87(sender As System.Object, e As System.EventArgs) Handles Prog_Lok75.Elapsed

        '*** Fahrprogramm für Dampflok 24 058
        '*** Datum: 23.02.2020

        SetText(TextBox1, "Dampflok 24 058                                                         IBS: 08.10.2025 - V3 : 10")
        LoadImage(PictureBox1, "H:\\EB_Media\\LokFotos\\Baureihe_24_01.jpg")
        GeschwindikeitenSetzen(75)

        Dim Stufe1, Stufe2, Stufe3, Stufe4 As Integer
        Dim Stufe11, Stufe12, Stufe13, Stufe14, Stufe21, Stufe22, Stufe23, Stufe24 As Integer
        Dim V_100, V_130, V_160, V_180, V_500 As Integer
        Dim T_100, T_130, T_160, T_180, T_500 As Integer
        Dim G_200 As Integer

        T_100 = _Betriebsparameter.Fahrparameter(75, KlausEBspecific.Betriebsparameter.FahrparameterEnum.T_100)
        T_130 = _Betriebsparameter.Fahrparameter(75, KlausEBspecific.Betriebsparameter.FahrparameterEnum.T_130)
        T_160 = _Betriebsparameter.Fahrparameter(75, KlausEBspecific.Betriebsparameter.FahrparameterEnum.T_160)
        T_180 = _Betriebsparameter.Fahrparameter(75, KlausEBspecific.Betriebsparameter.FahrparameterEnum.T_180)
        T_500 = _Betriebsparameter.Fahrparameter(75, KlausEBspecific.Betriebsparameter.FahrparameterEnum.T_500)
        V_100 = _Betriebsparameter.Fahrparameter(75, KlausEBspecific.Betriebsparameter.FahrparameterEnum.V_100)
        V_130 = _Betriebsparameter.Fahrparameter(75, KlausEBspecific.Betriebsparameter.FahrparameterEnum.V_130)
        V_160 = _Betriebsparameter.Fahrparameter(75, KlausEBspecific.Betriebsparameter.FahrparameterEnum.V_160)
        V_180 = _Betriebsparameter.Fahrparameter(75, KlausEBspecific.Betriebsparameter.FahrparameterEnum.V_180)
        V_500 = _Betriebsparameter.Fahrparameter(75, KlausEBspecific.Betriebsparameter.FahrparameterEnum.V_500)
        G_200 = _Betriebsparameter.Fahrparameter(75, KlausEBspecific.Betriebsparameter.FahrparameterEnum.G_200)

        If A_StopB = 1 Then
            V_100 = 8000
        End If

        Stufe1 = _LokStufen.Holen(75, 1)
        Stufe2 = _LokStufen.Holen(75, 2)
        Stufe3 = _LokStufen.Holen(75, 3)
        Stufe4 = _LokStufen.Holen(75, 4)

        If Stufe2 = 1 Then
            T_100 = T_100
            T_130 = T_130
            T_160 = T_160
            V_180 = V_180
        ElseIf Stufe2 = 2 Then
            T_100 = T_100 + 300
            T_130 = T_130 + 300
            T_160 = T_160 + 300
            V_180 = V_180 + 500
        ElseIf Stufe2 = 3 Then
            T_100 = T_100 + 500
            T_130 = T_130 + 500
            T_160 = T_160 + 500
            V_180 = V_180 + 1000
        ElseIf Stufe2 = 4 Then
            T_100 = T_100 + 700
            T_130 = T_130 + 700
            T_160 = T_160 + 700
            V_180 = V_180 + 1500
        ElseIf Stufe2 = 5 Then
            T_100 = T_100 + 900
            T_130 = T_130 + 900
            T_160 = T_160 + 900
            V_180 = V_180 + 2000
        ElseIf Stufe2 = 6 Then
            T_100 = T_100 + 1200
            T_130 = T_130 + 1200
            T_160 = T_160 + 1200
            V_180 = V_180 + 2500
        Else
            T_100 = T_100 + 1200
            T_130 = T_130 + 1200
            T_160 = T_160 + 1200
            V_180 = V_180 + 2500
        End If

        Stufe2 = Stufe1

        Stufe11 = Stufe1 + 1
        If Stufe11 > Stufe3 Then
            Stufe11 = Stufe3
        End If
        Stufe12 = Stufe1 + 2
        If Stufe12 > Stufe3 Then
            Stufe12 = Stufe3
        End If
        Stufe13 = Stufe1 + 3
        If Stufe13 > Stufe3 Then
            Stufe13 = Stufe3
        End If
        Stufe14 = Stufe1 + 4
        If Stufe14 > Stufe3 Then
            Stufe14 = Stufe3
        End If

        Stufe21 = Stufe2 + 1
        If Stufe21 > Stufe3 Then
            Stufe21 = Stufe3
        End If
        Stufe22 = Stufe2 + 2
        If Stufe22 > Stufe3 Then
            Stufe22 = Stufe3
        End If
        Stufe23 = Stufe2 + 3
        If Stufe23 > Stufe3 Then
            Stufe23 = Stufe3
        End If
        Stufe24 = Stufe2 + 4
        If Stufe24 > Stufe3 Then
            Stufe24 = Stufe3
        End If
        If G_200 > 0 Then
            If G_200 < Stufe4 Then
                G_200 = Stufe4
            End If
        Else
            G_200 = Stufe4
        End If

        If Betriebsart = 1 And (_GlsL75 = 3 Or _GlsL75 = 4) Then
            SetProgramCounterLabel1(_Prog75)
        Else
            SetProgramCounterLabel(_Prog75)
        End If

        ' Lok starten - Bahnhofsausfahrt

        If _Prog75 = 0 Then
            Prog_Lok75.Interval = 2000
        ElseIf _Prog75 = 1 Then
        ElseIf _Prog75 = 2 Then
            _Betriebsparameter.RundenErhoehen(75)
        ElseIf _Prog75 = 3 Then
        ElseIf _Prog75 = 4 Then
        ElseIf _Prog75 = 5 Then
        ElseIf _Prog75 = 6 Then

            ' Bahnhofsausfahrt

        ElseIf _Prog75 = 7 Then
            _eb.lokSteuern(75, Klassen.LokEigenschaften.Geschwindigkeit, Stufe1)
        ElseIf _Prog75 = 8 Then
            _eb.lokSteuern(75, Klassen.LokEigenschaften.Geschwindigkeit, Stufe11)
        ElseIf _Prog75 = 9 Then
            _eb.lokSteuern(75, Klassen.LokEigenschaften.Geschwindigkeit, Stufe12)
        ElseIf _Prog75 = 10 Then
            _eb.lokSteuern(75, Klassen.LokEigenschaften.Geschwindigkeit, Stufe13)
        ElseIf _Prog75 = 11 Then
            _eb.lokSteuern(75, Klassen.LokEigenschaften.Geschwindigkeit, Stufe14)
        ElseIf _Prog75 = 12 Then
            _eb.lokSteuern(75, Klassen.LokEigenschaften.Geschwindigkeit, Stufe3)

            ' Lok abstellen

        ElseIf _Prog75 = 50 Then
            Prog_Lok75.Interval = 2000
        ElseIf _Prog75 = 51 Then
        ElseIf _Prog75 = 52 Then
            If _Fahrzeugbeleuchtung2 < 2 Then
                _eb.lokSteuern(75, Klassen.LokEigenschaften.Hauptfunktion, 0) ' Licht aus
            End If

            ' Lok bremsen (Bahnhofseinfahrt Normalzug von links und von rechts)

        ElseIf _Prog75 = 100 Then
            Prog_Lok75.Interval = V_100
        ElseIf _Prog75 = 101 Then
            _eb.lokSteuern(75, Klassen.LokEigenschaften.Geschwindigkeit, Stufe24)
            Prog_Lok75.Interval = T_100
        ElseIf _Prog75 = 102 Then
            _eb.lokSteuern(75, Klassen.LokEigenschaften.Geschwindigkeit, Stufe23)
        ElseIf _Prog75 = 103 Then
            _eb.lokSteuern(75, Klassen.LokEigenschaften.Geschwindigkeit, Stufe22)
        ElseIf _Prog75 = 104 Then
            _eb.lokSteuern(75, Klassen.LokEigenschaften.Geschwindigkeit, Stufe21)
        ElseIf _Prog75 = 105 Then
            _eb.lokSteuern(75, Klassen.LokEigenschaften.Geschwindigkeit, Stufe2)

            ' Lok bremsen (Bahnhofseinfahrt Kurzzug von links)

        ElseIf _Prog75 = 130 Then
            Prog_Lok75.Interval = V_130
        ElseIf _Prog75 = 131 Then
            _eb.lokSteuern(75, Klassen.LokEigenschaften.Geschwindigkeit, Stufe24)
            Prog_Lok75.Interval = T_130
        ElseIf _Prog75 = 132 Then
            _eb.lokSteuern(75, Klassen.LokEigenschaften.Geschwindigkeit, Stufe23)
        ElseIf _Prog75 = 133 Then
            _eb.lokSteuern(75, Klassen.LokEigenschaften.Geschwindigkeit, Stufe22)
        ElseIf _Prog75 = 134 Then
            _eb.lokSteuern(75, Klassen.LokEigenschaften.Geschwindigkeit, Stufe21)
        ElseIf _Prog75 = 135 Then
            _eb.lokSteuern(75, Klassen.LokEigenschaften.Geschwindigkeit, Stufe2)
        ElseIf _Prog75 = 136 Then
            _eb.lokSteuern(75, Klassen.LokEigenschaften.Geschwindigkeit, 0)
        ElseIf _Prog75 = 137 Then
            Prog_Lok75.Interval = 2000
        ElseIf _Prog75 = 138 Then
            If _Fahrzeugbeleuchtung2 < 2 Then
                _eb.lokSteuern(75, Klassen.LokEigenschaften.Hauptfunktion, 0) ' Licht aus
            End If

            ' Lok bremsen (Bahnhofseinfahrt Kurzzug von rechts)

        ElseIf _Prog75 = 160 Then
            Prog_Lok75.Interval = V_160
        ElseIf _Prog75 = 161 Then
            _eb.lokSteuern(75, Klassen.LokEigenschaften.Geschwindigkeit, Stufe24)
            Prog_Lok75.Interval = T_160
        ElseIf _Prog75 = 162 Then
            _eb.lokSteuern(75, Klassen.LokEigenschaften.Geschwindigkeit, Stufe23)
        ElseIf _Prog75 = 163 Then
            _eb.lokSteuern(75, Klassen.LokEigenschaften.Geschwindigkeit, Stufe22)
        ElseIf _Prog75 = 164 Then
            _eb.lokSteuern(75, Klassen.LokEigenschaften.Geschwindigkeit, Stufe21)
        ElseIf _Prog75 = 165 Then
            _eb.lokSteuern(75, Klassen.LokEigenschaften.Geschwindigkeit, Stufe2)
        ElseIf _Prog75 = 166 Then
            _eb.lokSteuern(75, Klassen.LokEigenschaften.Geschwindigkeit, 0)
        ElseIf _Prog75 = 167 Then
            Prog_Lok75.Interval = 2000
        ElseIf _Prog75 = 168 Then
            If _Fahrzeugbeleuchtung2 < 2 Then
                _eb.lokSteuern(75, Klassen.LokEigenschaften.Hauptfunktion, 0) ' Licht aus
            End If

            ' Rangierzug

        ElseIf _Prog75 = 180 Then
            _eb.lokSteuern(75, Klassen.LokEigenschaften.Geschwindigkeit, 2)
            Prog_Lok75.Interval = V_180
        ElseIf _Prog75 = 181 Then
            Prog_Lok75.Interval = T_180
            _eb.lokSteuern(75, Klassen.LokEigenschaften.Geschwindigkeit, 1)
        ElseIf _Prog75 = 182 Then
            _eb.lokSteuern(75, Klassen.LokEigenschaften.Geschwindigkeit, 0)

            ' Tunnelausfahrt

        ElseIf _Prog75 = 200 Then ' Kontakt 1.2 <- (bergauf)
            _eb.lokSteuern(75, Klassen.LokEigenschaften.Geschwindigkeit, G_200)
            Prog_Lok75.Interval = 2000
        ElseIf _Prog75 = 201 Then
        ElseIf _Prog75 = 202 Then
        ElseIf _Prog75 = 203 Then
        ElseIf _Prog75 = 204 Then
        ElseIf _Prog75 = 205 Then
            If Stufe4 < Stufe3 Then
                _eb.lokSteuern(75, Klassen.LokEigenschaften.Geschwindigkeit, Stufe3)
            Else
                _eb.lokSteuern(75, Klassen.LokEigenschaften.Geschwindigkeit, Stufe4)
            End If

        ElseIf _Prog75 = 220 Then ' Kontakt 3.1 -> (hinter dem Martinstor bergauf)
            Prog_Lok75.Interval = 2000
        ElseIf _Prog75 = 221 Then
        ElseIf _Prog75 = 222 Then

        ElseIf _Prog75 = 240 Then ' Kontakt 3.7 <- (hinter der Brücke bergauf)
            Prog_Lok75.Interval = 2000
        ElseIf _Prog75 = 241 Then
        ElseIf _Prog75 = 242 Then

        ElseIf _Prog75 = 260 Then ' Kontakt 3.3 (links bzw vor der Brücke)
            Prog_Lok75.Interval = 2000
        ElseIf _Prog75 = 261 Then
        ElseIf _Prog75 = 262 Then
            _eb.lokSteuern(75, Klassen.LokEigenschaften.Geschwindigkeit, Stufe3)

        ElseIf _Prog75 = 600 Then ' Kontakt 3.5 <- (unter der Burg)
            Prog_Lok75.Interval = 2000
        ElseIf _Prog75 = 601 Then
        ElseIf _Prog75 = 602 Then

        ElseIf _Prog75 = 620 Then ' Kontakt 3.7 -> (hinter der Brücke bergab)
            Prog_Lok75.Interval = 2000
        ElseIf _Prog75 = 621 Then
        ElseIf _Prog75 = 622 Then

        ElseIf _Prog75 = 640 Then ' Kontakt 3.1 <- Talfahrt
            Prog_Lok75.Interval = 2000
        ElseIf _Prog75 = 641 Then
        ElseIf _Prog75 = 642 Then

        ElseIf _Prog75 = 660 Then ' Kontakt 1.2 -> Talfahrt
            Prog_Lok75.Interval = 2000
        ElseIf _Prog75 = 661 Then
        ElseIf _Prog75 = 662 Then

        ElseIf _Prog75 = 700 Then ' Kontakt 0.4 <- Diagonale
            Prog_Lok75.Interval = 2000
        ElseIf _Prog75 = 701 Then
        ElseIf _Prog75 = 702 Then

            ' Zindelstein

        ElseIf _Prog75 = 500 Then
            Prog_Lok75.Interval = V_500
        ElseIf _Prog75 = 501 Then
            _eb.lokSteuern(75, Klassen.LokEigenschaften.Geschwindigkeit, Stufe23)
            Prog_Lok75.Interval = T_500
        ElseIf _Prog75 = 502 Then
            _eb.lokSteuern(75, Klassen.LokEigenschaften.Geschwindigkeit, Stufe22)
        ElseIf _Prog75 = 503 Then
            _eb.lokSteuern(75, Klassen.LokEigenschaften.Geschwindigkeit, Stufe21)
        ElseIf _Prog75 = 504 Then
            _eb.lokSteuern(75, Klassen.LokEigenschaften.Geschwindigkeit, Stufe2)
        ElseIf _Prog75 = 505 Then
            _eb.lokSteuern(75, Klassen.LokEigenschaften.Geschwindigkeit, 0)

        Else
            _Prog75 = 0
            Prog_Lok75.Stop()
            Prog_Lok75.Interval = 200
            If Betriebsart = 1 Then
                SetProgramCounterLabel1(String.Empty)
            Else
                SetProgramCounterLabel(String.Empty)
            End If
        End If
        _Prog75 = _Prog75 + 1
    End Sub
    Private Sub HandleTimerElapsed88(sender As System.Object, e As System.EventArgs) Handles Prog_Lok76.Elapsed

        '*** Fahrprogramm für Dampflok S3/6
        '*** Datum: 23.02.2020

        SetText(TextBox1, "Dampflok S3/6                                                           IBS: 06.01.2022 V3: 8")
        LoadImage(PictureBox1, "H:\\EB_Media\\LokFotos\\Baureihe_S36_01.jpg")
        GeschwindikeitenSetzen(76)

        Dim Stufe1, Stufe2, Stufe3, Stufe4 As Integer
        Dim Stufe11, Stufe12, Stufe13, Stufe14, Stufe21, Stufe22, Stufe23, Stufe24 As Integer
        Dim V_100, V_130, V_160, V_180, V_500 As Integer
        Dim T_100, T_130, T_160, T_180, T_500 As Integer
        Dim G_200 As Integer

        T_100 = _Betriebsparameter.Fahrparameter(76, KlausEBspecific.Betriebsparameter.FahrparameterEnum.T_100)
        T_130 = _Betriebsparameter.Fahrparameter(76, KlausEBspecific.Betriebsparameter.FahrparameterEnum.T_130)
        T_160 = _Betriebsparameter.Fahrparameter(76, KlausEBspecific.Betriebsparameter.FahrparameterEnum.T_160)
        T_180 = _Betriebsparameter.Fahrparameter(76, KlausEBspecific.Betriebsparameter.FahrparameterEnum.T_180)
        T_500 = _Betriebsparameter.Fahrparameter(76, KlausEBspecific.Betriebsparameter.FahrparameterEnum.T_500)
        V_100 = _Betriebsparameter.Fahrparameter(76, KlausEBspecific.Betriebsparameter.FahrparameterEnum.V_100)
        V_130 = _Betriebsparameter.Fahrparameter(76, KlausEBspecific.Betriebsparameter.FahrparameterEnum.V_130)
        V_160 = _Betriebsparameter.Fahrparameter(76, KlausEBspecific.Betriebsparameter.FahrparameterEnum.V_160)
        V_180 = _Betriebsparameter.Fahrparameter(76, KlausEBspecific.Betriebsparameter.FahrparameterEnum.V_180)
        V_500 = _Betriebsparameter.Fahrparameter(76, KlausEBspecific.Betriebsparameter.FahrparameterEnum.V_500)
        G_200 = _Betriebsparameter.Fahrparameter(76, KlausEBspecific.Betriebsparameter.FahrparameterEnum.G_200)

        If A_StopB = 1 Then
            V_100 = 8000
        End If

        Stufe1 = _LokStufen.Holen(76, 1)
        Stufe2 = _LokStufen.Holen(76, 2)
        Stufe3 = _LokStufen.Holen(76, 3)
        Stufe4 = _LokStufen.Holen(76, 4)

        If Stufe2 = 1 Then
            T_100 = T_100
            T_130 = T_130
            T_160 = T_160
            V_180 = V_180
        ElseIf Stufe2 = 2 Then
            T_100 = T_100 + 300
            T_130 = T_130 + 300
            T_160 = T_160 + 300
            V_180 = V_180 + 500
        ElseIf Stufe2 = 3 Then
            T_100 = T_100 + 500
            T_130 = T_130 + 500
            T_160 = T_160 + 500
            V_180 = V_180 + 1000
        ElseIf Stufe2 = 4 Then
            T_100 = T_100 + 700
            T_130 = T_130 + 700
            T_160 = T_160 + 700
            V_180 = V_180 + 1500
        ElseIf Stufe2 = 5 Then
            T_100 = T_100 + 900
            T_130 = T_130 + 900
            T_160 = T_160 + 900
            V_180 = V_180 + 2000
        ElseIf Stufe2 = 6 Then
            T_100 = T_100 + 1200
            T_130 = T_130 + 1200
            T_160 = T_160 + 1200
            V_180 = V_180 + 2500
        Else
            T_100 = T_100 + 1200
            T_130 = T_130 + 1200
            T_160 = T_160 + 1200
            V_180 = V_180 + 2500
        End If

        Stufe2 = Stufe1

        Stufe11 = Stufe1 + 1
        If Stufe11 > Stufe3 Then
            Stufe11 = Stufe3
        End If
        Stufe12 = Stufe1 + 2
        If Stufe12 > Stufe3 Then
            Stufe12 = Stufe3
        End If
        Stufe13 = Stufe1 + 3
        If Stufe13 > Stufe3 Then
            Stufe13 = Stufe3
        End If
        Stufe14 = Stufe1 + 4
        If Stufe14 > Stufe3 Then
            Stufe14 = Stufe3
        End If

        Stufe21 = Stufe2 + 1
        If Stufe21 > Stufe3 Then
            Stufe21 = Stufe3
        End If
        Stufe22 = Stufe2 + 2
        If Stufe22 > Stufe3 Then
            Stufe22 = Stufe3
        End If
        Stufe23 = Stufe2 + 3
        If Stufe23 > Stufe3 Then
            Stufe23 = Stufe3
        End If
        Stufe24 = Stufe2 + 5  '*** +5
        If Stufe24 > Stufe3 Then
            Stufe24 = Stufe3
        End If
        If G_200 > 0 Then
            If G_200 < Stufe4 Then
                G_200 = Stufe4
            End If
        Else
            G_200 = Stufe4
        End If

        If Betriebsart = 1 And (_GlsL76 = 3 Or _GlsL76 = 4) Then
            SetProgramCounterLabel1(_Prog76)
        Else
            SetProgramCounterLabel(_Prog76)
        End If

        ' Lok starten - Bahnhofsausfahrt

        If _Prog76 = 0 Then
            Prog_Lok76.Interval = 2000
            If _Fahrzeugbeleuchtung2 > 0 Then
                _eb.lokSteuern(76, Klassen.LokEigenschaften.Hauptfunktion, 1) ' Licht ein
            End If
        ElseIf _Prog76 = 1 Then
            If _Dampf > 0 Then
                _eb.lokSteuern(76, Klassen.LokEigenschaften.Funktion1, 1) ' Dampf ein
            Else
                _Prog76 = 6
            End If
        ElseIf _Prog76 = 2 Then
            _Betriebsparameter.RundenErhoehen(76)
        ElseIf _Prog76 = 3 Then
        ElseIf _Prog76 = 4 Then
        ElseIf _Prog76 = 5 Then
        ElseIf _Prog76 = 6 Then
        ElseIf _Prog76 = 7 Then
        ElseIf _Prog76 = 8 Then

            ' Bahnhofsausfahrt

        ElseIf _Prog76 = 9 Then
            _eb.lokSteuern(76, Klassen.LokEigenschaften.Geschwindigkeit, Stufe1)
        ElseIf _Prog76 = 10 Then
            _eb.lokSteuern(76, Klassen.LokEigenschaften.Geschwindigkeit, Stufe11)
        ElseIf _Prog76 = 11 Then
            _eb.lokSteuern(76, Klassen.LokEigenschaften.Geschwindigkeit, Stufe12)
        ElseIf _Prog76 = 12 Then
            _eb.lokSteuern(76, Klassen.LokEigenschaften.Geschwindigkeit, Stufe13)
        ElseIf _Prog76 = 13 Then
            _eb.lokSteuern(76, Klassen.LokEigenschaften.Geschwindigkeit, Stufe14)
        ElseIf _Prog76 = 14 Then
            _eb.lokSteuern(76, Klassen.LokEigenschaften.Geschwindigkeit, Stufe3)
        ElseIf _Prog76 = 15 Then
            If _Dampf = 0 Or _Dampf = 2 Then
                _eb.lokSteuern(76, Klassen.LokEigenschaften.Funktion1, 0) ' Dampf aus
            End If

            ' Lok abstellen

        ElseIf _Prog76 = 50 Then
            Prog_Lok76.Interval = 2000
        ElseIf _Prog76 = 51 Then
        ElseIf _Prog76 = 52 Then
            If _Fahrzeugbeleuchtung2 < 2 Then
                _eb.lokSteuern(76, Klassen.LokEigenschaften.Hauptfunktion, 0) ' Licht aus
            End If

            ' Lok bremsen (Bahnhofseinfahrt Normalzug von links und von rechts)

        ElseIf _Prog76 = 100 Then
            Prog_Lok76.Interval = V_100
        ElseIf _Prog76 = 101 Then
            _eb.lokSteuern(76, Klassen.LokEigenschaften.Geschwindigkeit, Stufe24)
            Prog_Lok76.Interval = T_100
        ElseIf _Prog76 = 102 Then
            _eb.lokSteuern(76, Klassen.LokEigenschaften.Geschwindigkeit, Stufe23)
        ElseIf _Prog76 = 103 Then
            _eb.lokSteuern(76, Klassen.LokEigenschaften.Geschwindigkeit, Stufe22)
        ElseIf _Prog76 = 104 Then
            _eb.lokSteuern(76, Klassen.LokEigenschaften.Geschwindigkeit, Stufe21)
        ElseIf _Prog76 = 105 Then
            _eb.lokSteuern(76, Klassen.LokEigenschaften.Geschwindigkeit, Stufe2)

            ' Lok bremsen (Bahnhofseinfahrt Kurzzug von links)

        ElseIf _Prog76 = 130 Then
            Prog_Lok76.Interval = V_130
        ElseIf _Prog76 = 131 Then
            _eb.lokSteuern(76, Klassen.LokEigenschaften.Geschwindigkeit, Stufe24)
            Prog_Lok76.Interval = T_130
        ElseIf _Prog76 = 132 Then
            _eb.lokSteuern(76, Klassen.LokEigenschaften.Geschwindigkeit, Stufe23)
        ElseIf _Prog76 = 133 Then
            _eb.lokSteuern(76, Klassen.LokEigenschaften.Geschwindigkeit, Stufe22)
        ElseIf _Prog76 = 134 Then
            _eb.lokSteuern(76, Klassen.LokEigenschaften.Geschwindigkeit, Stufe21)
        ElseIf _Prog76 = 135 Then
            _eb.lokSteuern(76, Klassen.LokEigenschaften.Geschwindigkeit, Stufe2)
        ElseIf _Prog76 = 136 Then
            _eb.lokSteuern(76, Klassen.LokEigenschaften.Geschwindigkeit, 0)
        ElseIf _Prog76 = 137 Then
            Prog_Lok76.Interval = 2000
        ElseIf _Prog76 = 138 Then
            If _Fahrzeugbeleuchtung2 < 2 Then
                _eb.lokSteuern(76, Klassen.LokEigenschaften.Hauptfunktion, 0) ' Licht aus
            End If

            ' Lok bremsen (Bahnhofseinfahrt Kurzzug von rechts)

        ElseIf _Prog76 = 160 Then
            Prog_Lok76.Interval = V_160
        ElseIf _Prog76 = 161 Then
            _eb.lokSteuern(76, Klassen.LokEigenschaften.Geschwindigkeit, Stufe24)
            Prog_Lok76.Interval = T_160
        ElseIf _Prog76 = 162 Then
            _eb.lokSteuern(76, Klassen.LokEigenschaften.Geschwindigkeit, Stufe23)
        ElseIf _Prog76 = 163 Then
            _eb.lokSteuern(76, Klassen.LokEigenschaften.Geschwindigkeit, Stufe22)
        ElseIf _Prog76 = 164 Then
            _eb.lokSteuern(76, Klassen.LokEigenschaften.Geschwindigkeit, Stufe21)
        ElseIf _Prog76 = 165 Then
            _eb.lokSteuern(76, Klassen.LokEigenschaften.Geschwindigkeit, Stufe2)
        ElseIf _Prog76 = 166 Then
            _eb.lokSteuern(76, Klassen.LokEigenschaften.Geschwindigkeit, 0)
        ElseIf _Prog76 = 167 Then
            Prog_Lok76.Interval = 2000
        ElseIf _Prog76 = 168 Then
            If _Fahrzeugbeleuchtung2 < 2 Then
                _eb.lokSteuern(76, Klassen.LokEigenschaften.Hauptfunktion, 0) ' Licht aus
            End If

            ' Rangierzug

        ElseIf _Prog76 = 180 Then
            _eb.lokSteuern(76, Klassen.LokEigenschaften.Geschwindigkeit, 2)
            Prog_Lok76.Interval = V_180
        ElseIf _Prog76 = 181 Then
            Prog_Lok76.Interval = T_180
            _eb.lokSteuern(76, Klassen.LokEigenschaften.Geschwindigkeit, 1)
        ElseIf _Prog76 = 182 Then
            _eb.lokSteuern(76, Klassen.LokEigenschaften.Geschwindigkeit, 0)

            ' Tunnelausfahrt

        ElseIf _Prog76 = 200 Then ' Kontakt 1.2 <- (bergauf)
            _eb.lokSteuern(76, Klassen.LokEigenschaften.Geschwindigkeit, G_200)
            Prog_Lok76.Interval = 2000
        ElseIf _Prog76 = 201 Then
        ElseIf _Prog76 = 202 Then
        ElseIf _Prog76 = 203 Then
        ElseIf _Prog76 = 204 Then
        ElseIf _Prog76 = 205 Then
            If Stufe4 < Stufe3 Then
                _eb.lokSteuern(76, Klassen.LokEigenschaften.Geschwindigkeit, Stufe3)
            Else
                _eb.lokSteuern(76, Klassen.LokEigenschaften.Geschwindigkeit, Stufe4)
            End If
        ElseIf _Prog76 = 206 Then
        ElseIf _Prog76 = 207 Then
            If _Motor > 1 Then
                _eb.lokSteuern(76, Klassen.LokEigenschaften.Funktion2, 1) ' Motor ein
            End If
        ElseIf _Prog76 = 208 Then
            Prog_Lok76.Interval = 2000
        ElseIf _Prog76 = 209 Then
            If _AkustischeSignale > 1 Then
                _eb.lokSteuern(76, Klassen.LokEigenschaften.Funktion3, 1) ' Hupe ein
            End If
        ElseIf _Prog76 = 210 Then
            _eb.lokSteuern(76, Klassen.LokEigenschaften.Funktion3, 0) ' Hupe aus

        ElseIf _Prog76 = 220 Then ' Kontakt 3.1 -> (hinter dem Martinstor bergauf)
            Prog_Lok76.Interval = 2000
        ElseIf _Prog76 = 221 Then
        ElseIf _Prog76 = 222 Then
            If _Dampf < 3 Then
                _eb.lokSteuern(76, Klassen.LokEigenschaften.Funktion1, 0) ' Dampf aus
            End If
        ElseIf _Prog76 = 223 Then
            If _Motor < 3 Then
                _eb.lokSteuern(76, Klassen.LokEigenschaften.Funktion2, 1) ' Dampfgeräusch aus
            End If

        ElseIf _Prog76 = 240 Then ' Kontakt 3.7 <- (hinter der Brücke bergauf)
            Prog_Lok76.Interval = 2000
        ElseIf _Prog76 = 241 Then
        ElseIf _Prog76 = 242 Then

        ElseIf _Prog76 = 260 Then ' Kontakt 3.3 (links bzw vor der Brücke)
            Prog_Lok76.Interval = 2000
        ElseIf _Prog76 = 261 Then
        ElseIf _Prog76 = 262 Then
            _eb.lokSteuern(76, Klassen.LokEigenschaften.Geschwindigkeit, Stufe3)

        ElseIf _Prog76 = 600 Then ' Kontakt 3.5 <- (unter der Burg)
            Prog_Lok76.Interval = 2000
        ElseIf _Prog76 = 601 Then
        ElseIf _Prog76 = 602 Then

        ElseIf _Prog76 = 620 Then ' Kontakt 3.7 -> (hinter der Brücke bergab)
            Prog_Lok76.Interval = 2000
        ElseIf _Prog76 = 621 Then
        ElseIf _Prog76 = 622 Then

        ElseIf _Prog76 = 640 Then ' Kontakt 3.1 <- Talfahrt
            Prog_Lok76.Interval = 2000
        ElseIf _Prog76 = 641 Then
        ElseIf _Prog76 = 642 Then

        ElseIf _Prog76 = 660 Then ' Kontakt 1.2 -> Talfahrt
            Prog_Lok76.Interval = 2000
        ElseIf _Prog76 = 661 Then
        ElseIf _Prog76 = 662 Then

        ElseIf _Prog76 = 700 Then ' Kontakt 0.4 <- Diagonale
            Prog_Lok76.Interval = 2000
        ElseIf _Prog76 = 701 Then
        ElseIf _Prog76 = 702 Then

            ' Zindelstein

        ElseIf _Prog76 = 500 Then
            Prog_Lok76.Interval = V_500
        ElseIf _Prog76 = 501 Then
            _eb.lokSteuern(76, Klassen.LokEigenschaften.Geschwindigkeit, Stufe23)
            Prog_Lok76.Interval = T_500
        ElseIf _Prog76 = 502 Then
            _eb.lokSteuern(76, Klassen.LokEigenschaften.Geschwindigkeit, Stufe22)
        ElseIf _Prog76 = 503 Then
            _eb.lokSteuern(76, Klassen.LokEigenschaften.Geschwindigkeit, Stufe21)
        ElseIf _Prog76 = 504 Then
            _eb.lokSteuern(76, Klassen.LokEigenschaften.Geschwindigkeit, Stufe2)
        ElseIf _Prog76 = 505 Then
            _eb.lokSteuern(76, Klassen.LokEigenschaften.Geschwindigkeit, 0)

        Else
            _Prog76 = 0
            Prog_Lok76.Stop()
            Prog_Lok76.Interval = 200
            If Betriebsart = 1 Then
                SetProgramCounterLabel1(String.Empty)
            Else
                SetProgramCounterLabel(String.Empty)
            End If
        End If
        _Prog76 = _Prog76 + 1
    End Sub
    Private Sub HandleTimerElapsed89(sender As System.Object, e As System.EventArgs) Handles Prog_Lok77.Elapsed

        '*** Fahrprogramm Baureihe 12 (012 081-6)
        '*** Datum: 20.06.2020

        SetText(TextBox1, "Dampflok 012 081-6                                                      IBS: 11.10.2025 - V3 : 9")
        LoadImage(PictureBox1, "H:\\EB_Media\\LokFotos\\Baureihe_12_01.jpg")
        GeschwindikeitenSetzen(77)

        Dim Stufe1, Stufe2, Stufe3, Stufe4 As Integer
        Dim Stufe11, Stufe12, Stufe13, Stufe14, Stufe21, Stufe22, Stufe23, Stufe24 As Integer
        Dim V_100, V_130, V_160, V_180, V_500 As Integer
        Dim T_100, T_130, T_160, T_180, T_500 As Integer
        Dim G_200 As Integer

        T_100 = _Betriebsparameter.Fahrparameter(77, KlausEBspecific.Betriebsparameter.FahrparameterEnum.T_100)
        T_130 = _Betriebsparameter.Fahrparameter(77, KlausEBspecific.Betriebsparameter.FahrparameterEnum.T_130)
        T_160 = _Betriebsparameter.Fahrparameter(77, KlausEBspecific.Betriebsparameter.FahrparameterEnum.T_160)
        T_180 = _Betriebsparameter.Fahrparameter(77, KlausEBspecific.Betriebsparameter.FahrparameterEnum.T_180)
        T_500 = _Betriebsparameter.Fahrparameter(77, KlausEBspecific.Betriebsparameter.FahrparameterEnum.T_500)
        V_100 = _Betriebsparameter.Fahrparameter(77, KlausEBspecific.Betriebsparameter.FahrparameterEnum.V_100)
        V_130 = _Betriebsparameter.Fahrparameter(77, KlausEBspecific.Betriebsparameter.FahrparameterEnum.V_130)
        V_160 = _Betriebsparameter.Fahrparameter(77, KlausEBspecific.Betriebsparameter.FahrparameterEnum.V_160)
        V_180 = _Betriebsparameter.Fahrparameter(77, KlausEBspecific.Betriebsparameter.FahrparameterEnum.V_180)
        V_500 = _Betriebsparameter.Fahrparameter(77, KlausEBspecific.Betriebsparameter.FahrparameterEnum.V_500)
        G_200 = _Betriebsparameter.Fahrparameter(77, KlausEBspecific.Betriebsparameter.FahrparameterEnum.G_200)

        If A_StopB = 1 Then
            V_100 = 8000
        End If

        Stufe1 = _LokStufen.Holen(77, 1)
        Stufe2 = _LokStufen.Holen(77, 2)
        Stufe3 = _LokStufen.Holen(77, 3)
        Stufe4 = _LokStufen.Holen(77, 4)

        If Stufe2 = 1 Then
            T_100 = T_100
            T_130 = T_130
            T_160 = T_160
            V_180 = V_180
        ElseIf Stufe2 = 2 Then
            T_100 = T_100 + 300
            T_130 = T_130 + 300
            T_160 = T_160 + 300
            V_180 = V_180 + 500
        ElseIf Stufe2 = 3 Then
            T_100 = T_100 + 500
            T_130 = T_130 + 500
            T_160 = T_160 + 500
            V_180 = V_180 + 1000
        ElseIf Stufe2 = 4 Then
            T_100 = T_100 + 700
            T_130 = T_130 + 700
            T_160 = T_160 + 700
            V_180 = V_180 + 1500
        ElseIf Stufe2 = 5 Then
            T_100 = T_100 + 900
            T_130 = T_130 + 900
            T_160 = T_160 + 900
            V_180 = V_180 + 2000
        ElseIf Stufe2 = 6 Then
            T_100 = T_100 + 1200
            T_130 = T_130 + 1200
            T_160 = T_160 + 1200
            V_180 = V_180 + 2500
        Else
            T_100 = T_100 + 1200
            T_130 = T_130 + 1200
            T_160 = T_160 + 1200
            V_180 = V_180 + 2500
        End If

        Stufe2 = Stufe1

        Stufe11 = Stufe1 + 1
        If Stufe11 > Stufe3 Then
            Stufe11 = Stufe3
        End If
        Stufe12 = Stufe1 + 2
        If Stufe12 > Stufe3 Then
            Stufe12 = Stufe3
        End If
        Stufe13 = Stufe1 + 3
        If Stufe13 > Stufe3 Then
            Stufe13 = Stufe3
        End If
        Stufe14 = Stufe1 + 4
        If Stufe14 > Stufe3 Then
            Stufe14 = Stufe3
        End If

        Stufe21 = Stufe2 + 1
        If Stufe21 > Stufe3 Then
            Stufe21 = Stufe3
        End If
        Stufe22 = Stufe2 + 2
        If Stufe22 > Stufe3 Then
            Stufe22 = Stufe3
        End If
        Stufe23 = Stufe2 + 3
        If Stufe23 > Stufe3 Then
            Stufe23 = Stufe3
        End If
        Stufe24 = Stufe2 + 4
        If Stufe24 > Stufe3 Then
            Stufe24 = Stufe3
        End If
        If G_200 > 0 Then
            If G_200 < Stufe4 Then
                G_200 = Stufe4
            End If
        Else
            G_200 = Stufe4
        End If

        If Betriebsart = 1 And (_GlsL77 = 3 Or _GlsL77 = 4) Then
            SetProgramCounterLabel1(_Prog77)
        Else
            SetProgramCounterLabel(_Prog77)
        End If

        ' Lok starten - Bahnhofsausfahrt

        If _Prog77 = 0 Then
            Prog_Lok77.Interval = 2000
        ElseIf _Prog77 = 1 Then
            If _Dampf > 0 Then
                _eb.lokSteuern(77, Klassen.LokEigenschaften.Hauptfunktion, 1) ' Dampf ein
            Else
                _Prog77 = 6
            End If
        ElseIf _Prog77 = 2 Then
            _Betriebsparameter.RundenErhoehen(77)
        ElseIf _Prog77 = 3 Then
        ElseIf _Prog77 = 4 Then
        ElseIf _Prog77 = 5 Then
        ElseIf _Prog77 = 6 Then
        ElseIf _Prog77 = 7 Then
        ElseIf _Prog77 = 8 Then

            ' Bahnhofsausfahrt

        ElseIf _Prog77 = 9 Then
            _eb.lokSteuern(77, Klassen.LokEigenschaften.Geschwindigkeit, Stufe1)
        ElseIf _Prog77 = 10 Then
            _eb.lokSteuern(77, Klassen.LokEigenschaften.Geschwindigkeit, Stufe11)
        ElseIf _Prog77 = 11 Then
            _eb.lokSteuern(77, Klassen.LokEigenschaften.Geschwindigkeit, Stufe12)
        ElseIf _Prog77 = 12 Then
            _eb.lokSteuern(77, Klassen.LokEigenschaften.Geschwindigkeit, Stufe13)
        ElseIf _Prog77 = 13 Then
            _eb.lokSteuern(77, Klassen.LokEigenschaften.Geschwindigkeit, Stufe14)
        ElseIf _Prog77 = 14 Then
            _eb.lokSteuern(77, Klassen.LokEigenschaften.Geschwindigkeit, Stufe3)
        ElseIf _Prog77 = 15 Then
            If _Dampf < 3 Then
                _eb.lokSteuern(77, Klassen.LokEigenschaften.Hauptfunktion, 0) ' Dampf aus
            End If

            ' Lok abstellen

        ElseIf _Prog77 = 50 Then
            Prog_Lok77.Interval = 2000
        ElseIf _Prog77 = 51 Then
        ElseIf _Prog77 = 52 Then
            If _Dampf < 3 Then
                _eb.lokSteuern(77, Klassen.LokEigenschaften.Hauptfunktion, 0) ' Dampf aus
            End If
        ElseIf _Prog77 = 53 Then
        ElseIf _Prog77 = 54 Then
        ElseIf _Prog77 = 55 Then

            ' Lok bremsen (Bahnhofseinfahrt Normalzug von links und von rechts)

        ElseIf _Prog77 = 100 Then
            Prog_Lok77.Interval = V_100
        ElseIf _Prog77 = 101 Then
            _eb.lokSteuern(77, Klassen.LokEigenschaften.Geschwindigkeit, Stufe24)
            Prog_Lok77.Interval = T_100
        ElseIf _Prog77 = 102 Then
            _eb.lokSteuern(77, Klassen.LokEigenschaften.Geschwindigkeit, Stufe23)
        ElseIf _Prog77 = 103 Then
            _eb.lokSteuern(77, Klassen.LokEigenschaften.Geschwindigkeit, Stufe22)
        ElseIf _Prog77 = 104 Then
            _eb.lokSteuern(77, Klassen.LokEigenschaften.Geschwindigkeit, Stufe21)
        ElseIf _Prog77 = 105 Then
            _eb.lokSteuern(77, Klassen.LokEigenschaften.Geschwindigkeit, Stufe2)

            ' Lok bremsen (Bahnhofseinfahrt Kurzzug von links)

        ElseIf _Prog77 = 130 Then
            Prog_Lok77.Interval = V_130
        ElseIf _Prog77 = 131 Then
            _eb.lokSteuern(77, Klassen.LokEigenschaften.Geschwindigkeit, Stufe24)
            Prog_Lok77.Interval = T_130
        ElseIf _Prog77 = 132 Then
            _eb.lokSteuern(77, Klassen.LokEigenschaften.Geschwindigkeit, Stufe23)
        ElseIf _Prog77 = 133 Then
            _eb.lokSteuern(77, Klassen.LokEigenschaften.Geschwindigkeit, Stufe22)
        ElseIf _Prog77 = 134 Then
            _eb.lokSteuern(77, Klassen.LokEigenschaften.Geschwindigkeit, Stufe21)
        ElseIf _Prog77 = 135 Then
            _eb.lokSteuern(77, Klassen.LokEigenschaften.Geschwindigkeit, Stufe2)
        ElseIf _Prog77 = 136 Then
            _eb.lokSteuern(77, Klassen.LokEigenschaften.Geschwindigkeit, 0)
        ElseIf _Prog77 = 137 Then
            Prog_Lok77.Interval = 2000
        ElseIf _Prog77 = 138 Then
            If _Dampf < 3 Then
                _eb.lokSteuern(77, Klassen.LokEigenschaften.Hauptfunktion, 0) ' Dampf aus
            End If


            ' Lok bremsen (Bahnhofseinfahrt Kurzzug von rechts)

        ElseIf _Prog77 = 160 Then
            Prog_Lok77.Interval = V_160
        ElseIf _Prog77 = 161 Then
            _eb.lokSteuern(77, Klassen.LokEigenschaften.Geschwindigkeit, Stufe24)
            Prog_Lok77.Interval = T_160
        ElseIf _Prog77 = 162 Then
            _eb.lokSteuern(77, Klassen.LokEigenschaften.Geschwindigkeit, Stufe23)
        ElseIf _Prog77 = 163 Then
            _eb.lokSteuern(77, Klassen.LokEigenschaften.Geschwindigkeit, Stufe22)
        ElseIf _Prog77 = 164 Then
            _eb.lokSteuern(77, Klassen.LokEigenschaften.Geschwindigkeit, Stufe21)
        ElseIf _Prog77 = 165 Then
            _eb.lokSteuern(77, Klassen.LokEigenschaften.Geschwindigkeit, Stufe2)
        ElseIf _Prog77 = 166 Then
            _eb.lokSteuern(77, Klassen.LokEigenschaften.Geschwindigkeit, 0)
        ElseIf _Prog77 = 167 Then
            Prog_Lok77.Interval = 2000
        ElseIf _Prog77 = 168 Then
            If _Dampf < 3 Then
                _eb.lokSteuern(77, Klassen.LokEigenschaften.Hauptfunktion, 0) ' Dampf aus
            End If

            ' Rangierzug

        ElseIf _Prog77 = 180 Then
            _eb.lokSteuern(77, Klassen.LokEigenschaften.Geschwindigkeit, Stufe2)
            Prog_Lok77.Interval = V_180
        ElseIf _Prog77 = 181 Then
            Prog_Lok77.Interval = T_180
            _eb.lokSteuern(77, Klassen.LokEigenschaften.Geschwindigkeit, 1)
        ElseIf _Prog77 = 182 Then
            _eb.lokSteuern(77, Klassen.LokEigenschaften.Geschwindigkeit, 0)

            ' Tunnelausfahrt

        ElseIf _Prog77 = 200 Then ' Kontakt 1.2 <- (bergauf)
            _eb.lokSteuern(77, Klassen.LokEigenschaften.Geschwindigkeit, G_200)
            Prog_Lok77.Interval = 2000
        ElseIf _Prog77 = 201 Then
        ElseIf _Prog77 = 202 Then
        ElseIf _Prog77 = 203 Then
            If _Dampf > 1 Then
                _eb.lokSteuern(77, Klassen.LokEigenschaften.Hauptfunktion, 1) ' Dampf ein
            End If
        ElseIf _Prog77 = 204 Then
        ElseIf _Prog77 = 205 Then
            If Stufe4 < Stufe3 Then
                _eb.lokSteuern(77, Klassen.LokEigenschaften.Geschwindigkeit, Stufe3)
            Else
                _eb.lokSteuern(77, Klassen.LokEigenschaften.Geschwindigkeit, Stufe4)
            End If

        ElseIf _Prog77 = 220 Then ' Kontakt 3.1 -> (hinter dem Martinstor bergauf)
            Prog_Lok77.Interval = 3000
        ElseIf _Prog77 = 221 Then
        ElseIf _Prog77 = 222 Then
            If _Dampf < 3 Then
                _eb.lokSteuern(77, Klassen.LokEigenschaften.Hauptfunktion, 0) ' Dampf aus
            End If

        ElseIf _Prog77 = 240 Then ' Kontakt 3.7 <- (hinter der Brücke bergauf)
            Prog_Lok77.Interval = 3000
        ElseIf _Prog77 = 241 Then
            If _Dampf > 1 Then
                _eb.lokSteuern(77, Klassen.LokEigenschaften.Hauptfunktion, 1) ' Dampf ein
            End If
        ElseIf _Prog77 = 242 Then
        ElseIf _Prog77 = 243 Then
            If _Dampf < 3 Then
                _eb.lokSteuern(77, Klassen.LokEigenschaften.Hauptfunktion, 0) ' Dampf aus
            End If

        ElseIf _Prog77 = 260 Then ' Kontakt 3.3 (links bzw vor der Brücke)
            Prog_Lok77.Interval = 2000
        ElseIf _Prog77 = 261 Then
        ElseIf _Prog77 = 262 Then
            _eb.lokSteuern(77, Klassen.LokEigenschaften.Geschwindigkeit, Stufe3)

        ElseIf _Prog77 = 600 Then ' Kontakt 3.5 <- (unter der Burg)
            Prog_Lok77.Interval = 2000
        ElseIf _Prog77 = 601 Then
        ElseIf _Prog77 = 602 Then

        ElseIf _Prog77 = 620 Then ' Kontakt 3.7 -> (hinter der Brücke bergab)
            Prog_Lok77.Interval = 2000
        ElseIf _Prog77 = 621 Then
        ElseIf _Prog77 = 622 Then

        ElseIf _Prog77 = 640 Then ' Kontakt 3.1 <- Talfahrt
            Prog_Lok77.Interval = 2000
        ElseIf _Prog77 = 641 Then
        ElseIf _Prog77 = 642 Then

        ElseIf _Prog77 = 660 Then ' Kontakt 1.2 -> Talfahrt
            Prog_Lok77.Interval = 2000
        ElseIf _Prog77 = 661 Then
        ElseIf _Prog77 = 662 Then

        ElseIf _Prog77 = 700 Then ' Kontakt 0.4 <- Diagonale
            Prog_Lok77.Interval = 2000
        ElseIf _Prog77 = 701 Then
        ElseIf _Prog77 = 702 Then

            ' Zindelstein

        ElseIf _Prog77 = 500 Then
            Prog_Lok77.Interval = V_500
        ElseIf _Prog77 = 501 Then
            _eb.lokSteuern(77, Klassen.LokEigenschaften.Geschwindigkeit, Stufe23)
            Prog_Lok77.Interval = T_500
        ElseIf _Prog77 = 502 Then
            _eb.lokSteuern(77, Klassen.LokEigenschaften.Geschwindigkeit, Stufe22)
        ElseIf _Prog77 = 503 Then
            _eb.lokSteuern(77, Klassen.LokEigenschaften.Geschwindigkeit, Stufe21)
        ElseIf _Prog77 = 504 Then
            _eb.lokSteuern(77, Klassen.LokEigenschaften.Geschwindigkeit, Stufe2)
        ElseIf _Prog77 = 505 Then
            _eb.lokSteuern(77, Klassen.LokEigenschaften.Geschwindigkeit, 0)


        Else
            _Prog77 = 0
            Prog_Lok77.Interval = 200
            Prog_Lok77.Stop()
            If Betriebsart = 1 Then
                SetProgramCounterLabel1(String.Empty)
            Else
                SetProgramCounterLabel(String.Empty)
            End If
        End If
        _Prog77 = _Prog77 + 1
    End Sub
    Private Sub HandleTimerElapsed90(sender As System.Object, e As System.EventArgs) Handles Prog_Lok78.Elapsed

        '*** Fahrprogramm für Dampflok Rheinheim
        '*** Datum: 21.02.2023

        SetText(TextBox1, "Dampflok Rheinheim                                                      IBS: 21.02.2023 - V3 : 6")
        LoadImage(PictureBox1, "H:\\EB_Media\\LokFotos\\Baureihe_Rheinheim_03.jpg")
        GeschwindikeitenSetzen(78)

        Dim Stufe1, Stufe2, Stufe3, Stufe4 As Integer
        Dim Stufe11, Stufe12, Stufe13, Stufe14, Stufe21, Stufe22, Stufe23, Stufe24 As Integer
        Dim V_100, V_130, V_160, V_180, V_500 As Integer
        Dim T_100, T_130, T_160, T_180, T_500 As Integer
        Dim G_200 As Integer

        T_100 = _Betriebsparameter.Fahrparameter(78, KlausEBspecific.Betriebsparameter.FahrparameterEnum.T_100)
        T_130 = _Betriebsparameter.Fahrparameter(78, KlausEBspecific.Betriebsparameter.FahrparameterEnum.T_130)
        T_160 = _Betriebsparameter.Fahrparameter(78, KlausEBspecific.Betriebsparameter.FahrparameterEnum.T_160)
        T_180 = _Betriebsparameter.Fahrparameter(78, KlausEBspecific.Betriebsparameter.FahrparameterEnum.T_180)
        T_500 = _Betriebsparameter.Fahrparameter(78, KlausEBspecific.Betriebsparameter.FahrparameterEnum.T_500)
        V_100 = _Betriebsparameter.Fahrparameter(78, KlausEBspecific.Betriebsparameter.FahrparameterEnum.V_100)
        V_130 = _Betriebsparameter.Fahrparameter(78, KlausEBspecific.Betriebsparameter.FahrparameterEnum.V_130)
        V_160 = _Betriebsparameter.Fahrparameter(78, KlausEBspecific.Betriebsparameter.FahrparameterEnum.V_160)
        V_180 = _Betriebsparameter.Fahrparameter(78, KlausEBspecific.Betriebsparameter.FahrparameterEnum.V_180)
        V_500 = _Betriebsparameter.Fahrparameter(78, KlausEBspecific.Betriebsparameter.FahrparameterEnum.V_500)
        G_200 = _Betriebsparameter.Fahrparameter(78, KlausEBspecific.Betriebsparameter.FahrparameterEnum.G_200)

        If A_StopB = 1 Then
            V_100 = 8000
        End If

        Stufe1 = _LokStufen.Holen(78, 1)
        Stufe2 = _LokStufen.Holen(78, 2)
        Stufe3 = _LokStufen.Holen(78, 3)
        Stufe4 = _LokStufen.Holen(78, 4)

        If Stufe2 = 1 Then
            T_100 = T_100
            T_130 = T_130
            T_160 = T_160
            V_180 = V_180
        ElseIf Stufe2 = 2 Then
            T_100 = T_100 + 300
            T_130 = T_130 + 300
            T_160 = T_160 + 300
            V_180 = V_180 + 500
        ElseIf Stufe2 = 3 Then
            T_100 = T_100 + 500
            T_130 = T_130 + 500
            T_160 = T_160 + 500
            V_180 = V_180 + 1000
        ElseIf Stufe2 = 4 Then
            T_100 = T_100 + 700
            T_130 = T_130 + 700
            T_160 = T_160 + 700
            V_180 = V_180 + 1500
        ElseIf Stufe2 = 5 Then
            T_100 = T_100 + 900
            T_130 = T_130 + 900
            T_160 = T_160 + 900
            V_180 = V_180 + 2000
        ElseIf Stufe2 = 6 Then
            T_100 = T_100 + 1200
            T_130 = T_130 + 1200
            T_160 = T_160 + 1200
            V_180 = V_180 + 2500
        Else
            T_100 = T_100 + 1200
            T_130 = T_130 + 1200
            T_160 = T_160 + 1200
            V_180 = V_180 + 2500
        End If

        Stufe2 = Stufe1

        Stufe11 = Stufe1 + 1
        If Stufe11 > Stufe3 Then
            Stufe11 = Stufe3
        End If
        Stufe12 = Stufe1 + 2
        If Stufe12 > Stufe3 Then
            Stufe12 = Stufe3
        End If
        Stufe13 = Stufe1 + 3
        If Stufe13 > Stufe3 Then
            Stufe13 = Stufe3
        End If
        Stufe14 = Stufe1 + 4
        If Stufe14 > Stufe3 Then
            Stufe14 = Stufe3
        End If

        Stufe21 = Stufe2 + 1
        If Stufe21 > Stufe3 Then
            Stufe21 = Stufe3
        End If
        Stufe22 = Stufe2 + 2
        If Stufe22 > Stufe3 Then
            Stufe22 = Stufe3
        End If
        Stufe23 = Stufe2 + 3
        If Stufe23 > Stufe3 Then
            Stufe23 = Stufe3
        End If
        Stufe24 = Stufe2 + 4
        If Stufe24 > Stufe3 Then
            Stufe24 = Stufe3
        End If
        If G_200 > 0 Then
            If G_200 < Stufe4 Then
                G_200 = Stufe4
            End If
        Else
            G_200 = Stufe4
        End If

        If Betriebsart = 1 And (_GlsL78 = 3 Or _GlsL78 = 4) Then
            SetProgramCounterLabel1(_Prog78)
        Else
            SetProgramCounterLabel(_Prog78)
        End If

        ' Lok starten - Bahnhofsausfahrt

        If _Prog78 = 0 Then
            Prog_Lok78.Interval = 2000
        ElseIf _Prog78 = 1 Then
        ElseIf _Prog78 = 2 Then
            _Betriebsparameter.RundenErhoehen(78)
        ElseIf _Prog78 = 3 Then
        ElseIf _Prog78 = 4 Then
        ElseIf _Prog78 = 5 Then
        ElseIf _Prog78 = 6 Then

            ' Bahnhofsausfahrt

        ElseIf _Prog78 = 7 Then
            _eb.lokSteuern(78, Klassen.LokEigenschaften.Geschwindigkeit, Stufe1)
        ElseIf _Prog78 = 8 Then
            _eb.lokSteuern(78, Klassen.LokEigenschaften.Geschwindigkeit, Stufe11)
        ElseIf _Prog78 = 9 Then
            _eb.lokSteuern(78, Klassen.LokEigenschaften.Geschwindigkeit, Stufe12)
        ElseIf _Prog78 = 10 Then
            _eb.lokSteuern(78, Klassen.LokEigenschaften.Geschwindigkeit, Stufe13)
        ElseIf _Prog78 = 11 Then
            _eb.lokSteuern(78, Klassen.LokEigenschaften.Geschwindigkeit, Stufe14)
        ElseIf _Prog78 = 12 Then
            _eb.lokSteuern(78, Klassen.LokEigenschaften.Geschwindigkeit, Stufe3)

            ' Lok abstellen

        ElseIf _Prog78 = 50 Then
            Prog_Lok78.Interval = 2000
        ElseIf _Prog78 = 51 Then
        ElseIf _Prog78 = 52 Then
            If _Fahrzeugbeleuchtung2 < 2 Then
                _eb.lokSteuern(78, Klassen.LokEigenschaften.Hauptfunktion, 0) ' Licht aus
            End If

            ' Lok bremsen (Bahnhofseinfahrt Normalzug von links und von rechts)

        ElseIf _Prog78 = 100 Then
            Prog_Lok78.Interval = V_100
        ElseIf _Prog78 = 101 Then
            _eb.lokSteuern(78, Klassen.LokEigenschaften.Geschwindigkeit, Stufe24)
            Prog_Lok78.Interval = T_100
        ElseIf _Prog78 = 102 Then
            _eb.lokSteuern(78, Klassen.LokEigenschaften.Geschwindigkeit, Stufe23)
        ElseIf _Prog78 = 103 Then
            _eb.lokSteuern(78, Klassen.LokEigenschaften.Geschwindigkeit, Stufe22)
        ElseIf _Prog78 = 104 Then
            _eb.lokSteuern(78, Klassen.LokEigenschaften.Geschwindigkeit, Stufe21)
        ElseIf _Prog78 = 105 Then
            _eb.lokSteuern(64, Klassen.LokEigenschaften.Geschwindigkeit, Stufe2)

            ' Lok bremsen (Bahnhofseinfahrt Kurzzug von links)

        ElseIf _Prog78 = 130 Then
            Prog_Lok78.Interval = V_130
        ElseIf _Prog78 = 131 Then
            _eb.lokSteuern(78, Klassen.LokEigenschaften.Geschwindigkeit, Stufe24)
            Prog_Lok78.Interval = T_130
        ElseIf _Prog78 = 132 Then
            _eb.lokSteuern(78, Klassen.LokEigenschaften.Geschwindigkeit, Stufe23)
        ElseIf _Prog78 = 133 Then
            _eb.lokSteuern(78, Klassen.LokEigenschaften.Geschwindigkeit, Stufe22)
        ElseIf _Prog78 = 134 Then
            _eb.lokSteuern(78, Klassen.LokEigenschaften.Geschwindigkeit, Stufe21)
        ElseIf _Prog78 = 135 Then
            _eb.lokSteuern(64, Klassen.LokEigenschaften.Geschwindigkeit, Stufe2)
        ElseIf _Prog78 = 136 Then
            _eb.lokSteuern(78, Klassen.LokEigenschaften.Geschwindigkeit, 0)

            ' Lok bremsen (Bahnhofseinfahrt Kurzzug von rechts)

        ElseIf _Prog78 = 160 Then
            Prog_Lok78.Interval = V_160
        ElseIf _Prog78 = 161 Then
            _eb.lokSteuern(78, Klassen.LokEigenschaften.Geschwindigkeit, Stufe24)
            Prog_Lok78.Interval = T_160
        ElseIf _Prog78 = 162 Then
            _eb.lokSteuern(78, Klassen.LokEigenschaften.Geschwindigkeit, Stufe23)
        ElseIf _Prog78 = 163 Then
            _eb.lokSteuern(78, Klassen.LokEigenschaften.Geschwindigkeit, Stufe22)
        ElseIf _Prog78 = 164 Then
            _eb.lokSteuern(78, Klassen.LokEigenschaften.Geschwindigkeit, Stufe21)
        ElseIf _Prog78 = 165 Then
            _eb.lokSteuern(64, Klassen.LokEigenschaften.Geschwindigkeit, Stufe2)
        ElseIf _Prog78 = 166 Then
            _eb.lokSteuern(78, Klassen.LokEigenschaften.Geschwindigkeit, 0)

            ' Rangierzug

        ElseIf _Prog78 = 180 Then
            _eb.lokSteuern(78, Klassen.LokEigenschaften.Geschwindigkeit, 2)
            Prog_Lok78.Interval = V_180
        ElseIf _Prog78 = 181 Then
            Prog_Lok78.Interval = T_180
            _eb.lokSteuern(78, Klassen.LokEigenschaften.Geschwindigkeit, 1)
        ElseIf _Prog78 = 182 Then
            _eb.lokSteuern(78, Klassen.LokEigenschaften.Geschwindigkeit, 0)

            ' Tunnelausfahrt

        ElseIf _Prog78 = 200 Then ' Kontakt 1.2 <- (bergauf)
            _eb.lokSteuern(78, Klassen.LokEigenschaften.Geschwindigkeit, G_200)
            Prog_Lok78.Interval = 2000
        ElseIf _Prog78 = 201 Then
        ElseIf _Prog78 = 202 Then
        ElseIf _Prog78 = 203 Then
        ElseIf _Prog78 = 204 Then
        ElseIf _Prog78 = 205 Then
            If Stufe4 < Stufe3 Then
                _eb.lokSteuern(78, Klassen.LokEigenschaften.Geschwindigkeit, Stufe3)
            Else
                _eb.lokSteuern(78, Klassen.LokEigenschaften.Geschwindigkeit, Stufe4)
            End If

        ElseIf _Prog78 = 220 Then ' Kontakt 3.1 -> (hinter dem Martinstor bergauf)
            Prog_Lok78.Interval = 2000
        ElseIf _Prog78 = 221 Then
        ElseIf _Prog78 = 222 Then

        ElseIf _Prog78 = 240 Then ' Kontakt 3.7 <- (hinter der Brücke bergauf)
            Prog_Lok78.Interval = 2000
        ElseIf _Prog78 = 241 Then
        ElseIf _Prog78 = 242 Then

        ElseIf _Prog78 = 260 Then ' Kontakt 3.3 (links bzw vor der Brücke)
            Prog_Lok78.Interval = 2000
        ElseIf _Prog78 = 261 Then
        ElseIf _Prog78 = 262 Then
            _eb.lokSteuern(78, Klassen.LokEigenschaften.Geschwindigkeit, Stufe3)


        ElseIf _Prog78 = 600 Then ' Kontakt 3.5 <- (unter der Burg)
            Prog_Lok78.Interval = 2000
        ElseIf _Prog78 = 601 Then
        ElseIf _Prog78 = 602 Then

        ElseIf _Prog78 = 620 Then ' Kontakt 3.7 -> (hinter der Brücke bergab)
            Prog_Lok78.Interval = 2000
        ElseIf _Prog78 = 621 Then
        ElseIf _Prog78 = 622 Then

        ElseIf _Prog78 = 640 Then ' Kontakt 3.1 <- Talfahrt
            Prog_Lok78.Interval = 2000
        ElseIf _Prog78 = 641 Then
        ElseIf _Prog78 = 642 Then

        ElseIf _Prog78 = 660 Then ' Kontakt 1.2 -> Talfahrt
            Prog_Lok78.Interval = 2000
        ElseIf _Prog78 = 661 Then
        ElseIf _Prog78 = 662 Then

        ElseIf _Prog78 = 700 Then ' Kontakt 0.4 <- Diagonale
            Prog_Lok78.Interval = 2000
        ElseIf _Prog78 = 701 Then
        ElseIf _Prog78 = 702 Then

            ' Zindelstein

        ElseIf _Prog78 = 500 Then
            Prog_Lok78.Interval = V_500
        ElseIf _Prog78 = 501 Then
            _eb.lokSteuern(78, Klassen.LokEigenschaften.Geschwindigkeit, Stufe23)
            Prog_Lok78.Interval = T_500
        ElseIf _Prog78 = 502 Then
            _eb.lokSteuern(78, Klassen.LokEigenschaften.Geschwindigkeit, Stufe22)
        ElseIf _Prog78 = 503 Then
            _eb.lokSteuern(78, Klassen.LokEigenschaften.Geschwindigkeit, Stufe21)
        ElseIf _Prog78 = 504 Then
            _eb.lokSteuern(78, Klassen.LokEigenschaften.Geschwindigkeit, Stufe2)
        ElseIf _Prog78 = 505 Then
            _eb.lokSteuern(78, Klassen.LokEigenschaften.Geschwindigkeit, 0)

        Else
            _Prog78 = 0
            Prog_Lok78.Stop()
            Prog_Lok78.Interval = 200
            If Betriebsart = 1 Then
                SetProgramCounterLabel1(String.Empty)
            Else
                SetProgramCounterLabel(String.Empty)
            End If
        End If
        _Prog78 = _Prog78 + 1
    End Sub
    Private Sub HandleTimerElapsed91(sender As System.Object, e As System.EventArgs) Handles Prog_Lok79.Elapsed

        '*** Fahrprogramm für Dampflok 50 082-7
        '*** Datum: 23.02.2020

        SetText(TextBox1, "Dampflok 50 082-7                                                       IBS: 12.11.2023 - V3 : 6")
        LoadImage(PictureBox1, "H:\\EB_Media\\LokFotos\\Baureihe_50_01.jpg")
        GeschwindikeitenSetzen(79)

        Dim Stufe1, Stufe2, Stufe3, Stufe4 As Integer
        Dim Stufe11, Stufe12, Stufe13, Stufe14, Stufe21, Stufe22, Stufe23, Stufe24 As Integer
        Dim V_100, V_130, V_160, V_180, V_500 As Integer
        Dim T_100, T_130, T_160, T_180, T_500 As Integer
        Dim G_200 As Integer

        T_100 = _Betriebsparameter.Fahrparameter(79, KlausEBspecific.Betriebsparameter.FahrparameterEnum.T_100)
        T_130 = _Betriebsparameter.Fahrparameter(79, KlausEBspecific.Betriebsparameter.FahrparameterEnum.T_130)
        T_160 = _Betriebsparameter.Fahrparameter(79, KlausEBspecific.Betriebsparameter.FahrparameterEnum.T_160)
        T_180 = _Betriebsparameter.Fahrparameter(79, KlausEBspecific.Betriebsparameter.FahrparameterEnum.T_180)
        T_500 = _Betriebsparameter.Fahrparameter(79, KlausEBspecific.Betriebsparameter.FahrparameterEnum.T_500)
        V_100 = _Betriebsparameter.Fahrparameter(79, KlausEBspecific.Betriebsparameter.FahrparameterEnum.V_100)
        V_130 = _Betriebsparameter.Fahrparameter(79, KlausEBspecific.Betriebsparameter.FahrparameterEnum.V_130)
        V_160 = _Betriebsparameter.Fahrparameter(79, KlausEBspecific.Betriebsparameter.FahrparameterEnum.V_160)
        V_180 = _Betriebsparameter.Fahrparameter(79, KlausEBspecific.Betriebsparameter.FahrparameterEnum.V_180)
        V_500 = _Betriebsparameter.Fahrparameter(79, KlausEBspecific.Betriebsparameter.FahrparameterEnum.V_500)
        G_200 = _Betriebsparameter.Fahrparameter(79, KlausEBspecific.Betriebsparameter.FahrparameterEnum.G_200)


        If A_StopB = 1 Then
            V_100 = 8000
        End If

        Stufe1 = _LokStufen.Holen(79, 1)
        Stufe2 = _LokStufen.Holen(79, 2)
        Stufe3 = _LokStufen.Holen(79, 3)
        Stufe4 = _LokStufen.Holen(79, 4)

        If Stufe2 = 1 Then
            T_100 = T_100
            T_130 = T_130
            T_160 = T_160
            V_180 = V_180
        ElseIf Stufe2 = 2 Then
            T_100 = T_100 + 300
            T_130 = T_130 + 300
            T_160 = T_160 + 300
            V_180 = V_180 + 500
        ElseIf Stufe2 = 3 Then
            T_100 = T_100 + 500
            T_130 = T_130 + 500
            T_160 = T_160 + 500
            V_180 = V_180 + 1000
        ElseIf Stufe2 = 4 Then
            T_100 = T_100 + 700
            T_130 = T_130 + 700
            T_160 = T_160 + 700
            V_180 = V_180 + 1500
        ElseIf Stufe2 = 5 Then
            T_100 = T_100 + 900
            T_130 = T_130 + 900
            T_160 = T_160 + 900
            V_180 = V_180 + 2000
        ElseIf Stufe2 = 6 Then
            T_100 = T_100 + 1200
            T_130 = T_130 + 1200
            T_160 = T_160 + 1200
            V_180 = V_180 + 2500
        Else
            T_100 = T_100 + 1200
            T_130 = T_130 + 1200
            T_160 = T_160 + 1200
            V_180 = V_180 + 2500
        End If

        Stufe2 = Stufe1

        Stufe11 = Stufe1 + 1
        If Stufe11 > Stufe3 Then
            Stufe11 = Stufe3
        End If
        Stufe12 = Stufe1 + 2
        If Stufe12 > Stufe3 Then
            Stufe12 = Stufe3
        End If
        Stufe13 = Stufe1 + 3
        If Stufe13 > Stufe3 Then
            Stufe13 = Stufe3
        End If
        Stufe14 = Stufe1 + 4
        If Stufe14 > Stufe3 Then
            Stufe14 = Stufe3
        End If

        Stufe21 = Stufe2 + 1
        If Stufe21 > Stufe3 Then
            Stufe21 = Stufe3
        End If
        Stufe22 = Stufe2 + 2
        If Stufe22 > Stufe3 Then
            Stufe22 = Stufe3
        End If
        Stufe23 = Stufe2 + 3
        If Stufe23 > Stufe3 Then
            Stufe23 = Stufe3
        End If
        Stufe24 = Stufe2 + 4
        If Stufe24 > Stufe3 Then
            Stufe24 = Stufe3
        End If

        If G_200 > 0 Then
            If G_200 < Stufe4 Then
                G_200 = Stufe4
            End If
        Else
            G_200 = Stufe4
        End If

        If Betriebsart = 1 And (_GlsL79 = 3 Or _GlsL79 = 4) Then
            SetProgramCounterLabel1(_Prog79)
        Else
            SetProgramCounterLabel(_Prog79)
        End If

        ' Lok starten - Bahnhofsausfahrt

        If _Prog79 = 0 Then
            Prog_Lok79.Interval = 2000
        ElseIf _Prog79 = 1 Then
            If _Dampf > 0 Then
                _eb.lokSteuern(79, Klassen.LokEigenschaften.Hauptfunktion, 1) ' Dampf ein
            Else
                _Prog79 = 6
            End If
        ElseIf _Prog79 = 2 Then
            _Betriebsparameter.RundenErhoehen(79)
        ElseIf _Prog79 = 3 Then
        ElseIf _Prog79 = 4 Then
        ElseIf _Prog79 = 5 Then
        ElseIf _Prog79 = 6 Then
        ElseIf _Prog79 = 7 Then
        ElseIf _Prog79 = 8 Then
        ElseIf _Prog79 = 9 Then
        ElseIf _Prog79 = 10 Then
        ElseIf _Prog79 = 11 Then
        ElseIf _Prog79 = 12 Then


            ' Bahnhofsausfahrt

        ElseIf _Prog79 = 13 Then
            _eb.lokSteuern(79, Klassen.LokEigenschaften.Geschwindigkeit, Stufe1)
        ElseIf _Prog79 = 14 Then
            _eb.lokSteuern(79, Klassen.LokEigenschaften.Geschwindigkeit, Stufe11)
        ElseIf _Prog79 = 15 Then
            _eb.lokSteuern(79, Klassen.LokEigenschaften.Geschwindigkeit, Stufe12)
            If _Dampf < 2 Then
                _eb.lokSteuern(79, Klassen.LokEigenschaften.Hauptfunktion, 0) ' Dampf aus
            End If
        ElseIf _Prog79 = 16 Then
            _eb.lokSteuern(79, Klassen.LokEigenschaften.Geschwindigkeit, Stufe13)
        ElseIf _Prog79 = 17 Then
            _eb.lokSteuern(79, Klassen.LokEigenschaften.Geschwindigkeit, Stufe14)
        ElseIf _Prog79 = 18 Then
            _eb.lokSteuern(79, Klassen.LokEigenschaften.Geschwindigkeit, Stufe3)

            ' Lok abstellen

        ElseIf _Prog79 = 50 Then
            Prog_Lok79.Interval = 2000
        ElseIf _Prog79 = 51 Then ' *** Lok hat keine Lichtfunktion
        ElseIf _Prog79 = 52 Then
        ElseIf _Prog79 = 53 Then

            ' Lok bremsen (Bahnhofseinfahrt Normalzug von links und von rechts)

        ElseIf _Prog79 = 100 Then
            Prog_Lok79.Interval = V_100
        ElseIf _Prog79 = 101 Then
            _eb.lokSteuern(79, Klassen.LokEigenschaften.Geschwindigkeit, Stufe24)
            Prog_Lok79.Interval = T_100
        ElseIf _Prog79 = 102 Then
            _eb.lokSteuern(79, Klassen.LokEigenschaften.Geschwindigkeit, Stufe23)
        ElseIf _Prog79 = 103 Then
            _eb.lokSteuern(79, Klassen.LokEigenschaften.Geschwindigkeit, Stufe22)
        ElseIf _Prog79 = 104 Then
            _eb.lokSteuern(79, Klassen.LokEigenschaften.Geschwindigkeit, Stufe21)
        ElseIf _Prog79 = 105 Then
            _eb.lokSteuern(79, Klassen.LokEigenschaften.Geschwindigkeit, Stufe2)

            ' Lok bremsen (Bahnhofseinfahrt Kurzzug von links)

        ElseIf _Prog79 = 130 Then
            Prog_Lok79.Interval = V_130
        ElseIf _Prog79 = 131 Then
            _eb.lokSteuern(79, Klassen.LokEigenschaften.Geschwindigkeit, Stufe24)
            Prog_Lok79.Interval = T_130
        ElseIf _Prog79 = 132 Then
            _eb.lokSteuern(79, Klassen.LokEigenschaften.Geschwindigkeit, Stufe23)
        ElseIf _Prog79 = 133 Then
            _eb.lokSteuern(79, Klassen.LokEigenschaften.Geschwindigkeit, Stufe22)
        ElseIf _Prog79 = 134 Then
            _eb.lokSteuern(79, Klassen.LokEigenschaften.Geschwindigkeit, Stufe21)
        ElseIf _Prog79 = 135 Then
            _eb.lokSteuern(79, Klassen.LokEigenschaften.Geschwindigkeit, Stufe2)
        ElseIf _Prog79 = 136 Then
            _eb.lokSteuern(79, Klassen.LokEigenschaften.Geschwindigkeit, 0)
        ElseIf _Prog79 = 137 Then
            Prog_Lok79.Interval = 2000
        ElseIf _Prog79 = 138 Then
            If _Dampf < 3 Then
                _eb.lokSteuern(79, Klassen.LokEigenschaften.Hauptfunktion, 0) ' Dampf aus
            End If

            ' Lok bremsen (Bahnhofseinfahrt Kurzzug von rechts)

        ElseIf _Prog79 = 160 Then
            Prog_Lok79.Interval = V_160
        ElseIf _Prog79 = 161 Then
            _eb.lokSteuern(79, Klassen.LokEigenschaften.Geschwindigkeit, Stufe24)
            Prog_Lok79.Interval = T_160
        ElseIf _Prog79 = 162 Then
            _eb.lokSteuern(79, Klassen.LokEigenschaften.Geschwindigkeit, Stufe23)
        ElseIf _Prog79 = 163 Then
            _eb.lokSteuern(79, Klassen.LokEigenschaften.Geschwindigkeit, Stufe22)
        ElseIf _Prog79 = 164 Then
            _eb.lokSteuern(79, Klassen.LokEigenschaften.Geschwindigkeit, Stufe21)
        ElseIf _Prog79 = 165 Then
            _eb.lokSteuern(79, Klassen.LokEigenschaften.Geschwindigkeit, Stufe2)
        ElseIf _Prog79 = 166 Then
            _eb.lokSteuern(79, Klassen.LokEigenschaften.Geschwindigkeit, 0)
        ElseIf _Prog79 = 167 Then
            Prog_Lok79.Interval = 2000
        ElseIf _Prog79 = 168 Then
            If _Dampf < 3 Then
                _eb.lokSteuern(79, Klassen.LokEigenschaften.Hauptfunktion, 0) ' Dampf aus
            End If

            ' Rangierzug

        ElseIf _Prog79 = 180 Then
            _eb.lokSteuern(79, Klassen.LokEigenschaften.Geschwindigkeit, Stufe2)
            Prog_Lok79.Interval = V_180
        ElseIf _Prog79 = 181 Then
            _eb.lokSteuern(79, Klassen.LokEigenschaften.Geschwindigkeit, 0)
            Prog_Lok79.Interval = T_180
        ElseIf _Prog79 = 182 Then
            _eb.lokSteuern(79, Klassen.LokEigenschaften.Geschwindigkeit, 0)

            ' Tunnelausfahrt

        ElseIf _Prog79 = 200 Then ' Kontakt 1.2 <- (bergauf)
            _eb.lokSteuern(79, Klassen.LokEigenschaften.Geschwindigkeit, G_200)
        ElseIf _Prog79 = 201 Then
            Prog_Lok79.Interval = 2000
        ElseIf _Prog79 = 202 Then
            If _Dampf > 0 Then
                _eb.lokSteuern(79, Klassen.LokEigenschaften.Hauptfunktion, 1) ' Dampf ein
            End If
        ElseIf _Prog79 = 203 Then
        ElseIf _Prog79 = 204 Then
            If Stufe4 < 10 Then
                _eb.lokSteuern(79, Klassen.LokEigenschaften.Geschwindigkeit, 10)
            Else
                _eb.lokSteuern(79, Klassen.LokEigenschaften.Geschwindigkeit, Stufe4)
            End If
        ElseIf _Prog79 = 205 Then
        ElseIf _Prog79 = 206 Then
            If Stufe4 < Stufe3 Then
                _eb.lokSteuern(79, Klassen.LokEigenschaften.Geschwindigkeit, Stufe3)
            Else
                _eb.lokSteuern(79, Klassen.LokEigenschaften.Geschwindigkeit, Stufe4)
            End If
        ElseIf _Prog79 = 207 Then
            If _Dampf < 2 Then
                _eb.lokSteuern(79, Klassen.LokEigenschaften.Hauptfunktion, 0) ' Dampf aus
            End If
        ElseIf _Prog79 = 208 Then
        ElseIf _Prog79 = 209 Then
        ElseIf _Prog79 = 210 Then

        ElseIf _Prog79 = 220 Then ' Kontakt 3.1 -> (hinter dem Martinstor bergauf)
            Prog_Lok79.Interval = 2000
        ElseIf _Prog79 = 221 Then
        ElseIf _Prog79 = 222 Then
            If _Dampf < 3 Then
                _eb.lokSteuern(79, Klassen.LokEigenschaften.Funktion1, 0) ' Dampf aus
            End If
        ElseIf _Prog79 = 223 Then
            If _Motor < 3 Then
                _eb.lokSteuern(79, Klassen.LokEigenschaften.Funktion2, 1) ' Dampfgeräusch aus
            End If

        ElseIf _Prog79 = 240 Then ' Kontakt 3.7 <- (hinter der Brücke bergauf)
            Prog_Lok79.Interval = 2000
        ElseIf _Prog79 = 241 Then
        ElseIf _Prog79 = 242 Then

        ElseIf _Prog79 = 260 Then ' Kontakt 3.3 (links bzw vor der Brücke)
            Prog_Lok79.Interval = 2000
        ElseIf _Prog79 = 261 Then
        ElseIf _Prog79 = 262 Then
            _eb.lokSteuern(79, Klassen.LokEigenschaften.Geschwindigkeit, Stufe3)

        ElseIf _Prog79 = 600 Then ' Kontakt 3.5 <- (unter der Burg)
            Prog_Lok79.Interval = 2000
        ElseIf _Prog79 = 601 Then
        ElseIf _Prog79 = 602 Then

        ElseIf _Prog79 = 620 Then ' Kontakt 3.7 -> (hinter der Brücke bergab)
            Prog_Lok79.Interval = 2000
        ElseIf _Prog79 = 621 Then
        ElseIf _Prog79 = 622 Then

        ElseIf _Prog79 = 640 Then ' Kontakt 3.1 <- Talfahrt
            Prog_Lok79.Interval = 2000
        ElseIf _Prog79 = 641 Then
        ElseIf _Prog79 = 642 Then

        ElseIf _Prog79 = 660 Then ' Kontakt 1.2 -> Talfahrt
            Prog_Lok79.Interval = 2000
        ElseIf _Prog79 = 661 Then
        ElseIf _Prog79 = 662 Then

        ElseIf _Prog79 = 700 Then ' Kontakt 0.4 <- Diagonale
            Prog_Lok79.Interval = 2000
        ElseIf _Prog79 = 701 Then
        ElseIf _Prog79 = 702 Then


            ' Zindelstein

        ElseIf _Prog79 = 500 Then
            Prog_Lok79.Interval = V_500
        ElseIf _Prog79 = 501 Then
            _eb.lokSteuern(79, Klassen.LokEigenschaften.Geschwindigkeit, Stufe23)
            Prog_Lok79.Interval = T_500
        ElseIf _Prog79 = 502 Then
            _eb.lokSteuern(79, Klassen.LokEigenschaften.Geschwindigkeit, Stufe22)
        ElseIf _Prog79 = 503 Then
            _eb.lokSteuern(79, Klassen.LokEigenschaften.Geschwindigkeit, Stufe21)
        ElseIf _Prog79 = 504 Then
            _eb.lokSteuern(79, Klassen.LokEigenschaften.Geschwindigkeit, Stufe2)
        ElseIf _Prog79 = 505 Then
            _eb.lokSteuern(79, Klassen.LokEigenschaften.Geschwindigkeit, 0)


        Else
            _Prog79 = 0
            Prog_Lok79.Stop()
            Prog_Lok79.Interval = 200
            If Betriebsart = 1 Then
                SetProgramCounterLabel1(String.Empty)
            Else
                SetProgramCounterLabel(String.Empty)
            End If
        End If
        _Prog79 = _Prog79 + 1
    End Sub
    Private Sub HandleTimerElapsed92(sender As System.Object, e As System.EventArgs) Handles Prog_Lok80.Elapsed

        '*** Fahrprogramm für Dampflok 3029
        '*** Datum: 23.02.2020 +

        SetText(TextBox1, "Dampflok 3029                                                           IBS: nein")
        LoadImage(PictureBox1, "H:\\EB_Media\\LokFotos\\Baureihe_3029_01.jpg")
        GeschwindikeitenSetzen(80)

        Dim Stufe1, Stufe2, Stufe3, Stufe4 As Integer
        Dim Stufe11, Stufe12, Stufe13, Stufe14, Stufe21, Stufe22, Stufe23, Stufe24 As Integer
        Dim V_100, V_130, V_160, V_180, V_500 As Integer
        Dim T_100, T_130, T_160, T_180, T_500 As Integer
        Dim G_200 As Integer

        T_100 = _Betriebsparameter.Fahrparameter(80, KlausEBspecific.Betriebsparameter.FahrparameterEnum.T_100)
        T_130 = _Betriebsparameter.Fahrparameter(80, KlausEBspecific.Betriebsparameter.FahrparameterEnum.T_130)
        T_160 = _Betriebsparameter.Fahrparameter(80, KlausEBspecific.Betriebsparameter.FahrparameterEnum.T_160)
        T_180 = _Betriebsparameter.Fahrparameter(80, KlausEBspecific.Betriebsparameter.FahrparameterEnum.T_180)
        T_500 = _Betriebsparameter.Fahrparameter(80, KlausEBspecific.Betriebsparameter.FahrparameterEnum.T_500)
        V_100 = _Betriebsparameter.Fahrparameter(80, KlausEBspecific.Betriebsparameter.FahrparameterEnum.V_100)
        V_130 = _Betriebsparameter.Fahrparameter(80, KlausEBspecific.Betriebsparameter.FahrparameterEnum.V_130)
        V_160 = _Betriebsparameter.Fahrparameter(80, KlausEBspecific.Betriebsparameter.FahrparameterEnum.V_160)
        V_180 = _Betriebsparameter.Fahrparameter(80, KlausEBspecific.Betriebsparameter.FahrparameterEnum.V_180)
        V_500 = _Betriebsparameter.Fahrparameter(80, KlausEBspecific.Betriebsparameter.FahrparameterEnum.V_500)
        G_200 = _Betriebsparameter.Fahrparameter(80, KlausEBspecific.Betriebsparameter.FahrparameterEnum.G_200)

        If A_StopB = 1 Then
            V_100 = 8000
        End If

        Stufe1 = _LokStufen.Holen(80, 1)
        Stufe2 = _LokStufen.Holen(80, 2)
        Stufe3 = _LokStufen.Holen(80, 3)
        Stufe4 = _LokStufen.Holen(80, 4)

        If Stufe2 = 1 Then
            T_100 = T_100
            T_130 = T_130
            T_160 = T_160
            V_180 = V_180
        ElseIf Stufe2 = 2 Then
            T_100 = T_100 + 300
            T_130 = T_130 + 300
            T_160 = T_160 + 300
            V_180 = V_180 + 500
        ElseIf Stufe2 = 3 Then
            T_100 = T_100 + 500
            T_130 = T_130 + 500
            T_160 = T_160 + 500
            V_180 = V_180 + 1000
        ElseIf Stufe2 = 4 Then
            T_100 = T_100 + 700
            T_130 = T_130 + 700
            T_160 = T_160 + 700
            V_180 = V_180 + 1500
        ElseIf Stufe2 = 5 Then
            T_100 = T_100 + 900
            T_130 = T_130 + 900
            T_160 = T_160 + 900
            V_180 = V_180 + 2000
        ElseIf Stufe2 = 6 Then
            T_100 = T_100 + 1200
            T_130 = T_130 + 1200
            T_160 = T_160 + 1200
            V_180 = V_180 + 2500
        Else
            T_100 = T_100 + 1200
            T_130 = T_130 + 1200
            T_160 = T_160 + 1200
            V_180 = V_180 + 2500
        End If

        Stufe2 = Stufe1

        Stufe11 = Stufe1 + 1
        If Stufe11 > Stufe3 Then
            Stufe11 = Stufe3
        End If
        Stufe12 = Stufe1 + 2
        If Stufe12 > Stufe3 Then
            Stufe12 = Stufe3
        End If
        Stufe13 = Stufe1 + 3
        If Stufe13 > Stufe3 Then
            Stufe13 = Stufe3
        End If
        Stufe14 = Stufe1 + 4
        If Stufe14 > Stufe3 Then
            Stufe14 = Stufe3
        End If

        Stufe21 = Stufe2 + 1
        If Stufe21 > Stufe3 Then
            Stufe21 = Stufe3
        End If
        Stufe22 = Stufe2 + 2
        If Stufe22 > Stufe3 Then
            Stufe22 = Stufe3
        End If
        Stufe23 = Stufe2 + 3
        If Stufe23 > Stufe3 Then
            Stufe23 = Stufe3
        End If
        Stufe24 = Stufe2 + 4
        If Stufe24 > Stufe3 Then
            Stufe24 = Stufe3
        End If
        If G_200 > 0 Then
            If G_200 < Stufe4 Then
                G_200 = Stufe4
            End If
        Else
            G_200 = Stufe4
        End If

        If Betriebsart = 1 And (_GlsL80 = 3 Or _GlsL80 = 4) Then
            SetProgramCounterLabel1(_Prog80)
        Else
            SetProgramCounterLabel(_Prog80)
        End If

        ' Lok starten - Bahnhofsausfahrt

        If _Prog80 = 0 Then
            Prog_Lok80.Interval = 2000
        ElseIf _Prog80 = 1 Then
        ElseIf _Prog80 = 2 Then
            _Betriebsparameter.RundenErhoehen(80)
        ElseIf _Prog80 = 3 Then
        ElseIf _Prog80 = 4 Then
        ElseIf _Prog80 = 5 Then
        ElseIf _Prog80 = 6 Then

            ' Bahnhofsausfahrt

        ElseIf _Prog80 = 7 Then
            _eb.lokSteuern(80, Klassen.LokEigenschaften.Geschwindigkeit, Stufe1)
        ElseIf _Prog80 = 8 Then
            _eb.lokSteuern(80, Klassen.LokEigenschaften.Geschwindigkeit, Stufe11)
        ElseIf _Prog80 = 9 Then
            _eb.lokSteuern(80, Klassen.LokEigenschaften.Geschwindigkeit, Stufe12)
        ElseIf _Prog80 = 10 Then
            _eb.lokSteuern(80, Klassen.LokEigenschaften.Geschwindigkeit, Stufe13)
        ElseIf _Prog80 = 11 Then
            _eb.lokSteuern(80, Klassen.LokEigenschaften.Geschwindigkeit, Stufe14)
        ElseIf _Prog80 = 12 Then
            _eb.lokSteuern(80, Klassen.LokEigenschaften.Geschwindigkeit, Stufe3)

            ' Lok abstellen

        ElseIf _Prog80 = 50 Then
            Prog_Lok80.Interval = 2000
        ElseIf _Prog80 = 51 Then ' *** Lok hat keine Lichtfunktion
        ElseIf _Prog80 = 52 Then

            ' Lok bremsen (Bahnhofseinfahrt Normalzug von links und von rechts)

        ElseIf _Prog80 = 100 Then
            Prog_Lok80.Interval = V_100
        ElseIf _Prog80 = 101 Then
            _eb.lokSteuern(80, Klassen.LokEigenschaften.Geschwindigkeit, Stufe24)
            Prog_Lok80.Interval = T_100
        ElseIf _Prog80 = 102 Then
            _eb.lokSteuern(80, Klassen.LokEigenschaften.Geschwindigkeit, Stufe23)
        ElseIf _Prog80 = 103 Then
            _eb.lokSteuern(80, Klassen.LokEigenschaften.Geschwindigkeit, Stufe22)
        ElseIf _Prog80 = 104 Then
            _eb.lokSteuern(80, Klassen.LokEigenschaften.Geschwindigkeit, Stufe21)
        ElseIf _Prog80 = 105 Then
            _eb.lokSteuern(80, Klassen.LokEigenschaften.Geschwindigkeit, Stufe2)

            ' Lok bremsen (Bahnhofseinfahrt Kurzzug von links)

        ElseIf _Prog80 = 130 Then
            Prog_Lok80.Interval = V_130
        ElseIf _Prog80 = 131 Then
            _eb.lokSteuern(80, Klassen.LokEigenschaften.Geschwindigkeit, Stufe24)
            Prog_Lok80.Interval = T_130
        ElseIf _Prog80 = 132 Then
            _eb.lokSteuern(80, Klassen.LokEigenschaften.Geschwindigkeit, Stufe23)
        ElseIf _Prog80 = 133 Then
            _eb.lokSteuern(80, Klassen.LokEigenschaften.Geschwindigkeit, Stufe22)
        ElseIf _Prog80 = 134 Then
            _eb.lokSteuern(80, Klassen.LokEigenschaften.Geschwindigkeit, Stufe21)
        ElseIf _Prog80 = 135 Then
            _eb.lokSteuern(80, Klassen.LokEigenschaften.Geschwindigkeit, Stufe2)
        ElseIf _Prog80 = 136 Then
            _eb.lokSteuern(80, Klassen.LokEigenschaften.Geschwindigkeit, 0)

            ' Lok bremsen (Bahnhofseinfahrt Kurzzug von rechts)

        ElseIf _Prog80 = 160 Then
            Prog_Lok80.Interval = V_160
        ElseIf _Prog80 = 161 Then
            _eb.lokSteuern(80, Klassen.LokEigenschaften.Geschwindigkeit, Stufe24)
            Prog_Lok80.Interval = T_160
        ElseIf _Prog80 = 162 Then
            _eb.lokSteuern(80, Klassen.LokEigenschaften.Geschwindigkeit, Stufe23)
        ElseIf _Prog80 = 163 Then
            _eb.lokSteuern(80, Klassen.LokEigenschaften.Geschwindigkeit, Stufe22)
        ElseIf _Prog80 = 164 Then
            _eb.lokSteuern(80, Klassen.LokEigenschaften.Geschwindigkeit, Stufe21)
        ElseIf _Prog80 = 165 Then
            _eb.lokSteuern(80, Klassen.LokEigenschaften.Geschwindigkeit, Stufe2)
        ElseIf _Prog80 = 166 Then
            _eb.lokSteuern(80, Klassen.LokEigenschaften.Geschwindigkeit, 0)

            ' Rangierzug

        ElseIf _Prog80 = 180 Then
            _eb.lokSteuern(80, Klassen.LokEigenschaften.Geschwindigkeit, 5)
            Prog_Lok80.Interval = V_180
        ElseIf _Prog80 = 181 Then
            Prog_Lok80.Interval = T_180
            _eb.lokSteuern(80, Klassen.LokEigenschaften.Geschwindigkeit, 4)
        ElseIf _Prog80 = 182 Then
            _eb.lokSteuern(80, Klassen.LokEigenschaften.Geschwindigkeit, 0)

            ' Tunnelausfahrt

        ElseIf _Prog80 = 200 Then ' Kontakt 1.2 <- (bergauf)
            _eb.lokSteuern(80, Klassen.LokEigenschaften.Geschwindigkeit, G_200)
            Prog_Lok80.Interval = 2000
        ElseIf _Prog80 = 201 Then
        ElseIf _Prog80 = 202 Then
        ElseIf _Prog80 = 203 Then
        ElseIf _Prog80 = 204 Then
        ElseIf _Prog80 = 205 Then
            If Stufe4 < Stufe3 Then
                _eb.lokSteuern(80, Klassen.LokEigenschaften.Geschwindigkeit, Stufe3)
            Else
                _eb.lokSteuern(80, Klassen.LokEigenschaften.Geschwindigkeit, Stufe4)
            End If

        ElseIf _Prog80 = 220 Then ' Kontakt 3.1 -> (hinter dem Martinstor bergauf)
            Prog_Lok80.Interval = 2000
        ElseIf _Prog80 = 221 Then
        ElseIf _Prog80 = 222 Then

        ElseIf _Prog80 = 240 Then ' Kontakt 3.7 <- (hinter der Brücke bergauf)
            Prog_Lok80.Interval = 2000
        ElseIf _Prog80 = 241 Then
        ElseIf _Prog80 = 242 Then

        ElseIf _Prog80 = 260 Then ' Kontakt 3.3 (links bzw vor der Brücke)
            Prog_Lok80.Interval = 2000
        ElseIf _Prog80 = 261 Then
        ElseIf _Prog80 = 262 Then
            _eb.lokSteuern(80, Klassen.LokEigenschaften.Geschwindigkeit, Stufe3)

        ElseIf _Prog80 = 600 Then ' Kontakt 3.5 <- (unter der Burg)
            Prog_Lok80.Interval = 2000
        ElseIf _Prog80 = 601 Then
        ElseIf _Prog80 = 602 Then

        ElseIf _Prog80 = 620 Then ' Kontakt 3.7 -> (hinter der Brücke bergab)
            Prog_Lok80.Interval = 2000
        ElseIf _Prog80 = 621 Then
        ElseIf _Prog80 = 622 Then

        ElseIf _Prog80 = 640 Then ' Kontakt 3.1 <- Talfahrt
            Prog_Lok80.Interval = 2000
        ElseIf _Prog80 = 641 Then
        ElseIf _Prog80 = 642 Then

        ElseIf _Prog80 = 660 Then ' Kontakt 1.2 -> Talfahrt
            Prog_Lok80.Interval = 2000
        ElseIf _Prog80 = 661 Then
        ElseIf _Prog80 = 662 Then

        ElseIf _Prog80 = 700 Then ' Kontakt 0.4 <- Diagonale
            Prog_Lok80.Interval = 2000
        ElseIf _Prog80 = 701 Then
        ElseIf _Prog80 = 702 Then

            ' Zindelstein

        ElseIf _Prog80 = 500 Then
            Prog_Lok80.Interval = V_500
        ElseIf _Prog80 = 501 Then
            _eb.lokSteuern(80, Klassen.LokEigenschaften.Geschwindigkeit, Stufe23)
            Prog_Lok80.Interval = T_500
        ElseIf _Prog80 = 502 Then
            _eb.lokSteuern(80, Klassen.LokEigenschaften.Geschwindigkeit, Stufe22)
        ElseIf _Prog80 = 503 Then
            _eb.lokSteuern(80, Klassen.LokEigenschaften.Geschwindigkeit, Stufe21)
        ElseIf _Prog80 = 504 Then
            _eb.lokSteuern(80, Klassen.LokEigenschaften.Geschwindigkeit, Stufe2)
        ElseIf _Prog80 = 505 Then
            _eb.lokSteuern(80, Klassen.LokEigenschaften.Geschwindigkeit, 0)


        Else
            _Prog80 = 0
            Prog_Lok80.Stop()
            Prog_Lok80.Interval = 200
            If Betriebsart = 1 Then
                SetProgramCounterLabel1(String.Empty)
            Else
                SetProgramCounterLabel(String.Empty)
            End If
        End If
        _Prog80 = _Prog80 + 1
    End Sub

    Private Sub HandleTimerElapsed93(sender As System.Object, e As System.EventArgs) Handles Timer_Kamera0.Elapsed
        Timer_Kamera0.Stop()
        If _Kamera = 3 Then
            If _aktuelleKamera <> Forbach Then
                _Webcams.SetWebcam(0, Forbach)
                _aktuelleKamera = Forbach
                SetText(Button13, "Hinterzarten")
            End If
        End If
    End Sub
    Private Sub HandleTimerElapsed94(sender As System.Object, e As System.EventArgs) Handles Timer_Kamera1.Elapsed
        Timer_Kamera1.Stop()
        If _Kamera = 3 Then
            If _aktuelleKamera <> Marxzel Then
                _Webcams.SetWebcam(0, Marxzel)
                _aktuelleKamera = Marxzel
                SetText(Button13, "Wiehre")
            End If
        End If
    End Sub
    Private Sub HandleTimerElapsed95(sender As System.Object, e As System.EventArgs) Handles Timer_Kamera2.Elapsed
        Timer_Kamera2.Stop()
        If _Kamera = 3 Then
            If _aktuelleKamera <> Windeck Then
                _Webcams.SetWebcam(0, Windeck)
                _aktuelleKamera = Windeck
                SetText(Button13, "Titisee")
            End If
        End If
    End Sub
    Private Sub HandleTimerElapsed97(sender As System.Object, e As System.EventArgs) Handles Delay_Automatik_110.Elapsed
        Delay_Automatik_110.Stop()
        AutomatikParameter = 110
    End Sub
    Private Sub HandleTimerElapsed98(sender As System.Object, e As System.EventArgs) Handles Delay_Automatik_210.Elapsed
        Delay_Automatik_210.Stop()
        AutomatikParameter = 210
    End Sub

    ' *** Kontakt 0.0 false - Bahnhofsausfahrt
    Private Sub BahnhofsausfahrtLok1(Kontakt)
        If Kontakt.Modul = 0 And Kontakt.Adresse = 0 And Kontakt.status = False And AutomatikParameter = 100 Then
            If _Route_Gleis1 = 0 Or _Route_Gleis1 = 2 Then
                If _SBhf_Gleis1 > 0 Then
                    _eb.weicheSchalten(11, Klassen.WeichenRichtung.rechts)
                Else
                    _eb.weicheSchalten(11, Klassen.WeichenRichtung.links)
                End If
            End If
            AutomatikParameter = 101
        End If
    End Sub
    ' *** Kontakt 0.2 false
    Private Sub BahnhofsausfahrtLok2(Kontakt)
        If Kontakt.Modul = 0 And Kontakt.Adresse = 2 And Kontakt.status = False And AutomatikParameter = 200 Then
            If _Route_Gleis2 = 0 Or _Route_Gleis2 = 2 Then
                If _SBhf_Gleis2 > 0 Then
                    _eb.weicheSchalten(11, Klassen.WeichenRichtung.rechts)
                Else
                    _eb.weicheSchalten(11, Klassen.WeichenRichtung.links)
                End If
            End If
            AutomatikParameter = 201
        End If
    End Sub
    ' *** Kontakt 1.6 false
    Private Sub BahnhofsausfahrtLok3(Kontakt)
        If Kontakt.Modul = 1 And Kontakt.Adresse = 6 And Kontakt.status = False And AutomatikParameter = 300 Then
            If _Route_Gleis3 = 0 Then
                If _SBhf_Gleis3 > 0 Then
                    _eb.weicheSchalten(9, Klassen.WeichenRichtung.rechts)
                Else
                    _eb.weicheSchalten(9, Klassen.WeichenRichtung.links)
                End If
            End If
            AutomatikParameter = 301
        End If
    End Sub
    ' *** Kontakt 1.4 false
    Private Sub BahnhofsausfahrtLok4(Kontakt)
        If Kontakt.Modul = 1 And Kontakt.Adresse = 4 And Kontakt.status = False And AutomatikParameter = 400 Then
            If _Route_Gleis4 = 0 Then
                If _SBhf_Gleis4 > 0 Then
                    _eb.weicheSchalten(9, Klassen.WeichenRichtung.rechts)
                Else
                    _eb.weicheSchalten(9, Klassen.WeichenRichtung.links)
                End If
            End If
            AutomatikParameter = 401
        End If
    End Sub

    ' *** Kontakt 0.5 true  -  Nur Unten
    Private Sub NurUntenLok1(Kontakt)
        If Kontakt.Modul = 0 And Kontakt.Adresse = 5 And Kontakt.status = True And AutomatikParameter = 101 Then
            Ort_Lok1 = 102
            ' *** Zug fährt durch
            If _SBhf_Gleis1 = 0 Then
                If Weiche21schalten = True Then
                    _eb.weicheSchalten(21, Klassen.WeichenRichtung.rechts)
                End If
                If Weiche23schalten = True Then
                    If _Route_Gleis1 = 0 Then
                        _eb.weicheSchalten(23, Klassen.WeichenRichtung.links)
                    ElseIf _Route_Gleis1 = 1 Then
                        ' *** keine Aktion
                    ElseIf _Route_Gleis1 = 2 Then
                        _eb.weicheSchalten(23, Klassen.WeichenRichtung.rechts)
                    End If
                End If
                AutomatikParameter = 120
                ' *** Zug hält an
            ElseIf _SBhf_Gleis1 = 1 Then
                _eb.weicheSchalten(11, Klassen.WeichenRichtung.rechts)
                Button51.BackColor = Drawing.Color.Red
                AutomatikParameter = 120
                'Timer_EinzelLok1.Interval = NumericUpDown1.Value * 1000
                Timer_EinzelLok1.Interval = Warte1SB
                Timer_EinzelLok1.Start()
                ' *** Zug 1 wechselt auf Zug 2
            ElseIf _SBhf_Gleis1 = 2 Then
                If Ort_Lok2 = 0 Or Ort_Lok2 = 200 Then
                    Button32.BackColor = Drawing.Color.Red
                ElseIf Ort_Lok2 = 202 Then
                    Button52.BackColor = Drawing.Color.Red
                ElseIf Ort_Lok2 = 203 Then
                    Button82.BackColor = Drawing.Color.Red
                ElseIf Ort_Lok2 = 205 Then
                    Button72.BackColor = Drawing.Color.Red
                ElseIf Ort_Lok2 = 212 Then
                    Button61.BackColor = Drawing.Color.Red
                ElseIf Ort_Lok2 = 220 Then
                    Button92.BackColor = Drawing.Color.Red
                End If
                AutomatikParameter = Ort_Lok2
                Timer_EinzelLok2.Interval = NumericUpDown2.Value * 1000
                Timer_EinzelLok2.Start()
                ' *** Zug 1 wechselt auf Zug 3
            ElseIf _SBhf_Gleis1 = 3 Then
                If Ort_Lok3 = 0 Or Ort_Lok3 = 300 Then
                    Button33.BackColor = Drawing.Color.Red
                ElseIf Ort_Lok3 = 310 Then
                    Button53.BackColor = Drawing.Color.Red
                ElseIf Ort_Lok3 = 303 Then
                    Button83.BackColor = Drawing.Color.Red
                ElseIf Ort_Lok3 = 305 Then
                    Button73.BackColor = Drawing.Color.Red
                ElseIf Ort_Lok3 = 312 Then
                    Button63.BackColor = Drawing.Color.Red
                ElseIf Ort_Lok3 = 320 Then
                    Button53.BackColor = Drawing.Color.Red
                End If
                AutomatikParameter = Ort_Lok3
                Timer_EinzelLok3.Interval = NumericUpDown3.Value * 1000
                Timer_EinzelLok3.Start()
                ' *** Zug 1 wechselt auf Zug 4
            ElseIf _SBhf_Gleis1 = 4 Then
                If Ort_Lok4 = 0 Or Ort_Lok4 = 400 Then
                    Button34.BackColor = Drawing.Color.Red
                ElseIf Ort_Lok1 = 402 Then
                    Button54.BackColor = Drawing.Color.Red
                ElseIf Ort_Lok4 = 403 Then
                    Button84.BackColor = Drawing.Color.Red
                ElseIf Ort_Lok4 = 405 Then
                    Button74.BackColor = Drawing.Color.Red
                ElseIf Ort_Lok4 = 412 Then
                    Button64.BackColor = Drawing.Color.Red
                ElseIf Ort_Lok4 = 420 Then
                    Button54.BackColor = Drawing.Color.Red
                End If
                AutomatikParameter = Ort_Lok4
                Timer_EinzelLok4.Interval = NumericUpDown4.Value * 1000
                Timer_EinzelLok4.Start()
            End If
        End If
    End Sub
    Private Sub NurUntenLok2(Kontakt)
        If Kontakt.Modul = 0 And Kontakt.Adresse = 5 And Kontakt.status = True And AutomatikParameter = 201 Then
            Ort_Lok2 = 202
            ' *** Zug fährt durch
            If _SBhf_Gleis2 = 0 Then
                If Weiche21schalten = True Then
                    _eb.weicheSchalten(21, Klassen.WeichenRichtung.links)
                End If
                If Weiche23schalten = True Then
                    If _Route_Gleis2 = 0 Then
                        _eb.weicheSchalten(23, Klassen.WeichenRichtung.links)
                    ElseIf _Route_Gleis2 = 1 Then
                        ' *** keine Aktion
                    ElseIf _Route_Gleis2 = 2 Then
                        _eb.weicheSchalten(23, Klassen.WeichenRichtung.rechts)
                    End If
                End If
                AutomatikParameter = 220
                ' *** Zug 2 wechselt auf Zug 1
            ElseIf _SBhf_Gleis2 = 1 Then
                If Ort_Lok1 = 0 Or Ort_Lok1 = 100 Then
                    Button31.BackColor = Drawing.Color.Red
                ElseIf Ort_Lok1 = 102 Then
                    Button51.BackColor = Drawing.Color.Red
                ElseIf Ort_Lok1 = 103 Then
                    Button81.BackColor = Drawing.Color.Red
                ElseIf Ort_Lok1 = 105 Then
                    Button71.BackColor = Drawing.Color.Red
                ElseIf Ort_Lok1 = 112 Then
                    Button61.BackColor = Drawing.Color.Red
                ElseIf Ort_Lok1 = 120 Then
                    Button91.BackColor = Drawing.Color.Red
                End If
                AutomatikParameter = Ort_Lok1
                Timer_EinzelLok1.Interval = NumericUpDown1.Value * 1000
                Timer_EinzelLok1.Start()
                ' *** Zug hält an
            ElseIf _SBhf_Gleis2 = 2 Then
                _eb.weicheSchalten(11, Klassen.WeichenRichtung.rechts)
                Button52.BackColor = Drawing.Color.Red
                AutomatikParameter = 220
                'Timer_EinzelLok2.Interval = NumericUpDown2.Value * 1000
                Timer_EinzelLok2.Interval = Warte2SB
                Timer_EinzelLok2.Start()
                ' *** Zug 2 wechselt auf Zug 3
            ElseIf _SBhf_Gleis2 = 3 Then
                _eb.weicheSchalten(11, Klassen.WeichenRichtung.rechts)
                If Ort_Lok3 = 0 Or Ort_Lok3 = 300 Then
                    Button33.BackColor = Drawing.Color.Red
                ElseIf Ort_Lok3 = 310 Then
                    Button53.BackColor = Drawing.Color.Red
                ElseIf Ort_Lok3 = 303 Then
                    Button83.BackColor = Drawing.Color.Red
                ElseIf Ort_Lok3 = 305 Then
                    Button73.BackColor = Drawing.Color.Red
                ElseIf Ort_Lok3 = 312 Then
                    Button63.BackColor = Drawing.Color.Red
                ElseIf Ort_Lok3 = 320 Then
                    Button53.BackColor = Drawing.Color.Red
                End If
                AutomatikParameter = Ort_Lok3
                Timer_EinzelLok3.Interval = NumericUpDown3.Value * 1000
                Timer_EinzelLok3.Start()
                ' *** Zug 2 wechselt auf Zug 4
            ElseIf _SBhf_Gleis2 = 4 Then
                If Ort_Lok4 = 0 Or Ort_Lok4 = 400 Then
                    Button34.BackColor = Drawing.Color.Red
                ElseIf Ort_Lok1 = 402 Then
                    Button54.BackColor = Drawing.Color.Red
                ElseIf Ort_Lok4 = 403 Then
                    Button84.BackColor = Drawing.Color.Red
                ElseIf Ort_Lok4 = 405 Then
                    Button74.BackColor = Drawing.Color.Red
                ElseIf Ort_Lok4 = 412 Then
                    Button64.BackColor = Drawing.Color.Red
                ElseIf Ort_Lok4 = 420 Then
                    Button54.BackColor = Drawing.Color.Red
                End If
                AutomatikParameter = Ort_Lok4
                Timer_EinzelLok4.Interval = NumericUpDown4.Value * 1000
                Timer_EinzelLok4.Start()
            End If
        End If
    End Sub
    ' *** Kontakt 1.3 true  -  Nur Unten
    Private Sub NurUntenLok3(Kontakt)
        If Kontakt.Modul = 1 And Kontakt.Adresse = 3 And Kontakt.status = True And AutomatikParameter = 301 Then
            Ort_Lok3 = 320
            ' *** Zug fährt durch
            If _SBhf_Gleis3 = 0 Then
                If Weiche20schalten = True Then
                    _eb.weicheSchalten(20, Klassen.WeichenRichtung.links)
                End If
                AutomatikParameter = 320
                ' *** Zug 3 wechselt auf Zug 1
            ElseIf _SBhf_Gleis3 = 1 Then
                If Ort_Lok1 = 0 Or Ort_Lok1 = 100 Then
                    Button31.BackColor = Drawing.Color.Red
                ElseIf Ort_Lok1 = 102 Then
                    Button51.BackColor = Drawing.Color.Red
                ElseIf Ort_Lok1 = 103 Then
                    Button81.BackColor = Drawing.Color.Red
                ElseIf Ort_Lok1 = 105 Then
                    Button71.BackColor = Drawing.Color.Red
                ElseIf Ort_Lok1 = 112 Then
                    Button61.BackColor = Drawing.Color.Red
                ElseIf Ort_Lok1 = 120 Then
                    Button91.BackColor = Drawing.Color.Red
                End If
                AutomatikParameter = Ort_Lok1
                Timer_EinzelLok1.Interval = NumericUpDown1.Value * 1000
                Timer_EinzelLok1.Start()
                ' *** Zug 3 wechselt auf Zug 2
            ElseIf _SBhf_Gleis3 = 2 Then
                _eb.weicheSchalten(9, Klassen.WeichenRichtung.rechts)
                If Ort_Lok2 = 0 Or Ort_Lok2 = 200 Then
                    Button32.BackColor = Drawing.Color.Red
                ElseIf Ort_Lok2 = 202 Then
                    Button52.BackColor = Drawing.Color.Red
                ElseIf Ort_Lok2 = 203 Then
                    Button82.BackColor = Drawing.Color.Red
                ElseIf Ort_Lok2 = 205 Then
                    Button72.BackColor = Drawing.Color.Red
                ElseIf Ort_Lok2 = 212 Then
                    Button62.BackColor = Drawing.Color.Red
                ElseIf Ort_Lok2 = 220 Then
                    Button52.BackColor = Drawing.Color.Red
                End If
                AutomatikParameter = Ort_Lok2
                Timer_EinzelLok2.Interval = NumericUpDown2.Value * 1000
                Timer_EinzelLok2.Start()
                ' *** Zug hält an
            ElseIf _SBhf_Gleis3 = 3 Then
                _eb.weicheSchalten(9, Klassen.WeichenRichtung.rechts)
                Button53.BackColor = Drawing.Color.Red
                'Timer_EinzelLok3.Interval = NumericUpDown3.Value * 1000
                Timer_EinzelLok3.Interval = Warte3SB
                Timer_EinzelLok3.Start()
                AutomatikParameter = 320
                ' *** Zug 3 wechselt auf Zug 4
            ElseIf _SBhf_Gleis3 = 4 Then
                If Ort_Lok4 = 0 Or Ort_Lok4 = 400 Then
                    Button34.BackColor = Drawing.Color.Red
                ElseIf Ort_Lok1 = 402 Then
                    Button54.BackColor = Drawing.Color.Red
                ElseIf Ort_Lok4 = 403 Then
                    Button84.BackColor = Drawing.Color.Red
                ElseIf Ort_Lok4 = 405 Then
                    Button74.BackColor = Drawing.Color.Red
                ElseIf Ort_Lok4 = 412 Then
                    Button64.BackColor = Drawing.Color.Red
                ElseIf Ort_Lok4 = 420 Then
                    Button54.BackColor = Drawing.Color.Red
                End If
                AutomatikParameter = Ort_Lok4
                Timer_EinzelLok4.Interval = NumericUpDown4.Value * 1000
                Timer_EinzelLok4.Start()
            End If
        End If
    End Sub
    Private Sub NurUntenLok4(Kontakt)
        If Kontakt.Modul = 1 And Kontakt.Adresse = 3 And Kontakt.status = True And AutomatikParameter = 401 Then
            Ort_Lok4 = 420
            ' *** Zug fährt durch
            If _SBhf_Gleis4 = 0 Then
                If Weiche20schalten = True Then
                    _eb.weicheSchalten(20, Klassen.WeichenRichtung.rechts)
                End If
                AutomatikParameter = 420
                ' *** Zug 4 wechselt auf Zug 1
            ElseIf _SBhf_Gleis4 = 1 Then
                If Ort_Lok1 = 0 Or Ort_Lok1 = 100 Then
                    Button31.BackColor = Drawing.Color.Red
                ElseIf Ort_Lok1 = 102 Then
                    Button51.BackColor = Drawing.Color.Red
                ElseIf Ort_Lok1 = 103 Then
                    Button81.BackColor = Drawing.Color.Red
                ElseIf Ort_Lok1 = 105 Then
                    Button71.BackColor = Drawing.Color.Red
                ElseIf Ort_Lok1 = 112 Then
                    Button61.BackColor = Drawing.Color.Red
                ElseIf Ort_Lok1 = 120 Then
                    Button91.BackColor = Drawing.Color.Red
                End If
                AutomatikParameter = Ort_Lok1
                Timer_EinzelLok1.Interval = NumericUpDown1.Value * 1000
                Timer_EinzelLok1.Start()
                ' *** Zug 4 wechselt auf Zug 2
            ElseIf _SBhf_Gleis4 = 2 Then
                If Ort_Lok2 = 0 Or Ort_Lok2 = 200 Then
                    Button32.BackColor = Drawing.Color.Red
                ElseIf Ort_Lok2 = 202 Then
                    Button52.BackColor = Drawing.Color.Red
                ElseIf Ort_Lok2 = 203 Then
                    Button82.BackColor = Drawing.Color.Red
                ElseIf Ort_Lok2 = 205 Then
                    Button72.BackColor = Drawing.Color.Red
                ElseIf Ort_Lok2 = 212 Then
                    Button61.BackColor = Drawing.Color.Red
                ElseIf Ort_Lok2 = 220 Then
                    Button92.BackColor = Drawing.Color.Red
                End If
                AutomatikParameter = Ort_Lok2
                Timer_EinzelLok2.Interval = NumericUpDown2.Value * 1000
                Timer_EinzelLok2.Start()
                ' *** Zug 4 wechselt auf Zug 3
            ElseIf _SBhf_Gleis4 = 3 Then
                If Ort_Lok3 = 0 Or Ort_Lok3 = 300 Then
                    Button33.BackColor = Drawing.Color.Red
                ElseIf Ort_Lok3 = 310 Then
                    Button53.BackColor = Drawing.Color.Red
                ElseIf Ort_Lok3 = 303 Then
                    Button83.BackColor = Drawing.Color.Red
                ElseIf Ort_Lok3 = 305 Then
                    Button73.BackColor = Drawing.Color.Red
                ElseIf Ort_Lok3 = 312 Then
                    Button63.BackColor = Drawing.Color.Red
                ElseIf Ort_Lok3 = 320 Then
                    Button93.BackColor = Drawing.Color.Red
                End If
                AutomatikParameter = Ort_Lok3
                Timer_EinzelLok3.Interval = NumericUpDown2.Value * 1000
                Timer_EinzelLok3.Start()
                ' *** Zug hält an
            ElseIf _SBhf_Gleis4 = 4 Then
                _eb.weicheSchalten(9, Klassen.WeichenRichtung.rechts)
                Button54.BackColor = Drawing.Color.Red
                AutomatikParameter = 420
                'Timer_EinzelLok4.Interval = NumericUpDown4.Value * 1000
                Timer_EinzelLok4.Interval = Warte4SB
                Timer_EinzelLok4.Start()
            End If
        End If
    End Sub

    ' *** Kontakt 0.4 true Diagonale  -->
    Private Sub ObenKurzLok1(Kontakt)
        If Kontakt.Modul = 0 And Kontakt.Adresse = 4 And Kontakt.status = True And AutomatikParameter = 101 Then
            'AutomatikParameter = 110
            Delay_Automatik_110.Interval = 9000
            Delay_Automatik_110.Start()
            AutomatikParameter = 102
            Ort_Lok1 = 110
            If _Kamera = 3 And _aktuelleKamera <> Forbach Then
                Timer_Kamera0.Interval = 9000
                Timer_Kamera0.Start()
            End If
        End If
    End Sub
    Private Sub ObenKurzLok2(Kontakt)
        If Kontakt.Modul = 0 And Kontakt.Adresse = 4 And Kontakt.status = True And AutomatikParameter = 201 Then
            'AutomatikParameter = 210
            Delay_Automatik_210.Interval = 9000
            Delay_Automatik_210.Start()
            AutomatikParameter = 202
            Ort_Lok2 = 210
            If _Kamera = 3 And _aktuelleKamera <> Forbach Then
                Timer_Kamera0.Interval = 9000
                Timer_Kamera0.Start()
            End If
        End If
    End Sub
    Private Sub ObenLang104Lok3()
        AutomatikParameter = 307
        Ort_Lok3 = 317
        If _Kamera = 3 And _aktuelleKamera <> Forbach Then
            Timer_Kamera0.Interval = 9000
            Timer_Kamera0.Start()
        End If
    End Sub
    Private Sub ObenLang104Lok4()
        AutomatikParameter = 407
        Ort_Lok4 = 417
        If _Kamera = 3 And _aktuelleKamera <> Forbach Then
            Timer_Kamera0.Interval = 9000
            Timer_Kamera0.Start()
        End If
    End Sub

    ' *** Kontakt 0.4 - Diagonale <--
    Private Sub ObenLang102Lok1()
        AutomatikParameter = 103
        Ort_Lok1 = 103
        ' *** Zug hält an
        If Diagonale_Gleis1 = 1 Then
            _eb.weicheSchalten(10, Klassen.WeichenRichtung.rechts)
            Button81.BackColor = Drawing.Color.Red
            Timer_EinzelLok1.Interval = Warte1DI
            Timer_EinzelLok1.Start()
        End If
        'If _GleisFrei2 = 1 And Betriebsart12 = 1 And Betriebsart34 = 0 Then
        '    _eb.weicheSchalten(19, Klassen.WeichenRichtung.rechts)
        '    _eb.weicheSchalten(21, Klassen.WeichenRichtung.links)
        'End If
        'If _GleisFrei3 = 1 And Betriebsart12 = 1 And Betriebsart34 = 0 Then
        '    _eb.weicheSchalten(14, Klassen.WeichenRichtung.rechts)
        '    _eb.weicheSchalten(20, Klassen.WeichenRichtung.links)
        'End If
        'If _GleisFrei4 = 1 And Betriebsart12 = 1 And Betriebsart34 = 0 Then
        '    _eb.weicheSchalten(14, Klassen.WeichenRichtung.rechts)
        '    _eb.weicheSchalten(20, Klassen.WeichenRichtung.rechts)
        'End If
        If Weiche14schalten = True Then
            _eb.weicheSchalten(14, Klassen.WeichenRichtung.links)
        End If
        If Weiche19schalten = True Then
            _eb.weicheSchalten(19, Klassen.WeichenRichtung.links)
        End If
        If _Kamera = 3 And _aktuelleKamera <> Marxzel Then
            _Webcams.SetWebcam(0, Marxzel)
            SetText(Button13, "Wiehre")
            _aktuelleKamera = Marxzel
        End If
    End Sub
    Private Sub ObenLang102Lok2()
        AutomatikParameter = 203
        Ort_Lok2 = 203
        ' *** Zug hält an
        If Diagonale_Gleis2 = 2 Then
            _eb.weicheSchalten(10, Klassen.WeichenRichtung.rechts)
            Button82.BackColor = Drawing.Color.Red
            Timer_EinzelLok2.Interval = Warte2DI
            Timer_EinzelLok2.Start()
        End If
        If Weiche14schalten = True Then
            _eb.weicheSchalten(14, Klassen.WeichenRichtung.links)
        End If
        If Weiche19schalten = True Then
            _eb.weicheSchalten(19, Klassen.WeichenRichtung.rechts)
        End If
        If _Kamera = 3 And _aktuelleKamera <> Marxzel Then
            _Webcams.SetWebcam(0, Marxzel)
            SetText(Button13, "Wiehre")
            _aktuelleKamera = Marxzel
        End If
    End Sub
    Private Sub ObenKurzLok3(Kontakt)
        If Kontakt.Modul = 0 And Kontakt.Adresse = 4 And Kontakt.status = True And AutomatikParameter = 310 Then
            AutomatikParameter = 320
            Ort_Lok3 = 310
            If Weiche14schalten = True Then
                _eb.weicheSchalten(14, Klassen.WeichenRichtung.rechts)
            End If
            If Weiche20schalten = True Then
                _eb.weicheSchalten(20, Klassen.WeichenRichtung.links)
            End If
            If Diagonale_Gleis3 = 3 Then
                _eb.weicheSchalten(10, Klassen.WeichenRichtung.rechts)
                Button83.BackColor = Drawing.Color.Red
                Timer_EinzelLok3.Interval = Warte3DI
                Timer_EinzelLok3.Start()
            Else
                Zug3(700)
            End If
            If _Kamera = 3 And _aktuelleKamera <> Marxzel Then
                Timer_Kamera1.Interval = 100
                Timer_Kamera1.Start()
            End If
        End If
    End Sub
    Private Sub ObenKurzLok4(Kontakt)
        If Kontakt.Modul = 0 And Kontakt.Adresse = 4 And Kontakt.status = True And AutomatikParameter = 410 Then
            AutomatikParameter = 420
            Ort_Lok4 = 410
            If Weiche14schalten = True Then
                _eb.weicheSchalten(14, Klassen.WeichenRichtung.rechts)
            End If
            If Weiche20schalten = True Then
                _eb.weicheSchalten(20, Klassen.WeichenRichtung.rechts)
            End If
            If Diagonale_Gleis4 = 4 Then
                _eb.weicheSchalten(10, Klassen.WeichenRichtung.rechts)
                Button84.BackColor = Drawing.Color.Red
                Timer_EinzelLok4.Interval = Warte4DI
                Timer_EinzelLok4.Start()
            Else
                Zug4(700)
            End If
            If _Kamera = 3 And _aktuelleKamera <> Marxzel Then
                Timer_Kamera1.Interval = 100
                Timer_Kamera1.Start()
            End If
        End If
    End Sub


    ' *** Kontakt 0.5 true - Halt im Schattenbahnhof Lok1
    Private Sub ObenLang101Lok1()
        AutomatikParameter = 102
        Ort_Lok1 = 102
        If _SBhf_Gleis1 = 0 Then       ' *** kein Halt
            If Weiche23schalten = True Then
                _eb.weicheSchalten(23, Klassen.WeichenRichtung.rechts)
            End If
            If Diagonale_Gleis1 = 1 Then
                _eb.weicheSchalten(10, Klassen.WeichenRichtung.rechts)
            End If
            If _Kamera = 3 And _aktuelleKamera <> Marxzel Then
                Timer_Kamera1.Interval = 8500
                Timer_Kamera1.Start()
            End If
        ElseIf _SBhf_Gleis1 = 1 Then    ' *** Halt
            _eb.weicheSchalten(11, Klassen.WeichenRichtung.rechts)
            If Diagonale_Gleis1 = 1 Then
                _eb.weicheSchalten(10, Klassen.WeichenRichtung.rechts)
            End If
            Button51.BackColor = Drawing.Color.Red
            'Timer_EinzelLok1.Interval = NumericUpDown1.Value * 1000
            Timer_EinzelLok1.Interval = Warte1SB
            Timer_EinzelLok1.Start()
        ElseIf _SBhf_Gleis1 = 2 Then  ' *** Wechsel > 2
            _eb.weicheSchalten(11, Klassen.WeichenRichtung.rechts)
            AutomatikParameter = 200
            ARoute_Lok2 = _Route_Gleis2
            _Route_Gleis2 = 1
            If Ort_Lok2 = 0 Or Ort_Lok2 = 200 Then     ' Zug 2 steht im Bahnhof
                Button32.BackColor = Drawing.Color.Red
            End If
            ' Automatikparameter 202 nicht möglich, da Zug 1 hier steht
            If Ort_Lok2 = 203 Then   ' Zug 2 steht vor Signal 10 (Diagonale)
                Button82.BackColor = Drawing.Color.Red
                AutomatikParameter = 203
            End If
            If Ort_Lok2 = 205 Then   ' Zug 2 steht vor Signal 8
                Button72.BackColor = Drawing.Color.Red
                AutomatikParameter = 205
            End If
            If Ort_Lok2 = 212 Then    ' Zug 2 steht auf dem Berg
                Button62.BackColor = Drawing.Color.Red
                AutomatikParameter = 212
            End If
            Timer_EinzelLok2.Interval = NumericUpDown2.Value * 1000
            Timer_EinzelLok2.Start()
        ElseIf _SBhf_Gleis1 = 3 Then  ' *** Wechsel > 3
            _eb.weicheSchalten(11, Klassen.WeichenRichtung.rechts)
            _Route_Gleis2 = 1
            AutomatikParameter = 300
            If Ort_Lok3 = 0 Or Ort_Lok3 = 300 Then     ' Zug 3 steht im Bahnhof
                Button33.BackColor = Drawing.Color.Red
            End If
            If Ort_Lok3 = 320 Then    ' Zug 3 steht vor Signal 9
                AutomatikParameter = 320
                Button53.BackColor = Drawing.Color.Red
            End If
            If Ort_Lok3 = 315 Then    ' Zug 3 steht vor Signal 1
                AutomatikParameter = 315
                Button73.BackColor = Drawing.Color.Red
            End If
            If Ort_Lok3 = 312 Then    ' Zug 3 steht auf dem Berg
                AutomatikParameter = 312
                Button63.BackColor = Drawing.Color.Red
            End If
            Timer_EinzelLok3.Interval = NumericUpDown3.Value * 1000
            Timer_EinzelLok3.Start()
        ElseIf _SBhf_Gleis1 = 4 Then   ' *** Wechsel > 4
            _eb.weicheSchalten(11, Klassen.WeichenRichtung.rechts)
            _Route_Gleis2 = 1
            AutomatikParameter = 400
            If Ort_Lok4 = 0 Or Ort_Lok4 = 400 Then     ' Zug 4 steht im Bahnhof
                Button34.BackColor = Drawing.Color.Red
            End If
            If Ort_Lok4 = 420 Then    ' Zug 4 steht vor Signal 9
                AutomatikParameter = 420
                Button54.BackColor = Drawing.Color.Red
            End If
            If Ort_Lok4 = 415 Then    ' Zug 4 steht vor Signal 3
                AutomatikParameter = 415
                Button74.BackColor = Drawing.Color.Red
            End If
            If Ort_Lok4 = 412 Then    ' Zug 4 steht auf dem Berg
                AutomatikParameter = 412
                Button64.BackColor = Drawing.Color.Red
            End If
            Timer_EinzelLok4.Interval = NumericUpDown4.Value * 1000
            Timer_EinzelLok4.Start()
        End If
        ButtonsVisible(999)
    End Sub
    ' *** Kontakt 0.5 true - Halt im Schattenbahnhof Lok2
    Private Sub ObenLang101Lok2()
        AutomatikParameter = 202
        Ort_Lok2 = 202
        If _SBhf_Gleis2 = 0 Then       ' *** kein Halt
            If Weiche23schalten = True Then
                _eb.weicheSchalten(23, Klassen.WeichenRichtung.rechts)
            End If
            If Diagonale_Gleis2 = 1 Then
                _eb.weicheSchalten(10, Klassen.WeichenRichtung.rechts)
            End If
            If _Kamera = 3 And _aktuelleKamera <> Marxzel Then
                Timer_Kamera1.Interval = 8500
                Timer_Kamera1.Start()
            End If
        ElseIf _SBhf_Gleis2 = 2 Then    ' *** Halt
            _eb.weicheSchalten(11, Klassen.WeichenRichtung.rechts)
            If Diagonale_Gleis2 = 1 Then
                _eb.weicheSchalten(10, Klassen.WeichenRichtung.rechts)
            End If
            Button52.BackColor = Drawing.Color.Red
            'Timer_EinzelLok2.Interval = NumericUpDown2.Value * 1000
            Timer_EinzelLok2.Interval = Warte2SB
            Timer_EinzelLok2.Start()
        ElseIf _SBhf_Gleis2 = 1 Then  ' *** Wechsel > 1
            _eb.weicheSchalten(11, Klassen.WeichenRichtung.rechts)
            AutomatikParameter = 100
            ARoute_Lok1 = _Route_Gleis1
            _Route_Gleis1 = 1
            If Ort_Lok1 = 0 Or Ort_Lok1 = 100 Then     ' Zug 1 steht im Bahnhof
                Button31.BackColor = Drawing.Color.Red
            End If
            ' Automatikparameter 102 nicht möglich, da Zug 2 hier steht
            If Ort_Lok1 = 103 Then   ' Zug 1 steht vor Signal 10
                Button81.BackColor = Drawing.Color.Red
                AutomatikParameter = 103
            End If
            If Ort_Lok1 = 105 Then   ' Zug 1 steht vor Signal 6
                Button71.BackColor = Drawing.Color.Red
                AutomatikParameter = 105
            End If
            If Ort_Lok1 = 112 Then    ' Zug 1 steht auf dem Berg
                Button61.BackColor = Drawing.Color.Red
                AutomatikParameter = 112
            End If
            Timer_EinzelLok1.Interval = NumericUpDown1.Value * 1000
            Timer_EinzelLok1.Start()
        ElseIf _SBhf_Gleis2 = 3 Then  ' *** Wechsel > 3
            _eb.weicheSchalten(11, Klassen.WeichenRichtung.rechts)
            _Route_Gleis1 = 1
            AutomatikParameter = 300
            If Ort_Lok3 = 0 Or Ort_Lok3 = 300 Then     ' Zug 3 steht im Bahnhof
                Button33.BackColor = Drawing.Color.Red
            End If
            ' Zug 3 steht im Bahnhof - keine weiter Schaltung erforderlich
            If Ort_Lok3 = 320 Then    ' Zug 3 steht vor Signal 9
                AutomatikParameter = 320
                Button53.BackColor = Drawing.Color.Red
            End If
            If Ort_Lok3 = 315 Then    ' Zug 3 steht vor Signal 1
                AutomatikParameter = 315
                Button73.BackColor = Drawing.Color.Red
            End If
            If Ort_Lok3 = 312 Then    ' Zug 3 steht auf dem Berg
                AutomatikParameter = 312
                Button63.BackColor = Drawing.Color.Red
            End If
            Timer_EinzelLok3.Interval = NumericUpDown3.Value * 1000
            Timer_EinzelLok3.Start()
        ElseIf _SBhf_Gleis2 = 4 Then   ' *** Wechsel > 4
            _eb.weicheSchalten(11, Klassen.WeichenRichtung.rechts)
            _Route_Gleis1 = 1
            AutomatikParameter = 400
            If Ort_Lok4 = 0 Or Ort_Lok4 = 400 Then     ' Zug 4 steht im Bahnhof
                Button34.BackColor = Drawing.Color.Red
            End If
            If Ort_Lok4 = 420 Then    ' Zug 4 steht vor Signal 9
                AutomatikParameter = 420
                Button54.BackColor = Drawing.Color.Red
            End If
            If Ort_Lok4 = 415 Then    ' Zug 4 steht vor Signal 3
                AutomatikParameter = 415
                Button74.BackColor = Drawing.Color.Red
            End If
            If Ort_Lok4 = 412 Then    ' Zug 4 steht auf dem Berg
                AutomatikParameter = 412
                Button64.BackColor = Drawing.Color.Red
            End If
            Timer_EinzelLok4.Interval = NumericUpDown4.Value * 1000
            Timer_EinzelLok4.Start()
        End If
        ButtonsVisible(999)
    End Sub

    ' *** Kontakt 1.3 true - Halt im Schattenbahnhof Lok3
    Private Sub ObenLang105Lok3()
        AutomatikParameter = 320
        Ort_Lok3 = 320
        If _SBhf_Gleis3 = 0 Then        ' *** kein Halt
            If Weiche20schalten = True Then
                _eb.weicheSchalten(20, Klassen.WeichenRichtung.links)
            End If
        ElseIf _SBhf_Gleis3 = 3 Then    ' *** Halt
            _eb.weicheSchalten(9, Klassen.WeichenRichtung.rechts)
            Button53.BackColor = Drawing.Color.Red
            'Timer_EinzelLok3.Interval = NumericUpDown3.Value * 1000
            Timer_EinzelLok3.Interval = Warte3SB
            Timer_EinzelLok3.Start()
        ElseIf _SBhf_Gleis3 = 1 Then    ' *** Wechsel > 1
            _eb.weicheSchalten(9, Klassen.WeichenRichtung.rechts)
            _Route_Gleis4 = 1
            If Ort_Lok1 = 0 Or Ort_Lok1 = 100 Then    ' Zug 1 steht im Bahnhof
                Button31.BackColor = Drawing.Color.Red
                AutomatikParameter = 100
            End If
            If Ort_Lok1 = 102 Then    ' Zug 1 vor Signal 11
                Button51.BackColor = Drawing.Color.Red
                AutomatikParameter = 102
            End If
            If Ort_Lok1 = 103 Then   ' Zug 1 steht vor Signal 10
                Button81.BackColor = Drawing.Color.Red
                AutomatikParameter = 103
            End If
            If Ort_Lok1 = 105 Then   ' Zug 1 steht vor Signal 6
                Button71.BackColor = Drawing.Color.Red
                AutomatikParameter = 105
            End If
            If Ort_Lok1 = 112 Then    ' Zug 1 steht auf dem Berg
                Button61.BackColor = Drawing.Color.Red
                AutomatikParameter = 112
            End If
            Timer_EinzelLok1.Interval = NumericUpDown1.Value * 1000
            Timer_EinzelLok1.Start()
        ElseIf _SBhf_Gleis3 = 2 Then    ' *** Wechsel > 2
            _eb.weicheSchalten(9, Klassen.WeichenRichtung.rechts)
            _Route_Gleis4 = 1
            If Ort_Lok2 = 0 Or Ort_Lok2 = 200 Then    ' Zug 2 steht im Bahnhof
                Button32.BackColor = Drawing.Color.Red
                AutomatikParameter = 200
            End If
            If Ort_Lok2 = 202 Then    ' Zug 2 vor Signal 11
                Button52.BackColor = Drawing.Color.Red
                AutomatikParameter = 202
            End If
            If Ort_Lok2 = 203 Then   ' Zug 2 steht vor Signal 10
                Button82.BackColor = Drawing.Color.Red
                AutomatikParameter = 203
            End If
            If Ort_Lok2 = 205 Then   ' Zug 2 steht vor Signal 8
                Button72.BackColor = Drawing.Color.Red
                AutomatikParameter = 205
            End If
            If Ort_Lok2 = 212 Then    ' Zug 2 steht auf dem Berg
                Button62.BackColor = Drawing.Color.Red
                AutomatikParameter = 212
            End If
            Timer_EinzelLok2.Interval = NumericUpDown2.Value * 1000
            Timer_EinzelLok2.Start()
        ElseIf _SBhf_Gleis3 = 4 Then   ' *** Wechsel > 4
            _eb.weicheSchalten(9, Klassen.WeichenRichtung.rechts)
            _Route_Gleis4 = 1
            If Ort_Lok4 = 0 Or Ort_Lok4 = 400 Then    ' Zug 4 steht im Bahnhof
                Button34.BackColor = Drawing.Color.Red
                AutomatikParameter = 400
            End If
            If Ort_Lok4 = 420 Then    ' Zug 4 steht vor Signal 9
                Button54.BackColor = Drawing.Color.Red
                AutomatikParameter = 420
            End If
            If Ort_Lok4 = 415 Then    ' Zug 4 steht vor Signal 3
                Button74.BackColor = Drawing.Color.Red
                AutomatikParameter = 415
            End If
            If Ort_Lok4 = 412 Then    ' Zug 4 steht auf dem Berg
                Button64.BackColor = Drawing.Color.Red
                AutomatikParameter = 412
            End If
            Timer_EinzelLok4.Interval = NumericUpDown4.Value * 1000
            Timer_EinzelLok4.Start()
        Else      ' *** unbestimmt
            '_eb.weicheSchalten(13, Klassen.WeichenRichtung.links)
            _eb.weicheSchalten(14, Klassen.WeichenRichtung.links)
        End If
        ButtonsVisible(999)
    End Sub
    ' *** Kontakt 1.3 true - Halt im Schattenbahnhof Lok4
    Private Sub ObenLang105Lok4()
        AutomatikParameter = 420
        Ort_Lok4 = 420
        If _SBhf_Gleis4 = 0 Then        ' *** kein Halt
            If Weiche20schalten = True Then
                _eb.weicheSchalten(20, Klassen.WeichenRichtung.rechts)
            End If
        ElseIf _SBhf_Gleis4 = 4 Then    ' *** Halt
            _eb.weicheSchalten(9, Klassen.WeichenRichtung.rechts)
            Button54.BackColor = Drawing.Color.Red
            'Timer_EinzelLok4.Interval = NumericUpDown4.Value * 1000
            Timer_EinzelLok4.Interval = Warte4SB
            Timer_EinzelLok4.Start()
        ElseIf _SBhf_Gleis4 = 1 Then    ' *** Wechsel > 1
            _eb.weicheSchalten(9, Klassen.WeichenRichtung.rechts)
            _Route_Gleis3 = 1
            If Ort_Lok1 = 0 Or Ort_Lok1 = 100 Then    ' Zug 1 steht im Bahnhof
                Button31.BackColor = Drawing.Color.Red
                AutomatikParameter = 100
            End If
            If Ort_Lok1 = 102 Then    ' Zug 1 vor Signal 11
                Button51.BackColor = Drawing.Color.Red
                AutomatikParameter = 102
            End If
            If Ort_Lok1 = 103 Then   ' Zug 1 steht vor Signal 10
                Button81.BackColor = Drawing.Color.Red
                AutomatikParameter = 103
            End If
            If Ort_Lok1 = 105 Then   ' Zug 1 steht vor Signal 6
                Button71.BackColor = Drawing.Color.Red
                AutomatikParameter = 105
            End If
            If Ort_Lok1 = 112 Then    ' Zug 1 steht auf dem Berg
                Button61.BackColor = Drawing.Color.Red
                AutomatikParameter = 112
            End If
            Timer_EinzelLok1.Interval = NumericUpDown1.Value * 1000
            Timer_EinzelLok1.Start()
        ElseIf _SBhf_Gleis4 = 2 Then    ' *** Wechsel > 2
            _eb.weicheSchalten(9, Klassen.WeichenRichtung.rechts)
            If Ort_Lok2 = 0 Or Ort_Lok2 = 200 Then    ' Zug 2 steht im Bahnhof
                Button32.BackColor = Drawing.Color.Red
                AutomatikParameter = 200
            End If
            If Ort_Lok2 = 202 Then    ' Zug 2 vor Signal 11
                Button52.BackColor = Drawing.Color.Red
                AutomatikParameter = 202
            End If
            If Ort_Lok2 = 203 Then   ' Zug 2 steht vor Signal 10
                Button82.BackColor = Drawing.Color.Red
                AutomatikParameter = 203
            End If
            If Ort_Lok2 = 205 Then   ' Zug 2 steht vor Signal 8
                Button72.BackColor = Drawing.Color.Red
                AutomatikParameter = 205
            End If
            If Ort_Lok2 = 212 Then    ' Zug 2 steht auf dem Berg
                Button62.BackColor = Drawing.Color.Red
                AutomatikParameter = 212
            End If
            Timer_EinzelLok2.Interval = NumericUpDown2.Value * 1000
            Timer_EinzelLok2.Start()
        ElseIf _SBhf_Gleis4 = 3 Then   ' *** Wechsel > 3
            _eb.weicheSchalten(9, Klassen.WeichenRichtung.rechts)
            If Ort_Lok3 = 0 Or Ort_Lok3 = 300 Then    ' Zug 3 steht im Bahnhof
                Button33.BackColor = Drawing.Color.Red
                AutomatikParameter = 300
            End If
            If Ort_Lok3 = 320 Then    ' Zug 3 steht vor Signal 9
                AutomatikParameter = 320
                Button53.BackColor = Drawing.Color.Red
            End If
            If Ort_Lok3 = 315 Then    ' Zug 3 steht vor Signal 3
                Button73.BackColor = Drawing.Color.Red
                AutomatikParameter = 315
            End If
            If Ort_Lok3 = 312 Then    ' Zug 3 steht auf dem Berg
                Button63.BackColor = Drawing.Color.Red
                AutomatikParameter = 312
            End If
            Timer_EinzelLok3.Interval = NumericUpDown3.Value * 1000
            Timer_EinzelLok3.Start()
        End If
        ButtonsVisible(999)
    End Sub


    ' *** Kontakt 0.0 true  - Lok1 Bahnhof ->
    Private Sub ObenLang103Lok1()
        Ort_Lok1 = 105
        _AutomatikParameterH = 104
        A_StopH = 0
        If _Bhf2_Gleis1 = 0 Then       ' *** kein Halt
            'If Weiche17schalten = True Then
            '    _eb.weicheSchalten(17, Klassen.WeichenRichtung.links)
            'End If
            If Weiche27schalten = True Then
                _eb.weicheSchalten(27, Klassen.WeichenRichtung.rechts)
            End If
            AutomatikParameter = 105
            _LokStufen.EinzelLokSenden(1, 3)
            _StopZug1 = 0
        ElseIf _Bhf2_Gleis1 = 1 Then    ' *** Halt
            AutomatikParameter = 105
            _StopZug1 = 1
            If _Kurzzug1 = True Then
                Zug1(bremsen_kurz_von_links)
            Else
                Zug1(bremsen)
            End If
            Button71.BackColor = Drawing.Color.Red
            Timer_EinzelLok1.Interval = NumericUpDown1.Value * 1000
            Timer_EinzelLok1.Start()
        ElseIf _Bhf2_Gleis1 = 2 Then    ' *** Wechsel > 2
            _StopZug1 = 2
            If _Kurzzug1 = True Then
                Zug1(bremsen_kurz_von_links)
            Else
                Zug1(bremsen)
            End If
            If Ort_Lok2 = 0 Or Ort_Lok2 = 200 Then
                Button32.BackColor = Drawing.Color.Red
                AutomatikParameter = 200
            ElseIf Ort_Lok2 = 202 Then
                Button52.BackColor = Drawing.Color.Red
                AutomatikParameter = 202
            ElseIf Ort_Lok2 = 203 Then
                Button82.BackColor = Drawing.Color.Red
                AutomatikParameter = 203
            ElseIf Ort_Lok2 = 205 Then
                Button72.BackColor = Drawing.Color.Red
                AutomatikParameter = 205
            ElseIf Ort_Lok2 = 212 Then
                Button62.BackColor = Drawing.Color.Red
                AutomatikParameter = 212
            ElseIf Ort_Lok2 = 220 Then
                Button92.BackColor = Drawing.Color.Red
                AutomatikParameter = 220
            End If
            Timer_EinzelLok2.Interval = NumericUpDown2.Value * 1000
            Timer_EinzelLok2.Start()
        ElseIf _Bhf2_Gleis1 = 3 Then    ' *** Wechsel > 3
            _StopZug1 = 3
            If _Kurzzug1 = True Then
                Zug1(bremsen_kurz_von_links)
            Else
                Zug1(bremsen)
            End If
            If Ort_Lok3 = 0 Or Ort_Lok3 = 300 Then
                Button33.BackColor = Drawing.Color.Red
                AutomatikParameter = 300
            ElseIf Ort_Lok3 = 310 Then
                Button53.BackColor = Drawing.Color.Red
                AutomatikParameter = 310
            ElseIf Ort_Lok3 = 312 Then
                Button63.BackColor = Drawing.Color.Red
                AutomatikParameter = 312
            ElseIf Ort_Lok3 = 313 Then
                Button93.BackColor = Drawing.Color.Red
                AutomatikParameter = 313
            ElseIf Ort_Lok3 = 315 Then
                Button73.BackColor = Drawing.Color.Red
                AutomatikParameter = 315
            ElseIf Ort_Lok3 = 320 Then
                Button53.BackColor = Drawing.Color.Red
                AutomatikParameter = 320
            End If
            Timer_EinzelLok3.Interval = NumericUpDown3.Value * 1000
            Timer_EinzelLok3.Start()
        ElseIf _Bhf2_Gleis1 = 4 Then    ' *** Wechsel > 4
            _StopZug1 = 4
            If _Kurzzug1 = True Then
                Zug1(bremsen_kurz_von_links)
            Else
                Zug1(bremsen)
            End If
            If Ort_Lok4 = 0 Or Ort_Lok4 = 400 Then
                Button34.BackColor = Drawing.Color.Red
                AutomatikParameter = 400
            ElseIf Ort_Lok4 = 410 Then
                Button54.BackColor = Drawing.Color.Red
                AutomatikParameter = 410
            ElseIf Ort_Lok4 = 412 Then
                Button64.BackColor = Drawing.Color.Red
                AutomatikParameter = 412
            ElseIf Ort_Lok4 = 413 Then
                Button94.BackColor = Drawing.Color.Red
                AutomatikParameter = 413
            ElseIf Ort_Lok4 = 415 Then
                Button74.BackColor = Drawing.Color.Red
                AutomatikParameter = 415
            ElseIf Ort_Lok4 = 420 Then
                Button54.BackColor = Drawing.Color.Red
                AutomatikParameter = 420
            End If
            Timer_EinzelLok4.Interval = NumericUpDown4.Value * 1000
            Timer_EinzelLok4.Start()
        End If
    End Sub
    ' *** Kontakt 0.1 true  - Lok1 Bahnhof ->
    Private Sub ObenLang104Lok1()
        _AutomatikParameterH = 0
        AutomatikParameter = 105
        Ort_Lok1 = 105
        A_StopH = 0
        If _StopZug1 > 0 Then
            Zug1(nachlauf)
            'StopZug1()
        End If
        If _StopZug1 = 0 Then       ' *** kein Halt
            AutomatikParameter = 106
            If _Kamera = 3 And _aktuelleKamera <> Forbach Then
                _Webcams.SetWebcam(0, Forbach)
                SetText(Button13, "Hinterzarten")
                _aktuelleKamera = Forbach
            End If
        ElseIf _StopZug1 = 1 Then    ' *** Halt
            'If _NachlaufZug1 = False Then
            '    Zug1(abstellen)
            'Else
            '    Zug1(nachlauf)
            'End If
        ElseIf _StopZug1 = 2 Then    ' *** Wechsel > 2
            _Route_Gleis2 = ARoute_Lok2
            ButtonsVisible(999)
        ElseIf _StopZug1 = 3 Then    ' *** Wechsel > 3
            _Route_Gleis3 = ARoute_Lok3
            ButtonsVisible(999)
        ElseIf _StopZug1 = 4 Then    ' *** Wechsel > 4
            _Route_Gleis4 = ARoute_Lok4
            ButtonsVisible(999)
        End If
    End Sub
    ' *** Kontakt 0.1 false - Lok1 Bahnhof ->
    Private Sub ObenLang105Lok1()
        '_LokStufen.EinzelLokSenden(1, 3)
        AutomatikParameter = 110
    End Sub

    ' *** Kontakt 0.2 true  - Lok2 Bahnhof ->
    Private Sub ObenLang103Lok2()
        Ort_Lok2 = 205
        _AutomatikParameterH = 204
        A_StopH = 0
        If _Bhf2_Gleis2 = 0 Then       ' *** kein Halt
            'If Weiche17schalten = True Then
            '    _eb.weicheSchalten(17, Klassen.WeichenRichtung.links)
            'End If
            If Weiche27schalten = True Then
                _eb.weicheSchalten(27, Klassen.WeichenRichtung.rechts)
            End If
            AutomatikParameter = 205
            _LokStufen.EinzelLokSenden(2, 3)
            _StopZug2 = 0
        ElseIf _Bhf2_Gleis2 = 2 Then    ' *** Halt
            AutomatikParameter = 205
            _StopZug2 = 2
            If _Kurzzug2 = True Then
                Zug2(bremsen_kurz_von_links)
            Else
                Zug2(bremsen)
            End If
            Button72.BackColor = Drawing.Color.Red
            Timer_EinzelLok2.Interval = NumericUpDown2.Value * 1000
            Timer_EinzelLok2.Start()
        ElseIf _Bhf2_Gleis2 = 1 Then    ' *** Wechsel > 1
            _StopZug2 = 1
            If _Kurzzug2 = True Then
                Zug2(bremsen_kurz_von_links)
            Else
                Zug2(bremsen)
            End If
            If Ort_Lok1 = 0 Or Ort_Lok1 = 100 Then
                Button31.BackColor = Drawing.Color.Red
                AutomatikParameter = 100
            ElseIf Ort_Lok1 = 102 Then
                Button11.BackColor = Drawing.Color.Red
                AutomatikParameter = 102
            ElseIf Ort_Lok1 = 103 Then
                Button81.BackColor = Drawing.Color.Red
                AutomatikParameter = 103
            ElseIf Ort_Lok1 = 105 Then
                Button71.BackColor = Drawing.Color.Red
                AutomatikParameter = 105
            ElseIf Ort_Lok1 = 112 Then
                Button61.BackColor = Drawing.Color.Red
                AutomatikParameter = 112
            ElseIf Ort_Lok1 = 120 Then
                Button91.BackColor = Drawing.Color.Red
                AutomatikParameter = 120
            End If
            Timer_EinzelLok1.Interval = NumericUpDown1.Value * 1000
            Timer_EinzelLok1.Start()
        ElseIf _Bhf2_Gleis2 = 3 Then    ' *** Wechsel > 3
            _StopZug2 = 3
            If _Kurzzug2 = True Then
                Zug2(bremsen_kurz_von_links)
            Else
                Zug2(bremsen)
            End If
            If Ort_Lok3 = 0 Or Ort_Lok3 = 300 Then
                Button33.BackColor = Drawing.Color.Red
                AutomatikParameter = 300
            ElseIf Ort_Lok3 = 310 Then
                Button53.BackColor = Drawing.Color.Red
                AutomatikParameter = 310
            ElseIf Ort_Lok3 = 312 Then
                Button63.BackColor = Drawing.Color.Red
                AutomatikParameter = 312
            ElseIf Ort_Lok3 = 313 Then
                Button93.BackColor = Drawing.Color.Red
                AutomatikParameter = 313
            ElseIf Ort_Lok3 = 315 Then
                Button73.BackColor = Drawing.Color.Red
                AutomatikParameter = 315
            ElseIf Ort_Lok3 = 320 Then
                Button53.BackColor = Drawing.Color.Red
                AutomatikParameter = 320
            End If
            Timer_EinzelLok3.Interval = NumericUpDown3.Value * 1000
            Timer_EinzelLok3.Start()
        ElseIf _Bhf2_Gleis2 = 4 Then    ' *** Wechsel > 4
            _StopZug2 = 4
            If _Kurzzug2 = True Then
                Zug2(bremsen_kurz_von_links)
            Else
                Zug2(bremsen)
            End If
            If Ort_Lok4 = 0 Or Ort_Lok4 = 400 Then
                Button34.BackColor = Drawing.Color.Red
                AutomatikParameter = 400
            ElseIf Ort_Lok4 = 410 Then
                Button54.BackColor = Drawing.Color.Red
                AutomatikParameter = 410
            ElseIf Ort_Lok4 = 412 Then
                Button64.BackColor = Drawing.Color.Red
                AutomatikParameter = 412
            ElseIf Ort_Lok4 = 413 Then
                Button94.BackColor = Drawing.Color.Red
                AutomatikParameter = 413
            ElseIf Ort_Lok4 = 415 Then
                Button74.BackColor = Drawing.Color.Red
                AutomatikParameter = 415
            ElseIf Ort_Lok4 = 420 Then
                Button54.BackColor = Drawing.Color.Red
                AutomatikParameter = 420
            End If
            Timer_EinzelLok4.Interval = NumericUpDown4.Value * 1000
            Timer_EinzelLok4.Start()
        End If
    End Sub
    ' *** Kontakt 0.3 true  - Lok2 Bahnhof ->
    Private Sub ObenLang104Lok2()
        _AutomatikParameterH = 0
        AutomatikParameter = 205
        Ort_Lok2 = 205
        A_StopH = 0
        If _StopZug2 > 0 Then
            Zug2(nachlauf)
            'StopZug2()
        End If
        If _StopZug2 = 0 Then       ' *** kein Halt
            AutomatikParameter = 206
            If _Kamera = 3 And _aktuelleKamera <> Forbach Then
                _Webcams.SetWebcam(0, Forbach)
                SetText(Button13, "Hinterzarten")
                _aktuelleKamera = Forbach
            End If
        ElseIf _StopZug2 = 2 Then    ' *** Halt
            'If _NachlaufZug2 = False Then
            '    Zug2(abstellen)
            'Else
            '    Zug2(nachlauf)
            'End If
        ElseIf _StopZug2 = 1 Then    ' *** Wechsel > 1
            _Route_Gleis1 = ARoute_Lok1
            ButtonsVisible(999)
        ElseIf _StopZug2 = 3 Then    ' *** Wechsel > 3
            _Route_Gleis3 = ARoute_Lok3
            ButtonsVisible(999)
        ElseIf _StopZug2 = 4 Then    ' *** Wechsel > 4
            _Route_Gleis4 = ARoute_Lok4
            ButtonsVisible(999)
        End If
    End Sub
    ' *** Kontakt 0.3 false - Lok2 Bahnhof ->
    Private Sub ObenLang105Lok2()
        '_LokStufen.EinzelLokSenden(2, 3)
        AutomatikParameter = 210
    End Sub

    ' *** Kontakt 1.6 true  - Lok3 Bahnhof <-
    Private Sub ObenLang101Lok3()
        Ort_Lok3 = 315
        A_StopH = 0
        If _Bhf2_Gleis3 = 0 Then       ' *** kein Halt
            If _Route_Gleis3 = 0 Or _Route_Gleis3 = 2 Then
                If _SBhf_Gleis3 > 0 Then
                    _eb.weicheSchalten(9, Klassen.WeichenRichtung.rechts)
                Else
                    _eb.weicheSchalten(9, Klassen.WeichenRichtung.links)
                End If
            End If
            _LokStufen.EinzelLokSenden(3, 3)
            _StopZug3 = 0
            AutomatikParameter = 305
            _AutomatikParameterH = 318
        ElseIf _Bhf2_Gleis3 = 3 Then    ' *** Halt
            _StopZug3 = 3
            _AutomatikParameterH = 318
            If _Kurzzug3 = True Then
                Zug3(bremsen_kurz_von_rechts)
            Else
                Zug3(bremsen)
            End If
            Timer_EinzelLok3.Interval = NumericUpDown3.Value * 1000
            Timer_EinzelLok3.Start()
            Button73.BackColor = Drawing.Color.Red
        ElseIf _Bhf2_Gleis3 = 1 Then    ' *** Wechsel > 1
            _StopZug3 = 1
            _AutomatikParameterH = 318
            If _Kurzzug3 = True Then
                Zug3(bremsen_kurz_von_rechts)
            Else
                Zug3(bremsen)
            End If
            If Ort_Lok1 = 0 Or Ort_Lok1 = 100 Then
                Button31.BackColor = Drawing.Color.Red
                AutomatikParameter = 100
            ElseIf Ort_Lok1 = 102 Then
                Button51.BackColor = Drawing.Color.Red
                AutomatikParameter = 102
            ElseIf Ort_Lok1 = 103 Then
                Button81.BackColor = Drawing.Color.Red
                AutomatikParameter = 103
            ElseIf Ort_Lok1 = 105 Then
                Button71.BackColor = Drawing.Color.Red
                AutomatikParameter = 105
            ElseIf Ort_Lok1 = 112 Then
                Button61.BackColor = Drawing.Color.Red
                AutomatikParameter = 112
            ElseIf Ort_Lok1 = 120 Then
                Button91.BackColor = Drawing.Color.Red
                AutomatikParameter = 120
            End If
            Timer_EinzelLok1.Interval = NumericUpDown1.Value * 1000
            Timer_EinzelLok1.Start()
        ElseIf _Bhf2_Gleis3 = 2 Then    ' *** Wechsel > 2
            _StopZug3 = 2
            _AutomatikParameterH = 318
            If _Kurzzug3 = True Then
                Zug3(bremsen_kurz_von_rechts)
            Else
                Zug3(bremsen)
            End If
            If Ort_Lok2 = 0 Or Ort_Lok2 = 200 Then
                Button32.BackColor = Drawing.Color.Red
                AutomatikParameter = 200
            ElseIf Ort_Lok2 = 202 Then
                Button52.BackColor = Drawing.Color.Red
                AutomatikParameter = 202
            ElseIf Ort_Lok2 = 203 Then
                Button82.BackColor = Drawing.Color.Red
                AutomatikParameter = 203
            ElseIf Ort_Lok2 = 205 Then
                Button72.BackColor = Drawing.Color.Red
                AutomatikParameter = 205
            ElseIf Ort_Lok2 = 212 Then
                Button62.BackColor = Drawing.Color.Red
                AutomatikParameter = 212
            ElseIf Ort_Lok2 = 220 Then
                Button92.BackColor = Drawing.Color.Red
                AutomatikParameter = 220
            End If
            Timer_EinzelLok2.Interval = NumericUpDown2.Value * 1000
            Timer_EinzelLok2.Start()
        ElseIf _Bhf2_Gleis3 = 4 Then    ' *** Wechsel > 4
            _StopZug3 = 4
            _AutomatikParameterH = 318
            If _Kurzzug3 = True Then
                Zug3(bremsen_kurz_von_rechts)
            Else
                Zug3(bremsen)
            End If
            If Ort_Lok4 = 0 Or Ort_Lok4 = 400 Then
                Button34.BackColor = Drawing.Color.Red
                AutomatikParameter = 400
            ElseIf Ort_Lok4 = 410 Then
                Button54.BackColor = Drawing.Color.Red
                AutomatikParameter = 410
            ElseIf Ort_Lok4 = 412 Then
                Button64.BackColor = Drawing.Color.Red
                AutomatikParameter = 412
            ElseIf Ort_Lok4 = 413 Then
                Button94.BackColor = Drawing.Color.Red
                AutomatikParameter = 413
            ElseIf Ort_Lok4 = 415 Then
                Button74.BackColor = Drawing.Color.Red
                AutomatikParameter = 415
            ElseIf Ort_Lok4 = 420 Then
                Button54.BackColor = Drawing.Color.Red
                AutomatikParameter = 420
            End If
            Timer_EinzelLok4.Interval = NumericUpDown4.Value * 1000
            Timer_EinzelLok4.Start()
        End If
    End Sub
    ' *** Kontakt 1.7 true  - Lok3 Bahnhof <-
    Private Sub ObenLang102Lok3()

        ' *** Weiche 27 muss immer geschaltet werden, da Zug 3 diesen Kontakt nur dann auslöst,
        ' *** wenn er Route "oben lang" fährt. Der Zug kommt vom Berg. Weiche 27 muss also nun
        ' *** nach links geschaltet werden. Zug 4 könnte die Weiche aber bereits vorher auf links
        ' *** geschaltet haben.

        _AutomatikParameterH = 0
        AutomatikParameter = 305
        Ort_Lok3 = 315
        A_StopH = 0
        If _StopZug3 > 0 Then
            Zug3(nachlauf)
            'StopZug3()
        End If
        If _Bhf2_Gleis3 = 0 Then
            ' ***
            ' *** kein Halt
            ' ***
            If Weiche17schalten = True Then
                _eb.weicheSchalten(17, Klassen.WeichenRichtung.rechts)
            End If
            If Weiche27schalten = True Then
                _eb.weicheSchalten(27, Klassen.WeichenRichtung.links)
            End If
            If _SBhf_Gleis3 > 0 Then
                _eb.weicheSchalten(9, Klassen.WeichenRichtung.rechts)
            Else
                _eb.weicheSchalten(9, Klassen.WeichenRichtung.links)
            End If
            AutomatikParameter = 305
        ElseIf _StopZug3 = 3 Then    ' *** Halt
            'If _NachlaufZug3 = False Then
            '    StopZug3()
            '    Zug3(abstellen)
            'Else
            '    Zug3(nachlauf)
            'End If
            If _SBhf_Gleis3 = 1 Or _SBhf_Gleis3 = 2 Then
                _eb.weicheSchalten(9, Klassen.WeichenRichtung.rechts)
            End If
        ElseIf _StopZug3 = 1 Then    ' *** Wechsel > 1
            _Route_Gleis3 = ARoute_Lok3
            ButtonsVisible(999)
            StopZug3()
        ElseIf _StopZug3 = 2 Then    ' *** Wechsel > 2
            _Route_Gleis3 = ARoute_Lok3
            ButtonsVisible(999)
            StopZug3()
        ElseIf _StopZug3 = 4 Then    ' *** Wechsel > 4
            _Route_Gleis3 = ARoute_Lok3
            ButtonsVisible(999)
            StopZug3()
        End If
    End Sub
    ' *** Kontakt 1.7 false - Lok3 Bahnhof <-
    Private Sub ObenLang103Lok3()
        '_LokStufen.EinzelLokSenden(3, 3)
        AutomatikParameter = 306
    End Sub

    ' *** Kontakt 1.4 true  - Lok4 Bahnhof <-
    Private Sub ObenLang101Lok4()
        Ort_Lok4 = 415
        A_StopH = 0
        If _Bhf2_Gleis4 = 0 Then       ' *** kein Halt
            If _Route_Gleis4 = 0 Or _Route_Gleis4 = 2 Then
                If _SBhf_Gleis4 > 0 Then
                    _eb.weicheSchalten(9, Klassen.WeichenRichtung.rechts)
                Else
                    _eb.weicheSchalten(9, Klassen.WeichenRichtung.links)
                End If
            End If
            _LokStufen.EinzelLokSenden(4, 3)
            _StopZug4 = 0
            AutomatikParameter = 405
            _AutomatikParameterH = 418
        ElseIf _Bhf2_Gleis4 = 4 Then    ' *** Halt
            _StopZug4 = 4
            _AutomatikParameterH = 418
            If _Kurzzug4 = True Then
                Zug4(bremsen_kurz_von_rechts)
            Else
                Zug4(bremsen)
            End If
            Timer_EinzelLok4.Interval = NumericUpDown4.Value * 1000
            Timer_EinzelLok4.Start()
            Button74.BackColor = Drawing.Color.Red
        ElseIf _Bhf2_Gleis4 = 1 Then    ' *** Wechsel > 1
            _StopZug4 = 1
            _AutomatikParameterH = 418
            If _Kurzzug4 = True Then
                Zug4(bremsen_kurz_von_rechts)
            Else
                Zug4(bremsen)
            End If
            If Ort_Lok1 = 0 Or Ort_Lok1 = 100 Then
                Button31.BackColor = Drawing.Color.Red
                AutomatikParameter = 100
            ElseIf Ort_Lok1 = 102 Then
                Button51.BackColor = Drawing.Color.Red
                AutomatikParameter = 102
            ElseIf Ort_Lok1 = 103 Then
                Button81.BackColor = Drawing.Color.Red
                AutomatikParameter = 103
            ElseIf Ort_Lok1 = 105 Then
                Button71.BackColor = Drawing.Color.Red
                AutomatikParameter = 105
            ElseIf Ort_Lok1 = 112 Then
                Button61.BackColor = Drawing.Color.Red
                AutomatikParameter = 112
            ElseIf Ort_Lok1 = 120 Then
                Button91.BackColor = Drawing.Color.Red
                AutomatikParameter = 120
            End If
            Timer_EinzelLok1.Interval = NumericUpDown1.Value * 1000
            Timer_EinzelLok1.Start()
        ElseIf _Bhf2_Gleis4 = 2 Then    ' *** Wechsel > 2
            _StopZug4 = 2
            _AutomatikParameterH = 418
            If _Kurzzug4 = True Then
                Zug4(bremsen_kurz_von_rechts)
            Else
                Zug4(bremsen)
            End If
            If Ort_Lok2 = 0 Or Ort_Lok2 = 200 Then
                Button32.BackColor = Drawing.Color.Red
                AutomatikParameter = 200
            ElseIf Ort_Lok2 = 202 Then
                Button52.BackColor = Drawing.Color.Red
                AutomatikParameter = 202
            ElseIf Ort_Lok2 = 203 Then
                Button82.BackColor = Drawing.Color.Red
                AutomatikParameter = 203
            ElseIf Ort_Lok2 = 205 Then
                Button72.BackColor = Drawing.Color.Red
                AutomatikParameter = 205
            ElseIf Ort_Lok2 = 212 Then
                Button62.BackColor = Drawing.Color.Red
                AutomatikParameter = 212
            ElseIf Ort_Lok2 = 220 Then
                Button92.BackColor = Drawing.Color.Red
                AutomatikParameter = 220
            End If
            Timer_EinzelLok2.Interval = NumericUpDown2.Value * 1000
            Timer_EinzelLok2.Start()
        ElseIf _Bhf2_Gleis4 = 3 Then    ' *** Wechsel > 3
            _StopZug4 = 3
            _AutomatikParameterH = 418
            If _Kurzzug4 = True Then
                Zug4(bremsen_kurz_von_rechts)
            Else
                Zug4(bremsen)
            End If
            If Ort_Lok3 = 0 Or Ort_Lok3 = 300 Then
                Button33.BackColor = Drawing.Color.Red
                AutomatikParameter = 300
            ElseIf Ort_Lok3 = 310 Then
                Button53.BackColor = Drawing.Color.Red
                AutomatikParameter = 310
            ElseIf Ort_Lok3 = 312 Then
                Button63.BackColor = Drawing.Color.Red
                AutomatikParameter = 312
            ElseIf Ort_Lok3 = 313 Then
                Button93.BackColor = Drawing.Color.Red
                AutomatikParameter = 313
            ElseIf Ort_Lok3 = 315 Then
                Button73.BackColor = Drawing.Color.Red
                AutomatikParameter = 315
            ElseIf Ort_Lok3 = 320 Then
                Button53.BackColor = Drawing.Color.Red
                AutomatikParameter = 320
            End If
            Timer_EinzelLok3.Interval = NumericUpDown3.Value * 1000
            Timer_EinzelLok3.Start()
        End If
    End Sub
    ' *** Kontakt 1.5 true  - Lok4 Bahnhof <-
    Private Sub ObenLang102Lok4()

        ' *** Weiche 27 muss immer geschaltet werden, da Zug 3 diesen Kontakt nur dann auslöst,
        ' *** wenn er Route "oben lang" fährt. Der Zug kommt vom Berg. Weiche 27 muss also nun
        ' *** nach links geschaltet werden. Zug 4 könnte die Weiche aber bereits vorher auf links
        ' *** geschaltet haben.

        _AutomatikParameterH = 0
        AutomatikParameter = 405
        Ort_Lok4 = 415
        A_StopH = 0
        If _StopZug4 > 0 Then
            Zug4(nachlauf)
            'StopZug4()
        End If
        If _StopZug4 = 0 Then
            ' ***
            ' *** kein Halt
            ' ***
            If Weiche17schalten = True Then
                _eb.weicheSchalten(17, Klassen.WeichenRichtung.rechts)
            End If
            If Weiche27schalten = True Then
                _eb.weicheSchalten(27, Klassen.WeichenRichtung.links)
            End If
            If _SBhf_Gleis4 > 0 Then
                _eb.weicheSchalten(9, Klassen.WeichenRichtung.rechts)
            Else
                _eb.weicheSchalten(9, Klassen.WeichenRichtung.links)
            End If
            AutomatikParameter = 405
        ElseIf _StopZug4 = 4 Then    ' *** Halt
            'If _NachlaufZug4 = False Then
            '    'StopZug4()
            '    Zug4(abstellen)
            'Else
            '    Zug4(nachlauf)
            'End If
            If _SBhf_Gleis4 = 1 Or _SBhf_Gleis4 = 2 Then
                _eb.weicheSchalten(9, Klassen.WeichenRichtung.rechts)
            End If
        ElseIf _StopZug4 = 1 Then    ' *** Wechsel > 1
            _Route_Gleis4 = ARoute_Lok4
            ButtonsVisible(999)
        ElseIf _StopZug4 = 2 Then    ' *** Wechsel > 2
            _Route_Gleis4 = ARoute_Lok4
            ButtonsVisible(999)
        ElseIf _StopZug4 = 3 Then    ' *** Wechsel > 3
            _Route_Gleis4 = ARoute_Lok4
            ButtonsVisible(999)
        End If
    End Sub
    ' *** Kontakt 1.5 false - Lok4 Bahnhof <-
    Private Sub ObenLang103Lok4()
        '_LokStufen.EinzelLokSenden(4, 3)
        AutomatikParameter = 406
    End Sub

    ' *** Kontakt 1.2 true  - Bergfahrt <-
    Private Sub Bergfahrt110Lok1()
        ' ***
        ' *** Datum: 17.02.2020
        ' ***
        Dim Stufe3, Stufe4 As Integer

        Stufe3 = _LokStufen.Holen(NumericUpDown8.Value, 3)
        Stufe4 = _LokStufen.Holen(NumericUpDown8.Value, 4)

        If _GleisFrei2 = 1 And Betriebsart12 = 1 And Betriebsart34 = 0 Then
            _eb.weicheSchalten(21, Klassen.WeichenRichtung.rechts)
            _eb.weicheSchalten(19, Klassen.WeichenRichtung.links)
        End If

        Zug1(bergfahrt)

        AutomatikParameter = 111
        If _Kamera = 3 And _aktuelleKamera <> Marxzel Then
            Timer_Kamera1.Interval = 3500
            Timer_Kamera1.Start()
        End If
    End Sub
    Private Sub Bergfahrt110Lok2()
        ' ***
        ' *** Datum: 17.02.2020
        ' ***
        Dim Stufe3, Stufe4 As Integer

        Stufe3 = _LokStufen.Holen(NumericUpDown9.Value, 3)
        Stufe4 = _LokStufen.Holen(NumericUpDown9.Value, 4)

        Zug2(bergfahrt)

        AutomatikParameter = 211
        If _Kamera = 3 And _aktuelleKamera <> Marxzel Then
            Timer_Kamera1.Interval = 3500
            Timer_Kamera1.Start()
        End If
    End Sub
    Private Sub Bergfahrt110Lok3()
        ' ***
        ' *** Datum: 17.02.2020
        ' ***
        Dim Stufe3, Stufe4 As Integer

        Stufe3 = _LokStufen.Holen(NumericUpDown10.Value, 3)
        Stufe4 = _LokStufen.Holen(NumericUpDown10.Value, 4)

        Zug3(bergfahrt)

        AutomatikParameter = 311
        If _Kamera = 3 And _aktuelleKamera <> Marxzel Then
            Timer_Kamera1.Interval = 3500
            Timer_Kamera1.Start()
        End If
    End Sub
    Private Sub Bergfahrt110Lok4()
        ' ***
        ' *** Datum: 17.02.2020
        ' ***
        Dim Stufe3, Stufe4 As Integer

        Stufe3 = _LokStufen.Holen(NumericUpDown11.Value, 3)
        Stufe4 = _LokStufen.Holen(NumericUpDown11.Value, 4)

        Zug4(bergfahrt)

        AutomatikParameter = 411
        If _Kamera = 3 And _aktuelleKamera <> Marxzel Then
            Timer_Kamera1.Interval = 3500
            Timer_Kamera1.Start()
        End If
    End Sub

    ' *** Kontakt 1.2 false  - Bergfahrt <-
    Private Sub Bergfahrt111Lok1()
        AutomatikParameter = 112
    End Sub
    Private Sub Bergfahrt111Lok2()
        AutomatikParameter = 212
    End Sub
    Private Sub Bergfahrt111Lok3()
        AutomatikParameter = 312
    End Sub
    Private Sub Bergfahrt111Lok4()
        AutomatikParameter = 412
    End Sub

    ' *** Kontakt 1.2 true  - Bergfahrt ->
    Private Sub Bergfahrt112Lok1()
        _LokStufen.EinzelLokSenden(1, 3)
        Ort_Lok1 = 120
        If _Betriebsart3_0Var = 0 Then
            AutomatikParameter = 120
            If Weiche26schalten = True Then
                WeicheSchalten(26, Klassen.WeichenRichtung.rechts)
            End If
            If Weiche21schalten = True Then
                WeicheSchalten(21, Klassen.WeichenRichtung.rechts)
            End If
            If Weiche23schalten = True Then
                WeicheSchalten(23, Klassen.WeichenRichtung.links)
            End If
            If Talstrecke_Gleis1 = 1 Then
                WeicheSchalten(12, Klassen.WeichenRichtung.rechts)
                Button91.BackColor = Drawing.Color.Red
                Timer_EinzelLok1.Interval = Warte1TA
                Timer_EinzelLok1.Start()
            End If
            If _Kamera = 3 And _aktuelleKamera <> Forbach Then
                Timer_Kamera0.Interval = 1000
                Timer_Kamera0.Start()
            End If
        ElseIf _Betriebsart3_0Var = 1 Then
            AutomatikParameter = 202
            _eb.weicheSchalten(23, Klassen.WeichenRichtung.rechts)
            Button52.BackColor = Drawing.Color.Red
            Timer_11.Interval = 3000
            Timer_11.Start()
        ElseIf _Betriebsart3_0Var = 2 Then
            AutomatikParameter = 120
            If Weiche26schalten = True Then
                WeicheSchalten(26, Klassen.WeichenRichtung.rechts)
            End If
            If Weiche21schalten = True Then
                WeicheSchalten(21, Klassen.WeichenRichtung.rechts)
            End If
            If Weiche23schalten = True Then
                WeicheSchalten(23, Klassen.WeichenRichtung.links)
            End If
            If Talstrecke_Gleis1 = 1 Then
                WeicheSchalten(12, Klassen.WeichenRichtung.rechts)
                Button91.BackColor = Drawing.Color.Red
                Timer_EinzelLok1.Interval = Warte1TA
                Timer_EinzelLok1.Start()
            End If
            If _Kamera = 3 And _aktuelleKamera <> Forbach Then
                Timer_Kamera0.Interval = 1000
                Timer_Kamera0.Start()
            End If
        Else
            WeicheSchalten(12, Klassen.WeichenRichtung.rechts)
        End If
    End Sub
    Private Sub Bergfahrt112Lok2()
        _LokStufen.EinzelLokSenden(2, 3)
        Ort_Lok2 = 220
        If _Betriebsart3_0Var = 0 Then
            AutomatikParameter = 220
            If Weiche26schalten = True Then
                WeicheSchalten(26, Klassen.WeichenRichtung.rechts)
            End If
            If Weiche21schalten = True Then
                WeicheSchalten(21, Klassen.WeichenRichtung.links)
            End If
            If Weiche23schalten = True Then
                WeicheSchalten(23, Klassen.WeichenRichtung.links)
            End If
            If Talstrecke_Gleis2 = 2 Then
                WeicheSchalten(12, Klassen.WeichenRichtung.rechts)
                Button92.BackColor = Drawing.Color.Red
                Timer_EinzelLok2.Interval = Warte2TA
                Timer_EinzelLok2.Start()
            End If
            If _Kamera = 3 And _aktuelleKamera <> Forbach Then
                Timer_Kamera0.Interval = 1000
                Timer_Kamera0.Start()
            End If
        ElseIf _Betriebsart3_0Var = 1 Then
            _eb.weicheSchalten(23, Klassen.WeichenRichtung.rechts)
            If Ort_Lok1 = 102 Then
                AutomatikParameter = 102
                Button51.BackColor = Drawing.Color.Red
                Timer_11.Interval = 3000
                Timer_11.Start()
            ElseIf Ort_Lok1 = 103 Then
                AutomatikParameter = 220
                Button92.BackColor = Drawing.Color.Red
                Timer_12.Interval = 3000
                Timer_12.Start()
            End If
        ElseIf _Betriebsart3_0Var = 2 Then
            AutomatikParameter = 220
            If Weiche26schalten = True Then
                WeicheSchalten(26, Klassen.WeichenRichtung.rechts)
            End If
            If Weiche21schalten = True Then
                WeicheSchalten(21, Klassen.WeichenRichtung.links)
            End If
            If Weiche23schalten = True Then
                WeicheSchalten(23, Klassen.WeichenRichtung.rechts)
            End If
            If Talstrecke_Gleis2 = 2 Then
                WeicheSchalten(12, Klassen.WeichenRichtung.rechts)
                Button92.BackColor = Drawing.Color.Red
                Timer_EinzelLok2.Interval = Warte2TA
                Timer_EinzelLok2.Start()
            End If
            If _Kamera = 3 And _aktuelleKamera <> Forbach Then
                Timer_Kamera0.Interval = 1000
                Timer_Kamera0.Start()
            End If
        Else
            WeicheSchalten(12, Klassen.WeichenRichtung.rechts)
        End If
        Zug2(660)
    End Sub
    Private Sub Bergfahrt112Lok3()
        Ort_Lok3 = 313
        _LokStufen.EinzelLokSenden(3, 3)
        If Talstrecke_Gleis3 = 0 Then
            If _Route_Gleis3 = 0 Then
                AutomatikParameter = 317
            ElseIf _Route_Gleis3 = 1 Then
                AutomatikParameter = 310
                If Diagonale_Gleis3 = 1 Then
                    WeicheSchalten(10, Klassen.WeichenRichtung.rechts)
                End If
            ElseIf _Route_Gleis3 = 2 Then
                AutomatikParameter = 317
            End If
            If Weiche26schalten = True Then
                If _Route_Gleis3 = 0 Then
                    WeicheSchalten(26, Klassen.WeichenRichtung.rechts)
                ElseIf _Route_Gleis3 = 1 Then
                    WeicheSchalten(26, Klassen.WeichenRichtung.rechts)
                ElseIf _Route_Gleis3 = 2 Then
                    WeicheSchalten(26, Klassen.WeichenRichtung.links)
                End If
            End If
            If Weiche22schalten = True Then
                WeicheSchalten(22, Klassen.WeichenRichtung.rechts)
            End If
            If Weiche23schalten = True Then
                If _Route_Gleis3 = 1 Then
                    WeicheSchalten(23, Klassen.WeichenRichtung.rechts)
                End If
            End If
            If _Kamera = 3 And _aktuelleKamera <> Forbach Then
                Timer_Kamera0.Interval = 1000
                Timer_Kamera0.Start()
            End If
        ElseIf Talstrecke_Gleis3 = 1 Then
            'WeicheSchalten(12, Klassen.WeichenRichtung.rechts)
            'Button91.BackColor = Drawing.Color.Red
            'Timer_EinzelLok1.Interval = NumericUpDown1.Value * 1000
            'Timer_EinzelLok1.Start()
        ElseIf Talstrecke_Gleis3 = 2 Then
            'WeicheSchalten(12, Klassen.WeichenRichtung.rechts)
            'Button91.BackColor = Drawing.Color.Red
            'Timer_EinzelLok2.Interval = NumericUpDown2.Value * 1000
            'Timer_EinzelLok2.Start()
        ElseIf Talstrecke_Gleis3 = 3 Then
            If _Betriebsart0_5Var = 0 Then
                WeicheSchalten(12, Klassen.WeichenRichtung.rechts)
                Button93.BackColor = Drawing.Color.Red
                'Timer_EinzelLok3.Interval = NumericUpDown3.Value * 1000
                Timer_EinzelLok3.Interval = Warte3TA
                Timer_EinzelLok3.Start()
            End If
        ElseIf Talstrecke_Gleis3 = 4 Then
            If _Betriebsart0_5Var = 1 Then
                WeicheSchalten(12, Klassen.WeichenRichtung.rechts)
                Button53.BackColor = Drawing.Color.Red
                Timer_11.Interval = 3000
                Timer_11.Start()
                AutomatikParameter = 402
            End If
        End If
    End Sub
    Private Sub Bergfahrt112Lok4()
        Ort_Lok4 = 413
        _LokStufen.EinzelLokSenden(4, 3)
        If Talstrecke_Gleis4 = 0 Then
            If _Route_Gleis4 = 0 Then
                AutomatikParameter = 417
            ElseIf _Route_Gleis4 = 1 Then
                AutomatikParameter = 410
                If Diagonale_Gleis4 = 1 Then
                    WeicheSchalten(10, Klassen.WeichenRichtung.rechts)
                End If
            ElseIf _Route_Gleis4 = 2 Then
                AutomatikParameter = 417
            End If
            If Weiche26schalten = True Then
                If _Route_Gleis4 = 0 Then
                    WeicheSchalten(26, Klassen.WeichenRichtung.rechts)
                ElseIf _Route_Gleis4 = 1 Then
                    WeicheSchalten(26, Klassen.WeichenRichtung.rechts)
                ElseIf _Route_Gleis4 = 2 Then
                    WeicheSchalten(26, Klassen.WeichenRichtung.links)
                End If
            End If
            If Weiche22schalten = True Then
                WeicheSchalten(22, Klassen.WeichenRichtung.links)
            End If
            If Weiche23schalten = True Then
                If _Route_Gleis4 = 1 Then
                    WeicheSchalten(23, Klassen.WeichenRichtung.rechts)
                End If
            End If
            If _Kamera = 3 And _aktuelleKamera <> Forbach Then
                Timer_Kamera0.Interval = 1000
                Timer_Kamera0.Start()
            End If
        ElseIf Talstrecke_Gleis4 = 1 Then
            'WeicheSchalten(12, Klassen.WeichenRichtung.rechts)
            'Button91.BackColor = Drawing.Color.Red
            'Timer_EinzelLok1.Interval = NumericUpDown1.Value * 1000
            'Timer_EinzelLok1.Start()
        ElseIf Talstrecke_Gleis4 = 2 Then
            'WeicheSchalten(12, Klassen.WeichenRichtung.rechts)
            'Button92.BackColor = Drawing.Color.Red
            'Timer_EinzelLok2.Interval = NumericUpDown2.Value * 1000
            'Timer_EinzelLok2.Start()
        ElseIf Talstrecke_Gleis4 = 3 Then
            If _Betriebsart0_5Var = 1 Then
                WeicheSchalten(12, Klassen.WeichenRichtung.rechts)
                Button53.BackColor = Drawing.Color.Red
                Timer_11.Interval = 3000
                Timer_11.Start()
                AutomatikParameter = 302
            End If
        ElseIf Talstrecke_Gleis4 = 4 Then
            If _Betriebsart0_5Var = 0 Then
                WeicheSchalten(12, Klassen.WeichenRichtung.rechts)
                Button94.BackColor = Drawing.Color.Red
                'Timer_EinzelLok4.Interval = 3000
                Timer_EinzelLok4.Interval = Warte4TA
                Timer_EinzelLok4.Start()
            End If
        End If
    End Sub

    ' *** Kontakt 3.5 - Halt in Bärental
    'Private Sub BerghaltLok1()
    '    Ort_Lok1 = 112
    '    If _Berg_Gleis1 = 2 Then
    '        _LokStufen.EinzelLokSenden(1, 0)
    '        'Timer_EinzelLok1.Interval = NumericUpDown1.Value * 1000
    '        Timer_EinzelLok1.Interval = Warte1BA
    '        Timer_EinzelLok1.Start()
    '        Button61.BackColor = Drawing.Color.Red
    '    End If
    '    If Talstrecke_Gleis1 = 1 Then
    '        _eb.weicheSchalten(12, Klassen.WeichenRichtung.rechts)
    '    End If
    'End Sub
    'Private Sub BerghaltLok2()
    '    Ort_Lok2 = 212
    '    If _Berg_Gleis2 = 2 Then
    '        _LokStufen.EinzelLokSenden(2, 0)
    '        'Timer_EinzelLok2.Interval = NumericUpDown2.Value * 1000
    '        Timer_EinzelLok2.Interval = Warte2BA
    '        Timer_EinzelLok2.Start()
    '        Button62.BackColor = Drawing.Color.Red
    '    End If
    '    If Talstrecke_Gleis2 = 1 Then
    '        _eb.weicheSchalten(12, Klassen.WeichenRichtung.rechts)
    '    End If
    'End Sub
    'Private Sub BerghaltLok3()
    '    Ort_Lok3 = 312
    '    If _Berg_Gleis3 = 2 Then
    '        _LokStufen.EinzelLokSenden(3, 0)
    '        'Timer_EinzelLok3.Interval = NumericUpDown3.Value * 1000
    '        Timer_EinzelLok3.Interval = Warte3BA
    '        Timer_EinzelLok3.Start()
    '        Button63.BackColor = Drawing.Color.Red
    '    End If
    '    If Talstrecke_Gleis3 = 1 Then
    '        _eb.weicheSchalten(12, Klassen.WeichenRichtung.rechts)
    '    End If
    'End Sub
    'Private Sub BerghaltLok4()
    '    Ort_Lok4 = 412
    '    If _Berg_Gleis4 = 2 Then
    '        _LokStufen.EinzelLokSenden(4, 0)
    '        'Timer_EinzelLok4.Interval = NumericUpDown4.Value * 1000
    '        Timer_EinzelLok4.Interval = Warte4BA
    '        Timer_EinzelLok4.Start()
    '        Button64.BackColor = Drawing.Color.Red
    '    End If
    '    If Talstrecke_Gleis4 = 1 Then
    '        _eb.weicheSchalten(12, Klassen.WeichenRichtung.rechts)
    '    End If
    'End Sub

    Private Sub Zug1(Ort As Integer)
        ' ***
        ' *** Datum: 30.01.2021
        ' ***
        If NumericUpDown8.Value = 1 Then
        ElseIf NumericUpDown8.Value = 10 Then
            _Prog10 = Ort
            _GlsL10 = 1
            _TypL10 = _Zugtyp1
            Prog_Lok10.Interval = 200
            Prog_Lok10.Start()
        ElseIf NumericUpDown8.Value = 11 Then
            _Prog11 = Ort
            _GlsL11 = 1
            _TypL11 = _Zugtyp1
            Prog_Lok11.Interval = 200
            Prog_Lok11.Start()
        ElseIf NumericUpDown8.Value = 12 Then
            _Prog12 = Ort
            _GlsL12 = 1
            _TypL12 = _Zugtyp1
            Prog_Lok12.Interval = 200
            Prog_Lok12.Start()
        ElseIf NumericUpDown8.Value = 13 Then
            _Prog13 = Ort
            _GlsL13 = 1
            _TypL13 = _Zugtyp1
            Prog_Lok13.Interval = 200
            Prog_Lok13.Start()
        ElseIf NumericUpDown8.Value = 14 Then
            _Prog14 = Ort
            _GlsL14 = 1
            _TypL14 = _Zugtyp1
            Prog_Lok14.Interval = 200
            Prog_Lok14.Start()
        ElseIf NumericUpDown8.Value = 15 Then
            _Prog15 = Ort
            _GlsL15 = 1
            _TypL15 = _Zugtyp1
            Prog_Lok15.Interval = 200
            Prog_Lok15.Start()
        ElseIf NumericUpDown8.Value = 16 Then
            _Prog16 = Ort
            _GlsL16 = 1
            _TypL16 = _Zugtyp1
            Prog_Lok16.Interval = 200
            Prog_Lok16.Start()
        ElseIf NumericUpDown8.Value = 17 Then
            _Prog17 = Ort
            _GlsL17 = 1
            _TypL17 = _Zugtyp1
            Prog_Lok17.Interval = 200
            Prog_Lok17.Start()
        ElseIf NumericUpDown8.Value = 18 Then
            _Prog18 = Ort
            _GlsL18 = 1
            _TypL18 = _Zugtyp1
            Prog_Lok18.Interval = 200
            Prog_Lok18.Start()
        ElseIf NumericUpDown8.Value = 19 Then
            _Prog19 = Ort
            _GlsL19 = 1
            _TypL19 = _Zugtyp1
            Prog_Lok19.Interval = 200
            Prog_Lok19.Start()
        ElseIf NumericUpDown8.Value = 20 Then
            _Prog20 = Ort
            _GlsL20 = 1
            _TypL20 = _Zugtyp1
            Prog_Lok20.Interval = 200
            Prog_Lok20.Start()
        ElseIf NumericUpDown8.Value = 21 Then
            _Prog21 = Ort
            _GlsL21 = 1
            _TypL21 = _Zugtyp1
            Prog_Lok21.Interval = 200
            Prog_Lok21.Start()
        ElseIf NumericUpDown8.Value = 22 Then
            _Prog22 = Ort
            _GlsL22 = 1
            _TypL22 = _Zugtyp1
            Prog_Lok22.Interval = 200
            Prog_Lok22.Start()
        ElseIf NumericUpDown8.Value = 23 Then
            _Prog23 = Ort
            _GlsL23 = 1
            _TypL23 = _Zugtyp1
            Prog_Lok23.Interval = 200
            Prog_Lok23.Start()
        ElseIf NumericUpDown8.Value = 24 Then
            _Prog24 = Ort
            _GlsL24 = 1
            _TypL24 = _Zugtyp1
            Prog_Lok24.Interval = 200
            Prog_Lok24.Start()
        ElseIf NumericUpDown8.Value = 25 Then
            _Prog25 = Ort
            _GlsL25 = 1
            _TypL25 = _Zugtyp1
            Prog_Lok25.Interval = 200
            Prog_Lok25.Start()
        ElseIf NumericUpDown8.Value = 26 Then
            _Prog26 = Ort
            _GlsL26 = 1
            _TypL26 = _Zugtyp1
            Prog_Lok26.Interval = 200
            Prog_Lok26.Start()
        ElseIf NumericUpDown8.Value = 27 Then
            _Prog27 = Ort
            _GlsL27 = 1
            _TypL27 = _Zugtyp1
            Prog_Lok27.Interval = 200
            Prog_Lok27.Start()
        ElseIf NumericUpDown8.Value = 28 Then
            _Prog28 = Ort
            _GlsL28 = 1
            _TypL28 = _Zugtyp1
            Prog_Lok28.Interval = 200
            Prog_Lok28.Start()
        ElseIf NumericUpDown8.Value = 29 Then
            _Prog29 = Ort
            _GlsL29 = 1
            _TypL29 = _Zugtyp1
            Prog_Lok29.Interval = 200
            Prog_Lok29.Start()
        ElseIf NumericUpDown8.Value = 30 Then
            _Prog30 = Ort
            _GlsL30 = 1
            _TypL30 = _Zugtyp1
            Prog_Lok30.Interval = 200
            Prog_Lok30.Start()
        ElseIf NumericUpDown8.Value = 31 Then
            _Prog31 = Ort
            _GlsL31 = 1
            _TypL31 = _Zugtyp1
            Prog_Lok31.Interval = 200
            Prog_Lok31.Start()
        ElseIf NumericUpDown8.Value = 32 Then
            _Prog32 = Ort
            _GlsL32 = 1
            _TypL32 = _Zugtyp1
            Prog_Lok32.Interval = 200
            Prog_Lok32.Start()
        ElseIf NumericUpDown8.Value = 33 Then
            _Prog33 = Ort
            _GlsL33 = 1
            _TypL33 = _Zugtyp1
            Prog_Lok33.Interval = 200
            Prog_Lok33.Start()
        ElseIf NumericUpDown8.Value = 34 Then
            _Prog34 = Ort
            _GlsL34 = 1
            _TypL34 = _Zugtyp1
            Prog_Lok34.Interval = 200
            Prog_Lok34.Start()
        ElseIf NumericUpDown8.Value = 35 Then
            _Prog35 = Ort
            _GlsL35 = 1
            _TypL35 = _Zugtyp1
            Prog_Lok35.Interval = 200
            Prog_Lok35.Start()
        ElseIf NumericUpDown8.Value = 36 Then
            _Prog36 = Ort
            _GlsL36 = 1
            _TypL36 = _Zugtyp1
            Prog_Lok36.Interval = 200
            Prog_Lok36.Start()
        ElseIf NumericUpDown8.Value = 37 Then
            _Prog37 = Ort
            _GlsL37 = 1
            _TypL37 = _Zugtyp1
            Prog_Lok37.Interval = 200
            Prog_Lok37.Start()
        ElseIf NumericUpDown8.Value = 38 Then
            _Prog38 = Ort
            _GlsL38 = 1
            _TypL38 = _Zugtyp1
            Prog_Lok38.Interval = 200
            Prog_Lok38.Start()
        ElseIf NumericUpDown8.Value = 39 Then
            _Prog39 = Ort
            _GlsL39 = 1
            _TypL39 = _Zugtyp1
            Prog_Lok39.Interval = 200
            Prog_Lok39.Start()
        ElseIf NumericUpDown8.Value = 40 Then
            _Prog40 = Ort
            _GlsL40 = 1
            _TypL40 = _Zugtyp1
            Prog_Lok40.Interval = 200
            Prog_Lok40.Start()
        ElseIf NumericUpDown8.Value = 41 Then
            _Prog41 = Ort
            _GlsL41 = 1
            _TypL41 = _Zugtyp1
            Prog_Lok41.Interval = 200
            Prog_Lok41.Start()
        ElseIf NumericUpDown8.Value = 42 Then
            _Prog42 = Ort
            _GlsL42 = 1
            _TypL42 = _Zugtyp1
            Prog_Lok42.Interval = 200
            Prog_Lok42.Start()
        ElseIf NumericUpDown8.Value = 43 Then
            _Prog43 = Ort
            _GlsL43 = 1
            _TypL43 = _Zugtyp1
            Prog_Lok43.Interval = 200
            Prog_Lok43.Start()
        ElseIf NumericUpDown8.Value = 44 Then
            _Prog44 = Ort
            _GlsL44 = 1
            _TypL44 = _Zugtyp1
            Prog_Lok44.Interval = 200
            Prog_Lok44.Start()
        ElseIf NumericUpDown8.Value = 45 Then
            _Prog45 = Ort
            _GlsL45 = 1
            _TypL45 = _Zugtyp1
            Prog_Lok45.Interval = 200
            Prog_Lok45.Start()
        ElseIf NumericUpDown8.Value = 46 Then
            _Prog46 = Ort
            _GlsL46 = 1
            _TypL46 = _Zugtyp1
            Prog_Lok46.Interval = 200
            Prog_Lok46.Start()
        ElseIf NumericUpDown8.Value = 47 Then
            _Prog47 = Ort
            _GlsL47 = 1
            _TypL47 = _Zugtyp1
            Prog_Lok47.Interval = 200
            Prog_Lok47.Start()
        ElseIf NumericUpDown8.Value = 48 Then
            _Prog48 = Ort
            _GlsL48 = 1
            _TypL48 = _Zugtyp1
            Prog_Lok48.Interval = 200
            Prog_Lok48.Start()
        ElseIf NumericUpDown8.Value = 49 Then
            _Prog49 = Ort
            _GlsL49 = 1
            _TypL49 = _Zugtyp1
            Prog_Lok49.Interval = 200
            Prog_Lok49.Start()
        ElseIf NumericUpDown8.Value = 50 Then
            _Prog50 = Ort
            _GlsL50 = 1
            _TypL50 = _Zugtyp1
            Prog_Lok50.Interval = 200
            Prog_Lok50.Start()
        ElseIf NumericUpDown8.Value = 51 Then
            _Prog51 = Ort
            _GlsL51 = 1
            _TypL51 = _Zugtyp1
            Prog_Lok51.Interval = 200
            Prog_Lok51.Start()
        ElseIf NumericUpDown8.Value = 52 Then
            _Prog52 = Ort
            _GlsL52 = 1
            _TypL52 = _Zugtyp1
            Prog_Lok52.Interval = 200
            Prog_Lok52.Start()
        ElseIf NumericUpDown8.Value = 53 Then
            _Prog53 = Ort
            _GlsL53 = 1
            _TypL53 = _Zugtyp1
            Prog_Lok53.Interval = 200
            Prog_Lok53.Start()
        ElseIf NumericUpDown8.Value = 54 Then
            _Prog54 = Ort
            _GlsL54 = 1
            _TypL54 = _Zugtyp1
            Prog_Lok54.Interval = 200
            Prog_Lok54.Start()
        ElseIf NumericUpDown8.Value = 55 Then
            _Prog55 = Ort
            _GlsL55 = 1
            _TypL55 = _Zugtyp1
            Prog_Lok55.Interval = 200
            Prog_Lok55.Start()
        ElseIf NumericUpDown8.Value = 56 Then
            _Prog56 = Ort
            _GlsL56 = 1
            _TypL56 = _Zugtyp1
            Prog_Lok56.Interval = 200
            Prog_Lok56.Start()
        ElseIf NumericUpDown8.Value = 57 Then
            _Prog57 = Ort
            _GlsL57 = 1
            _TypL57 = _Zugtyp1
            Prog_Lok57.Interval = 200
            Prog_Lok57.Start()
        ElseIf NumericUpDown8.Value = 58 Then
            _Prog58 = Ort
            _GlsL58 = 1
            _TypL58 = _Zugtyp1
            Prog_Lok58.Interval = 200
            Prog_Lok58.Start()
        ElseIf NumericUpDown8.Value = 59 Then
            _Prog59 = Ort
            _GlsL59 = 1
            _TypL59 = _Zugtyp1
            Prog_Lok59.Interval = 200
            Prog_Lok59.Start()
        ElseIf NumericUpDown8.Value = 60 Then
            _Prog60 = Ort
            _GlsL60 = 1
            _TypL60 = _Zugtyp1
            Prog_Lok60.Interval = 200
            Prog_Lok60.Start()
        ElseIf NumericUpDown8.Value = 61 Then
            _Prog61 = Ort
            _GlsL61 = 1
            _TypL61 = _Zugtyp1
            Prog_Lok61.Interval = 200
            Prog_Lok61.Start()
        ElseIf NumericUpDown8.Value = 62 Then
            _Prog62 = Ort
            _GlsL62 = 1
            _TypL62 = _Zugtyp1
            Prog_Lok62.Interval = 200
            Prog_Lok62.Start()
        ElseIf NumericUpDown8.Value = 63 Then
            _Prog63 = Ort
            _GlsL63 = 1
            _TypL63 = _Zugtyp1
            Prog_Lok63.Interval = 200
            Prog_Lok63.Start()
        ElseIf NumericUpDown8.Value = 64 Then
            _Prog64 = Ort
            _GlsL64 = 1
            _TypL64 = _Zugtyp1
            Prog_Lok64.Interval = 200
            Prog_Lok64.Start()
        ElseIf NumericUpDown8.Value = 65 Then
            _Prog65 = Ort
            _GlsL65 = 1
            _TypL65 = _Zugtyp1
            Prog_Lok65.Interval = 200
            Prog_Lok65.Start()
        ElseIf NumericUpDown8.Value = 66 Then
            _Prog66 = Ort
            _GlsL66 = 1
            _TypL66 = _Zugtyp1
            Prog_Lok66.Interval = 200
            Prog_Lok66.Start()
        ElseIf NumericUpDown8.Value = 67 Then
            _Prog67 = Ort
            _GlsL67 = 1
            _TypL67 = _Zugtyp1
            Prog_Lok67.Interval = 200
            Prog_Lok67.Start()
        ElseIf NumericUpDown8.Value = 68 Then
            _Prog68 = Ort
            _GlsL68 = 1
            _TypL68 = _Zugtyp1
            Prog_Lok68.Interval = 200
            Prog_Lok68.Start()
        ElseIf NumericUpDown8.Value = 69 Then
            _Prog69 = Ort
            _GlsL69 = 1
            _TypL69 = _Zugtyp1
            Prog_Lok69.Interval = 200
            Prog_Lok69.Start()
        ElseIf NumericUpDown8.Value = 70 Then
            _Prog70 = Ort
            _GlsL70 = 1
            _TypL70 = _Zugtyp1
            Prog_Lok70.Interval = 200
            Prog_Lok70.Start()
        ElseIf NumericUpDown8.Value = 71 Then
            _Prog71 = Ort
            _GlsL71 = 1
            _TypL71 = _Zugtyp1
            Prog_Lok71.Interval = 200
            Prog_Lok71.Start()
        ElseIf NumericUpDown8.Value = 72 Then
            _Prog72 = Ort
            _GlsL72 = 1
            _TypL72 = _Zugtyp1
            Prog_Lok72.Interval = 200
            Prog_Lok72.Start()
        ElseIf NumericUpDown8.Value = 73 Then
            _Prog73 = Ort
            _GlsL73 = 1
            _TypL73 = _Zugtyp1
            Prog_Lok73.Interval = 200
            Prog_Lok73.Start()
        ElseIf NumericUpDown8.Value = 74 Then
            _Prog74 = Ort
            _GlsL74 = 1
            _TypL74 = _Zugtyp1
            Prog_Lok74.Interval = 200
            Prog_Lok74.Start()
        ElseIf NumericUpDown8.Value = 75 Then
            _Prog75 = Ort
            _GlsL75 = 1
            _TypL75 = _Zugtyp1
            Prog_Lok75.Interval = 200
            Prog_Lok75.Start()
        ElseIf NumericUpDown8.Value = 76 Then
            _Prog76 = Ort
            _GlsL76 = 1
            _TypL76 = _Zugtyp1
            Prog_Lok76.Interval = 200
            Prog_Lok76.Start()
        ElseIf NumericUpDown8.Value = 77 Then
            _Prog77 = Ort
            _GlsL77 = 1
            _TypL77 = _Zugtyp1
            Prog_Lok77.Interval = 200
            Prog_Lok77.Start()
        ElseIf NumericUpDown8.Value = 78 Then
            _Prog78 = Ort
            _GlsL78 = 1
            _TypL78 = _Zugtyp1
            Prog_Lok78.Interval = 200
            Prog_Lok78.Start()
        ElseIf NumericUpDown8.Value = 79 Then
            _Prog79 = Ort
            _GlsL79 = 1
            _TypL79 = _Zugtyp1
            Prog_Lok79.Interval = 200
            Prog_Lok79.Start()
        ElseIf NumericUpDown8.Value = 80 Then
            _Prog80 = Ort
            _GlsL80 = 1
            _TypL80 = _Zugtyp1
            Prog_Lok80.Interval = 200
            Prog_Lok80.Start()
        Else
            _LokStufen.EinzelLokSenden(1, 2)
        End If
    End Sub
    Private Sub Zug2(Ort As Integer)
        ' ***
        ' *** Datum: 30.01.2021
        ' ***
        If NumericUpDown9.Value = 1 Then
        ElseIf NumericUpDown9.Value = 10 Then
            _Prog10 = Ort
            _GlsL10 = 2
            _TypL10 = _Zugtyp2
            Prog_Lok10.Interval = 200
            Prog_Lok10.Start()
        ElseIf NumericUpDown9.Value = 11 Then
            _Prog11 = Ort
            _GlsL11 = 2
            _TypL11 = _Zugtyp2
            Prog_Lok11.Interval = 200
            Prog_Lok11.Start()
        ElseIf NumericUpDown9.Value = 12 Then
            _Prog12 = Ort
            _GlsL12 = 2
            _TypL12 = _Zugtyp2
            Prog_Lok12.Interval = 200
            Prog_Lok12.Start()
        ElseIf NumericUpDown9.Value = 13 Then
            _Prog13 = Ort
            _GlsL13 = 2
            _TypL13 = _Zugtyp2
            Prog_Lok13.Interval = 200
            Prog_Lok13.Start()
        ElseIf NumericUpDown9.Value = 14 Then
            _Prog14 = Ort
            _GlsL14 = 2
            _TypL14 = _Zugtyp2
            Prog_Lok14.Interval = 200
            Prog_Lok14.Start()
        ElseIf NumericUpDown9.Value = 15 Then
            _Prog15 = Ort
            _GlsL15 = 2
            _TypL15 = _Zugtyp2
            Prog_Lok15.Interval = 200
            Prog_Lok15.Start()
        ElseIf NumericUpDown9.Value = 16 Then
            _Prog16 = Ort
            _GlsL16 = 2
            _TypL16 = _Zugtyp2
            Prog_Lok16.Interval = 200
            Prog_Lok16.Start()
        ElseIf NumericUpDown9.Value = 17 Then
            _Prog17 = Ort
            _GlsL17 = 2
            _TypL17 = _Zugtyp2
            Prog_Lok17.Interval = 200
            Prog_Lok17.Start()
        ElseIf NumericUpDown9.Value = 18 Then
            _Prog18 = Ort
            _GlsL18 = 2
            _TypL18 = _Zugtyp2
            Prog_Lok18.Interval = 200
            Prog_Lok18.Start()
        ElseIf NumericUpDown9.Value = 19 Then
            _Prog19 = Ort
            _GlsL19 = 2
            _TypL19 = _Zugtyp2
            Prog_Lok19.Interval = 200
            Prog_Lok19.Start()
        ElseIf NumericUpDown9.Value = 20 Then
            _Prog20 = Ort
            _GlsL20 = 2
            _TypL20 = _Zugtyp2
            Prog_Lok20.Interval = 200
            Prog_Lok20.Start()
        ElseIf NumericUpDown9.Value = 21 Then
            _Prog21 = Ort
            _GlsL21 = 2
            _TypL21 = _Zugtyp2
            Prog_Lok21.Interval = 200
            Prog_Lok21.Start()
        ElseIf NumericUpDown9.Value = 22 Then
            _Prog22 = Ort
            _GlsL22 = 2
            _TypL22 = _Zugtyp2
            Prog_Lok22.Interval = 200
            Prog_Lok22.Start()
        ElseIf NumericUpDown9.Value = 23 Then
            _Prog23 = Ort
            _GlsL23 = 2
            _TypL23 = _Zugtyp2
            Prog_Lok23.Interval = 200
            Prog_Lok23.Start()
        ElseIf NumericUpDown9.Value = 24 Then
            _Prog24 = Ort
            _GlsL24 = 2
            _TypL24 = _Zugtyp2
            Prog_Lok24.Interval = 200
            Prog_Lok24.Start()
        ElseIf NumericUpDown9.Value = 25 Then
            _Prog25 = Ort
            _GlsL25 = 2
            _TypL25 = _Zugtyp2
            Prog_Lok25.Interval = 200
            Prog_Lok25.Start()
        ElseIf NumericUpDown9.Value = 26 Then
            _Prog26 = Ort
            _GlsL26 = 2
            _TypL26 = _Zugtyp2
            Prog_Lok26.Interval = 200
            Prog_Lok26.Start()
        ElseIf NumericUpDown9.Value = 27 Then
            _Prog27 = Ort
            _GlsL27 = 2
            _TypL27 = _Zugtyp2
            Prog_Lok27.Interval = 200
            Prog_Lok27.Start()
        ElseIf NumericUpDown9.Value = 28 Then
            _Prog28 = Ort
            _GlsL28 = 2
            _TypL28 = _Zugtyp2
            Prog_Lok28.Interval = 200
            Prog_Lok28.Start()
        ElseIf NumericUpDown9.Value = 29 Then
            _Prog29 = Ort
            _GlsL29 = 2
            _TypL29 = _Zugtyp2
            Prog_Lok29.Interval = 200
            Prog_Lok29.Start()
        ElseIf NumericUpDown9.Value = 30 Then
            _Prog30 = Ort
            _GlsL30 = 2
            _TypL30 = _Zugtyp2
            Prog_Lok30.Interval = 200
            Prog_Lok30.Start()
        ElseIf NumericUpDown9.Value = 31 Then
            _Prog31 = Ort
            _GlsL31 = 2
            _TypL31 = _Zugtyp2
            Prog_Lok31.Interval = 200
            Prog_Lok31.Start()
        ElseIf NumericUpDown9.Value = 32 Then
            _Prog32 = Ort
            _GlsL32 = 2
            _TypL32 = _Zugtyp2
            Prog_Lok32.Interval = 200
            Prog_Lok32.Start()
        ElseIf NumericUpDown9.Value = 33 Then
            _Prog33 = Ort
            _GlsL33 = 2
            _TypL33 = _Zugtyp2
            Prog_Lok33.Interval = 200
            Prog_Lok33.Start()
        ElseIf NumericUpDown9.Value = 34 Then
            _Prog34 = Ort
            _GlsL34 = 2
            _TypL34 = _Zugtyp2
            Prog_Lok34.Interval = 200
            Prog_Lok34.Start()
        ElseIf NumericUpDown9.Value = 35 Then
            _Prog35 = Ort
            _GlsL35 = 2
            _TypL35 = _Zugtyp2
            Prog_Lok35.Interval = 200
            Prog_Lok35.Start()
        ElseIf NumericUpDown9.Value = 36 Then
            _Prog36 = Ort
            _GlsL36 = 2
            _TypL36 = _Zugtyp2
            Prog_Lok36.Interval = 200
            Prog_Lok36.Start()
        ElseIf NumericUpDown9.Value = 37 Then
            _Prog37 = Ort
            _GlsL37 = 2
            _TypL37 = _Zugtyp2
            Prog_Lok37.Interval = 200
            Prog_Lok37.Start()
        ElseIf NumericUpDown9.Value = 38 Then
            _Prog38 = Ort
            _GlsL38 = 2
            _TypL38 = _Zugtyp2
            Prog_Lok38.Interval = 200
            Prog_Lok38.Start()
        ElseIf NumericUpDown9.Value = 39 Then
            _Prog39 = Ort
            _GlsL39 = 2
            _TypL39 = _Zugtyp2
            Prog_Lok39.Interval = 200
            Prog_Lok39.Start()
        ElseIf NumericUpDown9.Value = 40 Then
            _Prog40 = Ort
            _GlsL40 = 2
            _TypL40 = _Zugtyp2
            Prog_Lok40.Interval = 200
            Prog_Lok40.Start()
        ElseIf NumericUpDown9.Value = 41 Then
            _Prog41 = Ort
            _GlsL41 = 2
            _TypL41 = _Zugtyp2
            Prog_Lok41.Interval = 200
            Prog_Lok41.Start()
        ElseIf NumericUpDown9.Value = 42 Then
            _Prog42 = Ort
            _GlsL42 = 2
            _TypL42 = _Zugtyp2
            Prog_Lok42.Interval = 200
            Prog_Lok42.Start()
        ElseIf NumericUpDown9.Value = 43 Then
            _Prog43 = Ort
            _GlsL43 = 2
            _TypL43 = _Zugtyp2
            Prog_Lok43.Interval = 200
            Prog_Lok43.Start()
        ElseIf NumericUpDown9.Value = 44 Then
            _Prog44 = Ort
            _GlsL44 = 2
            _TypL44 = _Zugtyp2
            Prog_Lok44.Interval = 200
            Prog_Lok44.Start()
        ElseIf NumericUpDown9.Value = 45 Then
            _Prog45 = Ort
            _GlsL45 = 2
            _TypL45 = _Zugtyp2
            Prog_Lok45.Interval = 200
            Prog_Lok45.Start()
        ElseIf NumericUpDown9.Value = 46 Then
            _Prog46 = Ort
            _GlsL46 = 2
            _TypL46 = _Zugtyp2
            Prog_Lok46.Interval = 200
            Prog_Lok46.Start()
        ElseIf NumericUpDown9.Value = 47 Then
            _Prog47 = Ort
            _GlsL47 = 2
            _TypL47 = _Zugtyp2
            Prog_Lok47.Interval = 200
            Prog_Lok47.Start()
        ElseIf NumericUpDown9.Value = 48 Then
            _Prog48 = Ort
            _GlsL48 = 2
            _TypL48 = _Zugtyp2
            Prog_Lok48.Interval = 200
            Prog_Lok48.Start()
        ElseIf NumericUpDown9.Value = 49 Then
            _Prog49 = Ort
            _GlsL49 = 2
            _TypL49 = _Zugtyp2
            Prog_Lok49.Interval = 200
            Prog_Lok49.Start()
        ElseIf NumericUpDown9.Value = 50 Then
            _Prog50 = Ort
            _GlsL50 = 2
            _TypL50 = _Zugtyp2
            Prog_Lok50.Interval = 200
            Prog_Lok50.Start()
        ElseIf NumericUpDown9.Value = 51 Then
            _Prog51 = Ort
            _GlsL51 = 2
            _TypL51 = _Zugtyp2
            Prog_Lok51.Interval = 200
            Prog_Lok51.Start()
        ElseIf NumericUpDown9.Value = 52 Then
            _Prog52 = Ort
            _GlsL52 = 2
            _TypL52 = _Zugtyp2
            Prog_Lok52.Interval = 200
            Prog_Lok52.Start()
        ElseIf NumericUpDown9.Value = 53 Then
            _Prog53 = Ort
            _GlsL53 = 2
            _TypL53 = _Zugtyp2
            Prog_Lok53.Interval = 200
            Prog_Lok53.Start()
        ElseIf NumericUpDown9.Value = 54 Then
            _Prog54 = Ort
            _GlsL54 = 2
            _TypL54 = _Zugtyp2
            Prog_Lok54.Interval = 200
            Prog_Lok54.Start()
        ElseIf NumericUpDown9.Value = 55 Then
            _Prog55 = Ort
            _GlsL55 = 2
            _TypL55 = _Zugtyp2
            Prog_Lok55.Interval = 200
            Prog_Lok55.Start()
        ElseIf NumericUpDown9.Value = 56 Then
            _Prog56 = Ort
            _GlsL56 = 2
            _TypL56 = _Zugtyp2
            Prog_Lok56.Interval = 200
            Prog_Lok56.Start()
        ElseIf NumericUpDown9.Value = 57 Then
            _Prog57 = Ort
            _GlsL57 = 2
            _TypL57 = _Zugtyp2
            Prog_Lok57.Interval = 200
            Prog_Lok57.Start()
        ElseIf NumericUpDown9.Value = 58 Then
            _Prog58 = Ort
            _GlsL58 = 2
            _TypL58 = _Zugtyp2
            Prog_Lok58.Interval = 200
            Prog_Lok58.Start()
        ElseIf NumericUpDown9.Value = 59 Then
            _Prog59 = Ort
            _GlsL59 = 2
            _TypL59 = _Zugtyp2
            Prog_Lok59.Interval = 200
            Prog_Lok59.Start()
        ElseIf NumericUpDown9.Value = 60 Then
            _Prog60 = Ort
            _GlsL60 = 2
            _TypL60 = _Zugtyp2
            Prog_Lok60.Interval = 200
            Prog_Lok60.Start()
        ElseIf NumericUpDown9.Value = 61 Then
            _Prog61 = Ort
            _GlsL61 = 2
            _TypL61 = _Zugtyp2
            Prog_Lok61.Interval = 200
            Prog_Lok61.Start()
        ElseIf NumericUpDown9.Value = 62 Then
            _Prog62 = Ort
            _GlsL62 = 2
            _TypL62 = _Zugtyp2
            Prog_Lok62.Interval = 200
            Prog_Lok62.Start()
        ElseIf NumericUpDown9.Value = 63 Then
            _Prog63 = Ort
            _GlsL63 = 2
            _TypL63 = _Zugtyp2
            Prog_Lok63.Interval = 200
            Prog_Lok63.Start()
        ElseIf NumericUpDown9.Value = 64 Then
            _Prog64 = Ort
            _GlsL64 = 2
            _TypL64 = _Zugtyp2
            Prog_Lok64.Interval = 200
            Prog_Lok64.Start()
        ElseIf NumericUpDown9.Value = 65 Then
            _Prog65 = Ort
            _GlsL65 = 2
            _TypL65 = _Zugtyp2
            Prog_Lok65.Interval = 200
            Prog_Lok65.Start()
        ElseIf NumericUpDown9.Value = 66 Then
            _Prog66 = Ort
            _GlsL66 = 2
            _TypL66 = _Zugtyp2
            Prog_Lok66.Interval = 200
            Prog_Lok66.Start()
        ElseIf NumericUpDown9.Value = 67 Then
            _Prog67 = Ort
            _GlsL67 = 2
            _TypL67 = _Zugtyp2
            Prog_Lok67.Interval = 200
            Prog_Lok67.Start()
        ElseIf NumericUpDown9.Value = 68 Then
            _Prog68 = Ort
            _GlsL68 = 2
            _TypL68 = _Zugtyp2
            Prog_Lok68.Interval = 200
            Prog_Lok68.Start()
        ElseIf NumericUpDown9.Value = 69 Then
            _Prog69 = Ort
            _GlsL69 = 2
            _TypL69 = _Zugtyp2
            Prog_Lok69.Interval = 200
            Prog_Lok69.Start()
        ElseIf NumericUpDown9.Value = 70 Then
            _Prog70 = Ort
            _GlsL70 = 2
            _TypL70 = _Zugtyp2
            Prog_Lok70.Interval = 200
            Prog_Lok70.Start()
        ElseIf NumericUpDown9.Value = 71 Then
            _Prog71 = Ort
            _GlsL71 = 2
            _TypL71 = _Zugtyp2
            Prog_Lok71.Interval = 200
            Prog_Lok71.Start()
        ElseIf NumericUpDown9.Value = 72 Then
            _Prog72 = Ort
            _GlsL72 = 2
            _TypL72 = _Zugtyp2
            Prog_Lok72.Interval = 200
            Prog_Lok72.Start()
        ElseIf NumericUpDown9.Value = 73 Then
            _Prog73 = Ort
            _GlsL73 = 2
            _TypL73 = _Zugtyp2
            Prog_Lok73.Interval = 200
            Prog_Lok73.Start()
        ElseIf NumericUpDown9.Value = 74 Then
            _Prog74 = Ort
            _GlsL74 = 2
            _TypL74 = _Zugtyp2
            Prog_Lok74.Interval = 200
            Prog_Lok74.Start()
        ElseIf NumericUpDown9.Value = 75 Then
            _Prog75 = Ort
            _GlsL75 = 2
            _TypL75 = _Zugtyp2
            Prog_Lok75.Interval = 200
            Prog_Lok75.Start()
        ElseIf NumericUpDown9.Value = 76 Then
            _Prog76 = Ort
            _GlsL76 = 2
            _TypL76 = _Zugtyp2
            Prog_Lok76.Interval = 200
            Prog_Lok76.Start()
        ElseIf NumericUpDown9.Value = 77 Then
            _Prog77 = Ort
            _GlsL77 = 2
            _TypL77 = _Zugtyp2
            Prog_Lok77.Interval = 200
            Prog_Lok77.Start()
        ElseIf NumericUpDown9.Value = 78 Then
            _Prog78 = Ort
            _GlsL78 = 2
            _TypL78 = _Zugtyp2
            Prog_Lok78.Interval = 200
            Prog_Lok78.Start()
        ElseIf NumericUpDown9.Value = 79 Then
            _Prog79 = Ort
            _GlsL79 = 2
            _TypL79 = _Zugtyp2
            Prog_Lok79.Interval = 200
            Prog_Lok79.Start()
        ElseIf NumericUpDown9.Value = 80 Then
            _Prog80 = Ort
            _GlsL80 = 2
            _TypL80 = _Zugtyp2
            Prog_Lok80.Interval = 200
            Prog_Lok80.Start()
        Else
            _LokStufen.EinzelLokSenden(2, 2)
        End If
    End Sub
    Private Sub Zug3(Ort As Integer)
        ' ***
        ' *** Datum: 30.01.2021
        ' ***
        If NumericUpDown10.Value = 1 Then
        ElseIf NumericUpDown10.Value = 10 Then
            _Prog10 = Ort
            _GlsL10 = 3
            _TypL10 = _Zugtyp3
            Prog_Lok10.Interval = 200
            Prog_Lok10.Start()
        ElseIf NumericUpDown10.Value = 11 Then
            _Prog11 = Ort
            _GlsL11 = 3
            _TypL11 = _Zugtyp3
            Prog_Lok11.Interval = 200
            Prog_Lok11.Start()
        ElseIf NumericUpDown10.Value = 12 Then
            _Prog12 = Ort
            _GlsL12 = 3
            _TypL12 = _Zugtyp3
            Prog_Lok12.Interval = 200
            Prog_Lok12.Start()
        ElseIf NumericUpDown10.Value = 13 Then
            _Prog13 = Ort
            _GlsL13 = 3
            _TypL13 = _Zugtyp3
            Prog_Lok13.Interval = 200
            Prog_Lok13.Start()
        ElseIf NumericUpDown10.Value = 14 Then
            _Prog14 = Ort
            _GlsL14 = 3
            _TypL14 = _Zugtyp3
            Prog_Lok14.Interval = 200
            Prog_Lok14.Start()
        ElseIf NumericUpDown10.Value = 15 Then
            _Prog15 = Ort
            _GlsL15 = 3
            _TypL15 = _Zugtyp3
            Prog_Lok15.Interval = 200
            Prog_Lok15.Start()
        ElseIf NumericUpDown10.Value = 16 Then
            _Prog16 = Ort
            _GlsL16 = 3
            _TypL16 = _Zugtyp3
            Prog_Lok16.Interval = 200
            Prog_Lok16.Start()
        ElseIf NumericUpDown10.Value = 17 Then
            _Prog17 = Ort
            _GlsL17 = 3
            _TypL17 = _Zugtyp3
            Prog_Lok17.Interval = 200
            Prog_Lok17.Start()
        ElseIf NumericUpDown10.Value = 18 Then
            _Prog18 = Ort
            _GlsL18 = 3
            _TypL18 = _Zugtyp3
            Prog_Lok18.Interval = 200
            Prog_Lok18.Start()
        ElseIf NumericUpDown10.Value = 19 Then
            _Prog19 = Ort
            _GlsL19 = 3
            _TypL19 = _Zugtyp3
            Prog_Lok19.Interval = 200
            Prog_Lok19.Start()
        ElseIf NumericUpDown10.Value = 20 Then
            _Prog20 = Ort
            _GlsL20 = 3
            _TypL20 = _Zugtyp3
            Prog_Lok20.Interval = 200
            Prog_Lok20.Start()
        ElseIf NumericUpDown10.Value = 21 Then
            _Prog21 = Ort
            _GlsL21 = 3
            _TypL21 = _Zugtyp3
            Prog_Lok21.Interval = 200
            Prog_Lok21.Start()
        ElseIf NumericUpDown10.Value = 22 Then
            _Prog22 = Ort
            _GlsL22 = 3
            _TypL22 = _Zugtyp3
            Prog_Lok22.Interval = 200
            Prog_Lok22.Start()
        ElseIf NumericUpDown10.Value = 23 Then
            _Prog23 = Ort
            _GlsL23 = 3
            _TypL23 = _Zugtyp3
            Prog_Lok23.Interval = 200
            Prog_Lok23.Start()
        ElseIf NumericUpDown10.Value = 24 Then
            _Prog24 = Ort
            _GlsL24 = 3
            _TypL24 = _Zugtyp3
            Prog_Lok24.Interval = 200
            Prog_Lok24.Start()
        ElseIf NumericUpDown10.Value = 25 Then
            _Prog25 = Ort
            _GlsL25 = 3
            _TypL25 = _Zugtyp3
            Prog_Lok25.Interval = 200
            Prog_Lok25.Start()
        ElseIf NumericUpDown10.Value = 26 Then
            _Prog26 = Ort
            _GlsL26 = 3
            _TypL26 = _Zugtyp3
            Prog_Lok26.Interval = 200
            Prog_Lok26.Start()
        ElseIf NumericUpDown10.Value = 27 Then
            _Prog27 = Ort
            _GlsL27 = 3
            _TypL27 = _Zugtyp3
            Prog_Lok27.Interval = 200
            Prog_Lok27.Start()
        ElseIf NumericUpDown10.Value = 28 Then
            _Prog28 = Ort
            _GlsL28 = 3
            _TypL28 = _Zugtyp3
            Prog_Lok28.Interval = 200
            Prog_Lok28.Start()
        ElseIf NumericUpDown10.Value = 29 Then
            _Prog29 = Ort
            _GlsL29 = 3
            _TypL29 = _Zugtyp3
            Prog_Lok29.Interval = 200
            Prog_Lok29.Start()
        ElseIf NumericUpDown10.Value = 30 Then
            _Prog30 = Ort
            _GlsL30 = 3
            _TypL30 = _Zugtyp3
            Prog_Lok30.Interval = 200
            Prog_Lok30.Start()
        ElseIf NumericUpDown10.Value = 31 Then
            _Prog31 = Ort
            _GlsL31 = 3
            _TypL31 = _Zugtyp3
            Prog_Lok31.Interval = 200
            Prog_Lok31.Start()
        ElseIf NumericUpDown10.Value = 32 Then
            _Prog32 = Ort
            _GlsL32 = 3
            _TypL32 = _Zugtyp3
            Prog_Lok32.Interval = 200
            Prog_Lok32.Start()
        ElseIf NumericUpDown10.Value = 33 Then
            _Prog33 = Ort
            _GlsL33 = 3
            _TypL33 = _Zugtyp3
            Prog_Lok33.Interval = 200
            Prog_Lok33.Start()
        ElseIf NumericUpDown10.Value = 34 Then
            _Prog34 = Ort
            _GlsL34 = 3
            _TypL34 = _Zugtyp3
            Prog_Lok34.Interval = 200
            Prog_Lok34.Start()
        ElseIf NumericUpDown10.Value = 35 Then
            _Prog35 = Ort
            _GlsL35 = 3
            _TypL35 = _Zugtyp3
            Prog_Lok35.Interval = 200
            Prog_Lok35.Start()
        ElseIf NumericUpDown10.Value = 36 Then
            _Prog36 = Ort
            _GlsL36 = 3
            _TypL36 = _Zugtyp3
            Prog_Lok36.Interval = 200
            Prog_Lok36.Start()
        ElseIf NumericUpDown10.Value = 37 Then
            _Prog37 = Ort
            _GlsL37 = 3
            _TypL37 = _Zugtyp3
            Prog_Lok37.Interval = 200
            Prog_Lok37.Start()
        ElseIf NumericUpDown10.Value = 38 Then
            _Prog38 = Ort
            _GlsL38 = 3
            _TypL38 = _Zugtyp3
            Prog_Lok38.Interval = 200
            Prog_Lok38.Start()
        ElseIf NumericUpDown10.Value = 39 Then
            _Prog39 = Ort
            _GlsL39 = 3
            _TypL39 = _Zugtyp3
            Prog_Lok39.Interval = 200
            Prog_Lok39.Start()
        ElseIf NumericUpDown10.Value = 40 Then
            _Prog40 = Ort
            _GlsL40 = 3
            _TypL40 = _Zugtyp3
            Prog_Lok40.Interval = 200
            Prog_Lok40.Start()
        ElseIf NumericUpDown10.Value = 41 Then
            _Prog41 = Ort
            _GlsL41 = 3
            _TypL41 = _Zugtyp3
            Prog_Lok41.Interval = 200
            Prog_Lok41.Start()
        ElseIf NumericUpDown10.Value = 42 Then
            _Prog42 = Ort
            _GlsL42 = 3
            _TypL42 = _Zugtyp3
            Prog_Lok42.Interval = 200
            Prog_Lok42.Start()
        ElseIf NumericUpDown10.Value = 43 Then
            _Prog43 = Ort
            _GlsL43 = 3
            _TypL43 = _Zugtyp3
            Prog_Lok43.Interval = 200
            Prog_Lok43.Start()
        ElseIf NumericUpDown10.Value = 44 Then
            _Prog44 = Ort
            _GlsL44 = 3
            _TypL44 = _Zugtyp3
            Prog_Lok44.Interval = 200
            Prog_Lok44.Start()
        ElseIf NumericUpDown10.Value = 45 Then
            _Prog45 = Ort
            _GlsL45 = 3
            _TypL45 = _Zugtyp3
            Prog_Lok45.Interval = 200
            Prog_Lok45.Start()
        ElseIf NumericUpDown10.Value = 46 Then
            _Prog46 = Ort
            _GlsL46 = 3
            _TypL46 = _Zugtyp3
            Prog_Lok46.Interval = 200
            Prog_Lok46.Start()
        ElseIf NumericUpDown10.Value = 47 Then
            _Prog47 = Ort
            _GlsL47 = 3
            _TypL47 = _Zugtyp3
            Prog_Lok47.Interval = 200
            Prog_Lok47.Start()
        ElseIf NumericUpDown10.Value = 48 Then
            _Prog48 = Ort
            _GlsL48 = 3
            _TypL48 = _Zugtyp3
            Prog_Lok48.Interval = 200
            Prog_Lok48.Start()
        ElseIf NumericUpDown10.Value = 49 Then
            _Prog49 = Ort
            _GlsL49 = 3
            _TypL49 = _Zugtyp3
            Prog_Lok49.Interval = 200
            Prog_Lok49.Start()
        ElseIf NumericUpDown10.Value = 50 Then
            _Prog50 = Ort
            _GlsL50 = 3
            _TypL50 = _Zugtyp3
            Prog_Lok50.Interval = 200
            Prog_Lok50.Start()
        ElseIf NumericUpDown10.Value = 51 Then
            _Prog51 = Ort
            _GlsL51 = 3
            _TypL51 = _Zugtyp3
            Prog_Lok51.Interval = 200
            Prog_Lok51.Start()
        ElseIf NumericUpDown10.Value = 52 Then
            _Prog52 = Ort
            _GlsL52 = 3
            _TypL52 = _Zugtyp3
            Prog_Lok52.Interval = 200
            Prog_Lok52.Start()
        ElseIf NumericUpDown10.Value = 53 Then
            _Prog53 = Ort
            _GlsL53 = 3
            _TypL53 = _Zugtyp3
            Prog_Lok53.Interval = 200
            Prog_Lok53.Start()
        ElseIf NumericUpDown10.Value = 54 Then
            _Prog54 = Ort
            _GlsL54 = 3
            _TypL54 = _Zugtyp3
            Prog_Lok54.Interval = 200
            Prog_Lok54.Start()
        ElseIf NumericUpDown10.Value = 55 Then
            _Prog55 = Ort
            _GlsL55 = 3
            _TypL55 = _Zugtyp3
            Prog_Lok55.Interval = 200
            Prog_Lok55.Start()
        ElseIf NumericUpDown10.Value = 56 Then
            _Prog56 = Ort
            _GlsL56 = 3
            _TypL56 = _Zugtyp3
            Prog_Lok56.Interval = 200
            Prog_Lok56.Start()
        ElseIf NumericUpDown10.Value = 57 Then
            _Prog57 = Ort
            _GlsL57 = 3
            _TypL57 = _Zugtyp3
            Prog_Lok57.Interval = 200
            Prog_Lok57.Start()
        ElseIf NumericUpDown10.Value = 58 Then
            _Prog58 = Ort
            _GlsL58 = 3
            _TypL58 = _Zugtyp3
            Prog_Lok58.Interval = 200
            Prog_Lok58.Start()
        ElseIf NumericUpDown10.Value = 59 Then
            _Prog59 = Ort
            _GlsL59 = 3
            _TypL59 = _Zugtyp3
            Prog_Lok59.Interval = 200
            Prog_Lok59.Start()
        ElseIf NumericUpDown10.Value = 60 Then
            _Prog60 = Ort
            _GlsL60 = 3
            _TypL60 = _Zugtyp3
            Prog_Lok60.Interval = 200
            Prog_Lok60.Start()
        ElseIf NumericUpDown10.Value = 61 Then
            _Prog61 = Ort
            _GlsL61 = 3
            _TypL61 = _Zugtyp3
            Prog_Lok61.Interval = 200
            Prog_Lok61.Start()
        ElseIf NumericUpDown10.Value = 62 Then
            _Prog62 = Ort
            _GlsL62 = 3
            _TypL62 = _Zugtyp3
            Prog_Lok62.Interval = 200
            Prog_Lok62.Start()
        ElseIf NumericUpDown10.Value = 63 Then
            _Prog63 = Ort
            _GlsL63 = 3
            _TypL63 = _Zugtyp3
            Prog_Lok63.Interval = 200
            Prog_Lok63.Start()
        ElseIf NumericUpDown10.Value = 64 Then
            _Prog64 = Ort
            _GlsL64 = 3
            _TypL64 = _Zugtyp3
            Prog_Lok64.Interval = 200
            Prog_Lok64.Start()
        ElseIf NumericUpDown10.Value = 65 Then
            _Prog65 = Ort
            _GlsL65 = 3
            _TypL65 = _Zugtyp3
            Prog_Lok65.Interval = 200
            Prog_Lok65.Start()
        ElseIf NumericUpDown10.Value = 66 Then
            _Prog66 = Ort
            _GlsL66 = 3
            _TypL66 = _Zugtyp3
            Prog_Lok66.Interval = 200
            Prog_Lok66.Start()
        ElseIf NumericUpDown10.Value = 67 Then
            _Prog67 = Ort
            _GlsL67 = 3
            _TypL67 = _Zugtyp3
            Prog_Lok67.Interval = 200
            Prog_Lok67.Start()
        ElseIf NumericUpDown10.Value = 68 Then
            _Prog68 = Ort
            _GlsL68 = 3
            _TypL68 = _Zugtyp3
            Prog_Lok68.Interval = 200
            Prog_Lok68.Start()
        ElseIf NumericUpDown10.Value = 69 Then
            _Prog69 = Ort
            _GlsL69 = 3
            _TypL69 = _Zugtyp3
            Prog_Lok69.Interval = 200
            Prog_Lok69.Start()
        ElseIf NumericUpDown10.Value = 70 Then
            _Prog70 = Ort
            _GlsL70 = 3
            _TypL70 = _Zugtyp3
            Prog_Lok70.Interval = 200
            Prog_Lok70.Start()
        ElseIf NumericUpDown10.Value = 71 Then
            _Prog71 = Ort
            _GlsL71 = 3
            _TypL71 = _Zugtyp3
            Prog_Lok71.Interval = 200
            Prog_Lok71.Start()
        ElseIf NumericUpDown10.Value = 72 Then
            _Prog72 = Ort
            _GlsL72 = 3
            _TypL72 = _Zugtyp3
            Prog_Lok72.Interval = 200
            Prog_Lok72.Start()
        ElseIf NumericUpDown10.Value = 73 Then
            _Prog73 = Ort
            _GlsL73 = 3
            _TypL73 = _Zugtyp3
            Prog_Lok73.Interval = 200
            Prog_Lok73.Start()
        ElseIf NumericUpDown10.Value = 74 Then
            _Prog74 = Ort
            _GlsL74 = 3
            _TypL74 = _Zugtyp3
            Prog_Lok74.Interval = 200
            Prog_Lok74.Start()
        ElseIf NumericUpDown10.Value = 75 Then
            _Prog75 = Ort
            _GlsL75 = 3
            _TypL75 = _Zugtyp3
            Prog_Lok75.Interval = 200
            Prog_Lok75.Start()
        ElseIf NumericUpDown10.Value = 76 Then
            _Prog76 = Ort
            _GlsL76 = 3
            _TypL76 = _Zugtyp3
            Prog_Lok76.Interval = 200
            Prog_Lok76.Start()
        ElseIf NumericUpDown10.Value = 77 Then
            _Prog77 = Ort
            _GlsL77 = 3
            _TypL77 = _Zugtyp3
            Prog_Lok77.Interval = 200
            Prog_Lok77.Start()
        ElseIf NumericUpDown10.Value = 78 Then
            _Prog78 = Ort
            _GlsL78 = 3
            _TypL78 = _Zugtyp3
            Prog_Lok78.Interval = 200
            Prog_Lok78.Start()
        ElseIf NumericUpDown10.Value = 79 Then
            _Prog79 = Ort
            _GlsL79 = 3
            _TypL79 = _Zugtyp3
            Prog_Lok79.Interval = 200
            Prog_Lok79.Start()
        ElseIf NumericUpDown10.Value = 80 Then
            _Prog80 = Ort
            _GlsL80 = 3
            _TypL80 = _Zugtyp3
            Prog_Lok80.Interval = 200
            Prog_Lok80.Start()

        Else
            _LokStufen.EinzelLokSenden(3, 2)
        End If
    End Sub
    Private Sub Zug4(Ort As Integer)
        ' ***
        ' *** Datum: 30.01.2021
        ' ***
        If NumericUpDown11.Value = 1 Then
        ElseIf NumericUpDown11.Value = 10 Then
            _Prog10 = Ort
            _GlsL10 = 4
            _TypL10 = _Zugtyp4
            Prog_Lok10.Interval = 200
            Prog_Lok10.Start()
        ElseIf NumericUpDown11.Value = 11 Then
            _Prog11 = Ort
            _GlsL11 = 4
            _TypL11 = _Zugtyp4
            Prog_Lok11.Interval = 200
            Prog_Lok11.Start()
        ElseIf NumericUpDown11.Value = 12 Then
            _Prog12 = Ort
            _GlsL12 = 4
            _TypL12 = _Zugtyp4
            Prog_Lok12.Interval = 200
            Prog_Lok12.Start()
        ElseIf NumericUpDown11.Value = 13 Then
            _Prog13 = Ort
            _GlsL13 = 4
            _TypL13 = _Zugtyp4
            Prog_Lok13.Interval = 200
            Prog_Lok13.Start()
        ElseIf NumericUpDown11.Value = 14 Then
            _Prog14 = Ort
            _GlsL14 = 4
            _TypL14 = _Zugtyp4
            Prog_Lok14.Interval = 200
            Prog_Lok14.Start()
        ElseIf NumericUpDown11.Value = 15 Then
            _Prog15 = Ort
            _GlsL15 = 4
            _TypL15 = _Zugtyp4
            Prog_Lok15.Interval = 200
            Prog_Lok15.Start()
        ElseIf NumericUpDown11.Value = 16 Then
            _Prog16 = Ort
            _GlsL16 = 4
            _TypL16 = _Zugtyp4
            Prog_Lok16.Interval = 200
            Prog_Lok16.Start()
        ElseIf NumericUpDown11.Value = 17 Then
            _Prog17 = Ort
            _GlsL17 = 4
            _TypL17 = _Zugtyp4
            Prog_Lok17.Interval = 200
            Prog_Lok17.Start()
        ElseIf NumericUpDown11.Value = 18 Then
            _Prog18 = Ort
            _GlsL18 = 4
            _TypL18 = _Zugtyp4
            Prog_Lok18.Interval = 200
            Prog_Lok18.Start()
        ElseIf NumericUpDown11.Value = 19 Then
            _Prog19 = Ort
            _GlsL19 = 4
            _TypL19 = _Zugtyp4
            Prog_Lok19.Interval = 200
            Prog_Lok19.Start()
        ElseIf NumericUpDown11.Value = 20 Then
            _Prog20 = Ort
            _GlsL20 = 4
            _TypL20 = _Zugtyp4
            Prog_Lok20.Interval = 200
            Prog_Lok20.Start()
        ElseIf NumericUpDown11.Value = 21 Then
            _Prog21 = Ort
            _GlsL21 = 4
            _TypL21 = _Zugtyp4
            Prog_Lok21.Interval = 200
            Prog_Lok21.Start()
        ElseIf NumericUpDown11.Value = 22 Then
            _Prog22 = Ort
            _GlsL22 = 4
            _TypL22 = _Zugtyp4
            Prog_Lok22.Interval = 200
            Prog_Lok22.Start()
        ElseIf NumericUpDown11.Value = 23 Then
            _Prog23 = Ort
            _GlsL23 = 4
            _TypL23 = _Zugtyp4
            Prog_Lok23.Interval = 200
            Prog_Lok23.Start()
        ElseIf NumericUpDown11.Value = 24 Then
            _Prog24 = Ort
            _GlsL24 = 4
            _TypL24 = _Zugtyp4
            Prog_Lok24.Interval = 200
            Prog_Lok24.Start()
        ElseIf NumericUpDown11.Value = 25 Then
            _Prog25 = Ort
            _GlsL25 = 4
            _TypL25 = _Zugtyp4
            Prog_Lok25.Interval = 200
            Prog_Lok25.Start()
        ElseIf NumericUpDown11.Value = 26 Then
            _Prog26 = Ort
            _GlsL26 = 4
            _TypL26 = _Zugtyp4
            Prog_Lok26.Interval = 200
            Prog_Lok26.Start()
        ElseIf NumericUpDown11.Value = 27 Then
            _Prog27 = Ort
            _GlsL27 = 4
            _TypL27 = _Zugtyp4
            Prog_Lok27.Interval = 200
            Prog_Lok27.Start()
        ElseIf NumericUpDown11.Value = 28 Then
            _Prog28 = Ort
            _GlsL28 = 4
            _TypL28 = _Zugtyp4
            Prog_Lok28.Interval = 200
            Prog_Lok28.Start()
        ElseIf NumericUpDown11.Value = 29 Then
            _Prog29 = Ort
            _GlsL29 = 4
            _TypL29 = _Zugtyp4
            Prog_Lok29.Interval = 200
            Prog_Lok29.Start()
        ElseIf NumericUpDown11.Value = 30 Then
            _Prog30 = Ort
            _GlsL30 = 4
            _TypL30 = _Zugtyp4
            Prog_Lok30.Interval = 200
            Prog_Lok30.Start()
        ElseIf NumericUpDown11.Value = 31 Then
            _Prog31 = Ort
            _GlsL31 = 4
            _TypL31 = _Zugtyp4
            Prog_Lok31.Interval = 200
            Prog_Lok31.Start()
        ElseIf NumericUpDown11.Value = 32 Then
            _Prog32 = Ort
            _GlsL32 = 4
            _TypL32 = _Zugtyp4
            Prog_Lok32.Interval = 200
            Prog_Lok32.Start()
        ElseIf NumericUpDown11.Value = 33 Then
            _Prog33 = Ort
            _GlsL33 = 4
            _TypL33 = _Zugtyp4
            Prog_Lok33.Interval = 200
            Prog_Lok33.Start()
        ElseIf NumericUpDown11.Value = 34 Then
            _Prog34 = Ort
            _GlsL34 = 4
            _TypL34 = _Zugtyp4
            Prog_Lok34.Interval = 200
            Prog_Lok34.Start()
        ElseIf NumericUpDown11.Value = 35 Then
            _Prog35 = Ort
            _GlsL35 = 4
            _TypL35 = _Zugtyp4
            Prog_Lok35.Interval = 200
            Prog_Lok35.Start()
        ElseIf NumericUpDown11.Value = 36 Then
            _Prog36 = Ort
            _GlsL36 = 4
            _TypL36 = _Zugtyp4
            Prog_Lok36.Interval = 200
            Prog_Lok36.Start()
        ElseIf NumericUpDown11.Value = 37 Then
            _Prog37 = Ort
            _GlsL37 = 4
            _TypL37 = _Zugtyp4
            Prog_Lok37.Interval = 200
            Prog_Lok37.Start()
        ElseIf NumericUpDown11.Value = 38 Then
            _Prog38 = Ort
            _GlsL38 = 4
            _TypL38 = _Zugtyp4
            Prog_Lok38.Interval = 200
            Prog_Lok38.Start()
        ElseIf NumericUpDown11.Value = 39 Then
            _Prog39 = Ort
            _GlsL39 = 4
            _TypL39 = _Zugtyp4
            Prog_Lok39.Interval = 200
            Prog_Lok39.Start()
        ElseIf NumericUpDown11.Value = 40 Then
            _Prog40 = Ort
            _GlsL40 = 4
            _TypL40 = _Zugtyp4
            Prog_Lok40.Interval = 200
            Prog_Lok40.Start()
        ElseIf NumericUpDown11.Value = 41 Then
            _Prog41 = Ort
            _GlsL41 = 4
            _TypL41 = _Zugtyp4
            Prog_Lok41.Interval = 200
            Prog_Lok41.Start()
        ElseIf NumericUpDown11.Value = 42 Then
            _Prog42 = Ort
            _GlsL42 = 4
            _TypL42 = _Zugtyp4
            Prog_Lok42.Interval = 200
            Prog_Lok42.Start()
        ElseIf NumericUpDown11.Value = 43 Then
            _Prog43 = Ort
            _GlsL43 = 4
            _TypL43 = _Zugtyp4
            Prog_Lok43.Interval = 200
            Prog_Lok43.Start()
        ElseIf NumericUpDown11.Value = 44 Then
            _Prog44 = Ort
            _GlsL44 = 4
            _TypL44 = _Zugtyp4
            Prog_Lok44.Interval = 200
            Prog_Lok44.Start()
        ElseIf NumericUpDown11.Value = 45 Then
            _Prog45 = Ort
            _GlsL45 = 4
            _TypL45 = _Zugtyp4
            Prog_Lok45.Interval = 200
            Prog_Lok45.Start()
        ElseIf NumericUpDown11.Value = 46 Then
            _Prog46 = Ort
            _GlsL46 = 4
            _TypL46 = _Zugtyp4
            Prog_Lok46.Interval = 200
            Prog_Lok46.Start()
        ElseIf NumericUpDown11.Value = 47 Then
            _Prog47 = Ort
            _GlsL47 = 4
            _TypL47 = _Zugtyp4
            Prog_Lok47.Interval = 200
            Prog_Lok47.Start()
        ElseIf NumericUpDown11.Value = 48 Then
            _Prog48 = Ort
            _GlsL48 = 4
            _TypL48 = _Zugtyp4
            Prog_Lok48.Interval = 200
            Prog_Lok48.Start()
        ElseIf NumericUpDown11.Value = 49 Then
            _Prog49 = Ort
            _GlsL49 = 4
            _TypL49 = _Zugtyp4
            Prog_Lok49.Interval = 200
            Prog_Lok49.Start()
        ElseIf NumericUpDown11.Value = 50 Then
            _Prog50 = Ort
            _GlsL50 = 4
            _TypL50 = _Zugtyp4
            Prog_Lok50.Interval = 200
            Prog_Lok50.Start()
        ElseIf NumericUpDown11.Value = 51 Then
            _Prog51 = Ort
            _GlsL51 = 4
            _TypL51 = _Zugtyp4
            Prog_Lok51.Interval = 200
            Prog_Lok51.Start()
        ElseIf NumericUpDown11.Value = 52 Then
            _Prog52 = Ort
            _GlsL52 = 4
            _TypL52 = _Zugtyp4
            Prog_Lok52.Interval = 200
            Prog_Lok52.Start()
        ElseIf NumericUpDown11.Value = 53 Then
            _Prog53 = Ort
            _GlsL53 = 4
            _TypL53 = _Zugtyp4
            Prog_Lok53.Interval = 200
            Prog_Lok53.Start()
        ElseIf NumericUpDown11.Value = 54 Then
            _Prog54 = Ort
            _GlsL54 = 4
            _TypL54 = _Zugtyp4
            Prog_Lok54.Interval = 200
            Prog_Lok54.Start()
        ElseIf NumericUpDown11.Value = 55 Then
            _Prog55 = Ort
            _GlsL55 = 4
            _TypL55 = _Zugtyp4
            Prog_Lok55.Interval = 200
            Prog_Lok55.Start()
        ElseIf NumericUpDown11.Value = 56 Then
            _Prog56 = Ort
            _GlsL56 = 4
            _TypL56 = _Zugtyp4
            Prog_Lok56.Interval = 200
            Prog_Lok56.Start()
        ElseIf NumericUpDown11.Value = 57 Then
            _Prog57 = Ort
            _GlsL57 = 4
            _TypL57 = _Zugtyp4
            Prog_Lok57.Interval = 200
            Prog_Lok57.Start()
        ElseIf NumericUpDown11.Value = 58 Then
            _Prog58 = Ort
            _GlsL58 = 4
            _TypL58 = _Zugtyp4
            Prog_Lok58.Interval = 200
            Prog_Lok58.Start()
        ElseIf NumericUpDown11.Value = 59 Then
            _Prog59 = Ort
            _GlsL59 = 4
            _TypL59 = _Zugtyp4
            Prog_Lok59.Interval = 200
            Prog_Lok59.Start()
        ElseIf NumericUpDown11.Value = 60 Then
            _Prog60 = Ort
            _GlsL60 = 4
            _TypL60 = _Zugtyp4
            Prog_Lok60.Interval = 200
            Prog_Lok60.Start()
        ElseIf NumericUpDown11.Value = 61 Then
            _Prog61 = Ort
            _GlsL61 = 4
            _TypL61 = _Zugtyp4
            Prog_Lok61.Interval = 200
            Prog_Lok61.Start()
        ElseIf NumericUpDown11.Value = 62 Then
            _Prog62 = Ort
            _GlsL62 = 4
            _TypL62 = _Zugtyp4
            Prog_Lok62.Interval = 200
            Prog_Lok62.Start()
        ElseIf NumericUpDown11.Value = 63 Then
            _Prog63 = Ort
            _GlsL63 = 4
            _TypL63 = _Zugtyp4
            Prog_Lok63.Interval = 200
            Prog_Lok63.Start()
        ElseIf NumericUpDown11.Value = 64 Then
            _Prog64 = Ort
            _GlsL64 = 4
            _TypL64 = _Zugtyp4
            Prog_Lok64.Interval = 200
            Prog_Lok64.Start()
        ElseIf NumericUpDown11.Value = 65 Then
            _Prog65 = Ort
            _GlsL65 = 4
            _TypL65 = _Zugtyp4
            Prog_Lok65.Interval = 200
            Prog_Lok65.Start()
        ElseIf NumericUpDown11.Value = 66 Then
            _Prog66 = Ort
            _GlsL66 = 4
            _TypL66 = _Zugtyp4
            Prog_Lok66.Interval = 200
            Prog_Lok66.Start()
        ElseIf NumericUpDown11.Value = 67 Then
            _Prog67 = Ort
            _GlsL67 = 4
            _TypL67 = _Zugtyp4
            Prog_Lok67.Interval = 200
            Prog_Lok67.Start()
        ElseIf NumericUpDown11.Value = 68 Then
            _Prog68 = Ort
            _GlsL68 = 4
            _TypL68 = _Zugtyp4
            Prog_Lok68.Interval = 200
            Prog_Lok68.Start()
        ElseIf NumericUpDown11.Value = 69 Then
            _Prog69 = Ort
            _GlsL69 = 4
            _TypL69 = _Zugtyp4
            Prog_Lok69.Interval = 200
            Prog_Lok69.Start()
        ElseIf NumericUpDown11.Value = 70 Then
            _Prog70 = Ort
            _GlsL70 = 4
            _TypL70 = _Zugtyp4
            Prog_Lok70.Interval = 200
            Prog_Lok70.Start()
        ElseIf NumericUpDown11.Value = 71 Then
            _Prog71 = Ort
            _GlsL71 = 4
            _TypL71 = _Zugtyp4
            Prog_Lok71.Interval = 200
            Prog_Lok71.Start()
        ElseIf NumericUpDown11.Value = 72 Then
            _Prog72 = Ort
            _GlsL72 = 4
            _TypL72 = _Zugtyp4
            Prog_Lok72.Interval = 200
            Prog_Lok72.Start()
        ElseIf NumericUpDown11.Value = 73 Then
            _Prog73 = Ort
            _GlsL73 = 4
            _TypL73 = _Zugtyp4
            Prog_Lok73.Interval = 200
            Prog_Lok73.Start()
        ElseIf NumericUpDown11.Value = 74 Then
            _Prog74 = Ort
            _GlsL74 = 4
            _TypL74 = _Zugtyp4
            Prog_Lok74.Interval = 200
            Prog_Lok74.Start()
        ElseIf NumericUpDown11.Value = 75 Then
            _Prog75 = Ort
            _GlsL75 = 4
            _TypL75 = _Zugtyp4
            Prog_Lok75.Interval = 200
            Prog_Lok75.Start()
        ElseIf NumericUpDown11.Value = 76 Then
            _Prog76 = Ort
            _GlsL76 = 4
            _TypL76 = _Zugtyp4
            Prog_Lok76.Interval = 200
            Prog_Lok76.Start()
        ElseIf NumericUpDown11.Value = 77 Then
            _Prog77 = Ort
            _GlsL77 = 4
            _TypL77 = _Zugtyp4
            Prog_Lok77.Interval = 200
            Prog_Lok77.Start()
        ElseIf NumericUpDown11.Value = 78 Then
            _Prog78 = Ort
            _GlsL78 = 4
            _TypL78 = _Zugtyp4
            Prog_Lok78.Interval = 200
            Prog_Lok78.Start()
        ElseIf NumericUpDown11.Value = 79 Then
            _Prog79 = Ort
            _GlsL79 = 4
            _TypL79 = _Zugtyp4
            Prog_Lok79.Interval = 200
            Prog_Lok79.Start()
        ElseIf NumericUpDown11.Value = 80 Then
            _Prog80 = Ort
            _GlsL80 = 4
            _TypL80 = _Zugtyp4
            Prog_Lok80.Interval = 200
            Prog_Lok80.Start()
        Else
            _LokStufen.EinzelLokSenden(4, 2)
        End If
    End Sub

    Private Function WeichenStellen(Weiche As Integer, Zeile As Integer) As Boolean
        Dim Ergebnis, Fehler As Boolean
        Dim Spalte As Integer
        Fehler = False
        Ergebnis = False
        Spalte = 8 + 2 * (Weiche - 13)
        If Betriebsparameter.GetValue("Weichenparameter", Spalte, Zeile) = "j" Then
            Ergebnis = True
        ElseIf Betriebsparameter.GetValue("Weichenparameter", Spalte, Zeile) = "n" Then
        ElseIf Betriebsparameter.GetValue("Weichenparameter", Spalte, Zeile) = "x" Then
        ElseIf Betriebsparameter.GetValue("Weichenparameter", Spalte, Zeile) = "s" Then
        Else
            Fehler = True
        End If

        If Betriebsparameter.GetValue("Weichenparameter", Spalte + 1, Zeile) = "li" Then
            _eb.weicheSchalten(Weiche, Klassen.WeichenRichtung.links)
        ElseIf Betriebsparameter.GetValue("Weichenparameter", Spalte + 1, Zeile) = "re" Then
            _eb.weicheSchalten(Weiche, Klassen.WeichenRichtung.rechts)
        ElseIf Betriebsparameter.GetValue("Weichenparameter", Spalte + 1, Zeile) = "li/re" Then
        ElseIf Betriebsparameter.GetValue("Weichenparameter", Spalte + 1, Zeile) = "x" Then
        Else
            Fehler = True
        End If
        If Fehler = True Then
            AutoParaLabel.BackColor = Drawing.Color.Red
        End If

        If Ergebnis = True Then
            Return True
        Else
            Return False
        End If
    End Function

    Private Sub WeicheSchalten(ByVal nummer As Integer, ByVal richtung As Klassen.WeichenRichtung)
        If _eb.weiche(nummer).Richtung <> richtung Then
            _eb.weicheSchalten(nummer, richtung)
        End If
    End Sub

    Private Sub WeichenInStartPositionLok1()
        If Betriebsart12 = 1 And Betriebsart34 = 0 Then
            _eb.weicheSchalten(13, Klassen.WeichenRichtung.links)
        Else
            _eb.weicheSchalten(13, Klassen.WeichenRichtung.rechts)
        End If
        _eb.weicheSchalten(19, Klassen.WeichenRichtung.links)
        _eb.weicheSchalten(21, Klassen.WeichenRichtung.rechts)
        _eb.weicheSchalten(25, Klassen.WeichenRichtung.rechts)
        _eb.weicheSchalten(26, Klassen.WeichenRichtung.rechts)
        _eb.weicheSchalten(27, Klassen.WeichenRichtung.rechts)
        If _Route_Gleis1 = 0 Then
            _eb.weicheSchalten(14, Klassen.WeichenRichtung.links)
            _eb.weicheSchalten(17, Klassen.WeichenRichtung.links)
        ElseIf _Route_Gleis1 = 1 Then
            _eb.weicheSchalten(14, Klassen.WeichenRichtung.rechts)
            _eb.weicheSchalten(17, Klassen.WeichenRichtung.rechts)
        ElseIf _Route_Gleis1 = 2 Then
            _eb.weicheSchalten(14, Klassen.WeichenRichtung.links)
            _eb.weicheSchalten(17, Klassen.WeichenRichtung.links)
        End If
    End Sub
    Private Sub WeichenInStartPositionLok2()
        _eb.weicheSchalten(13, Klassen.WeichenRichtung.rechts)
        _eb.weicheSchalten(14, Klassen.WeichenRichtung.links)
        _eb.weicheSchalten(19, Klassen.WeichenRichtung.rechts)
        _eb.weicheSchalten(21, Klassen.WeichenRichtung.links)
        _eb.weicheSchalten(25, Klassen.WeichenRichtung.rechts)
        _eb.weicheSchalten(26, Klassen.WeichenRichtung.rechts)
        If _Route_Gleis2 = 0 Then
            _eb.weicheSchalten(17, Klassen.WeichenRichtung.links)
            _eb.weicheSchalten(23, Klassen.WeichenRichtung.links)
            _eb.weicheSchalten(27, Klassen.WeichenRichtung.links)
        ElseIf _Route_Gleis2 = 1 Then
            _eb.weicheSchalten(17, Klassen.WeichenRichtung.rechts)
            _eb.weicheSchalten(23, Klassen.WeichenRichtung.links)
            _eb.weicheSchalten(27, Klassen.WeichenRichtung.rechts)
        ElseIf _Route_Gleis2 = 2 Then
            _eb.weicheSchalten(17, Klassen.WeichenRichtung.links)
            _eb.weicheSchalten(23, Klassen.WeichenRichtung.links)
            _eb.weicheSchalten(27, Klassen.WeichenRichtung.rechts)
        End If
    End Sub
    Private Sub WeichenInStartPositionLok3()
        _eb.weicheSchalten(13, Klassen.WeichenRichtung.rechts)
        _eb.weicheSchalten(14, Klassen.WeichenRichtung.rechts)
        _eb.weicheSchalten(20, Klassen.WeichenRichtung.links)
        _eb.weicheSchalten(22, Klassen.WeichenRichtung.rechts)
        _eb.weicheSchalten(25, Klassen.WeichenRichtung.rechts)
        _eb.weicheSchalten(26, Klassen.WeichenRichtung.rechts)
        If _Route_Gleis3 = 0 Then
            _eb.weicheSchalten(17, Klassen.WeichenRichtung.links)
            _eb.weicheSchalten(23, Klassen.WeichenRichtung.links)
            _eb.weicheSchalten(27, Klassen.WeichenRichtung.links)
        ElseIf _Route_Gleis3 = 1 Then
            _eb.weicheSchalten(17, Klassen.WeichenRichtung.rechts)
            _eb.weicheSchalten(23, Klassen.WeichenRichtung.rechts)
            _eb.weicheSchalten(27, Klassen.WeichenRichtung.rechts)
        ElseIf _Route_Gleis3 = 2 Then
            _eb.weicheSchalten(17, Klassen.WeichenRichtung.rechts)
            _eb.weicheSchalten(23, Klassen.WeichenRichtung.rechts)
            _eb.weicheSchalten(27, Klassen.WeichenRichtung.rechts)
        End If
    End Sub
    Private Sub WeichenInStartPositionLok4()
        _eb.weicheSchalten(13, Klassen.WeichenRichtung.rechts)
        _eb.weicheSchalten(14, Klassen.WeichenRichtung.rechts)
        _eb.weicheSchalten(20, Klassen.WeichenRichtung.rechts)
        _eb.weicheSchalten(22, Klassen.WeichenRichtung.links)
        _eb.weicheSchalten(25, Klassen.WeichenRichtung.rechts)
        _eb.weicheSchalten(26, Klassen.WeichenRichtung.rechts)
        If _Route_Gleis4 = 0 Then
            _eb.weicheSchalten(17, Klassen.WeichenRichtung.links)
            _eb.weicheSchalten(23, Klassen.WeichenRichtung.links)
            _eb.weicheSchalten(27, Klassen.WeichenRichtung.links)
        ElseIf _Route_Gleis4 = 1 Then
            _eb.weicheSchalten(17, Klassen.WeichenRichtung.rechts)
            _eb.weicheSchalten(23, Klassen.WeichenRichtung.rechts)
            _eb.weicheSchalten(27, Klassen.WeichenRichtung.rechts)
        ElseIf _Route_Gleis4 = 2 Then
            _eb.weicheSchalten(17, Klassen.WeichenRichtung.rechts)
            _eb.weicheSchalten(23, Klassen.WeichenRichtung.rechts)
            _eb.weicheSchalten(27, Klassen.WeichenRichtung.rechts)
        End If
    End Sub

    Private Sub StopZug1()
        ' ***
        ' *** Datum: 11.01.2020
        ' ***
        _LokStufen.EinzelLokSenden(1, 0)
        If NumericUpDown8.Value = 10 Then
            Prog_Lok10.Stop()
        ElseIf NumericUpDown8.Value = 11 Then
            Prog_Lok11.Stop()
        ElseIf NumericUpDown8.Value = 12 Then
            Prog_Lok12.Stop()
        ElseIf NumericUpDown8.Value = 13 Then
            Prog_Lok13.Stop()
        ElseIf NumericUpDown8.Value = 14 Then
            Prog_Lok14.Stop()
        ElseIf NumericUpDown8.Value = 15 Then
            Prog_Lok15.Stop()
        ElseIf NumericUpDown8.Value = 16 Then
            Prog_Lok16.Stop()
        ElseIf NumericUpDown8.Value = 17 Then
            Prog_Lok17.Stop()
        ElseIf NumericUpDown8.Value = 18 Then
            Prog_Lok18.Stop()
        ElseIf NumericUpDown8.Value = 19 Then
            Prog_Lok19.Stop()
        ElseIf NumericUpDown8.Value = 20 Then
            Prog_Lok20.Stop()
        ElseIf NumericUpDown8.Value = 21 Then
            Prog_Lok21.Stop()
        ElseIf NumericUpDown8.Value = 22 Then
            Prog_Lok22.Stop()
        ElseIf NumericUpDown8.Value = 23 Then
            Prog_Lok23.Stop()
        ElseIf NumericUpDown8.Value = 24 Then
            Prog_Lok24.Stop()
        ElseIf NumericUpDown8.Value = 25 Then
            Prog_Lok25.Stop()
        ElseIf NumericUpDown8.Value = 26 Then
            Prog_Lok26.Stop()
        ElseIf NumericUpDown8.Value = 27 Then
            Prog_Lok27.Stop()
        ElseIf NumericUpDown8.Value = 28 Then
            Prog_Lok28.Stop()
        ElseIf NumericUpDown8.Value = 29 Then
            Prog_Lok29.Stop()
        ElseIf NumericUpDown8.Value = 30 Then
            Prog_Lok30.Stop()
        ElseIf NumericUpDown8.Value = 31 Then
            Prog_Lok31.Stop()
        ElseIf NumericUpDown8.Value = 32 Then
            Prog_Lok32.Stop()
        ElseIf NumericUpDown8.Value = 33 Then
            Prog_Lok33.Stop()
        ElseIf NumericUpDown8.Value = 34 Then
            Prog_Lok34.Stop()
        ElseIf NumericUpDown8.Value = 35 Then
            Prog_Lok35.Stop()
        ElseIf NumericUpDown8.Value = 36 Then
            Prog_Lok36.Stop()
        ElseIf NumericUpDown8.Value = 37 Then
            Prog_Lok37.Stop()
        ElseIf NumericUpDown8.Value = 38 Then
            Prog_Lok38.Stop()
        ElseIf NumericUpDown8.Value = 39 Then
            Prog_Lok39.Stop()
        ElseIf NumericUpDown8.Value = 40 Then
            Prog_Lok40.Stop()
        ElseIf NumericUpDown8.Value = 41 Then
            Prog_Lok41.Stop()
        ElseIf NumericUpDown8.Value = 42 Then
            Prog_Lok42.Stop()
        ElseIf NumericUpDown8.Value = 43 Then
            Prog_Lok43.Stop()
        ElseIf NumericUpDown8.Value = 44 Then
            Prog_Lok44.Stop()
        ElseIf NumericUpDown8.Value = 45 Then
            Prog_Lok45.Stop()
        ElseIf NumericUpDown8.Value = 46 Then
            Prog_Lok46.Stop()
        ElseIf NumericUpDown8.Value = 47 Then
            Prog_Lok47.Stop()
        ElseIf NumericUpDown8.Value = 48 Then
            Prog_Lok48.Stop()
        ElseIf NumericUpDown8.Value = 49 Then
            Prog_Lok49.Stop()
        ElseIf NumericUpDown8.Value = 50 Then
            Prog_Lok50.Stop()
        ElseIf NumericUpDown8.Value = 51 Then
            Prog_Lok51.Stop()
        ElseIf NumericUpDown8.Value = 52 Then
            Prog_Lok52.Stop()
        ElseIf NumericUpDown8.Value = 53 Then
            Prog_Lok53.Stop()
        ElseIf NumericUpDown8.Value = 54 Then
            Prog_Lok54.Stop()
        ElseIf NumericUpDown8.Value = 55 Then
            Prog_Lok55.Stop()
        ElseIf NumericUpDown8.Value = 56 Then
            Prog_Lok56.Stop()
        ElseIf NumericUpDown8.Value = 57 Then
            Prog_Lok57.Stop()
        ElseIf NumericUpDown8.Value = 58 Then
            Prog_Lok58.Stop()
        ElseIf NumericUpDown8.Value = 59 Then
            Prog_Lok59.Stop()
        ElseIf NumericUpDown8.Value = 60 Then
            Prog_Lok60.Stop()
        ElseIf NumericUpDown8.Value = 61 Then
            Prog_Lok61.Stop()
        ElseIf NumericUpDown8.Value = 62 Then
            Prog_Lok62.Stop()
        ElseIf NumericUpDown8.Value = 63 Then
            Prog_Lok63.Stop()
        ElseIf NumericUpDown8.Value = 64 Then
            Prog_Lok64.Stop()
        ElseIf NumericUpDown8.Value = 65 Then
            Prog_Lok65.Stop()
        ElseIf NumericUpDown8.Value = 66 Then
            Prog_Lok66.Stop()
        ElseIf NumericUpDown8.Value = 67 Then
            Prog_Lok67.Stop()
        ElseIf NumericUpDown8.Value = 68 Then
            Prog_Lok68.Stop()
        ElseIf NumericUpDown8.Value = 69 Then
            Prog_Lok69.Stop()
        ElseIf NumericUpDown8.Value = 70 Then
            Prog_Lok70.Stop()
        ElseIf NumericUpDown8.Value = 71 Then
            Prog_Lok71.Stop()
        ElseIf NumericUpDown8.Value = 72 Then
            Prog_Lok72.Stop()
        ElseIf NumericUpDown8.Value = 73 Then
            Prog_Lok73.Stop()
        ElseIf NumericUpDown8.Value = 74 Then
            Prog_Lok74.Stop()
        ElseIf NumericUpDown8.Value = 75 Then
            Prog_Lok75.Stop()
        ElseIf NumericUpDown8.Value = 76 Then
            Prog_Lok76.Stop()
        ElseIf NumericUpDown8.Value = 77 Then
            Prog_Lok77.Stop()
        ElseIf NumericUpDown8.Value = 78 Then
            Prog_Lok78.Stop()
        ElseIf NumericUpDown8.Value = 79 Then
            Prog_Lok79.Stop()
        ElseIf NumericUpDown8.Value = 80 Then
            Prog_Lok80.Stop()

        Else
            _LokStufen.EinzelLokSenden(1, 0)
        End If
    End Sub
    Private Sub StopZug2()
        ' ***
        ' *** Datum: 11.01.2020
        ' ***
        _LokStufen.EinzelLokSenden(2, 0)
        If NumericUpDown9.Value = 10 Then
            Prog_Lok10.Stop()
        ElseIf NumericUpDown9.Value = 11 Then
            Prog_Lok11.Stop()
        ElseIf NumericUpDown9.Value = 12 Then
            Prog_Lok12.Stop()
        ElseIf NumericUpDown9.Value = 13 Then
            Prog_Lok13.Stop()
        ElseIf NumericUpDown9.Value = 14 Then
            Prog_Lok14.Stop()
        ElseIf NumericUpDown9.Value = 15 Then
            Prog_Lok15.Stop()
        ElseIf NumericUpDown9.Value = 16 Then
            Prog_Lok16.Stop()
        ElseIf NumericUpDown9.Value = 17 Then
            Prog_Lok17.Stop()
        ElseIf NumericUpDown9.Value = 18 Then
            Prog_Lok18.Stop()
        ElseIf NumericUpDown9.Value = 19 Then
            Prog_Lok19.Stop()
        ElseIf NumericUpDown9.Value = 20 Then
            Prog_Lok20.Stop()
        ElseIf NumericUpDown9.Value = 21 Then
            Prog_Lok21.Stop()
        ElseIf NumericUpDown9.Value = 22 Then
            Prog_Lok22.Stop()
        ElseIf NumericUpDown9.Value = 23 Then
            Prog_Lok23.Stop()
        ElseIf NumericUpDown9.Value = 24 Then
            Prog_Lok24.Stop()
        ElseIf NumericUpDown9.Value = 25 Then
            Prog_Lok25.Stop()
        ElseIf NumericUpDown9.Value = 26 Then
            Prog_Lok26.Stop()
        ElseIf NumericUpDown9.Value = 27 Then
            Prog_Lok27.Stop()
        ElseIf NumericUpDown9.Value = 28 Then
            Prog_Lok28.Stop()
        ElseIf NumericUpDown9.Value = 29 Then
            Prog_Lok29.Stop()
        ElseIf NumericUpDown9.Value = 30 Then
            Prog_Lok30.Stop()
        ElseIf NumericUpDown9.Value = 31 Then
            Prog_Lok31.Stop()
        ElseIf NumericUpDown9.Value = 32 Then
            Prog_Lok32.Stop()
        ElseIf NumericUpDown9.Value = 33 Then
            Prog_Lok33.Stop()
        ElseIf NumericUpDown9.Value = 34 Then
            Prog_Lok34.Stop()
        ElseIf NumericUpDown9.Value = 35 Then
            Prog_Lok35.Stop()
        ElseIf NumericUpDown9.Value = 36 Then
            Prog_Lok36.Stop()
        ElseIf NumericUpDown9.Value = 37 Then
            Prog_Lok37.Stop()
        ElseIf NumericUpDown9.Value = 38 Then
            Prog_Lok38.Stop()
        ElseIf NumericUpDown9.Value = 39 Then
            Prog_Lok39.Stop()
        ElseIf NumericUpDown9.Value = 40 Then
            Prog_Lok40.Stop()
        ElseIf NumericUpDown9.Value = 41 Then
            Prog_Lok41.Stop()
        ElseIf NumericUpDown9.Value = 42 Then
            Prog_Lok42.Stop()
        ElseIf NumericUpDown9.Value = 43 Then
            Prog_Lok43.Stop()
        ElseIf NumericUpDown9.Value = 44 Then
            Prog_Lok44.Stop()
        ElseIf NumericUpDown9.Value = 45 Then
            Prog_Lok45.Stop()
        ElseIf NumericUpDown9.Value = 46 Then
            Prog_Lok46.Stop()
        ElseIf NumericUpDown9.Value = 47 Then
            Prog_Lok47.Stop()
        ElseIf NumericUpDown9.Value = 48 Then
            Prog_Lok48.Stop()
        ElseIf NumericUpDown9.Value = 49 Then
            Prog_Lok49.Stop()
        ElseIf NumericUpDown9.Value = 50 Then
            Prog_Lok50.Stop()
        ElseIf NumericUpDown9.Value = 51 Then
            Prog_Lok51.Stop()
        ElseIf NumericUpDown9.Value = 52 Then
            Prog_Lok52.Stop()
        ElseIf NumericUpDown9.Value = 53 Then
            Prog_Lok53.Stop()
        ElseIf NumericUpDown9.Value = 54 Then
            Prog_Lok54.Stop()
        ElseIf NumericUpDown9.Value = 55 Then
            Prog_Lok55.Stop()
        ElseIf NumericUpDown9.Value = 56 Then
            Prog_Lok56.Stop()
        ElseIf NumericUpDown9.Value = 57 Then
            Prog_Lok57.Stop()
        ElseIf NumericUpDown9.Value = 58 Then
            Prog_Lok58.Stop()
        ElseIf NumericUpDown9.Value = 59 Then
            Prog_Lok59.Stop()
        ElseIf NumericUpDown9.Value = 60 Then
            Prog_Lok60.Stop()
        ElseIf NumericUpDown9.Value = 61 Then
            Prog_Lok61.Stop()
        ElseIf NumericUpDown9.Value = 62 Then
            Prog_Lok62.Stop()
        ElseIf NumericUpDown9.Value = 63 Then
            Prog_Lok63.Stop()
        ElseIf NumericUpDown9.Value = 64 Then
            Prog_Lok64.Stop()
        ElseIf NumericUpDown9.Value = 65 Then
            Prog_Lok65.Stop()
        ElseIf NumericUpDown9.Value = 66 Then
            Prog_Lok66.Stop()
        ElseIf NumericUpDown9.Value = 67 Then
            Prog_Lok67.Stop()
        ElseIf NumericUpDown9.Value = 68 Then
            Prog_Lok68.Stop()
        ElseIf NumericUpDown9.Value = 69 Then
            Prog_Lok69.Stop()
        ElseIf NumericUpDown9.Value = 70 Then
            Prog_Lok70.Stop()
        ElseIf NumericUpDown9.Value = 71 Then
            Prog_Lok71.Stop()
        ElseIf NumericUpDown9.Value = 72 Then
            Prog_Lok72.Stop()
        ElseIf NumericUpDown9.Value = 73 Then
            Prog_Lok73.Stop()
        ElseIf NumericUpDown9.Value = 74 Then
            Prog_Lok74.Stop()
        ElseIf NumericUpDown9.Value = 75 Then
            Prog_Lok75.Stop()
        ElseIf NumericUpDown9.Value = 76 Then
            Prog_Lok76.Stop()
        ElseIf NumericUpDown9.Value = 77 Then
            Prog_Lok77.Stop()
        ElseIf NumericUpDown9.Value = 78 Then
            Prog_Lok78.Stop()
        ElseIf NumericUpDown9.Value = 79 Then
            Prog_Lok79.Stop()
        ElseIf NumericUpDown9.Value = 80 Then
            Prog_Lok80.Stop()

        Else
            _LokStufen.EinzelLokSenden(2, 0)
        End If
    End Sub
    Private Sub StopZug3()
        ' ***
        ' *** Datum: 11.01.2020
        ' ***
        _LokStufen.EinzelLokSenden(3, 0)
        If NumericUpDown10.Value = 10 Then
            Prog_Lok10.Stop()
        ElseIf NumericUpDown10.Value = 11 Then
            Prog_Lok11.Stop()
        ElseIf NumericUpDown10.Value = 12 Then
            Prog_Lok12.Stop()
        ElseIf NumericUpDown10.Value = 13 Then
            Prog_Lok13.Stop()
        ElseIf NumericUpDown10.Value = 14 Then
            Prog_Lok14.Stop()
        ElseIf NumericUpDown10.Value = 15 Then
            Prog_Lok15.Stop()
        ElseIf NumericUpDown10.Value = 16 Then
            Prog_Lok16.Stop()
        ElseIf NumericUpDown10.Value = 17 Then
            Prog_Lok17.Stop()
        ElseIf NumericUpDown10.Value = 18 Then
            Prog_Lok18.Stop()
        ElseIf NumericUpDown10.Value = 19 Then
            Prog_Lok19.Stop()
        ElseIf NumericUpDown10.Value = 20 Then
            Prog_Lok20.Stop()
        ElseIf NumericUpDown10.Value = 21 Then
            Prog_Lok21.Stop()
        ElseIf NumericUpDown10.Value = 22 Then
            Prog_Lok22.Stop()
        ElseIf NumericUpDown10.Value = 23 Then
            Prog_Lok23.Stop()
        ElseIf NumericUpDown10.Value = 24 Then
            Prog_Lok24.Stop()
        ElseIf NumericUpDown10.Value = 25 Then
            Prog_Lok25.Stop()
        ElseIf NumericUpDown10.Value = 26 Then
            Prog_Lok26.Stop()
        ElseIf NumericUpDown10.Value = 27 Then
            Prog_Lok27.Stop()
        ElseIf NumericUpDown10.Value = 28 Then
            Prog_Lok28.Stop()
        ElseIf NumericUpDown10.Value = 29 Then
            Prog_Lok29.Stop()
        ElseIf NumericUpDown10.Value = 30 Then
            Prog_Lok30.Stop()
        ElseIf NumericUpDown10.Value = 31 Then
            Prog_Lok31.Stop()
        ElseIf NumericUpDown10.Value = 32 Then
            Prog_Lok32.Stop()
        ElseIf NumericUpDown10.Value = 33 Then
            Prog_Lok33.Stop()
        ElseIf NumericUpDown10.Value = 34 Then
            Prog_Lok34.Stop()
        ElseIf NumericUpDown10.Value = 35 Then
            Prog_Lok35.Stop()
        ElseIf NumericUpDown10.Value = 36 Then
            Prog_Lok36.Stop()
        ElseIf NumericUpDown10.Value = 37 Then
            Prog_Lok37.Stop()
        ElseIf NumericUpDown10.Value = 38 Then
            Prog_Lok38.Stop()
        ElseIf NumericUpDown10.Value = 39 Then
            Prog_Lok39.Stop()
        ElseIf NumericUpDown10.Value = 40 Then
            Prog_Lok40.Stop()
        ElseIf NumericUpDown10.Value = 41 Then
            Prog_Lok41.Stop()
        ElseIf NumericUpDown10.Value = 42 Then
            Prog_Lok42.Stop()
        ElseIf NumericUpDown10.Value = 43 Then
            Prog_Lok43.Stop()
        ElseIf NumericUpDown10.Value = 44 Then
            Prog_Lok44.Stop()
        ElseIf NumericUpDown10.Value = 45 Then
            Prog_Lok45.Stop()
        ElseIf NumericUpDown10.Value = 46 Then
            Prog_Lok46.Stop()
        ElseIf NumericUpDown10.Value = 47 Then
            Prog_Lok47.Stop()
        ElseIf NumericUpDown10.Value = 48 Then
            Prog_Lok48.Stop()
        ElseIf NumericUpDown10.Value = 49 Then
            Prog_Lok49.Stop()
        ElseIf NumericUpDown10.Value = 50 Then
            Prog_Lok50.Stop()
        ElseIf NumericUpDown10.Value = 51 Then
            Prog_Lok51.Stop()
        ElseIf NumericUpDown10.Value = 52 Then
            Prog_Lok52.Stop()
        ElseIf NumericUpDown10.Value = 53 Then
            Prog_Lok53.Stop()
        ElseIf NumericUpDown10.Value = 54 Then
            Prog_Lok54.Stop()
        ElseIf NumericUpDown10.Value = 55 Then
            Prog_Lok55.Stop()
        ElseIf NumericUpDown10.Value = 56 Then
            Prog_Lok56.Stop()
        ElseIf NumericUpDown10.Value = 57 Then
            Prog_Lok57.Stop()
        ElseIf NumericUpDown10.Value = 58 Then
            Prog_Lok58.Stop()
        ElseIf NumericUpDown10.Value = 59 Then
            Prog_Lok59.Stop()
        ElseIf NumericUpDown10.Value = 60 Then
            Prog_Lok60.Stop()
        ElseIf NumericUpDown10.Value = 61 Then
            Prog_Lok61.Stop()
        ElseIf NumericUpDown10.Value = 62 Then
            Prog_Lok62.Stop()
        ElseIf NumericUpDown10.Value = 63 Then
            Prog_Lok63.Stop()
        ElseIf NumericUpDown10.Value = 64 Then
            Prog_Lok64.Stop()
        ElseIf NumericUpDown10.Value = 65 Then
            Prog_Lok65.Stop()
        ElseIf NumericUpDown10.Value = 66 Then
            Prog_Lok66.Stop()
        ElseIf NumericUpDown10.Value = 67 Then
            Prog_Lok67.Stop()
        ElseIf NumericUpDown10.Value = 68 Then
            Prog_Lok68.Stop()
        ElseIf NumericUpDown10.Value = 69 Then
            Prog_Lok69.Stop()
        ElseIf NumericUpDown10.Value = 70 Then
            Prog_Lok70.Stop()
        ElseIf NumericUpDown10.Value = 71 Then
            Prog_Lok71.Stop()
        ElseIf NumericUpDown10.Value = 72 Then
            Prog_Lok72.Stop()
        ElseIf NumericUpDown10.Value = 73 Then
            Prog_Lok73.Stop()
        ElseIf NumericUpDown10.Value = 74 Then
            Prog_Lok74.Stop()
        ElseIf NumericUpDown10.Value = 75 Then
            Prog_Lok75.Stop()
        ElseIf NumericUpDown10.Value = 76 Then
            Prog_Lok76.Stop()
        ElseIf NumericUpDown10.Value = 77 Then
            Prog_Lok77.Stop()
        ElseIf NumericUpDown10.Value = 78 Then
            Prog_Lok78.Stop()
        ElseIf NumericUpDown10.Value = 79 Then
            Prog_Lok79.Stop()
        ElseIf NumericUpDown10.Value = 80 Then
            Prog_Lok80.Stop()

        Else
            _LokStufen.EinzelLokSenden(3, 0)
        End If
    End Sub
    Private Sub StopZug4()
        ' ***
        ' *** Datum: 11.01.2020
        ' ***
        _LokStufen.EinzelLokSenden(4, 0)
        If NumericUpDown11.Value = 10 Then
            Prog_Lok10.Stop()
        ElseIf NumericUpDown11.Value = 11 Then
            Prog_Lok11.Stop()
        ElseIf NumericUpDown11.Value = 12 Then
            Prog_Lok12.Stop()
        ElseIf NumericUpDown11.Value = 13 Then
            Prog_Lok13.Stop()
        ElseIf NumericUpDown11.Value = 14 Then
            Prog_Lok14.Stop()
        ElseIf NumericUpDown11.Value = 15 Then
            Prog_Lok15.Stop()
        ElseIf NumericUpDown9.Value = 16 Then
            Prog_Lok16.Stop()
        ElseIf NumericUpDown11.Value = 17 Then
            Prog_Lok17.Stop()
        ElseIf NumericUpDown11.Value = 18 Then
            Prog_Lok18.Stop()
        ElseIf NumericUpDown11.Value = 19 Then
            Prog_Lok19.Stop()
        ElseIf NumericUpDown11.Value = 20 Then
            Prog_Lok20.Stop()
        ElseIf NumericUpDown11.Value = 21 Then
            Prog_Lok21.Stop()
        ElseIf NumericUpDown11.Value = 22 Then
            Prog_Lok22.Stop()
        ElseIf NumericUpDown11.Value = 23 Then
            Prog_Lok23.Stop()
        ElseIf NumericUpDown11.Value = 24 Then
            Prog_Lok24.Stop()
        ElseIf NumericUpDown11.Value = 25 Then
            Prog_Lok25.Stop()
        ElseIf NumericUpDown11.Value = 26 Then
            Prog_Lok26.Stop()
        ElseIf NumericUpDown11.Value = 27 Then
            Prog_Lok27.Stop()
        ElseIf NumericUpDown11.Value = 28 Then
            Prog_Lok28.Stop()
        ElseIf NumericUpDown11.Value = 29 Then
            Prog_Lok29.Stop()
        ElseIf NumericUpDown11.Value = 30 Then
            Prog_Lok30.Stop()
        ElseIf NumericUpDown11.Value = 31 Then
            Prog_Lok31.Stop()
        ElseIf NumericUpDown11.Value = 32 Then
            Prog_Lok32.Stop()
        ElseIf NumericUpDown11.Value = 33 Then
            Prog_Lok33.Stop()
        ElseIf NumericUpDown11.Value = 34 Then
            Prog_Lok34.Stop()
        ElseIf NumericUpDown11.Value = 35 Then
            Prog_Lok35.Stop()
        ElseIf NumericUpDown11.Value = 36 Then
            Prog_Lok36.Stop()
        ElseIf NumericUpDown11.Value = 37 Then
            Prog_Lok37.Stop()
        ElseIf NumericUpDown11.Value = 38 Then
            Prog_Lok38.Stop()
        ElseIf NumericUpDown11.Value = 39 Then
            Prog_Lok39.Stop()
        ElseIf NumericUpDown11.Value = 40 Then
            Prog_Lok40.Stop()
        ElseIf NumericUpDown11.Value = 41 Then
            Prog_Lok41.Stop()
        ElseIf NumericUpDown11.Value = 42 Then
            Prog_Lok42.Stop()
        ElseIf NumericUpDown11.Value = 43 Then
            Prog_Lok43.Stop()
        ElseIf NumericUpDown11.Value = 44 Then
            Prog_Lok44.Stop()
        ElseIf NumericUpDown11.Value = 45 Then
            Prog_Lok45.Stop()
        ElseIf NumericUpDown11.Value = 46 Then
            Prog_Lok46.Stop()
        ElseIf NumericUpDown11.Value = 47 Then
            Prog_Lok47.Stop()
        ElseIf NumericUpDown11.Value = 48 Then
            Prog_Lok48.Stop()
        ElseIf NumericUpDown11.Value = 49 Then
            Prog_Lok49.Stop()
        ElseIf NumericUpDown11.Value = 50 Then
            Prog_Lok50.Stop()
        ElseIf NumericUpDown11.Value = 51 Then
            Prog_Lok51.Stop()
        ElseIf NumericUpDown11.Value = 52 Then
            Prog_Lok52.Stop()
        ElseIf NumericUpDown11.Value = 53 Then
            Prog_Lok53.Stop()
        ElseIf NumericUpDown11.Value = 54 Then
            Prog_Lok54.Stop()
        ElseIf NumericUpDown11.Value = 55 Then
            Prog_Lok55.Stop()
        ElseIf NumericUpDown11.Value = 56 Then
            Prog_Lok56.Stop()
        ElseIf NumericUpDown11.Value = 57 Then
            Prog_Lok57.Stop()
        ElseIf NumericUpDown11.Value = 58 Then
            Prog_Lok58.Stop()
        ElseIf NumericUpDown11.Value = 59 Then
            Prog_Lok59.Stop()
        ElseIf NumericUpDown11.Value = 60 Then
            Prog_Lok60.Stop()
        ElseIf NumericUpDown11.Value = 61 Then
            Prog_Lok61.Stop()
        ElseIf NumericUpDown11.Value = 62 Then
            Prog_Lok62.Stop()
        ElseIf NumericUpDown11.Value = 63 Then
            Prog_Lok63.Stop()
        ElseIf NumericUpDown11.Value = 64 Then
            Prog_Lok64.Stop()
        ElseIf NumericUpDown11.Value = 65 Then
            Prog_Lok65.Stop()
        ElseIf NumericUpDown11.Value = 66 Then
            Prog_Lok66.Stop()
        ElseIf NumericUpDown11.Value = 67 Then
            Prog_Lok67.Stop()
        ElseIf NumericUpDown11.Value = 68 Then
            Prog_Lok68.Stop()
        ElseIf NumericUpDown11.Value = 69 Then
            Prog_Lok69.Stop()
        ElseIf NumericUpDown11.Value = 70 Then
            Prog_Lok70.Stop()
        ElseIf NumericUpDown11.Value = 71 Then
            Prog_Lok71.Stop()
        ElseIf NumericUpDown11.Value = 72 Then
            Prog_Lok72.Stop()
        ElseIf NumericUpDown11.Value = 73 Then
            Prog_Lok73.Stop()
        ElseIf NumericUpDown11.Value = 74 Then
            Prog_Lok74.Stop()
        ElseIf NumericUpDown11.Value = 75 Then
            Prog_Lok75.Stop()
        ElseIf NumericUpDown11.Value = 76 Then
            Prog_Lok76.Stop()
        ElseIf NumericUpDown11.Value = 77 Then
            Prog_Lok77.Stop()
        ElseIf NumericUpDown11.Value = 78 Then
            Prog_Lok78.Stop()
        ElseIf NumericUpDown11.Value = 79 Then
            Prog_Lok79.Stop()
        ElseIf NumericUpDown11.Value = 80 Then
            Prog_Lok80.Stop()
        Else
            _LokStufen.EinzelLokSenden(4, 0)
        End If
    End Sub

    Private Sub ZindelsteinLok1()
        Dim Schritt As Integer
        Schritt = 504
        If NumericUpDown8.Value = 10 Then
            _Prog10 = Schritt
        ElseIf NumericUpDown8.Value = 11 Then
            _Prog11 = Schritt
        ElseIf NumericUpDown8.Value = 12 Then
            _Prog12 = Schritt
        ElseIf NumericUpDown8.Value = 13 Then
            _Prog13 = Schritt
        ElseIf NumericUpDown8.Value = 14 Then
            _Prog14 = Schritt
        ElseIf NumericUpDown8.Value = 15 Then
            _Prog15 = Schritt
        ElseIf NumericUpDown8.Value = 16 Then
            _Prog16 = Schritt
        ElseIf NumericUpDown8.Value = 17 Then
            _Prog17 = Schritt
        ElseIf NumericUpDown8.Value = 18 Then
            _Prog18 = Schritt
        ElseIf NumericUpDown8.Value = 19 Then
            _Prog19 = Schritt
        ElseIf NumericUpDown8.Value = 20 Then
            _Prog21 = Schritt
        ElseIf NumericUpDown8.Value = 21 Then
            _Prog21 = Schritt
        ElseIf NumericUpDown8.Value = 22 Then
            _Prog22 = Schritt
        ElseIf NumericUpDown8.Value = 23 Then
            _Prog23 = Schritt
        ElseIf NumericUpDown8.Value = 24 Then
            _Prog24 = Schritt
        ElseIf NumericUpDown8.Value = 25 Then
            _Prog25 = Schritt
        ElseIf NumericUpDown8.Value = 26 Then
            _Prog26 = Schritt
        ElseIf NumericUpDown8.Value = 27 Then
            _Prog27 = Schritt
        ElseIf NumericUpDown8.Value = 28 Then
            _Prog28 = Schritt
        ElseIf NumericUpDown8.Value = 29 Then
            _Prog29 = Schritt
        ElseIf NumericUpDown8.Value = 30 Then
            _Prog30 = Schritt
        ElseIf NumericUpDown8.Value = 31 Then
            _Prog31 = Schritt
        ElseIf NumericUpDown8.Value = 32 Then
            _Prog32 = Schritt
        ElseIf NumericUpDown8.Value = 33 Then
            _Prog33 = Schritt
        ElseIf NumericUpDown8.Value = 34 Then
            _Prog34 = Schritt
        ElseIf NumericUpDown8.Value = 35 Then
            _Prog35 = Schritt
        ElseIf NumericUpDown8.Value = 36 Then
            _Prog36 = Schritt
        ElseIf NumericUpDown8.Value = 37 Then
            _Prog37 = Schritt
        ElseIf NumericUpDown8.Value = 38 Then
            _Prog38 = Schritt
        ElseIf NumericUpDown8.Value = 39 Then
            _Prog39 = Schritt
        ElseIf NumericUpDown8.Value = 40 Then
            _Prog40 = Schritt
        ElseIf NumericUpDown8.Value = 41 Then
            _Prog41 = Schritt
        ElseIf NumericUpDown8.Value = 42 Then
            _Prog42 = Schritt
        ElseIf NumericUpDown8.Value = 43 Then
            _Prog43 = Schritt
        ElseIf NumericUpDown8.Value = 44 Then
            _Prog44 = Schritt
        ElseIf NumericUpDown8.Value = 45 Then
            _Prog45 = Schritt
        ElseIf NumericUpDown8.Value = 46 Then
            _Prog46 = Schritt
        ElseIf NumericUpDown8.Value = 47 Then
            _Prog47 = Schritt
        ElseIf NumericUpDown8.Value = 48 Then
            _Prog48 = Schritt
        ElseIf NumericUpDown8.Value = 49 Then
            _Prog49 = Schritt
        ElseIf NumericUpDown8.Value = 50 Then
            _Prog50 = Schritt
        ElseIf NumericUpDown8.Value = 51 Then
            _Prog51 = Schritt
        ElseIf NumericUpDown8.Value = 52 Then
            _Prog52 = Schritt
        ElseIf NumericUpDown8.Value = 53 Then
            _Prog53 = Schritt
        ElseIf NumericUpDown8.Value = 54 Then
            _Prog54 = Schritt
        ElseIf NumericUpDown8.Value = 55 Then
            _Prog55 = Schritt
        ElseIf NumericUpDown8.Value = 56 Then
            _Prog56 = Schritt
        ElseIf NumericUpDown8.Value = 57 Then
            _Prog57 = Schritt
        ElseIf NumericUpDown8.Value = 58 Then
            _Prog58 = Schritt
        ElseIf NumericUpDown8.Value = 59 Then
            _Prog59 = Schritt
        ElseIf NumericUpDown8.Value = 60 Then
            _Prog60 = Schritt
            _GlsL60 = 1
            Prog_Lok60.Start()
        ElseIf NumericUpDown8.Value = 61 Then
            _Prog61 = Schritt
        ElseIf NumericUpDown8.Value = 62 Then
            _Prog62 = Schritt
        ElseIf NumericUpDown8.Value = 63 Then
            _Prog63 = Schritt
        ElseIf NumericUpDown8.Value = 64 Then
            _Prog64 = Schritt
        ElseIf NumericUpDown8.Value = 65 Then
            _Prog65 = Schritt
        ElseIf NumericUpDown8.Value = 66 Then
            _Prog66 = Schritt
        ElseIf NumericUpDown8.Value = 67 Then
            _Prog67 = Schritt
        ElseIf NumericUpDown8.Value = 68 Then
            _Prog68 = Schritt
        ElseIf NumericUpDown8.Value = 69 Then
            _Prog69 = Schritt
        ElseIf NumericUpDown8.Value = 70 Then
            _Prog70 = Schritt
        ElseIf NumericUpDown8.Value = 71 Then
            _Prog71 = Schritt
        ElseIf NumericUpDown8.Value = 72 Then
            _Prog72 = Schritt
        ElseIf NumericUpDown8.Value = 73 Then
            _Prog73 = Schritt
        ElseIf NumericUpDown8.Value = 74 Then
            _Prog74 = Schritt
        ElseIf NumericUpDown8.Value = 75 Then
            _Prog75 = Schritt
        ElseIf NumericUpDown8.Value = 76 Then
            _Prog76 = Schritt
        ElseIf NumericUpDown8.Value = 77 Then
            _Prog77 = Schritt
        ElseIf NumericUpDown8.Value = 78 Then
            _Prog78 = Schritt
        ElseIf NumericUpDown8.Value = 79 Then
            _Prog79 = Schritt
        ElseIf NumericUpDown8.Value = 80 Then
            _Prog80 = Schritt

        End If
    End Sub
    Private Sub ZindelsteinLok2()
        Dim Schritt As Integer
        Schritt = 504
        If NumericUpDown9.Value = 10 Then
            _Prog10 = Schritt
        ElseIf NumericUpDown9.Value = 11 Then
            _Prog11 = Schritt
        ElseIf NumericUpDown9.Value = 12 Then
            _Prog12 = Schritt
        ElseIf NumericUpDown9.Value = 13 Then
            _Prog13 = Schritt
        ElseIf NumericUpDown9.Value = 14 Then
            _Prog14 = Schritt
        ElseIf NumericUpDown9.Value = 15 Then
            _Prog15 = Schritt
        ElseIf NumericUpDown9.Value = 16 Then
            _Prog16 = Schritt
        ElseIf NumericUpDown9.Value = 17 Then
            _Prog17 = Schritt
        ElseIf NumericUpDown9.Value = 18 Then
            _Prog18 = Schritt
        ElseIf NumericUpDown9.Value = 19 Then
            _Prog19 = Schritt
        ElseIf NumericUpDown9.Value = 20 Then
            _Prog21 = Schritt
        ElseIf NumericUpDown9.Value = 21 Then
            _Prog21 = Schritt
        ElseIf NumericUpDown9.Value = 22 Then
            _Prog22 = Schritt
        ElseIf NumericUpDown9.Value = 23 Then
            _Prog23 = Schritt
        ElseIf NumericUpDown9.Value = 24 Then
            _Prog24 = Schritt
        ElseIf NumericUpDown9.Value = 25 Then
            _Prog25 = Schritt
        ElseIf NumericUpDown9.Value = 26 Then
            _Prog26 = Schritt
        ElseIf NumericUpDown9.Value = 27 Then
            _Prog27 = Schritt
        ElseIf NumericUpDown9.Value = 28 Then
            _Prog28 = Schritt
        ElseIf NumericUpDown9.Value = 29 Then
            _Prog29 = Schritt
        ElseIf NumericUpDown9.Value = 30 Then
            _Prog30 = Schritt
        ElseIf NumericUpDown9.Value = 31 Then
            _Prog31 = Schritt
        ElseIf NumericUpDown9.Value = 32 Then
            _Prog32 = Schritt
        ElseIf NumericUpDown9.Value = 33 Then
            _Prog33 = Schritt
        ElseIf NumericUpDown9.Value = 34 Then
            _Prog34 = Schritt
        ElseIf NumericUpDown9.Value = 35 Then
            _Prog35 = Schritt
        ElseIf NumericUpDown9.Value = 36 Then
            _Prog36 = Schritt
        ElseIf NumericUpDown9.Value = 37 Then
            _Prog37 = Schritt
        ElseIf NumericUpDown9.Value = 38 Then
            _Prog38 = Schritt
        ElseIf NumericUpDown9.Value = 39 Then
            _Prog39 = Schritt
        ElseIf NumericUpDown9.Value = 40 Then
            _Prog40 = Schritt
        ElseIf NumericUpDown9.Value = 41 Then
            _Prog41 = Schritt
        ElseIf NumericUpDown9.Value = 42 Then
            _Prog42 = Schritt
        ElseIf NumericUpDown9.Value = 43 Then
            _Prog43 = Schritt
        ElseIf NumericUpDown9.Value = 44 Then
            _Prog44 = Schritt
        ElseIf NumericUpDown9.Value = 45 Then
            _Prog45 = Schritt
        ElseIf NumericUpDown9.Value = 46 Then
            _Prog46 = Schritt
        ElseIf NumericUpDown9.Value = 47 Then
            _Prog47 = Schritt
        ElseIf NumericUpDown9.Value = 48 Then
            _Prog48 = Schritt
        ElseIf NumericUpDown9.Value = 49 Then
            _Prog49 = Schritt
        ElseIf NumericUpDown9.Value = 50 Then
            _Prog50 = Schritt
        ElseIf NumericUpDown9.Value = 51 Then
            _Prog51 = Schritt
        ElseIf NumericUpDown9.Value = 52 Then
            _Prog52 = Schritt
        ElseIf NumericUpDown9.Value = 53 Then
            _Prog53 = Schritt
        ElseIf NumericUpDown9.Value = 54 Then
            _Prog54 = Schritt
        ElseIf NumericUpDown9.Value = 55 Then
            _Prog55 = Schritt
        ElseIf NumericUpDown9.Value = 56 Then
            _Prog56 = Schritt
        ElseIf NumericUpDown9.Value = 57 Then
            _Prog57 = Schritt
        ElseIf NumericUpDown9.Value = 58 Then
            _Prog58 = Schritt
        ElseIf NumericUpDown9.Value = 59 Then
            _Prog59 = Schritt
        ElseIf NumericUpDown9.Value = 60 Then
            _Prog60 = Schritt
            _GlsL60 = 2
            Prog_Lok60.Start()
        ElseIf NumericUpDown9.Value = 61 Then
            _Prog61 = Schritt
        ElseIf NumericUpDown9.Value = 62 Then
            _Prog62 = Schritt
        ElseIf NumericUpDown9.Value = 63 Then
            _Prog63 = Schritt
        ElseIf NumericUpDown9.Value = 64 Then
            _Prog64 = Schritt
        ElseIf NumericUpDown9.Value = 65 Then
            _Prog65 = Schritt
        ElseIf NumericUpDown9.Value = 66 Then
            _Prog66 = Schritt
        ElseIf NumericUpDown9.Value = 67 Then
            _Prog67 = Schritt
        ElseIf NumericUpDown9.Value = 68 Then
            _Prog68 = Schritt
        ElseIf NumericUpDown9.Value = 69 Then
            _Prog69 = Schritt
        ElseIf NumericUpDown9.Value = 70 Then
            _Prog70 = Schritt
        ElseIf NumericUpDown9.Value = 71 Then
            _Prog71 = Schritt
        ElseIf NumericUpDown9.Value = 72 Then
            _Prog72 = Schritt
        ElseIf NumericUpDown9.Value = 73 Then
            _Prog73 = Schritt
        ElseIf NumericUpDown9.Value = 74 Then
            _Prog74 = Schritt
        ElseIf NumericUpDown9.Value = 75 Then
            _Prog75 = Schritt
        ElseIf NumericUpDown9.Value = 76 Then
            _Prog76 = Schritt
        ElseIf NumericUpDown9.Value = 77 Then
            _Prog77 = Schritt
        ElseIf NumericUpDown9.Value = 78 Then
            _Prog78 = Schritt
        ElseIf NumericUpDown9.Value = 79 Then
            _Prog79 = Schritt
        ElseIf NumericUpDown9.Value = 80 Then
            _Prog80 = Schritt

        End If
    End Sub
    Private Sub ZindelsteinLok3()
        Dim Schritt As Integer
        Schritt = 504
        If NumericUpDown10.Value = 10 Then
            _Prog10 = Schritt
        ElseIf NumericUpDown10.Value = 11 Then
            _Prog11 = Schritt
        ElseIf NumericUpDown10.Value = 12 Then
            _Prog12 = Schritt
        ElseIf NumericUpDown10.Value = 13 Then
            _Prog13 = Schritt
        ElseIf NumericUpDown10.Value = 14 Then
            _Prog14 = Schritt
        ElseIf NumericUpDown10.Value = 15 Then
            _Prog15 = Schritt
        ElseIf NumericUpDown9.Value = 16 Then
            _Prog16 = Schritt
        ElseIf NumericUpDown10.Value = 17 Then
            _Prog17 = Schritt
        ElseIf NumericUpDown10.Value = 18 Then
            _Prog18 = Schritt
        ElseIf NumericUpDown10.Value = 19 Then
            _Prog19 = Schritt
        ElseIf NumericUpDown10.Value = 20 Then
            _Prog21 = Schritt
        ElseIf NumericUpDown10.Value = 21 Then
            _Prog21 = Schritt
        ElseIf NumericUpDown10.Value = 22 Then
            _Prog22 = Schritt
        ElseIf NumericUpDown10.Value = 23 Then
            _Prog23 = Schritt
        ElseIf NumericUpDown10.Value = 24 Then
            _Prog24 = Schritt
        ElseIf NumericUpDown10.Value = 25 Then
            _Prog25 = Schritt
        ElseIf NumericUpDown10.Value = 26 Then
            _Prog26 = Schritt
        ElseIf NumericUpDown10.Value = 27 Then
            _Prog27 = Schritt
        ElseIf NumericUpDown10.Value = 28 Then
            _Prog28 = Schritt
        ElseIf NumericUpDown10.Value = 29 Then
            _Prog29 = Schritt
        ElseIf NumericUpDown10.Value = 30 Then
            _Prog30 = Schritt
        ElseIf NumericUpDown10.Value = 31 Then
            _Prog31 = Schritt
        ElseIf NumericUpDown10.Value = 32 Then
            _Prog32 = Schritt
        ElseIf NumericUpDown10.Value = 33 Then
            _Prog33 = Schritt
        ElseIf NumericUpDown10.Value = 34 Then
            _Prog34 = Schritt
        ElseIf NumericUpDown10.Value = 35 Then
            _Prog35 = Schritt
        ElseIf NumericUpDown10.Value = 36 Then
            _Prog36 = Schritt
        ElseIf NumericUpDown10.Value = 37 Then
            _Prog37 = Schritt
        ElseIf NumericUpDown10.Value = 38 Then
            _Prog38 = Schritt
        ElseIf NumericUpDown10.Value = 39 Then
            _Prog39 = Schritt
        ElseIf NumericUpDown10.Value = 40 Then
            _Prog40 = Schritt
        ElseIf NumericUpDown10.Value = 41 Then
            _Prog41 = Schritt
        ElseIf NumericUpDown10.Value = 42 Then
            _Prog42 = Schritt
        ElseIf NumericUpDown10.Value = 43 Then
            _Prog43 = Schritt
        ElseIf NumericUpDown10.Value = 44 Then
            _Prog44 = Schritt
        ElseIf NumericUpDown10.Value = 45 Then
            _Prog45 = Schritt
        ElseIf NumericUpDown10.Value = 46 Then
            _Prog46 = Schritt
        ElseIf NumericUpDown10.Value = 47 Then
            _Prog47 = Schritt
        ElseIf NumericUpDown10.Value = 48 Then
            _Prog48 = Schritt
        ElseIf NumericUpDown10.Value = 49 Then
            _Prog49 = Schritt
        ElseIf NumericUpDown10.Value = 50 Then
            _Prog50 = Schritt
        ElseIf NumericUpDown10.Value = 51 Then
            _Prog51 = Schritt
        ElseIf NumericUpDown10.Value = 52 Then
            _Prog52 = Schritt
        ElseIf NumericUpDown10.Value = 53 Then
            _Prog53 = Schritt
        ElseIf NumericUpDown10.Value = 54 Then
            _Prog54 = Schritt
        ElseIf NumericUpDown10.Value = 55 Then
            _Prog55 = Schritt
        ElseIf NumericUpDown10.Value = 56 Then
            _Prog56 = Schritt
        ElseIf NumericUpDown10.Value = 57 Then
            _Prog57 = Schritt
        ElseIf NumericUpDown10.Value = 58 Then
            _Prog58 = Schritt
        ElseIf NumericUpDown10.Value = 59 Then
            _Prog59 = Schritt
        ElseIf NumericUpDown10.Value = 60 Then
            _Prog60 = Schritt
            _GlsL60 = 3
            Prog_Lok60.Start()
        ElseIf NumericUpDown10.Value = 61 Then
            _Prog61 = Schritt
        ElseIf NumericUpDown10.Value = 62 Then
            _Prog62 = Schritt
        ElseIf NumericUpDown10.Value = 63 Then
            _Prog63 = Schritt
        ElseIf NumericUpDown10.Value = 64 Then
            _Prog64 = Schritt
        ElseIf NumericUpDown10.Value = 65 Then
            _Prog65 = Schritt
        ElseIf NumericUpDown10.Value = 66 Then
            _Prog66 = Schritt
        ElseIf NumericUpDown10.Value = 67 Then
            _Prog67 = Schritt
        ElseIf NumericUpDown10.Value = 68 Then
            _Prog68 = Schritt
        ElseIf NumericUpDown10.Value = 69 Then
            _Prog69 = Schritt
        ElseIf NumericUpDown10.Value = 70 Then
            _Prog70 = Schritt
        ElseIf NumericUpDown10.Value = 71 Then
            _Prog71 = Schritt
        ElseIf NumericUpDown10.Value = 72 Then
            _Prog72 = Schritt
        ElseIf NumericUpDown10.Value = 73 Then
            _Prog73 = Schritt
        ElseIf NumericUpDown10.Value = 74 Then
            _Prog74 = Schritt
        ElseIf NumericUpDown10.Value = 75 Then
            _Prog75 = Schritt
        ElseIf NumericUpDown10.Value = 76 Then
            _Prog76 = Schritt
        ElseIf NumericUpDown10.Value = 77 Then
            _Prog77 = Schritt
        ElseIf NumericUpDown10.Value = 78 Then
            _Prog78 = Schritt
        ElseIf NumericUpDown10.Value = 79 Then
            _Prog79 = Schritt
        ElseIf NumericUpDown10.Value = 80 Then
            _Prog80 = Schritt

        End If
    End Sub
    Private Sub ZindelsteinLok4()
        Dim Schritt As Integer
        Schritt = 504
        If NumericUpDown11.Value = 10 Then
            _Prog10 = Schritt
        ElseIf NumericUpDown11.Value = 11 Then
            _Prog11 = Schritt
        ElseIf NumericUpDown11.Value = 12 Then
            _Prog12 = Schritt
        ElseIf NumericUpDown11.Value = 13 Then
            _Prog13 = Schritt
        ElseIf NumericUpDown11.Value = 14 Then
            _Prog14 = Schritt
        ElseIf NumericUpDown11.Value = 15 Then
            _Prog15 = Schritt
        ElseIf NumericUpDown9.Value = 16 Then
            _Prog16 = Schritt
        ElseIf NumericUpDown11.Value = 17 Then
            _Prog17 = Schritt
        ElseIf NumericUpDown11.Value = 18 Then
            _Prog18 = Schritt
        ElseIf NumericUpDown11.Value = 19 Then
            _Prog19 = Schritt
        ElseIf NumericUpDown11.Value = 20 Then
            _Prog21 = Schritt
        ElseIf NumericUpDown11.Value = 21 Then
            _Prog21 = Schritt
        ElseIf NumericUpDown11.Value = 22 Then
            _Prog22 = Schritt
        ElseIf NumericUpDown11.Value = 23 Then
            _Prog23 = Schritt
        ElseIf NumericUpDown11.Value = 24 Then
            _Prog24 = Schritt
        ElseIf NumericUpDown11.Value = 25 Then
            _Prog25 = Schritt
        ElseIf NumericUpDown11.Value = 26 Then
            _Prog26 = Schritt
        ElseIf NumericUpDown11.Value = 27 Then
            _Prog27 = Schritt
        ElseIf NumericUpDown11.Value = 28 Then
            _Prog28 = Schritt
        ElseIf NumericUpDown11.Value = 29 Then
            _Prog29 = Schritt
        ElseIf NumericUpDown11.Value = 30 Then
            _Prog30 = Schritt
        ElseIf NumericUpDown11.Value = 31 Then
            _Prog31 = Schritt
        ElseIf NumericUpDown11.Value = 32 Then
            _Prog32 = Schritt
        ElseIf NumericUpDown11.Value = 33 Then
            _Prog33 = Schritt
        ElseIf NumericUpDown11.Value = 34 Then
            _Prog34 = Schritt
        ElseIf NumericUpDown11.Value = 35 Then
            _Prog35 = Schritt
        ElseIf NumericUpDown11.Value = 36 Then
            _Prog36 = Schritt
        ElseIf NumericUpDown11.Value = 37 Then
            _Prog37 = Schritt
        ElseIf NumericUpDown11.Value = 38 Then
            _Prog38 = Schritt
        ElseIf NumericUpDown11.Value = 39 Then
            _Prog39 = Schritt
        ElseIf NumericUpDown11.Value = 40 Then
            _Prog40 = Schritt
        ElseIf NumericUpDown11.Value = 41 Then
            _Prog41 = Schritt
        ElseIf NumericUpDown11.Value = 42 Then
            _Prog42 = Schritt
        ElseIf NumericUpDown11.Value = 43 Then
            _Prog43 = Schritt
        ElseIf NumericUpDown11.Value = 44 Then
            _Prog44 = Schritt
        ElseIf NumericUpDown11.Value = 45 Then
            _Prog45 = Schritt
        ElseIf NumericUpDown11.Value = 46 Then
            _Prog46 = Schritt
        ElseIf NumericUpDown11.Value = 47 Then
            _Prog47 = Schritt
        ElseIf NumericUpDown11.Value = 48 Then
            _Prog48 = Schritt
        ElseIf NumericUpDown11.Value = 49 Then
            _Prog49 = Schritt
        ElseIf NumericUpDown11.Value = 50 Then
            _Prog50 = Schritt
        ElseIf NumericUpDown11.Value = 51 Then
            _Prog51 = Schritt
        ElseIf NumericUpDown11.Value = 52 Then
            _Prog52 = Schritt
        ElseIf NumericUpDown11.Value = 53 Then
            _Prog53 = Schritt
        ElseIf NumericUpDown11.Value = 54 Then
            _Prog54 = Schritt
        ElseIf NumericUpDown11.Value = 55 Then
            _Prog55 = Schritt
        ElseIf NumericUpDown11.Value = 56 Then
            _Prog56 = Schritt
        ElseIf NumericUpDown11.Value = 57 Then
            _Prog57 = Schritt
        ElseIf NumericUpDown11.Value = 58 Then
            _Prog58 = Schritt
        ElseIf NumericUpDown11.Value = 59 Then
            _Prog59 = Schritt
        ElseIf NumericUpDown11.Value = 60 Then
            _Prog60 = Schritt
            _GlsL60 = 4
            Prog_Lok60.Start()
        ElseIf NumericUpDown11.Value = 61 Then
            _Prog61 = Schritt
        ElseIf NumericUpDown11.Value = 62 Then
            _Prog62 = Schritt
        ElseIf NumericUpDown11.Value = 63 Then
            _Prog63 = Schritt
        ElseIf NumericUpDown11.Value = 64 Then
            _Prog64 = Schritt
        ElseIf NumericUpDown11.Value = 65 Then
            _Prog65 = Schritt
        ElseIf NumericUpDown11.Value = 66 Then
            _Prog66 = Schritt
        ElseIf NumericUpDown11.Value = 67 Then
            _Prog67 = Schritt
        ElseIf NumericUpDown11.Value = 68 Then
            _Prog68 = Schritt
        ElseIf NumericUpDown11.Value = 69 Then
            _Prog69 = Schritt
        ElseIf NumericUpDown11.Value = 70 Then
            _Prog70 = Schritt
        ElseIf NumericUpDown11.Value = 71 Then
            _Prog71 = Schritt
        ElseIf NumericUpDown11.Value = 72 Then
            _Prog72 = Schritt
        ElseIf NumericUpDown11.Value = 73 Then
            _Prog73 = Schritt
        ElseIf NumericUpDown11.Value = 74 Then
            _Prog74 = Schritt
        ElseIf NumericUpDown11.Value = 75 Then
            _Prog75 = Schritt
        ElseIf NumericUpDown11.Value = 76 Then
            _Prog76 = Schritt
        ElseIf NumericUpDown11.Value = 77 Then
            _Prog77 = Schritt
        ElseIf NumericUpDown11.Value = 78 Then
            _Prog78 = Schritt
        ElseIf NumericUpDown11.Value = 79 Then
            _Prog79 = Schritt
        ElseIf NumericUpDown11.Value = 80 Then
            _Prog80 = Schritt

        End If
    End Sub

    Private Sub ObenLangLok1(Kontakt)
        If Kontakt.Modul = 0 And Kontakt.Adresse = 5 And Kontakt.status = True And AutomatikParameter = 101 Then
            ObenLang101Lok1()
        End If
        If Kontakt.Modul = 0 And Kontakt.Adresse = 4 And Kontakt.status = True And AutomatikParameter = 102 Then
            ObenLang102Lok1()
        End If
        If _GleisFrei2 = 0 And _GleisFrei3 = 0 And _GleisFrei4 = 0 Then
            If Kontakt.Modul = 0 And Kontakt.Adresse = 0 And Kontakt.status = True And AutomatikParameter = 103 Then
                ObenLang103Lok1()
            End If
            If Kontakt.Modul = 0 And Kontakt.Adresse = 1 And Kontakt.status = True And _AutomatikParameterH = 104 Then
                ObenLang104Lok1()
            End If
            If Kontakt.Modul = 0 And Kontakt.Adresse = 1 And Kontakt.status = False And AutomatikParameter = 106 Then
                ObenLang105Lok1()
            End If
        ElseIf _GleisFrei2 = 1 Then
            If Kontakt.Modul = 0 And Kontakt.Adresse = 2 And Kontakt.status = True And AutomatikParameter = 103 Then
                ObenLang103Lok1()
            End If
            If Kontakt.Modul = 0 And Kontakt.Adresse = 3 And Kontakt.status = True And _AutomatikParameterH = 104 Then
                ObenLang104Lok1()
            End If
            If Kontakt.Modul = 0 And Kontakt.Adresse = 3 And Kontakt.status = False And AutomatikParameter = 106 Then
                ObenLang105Lok1()
            End If
        ElseIf _GleisFrei3 = 1 Then
            If Kontakt.Modul = 1 And Kontakt.Adresse = 7 And Kontakt.status = True And AutomatikParameter = 103 Then
                ObenLang103Lok1()
            End If
            If Kontakt.Modul = 1 And Kontakt.Adresse = 6 And Kontakt.status = True And _AutomatikParameterH = 104 Then
                ObenLang104Lok1()
            End If
            If Kontakt.Modul = 1 And Kontakt.Adresse = 6 And Kontakt.status = False And AutomatikParameter = 106 Then
                ObenLang105Lok1()
            End If
        ElseIf _GleisFrei4 = 1 Then
            If Kontakt.Modul = 1 And Kontakt.Adresse = 5 And Kontakt.status = True And AutomatikParameter = 103 Then
                ObenLang103Lok1()
            End If
            If Kontakt.Modul = 1 And Kontakt.Adresse = 4 And Kontakt.status = True And _AutomatikParameterH = 104 Then
                ObenLang104Lok1()
            End If
            If Kontakt.Modul = 1 And Kontakt.Adresse = 4 And Kontakt.status = False And AutomatikParameter = 106 Then
                ObenLang105Lok1()
            End If
        End If
    End Sub
    Private Sub ObenLangLok2(Kontakt)
        If Kontakt.Modul = 0 And Kontakt.Adresse = 5 And Kontakt.status = True And AutomatikParameter = 201 Then
            ObenLang101Lok2()
        End If
        If Kontakt.Modul = 0 And Kontakt.Adresse = 4 And Kontakt.status = True And AutomatikParameter = 202 Then
            ObenLang102Lok2()
        End If
        If Kontakt.Modul = 0 And Kontakt.Adresse = 2 And Kontakt.status = True And AutomatikParameter = 203 Then
            ObenLang103Lok2()
        End If
        If Kontakt.Modul = 0 And Kontakt.Adresse = 3 And Kontakt.status = True And _AutomatikParameterH = 204 Then
            ObenLang104Lok2()
        End If
        If Kontakt.Modul = 0 And Kontakt.Adresse = 3 And Kontakt.status = False And AutomatikParameter = 206 Then
            ObenLang105Lok2()
        End If
    End Sub
    Private Sub ObenLangLok3(Kontakt)
        If Kontakt.Modul = 1 And Kontakt.Adresse = 6 And Kontakt.status = True And AutomatikParameter = 317 And _AutomatikParameterH <> 318 Then
            ObenLang101Lok3()
        End If
        If Kontakt.Modul = 1 And Kontakt.Adresse = 7 And Kontakt.status = True And _AutomatikParameterH = 318 Then
            ObenLang102Lok3()
        End If
        If Kontakt.Modul = 1 And Kontakt.Adresse = 7 And Kontakt.status = False And AutomatikParameter = 305 Then
            ObenLang103Lok3()
        End If
        If Kontakt.Modul = 0 And Kontakt.Adresse = 4 And Kontakt.status = True And AutomatikParameter = 306 Then
            ObenLang104Lok3()
        End If
        If Kontakt.Modul = 1 And Kontakt.Adresse = 3 And Kontakt.status = True And AutomatikParameter = 307 Then
            ObenLang105Lok3()
        End If
    End Sub
    Private Sub ObenLangLok4(Kontakt)
        If Kontakt.Modul = 1 And Kontakt.Adresse = 4 And Kontakt.status = True And AutomatikParameter = 417 And _AutomatikParameterH <> 418 Then
            ObenLang101Lok4()
        End If
        If Kontakt.Modul = 1 And Kontakt.Adresse = 5 And Kontakt.status = True And _AutomatikParameterH = 418 Then
            ObenLang102Lok4()
        End If
        If Kontakt.Modul = 1 And Kontakt.Adresse = 5 And Kontakt.status = False And AutomatikParameter = 405 Then
            ObenLang103Lok4()
        End If
        If Kontakt.Modul = 0 And Kontakt.Adresse = 4 And Kontakt.status = True And AutomatikParameter = 406 Then
            ObenLang104Lok4()
        End If
        If Kontakt.Modul = 1 And Kontakt.Adresse = 3 And Kontakt.status = True And AutomatikParameter = 407 Then
            ObenLang105Lok4()
        End If
    End Sub

    Private Sub BergfahrtLok1(ByVal Kontakt As Klassen.Kontakt)
        ' ***
        ' *** Bergfahrt
        ' *** Datum: 04.01.2020
        ' ***
        Dim Stufe1, Stufe3, Stufe4 As Integer

        If Kontakt.Modul = 1 And Kontakt.Adresse = 2 And Kontakt.status = True And AutomatikParameter = 110 Then
            Bergfahrt110Lok1()
        End If
        If Kontakt.Modul = 3 And Kontakt.Adresse = 1 And Kontakt.status = True And AutomatikParameter = 111 Then
            If _Kamera = 3 And _aktuelleKamera <> Windeck Then
                _Webcams.SetWebcam(0, Windeck)
                SetText(Button13, "Titisee")
                _aktuelleKamera = Windeck
            End If
            Zug1(220)
            AutomatikParameter = 112
        End If
        If Kontakt.Modul = 3 And Kontakt.Adresse = 7 And Kontakt.status = True And AutomatikParameter = 112 Then
            Zug1(240)
            AutomatikParameter = 112
        End If
        If Kontakt.Modul = 3 And Kontakt.Adresse = 3 And Kontakt.status = True And AutomatikParameter = 112 Then
            '_LokStufen.EinzelLokSenden(1, 3)
            Zug1(260)
            AutomatikParameter = 113
        End If
        If Kontakt.Modul = 3 And Kontakt.Adresse = 4 And Kontakt.status = True And AutomatikParameter = 113 Then
            Ort_Lok1 = 112
            A_StopH = 0
            _StopZug1 = _Berg_Gleis1
            AutomatikParameter = 114
            If _Berg_Gleis1 = 1 Or _Berg_Gleis1 = 2 Then
                A_StopB = 1
                If _Berg_Gleis1 = 1 Then
                    Zug1(500)
                Else
                    Zug1(bremsen)
                End If
                Button61.BackColor = Drawing.Color.Red
                'Timer_EinzelLok1.Interval = NumericUpDown1.Value * 1000
                Timer_EinzelLok1.Interval = Warte1BA
                Timer_EinzelLok1.Start()
            End If
        End If
        If Kontakt.Modul = 3 And Kontakt.Adresse = 4 And Kontakt.status = False And AutomatikParameter = 114 Then
            If _StopZug1 = 1 Then
                ZindelsteinLok1()
            End If
        End If
        If Kontakt.Modul = 3 And Kontakt.Adresse = 5 And Kontakt.status = True And (AutomatikParameter = 114 Or AutomatikParameter = 115) Then
            AutomatikParameter = 115
            If _StopZug1 > 0 Then
                StopZug1()
            Else
                Zug1(600)
            End If
        End If
        If Kontakt.Modul = 3 And Kontakt.Adresse = 5 And Kontakt.status = False And AutomatikParameter = 115 And _StopZug1 = 0 Then
            AutomatikParameter = 115

            Stufe1 = _LokStufen.Holen(NumericUpDown8.Value, 1)
            Stufe3 = _LokStufen.Holen(NumericUpDown8.Value, 3)
            Stufe4 = _LokStufen.Holen(NumericUpDown8.Value, 4)
            If Stufe4 < Stufe3 Then
                _LokStufen.EinzelLokSenden(1, 4)
            Else
                _LokStufen.EinzelLokSenden(1, 3)
            End If
            If NumericUpDown8.Value = 78 Then
                _eb.lokSteuern(78, Klassen.LokEigenschaften.Geschwindigkeit, Stufe1 + 1)
            End If
        End If
        If Kontakt.Modul = 3 And Kontakt.Adresse = 7 And Kontakt.status = True And AutomatikParameter = 115 Then
            Zug1(620)
        End If
        If Kontakt.Modul = 3 And Kontakt.Adresse = 1 And Kontakt.status = True And AutomatikParameter = 115 Then
            If Talstrecke_Gleis1 > 0 Then
                _eb.weicheSchalten(12, Klassen.WeichenRichtung.rechts)
            End If
            If _Kamera = 3 And _aktuelleKamera <> Marxzel Then
                _Webcams.SetWebcam(0, Marxzel)
                SetText(Button13, "Wiehre")
                _aktuelleKamera = Marxzel
            End If
            Zug1(640)
            If ComboBox1.SelectedIndex = 4 Then
                _StoryPointer = 70
            End If
            AutomatikParameter = 116
        End If
        ' !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!! = 112 !!!!!
        If Kontakt.Modul = 1 And Kontakt.Adresse = 2 And Kontakt.status = True And (AutomatikParameter = 116 Or AutomatikParameter = 112) Then
            Bergfahrt112Lok1()
            Zug1(660)
            If ComboBox1.SelectedIndex = 4 Then
                _StoryPointer = 80
            End If
        End If
    End Sub
    Private Sub BergfahrtLok2(ByVal Kontakt As Klassen.Kontakt)
        ' ***
        ' *** Bergfahrt
        ' *** Datum: 04.01.2020
        ' ***
        Dim Stufe1, Stufe3, Stufe4 As Integer

        If Kontakt.Modul = 1 And Kontakt.Adresse = 2 And Kontakt.status = True And AutomatikParameter = 210 Then
            Bergfahrt110Lok2()
        End If
        If Kontakt.Modul = 3 And Kontakt.Adresse = 1 And Kontakt.status = True And AutomatikParameter = 211 Then
            If _Kamera = 3 And _aktuelleKamera <> Windeck Then
                _Webcams.SetWebcam(0, Windeck)
                SetText(Button13, "Titisee")
                _aktuelleKamera = Windeck
            End If
            Zug2(220)
            AutomatikParameter = 212
        End If
        If Kontakt.Modul = 3 And Kontakt.Adresse = 7 And Kontakt.status = True And AutomatikParameter = 212 Then
            Zug2(240)
            AutomatikParameter = 212
        End If
        If Kontakt.Modul = 3 And Kontakt.Adresse = 3 And Kontakt.status = True And AutomatikParameter = 212 Then
            '_LokStufen.EinzelLokSenden(2, 3)
            Zug2(260)
            AutomatikParameter = 213
        End If
        If Kontakt.Modul = 3 And Kontakt.Adresse = 4 And Kontakt.status = True And AutomatikParameter = 213 Then
            Ort_Lok2 = 212
            A_StopH = 0
            _StopZug2 = _Berg_Gleis2
            AutomatikParameter = 214
            If _Berg_Gleis2 = 1 Or _Berg_Gleis2 = 2 Then
                A_StopB = 1
                If _Berg_Gleis2 = 1 Then
                    Zug2(500)
                Else
                    Zug2(bremsen)
                End If
                Button62.BackColor = Drawing.Color.Red
                Timer_EinzelLok2.Interval = Warte2BA
                'Timer_EinzelLok2.Interval = NumericUpDown2.Value * 1000
                Timer_EinzelLok2.Start()
            End If
        End If
        If Kontakt.Modul = 3 And Kontakt.Adresse = 4 And Kontakt.status = False And AutomatikParameter = 214 Then
            If _StopZug2 = 1 Then
                ZindelsteinLok2()
            End If
        End If
        If Kontakt.Modul = 3 And Kontakt.Adresse = 5 And Kontakt.status = True And (AutomatikParameter = 214 Or AutomatikParameter = 215) Then
            AutomatikParameter = 215
            If _StopZug2 > 0 Then
                StopZug2()
            Else
                Zug2(600)
            End If
            If ComboBox1.SelectedIndex = 4 Then
                _StoryPointer = 51
            End If
        End If
        If Kontakt.Modul = 3 And Kontakt.Adresse = 5 And Kontakt.status = False And AutomatikParameter = 215 And _StopZug2 = 0 Then
            AutomatikParameter = 215

            Stufe1 = _LokStufen.Holen(NumericUpDown9.Value, 1)
            Stufe3 = _LokStufen.Holen(NumericUpDown9.Value, 3)
            Stufe4 = _LokStufen.Holen(NumericUpDown9.Value, 4)
            If Stufe4 < Stufe3 Then
                _LokStufen.EinzelLokSenden(2, 4)
            Else
                _LokStufen.EinzelLokSenden(2, 3)
            End If
            If NumericUpDown9.Value = 78 Then
                _eb.lokSteuern(78, Klassen.LokEigenschaften.Geschwindigkeit, Stufe1 + 1)
            End If
        End If
        If Kontakt.Modul = 3 And Kontakt.Adresse = 7 And Kontakt.status = True And AutomatikParameter = 215 Then
            Zug2(620)
        End If
        If Kontakt.Modul = 3 And Kontakt.Adresse = 1 And Kontakt.status = True And AutomatikParameter = 215 Then
            If Talstrecke_Gleis2 > 0 Then
                _eb.weicheSchalten(12, Klassen.WeichenRichtung.rechts)
            End If
            If _Kamera = 3 And _aktuelleKamera <> Marxzel Then
                _Webcams.SetWebcam(0, Marxzel)
                SetText(Button13, "Wiehre")
                _aktuelleKamera = Marxzel
            End If
            Zug2(640)
            If ComboBox1.SelectedIndex = 4 Then
                _StoryPointer = 70
                'Timer_Story_DMX.Interval() = 100
                'Timer_Story_DMX.Start()
            End If
            AutomatikParameter = 216
        End If
        ' !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!! = 212 !!!!!
        If Kontakt.Modul = 1 And Kontakt.Adresse = 2 And Kontakt.status = True And (AutomatikParameter = 216 Or AutomatikParameter = 212) Then
            Bergfahrt112Lok2()
            Zug2(660)
            If ComboBox1.SelectedIndex = 4 Then
                _StoryPointer = 80
                'Timer_Story_DMX.Interval() = 100
                'Timer_Story_DMX.Start()
            End If
        End If
    End Sub
    Private Sub BergfahrtLok3(ByVal Kontakt As Klassen.Kontakt)
        ' ***
        ' *** Bergfahrt
        ' *** Datum: 04.01.2020
        ' ***
        Dim Stufe1, Stufe3, Stufe4 As Integer

        If Kontakt.Modul = 1 And Kontakt.Adresse = 2 And Kontakt.status = True And AutomatikParameter = 301 Then
            Bergfahrt110Lok3()
        End If
        If Kontakt.Modul = 3 And Kontakt.Adresse = 1 And Kontakt.status = True And AutomatikParameter = 311 Then
            If _Kamera = 3 And _aktuelleKamera <> Windeck Then
                _Webcams.SetWebcam(0, Windeck)
                SetText(Button13, "Titisee")
                _aktuelleKamera = Windeck
            End If
            Zug3(220)
            AutomatikParameter = 312
        End If
        If Kontakt.Modul = 3 And Kontakt.Adresse = 7 And Kontakt.status = True And AutomatikParameter = 312 Then
            Zug3(240)
            AutomatikParameter = 312
        End If
        If Kontakt.Modul = 3 And Kontakt.Adresse = 3 And Kontakt.status = True And AutomatikParameter = 312 Then
            Zug3(260)
            AutomatikParameter = 313
        End If
        If Kontakt.Modul = 3 And Kontakt.Adresse = 4 And Kontakt.status = True And AutomatikParameter = 313 Then
            Ort_Lok3 = 312
            A_StopH = 0
            _StopZug3 = _Berg_Gleis3
            AutomatikParameter = 314
            If _Berg_Gleis3 = 1 Or _Berg_Gleis3 = 2 Then
                A_StopB = 1
                If _Berg_Gleis3 = 1 Then
                    Zug3(500)
                Else
                    Zug3(bremsen)
                End If
                Button63.BackColor = Drawing.Color.Red
                'Timer_EinzelLok3.Interval = NumericUpDown3.Value * 1000
                Timer_EinzelLok3.Interval = Warte3BA
                Timer_EinzelLok3.Start()
            End If
        End If
        If Kontakt.Modul = 3 And Kontakt.Adresse = 4 And Kontakt.status = False And AutomatikParameter = 314 Then
            If _StopZug3 = 1 Then
                ZindelsteinLok3()
            End If
        End If
        If Kontakt.Modul = 3 And Kontakt.Adresse = 5 And Kontakt.status = True And (AutomatikParameter = 314 Or AutomatikParameter = 315) Then
            AutomatikParameter = 315
            If _StopZug3 > 0 Then
                StopZug3()
            Else
                Zug3(600)
            End If
        End If
        If Kontakt.Modul = 3 And Kontakt.Adresse = 5 And Kontakt.status = False And AutomatikParameter = 315 And _StopZug3 = 0 Then
            AutomatikParameter = 315

            Stufe1 = _LokStufen.Holen(NumericUpDown10.Value, 1)
            Stufe3 = _LokStufen.Holen(NumericUpDown10.Value, 3)
            Stufe4 = _LokStufen.Holen(NumericUpDown10.Value, 4)
            If Stufe4 < Stufe3 Then
                _LokStufen.EinzelLokSenden(3, 4)
            Else
                _LokStufen.EinzelLokSenden(3, 3)
            End If
            If NumericUpDown10.Value = 78 Then
                _eb.lokSteuern(78, Klassen.LokEigenschaften.Geschwindigkeit, Stufe1 + 1)
            End If
        End If
        If Kontakt.Modul = 3 And Kontakt.Adresse = 7 And Kontakt.status = True And AutomatikParameter = 315 Then
            Zug3(620)
        End If
        If Kontakt.Modul = 3 And Kontakt.Adresse = 1 And Kontakt.status = True And AutomatikParameter = 315 Then
            If Talstrecke_Gleis3 > 0 Then
                _eb.weicheSchalten(12, Klassen.WeichenRichtung.rechts)
            End If
            If _Kamera = 3 And _aktuelleKamera <> Marxzel Then
                _Webcams.SetWebcam(0, Marxzel)
                SetText(Button13, "Wiehre")
                _aktuelleKamera = Marxzel
            End If
            Zug3(640)
            If ComboBox1.SelectedIndex = 4 Then
                _StoryPointer = 70
                'Timer_Story_DMX.Interval() = 100
                'Timer_Story_DMX.Start()
            End If
            AutomatikParameter = 316
        End If
        ' !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!! = 312 !!!!!
        If Kontakt.Modul = 1 And Kontakt.Adresse = 2 And Kontakt.status = True And (AutomatikParameter = 316 Or AutomatikParameter = 312) Then
            Bergfahrt112Lok3()
            Zug3(660)
            If ComboBox1.SelectedIndex = 4 Then
                _StoryPointer = 80
                'Timer_Story_DMX.Interval() = 100
                'Timer_Story_DMX.Start()
            End If
        End If
    End Sub
    Private Sub BergfahrtLok4(ByVal Kontakt As Klassen.Kontakt)
        ' ***
        ' *** Bergfahrt
        ' *** Datum: 04.01.2020
        ' ***
        Dim Stufe1, Stufe3, Stufe4 As Integer

        If Kontakt.Modul = 1 And Kontakt.Adresse = 2 And Kontakt.status = True And AutomatikParameter = 401 Then
            Bergfahrt110Lok4()
        End If
        If Kontakt.Modul = 3 And Kontakt.Adresse = 1 And Kontakt.status = True And AutomatikParameter = 411 Then
            If _Kamera = 3 And _aktuelleKamera <> Windeck Then
                _Webcams.SetWebcam(0, Windeck)
                SetText(Button13, "Titisee")
                _aktuelleKamera = Windeck
            End If
            Zug4(220)
            AutomatikParameter = 412
        End If
        If Kontakt.Modul = 3 And Kontakt.Adresse = 7 And Kontakt.status = True And AutomatikParameter = 412 Then
            Zug4(240)
            AutomatikParameter = 412
        End If
        If Kontakt.Modul = 3 And Kontakt.Adresse = 3 And Kontakt.status = True And AutomatikParameter = 412 Then
            Zug4(260)
            AutomatikParameter = 413
        End If
        If Kontakt.Modul = 3 And Kontakt.Adresse = 4 And Kontakt.status = True And AutomatikParameter = 413 Then
            Ort_Lok4 = 412
            A_StopH = 0
            _StopZug4 = _Berg_Gleis4
            AutomatikParameter = 414
            If _Berg_Gleis4 = 1 Or _Berg_Gleis4 = 2 Then
                A_StopB = 1
                If _Berg_Gleis4 = 1 Then
                    Zug4(500)
                Else
                    Zug4(bremsen)
                End If
                Button64.BackColor = Drawing.Color.Red
                Timer_EinzelLok4.Interval = Warte4BA
                Timer_EinzelLok4.Start()
            End If
        End If
        If Kontakt.Modul = 3 And Kontakt.Adresse = 4 And Kontakt.status = False And AutomatikParameter = 414 Then
            If _StopZug4 = 1 Then
                ZindelsteinLok4()
            End If
        End If
        If Kontakt.Modul = 3 And Kontakt.Adresse = 5 And Kontakt.status = True And (AutomatikParameter = 414 Or AutomatikParameter = 415) Then
            AutomatikParameter = 415
            If _StopZug4 > 0 Then
                StopZug4()
            Else
                Zug4(600)
            End If
        End If
        If Kontakt.Modul = 3 And Kontakt.Adresse = 5 And Kontakt.status = False And AutomatikParameter = 415 And _StopZug4 = 0 Then
            AutomatikParameter = 415
            Stufe1 = _LokStufen.Holen(NumericUpDown11.Value, 1)
            Stufe3 = _LokStufen.Holen(NumericUpDown11.Value, 3)
            Stufe4 = _LokStufen.Holen(NumericUpDown11.Value, 4)
            If Stufe4 < Stufe3 Then
                _LokStufen.EinzelLokSenden(4, 4)
            Else
                _LokStufen.EinzelLokSenden(4, 3)
            End If
            If NumericUpDown11.Value = 78 Then
                _eb.lokSteuern(78, Klassen.LokEigenschaften.Geschwindigkeit, Stufe1 + 1)
            End If
        End If
        If Kontakt.Modul = 3 And Kontakt.Adresse = 7 And Kontakt.status = True And AutomatikParameter = 415 Then
            Zug4(620)
        End If
        If Kontakt.Modul = 3 And Kontakt.Adresse = 1 And Kontakt.status = True And AutomatikParameter = 415 Then
            If Talstrecke_Gleis4 > 0 Then
                _eb.weicheSchalten(12, Klassen.WeichenRichtung.rechts)
            End If
            If _Kamera = 3 And _aktuelleKamera <> Marxzel Then
                _Webcams.SetWebcam(0, Marxzel)
                SetText(Button13, "Wiehre")
                _aktuelleKamera = Marxzel
            End If
            Zug4(640)
            AutomatikParameter = 416
            DMX_Pointer = 70
        End If
        ' !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!! = 412 !!!!!
        If Kontakt.Modul = 1 And Kontakt.Adresse = 2 And Kontakt.status = True And (AutomatikParameter = 416 Or AutomatikParameter = 499) Then
            Bergfahrt112Lok4()
            Zug4(660)
            DMX_Pointer = 80
        End If
    End Sub

    Private Sub StopStart120Lok(StopLok As Integer, StartLok As Integer)
        If StopLok = 1 Then
            AutomatikParameter = 121
            If _Kurzzug1 = True Then
                Zug1(bremsen_kurz_von_rechts)
            Else
                Zug1(bremsen)
                AutomatikParameter = 121
            End If
            If StartLok = 1 Then
                Timer_EinzelLok1.Interval = NumericUpDown1.Value * 1000
                If Ort_Lok1 = 0 Then
                    Button31.BackColor = Drawing.Color.Red
                    Timer_EinzelLok1.Interval = Warte1A1
                ElseIf Ort_Lok1 = 100 Then
                    Button31.BackColor = Drawing.Color.Red
                    Timer_EinzelLok1.Interval = Warte1A1
                ElseIf Ort_Lok1 = 102 Then
                    AutomatikParameter = Ort_Lok1
                    Button51.BackColor = Drawing.Color.Red
                    Timer_EinzelLok1.Interval = Warte1SB
                ElseIf Ort_Lok1 = 105 Then
                    AutomatikParameter = Ort_Lok1
                    Button71.BackColor = Drawing.Color.Red
                    Timer_EinzelLok1.Interval = Warte1A2
                ElseIf Ort_Lok1 = 112 Then
                    AutomatikParameter = Ort_Lok1
                    Button61.BackColor = Drawing.Color.Red
                    Timer_EinzelLok1.Interval = Warte1BA
                End If
                If Ort_Lok1 = 102 And _Route_Gleis1 = 0 Then
                    AutomatikParameter = 120
                Else
                    AutomatikParameter = Ort_Lok1
                End If
                Timer_EinzelLok1.Start()
            ElseIf StartLok = 2 Then
                Timer_EinzelLok2.Interval = NumericUpDown2.Value * 1000
                If Ort_Lok2 = 0 Then
                    Button32.BackColor = Drawing.Color.Red
                    Timer_EinzelLok2.Interval = Warte2A1
                ElseIf Ort_Lok2 = 200 Then
                    Button32.BackColor = Drawing.Color.Red
                    Timer_EinzelLok2.Interval = Warte2A1
                ElseIf Ort_Lok2 = 202 Then
                    AutomatikParameter = Ort_Lok2
                    Button52.BackColor = Drawing.Color.Red
                    Timer_EinzelLok2.Interval = Warte2SB
                ElseIf Ort_Lok2 = 205 Then
                    AutomatikParameter = Ort_Lok2
                    Button72.BackColor = Drawing.Color.Red
                    Timer_EinzelLok2.Interval = Warte2A2
                ElseIf Ort_Lok2 = 212 Then
                    AutomatikParameter = Ort_Lok2
                    Button62.BackColor = Drawing.Color.Red
                    Timer_EinzelLok2.Interval = Warte2BA
                End If
                If Ort_Lok2 = 202 And _Route_Gleis2 = 0 Then
                    AutomatikParameter = 220
                Else
                    AutomatikParameter = Ort_Lok2
                End If
                Timer_EinzelLok2.Start()
            ElseIf StartLok = 3 Then
                Timer_EinzelLok3.Interval = NumericUpDown3.Value * 1000
                If Ort_Lok3 = 0 Then
                    Button33.BackColor = Drawing.Color.Red
                    Timer_EinzelLok3.Interval = Warte3A1
                ElseIf Ort_Lok3 = 300 Then
                    Button33.BackColor = Drawing.Color.Red
                    Timer_EinzelLok3.Interval = Warte3A1
                ElseIf Ort_Lok3 = 320 Then
                    AutomatikParameter = Ort_Lok3
                    Button53.BackColor = Drawing.Color.Red
                    Timer_EinzelLok3.Interval = Warte3SB
                ElseIf Ort_Lok3 = 315 Then
                    AutomatikParameter = Ort_Lok3
                    Button73.BackColor = Drawing.Color.Red
                    Timer_EinzelLok3.Interval = Warte3A2
                ElseIf Ort_Lok3 = 312 Then
                    AutomatikParameter = Ort_Lok3
                    Button63.BackColor = Drawing.Color.Red
                    Timer_EinzelLok3.Interval = Warte3BA
                End If
                AutomatikParameter = Ort_Lok3
                Timer_EinzelLok3.Start()
            ElseIf StartLok = 4 Then
                Timer_EinzelLok4.Interval = NumericUpDown4.Value * 1000
                If Ort_Lok4 = 0 Then
                    Button34.BackColor = Drawing.Color.Red
                    Timer_EinzelLok4.Interval = Warte4A1
                ElseIf Ort_Lok4 = 400 Then
                    Button34.BackColor = Drawing.Color.Red
                    Timer_EinzelLok4.Interval = Warte4A1
                ElseIf Ort_Lok4 = 420 Then
                    AutomatikParameter = Ort_Lok4
                    Button54.BackColor = Drawing.Color.Red
                    Timer_EinzelLok4.Interval = Warte4SB
                ElseIf Ort_Lok4 = 415 Then
                    AutomatikParameter = Ort_Lok4
                    Button74.BackColor = Drawing.Color.Red
                    Timer_EinzelLok4.Interval = Warte4A2
                ElseIf Ort_Lok4 = 412 Then
                    AutomatikParameter = Ort_Lok4
                    Button64.BackColor = Drawing.Color.Red
                    Timer_EinzelLok4.Interval = Warte4BA
                End If
                AutomatikParameter = Ort_Lok4
                Timer_EinzelLok4.Start()
            End If
        ElseIf StopLok = 2 Then
            AutomatikParameter = 221
            If _Kurzzug2 = True Then
                Zug2(bremsen_kurz_von_rechts)
            Else
                Zug2(bremsen)
                AutomatikParameter = 221
            End If
            If StartLok = 1 Then
                Timer_EinzelLok1.Interval = NumericUpDown1.Value * 1000
                If Ort_Lok1 = 0 Then
                    Button31.BackColor = Drawing.Color.Red
                    Timer_EinzelLok1.Interval = Warte1A1
                ElseIf Ort_Lok1 = 100 Then
                    Button31.BackColor = Drawing.Color.Red
                    Timer_EinzelLok1.Interval = Warte1A1
                ElseIf Ort_Lok1 = 102 Then
                    AutomatikParameter = Ort_Lok1
                    Button51.BackColor = Drawing.Color.Red
                    Timer_EinzelLok1.Interval = Warte1SB
                ElseIf Ort_Lok1 = 105 Then
                    AutomatikParameter = Ort_Lok1
                    Button71.BackColor = Drawing.Color.Red
                    Timer_EinzelLok1.Interval = Warte1A2
                ElseIf Ort_Lok1 = 112 Then
                    AutomatikParameter = Ort_Lok1
                    Button61.BackColor = Drawing.Color.Red
                    Timer_EinzelLok1.Interval = Warte1BA
                End If
                If Ort_Lok1 = 102 And _Route_Gleis1 = 0 Then
                    AutomatikParameter = 120
                Else
                    AutomatikParameter = Ort_Lok1
                End If
                Timer_EinzelLok1.Start()
            ElseIf StartLok = 2 Then
                Timer_EinzelLok2.Interval = NumericUpDown2.Value * 1000
                If Ort_Lok2 = 0 Then
                    Button32.BackColor = Drawing.Color.Red
                    Timer_EinzelLok2.Interval = Warte2A1
                ElseIf Ort_Lok2 = 200 Then
                    Button32.BackColor = Drawing.Color.Red
                    Timer_EinzelLok2.Interval = Warte2A1
                ElseIf Ort_Lok2 = 202 Then
                    AutomatikParameter = Ort_Lok2
                    Button52.BackColor = Drawing.Color.Red
                    Timer_EinzelLok2.Interval = Warte2SB
                ElseIf Ort_Lok2 = 205 Then
                    AutomatikParameter = Ort_Lok2
                    Button72.BackColor = Drawing.Color.Red
                    Timer_EinzelLok2.Interval = Warte2A2
                ElseIf Ort_Lok2 = 212 Then
                    AutomatikParameter = Ort_Lok2
                    Button62.BackColor = Drawing.Color.Red
                    Timer_EinzelLok2.Interval = Warte2BA
                End If
                If Ort_Lok2 = 202 And _Route_Gleis2 = 0 Then
                    AutomatikParameter = 220
                Else
                    AutomatikParameter = Ort_Lok2
                End If
                Timer_EinzelLok2.Start()
            ElseIf StartLok = 3 Then
                Timer_EinzelLok3.Interval = NumericUpDown3.Value * 1000
                If Ort_Lok3 = 0 Then
                    Button33.BackColor = Drawing.Color.Red
                    Timer_EinzelLok3.Interval = Warte3A1
                ElseIf Ort_Lok3 = 300 Then
                    Button33.BackColor = Drawing.Color.Red
                    Timer_EinzelLok3.Interval = Warte3A1
                ElseIf Ort_Lok3 = 320 Then
                    AutomatikParameter = Ort_Lok3
                    Button53.BackColor = Drawing.Color.Red
                    Timer_EinzelLok3.Interval = Warte3SB
                ElseIf Ort_Lok3 = 315 Then
                    AutomatikParameter = Ort_Lok3
                    Button73.BackColor = Drawing.Color.Red
                    Timer_EinzelLok3.Interval = Warte3A2
                ElseIf Ort_Lok3 = 312 Then
                    AutomatikParameter = Ort_Lok3
                    Button63.BackColor = Drawing.Color.Red
                    Timer_EinzelLok3.Interval = Warte3BA
                End If
                AutomatikParameter = Ort_Lok3
                Timer_EinzelLok3.Start()
            ElseIf StartLok = 4 Then
                Timer_EinzelLok4.Interval = NumericUpDown4.Value * 1000
                If Ort_Lok4 = 0 Then
                    Button34.BackColor = Drawing.Color.Red
                    Timer_EinzelLok4.Interval = Warte4A1
                ElseIf Ort_Lok4 = 400 Then
                    Button34.BackColor = Drawing.Color.Red
                    Timer_EinzelLok4.Interval = Warte4A1
                ElseIf Ort_Lok4 = 420 Then
                    AutomatikParameter = Ort_Lok4
                    Button54.BackColor = Drawing.Color.Red
                    Timer_EinzelLok4.Interval = Warte4SB
                ElseIf Ort_Lok4 = 415 Then
                    AutomatikParameter = Ort_Lok4
                    Button74.BackColor = Drawing.Color.Red
                    Timer_EinzelLok4.Interval = Warte4A2
                ElseIf Ort_Lok4 = 412 Then
                    AutomatikParameter = Ort_Lok4
                    Button64.BackColor = Drawing.Color.Red
                    Timer_EinzelLok4.Interval = Warte4BA
                End If
                AutomatikParameter = Ort_Lok4
                Timer_EinzelLok4.Start()
            End If
        ElseIf StopLok = 3 Then
            AutomatikParameter = 321
            If _Kurzzug3 = True Then
                Zug3(bremsen_kurz_von_links)
            Else
                Zug3(bremsen)
                AutomatikParameter = 321
            End If
            If StartLok = 1 Then
                Timer_EinzelLok1.Interval = NumericUpDown1.Value * 1000
                If Ort_Lok1 = 0 Then
                    Button31.BackColor = Drawing.Color.Red
                    Timer_EinzelLok1.Interval = Warte1A1
                ElseIf Ort_Lok1 = 100 Then
                    Button31.BackColor = Drawing.Color.Red
                    Timer_EinzelLok1.Interval = Warte1A1
                ElseIf Ort_Lok1 = 102 Then
                    AutomatikParameter = Ort_Lok1
                    Button51.BackColor = Drawing.Color.Red
                    Timer_EinzelLok1.Interval = Warte1SB
                ElseIf Ort_Lok1 = 105 Then
                    AutomatikParameter = Ort_Lok1
                    Button71.BackColor = Drawing.Color.Red
                    Timer_EinzelLok1.Interval = Warte1A2
                ElseIf Ort_Lok1 = 112 Then
                    AutomatikParameter = Ort_Lok1
                    Button61.BackColor = Drawing.Color.Red
                    Timer_EinzelLok1.Interval = Warte1BA
                End If
                If Ort_Lok1 = 102 And _Route_Gleis1 = 0 Then
                    AutomatikParameter = 120
                Else
                    AutomatikParameter = Ort_Lok1
                End If
                Timer_EinzelLok1.Interval = NumericUpDown1.Value * 1000
                Timer_EinzelLok1.Start()
            ElseIf StartLok = 2 Then
                Timer_EinzelLok2.Interval = NumericUpDown2.Value * 1000
                If Ort_Lok2 = 0 Then
                    Button32.BackColor = Drawing.Color.Red
                    Timer_EinzelLok2.Interval = Warte2A1
                ElseIf Ort_Lok2 = 200 Then
                    Button32.BackColor = Drawing.Color.Red
                    Timer_EinzelLok2.Interval = Warte2A1
                ElseIf Ort_Lok2 = 202 Then
                    AutomatikParameter = Ort_Lok2
                    Button52.BackColor = Drawing.Color.Red
                    Timer_EinzelLok2.Interval = Warte2SB
                ElseIf Ort_Lok2 = 205 Then
                    AutomatikParameter = Ort_Lok2
                    Button72.BackColor = Drawing.Color.Red
                    Timer_EinzelLok2.Interval = Warte2A2
                ElseIf Ort_Lok2 = 212 Then
                    AutomatikParameter = Ort_Lok2
                    Button62.BackColor = Drawing.Color.Red
                    Timer_EinzelLok2.Interval = Warte2BA
                End If
                If Ort_Lok2 = 202 And _Route_Gleis2 = 0 Then
                    AutomatikParameter = 220
                Else
                    AutomatikParameter = Ort_Lok2
                End If
                Timer_EinzelLok2.Start()
            ElseIf StartLok = 3 Then
                Timer_EinzelLok3.Interval = NumericUpDown3.Value * 1000
                If Ort_Lok3 = 0 Then
                    Button33.BackColor = Drawing.Color.Red
                    Timer_EinzelLok3.Interval = Warte3A1
                ElseIf Ort_Lok3 = 300 Then
                    Button33.BackColor = Drawing.Color.Red
                    Timer_EinzelLok3.Interval = Warte3A1
                ElseIf Ort_Lok3 = 320 Then
                    AutomatikParameter = Ort_Lok3
                    Button53.BackColor = Drawing.Color.Red
                    Timer_EinzelLok3.Interval = Warte3SB
                ElseIf Ort_Lok3 = 315 Then
                    AutomatikParameter = Ort_Lok3
                    Button73.BackColor = Drawing.Color.Red
                    Timer_EinzelLok3.Interval = Warte3A2
                ElseIf Ort_Lok3 = 312 Then
                    AutomatikParameter = Ort_Lok3
                    Button63.BackColor = Drawing.Color.Red
                    Timer_EinzelLok3.Interval = Warte3BA
                End If
                AutomatikParameter = Ort_Lok3
                Timer_EinzelLok3.Start()
            ElseIf StartLok = 4 Then
                Timer_EinzelLok4.Interval = NumericUpDown4.Value * 1000
                If Ort_Lok4 = 0 Then
                    Button34.BackColor = Drawing.Color.Red
                    Timer_EinzelLok4.Interval = Warte4A1
                ElseIf Ort_Lok4 = 400 Then
                    Button34.BackColor = Drawing.Color.Red
                    Timer_EinzelLok4.Interval = Warte4A1
                ElseIf Ort_Lok4 = 420 Then
                    AutomatikParameter = Ort_Lok4
                    Button54.BackColor = Drawing.Color.Red
                    Timer_EinzelLok4.Interval = Warte4SB
                ElseIf Ort_Lok4 = 415 Then
                    AutomatikParameter = Ort_Lok4
                    Button74.BackColor = Drawing.Color.Red
                    Timer_EinzelLok4.Interval = Warte4A2
                ElseIf Ort_Lok4 = 412 Then
                    AutomatikParameter = Ort_Lok4
                    Button64.BackColor = Drawing.Color.Red
                    Timer_EinzelLok4.Interval = Warte4BA
                End If
                AutomatikParameter = Ort_Lok4
                Timer_EinzelLok4.Start()
            End If
        ElseIf StopLok = 4 Then
            AutomatikParameter = 421
            If _Kurzzug4 = True Then
                Zug4(bremsen_kurz_von_links)
            Else
                Zug4(bremsen)
            End If
            If StartLok = 1 Then
                Timer_EinzelLok1.Interval = NumericUpDown1.Value * 1000
                If Ort_Lok1 = 0 Then
                    Button31.BackColor = Drawing.Color.Red
                    Timer_EinzelLok1.Interval = Warte1A1
                ElseIf Ort_Lok1 = 100 Then
                    Button31.BackColor = Drawing.Color.Red
                    Timer_EinzelLok1.Interval = Warte1A1
                ElseIf Ort_Lok1 = 102 Then
                    Button51.BackColor = Drawing.Color.Red
                    Timer_EinzelLok1.Interval = Warte1SB
                ElseIf Ort_Lok1 = 105 Then
                    Button71.BackColor = Drawing.Color.Red
                    Timer_EinzelLok1.Interval = Warte1A2
                ElseIf Ort_Lok1 = 112 Then
                    Button61.BackColor = Drawing.Color.Red
                    Timer_EinzelLok1.Interval = Warte1BA
                End If
                If Ort_Lok1 = 102 And _Route_Gleis1 = 0 Then
                    AutomatikParameter = 120
                Else
                    AutomatikParameter = Ort_Lok1
                End If
                Timer_EinzelLok1.Start()
            ElseIf StartLok = 2 Then
                Timer_EinzelLok2.Interval = NumericUpDown2.Value * 1000
                If Ort_Lok2 = 0 Then
                    Button32.BackColor = Drawing.Color.Red
                    Timer_EinzelLok2.Interval = Warte2A1
                ElseIf Ort_Lok2 = 200 Then
                    Button32.BackColor = Drawing.Color.Red
                    Timer_EinzelLok2.Interval = Warte2A1
                ElseIf Ort_Lok2 = 202 Then
                    Button52.BackColor = Drawing.Color.Red
                    Timer_EinzelLok2.Interval = Warte2SB
                ElseIf Ort_Lok2 = 205 Then
                    Button72.BackColor = Drawing.Color.Red
                    Timer_EinzelLok2.Interval = Warte2A2
                ElseIf Ort_Lok2 = 212 Then
                    Button62.BackColor = Drawing.Color.Red
                    Timer_EinzelLok2.Interval = Warte2BA
                End If
                If Ort_Lok2 = 202 And _Route_Gleis2 = 0 Then
                    AutomatikParameter = 220
                Else
                    AutomatikParameter = Ort_Lok1
                End If
                Timer_EinzelLok2.Start()
            ElseIf StartLok = 3 Then
                Timer_EinzelLok3.Interval = NumericUpDown3.Value * 1000
                If Ort_Lok3 = 0 Then
                    Button33.BackColor = Drawing.Color.Red
                    Timer_EinzelLok3.Interval = Warte3A1
                ElseIf Ort_Lok3 = 300 Then
                    Button33.BackColor = Drawing.Color.Red
                    Timer_EinzelLok3.Interval = Warte3A1
                ElseIf Ort_Lok3 = 320 Then
                    Button53.BackColor = Drawing.Color.Red
                    Timer_EinzelLok3.Interval = Warte3SB
                ElseIf Ort_Lok3 = 315 Then
                    Button73.BackColor = Drawing.Color.Red
                    Timer_EinzelLok3.Interval = Warte3A2
                ElseIf Ort_Lok3 = 312 Then
                    Button63.BackColor = Drawing.Color.Red
                    Timer_EinzelLok3.Interval = Warte3BA
                End If
                AutomatikParameter = Ort_Lok3
                Timer_EinzelLok3.Start()
            ElseIf StartLok = 4 Then
                Timer_EinzelLok4.Interval = NumericUpDown4.Value * 1000
                If Ort_Lok4 = 0 Then
                    Button34.BackColor = Drawing.Color.Red
                    Timer_EinzelLok4.Interval = Warte4A1
                ElseIf Ort_Lok4 = 400 Then
                    Button34.BackColor = Drawing.Color.Red
                    Timer_EinzelLok4.Interval = Warte4A1
                ElseIf Ort_Lok4 = 420 Then
                    Button54.BackColor = Drawing.Color.Red
                    Timer_EinzelLok4.Interval = Warte4SB
                ElseIf Ort_Lok4 = 415 Then
                    Button74.BackColor = Drawing.Color.Red
                    Timer_EinzelLok4.Interval = Warte4A2
                ElseIf Ort_Lok4 = 412 Then
                    Button64.BackColor = Drawing.Color.Red
                    Timer_EinzelLok4.Interval = Warte4BA
                End If
                AutomatikParameter = Ort_Lok4
                Timer_EinzelLok4.Start()
            End If
        End If
    End Sub
    Private Sub StopStart121Lok(StopLok As Integer, StartLok As Integer)
        If StopLok = 1 Then
            StopZug1()
            Zug1(abstellen)
        ElseIf StopLok = 2 Then
            StopZug2()
            Zug2(abstellen)
        ElseIf StopLok = 3 Then
            StopZug3()
            Zug3(abstellen)
        ElseIf StopLok = 4 Then
            StopZug4()
            Zug4(abstellen)
        End If
    End Sub

    Private Sub Zyklusende()
        If InvokeRequired Then
            BeginInvoke(Sub() Zyklusende())
        Else
            'Button42.BackColor = Drawing.Color.Yellow
            'Button41.BackColor = Drawing.Color.Yellow
            CheckBox1.Checked = False
            _Weichen_in_Startposition = False
            _Signale_in_Startposition = False
            _eb.weicheSchalten(2, Klassen.WeichenRichtung.rechts)
            _eb.weicheSchalten(4, Klassen.WeichenRichtung.rechts)
            _eb.weicheSchalten(5, Klassen.WeichenRichtung.rechts)
            _eb.weicheSchalten(7, Klassen.WeichenRichtung.rechts)
            PictureBox1.Visible = False
        End If
        AutomatikParameter = 0
        A_StopH = 0
    End Sub

#End Region

    ' *** Betriebsart 1: Züge fahren nur unten
    Private Sub Betriebsart1_Unten(Kontakt)
        If Betriebsart12 = 1 Then
            If Kontakt.Modul = 0 And Kontakt.Adresse = 0 And Kontakt.status = False And AutomatikParameter = 100 Then
                _LokStufen.EinzelLokSenden(1, 3)
                AutomatikParameter = 101
            End If
            If Kontakt.Modul = 0 And Kontakt.Adresse = 5 And Kontakt.status = True And AutomatikParameter = 101 Then
                AutomatikParameter = 102
            End If
            If Kontakt.Modul = 0 And Kontakt.Adresse = 1 And Kontakt.status = True And AutomatikParameter = 102 Then
                _LokStufen.EinzelLokSenden(1, 2)
                AutomatikParameter = 103
            End If
            If Kontakt.Modul = 0 And Kontakt.Adresse = 0 And Kontakt.status = True And AutomatikParameter = 103 Then
                Zug1(abstellen)
                AutomatikParameter = 125
                If A_Stop = 0 Then
                    Timer_EinzelLok1.Start()
                    Button31.BackColor = Drawing.Color.Red
                Else
                    Zyklusende()
                End If
            End If
        End If
        If Betriebsart12 = 2 Then
            If Kontakt.Modul = 0 And Kontakt.Adresse = 2 And Kontakt.status = False And AutomatikParameter = 200 Then
                _LokStufen.EinzelLokSenden(2, 3)
                AutomatikParameter = 201
            End If
            If Kontakt.Modul = 0 And Kontakt.Adresse = 5 And Kontakt.status = True And AutomatikParameter = 201 Then
                AutomatikParameter = 202
            End If
            If Kontakt.Modul = 0 And Kontakt.Adresse = 3 And Kontakt.status = True And AutomatikParameter = 202 Then
                _LokStufen.EinzelLokSenden(2, 2)
                AutomatikParameter = 203
            End If
            If Kontakt.Modul = 0 And Kontakt.Adresse = 2 And Kontakt.status = True And AutomatikParameter = 203 Then
                Zug2(abstellen)
                AutomatikParameter = 225
                If A_Stop = 0 Then
                    Timer_EinzelLok2.Start()
                    Button32.BackColor = Drawing.Color.Red
                Else
                    Zyklusende()
                End If
            End If
        End If
        If Betriebsart12 = 3 Then
            If Kontakt.Modul = 0 And Kontakt.Adresse = 0 And Kontakt.status = False And AutomatikParameter = 100 Then
                _LokStufen.EinzelLokSenden(1, 3)
                AutomatikParameter = 101
            End If
            If Kontakt.Modul = 0 And Kontakt.Adresse = 5 And Kontakt.status = True And AutomatikParameter = 101 Then
                AutomatikParameter = 102
            End If
            If Kontakt.Modul = 0 And Kontakt.Adresse = 1 And Kontakt.status = True And AutomatikParameter = 102 Then
                _LokStufen.EinzelLokSenden(1, 2)
                AutomatikParameter = 103
            End If
            If Kontakt.Modul = 0 And Kontakt.Adresse = 0 And Kontakt.status = True And AutomatikParameter = 103 Then
                Zug1(abstellen)
                _eb.weicheSchalten(21, Klassen.WeichenRichtung.links)
                _eb.weicheSchalten(19, Klassen.WeichenRichtung.rechts)
                AutomatikParameter = 225
                If A_Stop = 0 Then
                    Timer_EinzelLok2.Start()
                    Button32.BackColor = Drawing.Color.Red
                Else
                    Zyklusende()
                End If
            End If
            If Kontakt.Modul = 0 And Kontakt.Adresse = 2 And Kontakt.status = False And AutomatikParameter = 200 Then
                _LokStufen.EinzelLokSenden(2, 3)
                AutomatikParameter = 201
            End If
            If Kontakt.Modul = 0 And Kontakt.Adresse = 5 And Kontakt.status = True And AutomatikParameter = 201 Then
                AutomatikParameter = 202
            End If
            If Kontakt.Modul = 0 And Kontakt.Adresse = 3 And Kontakt.status = True And AutomatikParameter = 202 Then
                _LokStufen.EinzelLokSenden(2, 2)
                AutomatikParameter = 203
            End If
            If Kontakt.Modul = 0 And Kontakt.Adresse = 2 And Kontakt.status = True And AutomatikParameter = 203 Then
                Zug2(abstellen)
                _eb.weicheSchalten(21, Klassen.WeichenRichtung.rechts)
                _eb.weicheSchalten(19, Klassen.WeichenRichtung.links)
                AutomatikParameter = 125
                If A_Stop = 0 Then
                    Timer_EinzelLok1.Start()
                    Button31.BackColor = Drawing.Color.Red
                Else
                    Zyklusende()
                End If
            End If
        End If
        If Betriebsart34 = 3 Then
            If Kontakt.Modul = 1 And Kontakt.Adresse = 6 And Kontakt.status = False And AutomatikParameter1 = 300 Then
                _LokStufen.EinzelLokSenden(3, 3)
                AutomatikParameter1 = 301
            End If
            If Kontakt.Modul = 1 And Kontakt.Adresse = 3 And Kontakt.status = True And AutomatikParameter1 = 301 Then
                AutomatikParameter1 = 302
            End If
            If Kontakt.Modul = 1 And Kontakt.Adresse = 7 And Kontakt.status = True And AutomatikParameter1 = 302 Then
                _LokStufen.EinzelLokSenden(3, 2)
                AutomatikParameter1 = 303
            End If
            If Kontakt.Modul = 1 And Kontakt.Adresse = 6 And Kontakt.status = True And AutomatikParameter1 = 303 Then
                Zug3(abstellen)
                AutomatikParameter1 = 300
                If A_Stop = 0 Then
                    Timer_EinzelLok3.Start()
                    Button33.BackColor = Drawing.Color.Red
                Else
                    Zyklusende()
                End If
            End If
        End If
        If Betriebsart34 = 4 Then
            If Kontakt.Modul = 1 And Kontakt.Adresse = 4 And Kontakt.status = False And AutomatikParameter1 = 400 Then
                _LokStufen.EinzelLokSenden(4, 3)
                AutomatikParameter1 = 401
            End If
            If Kontakt.Modul = 1 And Kontakt.Adresse = 3 And Kontakt.status = True And AutomatikParameter1 = 401 Then
                AutomatikParameter1 = 402
            End If
            If Kontakt.Modul = 1 And Kontakt.Adresse = 5 And Kontakt.status = True And AutomatikParameter1 = 402 Then
                _LokStufen.EinzelLokSenden(4, 2)
                AutomatikParameter1 = 403
            End If
            If Kontakt.Modul = 1 And Kontakt.Adresse = 4 And Kontakt.status = True And AutomatikParameter1 = 403 Then
                Zug4(abstellen)
                AutomatikParameter1 = 400
                If A_Stop = 0 Then
                    Timer_EinzelLok4.Start()
                    Button34.BackColor = Drawing.Color.Red
                Else
                    Zyklusende()
                End If
            End If
        End If
        If Betriebsart34 = 5 Then
            If Kontakt.Modul = 1 And Kontakt.Adresse = 6 And Kontakt.status = False And AutomatikParameter1 = 300 Then
                _LokStufen.EinzelLokSenden(3, 3)
                AutomatikParameter1 = 301
            End If
            If Kontakt.Modul = 1 And Kontakt.Adresse = 3 And Kontakt.status = True And AutomatikParameter1 = 301 Then
                AutomatikParameter1 = 302
            End If
            If Kontakt.Modul = 1 And Kontakt.Adresse = 7 And Kontakt.status = True And AutomatikParameter1 = 302 Then
                _LokStufen.EinzelLokSenden(3, 2)
                AutomatikParameter1 = 303
            End If
            If Kontakt.Modul = 1 And Kontakt.Adresse = 6 And Kontakt.status = True And AutomatikParameter1 = 303 Then
                Zug3(abstellen)
                _eb.weicheSchalten(20, Klassen.WeichenRichtung.rechts)
                _eb.weicheSchalten(22, Klassen.WeichenRichtung.links)
                AutomatikParameter1 = 400
                If A_Stop = 0 Then
                    Timer_EinzelLok4.Start()
                    Button34.BackColor = Drawing.Color.Red
                Else
                    Zyklusende()
                End If
            End If
            If Kontakt.Modul = 1 And Kontakt.Adresse = 4 And Kontakt.status = False And AutomatikParameter1 = 400 Then
                _LokStufen.EinzelLokSenden(4, 3)
                AutomatikParameter1 = 401
            End If
            If Kontakt.Modul = 1 And Kontakt.Adresse = 3 And Kontakt.status = True And AutomatikParameter1 = 401 Then
                AutomatikParameter1 = 402
            End If
            If Kontakt.Modul = 1 And Kontakt.Adresse = 5 And Kontakt.status = True And AutomatikParameter1 = 402 Then
                _LokStufen.EinzelLokSenden(4, 2)
                AutomatikParameter1 = 403
            End If
            If Kontakt.Modul = 1 And Kontakt.Adresse = 4 And Kontakt.status = True And AutomatikParameter1 = 403 Then
                Zug4(abstellen)
                _eb.weicheSchalten(20, Klassen.WeichenRichtung.links)
                _eb.weicheSchalten(22, Klassen.WeichenRichtung.rechts)
                AutomatikParameter1 = 300
                If A_Stop = 0 Then
                    Timer_EinzelLok3.Start()
                    Button33.BackColor = Drawing.Color.Red
                Else
                    Zyklusende()
                End If
            End If

        End If
    End Sub

    ' *** Betriebsart 2: Koordinierter Betrieb zwischen innerem und äusserem Kreis
    Private Sub Betriebsart0_3(ByVal Kontakt As Klassen.Kontakt)
        ' ***
        ' *** Betriebsart 1/2=0 und ' *** Betriebsart 3/4=3
        ' ***
        ' *** Datum:          06.01.2023
        ' ***
        ' *** steuert die Fahrt des Zuges auf Gleis 3
        ' ***     
        ' ***
        ' ***
        ' ***
        ' *** Bahnhofsausfahrt Zug auf Gleis 3
        ' ***
        BahnhofsausfahrtLok3(Kontakt)

        If _Route_Gleis3 = 0 Then       ' *** Route "nur unten"

            NurUntenLok3(Kontakt)

        ElseIf _Route_Gleis3 = 1 Then  ' *** Route "oben kurz"

            BergfahrtLok3(Kontakt)
            ObenKurzLok3(Kontakt)

        ElseIf _Route_Gleis3 = 2 Then  ' *** Route "oben lang"

            BergfahrtLok3(Kontakt)
            ObenLangLok3(Kontakt)

        End If
        ' ***
        ' ***   Anhalten im Bahnhof
        ' ***
        If Kontakt.Modul = 1 And Kontakt.Adresse = 7 And Kontakt.status = True And AutomatikParameter = 320 Then
            Ort_Lok3 = 300
            _AutomatikParameterH = 321
            If A_Stop = 0 Then
                A_StopH = 0
                If _Bhf_Gleis3 = 0 Then
                    _StopZug3 = 0
                    AutomatikParameter = 321
                Else
                    _StopZug3 = 3
                    StopStart120Lok(3, 3)
                End If
            Else
                A_StopH = 1
                _StopZug3 = 3
                StopStart120Lok(3, 3)
            End If
        End If
        If Kontakt.Modul = 1 And Kontakt.Adresse = 6 And Kontakt.status = True And _AutomatikParameterH = 321 Then
            If _StopZug3 = 0 And A_StopH = 0 Then
                If _Route_Gleis3 = 0 Then
                    If _SBhf_Gleis3 > 0 Then
                        _eb.weicheSchalten(9, Klassen.WeichenRichtung.rechts)
                    End If
                End If
                If Weiche27schalten = True Then
                    _eb.weicheSchalten(27, Klassen.WeichenRichtung.rechts)
                End If
                AutomatikParameter = 300
            Else
                'Zug3(nachlauf)
                If _NachlaufZug3 = False Then
                    StopZug3()
                    Zug3(abstellen)
                Else
                    Zug3(nachlauf)
                End If
            End If
            _AutomatikParameterH = 0
        End If
    End Sub
    Private Sub Betriebsart0_3Var1(ByVal Kontakt As Klassen.Kontakt)
        ' ***
        ' *** Betriebsart 1/2=0 und ' *** Betriebsart 3/4=3
        ' ***
        ' *** Datum:          07.02.2021
        ' ***
        ' *** steuert die Fahrt des Zuges auf Gleis 3
        ' ***     
        ' ***
        ' ***

        ' ***
        ' *** Bahnhofsausfahrt Zug auf Gleis 3
        ' ***
        BahnhofsausfahrtLok3(Kontakt)

        BergfahrtLok3(Kontakt)
        If Kontakt.Modul = 1 And Kontakt.Adresse = 6 And Kontakt.status = True And AutomatikParameter = 317 And _AutomatikParameterH <> 318 Then
            ObenLang101Lok3()
        End If
        If Kontakt.Modul = 1 And Kontakt.Adresse = 7 And Kontakt.status = True And _AutomatikParameterH = 318 Then
            ObenLang102Lok3()
        End If
        If Kontakt.Modul = 1 And Kontakt.Adresse = 7 And Kontakt.status = False And AutomatikParameter = 305 Then
            ObenLang103Lok3()
        End If
        If Kontakt.Modul = 0 And Kontakt.Adresse = 5 And Kontakt.status = True And AutomatikParameter = 306 Then
            ObenLang104Lok3()
        End If
        If Kontakt.Modul = 0 And Kontakt.Adresse = 4 And Kontakt.status = True And AutomatikParameter = 307 Then
            'ObenLang105Lok3()
            AutomatikParameter = 320
            Ort_Lok3 = 320
        End If

        ' ***
        ' ***   Anhalten im Bahnhof
        ' ***
        If Kontakt.Modul = 1 And Kontakt.Adresse = 7 And Kontakt.status = True And AutomatikParameter = 320 Then
            Ort_Lok3 = 300
            _AutomatikParameterH = 321
            If A_Stop = 0 Then
                A_StopH = 0
                If _Bhf_Gleis3 = 0 Then
                    _StopZug3 = 0
                    AutomatikParameter = 321
                Else
                    _StopZug3 = 3
                    StopStart120Lok(3, 3)
                End If
            Else
                A_StopH = 1
                _StopZug3 = 3
                StopStart120Lok(3, 3)
            End If
        End If
        If Kontakt.Modul = 1 And Kontakt.Adresse = 6 And Kontakt.status = True And _AutomatikParameterH = 321 Then
            If _StopZug3 = 0 And A_StopH = 0 Then
                If _Route_Gleis3 = 0 Then
                    If _SBhf_Gleis3 > 0 Then
                        _eb.weicheSchalten(9, Klassen.WeichenRichtung.rechts)
                    End If
                End If
                If Weiche27schalten = True Then
                    _eb.weicheSchalten(27, Klassen.WeichenRichtung.rechts)
                End If
                AutomatikParameter = 300
            Else
                If _NachlaufZug3 = False Then
                    StopZug3()
                    Zug3(abstellen)
                Else
                    Zug3(nachlauf)
                End If
            End If
            _AutomatikParameterH = 0
        End If
    End Sub
    Private Sub Betriebsart0_4(ByVal Kontakt As Klassen.Kontakt)
        ' *** Betriebsart 1/2=0 und ' *** Betriebsart 3/4=4
        ' ***
        ' *** Datum:          07.02.2021
        ' ***                 Automatikparameter geändert
        ' ***
        ' *** steuert die Fahrt des Zuges auf Gleis 4
        ' *** 
        ' ***      
        ' ***

        ' ***
        ' *** Bahnhofsausfahrt Zug auf Gleis 4
        ' ***

        BahnhofsausfahrtLok4(Kontakt)

        If _Route_Gleis4 = 0 Then     ' *** Route "nur unten"

            NurUntenLok4(Kontakt)

        ElseIf _Route_Gleis4 = 1 Then ' *** Route "oben kurz"

            BergfahrtLok4(Kontakt)
            ObenKurzLok4(Kontakt)

        ElseIf _Route_Gleis4 = 2 Then ' *** Route "oben lang"

            BergfahrtLok4(Kontakt)
            ObenLangLok4(Kontakt)

        End If
        ' ***
        ' ***   Anhalten im Bahnhof
        ' ***
        If Kontakt.Modul = 1 And Kontakt.Adresse = 5 And Kontakt.status = True And AutomatikParameter = 420 Then
            Ort_Lok4 = 400
            _AutomatikParameterH = 421
            If A_Stop = 0 Then
                A_StopH = 0
                If _Bhf_Gleis4 = 0 Then
                    _StopZug4 = 0
                    AutomatikParameter = 421
                Else
                    _StopZug4 = 4
                    StopStart120Lok(4, 4)
                End If
            Else
                A_StopH = 1
                _StopZug4 = 4
                StopStart120Lok(4, 4)
            End If
        End If
        If Kontakt.Modul = 1 And Kontakt.Adresse = 4 And Kontakt.status = True And _AutomatikParameterH = 421 Then
            If _StopZug4 = 0 And A_StopH = 0 Then
                If _Route_Gleis4 = 0 Then
                    If _SBhf_Gleis4 > 0 Then
                        _eb.weicheSchalten(9, Klassen.WeichenRichtung.rechts)
                    End If
                End If
                If Weiche27schalten = True Then
                    _eb.weicheSchalten(27, Klassen.WeichenRichtung.rechts)
                End If
                AutomatikParameter = 400
            Else
                If _NachlaufZug4 = False Then
                    StopZug4()
                    Zug4(abstellen)
                Else
                    Zug4(nachlauf)
                End If
            End If
            _AutomatikParameterH = 0
        End If
    End Sub
    Private Sub Betriebsart0_4Var1(ByVal Kontakt As Klassen.Kontakt)
        ' ***
        ' *** Betriebsart 1/2=0 und ' *** Betriebsart 3/4=4
        ' ***
        ' *** Datum:          07.02.2021
        ' ***
        ' *** steuert die Fahrt des Zuges auf Gleis 4
        ' ***     
        ' ***
        ' ***
        ' ***
        ' *** Bahnhofsausfahrt Zug auf Gleis 4
        ' ***
        BahnhofsausfahrtLok4(Kontakt)

        BergfahrtLok4(Kontakt)
        If Kontakt.Modul = 1 And Kontakt.Adresse = 4 And Kontakt.status = True And AutomatikParameter = 417 And _AutomatikParameterH <> 418 Then
            ObenLang101Lok4()
        End If
        If Kontakt.Modul = 1 And Kontakt.Adresse = 5 And Kontakt.status = True And _AutomatikParameterH = 418 Then
            ObenLang102Lok4()
        End If
        If Kontakt.Modul = 1 And Kontakt.Adresse = 5 And Kontakt.status = False And AutomatikParameter = 405 Then
            ObenLang103Lok4()
        End If
        If Kontakt.Modul = 0 And Kontakt.Adresse = 5 And Kontakt.status = True And AutomatikParameter = 406 Then
            ObenLang104Lok4()
        End If
        If Kontakt.Modul = 0 And Kontakt.Adresse = 4 And Kontakt.status = True And AutomatikParameter = 407 Then
            'ObenLang105Lok4()
            AutomatikParameter = 420
            Ort_Lok4 = 420
        End If

        ' ***
        ' ***   Anhalten im Bahnhof
        ' ***
        If Kontakt.Modul = 1 And Kontakt.Adresse = 5 And Kontakt.status = True And AutomatikParameter = 420 Then
            Ort_Lok4 = 400
            _AutomatikParameterH = 421
            If A_Stop = 0 Then
                A_StopH = 0
                If _Bhf_Gleis4 = 0 Then
                    _StopZug4 = 0
                    AutomatikParameter = 421
                Else
                    _StopZug4 = 4
                    StopStart120Lok(4, 4)
                End If
            Else
                A_StopH = 1
                _StopZug3 = 3
                StopStart120Lok(4, 4)
            End If
        End If
        If Kontakt.Modul = 1 And Kontakt.Adresse = 4 And Kontakt.status = True And _AutomatikParameterH = 421 Then
            If _StopZug4 = 0 And A_StopH = 0 Then
                If _Route_Gleis4 = 0 Then
                    If _SBhf_Gleis4 > 0 Then
                        _eb.weicheSchalten(9, Klassen.WeichenRichtung.rechts)
                    End If
                End If
                If Weiche27schalten = True Then
                    _eb.weicheSchalten(27, Klassen.WeichenRichtung.rechts)
                End If
                AutomatikParameter = 400
            Else
                If _NachlaufZug3 = False Then
                    StopZug4()
                    Zug4(abstellen)
                Else
                    Zug4(nachlauf)
                End If
            End If
            _AutomatikParameterH = 0
        End If
    End Sub
    Private Sub Betriebsart0_4Var2(ByVal Kontakt As Klassen.Kontakt)
        ' ***
        ' *** Betriebsart 1/2=0 und ' *** Betriebsart 3/4=4
        ' ***
        ' *** Datum:          07.02.2021
        ' ***
        ' *** steuert die Fahrt des Zuges auf Gleis 4
        ' ***     
        ' ***
        ' ***
        ' ***
        ' *** Bahnhofsausfahrt Zug auf Gleis 4
        ' ***

        If Kontakt.Modul = 0 And Kontakt.Adresse = 5 And Kontakt.status = True And AutomatikParameter = 400 Then
            AutomatikParameter = 90
            Ort_Lok4 = 417
            If _Kamera = 3 And _aktuelleKamera <> Forbach Then
                Timer_Kamera0.Interval = 9000
                Timer_Kamera0.Start()
            End If
        End If
        If Kontakt.Modul = 0 And Kontakt.Adresse = 5 And Kontakt.status = False And AutomatikParameter = 400 Then
            AutomatikParameter = 90
            Ort_Lok4 = 417
            If _Kamera = 3 And _aktuelleKamera <> Forbach Then
                Timer_Kamera0.Interval = 9000
                Timer_Kamera0.Start()
            End If
        End If
        If Kontakt.Modul = 0 And Kontakt.Adresse = 5 And Kontakt.status = True And AutomatikParameter = 406 Then
            AutomatikParameter = 407
            Ort_Lok4 = 417
            If _SBhf_Gleis1 = 0 Then
                _eb.weicheSchalten(11, Klassen.WeichenRichtung.rechts)
                Button54.BackColor = Drawing.Color.Red
                Ort_Lok4 = 402
                AutomatikParameter = 420
                Timer_EinzelLok4.Interval = Warte4SB
                Timer_EinzelLok4.Start()
            End If

            If _Kamera = 3 And _aktuelleKamera <> Forbach Then
                Timer_Kamera0.Interval = 9000
                Timer_Kamera0.Start()
            End If
        End If
        If Kontakt.Modul = 0 And Kontakt.Adresse = 4 And Kontakt.status = True And AutomatikParameter = 407 Or AutomatikParameter = 90 Then
            AutomatikParameter = 420
            Ort_Lok4 = 420
        End If

        ' ***
        ' ***   Anhalten im Bahnhof
        ' ***
        If Kontakt.Modul = 1 And Kontakt.Adresse = 7 And Kontakt.status = True And AutomatikParameter = 420 Then
            Ort_Lok4 = 400
            _AutomatikParameterH = 421
            If A_Stop = 0 Then
                A_StopH = 0
                If _Bhf_Gleis4 = 0 Then
                    _StopZug4 = 0
                    AutomatikParameter = 421
                Else
                    _StopZug4 = 4
                    StopStart120Lok(4, 4)
                End If
            Else
                A_StopH = 1
                _StopZug3 = 3
                StopStart120Lok(4, 4)
            End If
        End If
        If Kontakt.Modul = 1 And Kontakt.Adresse = 6 And Kontakt.status = True And _AutomatikParameterH = 421 Then
            If _StopZug4 = 0 And A_StopH = 0 Then
                If _Route_Gleis4 = 0 Then
                    If _SBhf_Gleis4 > 0 Then
                        _eb.weicheSchalten(9, Klassen.WeichenRichtung.rechts)
                    End If
                End If
                If Weiche27schalten = True Then
                    _eb.weicheSchalten(27, Klassen.WeichenRichtung.rechts)
                End If
                AutomatikParameter = 400
            Else
                If _NachlaufZug3 = False Then
                    StopZug4()
                    Zug4(abstellen)
                Else
                    Zug4(nachlauf)
                End If
            End If
            _AutomatikParameterH = 0
        End If

        ' Bahnhofsausfahrt

        If Kontakt.Modul = 1 And Kontakt.Adresse = 6 And Kontakt.status = False And AutomatikParameter = 400 Then
            AutomatikParameter = 401
        End If

        BergfahrtLok4(Kontakt)

        If Kontakt.Modul = 1 And Kontakt.Adresse = 6 And Kontakt.status = True And AutomatikParameter = 417 And _AutomatikParameterH <> 418 Then
            Ort_Lok4 = 415
            A_StopH = 0
            If _Bhf2_Gleis4 = 0 Then       ' *** kein Halt
                If _SBhf_Gleis4 > 0 Then
                    _eb.weicheSchalten(11, Klassen.WeichenRichtung.rechts)
                Else
                    _eb.weicheSchalten(11, Klassen.WeichenRichtung.links)
                End If
                _LokStufen.EinzelLokSenden(4, 3)
                _StopZug4 = 0
                AutomatikParameter = 405
                _AutomatikParameterH = 418
            ElseIf _Bhf2_Gleis4 = 4 Then    ' *** Halt
                _StopZug4 = 4
                _AutomatikParameterH = 418
                If _Kurzzug4 = True Then
                    Zug4(bremsen_kurz_von_rechts)
                Else
                    Zug4(bremsen)
                End If
                Timer_EinzelLok4.Interval = NumericUpDown4.Value * 1000
                Timer_EinzelLok4.Start()
                Button74.BackColor = Drawing.Color.Red

            End If
        End If

        If Kontakt.Modul = 1 And Kontakt.Adresse = 7 And Kontakt.status = True And _AutomatikParameterH = 418 Then
            _AutomatikParameterH = 0
            AutomatikParameter = 405
            Ort_Lok4 = 415
            A_StopH = 0
            If _StopZug4 = 0 Then
                ' ***
                ' *** kein Halt
                ' ***
                If _SBhf_Gleis4 > 0 Then
                    _eb.weicheSchalten(11, Klassen.WeichenRichtung.rechts)
                Else
                    _eb.weicheSchalten(11, Klassen.WeichenRichtung.links)
                End If
                AutomatikParameter = 405
            ElseIf _StopZug4 = 4 Then    ' *** Halt
                If _SBhf_Gleis4 = 1 Or _SBhf_Gleis4 = 2 Then
                    _eb.weicheSchalten(11, Klassen.WeichenRichtung.rechts)
                End If
            End If
        End If

        If Kontakt.Modul = 1 And Kontakt.Adresse = 7 And Kontakt.status = False And AutomatikParameter = 405 Then
            ObenLang103Lok4()
        End If

    End Sub
    Private Sub Betriebsart0_5(ByVal Kontakt As Klassen.Kontakt)
        ' *** Betriebsart 1/2=0 und ' *** Betriebsart 3/4=5
        ' ***
        ' *** Datum:          19.01.2020
        ' ***
        ' *** steuert die Fahrt der Züge auf Gleis 3 und 4
        ' *** 
        ' ***
        ' ***

        ' ***
        ' *** Bahnhofsausfahrt Zug auf Gleis 3
        ' ***
        BahnhofsausfahrtLok3(Kontakt)


        If _Route_Gleis3 = 0 Then     ' *** Route "nur unten"

            NurUntenLok3(Kontakt)

        ElseIf _Route_Gleis3 = 1 Then ' *** Route "oben kurz"

            BergfahrtLok3(Kontakt)
            ObenKurzLok3(Kontakt)

        ElseIf _Route_Gleis3 = 2 Then ' *** Route "oben lang"

            BergfahrtLok3(Kontakt)
            ObenLangLok3(Kontakt)

        End If
        ' ***
        ' ***   Anhalten Lok3 im Bahnhof
        ' ***
        If Kontakt.Modul = 1 And Kontakt.Adresse = 7 And Kontakt.status = True And AutomatikParameter = 320 Then
            Ort_Lok3 = 300
            _AutomatikParameterH = 321
            If A_Stop = 0 Then
                A_StopH = 0
                If _Bhf_Gleis3 = 0 Then
                    _StopZug3 = 0
                    AutomatikParameter = 321
                ElseIf _Bhf_Gleis3 = 4 Then
                    _StopZug3 = 4
                    StopStart120Lok(3, 4)
                Else
                    _StopZug3 = 3
                    StopStart120Lok(3, 3)
                End If
            Else
                A_StopH = 1
                _StopZug3 = 3
                StopStart120Lok(3, 3)
            End If
        End If
        If Kontakt.Modul = 1 And Kontakt.Adresse = 6 And Kontakt.status = True And _AutomatikParameterH = 321 Then
            If _StopZug3 = 0 And A_StopH = 0 Then
                If _Route_Gleis3 = 0 Then
                    '*
                ElseIf _Route_Gleis3 = 1 Then
                    _eb.weicheSchalten(27, Klassen.WeichenRichtung.rechts)
                ElseIf _Route_Gleis3 = 2 Then
                    _eb.weicheSchalten(27, Klassen.WeichenRichtung.rechts)
                End If
                AutomatikParameter = 300
            Else
                If _NachlaufZug3 = False Then
                    StopZug3()
                    Zug3(abstellen)
                Else
                    Zug3(nachlauf)
                End If
            End If
            _AutomatikParameterH = 0
        End If


        BahnhofsausfahrtLok4(Kontakt)


        If _Route_Gleis4 = 0 Then     ' *** Route "nur unten"

            NurUntenLok4(Kontakt)

        ElseIf _Route_Gleis4 = 1 Then ' *** Route "oben kurz"

            BergfahrtLok4(Kontakt)
            ObenKurzLok4(Kontakt)


        ElseIf _Route_Gleis4 = 2 Then ' *** Route "oben lang"

            BergfahrtLok4(Kontakt)
            ObenLangLok4(Kontakt)

        End If
        ' ***
        ' ***   Anhalten im Bahnhof
        ' ***
        If Kontakt.Modul = 1 And Kontakt.Adresse = 5 And Kontakt.status = True And AutomatikParameter = 420 Then
            Ort_Lok4 = 400
            _AutomatikParameterH = 421
            If A_Stop = 0 Then
                A_StopH = 0
                If _Bhf_Gleis4 = 0 Then
                    _StopZug4 = 0
                    AutomatikParameter = 421
                ElseIf _Bhf_Gleis4 = 3 Then
                    _StopZug4 = 3
                    StopStart120Lok(4, 3)
                Else
                    _StopZug4 = 4
                    StopStart120Lok(4, 4)
                End If
            Else
                A_StopH = 1
                _StopZug4 = 4
                StopStart120Lok(4, 4)
            End If
        End If
        If Kontakt.Modul = 1 And Kontakt.Adresse = 4 And Kontakt.status = True And _AutomatikParameterH = 421 Then
            Ort_Lok4 = 400
            If _StopZug4 = 0 And A_StopH = 0 Then
                If _Route_Gleis4 = 0 Then
                    '*
                ElseIf _Route_Gleis4 = 1 Then
                    _eb.weicheSchalten(27, Klassen.WeichenRichtung.rechts)
                ElseIf _Route_Gleis4 = 2 Then
                    _eb.weicheSchalten(27, Klassen.WeichenRichtung.rechts)
                End If
                AutomatikParameter = 400
            Else
                If _NachlaufZug4 = False Then
                    StopZug4()
                    Zug4(abstellen)
                Else
                    Zug4(nachlauf)
                End If
            End If
            _AutomatikParameterH = 0
        End If
    End Sub
    Private Sub Betriebsart0_5Var1(ByVal Kontakt As Klassen.Kontakt)
        ' *** Betriebsart 1/2=0 und ' *** Betriebsart 3/4=5
        ' ***
        ' *** Datum:          19.01.2020
        ' ***
        ' *** steuert die Fahrt der Züge auf Gleis 3 und 4
        ' *** 
        ' ***
        ' ***

        ' ***
        ' *** Bahnhofsausfahrt Zug auf Gleis 3
        ' ***

        ' *** Bahnhofsausfahrt Lok3 und Lok4
        If Kontakt.Modul = 1 And Kontakt.Adresse = 6 And Kontakt.status = False And AutomatikParameter = 300 Then
            AutomatikParameter = 301
            Talstrecke_Gleis3 = 0
            Talstrecke_Gleis4 = 0
            ButtonsVisible(999)
        End If
        If Kontakt.Modul = 1 And Kontakt.Adresse = 4 And Kontakt.status = False And AutomatikParameter = 300 Then
            AutomatikParameter = 301
            Talstrecke_Gleis3 = 4
            Talstrecke_Gleis4 = 3
            Button83.Text = "Wechsel > 4"
            Button83.BackColor = Drawing.Color.LightYellow
            Button84.Text = "Wechsel > 3"
            Button84.BackColor = Drawing.Color.LightYellow
            Button93.Text = "Wechsel > 4"
            Button93.BackColor = Drawing.Color.LightYellow
            Button94.Text = "Wechsel > 3"
            Button94.BackColor = Drawing.Color.LightYellow
            Button53.Text = "Wechsel > 4"
            Button53.BackColor = Drawing.Color.LightYellow
            Button54.Text = "Wechsel > 3"
            Button54.BackColor = Drawing.Color.LightYellow
            ButtonsVisible(999)
        End If
        If Kontakt.Modul = 1 And Kontakt.Adresse = 4 And Kontakt.status = False And AutomatikParameter = 400 Then
            AutomatikParameter = 401
        End If

        BergfahrtLok3(Kontakt)
        BergfahrtLok4(Kontakt)

        If Kontakt.Modul = 1 And Kontakt.Adresse = 6 And Kontakt.status = True And AutomatikParameter = 317 And _AutomatikParameterH <> 318 Then
            ObenLang101Lok3()
        End If
        If Kontakt.Modul = 1 And Kontakt.Adresse = 7 And Kontakt.status = True And _AutomatikParameterH = 318 Then
            ObenLang102Lok3()
        End If
        If Kontakt.Modul = 1 And Kontakt.Adresse = 7 And Kontakt.status = False And AutomatikParameter = 305 Then
            If Talstrecke_Gleis3 = 0 Then
                AutomatikParameter = 91
            Else
                AutomatikParameter = 306
            End If
        End If


        If Kontakt.Modul = 1 And Kontakt.Adresse = 6 And Kontakt.status = True And AutomatikParameter = 417 And _AutomatikParameterH <> 418 Then
            ObenLang101Lok4()
        End If
        If Kontakt.Modul = 1 And Kontakt.Adresse = 7 And Kontakt.status = True And _AutomatikParameterH = 418 Then
            ObenLang102Lok4()
        End If
        If Kontakt.Modul = 1 And Kontakt.Adresse = 7 And Kontakt.status = False And AutomatikParameter = 405 Then
            AutomatikParameter = 406
        End If


        If Kontakt.Modul = 0 And Kontakt.Adresse = 5 And Kontakt.status = True And AutomatikParameter = 91 Then
            Ort_Lok1 = 302
            AutomatikParameter = 92
        End If
        If Kontakt.Modul = 0 And Kontakt.Adresse = 5 And Kontakt.status = True And AutomatikParameter = 306 Then
            Button84.BackColor = Drawing.Color.Red
            Timer_10.Interval = 3000
            Timer_10.Start()
            Ort_Lok3 = 301
            AutomatikParameter = 420
        End If
        If Kontakt.Modul = 0 And Kontakt.Adresse = 5 And Kontakt.status = True And AutomatikParameter = 406 Then
            Button83.BackColor = Drawing.Color.Red
            Timer_10.Interval = 3000
            Timer_10.Start()
            Ort_Lok4 = 401
            AutomatikParameter = 320
        End If


        If Kontakt.Modul = 0 And Kontakt.Adresse = 4 And Kontakt.status = True And AutomatikParameter = 92 Then
            _eb.weicheSchalten(11, Klassen.WeichenRichtung.rechts)
            Zug4(anfahren)
            Ort_Lok3 = 303
            AutomatikParameter = 400
        End If
        If Kontakt.Modul = 0 And Kontakt.Adresse = 4 And Kontakt.status = True And AutomatikParameter = 302 Then
            _eb.weicheSchalten(11, Klassen.WeichenRichtung.rechts)
            Button93.BackColor = Drawing.Color.Red
            Timer_12.Interval = 3000
            Timer_12.Start()
            Ort_Lok3 = 302
            AutomatikParameter = 417
        End If
        If Kontakt.Modul = 0 And Kontakt.Adresse = 4 And Kontakt.status = True And AutomatikParameter = 402 Then
            _eb.weicheSchalten(11, Klassen.WeichenRichtung.rechts)
            Button94.BackColor = Drawing.Color.Red
            Timer_12.Interval = 3000
            Timer_12.Start()
            Ort_Lok4 = 402
            AutomatikParameter = 317
        End If

        ' ***
        ' ***   Anhalten Lok3 im Bahnhof
        ' ***
        If Kontakt.Modul = 1 And Kontakt.Adresse = 5 And Kontakt.status = True And AutomatikParameter = 320 Then
            _eb.weicheSchalten(10, Klassen.WeichenRichtung.rechts)
            Ort_Lok3 = 300
            _AutomatikParameterH = 321
            If A_Stop = 0 Then
                A_StopH = 0
                If _Bhf_Gleis3 = 0 Then
                    _StopZug3 = 0
                    AutomatikParameter = 321
                ElseIf _Bhf_Gleis3 = 4 Then
                    _StopZug3 = 4
                    StopStart120Lok(3, 4)
                Else
                    _StopZug3 = 3
                    StopStart120Lok(3, 3)
                End If
            Else
                A_StopH = 1
                _StopZug3 = 3
                StopStart120Lok(3, 3)
            End If
        End If
        If Kontakt.Modul = 1 And Kontakt.Adresse = 4 And Kontakt.status = True And _AutomatikParameterH = 321 Then
            If _StopZug3 = 0 And A_StopH = 0 Then
                If _Route_Gleis3 = 0 Then
                    '*
                ElseIf _Route_Gleis3 = 1 Then
                    _eb.weicheSchalten(27, Klassen.WeichenRichtung.rechts)
                ElseIf _Route_Gleis3 = 2 Then
                    _eb.weicheSchalten(27, Klassen.WeichenRichtung.rechts)
                End If
                AutomatikParameter = 300
            Else
                If _NachlaufZug3 = False Then
                    StopZug3()
                    Zug3(abstellen)
                Else
                    Zug3(nachlauf)
                End If
            End If
            _AutomatikParameterH = 0
        End If


        ' ***
        ' ***   Anhalten im Bahnhof
        ' ***
        If Kontakt.Modul = 1 And Kontakt.Adresse = 5 And Kontakt.status = True And AutomatikParameter = 420 Then
            _eb.weicheSchalten(10, Klassen.WeichenRichtung.rechts)
            Ort_Lok4 = 400
            _AutomatikParameterH = 421
            If A_Stop = 0 Then
                A_StopH = 0
                If _Bhf_Gleis4 = 0 Then
                    _StopZug4 = 0
                    AutomatikParameter = 421
                ElseIf _Bhf_Gleis4 = 3 Then
                    _StopZug4 = 3
                    StopStart120Lok(4, 3)
                Else
                    _StopZug4 = 4
                    StopStart120Lok(4, 4)
                End If
            Else
                A_StopH = 1
                _StopZug4 = 4
                StopStart120Lok(4, 4)
            End If
        End If
        If Kontakt.Modul = 1 And Kontakt.Adresse = 4 And Kontakt.status = True And _AutomatikParameterH = 421 Then
            Ort_Lok4 = 400
            If _StopZug4 = 0 And A_StopH = 0 Then
                If _Route_Gleis4 = 0 Then
                    '*
                ElseIf _Route_Gleis4 = 1 Then
                    _eb.weicheSchalten(27, Klassen.WeichenRichtung.rechts)
                ElseIf _Route_Gleis4 = 2 Then
                    _eb.weicheSchalten(27, Klassen.WeichenRichtung.rechts)
                End If
                AutomatikParameter = 400
            Else
                If _NachlaufZug4 = False Then
                    StopZug4()
                    Zug4(abstellen)
                Else
                    Zug4(nachlauf)
                End If
            End If
            _AutomatikParameterH = 0
        End If
    End Sub
    Private Sub Betriebsart1_0(ByVal Kontakt As Klassen.Kontakt)
        ' *** Betriebsart 1/2=1 und ' *** Betriebsart 3/4=0
        ' ***
        ' *** Datum:          14.01.2020
        ' ***
        ' *** steuert die Fahrt des Zuges auf Gleis 1
        ' ***                
        ' ***                 _GleisFrei1 hinzugefügt  am 3.11.2019
        ' ***                       
        ' ***
        ' ***

        ' ***
        ' *** Bahnhofsausfahrt Zug auf Gleis 1
        ' ***

        BahnhofsausfahrtLok1(Kontakt)

        If _Route_Gleis1 = 0 Then     ' *** Route "nur unten"

            NurUntenLok1(Kontakt)

        ElseIf _Route_Gleis1 = 1 Then ' *** Route "oben kurz"

            ObenKurzLok1(Kontakt)
            BergfahrtLok1(Kontakt)

        ElseIf _Route_Gleis1 = 2 Then ' *** Route "oben lang"

            ObenLangLok1(Kontakt)
            BergfahrtLok1(Kontakt)

        End If
        ' ***
        ' *** Ankunft im Bahnhof
        ' ***
        If Kontakt.Modul = 0 And Kontakt.Adresse = 1 And Kontakt.status = True And AutomatikParameter = 120 Then
            Ort_Lok1 = 100
            _AutomatikParameterH = 121
            If A_Stop = 0 Then
                A_StopH = 0
                If _Bhf_Gleis1 = 0 Then
                    _StopZug1 = 0
                    AutomatikParameter = 121
                Else
                    _StopZug1 = 1
                    StopStart120Lok(1, 1)
                End If
            Else
                A_StopH = 1
                _StopZug1 = 1
                StopStart120Lok(1, 1)
            End If
        End If
        If Kontakt.Modul = 0 And Kontakt.Adresse = 0 And Kontakt.status = True And _AutomatikParameterH = 121 Then
            If _StopZug1 = 0 And A_StopH = 0 Then
                ' Weichen 17 und 27 müssen nicht geschaltet werden (Betriebsart12 = 1 und Betriebsart34 =0)
                AutomatikParameter = 100
            Else
                If _NachlaufZug1 = False Then
                    StopZug1()
                    Zug1(abstellen)
                Else
                    Zug1(nachlauf)
                End If
            End If
            _AutomatikParameterH = 0
        End If
    End Sub
    Private Sub Betriebsart1_0Var1(ByVal Kontakt As Klassen.Kontakt)
        ' *** Betriebsart 1/2=1 und ' *** Betriebsart 3/4=0
        ' ***
        ' *** Datum:          21.04.2025
        ' ***
        ' *** steuert die Fahrt des Zuges auf Gleis 1
        ' ***                
        ' ***                       
        ' ***
        ' ***

        ' ***
        ' *** Bahnhofsausfahrt Zug auf Gleis 1
        ' ***

        BahnhofsausfahrtLok1(Kontakt)

        If Kontakt.Modul = 0 And Kontakt.Adresse = 4 And Kontakt.status = True And AutomatikParameter = 101 Then
            'AutomatikParameter = 110
            Delay_Automatik_110.Interval = 9000
            Delay_Automatik_110.Start()
            Ort_Lok1 = 110
            If _Kamera = 3 And _aktuelleKamera <> Forbach Then
                Timer_Kamera0.Interval = 9000
                Timer_Kamera0.Start()
            End If
        End If
        If Kontakt.Modul = 0 And Kontakt.Adresse = 5 And Kontakt.status = True And AutomatikParameter = 110 Then
            AutomatikParameter = 103
            Ort_Lok1 = 111
        End If
        If Kontakt.Modul = 1 And Kontakt.Adresse = 7 And Kontakt.status = True And AutomatikParameter = 103 Then
            ObenLang103Lok1()
        End If
        If Kontakt.Modul = 1 And Kontakt.Adresse = 6 And Kontakt.status = True And _AutomatikParameterH = 104 Then
            ObenLang104Lok1()
        End If
        If Kontakt.Modul = 1 And Kontakt.Adresse = 6 And Kontakt.status = False And AutomatikParameter = 106 Then
            ObenLang105Lok1()
        End If
        BergfahrtLok1(Kontakt)
        'If _Route_Gleis1 = 0 Then     ' *** Route "nur unten"

        '    NurUntenLok1(Kontakt)

        'ElseIf _Route_Gleis1 = 1 Then ' *** Route "oben kurz"

        '    ObenKurzLok1(Kontakt)
        '    BergfahrtLok1(Kontakt)

        'ElseIf _Route_Gleis1 = 2 Then ' *** Route "oben lang"

        '    ObenLangLok1(Kontakt)
        '    BergfahrtLok1(Kontakt)

        'End If
        ' ***
        ' *** Ankunft im Bahnhof
        ' ***
        If Kontakt.Modul = 0 And Kontakt.Adresse = 1 And Kontakt.status = True And AutomatikParameter = 120 Then
            Ort_Lok1 = 100
            _AutomatikParameterH = 121
            If A_Stop = 0 Then
                A_StopH = 0
                If _Bhf_Gleis1 = 0 Then
                    _StopZug1 = 0
                    AutomatikParameter = 121
                Else
                    _StopZug1 = 1
                    StopStart120Lok(1, 1)
                End If
            Else
                A_StopH = 1
                _StopZug1 = 1
                StopStart120Lok(1, 1)
            End If
        End If
        If Kontakt.Modul = 0 And Kontakt.Adresse = 0 And Kontakt.status = True And _AutomatikParameterH = 121 Then
            If _StopZug1 = 0 And A_StopH = 0 Then
                ' Weichen 17 und 27 müssen nicht geschaltet werden (Betriebsart12 = 1 und Betriebsart34 =0)
                AutomatikParameter = 100
            Else
                If _NachlaufZug1 = False Then
                    StopZug1()
                    Zug1(abstellen)
                Else
                    Zug1(nachlauf)
                End If
            End If
            _AutomatikParameterH = 0
        End If
    End Sub
    Private Sub Betriebsart1_3(ByVal Kontakt As Klassen.Kontakt)

        ' *** Betriebsart 1/2=1 und ' *** Betriebsart 3/4=3
        ' ***
        ' *** Datum:          24.02.2021
        ' ***
        ' *** Kommentar allg. : kein
        ' ***                 
        ' *** 
        ' ***

        ' ***
        ' *** Bahnhofsausfahrt Zug auf Gleis 1
        ' ***

        BahnhofsausfahrtLok1(Kontakt)

        If _Route_Gleis1 = 0 Then     ' *** Route "nur unten"

            NurUntenLok1(Kontakt)

        ElseIf _Route_Gleis1 = 1 Then ' *** Route "oben kurz"

            ObenKurzLok1(Kontakt)
            BergfahrtLok1(Kontakt)

        ElseIf _Route_Gleis1 = 2 Then ' *** Route "oben lang"

            ObenLangLok1(Kontakt)
            BergfahrtLok1(Kontakt)

        End If
        ' ***
        ' *** Ankunft im Bahnhof
        ' ***
        If Kontakt.Modul = 0 And Kontakt.Adresse = 1 And Kontakt.status = True And AutomatikParameter = 120 Then
            Ort_Lok1 = 100
            _AutomatikParameterH = 121
            If A_Stop = 0 Then
                A_StopH = 0
                If _Bhf_Gleis1 = 0 Then
                    _StopZug1 = 0
                    AutomatikParameter = 121
                ElseIf _Bhf_Gleis1 = 3 Then
                    _StopZug1 = 3
                    StopStart120Lok(1, 3)
                Else
                    _StopZug1 = 1
                    StopStart120Lok(1, 1)
                End If
            Else
                A_StopH = 1
                _StopZug1 = 1
                StopStart120Lok(1, 1)
            End If
        End If
        If Kontakt.Modul = 0 And Kontakt.Adresse = 0 And Kontakt.status = True And _AutomatikParameterH = 121 Then
            If _StopZug1 = 0 And A_StopH = 0 Then
                If _Route_Gleis1 = 0 And _Route_Gleis3 = 0 Then
                    ' *** keine Aktion wenn beide Züge unten fahren
                Else
                    If _Route_Gleis1 = 0 Then
                        _eb.weicheSchalten(17, Klassen.WeichenRichtung.links)
                    ElseIf _Route_Gleis1 = 1 Then
                        _eb.weicheSchalten(17, Klassen.WeichenRichtung.rechts)
                        _eb.weicheSchalten(27, Klassen.WeichenRichtung.rechts)
                    ElseIf _Route_Gleis1 = 2 Then
                        _eb.weicheSchalten(17, Klassen.WeichenRichtung.links)
                    End If
                End If
                AutomatikParameter = 100
            Else
                If _NachlaufZug1 = False Then
                    StopZug1()
                    Zug1(abstellen)
                Else
                    Zug1(nachlauf)
                End If
            End If
            _AutomatikParameterH = 0
        End If

        ' ***
        ' *** Zug 3 Anfahren
        ' ***

        BahnhofsausfahrtLok3(Kontakt)

        If _Route_Gleis3 = 0 Then     ' *** Route "nur unten"

            NurUntenLok3(Kontakt)

        ElseIf _Route_Gleis3 = 1 Then ' *** Route "oben kurz"

            BergfahrtLok3(Kontakt)
            ObenKurzLok3(Kontakt)

        ElseIf _Route_Gleis3 = 2 Then  ' *** Route "oben lang"

            BergfahrtLok3(Kontakt)
            ObenLangLok3(Kontakt)

        End If
        ' ***
        ' *** Ankunft im Bahnhof
        ' ***
        If Kontakt.Modul = 1 And Kontakt.Adresse = 7 And Kontakt.status = True And AutomatikParameter = 320 Then
            Ort_Lok3 = 300
            _AutomatikParameterH = 321
            If A_Stop = 0 Then
                A_StopH = 0
                If _Bhf_Gleis3 = 0 Then
                    _StopZug3 = 0
                    AutomatikParameter = 321
                ElseIf _Bhf_Gleis3 = 1 Then
                    _StopZug3 = 1
                    StopStart120Lok(3, 1)
                Else
                    _StopZug3 = 3
                    StopStart120Lok(3, 3)
                End If
            Else
                A_StopH = 1
                _StopZug3 = 3
                StopStart120Lok(3, 3)
            End If
        End If
        If Kontakt.Modul = 1 And Kontakt.Adresse = 6 And Kontakt.status = True And _AutomatikParameterH = 321 Then
            If _StopZug3 = 0 And A_StopH = 0 Then
                If _Route_Gleis1 = 0 And _Route_Gleis3 = 0 Then
                    ' *** keine Aktion wenn beide Züge unten fahren
                Else
                    If _Route_Gleis3 = 0 Then
                        _eb.weicheSchalten(27, Klassen.WeichenRichtung.links)
                    ElseIf _Route_Gleis3 = 1 Then
                        _eb.weicheSchalten(27, Klassen.WeichenRichtung.rechts)
                    ElseIf _Route_Gleis3 = 2 Then
                        _eb.weicheSchalten(27, Klassen.WeichenRichtung.rechts)
                    End If
                End If
                AutomatikParameter = 300
            Else
                If _NachlaufZug3 = False Then
                    StopZug3()
                    Zug3(abstellen)
                Else
                    Zug3(nachlauf)
                End If
            End If
            _AutomatikParameterH = 0
        End If
    End Sub
    Private Sub Betriebsart1_4(ByVal Kontakt As Klassen.Kontakt)
        ' *** Betriebsart 1/2=1 und ' *** Betriebsart 3/4=4
        ' ***
        ' *** Datum:          14.01.2020
        ' ***
        ' *** Kommentar:      für einen Kurzzug im Bahnhof
        ' ***                 und einen Güterzug im Schattenbahnhof, der nicht im Bahnhof hält geeignet
        ' ***
        ' *** Datum:          31.12.2017
        ' ***
        ' ***
        ' ***

        ' ***
        ' *** Bahnhofsausfahrt Zug auf Gleis 1
        ' ***

        BahnhofsausfahrtLok1(Kontakt)

        If _Route_Gleis1 = 0 Then     ' *** Route "nur unten"

            NurUntenLok1(Kontakt)

        ElseIf _Route_Gleis1 = 1 Then ' *** Route "oben kurz"

            ObenKurzLok1(Kontakt)
            BergfahrtLok1(Kontakt)


        ElseIf _Route_Gleis1 = 2 Then ' *** Route "oben lang"

            ObenLangLok1(Kontakt)
            BergfahrtLok1(Kontakt)

        End If
        ' ***
        ' *** Ankunft im Bahnhof
        ' ***
        If Kontakt.Modul = 0 And Kontakt.Adresse = 1 And Kontakt.status = True And AutomatikParameter = 120 Then
            Ort_Lok1 = 100
            _AutomatikParameterH = 121
            If A_Stop = 0 Then
                A_StopH = 0
                If _Bhf_Gleis1 = 0 Then
                    _StopZug1 = 0
                    AutomatikParameter = 121
                ElseIf _Bhf_Gleis1 = 4 Then
                    _StopZug1 = 4
                    StopStart120Lok(1, 4)
                Else
                    _StopZug1 = 1
                    StopStart120Lok(1, 1)
                End If
            Else
                A_StopH = 1
                _StopZug1 = 1
                StopStart120Lok(1, 1)
            End If
        End If
        If Kontakt.Modul = 0 And Kontakt.Adresse = 0 And Kontakt.status = True And _AutomatikParameterH = 121 Then
            Ort_Lok1 = 100
            If _StopZug1 = 0 And A_StopH = 0 Then
                If _Route_Gleis1 = 0 And _Route_Gleis4 = 0 Then
                    ' *** keine Aktion wenn beide Züge unten fahren
                Else
                    If _Route_Gleis1 = 0 Then
                        _eb.weicheSchalten(17, Klassen.WeichenRichtung.links)
                    ElseIf _Route_Gleis1 = 1 Then
                        _eb.weicheSchalten(17, Klassen.WeichenRichtung.rechts)
                        _eb.weicheSchalten(27, Klassen.WeichenRichtung.rechts)
                    ElseIf _Route_Gleis1 = 2 Then
                        _eb.weicheSchalten(17, Klassen.WeichenRichtung.links)
                    End If
                End If
                AutomatikParameter = 100
            Else
                If _NachlaufZug1 = False Then
                    StopZug1()
                    Zug1(abstellen)
                Else
                    Zug1(nachlauf)
                End If
            End If
            _AutomatikParameterH = 0
        End If

        ' ***
        ' *** Zug 4 Anfahren
        ' ***

        BahnhofsausfahrtLok4(Kontakt)

        If _Route_Gleis4 = 0 Then     ' *** Route "nur unten"

            NurUntenLok4(Kontakt)

        ElseIf _Route_Gleis4 = 1 Then ' *** Route "oben kurz"

            BergfahrtLok4(Kontakt)
            ObenKurzLok4(Kontakt)

        ElseIf _Route_Gleis4 = 2 Then ' *** Route "oben lang"

            BergfahrtLok4(Kontakt)
            ObenLangLok4(Kontakt)

        End If
        ' ***
        ' *** Ankunft im Bahnhof
        ' ***
        If Kontakt.Modul = 1 And Kontakt.Adresse = 5 And Kontakt.status = True And AutomatikParameter = 420 Then
            Ort_Lok4 = 400
            _AutomatikParameterH = 421
            If A_Stop = 0 Then
                A_StopH = 0
                If _Bhf_Gleis4 = 0 Then
                    _StopZug4 = 0
                    AutomatikParameter = 421
                ElseIf _Bhf_Gleis4 = 1 Then
                    _StopZug4 = 1
                    StopStart120Lok(4, 1)
                Else
                    _StopZug4 = 4
                    StopStart120Lok(4, 4)
                End If
            Else
                A_StopH = 1
                _StopZug4 = 4
                StopStart120Lok(4, 4)
            End If
        End If
        If Kontakt.Modul = 1 And Kontakt.Adresse = 4 And Kontakt.status = True And _AutomatikParameterH = 421 Then
            If _StopZug4 = 0 And A_StopH = 0 Then
                If _Route_Gleis1 = 0 And _Route_Gleis4 = 0 Then
                    ' *** keine Aktion wenn beide Züge unten fahren
                Else
                    If _Route_Gleis4 = 0 Then
                        _eb.weicheSchalten(27, Klassen.WeichenRichtung.links)
                    ElseIf _Route_Gleis4 = 1 Then
                        _eb.weicheSchalten(27, Klassen.WeichenRichtung.rechts)
                    ElseIf _Route_Gleis4 = 2 Then
                        _eb.weicheSchalten(27, Klassen.WeichenRichtung.rechts)
                    End If
                End If
                AutomatikParameter = 400
            Else
                If _NachlaufZug4 = False Then
                    StopZug4()
                    Zug4(abstellen)
                Else
                    Zug4(nachlauf)
                End If
            End If
            _AutomatikParameterH = 0
        End If
    End Sub
    Private Sub Betriebsart1_5(ByVal Kontakt As Klassen.Kontakt)
        ' *** Betriebsart 1/2=1 und ' *** Betriebsart 3/4=5
        ' ***
        ' *** Datum:          14.01.2019
        ' ***
        ' *** Kommentar allgemein               : kein
        ' ***                 
        ' ***

        ' ***
        ' *** Bahnhofsausfahrt Zug auf Gleis 1
        ' ***

        BahnhofsausfahrtLok1(Kontakt)

        If _Route_Gleis1 = 0 Then     ' *** Route "nur unten"

            NurUntenLok1(Kontakt)

        ElseIf _Route_Gleis1 = 1 Then ' *** Route "oben kurz"

            ObenKurzLok1(Kontakt)
            BergfahrtLok1(Kontakt)

        ElseIf _Route_Gleis1 = 2 Then ' *** Route "oben lang"

            ObenLangLok1(Kontakt)
            BergfahrtLok1(Kontakt)

        End If
        ' ***
        ' *** Ankunft im Bahnhof
        ' ***
        If Kontakt.Modul = 0 And Kontakt.Adresse = 1 And Kontakt.status = True And AutomatikParameter = 120 Then
            Ort_Lok1 = 100
            _AutomatikParameterH = 121
            If A_Stop = 0 Then
                A_StopH = 0
                If _Bhf_Gleis1 = 0 Then
                    _StopZug1 = 0
                    AutomatikParameter = 121
                ElseIf _Bhf_Gleis1 = 3 Then
                    _StopZug1 = 3
                    StopStart120Lok(1, 3)
                ElseIf _Bhf_Gleis1 = 4 Then
                    _StopZug1 = 4
                    StopStart120Lok(1, 4)
                Else
                    _StopZug1 = 1
                    StopStart120Lok(1, 1)
                End If
            Else
                A_StopH = 1
                _StopZug1 = 1
                StopStart120Lok(1, 1)
            End If
        End If
        If Kontakt.Modul = 0 And Kontakt.Adresse = 0 And Kontakt.status = True And _AutomatikParameterH = 121 Then
            If _StopZug1 = 0 And A_StopH = 0 Then
                If _Route_Gleis1 = 0 Then
                    _eb.weicheSchalten(17, Klassen.WeichenRichtung.links)
                ElseIf _Route_Gleis1 = 1 Then
                    _eb.weicheSchalten(17, Klassen.WeichenRichtung.rechts)
                    _eb.weicheSchalten(27, Klassen.WeichenRichtung.rechts)
                ElseIf _Route_Gleis1 = 2 Then
                    _eb.weicheSchalten(17, Klassen.WeichenRichtung.links)
                End If
                AutomatikParameter = 100
            Else
                If _NachlaufZug1 = False Then
                    StopZug1()
                    Zug1(abstellen)
                Else
                    Zug1(nachlauf)
                End If
            End If
            _AutomatikParameterH = 0
        End If

        BahnhofsausfahrtLok3(Kontakt)

        If _Route_Gleis3 = 0 Then     ' *** Route "nur unten"

            NurUntenLok3(Kontakt)

        ElseIf _Route_Gleis3 = 1 Then ' *** Route "oben kurz"

            BergfahrtLok3(Kontakt)
            ObenKurzLok3(Kontakt)

        ElseIf _Route_Gleis3 = 2 Then ' *** Route "oben lang"

            BergfahrtLok3(Kontakt)
            ObenLangLok3(Kontakt)

        End If
        ' ***
        ' *** Ankunft im Bahnhof
        ' ***
        If Kontakt.Modul = 1 And Kontakt.Adresse = 7 And Kontakt.status = True And AutomatikParameter = 320 Then
            Ort_Lok3 = 300
            _AutomatikParameterH = 321
            If A_Stop = 0 Then
                A_StopH = 0
                If _Bhf_Gleis3 = 0 Then
                    _StopZug3 = 0
                    AutomatikParameter = 321
                ElseIf _Bhf_Gleis3 = 1 Then
                    _StopZug3 = 1
                    StopStart120Lok(3, 1)
                ElseIf _Bhf_Gleis3 = 4 Then
                    _StopZug3 = 4
                    StopStart120Lok(3, 4)
                Else
                    _StopZug3 = 3
                    StopStart120Lok(3, 3)
                End If
            Else
                A_StopH = 1
                _StopZug3 = 3
                StopStart120Lok(3, 3)
            End If
        End If
        If Kontakt.Modul = 1 And Kontakt.Adresse = 6 And Kontakt.status = True And _AutomatikParameterH = 321 Then
            If _StopZug3 = 0 And A_StopH = 0 Then
                If _Route_Gleis3 = 0 Then
                    _eb.weicheSchalten(27, Klassen.WeichenRichtung.links)
                ElseIf _Route_Gleis3 = 1 Then
                    _eb.weicheSchalten(27, Klassen.WeichenRichtung.rechts)
                ElseIf _Route_Gleis3 = 2 Then
                    _eb.weicheSchalten(27, Klassen.WeichenRichtung.rechts)
                End If
                AutomatikParameter = 300
            Else
                If _NachlaufZug3 = False Then
                    StopZug3()
                    Zug3(abstellen)
                Else
                    Zug3(nachlauf)
                End If
            End If
            _AutomatikParameterH = 0
        End If

        BahnhofsausfahrtLok4(Kontakt)

        If _Route_Gleis4 = 0 Then     ' *** Route "nur unten"

            NurUntenLok4(Kontakt)

        ElseIf _Route_Gleis4 = 1 Then ' *** Route "oben kurz"

            BergfahrtLok4(Kontakt)
            ObenKurzLok4(Kontakt)

        ElseIf _Route_Gleis4 = 2 Then ' *** Route "oben lang"

            BergfahrtLok4(Kontakt)
            ObenLangLok4(Kontakt)

        End If
        ' ***
        ' *** Ankunft im Bahnhof
        ' ***
        If Kontakt.Modul = 1 And Kontakt.Adresse = 5 And Kontakt.status = True And AutomatikParameter = 420 Then
            Ort_Lok4 = 400
            _AutomatikParameterH = 421
            If A_Stop = 0 Then
                A_StopH = 0
                If _Bhf_Gleis4 = 0 Then
                    _StopZug4 = 0
                    AutomatikParameter = 421
                ElseIf _Bhf_Gleis4 = 1 Then
                    _StopZug4 = 1
                    StopStart120Lok(4, 1)
                ElseIf _Bhf_Gleis4 = 3 Then
                    _StopZug4 = 3
                    StopStart120Lok(4, 3)
                Else
                    _StopZug4 = 4
                    StopStart120Lok(4, 4)
                End If
            Else
                A_StopH = 1
                _StopZug4 = 4
                StopStart120Lok(4, 4)
            End If
        End If
        If Kontakt.Modul = 1 And Kontakt.Adresse = 4 And Kontakt.status = True And _AutomatikParameterH = 421 Then
            If _StopZug4 = 0 And A_StopH = 0 Then
                If _Route_Gleis4 = 0 Then
                    _eb.weicheSchalten(27, Klassen.WeichenRichtung.links)
                ElseIf _Route_Gleis4 = 1 Then
                    _eb.weicheSchalten(27, Klassen.WeichenRichtung.rechts)
                ElseIf _Route_Gleis4 = 2 Then
                    _eb.weicheSchalten(27, Klassen.WeichenRichtung.rechts)
                End If
                AutomatikParameter = 400
            Else
                If _NachlaufZug4 = False Then
                    StopZug4()
                    Zug4(abstellen)
                Else
                    Zug4(nachlauf)
                End If
            End If
            _AutomatikParameterH = 0
        End If
    End Sub
    Private Sub Betriebsart2_0(ByVal Kontakt As Klassen.Kontakt)
        ' *** Betriebsart 1/2=2 und ' *** Betriebsart 3/4=0
        ' ***
        ' *** Datum:          06.01.2023
        ' ***
        ' *** Kommentar allgemein            : kein
        ' ***       
        ' *** getestet:       Route Gleis 2  : unten, oben kurz, oben lang
        ' ***                 Kurzug         :  nein()
        ' ***                 Schattenbahnhof: ja (20.11.2018 für Route unten)
        ' ***
        ' ***                 
        ' ***

        ' ***
        ' *** Bahnhofsausfahrt Zug auf Gleis 2
        ' ***

        BahnhofsausfahrtLok2(Kontakt)

        If _Route_Gleis2 = 0 Then     ' *** Route "nur unten"

            NurUntenLok2(Kontakt)

        ElseIf _Route_Gleis2 = 1 Then ' *** Route "oben kurz"

            ObenKurzLok2(Kontakt)
            BergfahrtLok2(Kontakt)

        ElseIf _Route_Gleis2 = 2 Then ' *** Route "oben lang"

            ObenLangLok2(Kontakt)
            BergfahrtLok2(Kontakt)

        End If
        ' ***
        ' *** Ankunft im Bahnhof
        ' ***
        If Kontakt.Modul = 0 And Kontakt.Adresse = 3 And Kontakt.status = True And AutomatikParameter = 220 Then
            Ort_Lok2 = 200
            _AutomatikParameterH = 221
            If A_Stop = 0 Then
                A_StopH = 0
                If _Bhf_Gleis2 = 0 Then
                    _StopZug2 = 0
                    AutomatikParameter = 221
                Else
                    _StopZug2 = 2
                    StopStart120Lok(2, 2)
                End If
            Else
                A_StopH = 1
                _StopZug2 = 2
                StopStart120Lok(2, 2)
            End If
        End If
        If Kontakt.Modul = 0 And Kontakt.Adresse = 2 And Kontakt.status = True And _AutomatikParameterH = 221 Then
            If _StopZug2 = 0 And A_StopH = 0 Then
                ' Weichen 17 und 27 müssen nicht geschaltet werden (Betriebsart12 = 1 und Betriebsart34 =0)
                AutomatikParameter = 200
            Else
                'Zug2(nachlauf)
                If _NachlaufZug2 = False Then
                    StopZug2()
                    Zug2(abstellen)
                Else
                    Zug2(nachlauf)
                End If
            End If
            _AutomatikParameterH = 0
        End If
    End Sub
    Private Sub Betriebsart2_0Var1(ByVal Kontakt As Klassen.Kontakt)
        ' *** Betriebsart 1/2=2 und ' *** Betriebsart 3/4=0
        ' ***
        ' *** Datum:          01.01.2026
        ' ***
        ' *** Kommentar allgemein            : kein
        ' ***       
        ' *** getestet:       Route Gleis 2  : oben kurz
        ' ***                 Kurzug         :  nein()
        ' ***                 
        ' ***
        ' ***                 
        ' ***
        ' ***
        ' *** Bahnhofsausfahrt Zug auf Gleis 2
        ' ***

        'BahnhofsausfahrtLok2(Kontakt)

        If Kontakt.Modul = 0 And Kontakt.Adresse = 3 And Kontakt.status = False And (AutomatikParameter = 200 Or AutomatikParameter = 206) Then
            AutomatikParameter = 210
        End If

        BergfahrtLok2(Kontakt)

        If Kontakt.Modul = 0 And Kontakt.Adresse = 4 And Kontakt.status = True And AutomatikParameter = 220 Then
            AutomatikParameter = 202
            Ort_Lok2 = 202
            Zug2(700)
        End If

        ' ***
        ' *** Ankunft im Bahnhof
        ' ***
        If Kontakt.Modul = 0 And Kontakt.Adresse = 2 And Kontakt.status = True And AutomatikParameter = 202 Then
            Ort_Lok2 = 205
            _AutomatikParameterH = 221
            If A_Stop = 0 Then
                A_StopH = 0
                If _Bhf2_Gleis2 = 0 Then
                    _StopZug2 = 0
                    AutomatikParameter = 221
                Else
                    _StopZug2 = 2
                    StopStart120Lok(2, 2)
                End If
            Else
                A_StopH = 1
                _StopZug2 = 2
                StopStart120Lok(2, 2)
            End If
        End If
        If Kontakt.Modul = 0 And Kontakt.Adresse = 3 And Kontakt.status = True And _AutomatikParameterH = 221 Then
            If _StopZug2 = 0 And A_StopH = 0 Then
                AutomatikParameter = 200
            Else
                'Zug2(nachlauf)
                If _NachlaufZug2 = False Then
                    StopZug2()
                    Zug2(abstellen)
                Else
                    Zug2(nachlauf)
                End If
            End If
            _AutomatikParameterH = 0
        End If
    End Sub
    Private Sub Betriebsart2_3(ByVal Kontakt As Klassen.Kontakt)
        ' *** Betriebsart 1/2=2 und ' *** Betriebsart 3/4=3
        ' ***
        ' *** Datum:          14.01.2020
        ' ***
        ' *** Kommentar:      kein
        ' *** 
        ' ***

        ' ***
        ' *** Bahnhofsausfahrt Zug auf Gleis 2
        ' ***

        BahnhofsausfahrtLok2(Kontakt)

        If _Route_Gleis2 = 0 Then     ' *** Route "nur unten"

            NurUntenLok2(Kontakt)

        ElseIf _Route_Gleis2 = 1 Then ' *** Route "oben kurz"

            ObenKurzLok2(Kontakt)
            BergfahrtLok2(Kontakt)

        ElseIf _Route_Gleis2 = 2 Then ' *** Route "oben lang"

            ObenLangLok2(Kontakt)
            BergfahrtLok2(Kontakt)

        End If
        ' ***
        ' *** Ankunft im Bahnhof
        ' ***
        If Kontakt.Modul = 0 And Kontakt.Adresse = 3 And Kontakt.status = True And AutomatikParameter = 220 Then
            Ort_Lok2 = 200
            _AutomatikParameterH = 221
            If A_Stop = 0 Then
                A_StopH = 0
                If _Bhf_Gleis2 = 0 Then
                    _StopZug2 = 0
                    AutomatikParameter = 221
                ElseIf _Bhf_Gleis2 = 3 Then
                    _StopZug2 = 3
                    StopStart120Lok(2, 3)
                Else
                    _StopZug2 = 2
                    StopStart120Lok(2, 2)
                End If
            Else
                A_StopH = 1
                _StopZug2 = 2
                StopStart120Lok(2, 2)
            End If
        End If
        If Kontakt.Modul = 0 And Kontakt.Adresse = 2 And Kontakt.status = True And _AutomatikParameterH = 221 Then
            If _StopZug2 = 0 And A_StopH = 0 Then
                If _Route_Gleis2 = 0 And _Route_Gleis3 = 0 Then
                    ' *** keine Aktion wenn beide Züge unten fahren
                ElseIf _Route_Gleis2 = 1 And _Route_Gleis3 = 1 Then
                    ' *** keine Aktion erforderlich
                Else
                    If _Route_Gleis2 = 0 Then
                        _eb.weicheSchalten(17, Klassen.WeichenRichtung.links)
                    ElseIf _Route_Gleis2 = 1 Then
                        _eb.weicheSchalten(17, Klassen.WeichenRichtung.rechts)
                        _eb.weicheSchalten(27, Klassen.WeichenRichtung.rechts)
                    ElseIf _Route_Gleis2 = 2 Then
                        _eb.weicheSchalten(17, Klassen.WeichenRichtung.links)
                    End If
                End If
                AutomatikParameter = 200
            Else
                If _NachlaufZug2 = False Then
                    StopZug2()
                    Zug2(abstellen)
                Else
                    Zug2(nachlauf)
                End If
            End If
            _AutomatikParameterH = 0
        End If

        BahnhofsausfahrtLok3(Kontakt)

        ' ***
        ' *** Zug 3 fährt Route unten
        ' ***
        If _Route_Gleis3 = 0 Then     ' *** Route "nur unten"

            NurUntenLok3(Kontakt)

        ElseIf _Route_Gleis3 = 1 Then ' *** Route "oben kurz"

            BergfahrtLok3(Kontakt)
            ObenKurzLok3(Kontakt)

        ElseIf _Route_Gleis3 = 2 Then ' *** Route "oben lang"

            BergfahrtLok3(Kontakt)
            ObenLangLok3(Kontakt)

        End If
        ' ***
        ' *** Ankunft im Bahnhof
        ' ***
        If Kontakt.Modul = 1 And Kontakt.Adresse = 7 And Kontakt.status = True And AutomatikParameter = 320 Then
            Ort_Lok3 = 300
            _AutomatikParameterH = 321
            If A_Stop = 0 Then
                A_StopH = 0
                If _Bhf_Gleis3 = 0 Then
                    _StopZug3 = 0
                    AutomatikParameter = 321
                ElseIf _Bhf_Gleis3 = 2 Then
                    _StopZug3 = 2
                    StopStart120Lok(3, 2)
                Else
                    _StopZug3 = 3
                    StopStart120Lok(3, 3)
                End If
            Else
                A_StopH = 1
                _StopZug3 = 3
                StopStart120Lok(3, 3)
            End If
        End If
        If Kontakt.Modul = 1 And Kontakt.Adresse = 6 And Kontakt.status = True And _AutomatikParameterH = 321 Then
            If _StopZug3 = 0 And A_StopH = 0 Then
                If _Route_Gleis2 = 0 And _Route_Gleis3 = 0 Then
                    ' *** keine Aktion wenn beide Züge unten fahren
                ElseIf _Route_Gleis2 = 1 And _Route_Gleis3 = 1 Then
                    ' *** keine Aktion erforderlich
                Else
                    If _Route_Gleis3 = 0 Then
                        _eb.weicheSchalten(27, Klassen.WeichenRichtung.links)
                    ElseIf _Route_Gleis3 = 1 Then
                        _eb.weicheSchalten(27, Klassen.WeichenRichtung.rechts)
                    ElseIf _Route_Gleis3 = 2 Then
                        _eb.weicheSchalten(27, Klassen.WeichenRichtung.rechts)
                    End If
                End If
                AutomatikParameter = 300
            Else
                If _NachlaufZug3 = False Then
                    StopZug3()
                    Zug3(abstellen)
                Else
                    Zug3(nachlauf)
                End If
            End If
            _AutomatikParameterH = 0
        End If
    End Sub
    Private Sub Betriebsart2_4(ByVal Kontakt As Klassen.Kontakt)
        ' *** Betriebsart 1/2=2 und ' *** Betriebsart 3/4=4
        ' ***
        ' *** Datum:          14.01.2020
        ' ***
        ' *** Kommentar allgemein            : kein
        ' ***             
        ' ***

        ' ***
        ' *** Bahnhofsausfahrt Zug auf Gleis 2
        ' ***  

        BahnhofsausfahrtLok2(Kontakt)

        If _Route_Gleis2 = 0 Then     ' *** Route "nur unten"

            NurUntenLok2(Kontakt)

        ElseIf _Route_Gleis2 = 1 Then ' *** Route "oben kurz"

            ObenKurzLok2(Kontakt)
            BergfahrtLok2(Kontakt)

        ElseIf _Route_Gleis2 = 2 Then ' *** Route "oben lang"

            ObenLangLok2(Kontakt)
            BergfahrtLok2(Kontakt)

        End If
        ' ***
        ' *** Ankunft im Bahnhof
        ' ***
        If Kontakt.Modul = 0 And Kontakt.Adresse = 3 And Kontakt.status = True And AutomatikParameter = 220 Then
            Ort_Lok2 = 200
            _AutomatikParameterH = 221
            If A_Stop = 0 Then
                A_StopH = 0
                If _Bhf_Gleis2 = 0 Then
                    _StopZug2 = 0
                    AutomatikParameter = 221
                ElseIf _Bhf_Gleis2 = 4 Then
                    _StopZug2 = 4
                    StopStart120Lok(2, 4)
                Else
                    _StopZug2 = 2
                    StopStart120Lok(2, 2)
                End If
            Else
                A_StopH = 1
                _StopZug2 = 2
                StopStart120Lok(2, 2)
            End If
        End If
        If Kontakt.Modul = 0 And Kontakt.Adresse = 2 And Kontakt.status = True And _AutomatikParameterH = 221 Then
            If _StopZug2 = 0 And A_StopH = 0 Then
                If _Route_Gleis2 = 0 And _Route_Gleis4 = 0 Then
                    ' *** keine Aktion wenn beide Züge unten fahren
                ElseIf _Route_Gleis2 = 1 And _Route_Gleis4 = 1 Then
                    ' *** keine Aktion erforderlich
                Else
                    If _Route_Gleis2 = 0 Then
                        _eb.weicheSchalten(17, Klassen.WeichenRichtung.links)
                    ElseIf _Route_Gleis2 = 1 Then
                        _eb.weicheSchalten(17, Klassen.WeichenRichtung.rechts)
                        _eb.weicheSchalten(27, Klassen.WeichenRichtung.rechts)
                    ElseIf _Route_Gleis2 = 2 Then
                        _eb.weicheSchalten(17, Klassen.WeichenRichtung.links)
                    End If
                End If
                AutomatikParameter = 200
            Else
                If _NachlaufZug2 = False Then
                    StopZug2()
                    Zug2(abstellen)
                Else
                    Zug2(nachlauf)
                End If
            End If
            _AutomatikParameterH = 0
        End If

        BahnhofsausfahrtLok4(Kontakt)

        ' ***
        ' *** Route "nur unten"
        ' ***
        If _Route_Gleis4 = 0 Then     ' *** Route "nur unten"

            NurUntenLok4(Kontakt)

        ElseIf _Route_Gleis4 = 1 Then ' *** Route "oben kurz"

            BergfahrtLok4(Kontakt)
            ObenKurzLok4(Kontakt)

        ElseIf _Route_Gleis4 = 2 Then ' *** Route "oben lang"

            BergfahrtLok4(Kontakt)
            ObenLangLok4(Kontakt)

        End If
        ' ***
        ' *** Ankunft im Bahnhof
        ' ***
        If Kontakt.Modul = 1 And Kontakt.Adresse = 5 And Kontakt.status = True And AutomatikParameter = 420 Then
            Ort_Lok4 = 400
            _AutomatikParameterH = 421
            If A_Stop = 0 Then
                A_StopH = 0
                If _Bhf_Gleis4 = 0 Then
                    _StopZug4 = 0
                    AutomatikParameter = 421
                ElseIf _Bhf_Gleis4 = 2 Then
                    _StopZug4 = 2
                    StopStart120Lok(4, 2)
                Else
                    _StopZug4 = 4
                    StopStart120Lok(4, 4)
                End If
            Else
                A_StopH = 1
                _StopZug4 = 4
                StopStart120Lok(4, 4)
            End If
        End If
        If Kontakt.Modul = 1 And Kontakt.Adresse = 4 And Kontakt.status = True And _AutomatikParameterH = 421 Then
            If _StopZug4 = 0 And A_StopH = 0 Then
                If _Route_Gleis2 = 0 And _Route_Gleis4 = 0 Then
                    ' *** keine Aktion wenn beide Züge unten fahren
                ElseIf _Route_Gleis2 = 1 And _Route_Gleis4 = 1 Then
                    ' *** keine Aktion erforderlich
                Else
                    If _Route_Gleis4 = 0 Then
                        _eb.weicheSchalten(27, Klassen.WeichenRichtung.links)
                    ElseIf _Route_Gleis4 = 1 Then
                        _eb.weicheSchalten(27, Klassen.WeichenRichtung.rechts)
                    ElseIf _Route_Gleis4 = 2 Then
                        _eb.weicheSchalten(27, Klassen.WeichenRichtung.rechts)
                    End If
                End If
                AutomatikParameter = 400
            Else
                If _NachlaufZug4 = False Then
                    StopZug4()
                    Zug4(abstellen)
                Else
                    Zug4(nachlauf)
                End If
            End If
            _AutomatikParameterH = 0
        End If
    End Sub
    Private Sub Betriebsart2_5(ByVal Kontakt As Klassen.Kontakt)
        ' *** Betriebsart 1/2=2 und ' *** Betriebsart 3/4=5
        ' ***
        ' *** Datum:          14.01.2020
        ' ***                
        ' *** Kommentar allgemein            : kein
        ' ***  
        ' ***

        ' ***
        ' *** Bahnhofsausfahrt Zug auf Gleis 2
        ' ***

        BahnhofsausfahrtLok2(Kontakt)

        If _Route_Gleis2 = 0 Then     ' *** Route "nur unten"

            NurUntenLok2(Kontakt)

        ElseIf _Route_Gleis2 = 1 Then ' *** Route "oben kurz"

            ObenKurzLok2(Kontakt)
            BergfahrtLok2(Kontakt)

        ElseIf _Route_Gleis2 = 2 Then ' *** Route "oben lang"

            ObenLangLok2(Kontakt)
            BergfahrtLok2(Kontakt)

        End If
        ' ***
        ' *** Ankunft im Bahnhof
        ' ***
        If Kontakt.Modul = 0 And Kontakt.Adresse = 3 And Kontakt.status = True And AutomatikParameter = 220 Then
            Ort_Lok2 = 200
            _AutomatikParameterH = 221
            If A_Stop = 0 Then
                A_StopH = 0
                If _Bhf_Gleis2 = 0 Then
                    _StopZug2 = 0
                    WeichenInStartPositionLok2()
                    AutomatikParameter = 200
                ElseIf _Bhf_Gleis2 = 3 Then
                    _StopZug2 = 3
                    StopStart120Lok(2, 3)
                ElseIf _Bhf_Gleis2 = 4 Then
                    _StopZug2 = 4
                    StopStart120Lok(2, 4)
                Else
                    _StopZug2 = 2
                    StopStart120Lok(2, 2)
                End If
            Else
                A_StopH = 1
                _StopZug2 = 2
                StopStart121Lok(2, 2)
            End If
        End If
        If Kontakt.Modul = 0 And Kontakt.Adresse = 2 And Kontakt.status = True And _AutomatikParameterH = 221 Then
            If _StopZug2 = 0 And A_StopH = 0 Then
                If _Route_Gleis2 = 0 And _Route_Gleis3 = 0 And _Route_Gleis4 = 0 Then
                    ' *** keine Aktion wenn alle Züge unten fahren
                ElseIf _Route_Gleis2 = 1 And _Route_Gleis3 = 1 And _Route_Gleis4 = 1 Then
                    ' *** keine Aktion erforderlich
                Else
                    If _Route_Gleis2 = 0 Then
                        _eb.weicheSchalten(17, Klassen.WeichenRichtung.links)
                    ElseIf _Route_Gleis2 = 1 Then
                        _eb.weicheSchalten(17, Klassen.WeichenRichtung.rechts)
                        _eb.weicheSchalten(27, Klassen.WeichenRichtung.rechts)
                    ElseIf _Route_Gleis2 = 2 Then
                        _eb.weicheSchalten(17, Klassen.WeichenRichtung.links)
                    End If
                End If
                AutomatikParameter = 200
            Else
                If _NachlaufZug2 = False Then
                    StopZug2()
                    Zug2(abstellen)
                Else
                    Zug2(nachlauf)
                End If
            End If
            _AutomatikParameterH = 0
        End If
        ' Zug auf Gleis 3 faehrt los

        BahnhofsausfahrtLok3(Kontakt)

        If _Route_Gleis3 = 0 Then     ' *** Route "nur unten"

            NurUntenLok3(Kontakt)

        ElseIf _Route_Gleis3 = 1 Then ' *** Route "oben kurz"

            BergfahrtLok3(Kontakt)
            ObenKurzLok3(Kontakt)

        ElseIf _Route_Gleis3 = 2 Then ' *** Route "oben lang"

            BergfahrtLok3(Kontakt)
            ObenLangLok3(Kontakt)

        End If
        ' ***
        ' *** Ankunft im Bahnhof
        ' ***
        If Kontakt.Modul = 1 And Kontakt.Adresse = 7 And Kontakt.status = True And AutomatikParameter = 320 Then
            Ort_Lok3 = 300
            _AutomatikParameterH = 321
            If A_Stop = 0 Then
                A_StopH = 0
                If _Bhf_Gleis3 = 0 Then
                    _StopZug3 = 0
                    WeichenInStartPositionLok3()
                    AutomatikParameter = 300
                ElseIf _Bhf_Gleis3 = 2 Then
                    _StopZug3 = 2
                    StopStart120Lok(3, 2)
                ElseIf _Bhf_Gleis3 = 4 Then
                    _StopZug3 = 4
                    StopStart120Lok(3, 4)
                Else
                    _StopZug3 = 3
                    StopStart120Lok(3, 3)
                End If
            Else
                A_StopH = 1
                _StopZug3 = 3
                StopStart121Lok(3, 3)
            End If
        End If
        If Kontakt.Modul = 1 And Kontakt.Adresse = 6 And Kontakt.status = True And _AutomatikParameterH = 321 Then
            If _StopZug3 = 0 And A_StopH = 0 Then
                If _Route_Gleis2 = 0 And _Route_Gleis3 = 0 And _Route_Gleis4 = 0 Then
                    ' *** keine Aktion wenn alle Züge unten fahren
                ElseIf _Route_Gleis2 = 1 And _Route_Gleis3 = 1 And _Route_Gleis4 = 1 Then
                    ' *** keine Aktion erforderlich
                Else
                    If _Route_Gleis3 = 0 Then
                        _eb.weicheSchalten(27, Klassen.WeichenRichtung.links)
                    ElseIf _Route_Gleis3 = 1 Then
                        _eb.weicheSchalten(27, Klassen.WeichenRichtung.rechts)
                    ElseIf _Route_Gleis3 = 2 Then
                        _eb.weicheSchalten(27, Klassen.WeichenRichtung.rechts)
                    End If
                End If
                AutomatikParameter = 300
            Else
                If _NachlaufZug3 = False Then
                    StopZug3()
                    Zug3(abstellen)
                Else
                    Zug3(nachlauf)
                End If
            End If
            _AutomatikParameterH = 0
        End If
        ' Zug auf Gleis 4 faehrt los

        BahnhofsausfahrtLok4(Kontakt)

        If _Route_Gleis4 = 0 Then     ' *** Route "nur unten"

            NurUntenLok4(Kontakt)

        ElseIf _Route_Gleis4 = 1 Then ' *** Route "oben kurz"

            BergfahrtLok4(Kontakt)
            ObenKurzLok4(Kontakt)

        ElseIf _Route_Gleis4 = 2 Then ' *** Route "oben lang"

            BergfahrtLok4(Kontakt)
            ObenLangLok4(Kontakt)

        End If
        ' ***
        ' *** Ankunft im Bahnhof
        ' ***
        If Kontakt.Modul = 1 And Kontakt.Adresse = 5 And Kontakt.status = True And AutomatikParameter = 420 Then
            Ort_Lok4 = 400
            _AutomatikParameterH = 421
            If A_Stop = 0 Then
                A_StopH = 0
                If _Bhf_Gleis4 = 0 Then
                    _StopZug4 = 0
                    WeichenInStartPositionLok4()
                    AutomatikParameter = 400
                ElseIf _Bhf_Gleis4 = 2 Then
                    _StopZug4 = 2
                    StopStart120Lok(4, 2)
                ElseIf _Bhf_Gleis4 = 3 Then
                    _StopZug4 = 3
                    StopStart120Lok(4, 3)
                Else
                    _StopZug4 = 4
                    StopStart120Lok(4, 4)
                End If
            Else
                A_StopH = 1
                _StopZug4 = 4
                StopStart121Lok(4, 4)
            End If
        End If
        If Kontakt.Modul = 1 And Kontakt.Adresse = 4 And Kontakt.status = True And _AutomatikParameterH = 421 Then
            If _StopZug4 = 0 And A_StopH = 0 Then
                If _Route_Gleis2 = 0 And _Route_Gleis3 = 0 And _Route_Gleis4 = 0 Then
                    ' *** keine Aktion wenn alle Züge unten fahren
                ElseIf _Route_Gleis2 = 1 And _Route_Gleis3 = 1 And _Route_Gleis4 = 1 Then
                    ' *** keine Aktion erforderlich
                Else
                    If _Route_Gleis4 = 0 Then
                        _eb.weicheSchalten(27, Klassen.WeichenRichtung.links)
                    ElseIf _Route_Gleis4 = 1 Then
                        _eb.weicheSchalten(27, Klassen.WeichenRichtung.rechts)
                    ElseIf _Route_Gleis4 = 2 Then
                        _eb.weicheSchalten(27, Klassen.WeichenRichtung.rechts)
                    End If
                End If
                AutomatikParameter = 400
            Else
                If _NachlaufZug4 = False Then
                    StopZug4()
                    Zug4(abstellen)
                Else
                    Zug4(nachlauf)
                End If
            End If
            _AutomatikParameterH = 0
        End If
    End Sub
    Private Sub Betriebsart3_0(ByVal Kontakt As Klassen.Kontakt)
        ' *** Betriebsart 1/2=3 und ' *** Betriebsart 3/4=0
        ' ***
        ' *** Datum:          14.01.2020
        ' ***
        ' *** steuert die Fahrt des Zuges auf Gleis 1
        ' ***                
        ' ***

        ' ***
        ' *** Bahnhofsausfahrt Zug auf Gleis 1
        ' ***
        BahnhofsausfahrtLok1(Kontakt)


        If _Route_Gleis1 = 0 Then     ' *** Route "nur unten"

            NurUntenLok1(Kontakt)

        ElseIf _Route_Gleis1 = 1 Then ' *** Route "oben kurz"

            BergfahrtLok1(Kontakt)
            ObenKurzLok1(Kontakt)

        ElseIf _Route_Gleis1 = 2 Then ' *** Route "oben lang"

            BergfahrtLok1(Kontakt)
            ObenLangLok1(Kontakt)

        End If
        ' ***
        ' ***   Anhalten Lok1 im Bahnhof
        ' ***
        If Kontakt.Modul = 0 And Kontakt.Adresse = 1 And Kontakt.status = True And AutomatikParameter = 120 Then
            Ort_Lok1 = 100
            _AutomatikParameterH = 121
            If A_Stop = 0 Then
                A_StopH = 0
                If _Bhf_Gleis1 = 0 Then
                    _StopZug1 = 0
                    AutomatikParameter = 121
                ElseIf _Bhf_Gleis1 = 2 Then
                    _StopZug1 = 2
                    _Route_Gleis2 = ARoute_Lok2
                    ButtonsVisible(999)
                    StopStart120Lok(1, 2)
                Else
                    _StopZug1 = 1
                    StopStart120Lok(1, 1)
                End If
            Else
                A_StopH = 1
                _StopZug1 = 1
                StopStart120Lok(1, 1)
            End If
        End If
        If Kontakt.Modul = 0 And Kontakt.Adresse = 0 And Kontakt.status = True And _AutomatikParameterH = 121 Then
            If _StopZug1 = 0 And A_StopH = 0 Then
                If _Route_Gleis1 = 0 And _Route_Gleis2 = 0 Then
                    ' *** keine Aktion wenn beide Züge unten fahren
                ElseIf _Route_Gleis1 = 1 And _Route_Gleis2 = 1 Then
                    ' *** keine Aktion wenn beide Züge oben kurz fahren
                Else
                    If _Route_Gleis1 = 0 Then
                        _eb.weicheSchalten(17, Klassen.WeichenRichtung.links)
                    ElseIf _Route_Gleis1 = 1 Then
                        _eb.weicheSchalten(17, Klassen.WeichenRichtung.rechts)
                        _eb.weicheSchalten(27, Klassen.WeichenRichtung.rechts)
                    ElseIf _Route_Gleis1 = 2 Then
                        _eb.weicheSchalten(17, Klassen.WeichenRichtung.links)
                    End If
                End If
                AutomatikParameter = 100
            Else
                If _NachlaufZug1 = False Then
                    StopZug1()
                    Zug1(abstellen)
                Else
                    Zug1(nachlauf)
                End If
            End If
            _AutomatikParameterH = 0
        End If


        BahnhofsausfahrtLok2(Kontakt)


        If _Route_Gleis2 = 0 Then     ' *** Route "nur unten"

            NurUntenLok2(Kontakt)

        ElseIf _Route_Gleis2 = 1 Then ' *** Route "oben kurz"

            BergfahrtLok2(Kontakt)
            ObenKurzLok2(Kontakt)


        ElseIf _Route_Gleis2 = 2 Then ' *** Route "oben lang"

            BergfahrtLok2(Kontakt)
            ObenLangLok2(Kontakt)

        End If
        ' ***
        ' ***   Anhalten im Bahnhof
        ' ***
        If Kontakt.Modul = 0 And Kontakt.Adresse = 3 And Kontakt.status = True And AutomatikParameter = 220 Then
            Ort_Lok2 = 200
            _AutomatikParameterH = 221
            If A_Stop = 0 Then
                A_StopH = 0
                If _Bhf_Gleis2 = 0 Then
                    _StopZug2 = 0
                    AutomatikParameter = 221
                ElseIf _Bhf_Gleis2 = 1 Then
                    _StopZug2 = 2
                    _Route_Gleis1 = ARoute_Lok1
                    ButtonsVisible(999)
                    StopStart120Lok(2, 1)
                Else
                    _StopZug2 = 2
                    StopStart120Lok(2, 2)
                End If
            Else
                A_StopH = 1
                _StopZug2 = 2
                StopStart120Lok(2, 2)
            End If
        End If
        If Kontakt.Modul = 0 And Kontakt.Adresse = 2 And Kontakt.status = True And _AutomatikParameterH = 221 Then
            Ort_Lok2 = 200
            If _StopZug2 = 0 And A_StopH = 0 Then
                If _Route_Gleis1 = 0 And _Route_Gleis2 = 0 Then
                    ' *** keine Aktion wenn beide Züge unten fahren
                ElseIf _Route_Gleis1 = 1 And _Route_Gleis2 = 1 Then
                    ' *** keine Aktion wenn beide Züge oben kurz fahren
                Else
                    If _Route_Gleis2 = 0 Then
                        _eb.weicheSchalten(17, Klassen.WeichenRichtung.links)
                    ElseIf _Route_Gleis2 = 1 Then
                        _eb.weicheSchalten(17, Klassen.WeichenRichtung.rechts)
                        _eb.weicheSchalten(27, Klassen.WeichenRichtung.rechts)
                    ElseIf _Route_Gleis2 = 2 Then
                        _eb.weicheSchalten(17, Klassen.WeichenRichtung.links)
                    End If
                End If
                AutomatikParameter = 200
            Else
                If _NachlaufZug2 = False Then
                    StopZug2()
                    Zug2(abstellen)
                Else
                    Zug2(nachlauf)
                End If
            End If
            _AutomatikParameterH = 0
        End If
    End Sub
    Private Sub Betriebsart3_0Var2(ByVal Kontakt As Klassen.Kontakt)
        ' *** Betriebsart 1/2=3 und ' *** Betriebsart 3/4=0
        ' ***
        ' *** Datum:          03.01.2025
        ' ***
        ' *** steuert die Fahrt des Zuges auf Gleis 1 und 2
        ' ***                
        ' ***

        ' ***
        ' *** Bahnhofsausfahrt Zug auf Gleis 1
        ' ***

        BahnhofsausfahrtLok1(Kontakt)


        If _Route_Gleis1 = 0 Then     ' *** Route "nur unten"

            NurUntenLok1(Kontakt)

        ElseIf _Route_Gleis1 = 1 Then ' *** Route "oben kurz"

            BergfahrtLok1(Kontakt)
            ObenKurzLok1(Kontakt)

        ElseIf _Route_Gleis1 = 2 Then ' *** Route "oben lang"

            BergfahrtLok1(Kontakt)
            ObenLangLok1(Kontakt)

        End If
        ' ***
        ' ***   Anhalten Lok1 im Bahnhof
        ' ***
        If Kontakt.Modul = 0 And Kontakt.Adresse = 1 And Kontakt.status = True And AutomatikParameter = 120 Then
            Ort_Lok1 = 100
            _AutomatikParameterH = 121
            If A_Stop = 0 Then
                A_StopH = 0
                If _Bhf_Gleis1 = 0 Then
                    _StopZug1 = 0
                    AutomatikParameter = 121
                ElseIf _Bhf_Gleis1 = 2 Then
                    _StopZug1 = 2
                    _Route_Gleis2 = ARoute_Lok2
                    ButtonsVisible(999)
                    StopStart120Lok(1, 2)
                Else
                    _StopZug1 = 1
                    StopStart120Lok(1, 1)
                End If
            Else
                A_StopH = 1
                _StopZug1 = 1
                StopStart120Lok(1, 1)
            End If
        End If
        If Kontakt.Modul = 0 And Kontakt.Adresse = 0 And Kontakt.status = True And _AutomatikParameterH = 121 Then
            If _StopZug1 = 0 And A_StopH = 0 Then
                If _Route_Gleis1 = 0 And _Route_Gleis2 = 0 Then
                    ' *** keine Aktion wenn beide Züge unten fahren
                ElseIf _Route_Gleis1 = 1 And _Route_Gleis2 = 1 Then
                    ' *** keine Aktion wenn beide Züge oben kurz fahren
                Else
                    If _Route_Gleis1 = 0 Then
                        _eb.weicheSchalten(17, Klassen.WeichenRichtung.links)
                    ElseIf _Route_Gleis1 = 1 Then
                        _eb.weicheSchalten(17, Klassen.WeichenRichtung.rechts)
                        _eb.weicheSchalten(27, Klassen.WeichenRichtung.rechts)
                    ElseIf _Route_Gleis1 = 2 Then
                        _eb.weicheSchalten(17, Klassen.WeichenRichtung.links)
                    End If
                End If
                AutomatikParameter = 100
            Else
                If _NachlaufZug1 = False Then
                    StopZug1()
                    Zug1(abstellen)
                Else
                    Zug1(nachlauf)
                End If
            End If
            _AutomatikParameterH = 0
        End If


        'BahnhofsausfahrtLok2(Kontakt)

        If Kontakt.Modul = 0 And Kontakt.Adresse = 3 And Kontakt.status = False And (AutomatikParameter = 200 Or AutomatikParameter = 206) Then
            AutomatikParameter = 210
        End If

        BergfahrtLok2(Kontakt)

        If Kontakt.Modul = 0 And Kontakt.Adresse = 4 And Kontakt.status = True And AutomatikParameter = 220 Then
            AutomatikParameter = 202
            Ort_Lok2 = 202
            Zug2(700)
        End If

        ' ***
        ' *** Ankunft im Bahnhof
        ' ***
        If Kontakt.Modul = 0 And Kontakt.Adresse = 2 And Kontakt.status = True And AutomatikParameter = 202 Then
            Ort_Lok2 = 205
            _AutomatikParameterH = 221
            If A_Stop = 0 Then
                A_StopH = 0
                If _Bhf2_Gleis2 = 0 Then
                    _StopZug2 = 0
                    AutomatikParameter = 221
                ElseIf _Bhf2_Gleis2 = 1 Then
                    _StopZug2 = 2
                    _Route_Gleis1 = ARoute_Lok1
                    ButtonsVisible(999)
                    StopStart120Lok(2, 1)
                Else
                    _StopZug2 = 2
                    StopStart120Lok(2, 2)
                End If
            Else
                A_StopH = 1
                _StopZug2 = 2
                StopStart120Lok(2, 2)
            End If
        End If
        If Kontakt.Modul = 0 And Kontakt.Adresse = 3 And Kontakt.status = True And _AutomatikParameterH = 221 Then
            If _StopZug2 = 0 And A_StopH = 0 Then
                AutomatikParameter = 200
            Else
                'Zug2(nachlauf)
                If _NachlaufZug2 = False Then
                    StopZug2()
                    Zug2(abstellen)
                Else
                    Zug2(nachlauf)
                End If
            End If
            _AutomatikParameterH = 0
        End If
    End Sub
    Private Sub Betriebsart3_0Var1(ByVal Kontakt As Klassen.Kontakt)
        ' ***
        ' *** Betriebsart 1/2=3 und ' *** Betriebsart 3/4=0 Variante 1
        ' ***
        ' *** Datum:          02.02.2022
        ' ***
        ' *** Kommentar allgemein            : kein
        ' ***   

        ' ***
        ' *** Programmstart Zug1 bis Signal 10 fahren
        ' ***
        If Kontakt.Modul = 0 And Kontakt.Adresse = 0 And Kontakt.status = False And AutomatikParameter = 90 Then
            _LokStufen.EinzelLokSenden(1, 3)
            AutomatikParameter = 91
        End If
        If Kontakt.Modul = 0 And Kontakt.Adresse = 5 And Kontakt.status = True And AutomatikParameter = 91 Then
            Ort_Lok1 = 102
            AutomatikParameter = 92
        End If
        If Kontakt.Modul = 0 And Kontakt.Adresse = 4 And Kontakt.status = True And AutomatikParameter = 92 Then
            _eb.weicheSchalten(11, Klassen.WeichenRichtung.rechts)
            Zug2(anfahren)
            Ort_Lok1 = 103
            AutomatikParameter = 200
        End If
        If Kontakt.Modul = 0 And Kontakt.Adresse = 2 And Kontakt.status = False And AutomatikParameter = 200 Then
            _LokStufen.EinzelLokSenden(2, 3)
            AutomatikParameter = 201
        End If
        If Kontakt.Modul = 0 And Kontakt.Adresse = 5 And Kontakt.status = True And AutomatikParameter = 201 Then
            Button81.BackColor = Drawing.Color.Red
            Timer_10.Interval = 3000
            Timer_10.Start()
            Ort_Lok2 = 202
            AutomatikParameter = 103
        End If
        'If Kontakt.Modul = 1 And Kontakt.Adresse = 2 And Kontakt.status = True And AutomatikParameter = 200 Then
        '    AutomatikParameter = 210
        'End If
        ' ***
        ' *** Anhalten Lok1 im Bahnhof ->
        ' ***
        If Kontakt.Modul = 0 And Kontakt.Adresse = 2 And Kontakt.status = True And AutomatikParameter = 103 Then
            _eb.weicheSchalten(10, Klassen.WeichenRichtung.rechts)
            Ort_Lok1 = 105
            AutomatikParameter = 104
            If _Kurzzug1 = True Then
                Zug1(bremsen_kurz_von_links)
            Else
                Zug1(bremsen)
            End If
            Button71.BackColor = Drawing.Color.Red
            Timer_EinzelLok1.Interval = NumericUpDown1.Value * 1000
            Timer_EinzelLok1.Start()
        End If
        If Kontakt.Modul = 0 And Kontakt.Adresse = 3 And Kontakt.status = True And AutomatikParameter = 104 Then
            StopZug1()
        End If
        If Kontakt.Modul = 0 And Kontakt.Adresse = 3 And Kontakt.status = False And AutomatikParameter = 106 Then
            _LokStufen.EinzelLokSenden(1, 3)
            AutomatikParameter = 110
        End If

        ' ***
        ' *** Bergfahrt Lok1
        ' ***

        BergfahrtLok1(Kontakt)

        If Kontakt.Modul = 0 And Kontakt.Adresse = 4 And Kontakt.status = True And AutomatikParameter = 202 Then
            _eb.weicheSchalten(23, Klassen.WeichenRichtung.links)
            _eb.weicheSchalten(11, Klassen.WeichenRichtung.rechts)
            Button91.BackColor = Drawing.Color.Red
            Timer_12.Interval = 3000
            Timer_12.Start()
            Ort_Lok2 = 103
            AutomatikParameter = 120
        End If
        ' ***
        ' *** Anhalten Lok1 im Bahnhof <-
        ' ***
        If Kontakt.Modul = 0 And Kontakt.Adresse = 1 And Kontakt.status = True And AutomatikParameter = 120 Then
            Ort_Lok1 = 100
            AutomatikParameter = 121
            If _Kurzzug1 = True Then
                Zug1(bremsen_kurz_von_rechts)
            Else
                Zug1(bremsen)
            End If
            Button31.BackColor = Drawing.Color.Red
            Timer_EinzelLok1.Interval = NumericUpDown1.Value * 1000
            Timer_EinzelLok1.Start()
        End If
        If Kontakt.Modul = 0 And Kontakt.Adresse = 0 And Kontakt.status = True And AutomatikParameter = 121 Then
            StopZug1()
        End If
        If Kontakt.Modul = 0 And Kontakt.Adresse = 0 And Kontakt.status = False And AutomatikParameter = 100 Then
            _LokStufen.EinzelLokSenden(1, 3)
            AutomatikParameter = 101
        End If
        If Kontakt.Modul = 0 And Kontakt.Adresse = 5 And Kontakt.status = True And AutomatikParameter = 101 Then
            Button82.BackColor = Drawing.Color.Red
            Timer_10.Interval = 3000
            Timer_10.Start()
            Ort_Lok1 = 102
            AutomatikParameter = 203
        End If
        ' ***
        ' *** Anhalten Lok2 im Bahnhof ->
        ' ***
        If Kontakt.Modul = 0 And Kontakt.Adresse = 2 And Kontakt.status = True And AutomatikParameter = 203 Then
            _eb.weicheSchalten(10, Klassen.WeichenRichtung.rechts)
            Ort_Lok2 = 205
            AutomatikParameter = 204
            If _Kurzzug2 = True Then
                Zug2(bremsen_kurz_von_links)
            Else
                Zug2(bremsen)
            End If
            Button72.BackColor = Drawing.Color.Red
            Timer_EinzelLok2.Interval = NumericUpDown2.Value * 1000
            Timer_EinzelLok2.Start()
        End If
        If Kontakt.Modul = 0 And Kontakt.Adresse = 3 And Kontakt.status = True And AutomatikParameter = 204 Then
            StopZug2()
        End If
        If Kontakt.Modul = 0 And Kontakt.Adresse = 3 And Kontakt.status = False And AutomatikParameter = 206 Then
            _LokStufen.EinzelLokSenden(2, 3)
            AutomatikParameter = 210
        End If
        ' ***
        ' *** Bergfahrt Lok2
        ' ***
        BergfahrtLok2(Kontakt)

        If Kontakt.Modul = 0 And Kontakt.Adresse = 4 And Kontakt.status = True And AutomatikParameter = 102 Then
            _eb.weicheSchalten(23, Klassen.WeichenRichtung.links)
            _eb.weicheSchalten(11, Klassen.WeichenRichtung.rechts)
            Button92.BackColor = Drawing.Color.Red
            Timer_12.Interval = 3000
            Timer_12.Start()
            Ort_Lok1 = 103
            AutomatikParameter = 220
        End If
        ' ***
        ' *** Anhalten Lok2 im Bahnhof <-
        ' ***
        If Kontakt.Modul = 0 And Kontakt.Adresse = 1 And Kontakt.status = True And AutomatikParameter = 220 Then
            Ort_Lok2 = 200
            AutomatikParameter = 221
            If _Kurzzug2 = True Then
                Zug2(bremsen_kurz_von_rechts)
            Else
                Zug2(bremsen)
            End If
            Button32.BackColor = Drawing.Color.Red
            Timer_EinzelLok2.Interval = NumericUpDown2.Value * 1000
            Timer_EinzelLok2.Start()
        End If
        If Kontakt.Modul = 0 And Kontakt.Adresse = 0 And Kontakt.status = True And AutomatikParameter = 221 Then
            StopZug2()
        End If
        If Kontakt.Modul = 0 And Kontakt.Adresse = 0 And Kontakt.status = False And AutomatikParameter = 200 Then
            _LokStufen.EinzelLokSenden(2, 3)
            AutomatikParameter = 201
        End If
    End Sub
    Private Sub Betriebsart3_3(ByVal Kontakt As Klassen.Kontakt)
        ' *** Betriebsart 1/2=3 und ' *** Betriebsart 3/4=3
        ' ***
        ' *** Datum:          01.03.2021
        ' ***
        ' *** Kommentar allgemein              : kein
        ' ***
        ' ***
        ' ***


        ' ***
        ' *** Bahnhofsausfahrt Zug auf Gleis 1
        ' ***
        BahnhofsausfahrtLok1(Kontakt)

        If _Route_Gleis1 = 0 Then     ' *** Route "nur unten"

            NurUntenLok1(Kontakt)

        ElseIf _Route_Gleis1 = 1 Then ' *** Route "oben kurz"

            ObenKurzLok1(Kontakt)
            BergfahrtLok1(Kontakt)

        ElseIf _Route_Gleis1 = 2 Then ' *** Route "oben lang"

            ObenLangLok1(Kontakt)
            BergfahrtLok1(Kontakt)

        End If
        ' ***
        ' *** Ankunft im Bahnhof
        ' ***
        If Kontakt.Modul = 0 And Kontakt.Adresse = 1 And Kontakt.status = True And AutomatikParameter = 120 Then
            Ort_Lok1 = 100
            _AutomatikParameterH = 121
            If A_Stop = 0 Then
                A_StopH = 0
                If _Bhf_Gleis1 = 0 Then
                    _StopZug1 = 0
                    AutomatikParameter = 121
                ElseIf _Bhf_Gleis1 = 2 Then
                    _StopZug1 = 2
                    StopStart120Lok(1, 2)
                ElseIf _Bhf_Gleis1 = 3 Then
                    _StopZug1 = 3
                    StopStart120Lok(1, 3)
                Else
                    _StopZug1 = 1
                    StopStart120Lok(1, 1)
                End If
            Else
                A_StopH = 1
                _StopZug1 = 1
                StopStart120Lok(1, 1)
            End If
        End If
        If Kontakt.Modul = 0 And Kontakt.Adresse = 0 And Kontakt.status = True And _AutomatikParameterH = 121 Then
            If _StopZug1 = 0 And A_StopH = 0 Then
                If _Route_Gleis1 = 0 And _Route_Gleis2 = 0 And _Route_Gleis3 = 0 Then
                    ' *** keine Aktion wenn alle Züge unten fahren
                ElseIf _Route_Gleis1 = 0 And _Route_Gleis2 = 0 And _Route_Gleis3 = 1 Then
                    ' *** keine Aktion erforderlich
                ElseIf _Route_Gleis1 = 1 And _Route_Gleis2 = 1 And _Route_Gleis3 = 0 Then
                    ' *** keine Aktion erforderlich
                ElseIf _Route_Gleis1 = 1 And _Route_Gleis2 = 1 And _Route_Gleis3 = 1 Then
                    ' *** keine Aktion erforderlich
                ElseIf _Route_Gleis1 = 1 And _Route_Gleis2 = 1 And _Route_Gleis3 = 2 Then
                    ' *** keine Aktion erforderlich
                Else
                    If _Route_Gleis1 = 0 Then
                        _eb.weicheSchalten(17, Klassen.WeichenRichtung.links)
                    ElseIf _Route_Gleis1 = 1 Then
                        _eb.weicheSchalten(17, Klassen.WeichenRichtung.rechts)
                        _eb.weicheSchalten(27, Klassen.WeichenRichtung.rechts)
                    ElseIf _Route_Gleis1 = 2 Then
                        _eb.weicheSchalten(17, Klassen.WeichenRichtung.links)
                    End If
                End If
                AutomatikParameter = 100
            Else
                If _NachlaufZug1 = False Then
                    StopZug1()
                    Zug1(abstellen)
                Else
                    Zug1(nachlauf)
                End If
            End If
            _AutomatikParameterH = 0
        End If

        ' ***
        ' *** Bahnhofsausfahrt Zug auf Gleis 2
        ' ***

        BahnhofsausfahrtLok2(Kontakt)

        If _Route_Gleis2 = 0 Then     ' *** Route "nur unten"

            NurUntenLok2(Kontakt)

        ElseIf _Route_Gleis2 = 1 Then ' *** Route "oben kurz"

            ObenKurzLok2(Kontakt)
            BergfahrtLok2(Kontakt)

        ElseIf _Route_Gleis2 = 2 Then ' *** Route "oben lang"

            ObenLangLok2(Kontakt)
            BergfahrtLok2(Kontakt)

        End If
        ' ***
        ' *** Ankunft im Bahnhof
        ' ***
        If Kontakt.Modul = 0 And Kontakt.Adresse = 3 And Kontakt.status = True And AutomatikParameter = 220 Then
            Ort_Lok2 = 200
            _AutomatikParameterH = 221
            If A_Stop = 0 Then
                A_StopH = 0
                If _Bhf_Gleis2 = 0 Then
                    _StopZug2 = 0
                    AutomatikParameter = 221
                ElseIf _Bhf_Gleis2 = 1 Then
                    _StopZug2 = 1
                    StopStart120Lok(2, 1)
                ElseIf _Bhf_Gleis2 = 3 Then
                    _StopZug2 = 3
                    StopStart120Lok(2, 3)
                Else
                    _StopZug2 = 2
                    StopStart120Lok(2, 2)
                End If
            Else
                A_StopH = 1
                _StopZug2 = 2
                StopStart120Lok(2, 2)
            End If
        End If
        If Kontakt.Modul = 0 And Kontakt.Adresse = 2 And Kontakt.status = True And _AutomatikParameterH = 221 Then
            If _StopZug2 = 0 And A_StopH = 0 Then
                If _Route_Gleis1 = 0 And _Route_Gleis2 = 0 And _Route_Gleis3 = 0 Then
                    ' *** keine Aktion wenn alle Züge unten fahren
                ElseIf _Route_Gleis1 = 0 And _Route_Gleis2 = 0 And _Route_Gleis3 = 1 Then
                    ' *** keine Aktion erforderlich
                ElseIf _Route_Gleis1 = 1 And _Route_Gleis2 = 1 And _Route_Gleis3 = 0 Then
                    ' *** keine Aktion erforderlich
                ElseIf _Route_Gleis1 = 1 And _Route_Gleis2 = 1 And _Route_Gleis3 = 1 Then
                    ' *** keine Aktion erforderlich
                ElseIf _Route_Gleis1 = 1 And _Route_Gleis2 = 1 And _Route_Gleis3 = 2 Then
                    ' *** keine Aktion erforderlich
                Else
                    If _Route_Gleis2 = 0 Then
                        _eb.weicheSchalten(17, Klassen.WeichenRichtung.links)
                    ElseIf _Route_Gleis2 = 1 Then
                        _eb.weicheSchalten(17, Klassen.WeichenRichtung.rechts)
                        _eb.weicheSchalten(27, Klassen.WeichenRichtung.rechts)
                    ElseIf _Route_Gleis2 = 2 Then
                        _eb.weicheSchalten(17, Klassen.WeichenRichtung.links)
                    End If
                End If
                AutomatikParameter = 200
            Else
                If _NachlaufZug2 = False Then
                    StopZug2()
                    Zug2(abstellen)
                Else
                    Zug2(nachlauf)
                End If
            End If
            _AutomatikParameterH = 0
        End If

        ' ***
        ' *** Bahnhofsausfahrt Zug auf Gleis 3
        ' ***

        BahnhofsausfahrtLok3(Kontakt)

        If _Route_Gleis3 = 0 Then     ' *** Route "nur unten"

            NurUntenLok3(Kontakt)

        ElseIf _Route_Gleis3 = 1 Then ' *** Route "oben kurz"

            BergfahrtLok3(Kontakt)
            ObenKurzLok3(Kontakt)

        ElseIf _Route_Gleis3 = 2 Then ' *** Route "oben lang"

            BergfahrtLok3(Kontakt)
            ObenLangLok3(Kontakt)

        End If
        ' ***
        ' *** Ankunft im Bahnhof
        ' ***
        If Kontakt.Modul = 1 And Kontakt.Adresse = 7 And Kontakt.status = True And AutomatikParameter = 320 Then
            Ort_Lok3 = 300
            _AutomatikParameterH = 321
            If A_Stop = 0 Then
                A_StopH = 0
                If _Bhf_Gleis3 = 0 Then
                    _StopZug3 = 0
                    AutomatikParameter = 321
                ElseIf _Bhf_Gleis3 = 1 Then
                    _StopZug3 = 1
                    StopStart120Lok(3, 1)
                ElseIf _Bhf_Gleis3 = 2 Then
                    _StopZug3 = 2
                    StopStart120Lok(3, 2)
                Else
                    _StopZug3 = 3
                    StopStart120Lok(3, 3)
                End If
            Else
                A_StopH = 1
                _StopZug3 = 3
                StopStart120Lok(3, 3)
            End If
        End If
        If Kontakt.Modul = 1 And Kontakt.Adresse = 6 And Kontakt.status = True And _AutomatikParameterH = 321 Then
            If _StopZug3 = 0 And A_StopH = 0 Then
                If _Route_Gleis1 = 0 And _Route_Gleis2 = 0 And _Route_Gleis3 = 0 Then
                    ' *** keine Aktion wenn alle Züge unten fahren
                ElseIf _Route_Gleis1 = 0 And _Route_Gleis2 = 0 And _Route_Gleis3 = 1 Then
                    ' *** keine Aktion erforderlich
                ElseIf _Route_Gleis1 = 1 And _Route_Gleis2 = 1 And _Route_Gleis3 = 0 Then
                    ' *** keine Aktion erforderlich
                ElseIf _Route_Gleis1 = 1 And _Route_Gleis2 = 1 And _Route_Gleis3 = 1 Then
                    ' *** keine Aktion erforderlich
                ElseIf _Route_Gleis1 = 1 And _Route_Gleis2 = 1 And _Route_Gleis3 = 2 Then
                    ' *** keine Aktion erforderlich
                Else
                    If _Route_Gleis3 = 0 Then
                        _eb.weicheSchalten(27, Klassen.WeichenRichtung.links)
                    ElseIf _Route_Gleis3 = 1 Then
                        _eb.weicheSchalten(17, Klassen.WeichenRichtung.rechts)
                    ElseIf _Route_Gleis3 = 2 Then
                        _eb.weicheSchalten(17, Klassen.WeichenRichtung.rechts)
                    End If
                End If
                AutomatikParameter = 300
            Else
                If _NachlaufZug3 = False Then
                    StopZug3()
                    Zug3(abstellen)
                Else
                    Zug3(nachlauf)
                End If
            End If
            _AutomatikParameterH = 0
        End If
    End Sub
    Private Sub Betriebsart3_4(ByVal Kontakt As Klassen.Kontakt)
        ' *** Betriebsart 1/2=3 und ' *** Betriebsart 3/4=4
        ' ***
        ' *** Datum:          14.01.2020
        ' ***
        ' *** Kommentar allgemein              : kein
        ' *** 
        ' ***

        ' ***
        ' *** Bahnhofsausfahrt Zug auf Gleis 1
        ' ***

        BahnhofsausfahrtLok1(Kontakt)

        If _Route_Gleis1 = 0 Then     ' *** Route "nur unten"

            NurUntenLok1(Kontakt)

        ElseIf _Route_Gleis1 = 1 Then ' *** Route "oben kurz"

            ObenKurzLok1(Kontakt)
            BergfahrtLok1(Kontakt)

        ElseIf _Route_Gleis1 = 2 Then ' *** Route "oben lang"

            ObenLangLok1(Kontakt)
            BergfahrtLok1(Kontakt)

        End If
        ' ***
        ' *** Ankunft im Bahnhof
        ' ***
        If Kontakt.Modul = 0 And Kontakt.Adresse = 1 And Kontakt.status = True And AutomatikParameter = 120 Then
            Ort_Lok1 = 100
            _AutomatikParameterH = 121
            If A_Stop = 0 Then
                A_StopH = 0
                If _Bhf_Gleis1 = 0 Then
                    _StopZug1 = 0
                    AutomatikParameter = 121
                ElseIf _Bhf_Gleis1 = 2 Then
                    _StopZug1 = 2
                    StopStart120Lok(1, 2)
                ElseIf _Bhf_Gleis1 = 4 Then
                    _StopZug1 = 4
                    StopStart120Lok(1, 4)
                Else
                    _StopZug1 = 1
                    StopStart120Lok(1, 1)
                End If
            Else
                A_StopH = 1
                _StopZug1 = 1
                StopStart120Lok(1, 1)
            End If
        End If
        If Kontakt.Modul = 0 And Kontakt.Adresse = 0 And Kontakt.status = True And _AutomatikParameterH = 121 Then
            If _StopZug1 = 0 And A_StopH = 0 Then
                If _Route_Gleis1 = 0 And _Route_Gleis2 = 0 And _Route_Gleis4 = 0 Then
                    ' *** keine Aktion wenn alle Züge unten fahren
                Else
                    If _Route_Gleis1 = 0 Then
                        _eb.weicheSchalten(17, Klassen.WeichenRichtung.links)
                    ElseIf _Route_Gleis1 = 1 Then
                        _eb.weicheSchalten(17, Klassen.WeichenRichtung.rechts)
                        _eb.weicheSchalten(27, Klassen.WeichenRichtung.rechts)
                    ElseIf _Route_Gleis1 = 2 Then
                        _eb.weicheSchalten(17, Klassen.WeichenRichtung.links)
                    End If
                End If
                AutomatikParameter = 100
            Else
                If _NachlaufZug1 = False Then
                    StopZug1()
                    Zug1(abstellen)
                Else
                    Zug1(nachlauf)
                End If
            End If
            _AutomatikParameterH = 0
        End If

        ' Zug auf Gleis 2 faehrt los

        BahnhofsausfahrtLok2(Kontakt)

        If _Route_Gleis2 = 0 Then     ' *** Route "nur unten"

            NurUntenLok2(Kontakt)

        ElseIf _Route_Gleis2 = 1 Then ' *** Route "oben kurz"

            ObenKurzLok2(Kontakt)
            BergfahrtLok2(Kontakt)

        ElseIf _Route_Gleis2 = 2 Then ' *** Route "oben lang"

            ObenLangLok2(Kontakt)
            BergfahrtLok2(Kontakt)

        End If
        ' ***
        ' *** Ankunft im Bahnhof
        ' ***
        If Kontakt.Modul = 0 And Kontakt.Adresse = 3 And Kontakt.status = True And AutomatikParameter = 220 Then
            Ort_Lok2 = 200
            _AutomatikParameterH = 221
            If A_Stop = 0 Then
                A_StopH = 0
                If _Bhf_Gleis2 = 0 Then
                    _StopZug2 = 0
                    AutomatikParameter = 221
                ElseIf _Bhf_Gleis2 = 1 Then
                    _StopZug2 = 1
                    StopStart120Lok(2, 1)
                ElseIf _Bhf_Gleis2 = 4 Then
                    _StopZug2 = 4
                    StopStart120Lok(2, 4)
                Else
                    _StopZug2 = 2
                    StopStart120Lok(2, 2)
                End If
            Else
                A_StopH = 1
                _StopZug2 = 2
                StopStart120Lok(2, 2)
            End If
        End If
        If Kontakt.Modul = 0 And Kontakt.Adresse = 2 And Kontakt.status = True And _AutomatikParameterH = 221 Then
            If _StopZug2 = 0 And A_StopH = 0 Then
                If _Route_Gleis1 = 0 And _Route_Gleis2 = 0 And _Route_Gleis4 = 0 Then
                    ' *** keine Aktion wenn alle Züge unten fahren
                Else
                    If _Route_Gleis2 = 0 Then
                        _eb.weicheSchalten(17, Klassen.WeichenRichtung.links)
                    ElseIf _Route_Gleis2 = 1 Then
                        _eb.weicheSchalten(17, Klassen.WeichenRichtung.rechts)
                        _eb.weicheSchalten(27, Klassen.WeichenRichtung.rechts)
                    ElseIf _Route_Gleis2 = 2 Then
                        _eb.weicheSchalten(17, Klassen.WeichenRichtung.links)
                    End If
                End If
                AutomatikParameter = 200
            Else
                If _NachlaufZug2 = False Then
                    StopZug2()
                    Zug2(abstellen)
                Else
                    Zug2(nachlauf)
                End If
            End If
            _AutomatikParameterH = 0
        End If
        ' Zug auf Gleis 4 faehrt los

        BahnhofsausfahrtLok4(Kontakt)

        If _Route_Gleis4 = 0 Then     ' *** Route "nur unten"

            NurUntenLok4(Kontakt)

        ElseIf _Route_Gleis4 = 1 Then ' *** Route "oben kurz"

            BergfahrtLok4(Kontakt)
            ObenKurzLok4(Kontakt)

        ElseIf _Route_Gleis4 = 2 Then ' *** Route "oben lang"

            BergfahrtLok4(Kontakt)
            ObenLangLok4(Kontakt)

        End If
        ' ***
        ' *** Ankunft im Bahnhof
        ' ***
        If Kontakt.Modul = 1 And Kontakt.Adresse = 5 And Kontakt.status = True And AutomatikParameter = 420 Then
            Ort_Lok4 = 400
            _AutomatikParameterH = 421
            If A_Stop = 0 Then
                A_StopH = 0
                If _Bhf_Gleis4 = 0 Then
                    _StopZug4 = 0
                    AutomatikParameter = 421
                ElseIf _Bhf_Gleis4 = 1 Then
                    _StopZug4 = 1
                    StopStart120Lok(4, 1)
                ElseIf _Bhf_Gleis4 = 2 Then
                    _StopZug4 = 2
                    StopStart120Lok(4, 2)
                ElseIf _Bhf_Gleis4 = 4 Then
                    _StopZug4 = 4
                    StopStart120Lok(4, 4)
                End If
            Else
                A_StopH = 1
                _StopZug4 = 4
                StopStart120Lok(4, 4)
            End If
        End If
        If Kontakt.Modul = 1 And Kontakt.Adresse = 4 And Kontakt.status = True And _AutomatikParameterH = 421 Then
            If _StopZug4 = 0 And A_StopH = 0 Then
                If _Route_Gleis1 = 0 And _Route_Gleis2 = 0 And _Route_Gleis4 = 0 Then
                    ' *** keine Aktion wenn alle Züge unten fahren
                Else
                    If _Route_Gleis1 = 0 Then
                        _eb.weicheSchalten(17, Klassen.WeichenRichtung.links)
                    ElseIf _Route_Gleis1 = 1 Then
                        _eb.weicheSchalten(17, Klassen.WeichenRichtung.rechts)
                    ElseIf _Route_Gleis1 = 2 Then
                        _eb.weicheSchalten(17, Klassen.WeichenRichtung.links)
                    End If
                End If
                AutomatikParameter = 400
            Else
                If _NachlaufZug4 = False Then
                    StopZug4()
                    Zug4(abstellen)
                Else
                    Zug4(nachlauf)
                End If
            End If
            _AutomatikParameterH = 0
        End If
    End Sub
    Private Sub Betriebsart3_5(ByVal Kontakt As Klassen.Kontakt)
        ' *** Betriebsart 1/2=3 und ' *** Betriebsart 3/4=5
        ' ***
        ' *** Datum:          14.01.2020
        ' ***
        ' *** Kommentar allgemein                : kein
        ' ***
        ' ***

        ' ***
        ' *** Bahnhofsausfahrt Zug auf Gleis 1
        ' ***

        BahnhofsausfahrtLok1(Kontakt)

        If _Route_Gleis1 = 0 Then     ' *** Route "nur unten"

            NurUntenLok1(Kontakt)

        ElseIf _Route_Gleis1 = 1 Then ' *** Route "oben kurz"

            ObenKurzLok1(Kontakt)
            BergfahrtLok1(Kontakt)

        ElseIf _Route_Gleis1 = 2 Then ' *** Route "oben lang"

            ObenLangLok1(Kontakt)
            BergfahrtLok1(Kontakt)

        End If
        ' ***
        ' *** Ankunft im Bahnhof
        ' ***
        If Kontakt.Modul = 0 And Kontakt.Adresse = 1 And Kontakt.status = True And AutomatikParameter = 120 Then
            Ort_Lok1 = 100
            _AutomatikParameterH = 121
            If A_Stop = 0 Then
                A_StopH = 0
                If _Bhf_Gleis1 = 0 Then
                    _StopZug1 = 0
                    AutomatikParameter = 121
                ElseIf _Bhf_Gleis1 = 2 Then
                    _StopZug1 = 2
                    StopStart120Lok(1, 2)
                ElseIf _Bhf_Gleis1 = 3 Then
                    _StopZug1 = 3
                    StopStart120Lok(1, 3)
                ElseIf _Bhf_Gleis1 = 4 Then
                    _StopZug1 = 4
                    StopStart120Lok(1, 4)
                ElseIf _Bhf_Gleis1 = 1 Then
                    _StopZug1 = 1
                    StopStart120Lok(1, 1)
                End If
            Else
                A_StopH = 1
                _StopZug1 = 1
                StopStart120Lok(1, 1)
            End If
        End If
        If Kontakt.Modul = 0 And Kontakt.Adresse = 0 And Kontakt.status = True And _AutomatikParameterH = 121 Then
            If _StopZug1 = 0 And A_StopH = 0 Then
                If _Route_Gleis1 = 0 And _Route_Gleis2 = 0 And _Route_Gleis3 = 0 And _Route_Gleis4 = 0 Then
                    ' *** keine Aktion wenn alle Züge unten fahren
                Else
                    If _Route_Gleis1 = 0 Then
                        _eb.weicheSchalten(17, Klassen.WeichenRichtung.links)
                    ElseIf _Route_Gleis1 = 1 Then
                        _eb.weicheSchalten(17, Klassen.WeichenRichtung.rechts)
                        _eb.weicheSchalten(27, Klassen.WeichenRichtung.rechts)
                    ElseIf _Route_Gleis1 = 2 Then
                        _eb.weicheSchalten(17, Klassen.WeichenRichtung.links)
                    End If
                End If
                AutomatikParameter = 100
            Else
                If _NachlaufZug1 = False Then
                    StopZug1()
                    Zug1(abstellen)
                Else
                    Zug1(nachlauf)
                End If
            End If
            _AutomatikParameterH = 0
        End If

        ' ***
        ' *** Zug 2 Anfahren
        ' ***
        BahnhofsausfahrtLok2(Kontakt)

        If _Route_Gleis2 = 0 Then     ' *** Route "nur unten"

            NurUntenLok2(Kontakt)

        ElseIf _Route_Gleis2 = 1 Then ' *** Route "oben kurz"

            ObenKurzLok2(Kontakt)
            BergfahrtLok2(Kontakt)

        ElseIf _Route_Gleis2 = 2 Then ' *** Route "oben lang"

            ObenLangLok2(Kontakt)
            BergfahrtLok2(Kontakt)

        End If
        ' ***
        ' *** Ankunft im Bahnhof
        ' ***
        If Kontakt.Modul = 0 And Kontakt.Adresse = 3 And Kontakt.status = True And AutomatikParameter = 220 Then
            Ort_Lok2 = 200
            _AutomatikParameterH = 221
            If A_Stop = 0 Then
                A_StopH = 0
                If _Bhf_Gleis2 = 0 Then
                    _StopZug2 = 0
                    AutomatikParameter = 221
                ElseIf _Bhf_Gleis2 = 1 Then
                    _StopZug2 = 1
                    StopStart120Lok(2, 1)
                ElseIf _Bhf_Gleis2 = 3 Then
                    _StopZug2 = 3
                    StopStart120Lok(2, 3)
                ElseIf _Bhf_Gleis2 = 4 Then
                    _StopZug2 = 4
                    StopStart120Lok(2, 4)
                ElseIf _Bhf_Gleis2 = 2 Then
                    _StopZug2 = 2
                    StopStart120Lok(2, 2)
                End If
            Else
                A_StopH = 1
                _StopZug2 = 2
                StopStart120Lok(2, 2)
            End If
        End If
        If Kontakt.Modul = 0 And Kontakt.Adresse = 2 And Kontakt.status = True And _AutomatikParameterH = 221 Then
            If _StopZug2 = 0 And A_StopH = 0 Then
                If _Route_Gleis1 = 0 And _Route_Gleis2 = 0 And _Route_Gleis3 = 0 And _Route_Gleis4 = 0 Then
                    ' *** keine Aktion wenn alle Züge unten fahren
                Else
                    If _Route_Gleis2 = 0 Then
                        _eb.weicheSchalten(17, Klassen.WeichenRichtung.links)
                    ElseIf _Route_Gleis2 = 1 Then
                        _eb.weicheSchalten(17, Klassen.WeichenRichtung.rechts)
                        _eb.weicheSchalten(27, Klassen.WeichenRichtung.rechts)
                    ElseIf _Route_Gleis2 = 2 Then
                        _eb.weicheSchalten(17, Klassen.WeichenRichtung.links)
                    End If
                End If
                AutomatikParameter = 200
            Else
                If _NachlaufZug2 = False Then
                    StopZug2()
                    Zug2(abstellen)
                Else
                    Zug2(nachlauf)
                End If
            End If
            _AutomatikParameterH = 0
        End If

        ' ***
        ' *** Zug 3 Anfahren
        ' ***
        BahnhofsausfahrtLok3(Kontakt)

        If _Route_Gleis3 = 0 Then     ' *** Route "nur unten"

            NurUntenLok3(Kontakt)

        ElseIf _Route_Gleis3 = 1 Then ' *** Route "oben kurz"

            BergfahrtLok3(Kontakt)
            ObenKurzLok3(Kontakt)

        ElseIf _Route_Gleis3 = 2 Then ' *** Route "oben lang"

            BergfahrtLok3(Kontakt)
            ObenLangLok3(Kontakt)

        End If
        ' ***
        ' *** Ankunft im Bahnhof
        ' ***
        If Kontakt.Modul = 1 And Kontakt.Adresse = 7 And Kontakt.status = True And AutomatikParameter = 320 Then
            Ort_Lok3 = 300
            _AutomatikParameterH = 321
            If A_Stop = 0 Then
                A_StopH = 0
                If _Bhf_Gleis3 = 0 Then
                    _StopZug3 = 0
                    AutomatikParameter = 321
                ElseIf _Bhf_Gleis3 = 1 Then
                    _StopZug3 = 1
                    StopStart120Lok(3, 1)
                ElseIf _Bhf_Gleis3 = 2 Then
                    _StopZug3 = 2
                    StopStart120Lok(3, 2)
                ElseIf _Bhf_Gleis3 = 4 Then
                    _StopZug3 = 4
                    StopStart120Lok(3, 4)
                ElseIf _Bhf_Gleis3 = 3 Then
                    _StopZug3 = 3
                    StopStart120Lok(3, 3)
                End If
            Else
                A_StopH = 1
                _StopZug3 = 3
                StopStart120Lok(3, 3)
            End If
        End If
        If Kontakt.Modul = 1 And Kontakt.Adresse = 6 And Kontakt.status = True And _AutomatikParameterH = 321 Then
            If _StopZug3 = 0 And A_StopH = 0 Then
                If _Route_Gleis1 = 0 And _Route_Gleis2 = 0 And _Route_Gleis3 = 0 And _Route_Gleis4 = 0 Then
                    ' *** keine Aktion wenn alle Züge unten fahren
                Else
                    If _Route_Gleis3 = 0 Then
                        _eb.weicheSchalten(27, Klassen.WeichenRichtung.links)
                    ElseIf _Route_Gleis3 = 1 Then
                        _eb.weicheSchalten(27, Klassen.WeichenRichtung.rechts)
                    ElseIf _Route_Gleis3 = 2 Then
                        _eb.weicheSchalten(27, Klassen.WeichenRichtung.rechts)
                    End If
                End If
                AutomatikParameter = 300
            Else
                If _NachlaufZug3 = False Then
                    StopZug3()
                    Zug3(abstellen)
                Else
                    Zug3(nachlauf)
                End If
            End If
            _AutomatikParameterH = 0
        End If

        ' ***
        ' *** Zug 4 Anfahren
        ' ***
        BahnhofsausfahrtLok4(Kontakt)

        If _Route_Gleis4 = 0 Then     ' *** Route "nur unten"

            NurUntenLok4(Kontakt)

        ElseIf _Route_Gleis4 = 1 Then ' *** Route "oben kurz"

            BergfahrtLok4(Kontakt)
            ObenKurzLok4(Kontakt)

        ElseIf _Route_Gleis4 = 2 Then ' *** Route "oben lang"

            BergfahrtLok4(Kontakt)
            ObenLangLok4(Kontakt)

        End If
        ' ***
        ' *** Ankunft im Bahnhof
        ' ***
        If Kontakt.Modul = 1 And Kontakt.Adresse = 5 And Kontakt.status = True And AutomatikParameter = 420 Then
            Ort_Lok4 = 400
            _AutomatikParameterH = 421
            If A_Stop = 0 Then
                A_StopH = 0
                If _Bhf_Gleis4 = 0 Then
                    _StopZug4 = 0
                    AutomatikParameter = 421
                ElseIf _Bhf_Gleis4 = 1 Then
                    _StopZug4 = 1
                    StopStart120Lok(4, 1)
                ElseIf _Bhf_Gleis4 = 2 Then
                    _StopZug4 = 2
                    StopStart120Lok(4, 2)
                ElseIf _Bhf_Gleis4 = 3 Then
                    _StopZug4 = 3
                    StopStart120Lok(4, 3)
                ElseIf _Bhf_Gleis4 = 4 Then
                    _StopZug4 = 4
                    StopStart120Lok(4, 4)
                End If
            Else
                A_StopH = 1
                _StopZug4 = 4
                StopStart120Lok(4, 4)
            End If
        End If
        If Kontakt.Modul = 1 And Kontakt.Adresse = 4 And Kontakt.status = True And _AutomatikParameterH = 421 Then
            If _StopZug4 = 0 And A_StopH = 0 Then
                If _Route_Gleis1 = 0 And _Route_Gleis2 = 0 And _Route_Gleis3 = 0 And _Route_Gleis4 = 0 Then
                    ' *** keine Aktion wenn alle Züge unten fahren
                Else
                    If _Route_Gleis3 = 0 Then
                        _eb.weicheSchalten(27, Klassen.WeichenRichtung.links)
                    ElseIf _Route_Gleis3 = 1 Then
                        _eb.weicheSchalten(27, Klassen.WeichenRichtung.rechts)
                    ElseIf _Route_Gleis3 = 2 Then
                        _eb.weicheSchalten(27, Klassen.WeichenRichtung.rechts)
                    End If
                End If
                AutomatikParameter = 400
            Else
                If _NachlaufZug4 = False Then
                    StopZug4()
                    Zug4(abstellen)
                Else
                    Zug4(nachlauf)
                End If
            End If
            _AutomatikParameterH = 0
        End If
    End Sub

    ' *** Betriebsart 3: Story
    Private Sub Betriebsart3_Story(Kontakt)
        ' *** Betriebsart = 3         Das kalte Herz
        ' *** Kommentar:      für "Das kalte Herz"
        ' ***                 
        ' *** Datum:          18.01.2018
        ' *** getestet:       Kurzug:          nein
        ' ***                 Schattenbahnhof: nein
        ' ***                 Route Gleis 2  : nein
        ' ***                 Weichen stellen: nein
        ' ***                 Signale stellen: nein
        ' ***                 Weichen überwa.: nein
        ' ***                 Signale überwa.: nein
        ' ***                 Stop-Funktion  : nein
        ' ***                 Berg-Geschw.   : nein
        ' ***
        ' *** Anfahren von Zug 2 - Fahrweg schalten - Bahnhofsausfahrt
        ' ***

        ' ***
        ' *** Einführung
        ' ***
        If _StoryPointer = 0 And AutomatikParameter = 0 Then
            '_eb.weicheSchalten(9, Klassen.WeichenRichtung.links)
            '_LokStufen.EinzelLokSenden(3, 3)
            'AutomatikParameter = 1300
            _StoryPointer = 1
        End If
        If Kontakt.IsActive(1, 7) And AutomatikParameter = 1300 Then
            AutomatikParameter = 1301
        End If
        If Kontakt.IsActive(1, 6) And AutomatikParameter = 1301 Then
            AutomatikParameter = 1302
        End If
        If Kontakt.Modul = 1 And Kontakt.Adresse = 6 And Kontakt.status = False And (AutomatikParameter = 1302 Or AutomatikParameter = 1300) Then
            _eb.weicheSchalten(9, Klassen.WeichenRichtung.rechts)
            AutomatikParameter = 1303
        End If
        If Kontakt.IsActive(1, 3) And AutomatikParameter = 1303 Then
            If A_Stop = 1 Then
                Zyklusende()
            Else
                If _StoryControl < 3 Then
                    _LokStufen.EinzelLokSenden(3, 0)
                    _LokStufen.EinzelLokSenden(2, 0)
                    _eb.weicheSchalten(11, Klassen.WeichenRichtung.links)
                    _LokStufen.EinzelLokSenden(2, 3)
                    AutomatikParameter = 1200
                End If
                If _StoryControl = 3 Then
                    _LokStufen.EinzelLokSenden(3, 0)
                    StoryText = "weiter"
                    StoryColor = Drawing.Color.LightGray
                    AutomatikParameter = 1200
                End If
            End If
        End If
        If Kontakt.IsActive(0, 3) And AutomatikParameter = 1200 Then
            AutomatikParameter = 1201
        End If
        If Kontakt.IsActive(0, 2) And AutomatikParameter = 1201 Then
            AutomatikParameter = 1202
        End If
        If Kontakt.Modul = 0 And Kontakt.Adresse = 2 And Kontakt.status = False And (AutomatikParameter = 1202 Or AutomatikParameter = 1200) Then
            _eb.weicheSchalten(11, Klassen.WeichenRichtung.rechts)
            AutomatikParameter = 1203
        End If
        ' ***
        ' *** Zug 1 starten nach Anlauf
        ' ***
        If Kontakt.IsActive(0, 5) And AutomatikParameter = 1203 Then
            _LokStufen.EinzelLokSenden(2, 0)
            If A_Stop = 1 Then
                Zyklusende()
            Else
                If _StoryControl < 3 Then
                    _eb.weicheSchalten(17, Klassen.WeichenRichtung.rechts)
                    _eb.weicheSchalten(23, Klassen.WeichenRichtung.links)
                    '_eb.weicheSchalten(25, Klassen.WeichenRichtung.rechts)
                    _eb.weicheSchalten(26, Klassen.WeichenRichtung.rechts)
                    _eb.weicheSchalten(27, Klassen.WeichenRichtung.rechts)
                    _eb.weicheSchalten(19, Klassen.WeichenRichtung.links)
                    _eb.weicheSchalten(21, Klassen.WeichenRichtung.rechts)
                    _LokStufen.EinzelLokSenden(1, 1)
                End If
                AutomatikParameter = 2100
                If _StoryControl = 3 Then
                    StoryText = "weiter"
                    StoryColor = Drawing.Color.LightGray
                End If
            End If
        End If
        ' ***
        ' *** Zug 1 starten in Schleife
        ' ***
        If Kontakt.Modul = 0 And Kontakt.Adresse = 0 And Kontakt.status = False And AutomatikParameter = 2100 Then
            _LokStufen.EinzelLokSenden(1, 3)
            AutomatikParameter = 2101
        End If
        If Kontakt.Modul = 0 And Kontakt.Adresse = 4 And Kontakt.status = True And AutomatikParameter = 2101 Then
            AutomatikParameter = 2102
        End If
        If Kontakt.Modul = 1 And Kontakt.Adresse = 2 And Kontakt.status = True And AutomatikParameter = 2102 Then
            _LokStufen.EinzelLokSenden(1, 4)
            AutomatikParameter = 2110
        End If
        If Kontakt.Modul = 1 And Kontakt.Adresse = 2 And Kontakt.status = False And AutomatikParameter = 2110 Then
            AutomatikParameter = 2111
        End If
        If Kontakt.Modul = 1 And Kontakt.Adresse = 2 And Kontakt.status = True And AutomatikParameter = 2111 Then
            AutomatikParameter = 2120
        End If
        If Kontakt.Modul = 0 And Kontakt.Adresse = 1 And Kontakt.status = True And AutomatikParameter = 2120 Then
            _LokStufen.EinzelLokSenden(1, 2)
            'Timer_EinzelLok1.Stop()
            AutomatikParameter = 2121
        End If
        If Kontakt.Modul = 0 And Kontakt.Adresse = 0 And Kontakt.status = True And AutomatikParameter = 2121 Then
            _LokStufen.EinzelLokSenden(1, 0)
            If A_Stop = 1 Then
                Zyklusende()
            Else
                If _StoryControl < 3 Then
                    _eb.weicheSchalten(13, Klassen.WeichenRichtung.rechts)
                    _eb.weicheSchalten(14, Klassen.WeichenRichtung.rechts)
                    _eb.weicheSchalten(17, Klassen.WeichenRichtung.rechts)
                    _eb.weicheSchalten(23, Klassen.WeichenRichtung.rechts)
                    '_eb.weicheSchalten(25, Klassen.WeichenRichtung.rechts)
                    _eb.weicheSchalten(26, Klassen.WeichenRichtung.rechts)
                    _eb.weicheSchalten(27, Klassen.WeichenRichtung.rechts)
                    _eb.weicheSchalten(22, Klassen.WeichenRichtung.links)
                    _eb.weicheSchalten(20, Klassen.WeichenRichtung.rechts)
                    _LokStufen.EinzelLokSenden(4, 2)
                End If
                If _StoryControl = 3 Then
                    StoryText = "weiter"
                    StoryColor = Drawing.Color.LightGray
                End If
                AutomatikParameter = 2400
            End If
        End If
        If Kontakt.Modul = 1 And Kontakt.Adresse = 4 And Kontakt.status = False And AutomatikParameter = 2400 Then
            _LokStufen.EinzelLokSenden(4, 3)
            AutomatikParameter = 2401
        End If
        If Kontakt.Modul = 1 And Kontakt.Adresse = 2 And Kontakt.status = True And AutomatikParameter = 2401 Then
            _LokStufen.EinzelLokSenden(4, 4)
            AutomatikParameter = 2410
        End If
        If Kontakt.Modul = 1 And Kontakt.Adresse = 2 And Kontakt.status = False And AutomatikParameter = 2410 Then
            AutomatikParameter = 2411
        End If
        If Kontakt.Modul = 1 And Kontakt.Adresse = 2 And Kontakt.status = True And AutomatikParameter = 2411 Then
            AutomatikParameter = 2412
        End If
        If Kontakt.Modul = 0 And Kontakt.Adresse = 4 And Kontakt.status = True And AutomatikParameter = 2412 Then
            AutomatikParameter = 2420
        End If
        If Kontakt.Modul = 1 And Kontakt.Adresse = 5 And Kontakt.status = True And AutomatikParameter = 2420 Then
            _LokStufen.EinzelLokSenden(4, 2)
            AutomatikParameter = 2421
        End If
        If Kontakt.Modul = 1 And Kontakt.Adresse = 4 And Kontakt.status = True And AutomatikParameter = 2421 Then
            _LokStufen.EinzelLokSenden(4, 0)
            If A_Stop = 1 Then
                Zyklusende()
            Else
                _eb.weicheSchalten(13, Klassen.WeichenRichtung.links)
                _eb.weicheSchalten(14, Klassen.WeichenRichtung.links)
                _eb.weicheSchalten(17, Klassen.WeichenRichtung.rechts)
                _eb.weicheSchalten(19, Klassen.WeichenRichtung.rechts)
                _eb.weicheSchalten(21, Klassen.WeichenRichtung.links)
                _eb.weicheSchalten(23, Klassen.WeichenRichtung.rechts)
                '_eb.weicheSchalten(25, Klassen.WeichenRichtung.links)
                _eb.weicheSchalten(26, Klassen.WeichenRichtung.links)
                _eb.weicheSchalten(27, Klassen.WeichenRichtung.rechts)
                _LokStufen.EinzelLokSenden(2, 0)
                _eb.weicheSchalten(11, Klassen.WeichenRichtung.links)
                If _StoryControl < 3 Then
                    _LokStufen.EinzelLokSenden(2, 3)
                End If
                If _StoryControl = 3 Then
                    StoryText = "weiter"
                    StoryColor = Drawing.Color.LightGray
                End If
                AutomatikParameter = 2200
            End If
        End If
        If Kontakt.Modul = 0 And Kontakt.Adresse = 4 And Kontakt.status = True And AutomatikParameter = 2200 Then
            _eb.weicheSchalten(23, Klassen.WeichenRichtung.links)
            '_eb.weicheSchalten(25, Klassen.WeichenRichtung.rechts)
            _eb.weicheSchalten(26, Klassen.WeichenRichtung.rechts)
            AutomatikParameter = 2201
        End If
        If Kontakt.Modul = 0 And Kontakt.Adresse = 2 And Kontakt.status = True And AutomatikParameter = 2201 Then
            AutomatikParameter = 2202
        End If
        If Kontakt.Modul = 0 And Kontakt.Adresse = 3 And Kontakt.status = True And AutomatikParameter = 2202 Then
            AutomatikParameter = 2203
        End If
        If Kontakt.Modul = 1 And Kontakt.Adresse = 2 And Kontakt.status = True And AutomatikParameter = 2203 Then
            _LokStufen.EinzelLokSenden(2, 4)
            _eb.weicheSchalten(11, Klassen.WeichenRichtung.rechts)
            _eb.weicheSchalten(17, Klassen.WeichenRichtung.links)
            AutomatikParameter = 2210
        End If
        If Kontakt.Modul = 1 And Kontakt.Adresse = 2 And Kontakt.status = False And AutomatikParameter = 2210 Then
            AutomatikParameter = 2211
        End If
        If Kontakt.Modul = 1 And Kontakt.Adresse = 2 And Kontakt.status = True And AutomatikParameter = 2211 Then
            AutomatikParameter = 2220
        End If
        If Kontakt.Modul = 0 And Kontakt.Adresse = 3 And Kontakt.status = True And AutomatikParameter = 2220 Then
            AutomatikParameter = 2221
        End If
        If Kontakt.Modul = 0 And Kontakt.Adresse = 2 And Kontakt.status = True And AutomatikParameter = 2221 Then
            AutomatikParameter = 2222
        End If
        If Kontakt.Modul = 0 And Kontakt.Adresse = 5 And Kontakt.status = True And AutomatikParameter = 2222 Then
            _LokStufen.EinzelLokSenden(2, 0)
            If A_Stop = 1 Then
                Zyklusende()
            Else
                _eb.weicheSchalten(9, Klassen.WeichenRichtung.links)
                If _StoryControl < 3 Then
                    _eb.weicheSchalten(13, Klassen.WeichenRichtung.links)
                    _eb.weicheSchalten(14, Klassen.WeichenRichtung.links)
                    _eb.weicheSchalten(17, Klassen.WeichenRichtung.rechts)
                    _eb.weicheSchalten(20, Klassen.WeichenRichtung.links)
                    _eb.weicheSchalten(22, Klassen.WeichenRichtung.rechts)
                    _eb.weicheSchalten(23, Klassen.WeichenRichtung.rechts)
                    '_eb.weicheSchalten(25, Klassen.WeichenRichtung.links)
                    _eb.weicheSchalten(26, Klassen.WeichenRichtung.links)
                    _eb.weicheSchalten(27, Klassen.WeichenRichtung.rechts)
                    _LokStufen.EinzelLokSenden(3, 3)
                End If
                If _StoryControl = 3 Then
                    StoryText = "weiter"
                    StoryColor = Drawing.Color.LightGray
                End If
                AutomatikParameter = 2300
            End If
        End If
        If Kontakt.Modul = 1 And Kontakt.Adresse = 7 And Kontakt.status = True And AutomatikParameter = 2300 Then
            _eb.weicheSchalten(13, Klassen.WeichenRichtung.rechts)
            _eb.weicheSchalten(14, Klassen.WeichenRichtung.rechts)
            AutomatikParameter = 2301
        End If
        If Kontakt.Modul = 1 And Kontakt.Adresse = 6 And Kontakt.status = True And AutomatikParameter = 2301 Then
            AutomatikParameter = 2302
        End If
        If Kontakt.Modul = 1 And Kontakt.Adresse = 2 And Kontakt.status = True And AutomatikParameter = 2302 Then
            _LokStufen.EinzelLokSenden(3, 4)
            AutomatikParameter = 2303
        End If
        If Kontakt.Modul = 1 And Kontakt.Adresse = 2 And Kontakt.status = False And AutomatikParameter = 2303 Then
            AutomatikParameter = 2310
        End If
        If Kontakt.Modul = 1 And Kontakt.Adresse = 2 And Kontakt.status = True And AutomatikParameter = 2310 Then
            AutomatikParameter = 2311
        End If
        If Kontakt.Modul = 1 And Kontakt.Adresse = 6 And Kontakt.status = True And AutomatikParameter = 2311 Then
            AutomatikParameter = 2320
        End If
        If Kontakt.Modul = 1 And Kontakt.Adresse = 7 And Kontakt.status = True And AutomatikParameter = 2320 Then
            '_eb.weicheSchalten(25, Klassen.WeichenRichtung.rechts)
            _eb.weicheSchalten(26, Klassen.WeichenRichtung.rechts)
            _eb.weicheSchalten(27, Klassen.WeichenRichtung.links)
            AutomatikParameter = 2321
        End If
        If Kontakt.Modul = 0 And Kontakt.Adresse = 4 And Kontakt.status = True And AutomatikParameter = 2321 Then
            _eb.weicheSchalten(9, Klassen.WeichenRichtung.rechts)
            AutomatikParameter = 2330
        End If
        If Kontakt.Modul = 1 And Kontakt.Adresse = 3 And Kontakt.status = True And AutomatikParameter = 2330 Then
            _LokStufen.EinzelLokSenden(3, 0)
            If A_Stop = 1 Then
                Zyklusende()
            Else
                If _StoryControl < 3 Then
                    _eb.weicheSchalten(13, Klassen.WeichenRichtung.links)
                    _eb.weicheSchalten(14, Klassen.WeichenRichtung.links)
                    _eb.weicheSchalten(17, Klassen.WeichenRichtung.rechts)
                    _eb.weicheSchalten(23, Klassen.WeichenRichtung.links)
                    _eb.weicheSchalten(25, Klassen.WeichenRichtung.rechts)
                    _eb.weicheSchalten(26, Klassen.WeichenRichtung.rechts)
                    _eb.weicheSchalten(27, Klassen.WeichenRichtung.rechts)
                    _eb.weicheSchalten(21, Klassen.WeichenRichtung.rechts)
                    _eb.weicheSchalten(19, Klassen.WeichenRichtung.links)
                    _LokStufen.EinzelLokSenden(1, 1)
                End If
                If _StoryControl = 3 Then
                    StoryText = "weiter"
                    StoryColor = Drawing.Color.LightGray
                End If
                AutomatikParameter = 2100
            End If
        End If
    End Sub

    ' *** Hauptschleife
    Private Sub Automatik1(ByRef Kontakte() As Klassen.Kontakt)
        For Each Kontakt As Klassen.Kontakt In Kontakte

            If Betriebsart = 1 Then
                Betriebsart1_Unten(Kontakt)
            End If

            If Betriebsart = 2 Then

                If Betriebsart12 = 0 And Betriebsart34 = 3 Then
                    If _Betriebsart0_3Var = 1 Then
                        Betriebsart0_3Var1(Kontakt)
                    Else
                        Betriebsart0_3(Kontakt)
                    End If
                End If

                If Betriebsart12 = 0 And Betriebsart34 = 4 Then
                    If _Betriebsart0_4Var = 1 Then
                        Betriebsart0_4Var1(Kontakt)
                    ElseIf _Betriebsart0_4Var = 2 Then
                        Betriebsart0_4Var2(Kontakt)
                    Else
                        Betriebsart0_4(Kontakt)
                    End If
                End If

                If Betriebsart12 = 0 And Betriebsart34 = 5 Then
                    If _Betriebsart0_5Var = 1 Then
                        Betriebsart0_5Var1(Kontakt)
                    Else
                        Betriebsart0_5(Kontakt)
                    End If
                    'Betriebsart0_5(Kontakt)
                End If

                If Betriebsart12 = 1 And Betriebsart34 = 0 Then
                    'Betriebsart1_0(Kontakt)
                    If _Betriebsart1_0Var = 1 Then
                        Betriebsart1_0Var1(Kontakt)
                    Else
                        Betriebsart1_0(Kontakt)
                    End If
                End If

                If Betriebsart12 = 1 And Betriebsart34 = 3 Then
                    Betriebsart1_3(Kontakt)
                End If

                If Betriebsart12 = 1 And Betriebsart34 = 4 Then
                    Betriebsart1_4(Kontakt)
                End If

                If Betriebsart12 = 1 And Betriebsart34 = 5 Then
                    Betriebsart1_5(Kontakt)
                End If

                If Betriebsart12 = 2 And Betriebsart34 = 0 Then
                    'Betriebsart2_0(Kontakt)
                    If _Betriebsart2_0Var = 1 Then
                        Betriebsart2_0Var1(Kontakt)
                    Else
                        Betriebsart2_0(Kontakt)
                    End If
                End If

                If Betriebsart12 = 2 And Betriebsart34 = 3 Then
                    Betriebsart2_3(Kontakt)
                End If

                If Betriebsart12 = 2 And Betriebsart34 = 4 Then
                    Betriebsart2_4(Kontakt)
                End If

                If Betriebsart12 = 2 And Betriebsart34 = 5 Then
                    Betriebsart2_5(Kontakt)
                End If

                If Betriebsart12 = 3 And Betriebsart34 = 0 Then
                    If _Betriebsart3_0Var = 0 Then
                        Betriebsart3_0(Kontakt)
                    ElseIf _Betriebsart3_0Var = 1 Then
                        Betriebsart3_0Var1(Kontakt)
                    ElseIf _Betriebsart3_0Var = 2 Then
                        Betriebsart3_0Var2(Kontakt)
                    End If
                End If

                If Betriebsart12 = 3 And Betriebsart34 = 3 Then
                    Betriebsart3_3(Kontakt)
                End If

                If Betriebsart12 = 3 And Betriebsart34 = 4 Then
                    Betriebsart3_4(Kontakt)
                End If

                If Betriebsart12 = 3 And Betriebsart34 = 5 Then
                    Betriebsart3_5(Kontakt)
                End If

            End If

            If Betriebsart = 3 Then
                'Betriebsart3_Story(Kontakt)
                Betriebsart3_5(Kontakt)
            End If

        Next
    End Sub


    Private Sub NumericUpDown1_ValueChanged(sender As System.Object, e As System.EventArgs) Handles NumericUpDown1.ValueChanged
        Dim interval As Integer = NumericUpDown1.Value * 1000
        If Not _daten Is Nothing Then
            _daten.write_to_table(TimerTableName, 0, Convert.ToInt32(interval))
        End If
    End Sub

    Private Sub NumericUpDown2_ValueChanged(sender As System.Object, e As System.EventArgs) Handles NumericUpDown2.ValueChanged
        Dim interval As Integer = NumericUpDown2.Value * 1000
        If Not _daten Is Nothing Then
            _daten.write_to_table(TimerTableName, 1, Convert.ToInt32(interval))
        End If
    End Sub

    Private Sub NumericUpDown3_ValueChanged(sender As System.Object, e As System.EventArgs) Handles NumericUpDown3.ValueChanged
        Dim interval As Integer = NumericUpDown3.Value * 1000
        If Not _daten Is Nothing Then
            _daten.write_to_table(TimerTableName, 2, Convert.ToInt32(interval))
        End If
    End Sub

    Private Sub NumericUpDown4_ValueChanged(sender As System.Object, e As System.EventArgs) Handles NumericUpDown4.ValueChanged
        Dim interval As Integer = NumericUpDown4.Value * 1000
        If Not _daten Is Nothing Then
            _daten.write_to_table(TimerTableName, 3, Convert.ToInt32(interval))
        End If
    End Sub

    Dim LastHoveredSpeedControlAddress As Integer = 1
    Dim LadeLoknummern As Boolean = False
    ' *** Loknummern wählen
    Private Sub NumericUpDown8_Enter(sender As System.Object, e As System.EventArgs) Handles NumericUpDown8.Enter, NumericUpDown9.Enter, NumericUpDown10.Enter, NumericUpDown11.Enter
        Dim numericUpDown As System.Windows.Forms.NumericUpDown = sender
        GeschwindikeitenSetzen(numericUpDown.Value)
    End Sub
    Private Sub NumericUpDown8_ValueChanged(sender As System.Object, e As System.EventArgs) Handles NumericUpDown8.ValueChanged, NumericUpDown9.ValueChanged, NumericUpDown10.ValueChanged, NumericUpDown11.ValueChanged
        If LadeLoknummern = False And _LokStufen Is Nothing = False Then
            _LokStufen.AktiveSetzten(NumericUpDown8.Value, NumericUpDown9.Value, NumericUpDown10.Value, NumericUpDown11.Value)
            Dim numericUpDown As System.Windows.Forms.NumericUpDown = sender
            GeschwindikeitenSetzen(numericUpDown.Value)
        End If
        If Not _Betriebsparameter Is Nothing Then
            _Betriebsparameter.UpdateContent({NumericUpDown8.Value, NumericUpDown9.Value, NumericUpDown10.Value, NumericUpDown11.Value})
        End If
    End Sub
    Private Sub NumericUPDown8_Click(sender As System.Object, e As System.EventArgs) Handles NumericUpDown8.Click

        NumericUpDown8.BackColor = Drawing.Color.LightBlue
        NumericUpDown9.BackColor = Drawing.Color.White
        NumericUpDown10.BackColor = Drawing.Color.White
        NumericUpDown11.BackColor = Drawing.Color.White

        If NumericUpDown8.Value = 10 Then
            _Prog10 = 999
            Prog_Lok10.Start()
        ElseIf NumericUpDown8.Value = 11 Then
            _Prog11 = 999
            Prog_Lok11.Start()
        ElseIf NumericUpDown8.Value = 12 Then
            _Prog12 = 999
            Prog_Lok12.Start()
        ElseIf NumericUpDown8.Value = 13 Then
            _Prog13 = 999
            Prog_Lok13.Start()
        ElseIf NumericUpDown8.Value = 14 Then
            _Prog14 = 999
            Prog_Lok14.Start()
        ElseIf NumericUpDown8.Value = 15 Then
            _Prog15 = 999
            Prog_Lok15.Start()
        ElseIf NumericUpDown8.Value = 16 Then
            _Prog16 = 999
            Prog_Lok16.Start()
        ElseIf NumericUpDown8.Value = 17 Then
            _Prog17 = 999
            Prog_Lok17.Start()
        ElseIf NumericUpDown8.Value = 18 Then
            _Prog18 = 999
            Prog_Lok18.Start()
        ElseIf NumericUpDown8.Value = 19 Then
            _Prog19 = 999
            Prog_Lok19.Start()
        ElseIf NumericUpDown8.Value = 20 Then
            _Prog20 = 999
            Prog_Lok20.Start()
        ElseIf NumericUpDown8.Value = 21 Then
            _Prog21 = 999
            Prog_Lok21.Start()
        ElseIf NumericUpDown8.Value = 22 Then
            _Prog22 = 999
            Prog_Lok22.Start()
        ElseIf NumericUpDown8.Value = 23 Then
            _Prog23 = 999
            Prog_Lok23.Start()
        ElseIf NumericUpDown8.Value = 24 Then
            _Prog24 = 999
            Prog_Lok24.Start()
        ElseIf NumericUpDown8.Value = 25 Then
            _Prog25 = 999
            Prog_Lok25.Start()
        ElseIf NumericUpDown8.Value = 26 Then
            _Prog26 = 999
            Prog_Lok26.Start()
        ElseIf NumericUpDown8.Value = 27 Then
            _Prog27 = 999
            Prog_Lok27.Start()
        ElseIf NumericUpDown8.Value = 28 Then
            _Prog28 = 999
            Prog_Lok28.Start()
        ElseIf NumericUpDown8.Value = 29 Then
            _Prog29 = 999
            Prog_Lok29.Start()
        ElseIf NumericUpDown8.Value = 30 Then
            _Prog30 = 999
            Prog_Lok30.Start()
        ElseIf NumericUpDown8.Value = 31 Then
            _Prog31 = 999
            Prog_Lok31.Start()
        ElseIf NumericUpDown8.Value = 32 Then
            _Prog32 = 999
            Prog_Lok32.Start()
        ElseIf NumericUpDown8.Value = 33 Then
            _Prog33 = 999
            Prog_Lok33.Start()
        ElseIf NumericUpDown8.Value = 34 Then
            _Prog34 = 999
            Prog_Lok34.Start()
        ElseIf NumericUpDown8.Value = 35 Then
            _Prog35 = 999
            Prog_Lok35.Start()
        ElseIf NumericUpDown8.Value = 36 Then
            _Prog36 = 999
            Prog_Lok36.Start()
        ElseIf NumericUpDown8.Value = 37 Then
            _Prog37 = 999
            Prog_Lok37.Start()
        ElseIf NumericUpDown8.Value = 38 Then
            _Prog38 = 999
            Prog_Lok38.Start()
        ElseIf NumericUpDown8.Value = 39 Then
            _Prog39 = 999
            Prog_Lok39.Start()
        ElseIf NumericUpDown8.Value = 40 Then
            _Prog40 = 999
            Prog_Lok40.Start()
        ElseIf NumericUpDown8.Value = 41 Then
            _Prog41 = 999
            Prog_Lok41.Start()
        ElseIf NumericUpDown8.Value = 42 Then
            _Prog42 = 999
            Prog_Lok42.Start()
        ElseIf NumericUpDown8.Value = 43 Then
            _Prog43 = 999
            Prog_Lok43.Start()
        ElseIf NumericUpDown8.Value = 44 Then
            _Prog44 = 999
            Prog_Lok44.Start()
        ElseIf NumericUpDown8.Value = 45 Then
            _Prog45 = 999
            Prog_Lok45.Start()
        ElseIf NumericUpDown8.Value = 46 Then
            _Prog46 = 999
            Prog_Lok46.Start()
        ElseIf NumericUpDown8.Value = 47 Then
            _Prog47 = 999
            Prog_Lok47.Start()
        ElseIf NumericUpDown8.Value = 48 Then
            _Prog48 = 999
            Prog_Lok48.Start()
        ElseIf NumericUpDown8.Value = 49 Then
            _Prog49 = 999
            Prog_Lok49.Start()
        ElseIf NumericUpDown8.Value = 50 Then
            _Prog50 = 999
            Prog_Lok50.Start()
        ElseIf NumericUpDown8.Value = 51 Then
            _Prog51 = 999
            Prog_Lok51.Start()
        ElseIf NumericUpDown8.Value = 52 Then
            _Prog52 = 999
            Prog_Lok52.Start()
        ElseIf NumericUpDown8.Value = 53 Then
            _Prog53 = 999
            Prog_Lok53.Start()
        ElseIf NumericUpDown8.Value = 54 Then
            _Prog54 = 999
            Prog_Lok54.Start()
        ElseIf NumericUpDown8.Value = 55 Then
            _Prog55 = 999
            Prog_Lok55.Start()
        ElseIf NumericUpDown8.Value = 56 Then
            _Prog56 = 999
            Prog_Lok56.Start()
        ElseIf NumericUpDown8.Value = 57 Then
            _Prog57 = 999
            Prog_Lok57.Start()
        ElseIf NumericUpDown8.Value = 58 Then
            _Prog58 = 999
            Prog_Lok58.Start()
        ElseIf NumericUpDown8.Value = 59 Then
            _Prog59 = 999
            Prog_Lok59.Start()
        ElseIf NumericUpDown8.Value = 60 Then
            _Prog60 = 999
            Prog_Lok60.Start()
        ElseIf NumericUpDown8.Value = 61 Then
            _Prog61 = 999
            Prog_Lok61.Start()
        ElseIf NumericUpDown8.Value = 62 Then
            _Prog62 = 999
            Prog_Lok62.Start()
        ElseIf NumericUpDown8.Value = 63 Then
            _Prog63 = 999
            Prog_Lok63.Start()
        ElseIf NumericUpDown8.Value = 64 Then
            _Prog64 = 999
            Prog_Lok64.Start()
        ElseIf NumericUpDown8.Value = 65 Then
            _Prog65 = 999
            Prog_Lok65.Start()
        ElseIf NumericUpDown8.Value = 66 Then
            _Prog66 = 999
            Prog_Lok66.Start()
        ElseIf NumericUpDown8.Value = 67 Then
            _Prog67 = 999
            Prog_Lok67.Start()
        ElseIf NumericUpDown8.Value = 68 Then
            _Prog68 = 999
            Prog_Lok68.Start()
        ElseIf NumericUpDown8.Value = 69 Then
            _Prog69 = 999
            Prog_Lok69.Start()
        ElseIf NumericUpDown8.Value = 70 Then
            _Prog70 = 999
            Prog_Lok70.Start()
        ElseIf NumericUpDown8.Value = 71 Then
            _Prog71 = 999
            Prog_Lok71.Start()
        ElseIf NumericUpDown8.Value = 72 Then
            _Prog72 = 999
            Prog_Lok72.Start()
        ElseIf NumericUpDown8.Value = 73 Then
            _Prog73 = 999
            Prog_Lok73.Start()
        ElseIf NumericUpDown8.Value = 74 Then
            _Prog74 = 999
            Prog_Lok74.Start()
        ElseIf NumericUpDown8.Value = 75 Then
            _Prog75 = 999
            Prog_Lok75.Start()
        ElseIf NumericUpDown8.Value = 76 Then
            _Prog76 = 999
            Prog_Lok76.Start()
        ElseIf NumericUpDown8.Value = 77 Then
            _Prog77 = 999
            Prog_Lok77.Start()
        ElseIf NumericUpDown8.Value = 78 Then
            _Prog78 = 999
            Prog_Lok78.Start()
        ElseIf NumericUpDown8.Value = 79 Then
            _Prog79 = 999
            Prog_Lok79.Start()
        ElseIf NumericUpDown8.Value = 80 Then
            _Prog80 = 999
            Prog_Lok80.Start()
        End If

        Startzug = 1
        _daten.write_to_table(AutomatikParameterTableName, 43, Startzug)
        'If _Weichen_initialisiert = True Then
        '    Button41.BackColor = Drawing.Color.Yellow
        'Else
        '    Button41.BackColor = Drawing.Color.Red
        'End If
        'If _Signale_initialisiert = True Then
        '    Button42.BackColor = Drawing.Color.Yellow
        'Else
        '    Button42.BackColor = Drawing.Color.Red
        'End If
        _Weichen_in_Startposition = False
        _Signale_in_Startposition = False
        ButtonsVisible(999)
    End Sub
    Private Sub NumericUPDown9_Click(sender As System.Object, e As System.EventArgs) Handles NumericUpDown9.Click

        NumericUpDown8.BackColor = Drawing.Color.White
        NumericUpDown9.BackColor = Drawing.Color.LightBlue
        NumericUpDown10.BackColor = Drawing.Color.White
        NumericUpDown11.BackColor = Drawing.Color.White

        If NumericUpDown9.Value = 10 Then
            _Prog10 = 999
            Prog_Lok10.Start()
        ElseIf NumericUpDown9.Value = 11 Then
            _Prog11 = 999
            Prog_Lok11.Start()
        ElseIf NumericUpDown9.Value = 12 Then
            _Prog12 = 999
            Prog_Lok12.Start()
        ElseIf NumericUpDown9.Value = 13 Then
            _Prog13 = 999
            Prog_Lok13.Start()
        ElseIf NumericUpDown9.Value = 14 Then
            _Prog14 = 999
            Prog_Lok14.Start()
        ElseIf NumericUpDown9.Value = 15 Then
            _Prog15 = 999
            Prog_Lok15.Start()
        ElseIf NumericUpDown9.Value = 16 Then
            _Prog16 = 999
            Prog_Lok16.Start()
        ElseIf NumericUpDown9.Value = 17 Then
            _Prog17 = 999
            Prog_Lok17.Start()
        ElseIf NumericUpDown9.Value = 18 Then
            _Prog18 = 999
            Prog_Lok18.Start()
        ElseIf NumericUpDown9.Value = 19 Then
            _Prog19 = 999
            Prog_Lok19.Start()
        ElseIf NumericUpDown9.Value = 20 Then
            _Prog20 = 999
            Prog_Lok20.Start()
        ElseIf NumericUpDown9.Value = 21 Then
            _Prog21 = 999
            Prog_Lok21.Start()
        ElseIf NumericUpDown9.Value = 22 Then
            _Prog22 = 999
            Prog_Lok22.Start()
        ElseIf NumericUpDown9.Value = 23 Then
            _Prog23 = 999
            Prog_Lok23.Start()
        ElseIf NumericUpDown9.Value = 24 Then
            _Prog24 = 999
            Prog_Lok24.Start()
        ElseIf NumericUpDown9.Value = 25 Then
            _Prog25 = 999
            Prog_Lok25.Start()
        ElseIf NumericUpDown9.Value = 26 Then
            _Prog26 = 999
            Prog_Lok26.Start()
        ElseIf NumericUpDown9.Value = 27 Then
            _Prog27 = 999
            Prog_Lok27.Start()
        ElseIf NumericUpDown9.Value = 28 Then
            _Prog28 = 999
            Prog_Lok28.Start()
        ElseIf NumericUpDown9.Value = 29 Then
            _Prog29 = 999
            Prog_Lok29.Start()
        ElseIf NumericUpDown9.Value = 30 Then
            _Prog30 = 999
            Prog_Lok30.Start()
        ElseIf NumericUpDown9.Value = 31 Then
            _Prog31 = 999
            Prog_Lok31.Start()
        ElseIf NumericUpDown9.Value = 32 Then
            _Prog32 = 999
            Prog_Lok32.Start()
        ElseIf NumericUpDown9.Value = 33 Then
            _Prog33 = 999
            Prog_Lok33.Start()
        ElseIf NumericUpDown9.Value = 34 Then
            _Prog34 = 999
            Prog_Lok34.Start()
        ElseIf NumericUpDown9.Value = 35 Then
            _Prog35 = 999
            Prog_Lok35.Start()
        ElseIf NumericUpDown9.Value = 36 Then
            _Prog36 = 999
            Prog_Lok36.Start()
        ElseIf NumericUpDown9.Value = 37 Then
            _Prog37 = 999
            Prog_Lok37.Start()
        ElseIf NumericUpDown9.Value = 38 Then
            _Prog38 = 999
            Prog_Lok38.Start()
        ElseIf NumericUpDown9.Value = 39 Then
            _Prog39 = 999
            Prog_Lok39.Start()
        ElseIf NumericUpDown9.Value = 40 Then
            _Prog40 = 999
            Prog_Lok40.Start()
        ElseIf NumericUpDown9.Value = 41 Then
            _Prog41 = 999
            Prog_Lok41.Start()
        ElseIf NumericUpDown9.Value = 42 Then
            _Prog42 = 999
            Prog_Lok42.Start()
        ElseIf NumericUpDown9.Value = 43 Then
            _Prog43 = 999
            Prog_Lok43.Start()
        ElseIf NumericUpDown9.Value = 44 Then
            _Prog44 = 999
            Prog_Lok44.Start()
        ElseIf NumericUpDown9.Value = 45 Then
            _Prog45 = 999
            Prog_Lok45.Start()
        ElseIf NumericUpDown9.Value = 46 Then
            _Prog46 = 999
            Prog_Lok46.Start()
        ElseIf NumericUpDown9.Value = 47 Then
            _Prog47 = 999
            Prog_Lok47.Start()
        ElseIf NumericUpDown9.Value = 48 Then
            _Prog48 = 999
            Prog_Lok48.Start()
        ElseIf NumericUpDown9.Value = 49 Then
            _Prog49 = 999
            Prog_Lok49.Start()
        ElseIf NumericUpDown9.Value = 50 Then
            _Prog50 = 999
            Prog_Lok50.Start()
        ElseIf NumericUpDown9.Value = 51 Then
            _Prog51 = 999
            Prog_Lok51.Start()
        ElseIf NumericUpDown9.Value = 52 Then
            _Prog52 = 999
            Prog_Lok52.Start()
        ElseIf NumericUpDown9.Value = 53 Then
            _Prog53 = 999
            Prog_Lok53.Start()
        ElseIf NumericUpDown9.Value = 54 Then
            _Prog54 = 999
            Prog_Lok54.Start()
        ElseIf NumericUpDown9.Value = 55 Then
            _Prog55 = 999
            Prog_Lok55.Start()
        ElseIf NumericUpDown9.Value = 56 Then
            _Prog56 = 999
            Prog_Lok56.Start()
        ElseIf NumericUpDown9.Value = 57 Then
            _Prog57 = 999
            Prog_Lok57.Start()
        ElseIf NumericUpDown9.Value = 58 Then
            _Prog58 = 999
            Prog_Lok58.Start()
        ElseIf NumericUpDown9.Value = 59 Then
            _Prog59 = 999
            Prog_Lok59.Start()
        ElseIf NumericUpDown9.Value = 60 Then
            _Prog60 = 999
            Prog_Lok60.Start()
        ElseIf NumericUpDown9.Value = 61 Then
            _Prog61 = 999
            Prog_Lok61.Start()
        ElseIf NumericUpDown9.Value = 62 Then
            _Prog62 = 999
            Prog_Lok62.Start()
        ElseIf NumericUpDown9.Value = 63 Then
            _Prog63 = 999
            Prog_Lok63.Start()
        ElseIf NumericUpDown9.Value = 64 Then
            _Prog64 = 999
            Prog_Lok64.Start()
        ElseIf NumericUpDown9.Value = 65 Then
            _Prog65 = 999
            Prog_Lok65.Start()
        ElseIf NumericUpDown9.Value = 66 Then
            _Prog66 = 999
            Prog_Lok66.Start()
        ElseIf NumericUpDown9.Value = 67 Then
            _Prog67 = 999
            Prog_Lok67.Start()
        ElseIf NumericUpDown9.Value = 68 Then
            _Prog68 = 999
            Prog_Lok68.Start()
        ElseIf NumericUpDown9.Value = 69 Then
            _Prog69 = 999
            Prog_Lok69.Start()
        ElseIf NumericUpDown9.Value = 70 Then
            _Prog70 = 999
            Prog_Lok70.Start()
        ElseIf NumericUpDown9.Value = 71 Then
            _Prog71 = 999
            Prog_Lok71.Start()
        ElseIf NumericUpDown9.Value = 72 Then
            _Prog72 = 999
            Prog_Lok72.Start()
        ElseIf NumericUpDown9.Value = 73 Then
            _Prog73 = 999
            Prog_Lok73.Start()
        ElseIf NumericUpDown9.Value = 74 Then
            _Prog74 = 999
            Prog_Lok74.Start()


        ElseIf NumericUpDown9.Value = 75 Then
            _Prog75 = 999
            Prog_Lok75.Start()
        ElseIf NumericUpDown9.Value = 76 Then
            _Prog76 = 999
            Prog_Lok76.Start()
        ElseIf NumericUpDown9.Value = 77 Then
            _Prog77 = 999
            Prog_Lok77.Start()
        ElseIf NumericUpDown9.Value = 78 Then
            _Prog78 = 999
            Prog_Lok78.Start()
        ElseIf NumericUpDown9.Value = 79 Then
            _Prog79 = 999
            Prog_Lok79.Start()
        ElseIf NumericUpDown9.Value = 80 Then
            _Prog80 = 999
            Prog_Lok80.Start()
        End If

        Startzug = 2
        _daten.write_to_table(AutomatikParameterTableName, 43, Startzug)
        'If _Weichen_initialisiert = True Then
        '    Button41.BackColor = Drawing.Color.Yellow
        'Else
        '    Button41.BackColor = Drawing.Color.Red
        'End If
        'If _Signale_initialisiert = True Then
        '    Button42.BackColor = Drawing.Color.Yellow
        'Else
        '    Button42.BackColor = Drawing.Color.Red
        'End If
        _Weichen_in_Startposition = False
        _Signale_in_Startposition = False
        ButtonsVisible(999)
    End Sub
    Private Sub NumericUPDown10_Click(sender As System.Object, e As System.EventArgs) Handles NumericUpDown10.Click

        NumericUpDown8.BackColor = Drawing.Color.White
        NumericUpDown9.BackColor = Drawing.Color.White
        NumericUpDown10.BackColor = Drawing.Color.LightBlue
        NumericUpDown11.BackColor = Drawing.Color.White

        If NumericUpDown10.Value = 10 Then
            _Prog10 = 999
            Prog_Lok10.Start()
        ElseIf NumericUpDown10.Value = 11 Then
            _Prog11 = 999
            Prog_Lok11.Start()
        ElseIf NumericUpDown10.Value = 12 Then
            _Prog12 = 999
            Prog_Lok12.Start()
        ElseIf NumericUpDown10.Value = 13 Then
            _Prog13 = 999
            Prog_Lok13.Start()
        ElseIf NumericUpDown10.Value = 14 Then
            _Prog14 = 999
            Prog_Lok14.Start()
        ElseIf NumericUpDown10.Value = 15 Then
            _Prog15 = 999
            Prog_Lok15.Start()
        ElseIf NumericUpDown10.Value = 16 Then
            _Prog16 = 999
            Prog_Lok16.Start()
        ElseIf NumericUpDown10.Value = 17 Then
            _Prog17 = 999
            Prog_Lok17.Start()
        ElseIf NumericUpDown10.Value = 18 Then
            _Prog18 = 999
            Prog_Lok18.Start()
        ElseIf NumericUpDown10.Value = 19 Then
            _Prog19 = 999
            Prog_Lok19.Start()
        ElseIf NumericUpDown10.Value = 20 Then
            _Prog20 = 999
            Prog_Lok20.Start()
        ElseIf NumericUpDown10.Value = 21 Then
            _Prog21 = 999
            Prog_Lok21.Start()
        ElseIf NumericUpDown10.Value = 22 Then
            _Prog22 = 999
            Prog_Lok22.Start()
        ElseIf NumericUpDown10.Value = 23 Then
            _Prog23 = 999
            Prog_Lok23.Start()
        ElseIf NumericUpDown10.Value = 24 Then
            _Prog24 = 999
            Prog_Lok24.Start()
        ElseIf NumericUpDown10.Value = 25 Then
            _Prog25 = 999
            Prog_Lok25.Start()
        ElseIf NumericUpDown10.Value = 26 Then
            _Prog26 = 999
            Prog_Lok26.Start()
        ElseIf NumericUpDown10.Value = 27 Then
            _Prog27 = 999
            Prog_Lok27.Start()
        ElseIf NumericUpDown10.Value = 28 Then
            _Prog28 = 999
            Prog_Lok28.Start()
        ElseIf NumericUpDown10.Value = 29 Then
            _Prog29 = 999
            Prog_Lok29.Start()
        ElseIf NumericUpDown10.Value = 30 Then
            _Prog30 = 999
            Prog_Lok30.Start()
        ElseIf NumericUpDown10.Value = 31 Then
            _Prog31 = 999
            Prog_Lok31.Start()
        ElseIf NumericUpDown10.Value = 32 Then
            _Prog32 = 999
            Prog_Lok32.Start()
        ElseIf NumericUpDown10.Value = 33 Then
            _Prog33 = 999
            Prog_Lok33.Start()
        ElseIf NumericUpDown10.Value = 34 Then
            _Prog34 = 999
            Prog_Lok34.Start()
        ElseIf NumericUpDown10.Value = 35 Then
            _Prog35 = 999
            Prog_Lok35.Start()
        ElseIf NumericUpDown10.Value = 36 Then
            _Prog36 = 999
            Prog_Lok36.Start()
        ElseIf NumericUpDown10.Value = 37 Then
            _Prog37 = 999
            Prog_Lok37.Start()
        ElseIf NumericUpDown10.Value = 38 Then
            _Prog38 = 999
            Prog_Lok38.Start()
        ElseIf NumericUpDown10.Value = 39 Then
            _Prog39 = 999
            Prog_Lok39.Start()
        ElseIf NumericUpDown10.Value = 40 Then
            _Prog40 = 999
            Prog_Lok40.Start()
        ElseIf NumericUpDown10.Value = 41 Then
            _Prog41 = 999
            Prog_Lok41.Start()
        ElseIf NumericUpDown10.Value = 42 Then
            _Prog42 = 999
            Prog_Lok42.Start()
        ElseIf NumericUpDown10.Value = 43 Then
            _Prog43 = 999
            Prog_Lok43.Start()
        ElseIf NumericUpDown10.Value = 44 Then
            _Prog44 = 999
            Prog_Lok44.Start()
        ElseIf NumericUpDown10.Value = 45 Then
            _Prog45 = 999
            Prog_Lok45.Start()
        ElseIf NumericUpDown10.Value = 46 Then
            _Prog46 = 999
            Prog_Lok46.Start()
        ElseIf NumericUpDown10.Value = 47 Then
            _Prog47 = 999
            Prog_Lok47.Start()
        ElseIf NumericUpDown10.Value = 48 Then
            _Prog48 = 999
            Prog_Lok48.Start()
        ElseIf NumericUpDown10.Value = 49 Then
            _Prog49 = 999
            Prog_Lok49.Start()
        ElseIf NumericUpDown10.Value = 50 Then
            _Prog50 = 999
            Prog_Lok50.Start()
        ElseIf NumericUpDown10.Value = 51 Then
            _Prog51 = 999
            Prog_Lok51.Start()
        ElseIf NumericUpDown10.Value = 52 Then
            _Prog52 = 999
            Prog_Lok52.Start()
        ElseIf NumericUpDown10.Value = 53 Then
            _Prog53 = 999
            Prog_Lok53.Start()
        ElseIf NumericUpDown10.Value = 54 Then
            _Prog54 = 999
            Prog_Lok54.Start()
        ElseIf NumericUpDown10.Value = 55 Then
            _Prog55 = 999
            Prog_Lok55.Start()
        ElseIf NumericUpDown10.Value = 56 Then
            _Prog56 = 999
            Prog_Lok56.Start()
        ElseIf NumericUpDown10.Value = 57 Then
            _Prog57 = 999
            Prog_Lok57.Start()
        ElseIf NumericUpDown10.Value = 58 Then
            _Prog58 = 999
            Prog_Lok58.Start()
        ElseIf NumericUpDown10.Value = 59 Then
            _Prog59 = 999
            Prog_Lok59.Start()
        ElseIf NumericUpDown10.Value = 60 Then
            _Prog60 = 999
            Prog_Lok60.Start()
        ElseIf NumericUpDown10.Value = 61 Then
            _Prog61 = 999
            Prog_Lok61.Start()
        ElseIf NumericUpDown10.Value = 62 Then
            _Prog62 = 999
            Prog_Lok62.Start()
        ElseIf NumericUpDown10.Value = 63 Then
            _Prog63 = 999
            Prog_Lok63.Start()
        ElseIf NumericUpDown10.Value = 64 Then
            _Prog64 = 999
            Prog_Lok64.Start()
        ElseIf NumericUpDown10.Value = 65 Then
            _Prog65 = 999
            Prog_Lok65.Start()
        ElseIf NumericUpDown10.Value = 66 Then
            _Prog66 = 999
            Prog_Lok66.Start()
        ElseIf NumericUpDown10.Value = 67 Then
            _Prog67 = 999
            Prog_Lok67.Start()
        ElseIf NumericUpDown10.Value = 68 Then
            _Prog68 = 999
            Prog_Lok68.Start()
        ElseIf NumericUpDown10.Value = 69 Then
            _Prog69 = 999
            Prog_Lok69.Start()
        ElseIf NumericUpDown10.Value = 70 Then
            _Prog70 = 999
            Prog_Lok70.Start()
        ElseIf NumericUpDown10.Value = 71 Then
            _Prog71 = 999
            Prog_Lok71.Start()
        ElseIf NumericUpDown10.Value = 72 Then
            _Prog72 = 999
            Prog_Lok72.Start()
        ElseIf NumericUpDown10.Value = 73 Then
            _Prog73 = 999
            Prog_Lok73.Start()
        ElseIf NumericUpDown10.Value = 74 Then
            _Prog74 = 999
            Prog_Lok74.Start()
        ElseIf NumericUpDown10.Value = 75 Then
            _Prog75 = 999
            Prog_Lok75.Start()
        ElseIf NumericUpDown10.Value = 76 Then
            _Prog76 = 999
            Prog_Lok76.Start()
        ElseIf NumericUpDown10.Value = 77 Then
            _Prog77 = 999
            Prog_Lok77.Start()
        ElseIf NumericUpDown10.Value = 78 Then
            _Prog78 = 999
            Prog_Lok78.Start()
        ElseIf NumericUpDown10.Value = 79 Then
            _Prog79 = 999
            Prog_Lok79.Start()
        ElseIf NumericUpDown10.Value = 80 Then
            _Prog80 = 999
            Prog_Lok80.Start()
        End If

        Startzug = 3
        _daten.write_to_table(AutomatikParameterTableName, 43, Startzug)
        'If _Weichen_initialisiert = True Then
        '    Button41.BackColor = Drawing.Color.Yellow
        'Else
        '    Button41.BackColor = Drawing.Color.Red
        'End If
        'If _Signale_initialisiert = True Then
        '    Button42.BackColor = Drawing.Color.Yellow
        'Else
        '    Button42.BackColor = Drawing.Color.Red
        'End If
        _Weichen_in_Startposition = False
        _Signale_in_Startposition = False
        ButtonsVisible(999)
    End Sub
    Private Sub NumericUPDown11_Click(sender As System.Object, e As System.EventArgs) Handles NumericUpDown11.Click

        NumericUpDown8.BackColor = Drawing.Color.White
        NumericUpDown9.BackColor = Drawing.Color.White
        NumericUpDown10.BackColor = Drawing.Color.White
        NumericUpDown11.BackColor = Drawing.Color.LightBlue

        If NumericUpDown11.Value = 10 Then
            _Prog10 = 999
            Prog_Lok10.Start()
        ElseIf NumericUpDown11.Value = 11 Then
            _Prog11 = 999
            Prog_Lok11.Start()
        ElseIf NumericUpDown11.Value = 12 Then
            _Prog12 = 999
            Prog_Lok12.Start()
        ElseIf NumericUpDown11.Value = 13 Then
            _Prog13 = 999
            Prog_Lok13.Start()
        ElseIf NumericUpDown11.Value = 14 Then
            _Prog14 = 999
            Prog_Lok14.Start()
        ElseIf NumericUpDown11.Value = 15 Then
            _Prog15 = 999
            Prog_Lok15.Start()
        ElseIf NumericUpDown11.Value = 16 Then
            _Prog16 = 999
            Prog_Lok16.Start()
        ElseIf NumericUpDown11.Value = 17 Then
            _Prog17 = 999
            Prog_Lok17.Start()
        ElseIf NumericUpDown11.Value = 18 Then
            _Prog18 = 999
            Prog_Lok18.Start()
        ElseIf NumericUpDown11.Value = 19 Then
            _Prog19 = 999
            Prog_Lok19.Start()
        ElseIf NumericUpDown11.Value = 20 Then
            _Prog20 = 999
            Prog_Lok20.Start()
        ElseIf NumericUpDown11.Value = 21 Then
            _Prog21 = 999
            Prog_Lok21.Start()
        ElseIf NumericUpDown11.Value = 22 Then
            _Prog22 = 999
            Prog_Lok22.Start()
        ElseIf NumericUpDown11.Value = 23 Then
            _Prog23 = 999
            Prog_Lok23.Start()
        ElseIf NumericUpDown11.Value = 24 Then
            _Prog24 = 999
            Prog_Lok24.Start()
        ElseIf NumericUpDown11.Value = 25 Then
            _Prog25 = 999
            Prog_Lok25.Start()
        ElseIf NumericUpDown11.Value = 26 Then
            _Prog26 = 999
            Prog_Lok26.Start()
        ElseIf NumericUpDown11.Value = 27 Then
            _Prog27 = 999
            Prog_Lok27.Start()
        ElseIf NumericUpDown11.Value = 28 Then
            _Prog28 = 999
            Prog_Lok28.Start()
        ElseIf NumericUpDown11.Value = 29 Then
            _Prog29 = 999
            Prog_Lok29.Start()
        ElseIf NumericUpDown11.Value = 30 Then
            _Prog30 = 999
            Prog_Lok30.Start()
        ElseIf NumericUpDown11.Value = 31 Then
            _Prog31 = 999
            Prog_Lok31.Start()
        ElseIf NumericUpDown11.Value = 32 Then
            _Prog32 = 999
            Prog_Lok32.Start()
        ElseIf NumericUpDown11.Value = 33 Then
            _Prog33 = 999
            Prog_Lok33.Start()
        ElseIf NumericUpDown11.Value = 34 Then
            _Prog34 = 999
            Prog_Lok34.Start()
        ElseIf NumericUpDown11.Value = 35 Then
            _Prog35 = 999
            Prog_Lok35.Start()
        ElseIf NumericUpDown11.Value = 36 Then
            _Prog36 = 999
            Prog_Lok36.Start()
        ElseIf NumericUpDown11.Value = 37 Then
            _Prog37 = 999
            Prog_Lok37.Start()
        ElseIf NumericUpDown11.Value = 38 Then
            _Prog38 = 999
            Prog_Lok38.Start()
        ElseIf NumericUpDown11.Value = 39 Then
            _Prog39 = 999
            Prog_Lok39.Start()
        ElseIf NumericUpDown11.Value = 40 Then
            _Prog40 = 999
            Prog_Lok40.Start()
        ElseIf NumericUpDown11.Value = 41 Then
            _Prog41 = 999
            Prog_Lok41.Start()
        ElseIf NumericUpDown11.Value = 42 Then
            _Prog42 = 999
            Prog_Lok42.Start()
        ElseIf NumericUpDown11.Value = 43 Then
            _Prog43 = 999
            Prog_Lok43.Start()
        ElseIf NumericUpDown11.Value = 44 Then
            _Prog44 = 999
            Prog_Lok44.Start()
        ElseIf NumericUpDown11.Value = 45 Then
            _Prog45 = 999
            Prog_Lok45.Start()
        ElseIf NumericUpDown11.Value = 46 Then
            _Prog46 = 999
            Prog_Lok46.Start()
        ElseIf NumericUpDown11.Value = 47 Then
            _Prog47 = 999
            Prog_Lok47.Start()
        ElseIf NumericUpDown11.Value = 48 Then
            _Prog48 = 999
            Prog_Lok48.Start()
        ElseIf NumericUpDown11.Value = 49 Then
            _Prog49 = 999
            Prog_Lok49.Start()
        ElseIf NumericUpDown11.Value = 50 Then
            _Prog50 = 999
            Prog_Lok50.Start()
        ElseIf NumericUpDown11.Value = 51 Then
            _Prog51 = 999
            Prog_Lok51.Start()
        ElseIf NumericUpDown11.Value = 52 Then
            _Prog52 = 999
            Prog_Lok52.Start()
        ElseIf NumericUpDown11.Value = 53 Then
            _Prog53 = 999
            Prog_Lok53.Start()
        ElseIf NumericUpDown11.Value = 54 Then
            _Prog54 = 999
            Prog_Lok54.Start()
        ElseIf NumericUpDown11.Value = 55 Then
            _Prog55 = 999
            Prog_Lok55.Start()
        ElseIf NumericUpDown11.Value = 56 Then
            _Prog56 = 999
            Prog_Lok56.Start()
        ElseIf NumericUpDown11.Value = 57 Then
            _Prog57 = 999
            Prog_Lok57.Start()
        ElseIf NumericUpDown11.Value = 58 Then
            _Prog58 = 999
            Prog_Lok58.Start()
        ElseIf NumericUpDown11.Value = 59 Then
            _Prog59 = 999
            Prog_Lok59.Start()
        ElseIf NumericUpDown11.Value = 60 Then
            _Prog60 = 999
            Prog_Lok60.Start()
        ElseIf NumericUpDown11.Value = 61 Then
            _Prog61 = 999
            Prog_Lok61.Start()
        ElseIf NumericUpDown11.Value = 62 Then
            _Prog62 = 999
            Prog_Lok62.Start()
        ElseIf NumericUpDown11.Value = 63 Then
            _Prog63 = 999
            Prog_Lok63.Start()
        ElseIf NumericUpDown11.Value = 64 Then
            _Prog64 = 999
            Prog_Lok64.Start()
        ElseIf NumericUpDown11.Value = 65 Then
            _Prog65 = 999
            Prog_Lok65.Start()
        ElseIf NumericUpDown11.Value = 66 Then
            _Prog66 = 999
            Prog_Lok66.Start()
        ElseIf NumericUpDown11.Value = 67 Then
            _Prog67 = 999
            Prog_Lok67.Start()
        ElseIf NumericUpDown11.Value = 68 Then
            _Prog68 = 999
            Prog_Lok68.Start()
        ElseIf NumericUpDown11.Value = 69 Then
            _Prog69 = 999
            Prog_Lok69.Start()
        ElseIf NumericUpDown11.Value = 70 Then
            _Prog70 = 999
            Prog_Lok70.Start()
        ElseIf NumericUpDown11.Value = 71 Then
            _Prog71 = 999
            Prog_Lok71.Start()
        ElseIf NumericUpDown11.Value = 72 Then
            _Prog72 = 999
            Prog_Lok72.Start()
        ElseIf NumericUpDown11.Value = 73 Then
            _Prog73 = 999
            Prog_Lok73.Start()
        ElseIf NumericUpDown11.Value = 74 Then
            _Prog74 = 999
            Prog_Lok74.Start()
        ElseIf NumericUpDown11.Value = 75 Then
            _Prog75 = 999
            Prog_Lok75.Start()
        ElseIf NumericUpDown11.Value = 76 Then
            _Prog76 = 999
            Prog_Lok76.Start()
        ElseIf NumericUpDown11.Value = 77 Then
            _Prog77 = 999
            Prog_Lok77.Start()
        ElseIf NumericUpDown11.Value = 78 Then
            _Prog78 = 999
            Prog_Lok78.Start()
        ElseIf NumericUpDown11.Value = 79 Then
            _Prog79 = 999
            Prog_Lok79.Start()
        ElseIf NumericUpDown11.Value = 80 Then
            _Prog80 = 999
            Prog_Lok80.Start()
        End If

        Startzug = 4
        _daten.write_to_table(AutomatikParameterTableName, 43, Startzug)

        _Weichen_in_Startposition = False
        _Signale_in_Startposition = False
        ButtonsVisible(999)
    End Sub

    Private Sub TrackBar1_Scroll(sender As System.Object, e As System.EventArgs) Handles TrackBar3.Scroll, TrackBar4.Scroll
        Dim trackBar As System.Windows.Forms.TrackBar = sender
        _LokStufen.Setzten(LastHoveredSpeedControlAddress, trackBar.Tag, trackBar.Value)
    End Sub

    Private Sub NumericUpDown5_ValueChanged(sender As System.Object, e As System.EventArgs) Handles NumericUpDown5.ValueChanged, NumericUpDown6.ValueChanged
        Dim numericUpDown As System.Windows.Forms.NumericUpDown = sender
        _LokStufen.Setzten(LastHoveredSpeedControlAddress, numericUpDown.Tag, numericUpDown.Value)
    End Sub

    Private Sub GeschwindikeitenSetzen(ByVal loknummer As Integer)
        If Me.InvokeRequired Then
            Me.Invoke(Sub() GeschwindikeitenSetzen(loknummer))
        Else
            LastHoveredSpeedControlAddress = loknummer
            NumericUpDown5.Value = _LokStufen.Holen(loknummer, 1)
            NumericUpDown6.Value = _LokStufen.Holen(loknummer, 2)
            TrackBar3.Value = _LokStufen.Holen(loknummer, 3)
            TrackBar4.Value = _LokStufen.Holen(loknummer, 4)
            GroupBox10.Text = "Lok " + loknummer.ToString() + " Geschwindigkeit"
        End If
    End Sub
    Private Sub LoksWiederherstellen()
        LadeLoknummern = True
        NumericUpDown8.Value = _LokStufen.AktiveHolen(1)
        NumericUpDown9.Value = _LokStufen.AktiveHolen(2)
        NumericUpDown10.Value = _LokStufen.AktiveHolen(3)
        NumericUpDown11.Value = _LokStufen.AktiveHolen(4)
        LadeLoknummern = False
    End Sub

    Sub Routen(ByRef button As System.Windows.Forms.Button, ByVal route As Integer)
        If route = 0 Then
            button.BackColor = Drawing.Color.LightGreen
            button.Text = "Unten"
        End If
        If route = 1 Then
            button.BackColor = Drawing.Color.LightBlue
            button.Text = "Obn k"
        End If
        If route = 2 Then
            button.BackColor = Drawing.Color.LightBlue
            button.Text = "Obn l"
        End If
    End Sub



    Public Sub DMX(Szene As Int16, S As Integer, L1 As Int16, L2 As Int16, L3 As Int16, L4 As Int16, L5 As Int16, L6 As Int16, L7 As Int16)
        If Szene = 0 Then
            _dmxServer.SetData(1, 0)
            _dmxServer.SetData(2, 0)
            _dmxServer.SetData(3, 0)
            _dmxServer.SetData(4, 0)
            _dmxServer.SetData(6, 0)
            _dmxServer.SetData(7, 0)
            _dmxServer.SetData(8, 0)
            L1_soll = 0
            L2_soll = 0
            L3_soll = 0
            L4_soll = 0
            L5_soll = 0
            L6_soll = 0
            L7_soll = 0
            L1_aktuell = 0
            L2_aktuell = 0
            L3_aktuell = 0
            L4_aktuell = 0
            L5_aktuell = 0
            L6_aktuell = 0
            L7_aktuell = 0
        ElseIf Szene = 1 Then
            _dmxServer.SetData(1, 200)
            _dmxServer.SetData(2, 200)
            _dmxServer.SetData(3, 200)
            _dmxServer.SetData(4, 200)
            _dmxServer.SetData(6, 200)
            _dmxServer.SetData(7, 200)
            _dmxServer.SetData(8, 200)
            L1_soll = 200
            L2_soll = 200
            L3_soll = 200
            L4_soll = 200
            L5_soll = 200
            L6_soll = 200
            L7_soll = 200
            L1_aktuell = 200
            L2_aktuell = 200
            L3_aktuell = 200
            L4_aktuell = 200
            L5_aktuell = 200
            L6_aktuell = 200
            L7_aktuell = 200
        ElseIf Szene = 2 Then
            L1_soll = 0
            L2_soll = 0
            L3_soll = 0
            L4_soll = 0
            L5_soll = 0
            L6_soll = 0
            L7_soll = 0
            S_DMX = S
            Timer_DMX.Start()
        ElseIf Szene = 3 Then
            L1_soll = 60
            L2_soll = 60
            L3_soll = 60
            L4_soll = 60
            L5_soll = 60
            L6_soll = 60
            L7_soll = 60
            S_DMX = S
            Timer_DMX.Start()
        ElseIf Szene = 4 Then
            L1_soll = 120
            L2_soll = 100
            L3_soll = 80
            L4_soll = 60
            L5_soll = 60
            L6_soll = 60
            L7_soll = 60
            S_DMX = S
            Timer_DMX.Start()
        ElseIf Szene = 5 Then
            L1_soll = 200
            L2_soll = 200
            L3_soll = 200
            L4_soll = 200
            L5_soll = 200
            L6_soll = 200
            L7_soll = 200
            S_DMX = S
            Timer_DMX.Start()
        ElseIf Szene = 6 Then
            L1_soll = 60
            L2_soll = 60
            L3_soll = 60
            L4_soll = 60
            L5_soll = 80
            L6_soll = 100
            L7_soll = 120
            S_DMX = S
            Timer_DMX.Start()
        ElseIf Szene = 7 Then
            L1_soll = 60
            L2_soll = 60
            L3_soll = 60
            L4_soll = 60
            L5_soll = 60
            L6_soll = 60
            L7_soll = 60
            S_DMX = S
            Timer_DMX.Start()
        ElseIf Szene = 8 Then
            _dmxServer.SetData(1, L1)
            _dmxServer.SetData(2, L2)
            _dmxServer.SetData(3, L3)
            _dmxServer.SetData(4, L4)
            _dmxServer.SetData(6, L5)
            _dmxServer.SetData(7, L6)
            _dmxServer.SetData(8, L7)
            L1_aktuell = L1
            L2_aktuell = L2
            L3_aktuell = L3
            L4_aktuell = L4
            L5_aktuell = L5
            L6_aktuell = L6
            L7_aktuell = L7
        Else
            L1_soll = L1
            L2_soll = L2
            L3_soll = L3
            L4_soll = L4
            L5_soll = L5
            L6_soll = L6
            L7_soll = L7
            S_DMX = S
            Timer_DMX.Start()
        End If
    End Sub

    Public Sub BeleuchtungSchalten()
        Dim IndexLicht, DMX1, DMX2, DMX3, DMX4, DMX5, DMX6, DMX7, FMod1, FMod2, FMod3, FMod4, FMod5, FMod6, FMod7, FMod8, FMod9, FMod10, FMod11, FMod12 As Integer
        _Beleuchtung = _Beleuchtung + 1
        If _Beleuchtung < 4 Then
            _Beleuchtung = 4
        End If
        If _Beleuchtung > 9 Then
            _Beleuchtung = 4
        End If

        IndexLicht = _Beleuchtung + 4
        DMX1 = Betriebsparameter.GetValue("Beleuchtungsparameter", 2, IndexLicht)
        DMX2 = Betriebsparameter.GetValue("Beleuchtungsparameter", 3, IndexLicht)
        DMX3 = Betriebsparameter.GetValue("Beleuchtungsparameter", 4, IndexLicht)
        DMX4 = Betriebsparameter.GetValue("Beleuchtungsparameter", 5, IndexLicht)
        DMX5 = Betriebsparameter.GetValue("Beleuchtungsparameter", 6, IndexLicht)
        DMX6 = Betriebsparameter.GetValue("Beleuchtungsparameter", 7, IndexLicht)
        DMX7 = Betriebsparameter.GetValue("Beleuchtungsparameter", 8, IndexLicht)

        If _Hue = 3 Then
            Hue_Control = Betriebsparameter.GetValue("Beleuchtungsparameter", 9, IndexLicht)
            Col_soll = Betriebsparameter.GetValue("Beleuchtungsparameter", 10, IndexLicht)
            Sat_soll = Betriebsparameter.GetValue("Beleuchtungsparameter", 11, IndexLicht)
            Bri_soll = Betriebsparameter.GetValue("Beleuchtungsparameter", 12, IndexLicht)
            CT_soll = Betriebsparameter.GetValue("Beleuchtungsparameter", 13, IndexLicht)
            Timer_HUE.Start()
        End If

        FMod1 = Betriebsparameter.GetValue("Beleuchtungsparameter", 14, IndexLicht)
        FMod2 = Betriebsparameter.GetValue("Beleuchtungsparameter", 15, IndexLicht)
        FMod3 = Betriebsparameter.GetValue("Beleuchtungsparameter", 16, IndexLicht)
        FMod4 = Betriebsparameter.GetValue("Beleuchtungsparameter", 17, IndexLicht)
        FMod5 = Betriebsparameter.GetValue("Beleuchtungsparameter", 18, IndexLicht)
        FMod6 = Betriebsparameter.GetValue("Beleuchtungsparameter", 19, IndexLicht)
        FMod7 = Betriebsparameter.GetValue("Beleuchtungsparameter", 20, IndexLicht)
        FMod8 = Betriebsparameter.GetValue("Beleuchtungsparameter", 21, IndexLicht)
        FMod9 = Betriebsparameter.GetValue("Beleuchtungsparameter", 22, IndexLicht)
        FMod10 = Betriebsparameter.GetValue("Beleuchtungsparameter", 23, IndexLicht)
        FMod11 = Betriebsparameter.GetValue("Beleuchtungsparameter", 24, IndexLicht)
        FMod12 = Betriebsparameter.GetValue("Beleuchtungsparameter", 25, IndexLicht)

        'Button1.Text = "DMX " + Betriebsparameter.GetValue("Beleuchtungsparameter", 1, IndexLicht)
        DMX(8, 20, DMX1, DMX2, DMX3, DMX4, DMX5, DMX6, DMX7)

        If _Funktionsmodelle = 2 Then
            If FMod1 = 1 Then
                _eb.weicheSchalten(29, Klassen.WeichenRichtung.links)
            Else
                _eb.weicheSchalten(29, Klassen.WeichenRichtung.rechts)
            End If
            If FMod2 = 1 Then
                _eb.weicheSchalten(30, Klassen.WeichenRichtung.links)
            Else
                _eb.weicheSchalten(30, Klassen.WeichenRichtung.rechts)
            End If
            If FMod3 = 1 Then
                _eb.weicheSchalten(31, Klassen.WeichenRichtung.links)
            Else
                _eb.weicheSchalten(31, Klassen.WeichenRichtung.rechts)
            End If
            If FMod4 = 1 Then
                _eb.weicheSchalten(32, Klassen.WeichenRichtung.links)
            Else
                _eb.weicheSchalten(32, Klassen.WeichenRichtung.rechts)
            End If
            If FMod5 = 1 Then
                _eb.weicheSchalten(33, Klassen.WeichenRichtung.links)
            Else
                _eb.weicheSchalten(33, Klassen.WeichenRichtung.rechts)
            End If
            If FMod6 = 1 Then
                _eb.weicheSchalten(34, Klassen.WeichenRichtung.links)
            Else
                _eb.weicheSchalten(34, Klassen.WeichenRichtung.rechts)
            End If
            If FMod7 = 1 Then
                _eb.weicheSchalten(35, Klassen.WeichenRichtung.links)
            Else
                _eb.weicheSchalten(35, Klassen.WeichenRichtung.rechts)
            End If
            If FMod8 = 1 Then
                _eb.weicheSchalten(36, Klassen.WeichenRichtung.links)
            Else
                _eb.weicheSchalten(36, Klassen.WeichenRichtung.rechts)
            End If
            If FMod9 = 1 Then
                _eb.weicheSchalten(37, Klassen.WeichenRichtung.links)
            Else
                _eb.weicheSchalten(37, Klassen.WeichenRichtung.rechts)
            End If
            If FMod10 = 1 Then
                _eb.weicheSchalten(38, Klassen.WeichenRichtung.links)
            Else
                _eb.weicheSchalten(38, Klassen.WeichenRichtung.rechts)
            End If
            If FMod11 = 1 Then
                _eb.weicheSchalten(39, Klassen.WeichenRichtung.links)
            Else
                _eb.weicheSchalten(39, Klassen.WeichenRichtung.rechts)
            End If
            If FMod12 = 1 Then
                _eb.weicheSchalten(40, Klassen.WeichenRichtung.links)
            Else
                _eb.weicheSchalten(40, Klassen.WeichenRichtung.rechts)
            End If
        End If

        If _Beleuchtung = 0 Then
            'Button1.BackColor = Drawing.Color.LightGray
        Else
            'Button1.BackColor = Drawing.Color.LightYellow
        End If
        _daten.write_to_table(AutomatikParameterTableName, 44, _Beleuchtung)
    End Sub

    ' *** Das kalte Herz - Story

    Private Sub Das_kalte_Herz()

        If ComboBox1.SelectedIndex = 1 Then

            If _StoryPointer = 0 Then

                StoryText = "10: Der Transeuropaexpress fährt durch Altenstein"
                Timer_Story_Auto.Interval = 88000
                _kalteHerz.StartVideo("H:\\EB_Media\\Clips\\Lok10.mp4")
                _StoryPointer = 1
            ElseIf _StoryPointer = 1 Then

                StoryText = "15: E 103 mit Intercity"
                Timer_Story_Auto.Interval = 97000
                _kalteHerz.StartVideo("H:\\EB_Media\\Clips\\Lok15.mp4")
                _StoryPointer = 2
            ElseIf _StoryPointer = 2 Then

                StoryText = "69: Baureihe 55"
                Timer_Story_Auto.Interval = 123000
                _kalteHerz.StartVideo("H:\\EB_Media\\Clips\\Lok69.mp4")
                _StoryPointer = 3
            ElseIf _StoryPointer = 3 Then

                StoryText = "11: ICE"
                Timer_Story_Auto.Interval = 128000
                _kalteHerz.StartVideo("H:\\EB_Media\\Clips\\Lok11.mp4")
                _StoryPointer = 4
            ElseIf _StoryPointer = 4 Then

                StoryText = "14: Baureihe 460 SBB"
                Timer_Story_Auto.Interval = 70000
                _kalteHerz.StartVideo("H:\\EB_Media\\Clips\\Lok14.mp4")
                _StoryPointer = 5
            ElseIf _StoryPointer = 5 Then

                StoryText = "17: 12X (Baureihe 128)"
                Timer_Story_Auto.Interval = 183000
                _kalteHerz.StartVideo("H:\\EB_Media\\Clips\\Lok17.mp4")
                _StoryPointer = 6
            ElseIf _StoryPointer = 6 Then

                StoryText = "12: Baureihe 103"
                Timer_Story_Auto.Interval = 37000
                _kalteHerz.StartVideo("H:\\EB_Media\\Clips\\Lok12.mp4")
                _StoryPointer = 7
            ElseIf _StoryPointer = 7 Then

                StoryText = "13: Baureihe 120"
                Timer_Story_Auto.Interval = 7000
                _kalteHerz.StartVideo("H:\\EB_Media\\Clips\\Lok13.mp4")
                _StoryPointer = 8
            ElseIf _StoryPointer = 8 Then

                StoryText = "16: Baureihe 120"
                Timer_Story_Auto.Interval = 13000
                _kalteHerz.StartVideo("H:\\EB_Media\\Clips\\Lok16.mp4")
                _StoryPointer = 9
            ElseIf _StoryPointer = 9 Then

                StoryText = "18: Baureihe 18"
                Timer_Story_Auto.Interval = 72000
                _kalteHerz.StartVideo("H:\\EB_Media\\Clips\\Lok18.mp4")
                _StoryPointer = 10
            ElseIf _StoryPointer = 10 Then

                StoryText = "19: Baureihe 101"
                Timer_Story_Auto.Interval = 72000
                _kalteHerz.StartVideo("H:\\EB_Media\\Clips\\Lok19.mp4")
                _StoryPointer = 11
            ElseIf _StoryPointer = 11 Then

                StoryText = "37: Baureihe 151"
                Timer_Story_Auto.Interval = 102000
                _kalteHerz.StartVideo("H:\\EB_Media\\Clips\\Lok37.mp4")
                _StoryPointer = 12
            ElseIf _StoryPointer = 12 Then

                StoryText = "44: Baureihe 216"
                Timer_Story_Auto.Interval = 125000
                _kalteHerz.StartVideo("H:\\EB_Media\\Clips\\Lok44.mp4")
                _StoryPointer = 13
            ElseIf _StoryPointer = 13 Then

                StoryText = "49: Baureihe 212"
                Timer_Story_Auto.Interval = 153000
                _kalteHerz.StartVideo("H:\\EB_Media\\Clips\\Lok49.mp4")
                _StoryPointer = 14
            ElseIf _StoryPointer = 14 Then

                StoryText = "73: Baureihe 80"
                Timer_Story_Auto.Interval = 55000
                _kalteHerz.StartVideo("H:\\EB_Media\\Clips\\Lok73.mp4")
                _StoryPointer = 15
            ElseIf _StoryPointer = 15 Then

                StoryText = "78: Rheinheim"
                Timer_Story_Auto.Interval = 196000
                _kalteHerz.StartVideo("H:\\EB_Media\\Clips\\Lok78.mp4")
                _StoryPointer = 0
            End If


        ElseIf ComboBox1.SelectedIndex = 2 Then

            If _StoryPointer = 0 Then
                ' ***
                ' *** Vorwort - eine Geschichte aus dem Schwarzwald
                ' ***

                Hue_Control = 1
                CT_soll = 260
                Bri_soll = 128
                _Hue = 3
                _Hue_Reset = 1
                Timer_HUE.Start()
                ButtonsVisible(999)

                StoryText = "0-0: Das kalte Herz"
                StoryImage = "0-Titel.jpg"
                StoryFont = New System.Drawing.Font(StoryFont.FontFamily.Name, StoryFont.Size, Drawing.FontStyle.Bold)
                Timer_Story_Auto.Interval = 3000
                _StoryPointer = 1
            ElseIf _StoryPointer = 1 Then
                StoryText = "0-1: Das kalte Herz "
                Timer_Story_Auto.Interval = 12000
                _kalteHerz.StopVideo()
                _kalteHerz.StartVideo("H:\\2. Dokumentation_EB\10. Texte für Sprachgenerator\\Kapitel 0-1.mp4")
                _StoryPointer = 2
            ElseIf _StoryPointer = 2 Then
                StoryText = "0-2:  "
                Timer_Story_Auto.Interval = 30000
                _kalteHerz.StopVideo()
                _kalteHerz.StartVideo("H:\\2. Dokumentation_EB\10. Texte für Sprachgenerator\\Kapitel 0-2.mp4")
                _StoryPointer = 3
            ElseIf _StoryPointer = 3 Then
                StoryText = "0-3:  "
                Timer_Story_Auto.Interval = 186000
                _kalteHerz.StopVideo()
                _kalteHerz.StartVideo("H:\\2. Dokumentation_EB\10. Texte für Sprachgenerator\\Kapitel 0-3.mp4")
                _StoryPointer = 100

            ElseIf _StoryPointer = 100 Then

                ' ***
                ' *** Kapitel 1 - der Schwarzwald und die Bahnstrecke
                ' ***

                Hue_Control = 1
                CT_soll = 260
                Bri_soll = 128
                StoryText = "1-0: Kapitel 1 - der Schwarzwald und die Bahnstrecke"
                'StoryImage = "0-Vorwort.jpg"
                Timer_Story_Auto.Interval = 3000
                _kalteHerz.StopVideo()
                _StoryPointer = 101

            ElseIf _StoryPointer = 101 Then
                StoryText = "1-1:  "
                Timer_Story_Auto.Interval = 77000
                _kalteHerz.StopVideo()
                _kalteHerz.StartVideo("H:\\2. Dokumentation_EB\10. Texte für Sprachgenerator\\Kapitel 1-1.mp4")
                _StoryPointer = 102

            ElseIf _StoryPointer = 102 Then
                StoryText = "1-2:  "
                Timer_Story_Auto.Interval = 122000
                _kalteHerz.StopVideo()
                _kalteHerz.StartVideo("H:\\2. Dokumentation_EB\10. Texte für Sprachgenerator\\Kapitel 1-2.mp4")
                _StoryPointer = 103

            ElseIf _StoryPointer = 103 Then
                StoryText = "1-3:  "
                Timer_Story_Auto.Interval = 144000
                _kalteHerz.StopVideo()
                _kalteHerz.StartVideo("H:\\2. Dokumentation_EB\10. Texte für Sprachgenerator\\Kapitel 1-3.mp4")
                _StoryPointer = 200

            ElseIf _StoryPointer = 200 Then

                ' ***
                ' *** Kapitel 2 - die Ankunft 
                ' ***

                Hue_Control = 1
                CT_soll = 260
                Bri_soll = 128

                StoryText = "2-0: Kapitel 2 - Die Anreise "
                _kalteHerz.StopVideo()
                'StoryImage = "Anlage_035.jpg"
                Timer_Story_Auto.Interval = 3000
                _StoryPointer = 201
            ElseIf _StoryPointer = 201 Then
                StoryText = "2-1:  "
                Timer_Story_Auto.Interval = 47000
                _kalteHerz.StopVideo()
                _kalteHerz.StartVideo("H:\\2. Dokumentation_EB\10. Texte für Sprachgenerator\\Kapitel 2-1.mp4")
                _StoryPointer = 202

            ElseIf _StoryPointer = 202 Then
                StoryText = "2-2:  "
                Timer_Story_Auto.Interval = 226000
                _kalteHerz.StopVideo()
                _kalteHerz.StartVideo("H:\\2. Dokumentation_EB\10. Texte für Sprachgenerator\\Kapitel 2-2 Modelleisenbahn.mp4")
                _StoryPointer = 300

            ElseIf _StoryPointer = 300 Then

                ' ***
                ' *** Kapitel 3 - der Schatzhauser und der Schmied Ezechiel
                ' ***

                Hue_Control = 2
                Bri_soll = 20
                Sat_soll = 250
                Col_soll = 42500

                _kalteHerz.StopVideo()
                StoryText = "3-0: Kapitel 3 - Der Schatzhauser und der Schmied Ezechiel "
                Timer_Story_Auto.Interval = 3000
                _StoryPointer = 301
            ElseIf _StoryPointer = 301 Then
                StoryText = "3-1:  "
                'StoryImage = "Kaltes Herz.jpg"
                Timer_Story_Auto.Interval = 55000
                _kalteHerz.StopVideo()
                _kalteHerz.StartVideo("H:\\2. Dokumentation_EB\10. Texte für Sprachgenerator\\Kapitel 3-1.mp4")
                _StoryPointer = 302

            ElseIf _StoryPointer = 302 Then
                StoryText = "3-2:  "
                'StoryImage = "Kaltes Herz.jpg"
                Timer_Music.Interval = 290000
                _Music_laeuft = 1
                Timer_Story_Auto.Interval = 3000
                _kalteHerz.StopVideo()
                _kalteHerz.StartVideo("H:\EB_Media\Das kalte Herz Videos\Alan Parsons Project - Old and Wise - Lyrics on screen (720p).mp4")
                StoryText = "3-1: Alan Parsons Project - Old and Wise"
                _StoryPointer = 303

            ElseIf _StoryPointer = 303 Then
                StoryText = "3-3:  "
                'StoryImage = "Kaltes Herz.jpg"
                Timer_Story_Auto.Interval = 48000
                _kalteHerz.StopVideo()
                _kalteHerz.StartVideo("H:\\2. Dokumentation_EB\10. Texte für Sprachgenerator\\Kapitel 3-3.mp4")
                _StoryPointer = 304

            ElseIf _StoryPointer = 304 Then
                StoryText = "3-4:  "
                'StoryImage = "Kaltes Herz.jpg"
                Timer_Story_Auto.Interval = 289000
                _kalteHerz.StopVideo()
                _kalteHerz.StartVideo("H:\\2. Dokumentation_EB\10. Texte für Sprachgenerator\\Kapitel 3-4 Fast Train.mp4")
                _StoryPointer = 400

            ElseIf _StoryPointer = 400 Then

                ' ***
                ' *** Kapitel 4 - der Bürgermeister
                ' ***

                Hue_Control = 1
                CT_soll = 260
                Bri_soll = 100

                DMX(3, 20, 0, 0, 128, 160, 128, 0, 0)

                _kalteHerz.StopVideo()
                StoryText = "4-0: Kapitel 4 - der Bürgermeister"
                'StoryImage = "Anlage_017.jpg"
                Timer_Story_Auto.Interval = 3000
                _StoryPointer = 401
            ElseIf _StoryPointer = 401 Then
                StoryText = "4-1:  "
                'StoryImage = "Kaltes Herz.jpg"
                Timer_Story_Auto.Interval = 570000
                _kalteHerz.StopVideo()
                _kalteHerz.StartVideo("H:\\2. Dokumentation_EB\10. Texte für Sprachgenerator\\Kapitel 4-1.mp4")
                _StoryPointer = 500

            ElseIf _StoryPointer = 500 Then

                ' ***
                ' *** Kapitel 5 - die schöne Tochter des Müllers
                ' ***

                Hue_Control = 1
                CT_soll = 260
                Bri_soll = 200

                _kalteHerz.StopVideo()
                StoryText = "5-0: Kapitel 5 - die schöne Tochter des Müllers  "
                'StoryImage = "Kaltes Herz_46.jpg"
                Timer_Story_Auto.Interval = 3000
                _StoryPointer = 501
            ElseIf _StoryPointer = 501 Then
                StoryText = "5-1:  "
                StoryImage = "Kaltes Herz.jpg"
                Timer_Story_Auto.Interval = 242000
                _kalteHerz.StopVideo()
                _kalteHerz.StartVideo("H:\\2. Dokumentation_EB\10. Texte für Sprachgenerator\\Kapitel 5-1 Geli.mp4")
                _StoryPointer = 600

            ElseIf _StoryPointer = 600 Then

                ' ***
                ' *** Kapitel 6 - Peter Kohlenmunk
                ' ***

                Hue_Control = 1
                CT_soll = 260
                Bri_soll = 100

                _kalteHerz.StopVideo()
                StoryText = "6-0: Kapitel 6 - Peter Kohlenmunk "
                'StoryImage = "Kaltes Herz_61.jpg"
                Timer_Story_Auto.Interval = 3000
                _StoryPointer = 601
            ElseIf _StoryPointer = 601 Then
                StoryText = "6-1:  "
                'StoryImage = "Kaltes Herz.jpg"
                Timer_Story_Auto.Interval = 207000
                _kalteHerz.StopVideo()
                _kalteHerz.StartVideo("H:\\2. Dokumentation_EB\10. Texte für Sprachgenerator\\Kapitel 6-1.mp4")
                _StoryPointer = 602

            ElseIf _StoryPointer = 602 Then
                StoryText = "6-2:  "
                'StoryImage = "Kaltes Herz.jpg"
                Timer_Story_Auto.Interval = 276000
                _kalteHerz.StopVideo()
                _kalteHerz.StartVideo("H:\\2. Dokumentation_EB\10. Texte für Sprachgenerator\\Kapitel 6-2 Downtown Train.mp4")
                _StoryPointer = 603

            ElseIf _StoryPointer = 603 Then
                StoryText = "6-3:  "
                'StoryImage = "Kaltes Herz.jpg"
                Timer_Story_Auto.Interval = 222000
                _kalteHerz.StopVideo()
                _kalteHerz.StartVideo("H:\\2. Dokumentation_EB\10. Texte für Sprachgenerator\\Kapitel 6-3 für immer jung.mp4")
                _StoryPointer = 604

            ElseIf _StoryPointer = 604 Then
                StoryText = "6-4:  "
                'StoryImage = "Kaltes Herz.jpg"
                Timer_Story_Auto.Interval = 32000
                _kalteHerz.StopVideo()
                _kalteHerz.StartVideo("H:\\2. Dokumentation_EB\10. Texte für Sprachgenerator\\Kapitel 6-4.mp4")
                _StoryPointer = 700

            ElseIf _StoryPointer = 700 Then

                ' ***
                ' *** Kapitel 7 - Peter Kohlenmunk trifft das Glasmännlein und wird reich
                ' ***

                Hue_Control = 1
                Bri_soll = 50
                CT_soll = 260

                StoryText = "7-0: Kapitel 7 - Peter Kohlenmunk trifft das Glasmännlein und wird reich "
                'StoryImage = "Kaltes Herz_88.jpg"
                Timer_Story_Auto.Interval = 3000
                _StoryPointer = 701

            ElseIf _StoryPointer = 701 Then
                StoryText = "7-1:  "
                Timer_Story_Auto.Interval = 418000
                _kalteHerz.StopVideo()
                _kalteHerz.StartVideo("H:\\2. Dokumentation_EB\10. Texte für Sprachgenerator\\Kapitel 7-1.mp4")
                _StoryPointer = 702
            ElseIf _StoryPointer = 702 Then
                StoryText = "7-2:  "
                'StoryImage = "Kaltes Herz.jpg"
                Timer_Story_Auto.Interval = 279000
                _kalteHerz.StopVideo()
                _kalteHerz.StartVideo("H:\\2. Dokumentation_EB\10. Texte für Sprachgenerator\\Kapitel 7-2.mp4")
                _StoryPointer = 800

            ElseIf _StoryPointer = 800 Then

                ' ***
                ' *** Kapitel 8 - Peter Kohlenmunk wird böse
                ' ***

                Hue_Control = 1
                Bri_soll = 100
                CT_soll = 260

                _kalteHerz.StopVideo()
                'StoryImage = "Kaltes Herz_101.jpg"
                StoryText = "8-0: Kapitel 8 - Peter Kohlenmunk wird böse "
                Timer_Story_Auto.Interval = 3000
                _StoryPointer = 801
            ElseIf _StoryPointer = 801 Then
                StoryText = "8-1:  "
                'StoryImage = "Kaltes Herz.jpg"
                Timer_Story_Auto.Interval = 123000
                _kalteHerz.StopVideo()
                _kalteHerz.StartVideo("H:\\2. Dokumentation_EB\10. Texte für Sprachgenerator\\Kapitel 8-1.mp4")
                _StoryPointer = 802

            ElseIf _StoryPointer = 802 Then
                StoryText = "8-2:  "
                'StoryImage = "Kaltes Herz.jpg"
                Timer_Story_Auto.Interval = 413000
                _kalteHerz.StopVideo()
                _kalteHerz.StartVideo("H:\\2. Dokumentation_EB\10. Texte für Sprachgenerator\\Kapitel 8-2 blank & jones & mark reeder ft. robert smith - a forest (ma).mp4")
                _StoryPointer = 803

            ElseIf _StoryPointer = 803 Then
                StoryText = "8-3:  "
                'StoryImage = "Kaltes Herz.jpg"
                Timer_Story_Auto.Interval = 69000
                _kalteHerz.StopVideo()
                _kalteHerz.StartVideo("H:\\2. Dokumentation_EB\10. Texte für Sprachgenerator\\Kapitel 8-3.mp4")
                _StoryPointer = 900

            ElseIf _StoryPointer = 900 Then

                ' ***
                ' *** Kapitel 9 - die Feier zum Abschluss
                ' ***

                Hue_Control = 1
                Bri_soll = 200
                CT_soll = 260

                _kalteHerz.StopVideo()
                Timer_Story_Auto.Interval = 3000
                StoryText = "9-0: Kapitel 9 - Die Feier zum Abschluss"
                _StoryPointer = 901
            ElseIf _StoryPointer = 901 Then
                StoryText = "9-1:  "
                Timer_Story_Auto.Interval = 73000
                _kalteHerz.StopVideo()
                _kalteHerz.StartVideo("H:\\2. Dokumentation_EB\10. Texte für Sprachgenerator\\Kapitel 9-1.mp4")
                _StoryPointer = 902
            ElseIf _StoryPointer = 902 Then
                StoryText = "9-2:  "
                Timer_Story_Auto.Interval = 256000
                _kalteHerz.StopVideo()
                _kalteHerz.StartVideo("H:\\2. Dokumentation_EB\10. Texte für Sprachgenerator\\Kapitel 9-2 Midnight Train.mp4")
                _StoryPointer = 903
            ElseIf _StoryPointer = 903 Then
                StoryText = "9-3:    E N D E  "
                _kalteHerz.StopVideo()
            End If

        End If
    End Sub
    Private Sub Das_kalte_Herz_Stop()
        _StoryPointer = 0
        StopMusic()
        _kalteHerz.StopVideo()
        Timer_Music.Stop()
        StoryText = "0 - Klicken zum Starten"
        StoryImage = "0 - Vorwort.jpg"
        StoryColor = Drawing.Color.LightGray
        StoryFont = New System.Drawing.Font(StoryFont.FontFamily.Name, StoryFont.Size, Drawing.FontStyle.Bold)
    End Sub

    Private Sub StoryProgress(ByVal progressEvent As DasKalteHerz.ProgressEvent) Handles _kalteHerz.StoryProgress
        If Me.InvokeRequired Then
            Me.Invoke(Sub() StoryProgress(progressEvent))
        Else
            If progressEvent = DasKalteHerz.ProgressEvent.StepForward Then

                If ComboBox1.SelectedIndex = 0 Then       ' *** Aus
                ElseIf ComboBox1.SelectedIndex = 1 Then   ' *** Eisenbahn
                ElseIf ComboBox1.SelectedIndex = 2 Then   ' *** Das kalte Herz
                ElseIf ComboBox1.SelectedIndex = 3 Then   ' *** Tag und Nacht
                End If
                '_StoryAuto = 0
                Das_kalte_Herz()

            ElseIf progressEvent = DasKalteHerz.ProgressEvent.StepBackward Then
                If ComboBox1.SelectedIndex = 0 Then       ' *** Aus
                ElseIf ComboBox1.SelectedIndex = 1 Then   ' *** Eisenbahn
                ElseIf ComboBox1.SelectedIndex = 2 Then   ' *** Das kalte Herz
                    _StoryAuto = 0
                    If _StoryPointer = 0 Then
                        _StoryPointer = 0
                    ElseIf _StoryPointer = 1 Then
                        _StoryPointer = 0
                    ElseIf _StoryPointer = 2 Then
                        _StoryPointer = 1
                    ElseIf _StoryPointer = 100 Then
                        _StoryPointer = 100
                    ElseIf _StoryPointer = 200 Then
                        _StoryPointer = 200
                    ElseIf _StoryPointer = 300 Then
                        _StoryPointer = 300
                    ElseIf _StoryPointer = 400 Then
                        _StoryPointer = 400
                    ElseIf _StoryPointer = 500 Then
                        _StoryPointer = 500
                    ElseIf _StoryPointer = 600 Then
                        _StoryPointer = 600
                    ElseIf _StoryPointer = 700 Then
                        _StoryPointer = 700
                    ElseIf _StoryPointer = 800 Then
                        _StoryPointer = 800
                    ElseIf _StoryPointer = 900 Then
                        _StoryPointer = 900
                    ElseIf _StoryPointer = 101 Then
                        _StoryPointer = 100
                    ElseIf _StoryPointer = 201 Then
                        _StoryPointer = 200
                    ElseIf _StoryPointer = 301 Then
                        _StoryPointer = 300
                    ElseIf _StoryPointer = 401 Then
                        _StoryPointer = 400
                    ElseIf _StoryPointer = 501 Then
                        _StoryPointer = 500
                    ElseIf _StoryPointer = 601 Then
                        _StoryPointer = 600
                    ElseIf _StoryPointer = 701 Then
                        _StoryPointer = 700
                    ElseIf _StoryPointer = 801 Then
                        _StoryPointer = 800
                    ElseIf _StoryPointer = 901 Then
                        _StoryPointer = 900
                    Else
                        _StoryPointer = _StoryPointer - 2
                    End If
                    _Music_laeuft = 0
                    Timer_Music.Stop()
                    PlayMusic("H:\Eisenbahn\EisenbahnV4\Plugins\KlausEBspecific\Media\Stop.mp3")
                    _kalteHerz.StopVideo()
                ElseIf ComboBox1.SelectedIndex = 3 Then   ' *** Tag und Nacht
                End If

                Das_kalte_Herz()

            ElseIf progressEvent = DasKalteHerz.ProgressEvent.JumpToStart Then
                If ComboBox1.SelectedIndex = 0 Then       ' *** Aus
                ElseIf ComboBox1.SelectedIndex = 1 Then   ' *** Eisenbahn
                ElseIf ComboBox1.SelectedIndex = 2 Then   ' *** Das kalte Herz

                    _StoryAuto = 0

                    _Music_laeuft = 0
                    Timer_Music.Stop()
                    PlayMusic("H:\Eisenbahn\EisenbahnV4\Plugins\KlausEBspecific\Media\Stop.mp3")
                    _kalteHerz.StopVideo()

                    _StoryPointer = 0

                ElseIf ComboBox1.SelectedIndex = 3 Then   ' *** Tag und Nacht
                End If

                Das_kalte_Herz()
            ElseIf progressEvent = DasKalteHerz.ProgressEvent.JumpToNextChapter Then
                If ComboBox1.SelectedIndex = 0 Then       ' *** Aus
                ElseIf ComboBox1.SelectedIndex = 1 Then   ' *** Eisenbahn
                ElseIf ComboBox1.SelectedIndex = 2 Then   ' *** Das kalte Herz

                    _StoryAuto = 0

                    If _StoryPointer <= 100 Then
                        _StoryPointer = 100
                    ElseIf _StoryPointer = 100 Then
                        _StoryPointer = 200
                    ElseIf _StoryPointer >= 100 And _StoryPointer < 200 Then
                        _StoryPointer = 200
                    ElseIf _StoryPointer >= 200 And _StoryPointer < 300 Then
                        _StoryPointer = 300
                    ElseIf _StoryPointer >= 300 And _StoryPointer < 400 Then
                        _StoryPointer = 400
                    ElseIf _StoryPointer >= 400 And _StoryPointer < 500 Then
                        _StoryPointer = 500
                    ElseIf _StoryPointer >= 500 And _StoryPointer < 600 Then
                        _StoryPointer = 600
                    ElseIf _StoryPointer >= 600 And _StoryPointer < 700 Then
                        _StoryPointer = 700
                    ElseIf _StoryPointer >= 700 And _StoryPointer < 800 Then
                        _StoryPointer = 800
                    ElseIf _StoryPointer >= 800 And _StoryPointer < 900 Then
                        _StoryPointer = 900
                    End If
                    _Music_laeuft = 0
                    Timer_Music.Stop()
                    PlayMusic("H:\Eisenbahn\EisenbahnV4\Plugins\KlausEBspecific\Media\Stop.mp3")
                    _kalteHerz.StopVideo()

                ElseIf ComboBox1.SelectedIndex = 3 Then   ' *** Tag und Nacht
                End If

                Das_kalte_Herz()
            ElseIf progressEvent = DasKalteHerz.ProgressEvent.JumpToPreviousChapter Then
                If ComboBox1.SelectedIndex = 0 Then       ' *** Aus
                ElseIf ComboBox1.SelectedIndex = 1 Then   ' *** Eisenbahn
                ElseIf ComboBox1.SelectedIndex = 2 Then   ' *** Das kalte Herz
                    _StoryAuto = 0

                    If _StoryPointer <= 100 Then
                        _StoryPointer = 0
                    ElseIf _StoryPointer = 100 Then
                        _StoryPointer = 1
                    ElseIf _StoryPointer >= 100 And _StoryPointer < 200 Then
                        _StoryPointer = 1
                    ElseIf _StoryPointer >= 200 And _StoryPointer < 300 Then
                        _StoryPointer = 100
                    ElseIf _StoryPointer >= 300 And _StoryPointer < 400 Then
                        _StoryPointer = 200
                    ElseIf _StoryPointer >= 400 And _StoryPointer < 500 Then
                        _StoryPointer = 300
                    ElseIf _StoryPointer >= 500 And _StoryPointer < 600 Then
                        _StoryPointer = 400
                    ElseIf _StoryPointer >= 600 And _StoryPointer < 700 Then
                        _StoryPointer = 500
                    ElseIf _StoryPointer >= 700 And _StoryPointer < 800 Then
                        _StoryPointer = 600
                    ElseIf _StoryPointer >= 800 And _StoryPointer < 900 Then
                        _StoryPointer = 700
                    ElseIf _StoryPointer >= 900 And _StoryPointer < 999 Then
                        _StoryPointer = 800
                    End If
                    _Music_laeuft = 0
                    Timer_Music.Stop()
                    PlayMusic("H:\Eisenbahn\EisenbahnV4\Plugins\KlausEBspecific\Media\Stop.mp3")
                    _kalteHerz.StopVideo()

                ElseIf ComboBox1.SelectedIndex = 3 Then   ' *** Tag und Nacht
                End If

                Das_kalte_Herz()

            ElseIf progressEvent = DasKalteHerz.ProgressEvent.JumpAuto Then

                If ComboBox1.SelectedIndex = 0 Then       ' *** Aus
                ElseIf ComboBox1.SelectedIndex = 1 Then   ' *** Eisenbahn
                    If _StoryAuto = 0 Then
                        _StoryAuto = 1
                        Timer_Story_Auto.Interval = _StoryZeit
                        Timer_Story_Auto.Start()
                        StoryColor = Drawing.Color.LightBlue
                    Else
                        Timer_Story_Auto.Stop()
                        StoryColor = Drawing.Color.LightGray
                        _StoryAuto = 0
                    End If
                ElseIf ComboBox1.SelectedIndex = 2 Then   ' *** Das kalte Herz
                    If _StoryAuto = 0 Then
                        _StoryAuto = 1
                        Timer_Story_Auto.Interval = _StoryZeit
                        Timer_Story_Auto.Start()
                        StoryColor = Drawing.Color.LightBlue
                    Else
                        Timer_Story_Auto.Stop()
                        StoryColor = Drawing.Color.LightGray
                        _StoryAuto = 0
                    End If

                ElseIf ComboBox1.SelectedIndex = 3 Then   ' *** Tag und Nacht
                End If
                Das_kalte_Herz()
            End If
        End If

    End Sub

    Public Property StoryText As String
        Get
            Return TextBox1.Text
        End Get
        Set(value As String)
            TextBox1.Text = value
            _kalteHerz.StoryText = value
        End Set
    End Property

    Public WriteOnly Property StoryImage As String
        Set(value As String)
            _kalteHerz.StoryImage = value
        End Set
    End Property

    Public WriteOnly Property StoryColor As System.Drawing.Color
        Set(value As System.Drawing.Color)
            _kalteHerz.StoryColor = value
        End Set
    End Property

    Public Property StoryFont As System.Drawing.Font
        Get
            Return _kalteHerz.StoryFont
        End Get
        Set(value As System.Drawing.Font)
            _kalteHerz.StoryFont = value
        End Set
    End Property

    Private Sub PlayMusic(ByRef file As String)
        _mediaProvider.PlayMusic(file)
    End Sub

    Private Sub StopMusic()
        PlayMusic("H:\\Eisenbahn\\EisenbahnV4\\Plugins\\KlausEBspecific\\Musik\\Stop.wav")
        '_Musicplayer.controls.stop()
    End Sub

    Private Sub ButtonsVisible(Button As Integer)
        Routen(Button21, _Route_Gleis1)
        Routen(Button22, _Route_Gleis2)
        Routen(Button23, _Route_Gleis3)
        Routen(Button24, _Route_Gleis4)

        Button19.Visible = False
        Button38.Visible = False
        Button30.Visible = False
        Button35.Visible = False
        Button40.Visible = False
        Button44.Visible = False

        Button15.Visible = False
        Button16.Visible = False
        Button17.Visible = False
        Button18.Visible = False

        ' *** Betriebsart = 0
        If _Betriebsart = 0 Then
            NumericUpDown1.Visible = True
            NumericUpDown2.Visible = True
            NumericUpDown3.Visible = True
            NumericUpDown4.Visible = True

            Button11.Visible = False
            Button12.Visible = False

            Button19.Visible = False
            Button38.Visible = False
            Button30.Visible = False
            Button35.Visible = False
            Button40.Visible = False
            Button44.Visible = False

            Button21.Visible = False
            Button22.Visible = False
            Button23.Visible = False
            Button24.Visible = False

            Button31.Visible = False
            Button32.Visible = False
            Button33.Visible = False
            Button34.Visible = False

            Button51.Visible = False
            Button52.Visible = False
            Button53.Visible = False
            Button54.Visible = False

            Button61.Visible = False
            Button62.Visible = False
            Button63.Visible = False
            Button64.Visible = False

            Button71.Visible = False
            Button72.Visible = False
            Button73.Visible = False
            Button74.Visible = False

            Button81.Visible = False
            Button82.Visible = False
            Button83.Visible = False
            Button84.Visible = False

            Button91.Visible = False
            Button92.Visible = False
            Button93.Visible = False
            Button94.Visible = False

            Label1.Visible = False
            Label2.Visible = False
            Label4.Visible = False
            Label25.Visible = False
            Label5.Visible = False
            Label6.Visible = False
            Label28.Visible = False

            Label26.Visible = False
            Label24.Visible = False
            Label7.Visible = False
            Label29.Visible = False
            Label27.Visible = False
            Label12.Visible = False
            Label15.Visible = False

            LineShape1.Visible = False
            LineShape2.Visible = False
            LineShape3.Visible = False
            LineShape4.Visible = False


        End If
        ' *** Betriebsart = 1
        If _Betriebsart = 1 Then
            NumericUpDown1.Visible = True
            NumericUpDown2.Visible = True
            NumericUpDown3.Visible = True
            NumericUpDown4.Visible = True

            NumericUpDown8.Visible = True
            NumericUpDown9.Visible = True
            NumericUpDown10.Visible = True
            NumericUpDown11.Visible = True

            Button11.Visible = True
            Button12.Visible = True
            Button15.Visible = False
            Button16.Visible = False
            Button17.Visible = False
            Button18.Visible = False
            Button21.Visible = False
            Button22.Visible = False
            Button23.Visible = False
            Button24.Visible = False
            Button31.Visible = False
            Button32.Visible = False
            Button33.Visible = False
            Button34.Visible = False
            LineShape1.Visible = False
            LineShape2.Visible = False
            LineShape3.Visible = False
            LineShape4.Visible = False
            If Betriebsart12 = 1 Or Betriebsart12 = 3 Then
                Button31.Visible = True
                LineShape1.Visible = True
            End If
            If Betriebsart12 = 2 Or Betriebsart12 = 3 Then
                Button32.Visible = True
                LineShape2.Visible = True
            End If
            If Betriebsart34 = 3 Or Betriebsart34 = 5 Then
                Button33.Visible = True
                LineShape3.Visible = True
            End If
            If Betriebsart34 = 4 Or Betriebsart34 = 5 Then
                Button34.Visible = True
                LineShape4.Visible = True
            End If
            Button51.Visible = False
            Button52.Visible = False
            Button53.Visible = False
            Button54.Visible = False
            Button61.Visible = False
            Button62.Visible = False
            Button63.Visible = False
            Button64.Visible = False
            Button71.Visible = False
            Button72.Visible = False
            Button73.Visible = False
            Button74.Visible = False
            Button81.Visible = False
            Button82.Visible = False
            Button83.Visible = False
            Button84.Visible = False
            Button91.Visible = False
            Button92.Visible = False
            Button93.Visible = False
            Button94.Visible = False

        End If
        ' *** Betriebsart = 2
        If _Betriebsart = 2 Then
            ' *** Allgemein
            NumericUpDown1.Visible = True
            NumericUpDown2.Visible = True
            NumericUpDown3.Visible = True
            NumericUpDown4.Visible = True
            Button11.Visible = True
            Button12.Visible = True

            If Betriebsart12 = 0 Then
                Label1.Visible = False
                Label2.Visible = False
                Label4.Visible = False
                Label25.Visible = False
                Label5.Visible = False
                Label6.Visible = False
                Label28.Visible = False
            Else
                Label1.Visible = True
                Label2.Visible = True
                Label4.Visible = True
                Label25.Visible = True
                Label5.Visible = True
                Label6.Visible = True
                Label28.Visible = True
            End If
            If Betriebsart34 = 0 Then
                Label26.Visible = False
                Label24.Visible = False
                Label7.Visible = False
                Label29.Visible = False
                Label27.Visible = False
                Label12.Visible = False
                Label15.Visible = False
            Else
                Label26.Visible = True
                Label24.Visible = True
                Label7.Visible = True
                Label29.Visible = True
                Label27.Visible = True
                Label12.Visible = True
                Label15.Visible = True
            End If
            '*** Betriebsart12 = 0 und Betriebsart34 = 0
            If _Betriebsart12 = 0 And _Betriebsart34 = 0 Then
                Button21.Visible = False
                Button22.Visible = False
                Button23.Visible = False
                Button24.Visible = False

                Button31.Visible = False
                Button32.Visible = False
                Button33.Visible = False
                Button34.Visible = False

                Button51.Visible = False
                Button52.Visible = False
                Button53.Visible = False
                Button54.Visible = False

                Button61.Visible = False
                Button62.Visible = False
                Button63.Visible = False
                Button64.Visible = False

                Button71.Visible = False
                Button72.Visible = False
                Button73.Visible = False
                Button74.Visible = False

                Button81.Visible = False
                Button82.Visible = False
                Button83.Visible = False
                Button84.Visible = False

                Button91.Visible = False
                Button92.Visible = False
                Button93.Visible = False
                Button94.Visible = False

                LineShape1.Visible = False
                LineShape2.Visible = False
                LineShape3.Visible = False
                LineShape4.Visible = False


                Button15.Visible = False
                Button16.Visible = False
                Button17.Visible = False
                Button18.Visible = False

            End If
            '*** Betriebsart12 = 0 und Betriebsart34 = 3
            If _Betriebsart12 = 0 And _Betriebsart34 = 3 Then

                Button15.Visible = False
                Button16.Visible = False
                Button17.Visible = False
                Button18.Visible = False

                Button30.Visible = True
                Button35.Visible = False

                LineShape1.Visible = False
                LineShape2.Visible = False
                LineShape3.Visible = True
                LineShape4.Visible = False
                NumericUpDown1.Visible = False
                NumericUpDown2.Visible = False
                NumericUpDown3.Visible = True
                NumericUpDown4.Visible = False
                Button21.Visible = False
                Button22.Visible = False
                Button23.Visible = True
                Button24.Visible = False

                Button31.Visible = False
                Button32.Visible = False
                Button34.Visible = False

                Button51.Visible = False
                Button52.Visible = False
                Button54.Visible = False

                Button61.Visible = False
                Button62.Visible = False
                Button64.Visible = False

                Button71.Visible = False
                Button72.Visible = False
                Button74.Visible = False

                Button81.Visible = False
                Button82.Visible = False
                Button84.Visible = False

                Button91.Visible = False
                Button92.Visible = False
                Button94.Visible = False

                If _Route_Gleis3 = 0 Then
                    Button33.Visible = True
                    Button53.Visible = True
                    Button63.Visible = False
                    Button73.Visible = False
                    Button83.Visible = False
                    Button93.Visible = False

                ElseIf _Route_Gleis3 = 1 Then
                    Button33.Visible = True
                    Button53.Visible = False
                    Button63.Visible = True
                    Button73.Visible = False
                    Button83.Visible = True
                    Button93.Visible = True

                ElseIf _Route_Gleis3 = 2 Then
                    Button33.Visible = True
                    Button53.Visible = True
                    Button63.Visible = True
                    Button73.Visible = True
                    Button83.Visible = False
                    Button93.Visible = True
                End If
            End If
            '*** Betriebsart12 = 0 und Betriebsart34 = 4
            If _Betriebsart12 = 0 And _Betriebsart34 = 4 Then

                Button15.Visible = False
                Button16.Visible = False
                Button17.Visible = False
                Button18.Visible = False

                Button30.Visible = False
                Button35.Visible = True

                LineShape1.Visible = False
                LineShape2.Visible = False
                LineShape3.Visible = False
                LineShape4.Visible = True
                NumericUpDown1.Visible = False
                NumericUpDown2.Visible = False
                NumericUpDown3.Visible = False
                NumericUpDown4.Visible = True
                Button21.Visible = False
                Button22.Visible = False
                Button23.Visible = False
                Button24.Visible = True

                Button31.Visible = False
                Button32.Visible = False
                Button33.Visible = False

                Button51.Visible = False
                Button52.Visible = False
                Button53.Visible = False

                Button61.Visible = False
                Button62.Visible = False
                Button63.Visible = False

                Button71.Visible = False
                Button72.Visible = False
                Button73.Visible = False

                Button81.Visible = False
                Button82.Visible = False
                Button83.Visible = False

                Button91.Visible = False
                Button92.Visible = False
                Button93.Visible = False

                If _Route_Gleis4 = 0 Then
                    Button34.Visible = True
                    Button54.Visible = True
                    Button64.Visible = False
                    Button74.Visible = False
                    Button84.Visible = False
                    Button94.Visible = False

                ElseIf _Route_Gleis4 = 1 Then
                    Button34.Visible = True
                    Button54.Visible = False
                    Button64.Visible = True
                    Button74.Visible = False
                    Button84.Visible = True
                    Button94.Visible = True

                ElseIf _Route_Gleis4 = 2 Then
                    Button34.Visible = True
                    Button54.Visible = True
                    Button64.Visible = True
                    Button74.Visible = True
                    Button84.Visible = False
                    Button94.Visible = True

                End If
            End If
            '*** Betriebsart12 = 0 und Betriebsart34 = 5
            If _Betriebsart12 = 0 And _Betriebsart34 = 5 Then

                Button15.Visible = False
                Button16.Visible = False
                Button17.Visible = False
                Button18.Visible = False

                Button19.Visible = False
                Button38.Visible = True

                LineShape1.Visible = False
                LineShape2.Visible = False
                LineShape3.Visible = True
                LineShape4.Visible = True
                NumericUpDown1.Visible = False
                NumericUpDown2.Visible = False
                NumericUpDown3.Visible = True
                NumericUpDown4.Visible = True
                Button21.Visible = False
                Button22.Visible = False
                Button23.Visible = True
                Button24.Visible = True

                Button31.Visible = False
                Button32.Visible = False

                Button51.Visible = False
                Button52.Visible = False

                Button61.Visible = False
                Button62.Visible = False

                Button71.Visible = False
                Button72.Visible = False

                Button81.Visible = False
                Button82.Visible = False

                Button91.Visible = False
                Button92.Visible = False


                If _Route_Gleis3 = 0 Then
                    Button33.Visible = True
                    Button53.Visible = True
                    Button63.Visible = False
                    Button73.Visible = False
                    Button83.Visible = False
                    Button93.Visible = False

                ElseIf _Route_Gleis3 = 1 Then
                    Button33.Visible = True
                    Button53.Visible = False
                    Button63.Visible = True
                    Button73.Visible = False
                    Button83.Visible = True
                    Button93.Visible = True

                ElseIf _Route_Gleis3 = 2 Then
                    Button33.Visible = True
                    Button53.Visible = True
                    Button63.Visible = True
                    Button73.Visible = True
                    Button83.Visible = False
                    Button93.Visible = True

                End If
                If _Route_Gleis4 = 0 Then
                    Button34.Visible = True
                    Button54.Visible = True
                    Button64.Visible = False
                    Button74.Visible = False
                    Button84.Visible = False
                    Button94.Visible = False

                ElseIf _Route_Gleis4 = 1 Then
                    Button34.Visible = True
                    Button54.Visible = False
                    Button64.Visible = True
                    Button74.Visible = False
                    Button84.Visible = True
                    Button94.Visible = True

                ElseIf _Route_Gleis4 = 2 Then
                    Button34.Visible = True
                    Button54.Visible = True
                    Button64.Visible = True
                    Button74.Visible = True
                    Button84.Visible = False
                    Button94.Visible = True

                End If
                If _Betriebsart0_5Var = 0 Then
                    'Button53.Visible = True
                    'Button54.Visible = True
                    'Button73.Visible = True
                    'Button74.Visible = True
                    'Button83.Visible = False
                    'Button84.Visible = False
                    Button53.Location = New System.Drawing.Point(882, 354)
                    Button73.Location = New System.Drawing.Point(778, 354)
                    Button83.Location = New System.Drawing.Point(678, 354)
                    Button54.Location = New System.Drawing.Point(882, 379)
                    Button74.Location = New System.Drawing.Point(778, 379)
                    Button84.Location = New System.Drawing.Point(678, 379)

                    Label27.Location = New System.Drawing.Point(685, 339)
                    Label12.Location = New System.Drawing.Point(783, 339)
                    Label15.Location = New System.Drawing.Point(884, 339)
                Else
                    Button53.Visible = True
                    Button54.Visible = True
                    Button73.Visible = True
                    Button74.Visible = True
                    Button83.Visible = True
                    Button84.Visible = True
                    Button53.Location = New System.Drawing.Point(778, 354)
                    Button73.Location = New System.Drawing.Point(678, 354)
                    Button83.Location = New System.Drawing.Point(882, 354)
                    Button54.Location = New System.Drawing.Point(778, 379)
                    Button74.Location = New System.Drawing.Point(678, 379)
                    Button84.Location = New System.Drawing.Point(882, 379)

                    Label27.Location = New System.Drawing.Point(884, 339)
                    Label12.Location = New System.Drawing.Point(685, 339)
                    Label15.Location = New System.Drawing.Point(783, 339)
                End If
            End If
            '*** Betriebsart12 = 1 und Betriebsart34 = 0
            If _Betriebsart12 = 1 And _Betriebsart34 = 0 Then
                If _Betriebsart1_0Var = 0 Then
                    Button40.Visible = True

                    NumericUpDown1.Visible = True
                    NumericUpDown2.Visible = False
                    NumericUpDown3.Visible = False
                    NumericUpDown4.Visible = False
                    Button21.Visible = True
                    Button22.Visible = False
                    Button23.Visible = False
                    Button24.Visible = False

                    Button32.Visible = False
                    Button33.Visible = False
                    Button34.Visible = False

                    Button52.Visible = False
                    Button53.Visible = False
                    Button54.Visible = False

                    Button62.Visible = False
                    Button63.Visible = False
                    Button64.Visible = False

                    Button72.Visible = False
                    Button73.Visible = False
                    Button74.Visible = False

                    Button82.Visible = False
                    Button83.Visible = False
                    Button84.Visible = False

                    Button92.Visible = False
                    Button93.Visible = False
                    Button94.Visible = False



                    If _Route_Gleis1 = 0 Then
                        Button15.Visible = False
                        Button16.Visible = False
                        Button17.Visible = False
                        Button18.Visible = False
                        LineShape1.Visible = True
                        LineShape2.Visible = False
                        LineShape3.Visible = False
                        LineShape4.Visible = False
                        Button31.Visible = True
                        Button51.Visible = True
                        Button61.Visible = False
                        Button71.Visible = False
                        Button81.Visible = False
                        Button91.Visible = False

                    ElseIf _Route_Gleis1 = 1 Then
                        Button15.Visible = False
                        Button16.Visible = False
                        Button17.Visible = False
                        Button18.Visible = False
                        LineShape1.Visible = True
                        LineShape2.Visible = False
                        LineShape3.Visible = False
                        LineShape4.Visible = False
                        Button31.Visible = True
                        Button51.Visible = False
                        Button61.Visible = True
                        Button71.Visible = False
                        Button81.Visible = False
                        Button91.Visible = True

                    ElseIf _Route_Gleis1 = 2 Then
                        Button15.Visible = False
                        Button16.Visible = True
                        Button17.Visible = True
                        Button18.Visible = True
                        LineShape1.Visible = True
                        LineShape2.Visible = True
                        LineShape3.Visible = True
                        LineShape4.Visible = True
                        Button31.Visible = True
                        Button51.Visible = True
                        Button61.Visible = True
                        Button71.Visible = True
                        Button81.Visible = True
                        Button91.Visible = True

                    End If
                Else
                    Button15.Visible = False
                    Button16.Visible = False
                    Button17.Visible = True
                    Button18.Visible = False
                    Button40.Visible = True

                    LineShape1.Visible = True
                    LineShape2.Visible = False
                    LineShape3.Visible = True
                    LineShape4.Visible = False

                    NumericUpDown1.Visible = True
                    NumericUpDown2.Visible = False
                    NumericUpDown3.Visible = False
                    NumericUpDown4.Visible = False
                    Button21.Visible = True
                    Button22.Visible = False
                    Button23.Visible = False
                    Button24.Visible = False

                    Button31.Visible = True
                    Button32.Visible = False
                    Button33.Visible = False
                    Button34.Visible = False

                    Button51.Visible = False
                    Button52.Visible = False
                    Button53.Visible = False
                    Button54.Visible = False

                    Button61.Visible = True
                    Button62.Visible = False
                    Button63.Visible = False
                    Button64.Visible = False

                    Button71.Visible = True
                    Button72.Visible = False
                    Button73.Visible = False
                    Button74.Visible = False

                    Button81.Visible = False
                    Button82.Visible = False
                    Button83.Visible = False
                    Button84.Visible = False

                    Button91.Visible = True
                    Button92.Visible = False
                    Button93.Visible = False
                    Button94.Visible = False

                End If

            End If
            '*** Betriebsart12 = 1 und Betriebsart34 = 3
            If _Betriebsart12 = 1 And _Betriebsart34 = 3 Then

                Button15.Visible = False
                Button16.Visible = False
                Button17.Visible = False
                Button18.Visible = False

                LineShape1.Visible = True
                LineShape2.Visible = False
                LineShape3.Visible = True
                LineShape4.Visible = False
                NumericUpDown1.Visible = True
                NumericUpDown2.Visible = False
                NumericUpDown3.Visible = True
                NumericUpDown4.Visible = False
                Button21.Visible = True
                Button22.Visible = False
                Button23.Visible = True
                Button24.Visible = False

                Button32.Visible = False
                Button34.Visible = False

                Button52.Visible = False
                Button54.Visible = False

                Button62.Visible = False
                Button64.Visible = False

                Button72.Visible = False
                Button74.Visible = False

                Button82.Visible = False
                Button84.Visible = False

                Button92.Visible = False
                Button94.Visible = False


                If _Route_Gleis1 = 0 Then
                    Button31.Visible = True
                    Button51.Visible = True
                    Button61.Visible = False
                    Button71.Visible = False
                    Button81.Visible = False
                    Button91.Visible = False

                ElseIf _Route_Gleis1 = 1 Then
                    Button31.Visible = True
                    Button51.Visible = False
                    Button61.Visible = True
                    Button71.Visible = False
                    Button81.Visible = False
                    Button91.Visible = True

                ElseIf _Route_Gleis1 = 2 Then
                    Button31.Visible = True
                    Button51.Visible = True
                    Button61.Visible = True
                    Button71.Visible = True
                    Button81.Visible = True
                    Button91.Visible = True

                End If
                If _Route_Gleis3 = 0 Then
                    Button33.Visible = True
                    Button53.Visible = True
                    Button63.Visible = False
                    Button73.Visible = False
                    Button83.Visible = False
                    Button93.Visible = False

                ElseIf _Route_Gleis3 = 1 Then
                    Button33.Visible = True
                    Button53.Visible = False
                    Button63.Visible = True
                    Button73.Visible = False
                    Button83.Visible = True
                    Button93.Visible = True

                ElseIf _Route_Gleis3 = 2 Then
                    Button33.Visible = True
                    Button53.Visible = True
                    Button63.Visible = True
                    Button73.Visible = True
                    Button83.Visible = False
                    Button93.Visible = True

                End If
            End If
            '*** Betriebsart12 = 1 und Betriebsart34 = 4
            If _Betriebsart12 = 1 And _Betriebsart34 = 4 Then

                Button15.Visible = False
                Button16.Visible = False
                Button17.Visible = False
                Button18.Visible = False

                LineShape1.Visible = True
                LineShape2.Visible = False
                LineShape3.Visible = False
                LineShape4.Visible = True
                NumericUpDown1.Visible = True
                NumericUpDown2.Visible = False
                NumericUpDown3.Visible = False
                NumericUpDown4.Visible = True
                Button21.Visible = True
                Button22.Visible = False
                Button23.Visible = False
                Button24.Visible = True

                Button32.Visible = False
                Button33.Visible = False

                Button52.Visible = False
                Button53.Visible = False

                Button62.Visible = False
                Button63.Visible = False

                Button72.Visible = False
                Button73.Visible = False

                Button82.Visible = False
                Button83.Visible = False

                Button92.Visible = False
                Button93.Visible = False

                If _Route_Gleis1 = 0 Then
                    Button31.Visible = True
                    Button51.Visible = True
                    Button61.Visible = False
                    Button71.Visible = False
                    Button81.Visible = False
                    Button91.Visible = False

                ElseIf _Route_Gleis1 = 1 Then
                    Button31.Visible = True
                    Button51.Visible = False
                    Button61.Visible = True
                    Button71.Visible = False
                    Button81.Visible = False
                    Button91.Visible = False

                ElseIf _Route_Gleis1 = 2 Then
                    Button31.Visible = True
                    Button51.Visible = True
                    Button61.Visible = True
                    Button71.Visible = True
                    Button81.Visible = True
                    Button91.Visible = True

                End If
                If _Route_Gleis4 = 0 Then
                    Button34.Visible = True
                    Button54.Visible = True
                    Button64.Visible = False
                    Button74.Visible = False
                    Button84.Visible = False
                    Button94.Visible = False

                ElseIf _Route_Gleis4 = 1 Then
                    Button34.Visible = True
                    Button54.Visible = False
                    Button64.Visible = True
                    Button74.Visible = False
                    Button84.Visible = True
                    Button94.Visible = True

                ElseIf _Route_Gleis4 = 2 Then
                    Button34.Visible = True
                    Button54.Visible = True
                    Button64.Visible = True
                    Button74.Visible = True
                    Button84.Visible = False
                    Button94.Visible = True

                End If
            End If
            '*** Betriebsart12 = 1 und Betriebsart34 = 5
            If _Betriebsart12 = 1 And _Betriebsart34 = 5 Then

                Button15.Visible = False
                Button16.Visible = False
                Button17.Visible = False
                Button18.Visible = False

                LineShape1.Visible = True
                LineShape2.Visible = False
                LineShape3.Visible = True
                LineShape4.Visible = True
                NumericUpDown1.Visible = True
                NumericUpDown2.Visible = False
                NumericUpDown3.Visible = True
                NumericUpDown4.Visible = True
                Button21.Visible = True
                Button22.Visible = False
                Button23.Visible = True
                Button24.Visible = True

                Button32.Visible = False

                Button52.Visible = False

                Button62.Visible = False

                Button72.Visible = False

                Button82.Visible = False

                Button92.Visible = False


                If _Route_Gleis1 = 0 Then
                    Button31.Visible = True
                    Button51.Visible = True
                    Button61.Visible = False
                    Button71.Visible = False
                    Button81.Visible = False
                    Button91.Visible = False

                ElseIf _Route_Gleis1 = 1 Then
                    Button31.Visible = True
                    Button51.Visible = False
                    Button61.Visible = True
                    Button71.Visible = False
                    Button81.Visible = False
                    Button91.Visible = True

                ElseIf _Route_Gleis1 = 2 Then
                    Button31.Visible = True
                    Button51.Visible = True
                    Button61.Visible = True
                    Button71.Visible = True
                    Button81.Visible = True
                    Button91.Visible = True

                End If
                If _Route_Gleis3 = 0 Then
                    Button33.Visible = True
                    Button53.Visible = True
                    Button63.Visible = False
                    Button73.Visible = False
                    Button83.Visible = False
                    Button93.Visible = False

                ElseIf _Route_Gleis3 = 1 Then
                    Button33.Visible = True
                    Button53.Visible = False
                    Button63.Visible = True
                    Button73.Visible = False
                    Button83.Visible = True
                    Button93.Visible = True

                ElseIf _Route_Gleis3 = 2 Then
                    Button33.Visible = True
                    Button53.Visible = True
                    Button63.Visible = True
                    Button73.Visible = True
                    Button83.Visible = False
                    Button93.Visible = False

                End If
                If _Route_Gleis4 = 0 Then
                    Button34.Visible = True
                    Button54.Visible = True
                    Button64.Visible = False
                    Button74.Visible = False
                    Button84.Visible = False
                    Button94.Visible = False

                ElseIf _Route_Gleis4 = 1 Then
                    Button34.Visible = True
                    Button54.Visible = False
                    Button64.Visible = True
                    Button74.Visible = False
                    Button84.Visible = True
                    Button94.Visible = True

                ElseIf _Route_Gleis4 = 2 Then
                    Button34.Visible = True
                    Button54.Visible = True
                    Button64.Visible = True
                    Button74.Visible = True
                    Button84.Visible = False
                    Button94.Visible = False

                End If
            End If
            '*** Betriebsart12 = 2 und Betriebsart34 = 0
            If _Betriebsart12 = 2 And _Betriebsart34 = 0 Then

                Button15.Visible = False
                Button16.Visible = False
                Button17.Visible = False
                Button18.Visible = False

                LineShape1.Visible = False
                LineShape2.Visible = True
                LineShape3.Visible = False
                LineShape4.Visible = False
                NumericUpDown1.Visible = False
                NumericUpDown2.Visible = True
                NumericUpDown3.Visible = False
                NumericUpDown4.Visible = False
                Button21.Visible = False
                Button22.Visible = True
                Button23.Visible = False
                Button24.Visible = False

                Button31.Visible = False ' Altenstein <-
                Button33.Visible = False
                Button34.Visible = False

                Button44.Visible = True

                Button51.Visible = False ' Schattenbahnhof
                Button53.Visible = False
                Button54.Visible = False

                Button61.Visible = False ' Bärental
                Button63.Visible = False
                Button64.Visible = False

                Button71.Visible = False ' Altenstein ->
                Button73.Visible = False
                Button74.Visible = False

                Button81.Visible = False
                Button83.Visible = False
                Button84.Visible = False

                Button91.Visible = False
                Button93.Visible = False
                Button94.Visible = False

                If _Betriebsart2_0Var = 0 Then

                    If _Route_Gleis2 = 0 Then
                        Button32.Visible = True     ' Altenstein <-
                        Button52.Visible = True     ' Schattenbahnhof
                        Button62.Visible = False    ' Bärental
                        Button72.Visible = False    ' Altenstein ->
                        Button82.Visible = False
                        Button92.Visible = False

                    ElseIf _Route_Gleis2 = 1 Then
                        Button32.Visible = True     ' Altenstein <-
                        Button52.Visible = False    ' Schattenbahnhof
                        Button62.Visible = True     ' Bärental
                        Button72.Visible = False    ' Altenstein ->
                        Button82.Visible = False
                        Button92.Visible = True

                    ElseIf _Route_Gleis2 = 2 Then
                        Button32.Visible = True     ' Altenstein <-
                        Button52.Visible = True     ' Schattenbahnhof
                        Button62.Visible = True     ' Bärental
                        Button72.Visible = True     ' Altenstein ->
                        Button82.Visible = True
                        Button92.Visible = True

                    End If
                Else
                    If _Route_Gleis2 = 0 Then
                        Button32.Visible = True     ' Altenstein <-
                        Button52.Visible = True     ' Schattenbahnhof
                        Button62.Visible = False    ' Bärental
                        Button72.Visible = False    ' Altenstein ->
                        Button82.Visible = False
                        Button92.Visible = False

                    ElseIf _Route_Gleis2 = 1 Then
                        Button32.Visible = False    ' Altenstein <-
                        Button52.Visible = False    ' Schattenbahnhof
                        Button62.Visible = True     ' Bärental
                        Button72.Visible = True     ' Altenstein ->
                        Button82.Visible = False
                        Button92.Visible = True

                    ElseIf _Route_Gleis2 = 2 Then
                        Button32.Visible = True     ' Altenstein <-
                        Button52.Visible = True     ' Schattenbahnhof
                        Button62.Visible = True     ' Bärental
                        Button72.Visible = True     ' Altenstein ->
                        Button82.Visible = True
                        Button92.Visible = True

                    End If
                End If

            End If
            If _Betriebsart12 = 2 And _Betriebsart34 = 3 Then

                Button15.Visible = False
                Button16.Visible = False
                Button17.Visible = False
                Button18.Visible = False

                LineShape1.Visible = False
                LineShape2.Visible = True
                LineShape3.Visible = True
                LineShape4.Visible = False
                NumericUpDown1.Visible = False
                NumericUpDown2.Visible = True
                NumericUpDown3.Visible = True
                NumericUpDown4.Visible = False
                Button21.Visible = False
                Button22.Visible = True
                Button23.Visible = True
                Button24.Visible = False

                Button31.Visible = False
                Button34.Visible = False

                Button51.Visible = False
                Button54.Visible = False

                Button61.Visible = False
                Button64.Visible = False

                Button71.Visible = False
                Button74.Visible = False

                Button81.Visible = False
                Button84.Visible = False

                Button91.Visible = False
                Button94.Visible = False


                If _Route_Gleis2 = 0 Then
                    Button32.Visible = True
                    Button52.Visible = True
                    Button62.Visible = False
                    Button72.Visible = False
                    Button82.Visible = False
                    Button92.Visible = False

                ElseIf _Route_Gleis2 = 1 Then
                    Button32.Visible = True
                    Button52.Visible = False
                    Button62.Visible = True
                    Button72.Visible = False
                    Button82.Visible = False
                    Button92.Visible = True

                ElseIf _Route_Gleis2 = 2 Then
                    Button32.Visible = True
                    Button52.Visible = True
                    Button62.Visible = True
                    Button72.Visible = True
                    Button82.Visible = True
                    Button92.Visible = True

                End If

                If _Route_Gleis3 = 0 Then
                    Button33.Visible = True
                    Button53.Visible = True
                    Button63.Visible = False
                    Button73.Visible = False
                    Button83.Visible = False
                    Button93.Visible = False

                ElseIf _Route_Gleis3 = 1 Then
                    Button33.Visible = True
                    Button53.Visible = False
                    Button63.Visible = True
                    Button73.Visible = False
                    Button83.Visible = True
                    Button93.Visible = True

                ElseIf _Route_Gleis3 = 2 Then
                    Button33.Visible = True
                    Button53.Visible = True
                    Button63.Visible = True
                    Button73.Visible = True
                    Button83.Visible = False
                    Button93.Visible = True

                End If
            End If
            '*** Betriebsart12 = 2 und Betriebsart34 = 4
            If _Betriebsart12 = 2 And _Betriebsart34 = 4 Then

                Button15.Visible = False
                Button16.Visible = False
                Button17.Visible = False
                Button18.Visible = False

                LineShape1.Visible = False
                LineShape2.Visible = True
                LineShape3.Visible = False
                LineShape4.Visible = True
                NumericUpDown1.Visible = False
                NumericUpDown2.Visible = True
                NumericUpDown3.Visible = False
                NumericUpDown4.Visible = True
                Button21.Visible = False
                Button22.Visible = True
                Button23.Visible = False
                Button24.Visible = True

                Button31.Visible = False
                Button33.Visible = False

                Button51.Visible = False
                Button53.Visible = False

                Button61.Visible = False
                Button63.Visible = False

                Button71.Visible = False
                Button73.Visible = False

                Button81.Visible = False
                Button83.Visible = False

                Button91.Visible = False
                Button93.Visible = False


                If _Route_Gleis2 = 0 Then
                    Button32.Visible = True
                    Button52.Visible = True
                    Button62.Visible = False
                    Button72.Visible = False
                    Button82.Visible = False
                    Button92.Visible = False

                ElseIf _Route_Gleis2 = 1 Then
                    Button32.Visible = True
                    Button52.Visible = False
                    Button62.Visible = True
                    Button72.Visible = False
                    Button82.Visible = False
                    Button92.Visible = True

                ElseIf _Route_Gleis2 = 2 Then
                    Button32.Visible = True
                    Button52.Visible = True
                    Button62.Visible = True
                    Button72.Visible = True
                    Button82.Visible = True
                    Button92.Visible = True

                End If

                If _Route_Gleis4 = 0 Then
                    Button34.Visible = True
                    Button54.Visible = True
                    Button64.Visible = False
                    Button74.Visible = False
                    Button84.Visible = False
                    Button94.Visible = False

                ElseIf _Route_Gleis4 = 1 Then
                    Button34.Visible = True
                    Button54.Visible = False
                    Button64.Visible = True
                    Button74.Visible = False
                    Button84.Visible = True
                    Button94.Visible = True

                ElseIf _Route_Gleis4 = 2 Then
                    Button34.Visible = True
                    Button54.Visible = True
                    Button64.Visible = True
                    Button74.Visible = True
                    Button84.Visible = False
                    Button94.Visible = True

                End If
            End If
            '*** Betriebsart12 = 2 und Betriebsart34 = 5
            If _Betriebsart12 = 2 And _Betriebsart34 = 5 Then

                Button15.Visible = False
                Button16.Visible = False
                Button17.Visible = False
                Button18.Visible = False

                LineShape1.Visible = False
                LineShape2.Visible = True
                LineShape3.Visible = True
                LineShape4.Visible = True
                NumericUpDown1.Visible = False
                NumericUpDown2.Visible = True
                NumericUpDown3.Visible = True
                NumericUpDown4.Visible = True
                Button21.Visible = False
                Button22.Visible = True
                Button23.Visible = True
                Button24.Visible = True
                Button31.Visible = False
                Button51.Visible = False
                Button61.Visible = False
                Button71.Visible = False
                Button81.Visible = False
                Button91.Visible = False


                If _Route_Gleis2 = 0 Then
                    Button32.Visible = True
                    Button52.Visible = True
                    Button62.Visible = False
                    Button72.Visible = False
                    Button82.Visible = False
                    Button92.Visible = False

                ElseIf _Route_Gleis2 = 1 Then
                    Button32.Visible = True
                    Button52.Visible = False
                    Button62.Visible = True
                    Button72.Visible = False
                    Button82.Visible = False
                    Button92.Visible = True

                ElseIf _Route_Gleis2 = 2 Then
                    Button32.Visible = True
                    Button52.Visible = True
                    Button62.Visible = True
                    Button72.Visible = True
                    Button82.Visible = True
                    Button92.Visible = True

                End If
                If _Route_Gleis3 = 0 Then
                    Button33.Visible = True
                    Button53.Visible = True
                    Button63.Visible = False
                    Button73.Visible = False
                    Button83.Visible = False
                    Button93.Visible = False

                ElseIf _Route_Gleis3 = 1 Then
                    Button33.Visible = True
                    Button53.Visible = False
                    Button63.Visible = True
                    Button73.Visible = False
                    Button83.Visible = True
                    Button93.Visible = True

                ElseIf _Route_Gleis3 = 2 Then
                    Button33.Visible = True
                    Button53.Visible = True
                    Button63.Visible = True
                    Button73.Visible = True
                    Button83.Visible = False
                    Button93.Visible = True

                End If
                If _Route_Gleis4 = 0 Then
                    Button34.Visible = True
                    Button54.Visible = True
                    Button64.Visible = False
                    Button74.Visible = False
                    Button84.Visible = False
                    Button94.Visible = False

                ElseIf _Route_Gleis4 = 1 Then
                    Button34.Visible = True
                    Button54.Visible = False
                    Button64.Visible = True
                    Button74.Visible = False
                    Button84.Visible = True
                    Button94.Visible = True

                ElseIf _Route_Gleis4 = 2 Then
                    Button34.Visible = True
                    Button54.Visible = True
                    Button64.Visible = True
                    Button74.Visible = True
                    Button84.Visible = False
                    Button94.Visible = True

                End If
            End If
            '*** Betriebsart12 = 3 und Betriebsart34 = 0
            If _Betriebsart12 = 3 And _Betriebsart34 = 0 Then
                Button19.Visible = True
                Button38.Visible = False

                Button15.Visible = False
                Button16.Visible = False
                Button17.Visible = False
                'Button17.Text = "Variante 1"
                Button18.Visible = False

                LineShape1.Visible = True
                LineShape2.Visible = True
                LineShape3.Visible = False
                LineShape4.Visible = False
                NumericUpDown1.Visible = True
                NumericUpDown2.Visible = True
                NumericUpDown3.Visible = False
                NumericUpDown4.Visible = False
                Button21.Visible = True
                Button22.Visible = True
                Button23.Visible = False
                Button24.Visible = False

                Button33.Visible = False
                Button34.Visible = False

                Button53.Visible = False
                Button54.Visible = False

                Button63.Visible = False
                Button64.Visible = False

                Button73.Visible = False
                Button74.Visible = False

                Button83.Visible = False
                Button84.Visible = False

                Button93.Visible = False
                Button94.Visible = False

                If _Betriebsart3_0Var = 2 Then
                    Button31.Visible = True     ' Altenstein <-
                    Button51.Visible = False    ' Schattenbahnhof
                    Button61.Visible = True     ' Bärental
                    Button71.Visible = False    ' Altenstein ->
                    Button81.Visible = False
                    Button91.Visible = True

                    Button32.Visible = False    ' Altenstein <-
                    Button52.Visible = False    ' Schattenbahnhof
                    Button62.Visible = True     ' Bärental
                    Button72.Visible = True     ' Altenstein ->
                    Button82.Visible = False
                    Button92.Visible = True

                Else

                    If _Route_Gleis1 = 0 Then
                        Button31.Visible = True
                        Button51.Visible = True
                        Button61.Visible = False
                        Button71.Visible = False
                        Button81.Visible = False
                        Button91.Visible = False

                    ElseIf _Route_Gleis1 = 1 Then
                        Button31.Visible = True
                        Button51.Visible = False
                        Button61.Visible = True
                        Button71.Visible = False
                        Button81.Visible = False
                        Button91.Visible = True

                    ElseIf _Route_Gleis1 = 2 Then
                        Button31.Visible = True
                        Button51.Visible = True
                        Button61.Visible = True
                        Button71.Visible = True
                        Button81.Visible = True
                        Button91.Visible = True

                    End If
                    If _Route_Gleis2 = 0 Then
                        Button32.Visible = True
                        Button52.Visible = True
                        Button62.Visible = False
                        Button72.Visible = False
                        Button82.Visible = False
                        Button92.Visible = False

                    ElseIf _Route_Gleis2 = 1 Then
                        Button32.Visible = True
                        Button52.Visible = False
                        Button62.Visible = True
                        Button72.Visible = False
                        Button82.Visible = False
                        Button92.Visible = True

                    ElseIf _Route_Gleis2 = 2 Then
                        Button32.Visible = True
                        Button52.Visible = True
                        Button62.Visible = True
                        Button72.Visible = True
                        Button82.Visible = True
                        Button92.Visible = True

                    End If
                End If



            End If
            '*** Betriebsart12 = 3 und Betriebsart34 = 3
            If _Betriebsart12 = 3 And _Betriebsart34 = 3 Then

                Button15.Visible = False
                Button16.Visible = False
                Button17.Visible = False
                Button18.Visible = False

                LineShape1.Visible = True
                LineShape2.Visible = True
                LineShape3.Visible = True
                LineShape4.Visible = False
                NumericUpDown1.Visible = True
                NumericUpDown2.Visible = True
                NumericUpDown3.Visible = True
                NumericUpDown4.Visible = False
                Button21.Visible = True
                Button22.Visible = True
                Button23.Visible = True
                Button24.Visible = False

                Button34.Visible = False

                Button54.Visible = False

                Button64.Visible = False

                Button74.Visible = False

                Button84.Visible = False

                Button94.Visible = False


                If _Route_Gleis1 = 0 Then
                    Button31.Visible = True
                    Button51.Visible = True
                    Button61.Visible = False
                    Button71.Visible = False
                    Button81.Visible = False
                    Button91.Visible = False

                ElseIf _Route_Gleis1 = 1 Then
                    Button31.Visible = True
                    Button51.Visible = False
                    Button61.Visible = True
                    Button71.Visible = False
                    Button81.Visible = False
                    Button91.Visible = True

                ElseIf _Route_Gleis1 = 2 Then
                    Button31.Visible = True
                    Button51.Visible = True
                    Button61.Visible = True
                    Button71.Visible = True
                    Button81.Visible = True
                    Button91.Visible = True

                End If
                If _Route_Gleis2 = 0 Then
                    Button32.Visible = True
                    Button52.Visible = True
                    Button62.Visible = False
                    Button72.Visible = False
                    Button82.Visible = False
                    Button92.Visible = False

                ElseIf _Route_Gleis2 = 1 Then
                    Button32.Visible = True
                    Button52.Visible = False
                    Button62.Visible = True
                    Button72.Visible = False
                    Button82.Visible = False
                    Button92.Visible = True

                ElseIf _Route_Gleis2 = 2 Then
                    Button32.Visible = True
                    Button52.Visible = True
                    Button62.Visible = True
                    Button72.Visible = True
                    Button82.Visible = True
                    Button92.Visible = True

                End If
                If _Route_Gleis3 = 0 Then
                    Button33.Visible = True
                    Button53.Visible = True
                    Button63.Visible = False
                    Button73.Visible = False
                    Button83.Visible = False
                    Button93.Visible = False

                ElseIf _Route_Gleis3 = 1 Then
                    Button33.Visible = True
                    Button53.Visible = False
                    Button63.Visible = True
                    Button73.Visible = False
                    Button83.Visible = True
                    Button93.Visible = True

                ElseIf _Route_Gleis3 = 2 Then
                    Button33.Visible = True
                    Button53.Visible = True
                    Button63.Visible = True
                    Button73.Visible = True
                    Button83.Visible = False
                    Button93.Visible = True

                End If
            End If
            '*** Betriebsart12 = 3 und Betriebsart34 = 4
            If _Betriebsart12 = 3 And _Betriebsart34 = 4 Then

                Button15.Visible = False
                Button16.Visible = False
                Button17.Visible = False
                Button18.Visible = False

                LineShape1.Visible = True
                LineShape2.Visible = True
                LineShape3.Visible = False
                LineShape4.Visible = True
                NumericUpDown1.Visible = True
                NumericUpDown2.Visible = True
                NumericUpDown3.Visible = False
                NumericUpDown4.Visible = True
                Button21.Visible = True
                Button22.Visible = True
                Button23.Visible = False
                Button24.Visible = True

                Button33.Visible = False

                Button53.Visible = False

                Button63.Visible = False

                Button73.Visible = False

                Button83.Visible = False

                Button93.Visible = False



                If _Route_Gleis1 = 0 Then
                    Button31.Visible = True
                    Button51.Visible = True
                    Button61.Visible = False
                    Button71.Visible = False
                    Button81.Visible = False
                    Button91.Visible = False

                ElseIf _Route_Gleis1 = 1 Then
                    Button31.Visible = True
                    Button51.Visible = False
                    Button61.Visible = True
                    Button71.Visible = False
                    Button81.Visible = False
                    Button91.Visible = True

                ElseIf _Route_Gleis1 = 2 Then
                    Button31.Visible = True
                    Button51.Visible = True
                    Button61.Visible = True
                    Button71.Visible = True
                    Button81.Visible = True
                    Button91.Visible = True

                End If
                If _Route_Gleis2 = 0 Then
                    Button32.Visible = True
                    Button52.Visible = True
                    Button62.Visible = False
                    Button72.Visible = False
                    Button82.Visible = False
                    Button92.Visible = False

                ElseIf _Route_Gleis2 = 1 Then
                    Button32.Visible = True
                    Button52.Visible = False
                    Button62.Visible = True
                    Button72.Visible = False
                    Button82.Visible = False
                    Button92.Visible = True

                ElseIf _Route_Gleis2 = 2 Then
                    Button32.Visible = True
                    Button52.Visible = True
                    Button62.Visible = True
                    Button72.Visible = True
                    Button82.Visible = True
                    Button92.Visible = True

                End If
                If _Route_Gleis4 = 0 Then
                    Button34.Visible = True
                    Button54.Visible = True
                    Button64.Visible = False
                    Button74.Visible = False
                    Button84.Visible = False
                    Button94.Visible = False

                ElseIf _Route_Gleis4 = 1 Then
                    Button34.Visible = True
                    Button54.Visible = False
                    Button64.Visible = True
                    Button74.Visible = False
                    Button84.Visible = True
                    Button94.Visible = True

                ElseIf _Route_Gleis4 = 2 Then
                    Button34.Visible = True
                    Button54.Visible = True
                    Button64.Visible = True
                    Button74.Visible = True
                    Button84.Visible = False
                    Button94.Visible = True

                End If
            End If
            '*** Betriebsart12 = 3 und Betriebsart34 = 5
            If _Betriebsart12 = 3 And _Betriebsart34 = 5 Then

                Button15.Visible = False
                Button16.Visible = False
                Button17.Visible = False
                Button18.Visible = False

                LineShape1.Visible = True
                LineShape2.Visible = True
                LineShape3.Visible = True
                LineShape4.Visible = True
                NumericUpDown1.Visible = True
                NumericUpDown2.Visible = True
                NumericUpDown3.Visible = True
                NumericUpDown4.Visible = True
                Button21.Visible = True
                Button22.Visible = True
                Button23.Visible = True
                Button24.Visible = True
                If _Route_Gleis1 = 0 Then
                    Button31.Visible = True
                    Button51.Visible = True
                    Button61.Visible = False
                    Button71.Visible = False
                    Button81.Visible = False
                    Button91.Visible = False

                ElseIf _Route_Gleis1 = 1 Then
                    Button31.Visible = True
                    Button51.Visible = False
                    Button61.Visible = True
                    Button71.Visible = False
                    Button81.Visible = False
                    Button91.Visible = True

                ElseIf _Route_Gleis1 = 2 Then
                    Button31.Visible = True
                    Button51.Visible = True
                    Button61.Visible = True
                    Button71.Visible = True
                    Button81.Visible = True
                    Button91.Visible = True

                End If

                If _Route_Gleis2 = 0 Then
                    Button32.Visible = True
                    Button52.Visible = True
                    Button62.Visible = False
                    Button72.Visible = False
                    Button82.Visible = False
                    Button92.Visible = False

                ElseIf _Route_Gleis2 = 1 Then
                    Button32.Visible = True
                    Button52.Visible = False
                    Button62.Visible = True
                    Button72.Visible = False
                    Button82.Visible = False
                    Button92.Visible = True

                ElseIf _Route_Gleis2 = 2 Then
                    Button32.Visible = True
                    Button52.Visible = True
                    Button62.Visible = True
                    Button72.Visible = True
                    Button82.Visible = True
                    Button92.Visible = True

                End If

                If _Route_Gleis3 = 0 Then
                    Button33.Visible = True
                    Button53.Visible = True
                    Button63.Visible = False
                    Button73.Visible = False
                    Button83.Visible = False
                    Button93.Visible = False

                ElseIf _Route_Gleis3 = 1 Then
                    Button33.Visible = True
                    Button53.Visible = False
                    Button63.Visible = True
                    Button73.Visible = False
                    Button83.Visible = True
                    Button93.Visible = True

                ElseIf _Route_Gleis3 = 2 Then
                    Button33.Visible = True
                    Button53.Visible = True
                    Button63.Visible = True
                    Button73.Visible = True
                    Button83.Visible = False
                    Button93.Visible = True

                End If

                If _Route_Gleis4 = 0 Then
                    Button34.Visible = True
                    Button54.Visible = True
                    Button64.Visible = False
                    Button74.Visible = False
                    Button84.Visible = False
                    Button94.Visible = False

                ElseIf _Route_Gleis4 = 1 Then
                    Button34.Visible = True
                    Button54.Visible = False
                    Button64.Visible = True
                    Button74.Visible = False
                    Button84.Visible = True
                    Button94.Visible = True

                ElseIf _Route_Gleis4 = 2 Then
                    Button34.Visible = True
                    Button54.Visible = True
                    Button64.Visible = True
                    Button74.Visible = True
                    Button84.Visible = False
                    Button94.Visible = True

                End If
            End If
        End If

        ' *** Verhalten im Bahnhof
        'If _Bhf_Gleis1 = 0 Then
        '    Button31.Text = "kein Halt"
        '    Button31.BackColor = Drawing.Color.LightGreen
        'ElseIf _Bhf_Gleis1 = 1 Then
        '    Button31.Text = "Halt"
        '    Button31.BackColor = Drawing.Color.LightYellow
        'ElseIf _Bhf_Gleis1 = 2 Then
        '    Button31.Text = "Wechsel > 2"
        '    Button31.BackColor = Drawing.Color.LightYellow
        'ElseIf _Bhf_Gleis1 = 3 Then
        '    Button31.Text = "Wechsel > 3"
        '    Button31.BackColor = Drawing.Color.LightYellow
        'ElseIf _Bhf_Gleis1 = 4 Then
        '    Button31.Text = "Wechsel > 4"
        '    Button31.BackColor = Drawing.Color.LightYellow
        'End If

        'If _Bhf_Gleis2 = 0 Then
        '    Button32.Text = "kein Halt"
        '    Button32.BackColor = Drawing.Color.LightGreen
        'ElseIf _Bhf_Gleis2 = 2 Then
        '    Button32.Text = "Halt"
        '    Button32.BackColor = Drawing.Color.LightYellow
        'ElseIf _Bhf_Gleis2 = 1 Then
        '    Button32.Text = "Wechsel > 1"
        '    Button32.BackColor = Drawing.Color.LightYellow
        'ElseIf _Bhf_Gleis2 = 3 Then
        '    Button32.Text = "Wechsel > 3"
        '    Button32.BackColor = Drawing.Color.LightYellow
        'ElseIf _Bhf_Gleis2 = 4 Then
        '    Button32.Text = "Wechsel > 4"
        '    Button32.BackColor = Drawing.Color.LightYellow
        'End If

        'If _Bhf_Gleis3 = 0 Then
        '    Button33.Text = "kein Halt"
        '    Button33.BackColor = Drawing.Color.LightGreen
        'ElseIf _Bhf_Gleis3 = 1 Then
        '    Button33.Text = "Wechsel > 1"
        '    Button33.BackColor = Drawing.Color.LightYellow
        'ElseIf _Bhf_Gleis3 = 2 Then
        '    Button33.Text = "Wechsel > 2"
        '    Button33.BackColor = Drawing.Color.LightYellow
        'ElseIf _Bhf_Gleis3 = 3 Then
        '    Button33.Text = "Halt"
        '    Button33.BackColor = Drawing.Color.LightYellow
        'ElseIf _Bhf_Gleis3 = 4 Then
        '    Button33.Text = "Wechsel > 4"
        '    Button33.BackColor = Drawing.Color.LightYellow
        'End If

        'If _Bhf_Gleis4 = 0 Then
        '    Button34.Text = "kein Halt"
        '    Button34.BackColor = Drawing.Color.LightGreen
        'ElseIf _Bhf_Gleis4 = 1 Then
        '    Button34.Text = "Wechsel > 1"
        '    Button34.BackColor = Drawing.Color.LightYellow
        'ElseIf _Bhf_Gleis4 = 2 Then
        '    Button34.Text = "Wechsel > 2"
        '    Button34.BackColor = Drawing.Color.LightYellow
        'ElseIf _Bhf_Gleis4 = 3 Then
        '    Button34.Text = "Wechsel > 3"
        '    Button34.BackColor = Drawing.Color.LightYellow
        'ElseIf _Bhf_Gleis4 = 4 Then
        '    Button34.Text = "Halt"
        '    Button34.BackColor = Drawing.Color.LightYellow
        'End If
        ' *** Verhalten im Schattenbahnhof
        'If _SBhf_Gleis1 = 0 Then
        '    Button51.Text = "kein Halt"
        '    Button51.BackColor = Drawing.Color.LightGreen
        'ElseIf _SBhf_Gleis1 = 1 Then
        '    Button51.Text = "Halt"
        '    Button51.BackColor = Drawing.Color.LightYellow
        'ElseIf _SBhf_Gleis1 = 2 Then
        '    Button51.Text = "Wechsel > 2"
        '    Button51.BackColor = Drawing.Color.LightYellow
        'ElseIf _SBhf_Gleis1 = 3 Then
        '    Button51.Text = "Wechsel > 3"
        '    Button51.BackColor = Drawing.Color.LightYellow
        'ElseIf _SBhf_Gleis1 = 4 Then
        '    Button51.Text = "Wechsel > 4"
        '    Button51.BackColor = Drawing.Color.LightYellow
        'End If

        'If _SBhf_Gleis2 = 0 Then
        '    Button52.Text = "kein Halt"
        '    Button52.BackColor = Drawing.Color.LightGreen
        'ElseIf _SBhf_Gleis2 = 2 Then
        '    Button52.Text = "Halt"
        '    Button52.BackColor = Drawing.Color.LightYellow
        'ElseIf _SBhf_Gleis2 = 1 Then
        '    Button52.Text = "Wechsel > 1"
        '    Button52.BackColor = Drawing.Color.LightYellow
        'ElseIf _SBhf_Gleis2 = 3 Then
        '    Button52.Text = "Wechsel > 3"
        '    Button52.BackColor = Drawing.Color.LightYellow
        'ElseIf _SBhf_Gleis2 = 4 Then
        '    Button52.Text = "Wechsel > 4"
        '    Button52.BackColor = Drawing.Color.LightYellow
        'End If

        'If _SBhf_Gleis3 = 0 Then
        '    Button53.Text = "kein Halt"
        '    Button53.BackColor = Drawing.Color.LightGreen
        'ElseIf _SBhf_Gleis3 = 3 Then
        '    Button53.Text = "Halt"
        '    Button53.BackColor = Drawing.Color.LightYellow
        'ElseIf _SBhf_Gleis3 = 1 Then
        '    Button53.Text = "Wechsel > 1"
        '    Button53.BackColor = Drawing.Color.LightYellow
        'ElseIf _SBhf_Gleis3 = 2 Then
        '    Button53.Text = "Wechsel > 2"
        '    Button53.BackColor = Drawing.Color.LightYellow
        'ElseIf _SBhf_Gleis3 = 4 Then
        '    Button53.Text = "Wechsel > 4"
        '    Button53.BackColor = Drawing.Color.LightYellow
        'End If

        'If _SBhf_Gleis4 = 0 Then
        '    Button54.Text = "kein Halt"
        '    Button54.BackColor = Drawing.Color.LightGreen
        'ElseIf _SBhf_Gleis4 = 4 Then
        '    Button54.Text = "Halt"
        '    Button54.BackColor = Drawing.Color.LightYellow
        'ElseIf _SBhf_Gleis4 = 1 Then
        '    Button54.Text = "Wechsel > 1"
        '    Button54.BackColor = Drawing.Color.LightYellow
        'ElseIf _SBhf_Gleis4 = 2 Then
        '    Button54.Text = "Wechsel > 2"
        '    Button54.BackColor = Drawing.Color.LightYellow
        'ElseIf _SBhf_Gleis4 = 3 Then
        '    Button54.Text = "Wechsel > 3"
        '    Button54.BackColor = Drawing.Color.LightYellow
        'End If
        ' *** Verhalten auf dem Berg
        'If _Berg_Gleis1 = 0 Then
        '    Button61.Text = "kein Halt"
        '    Button61.BackColor = Drawing.Color.LightGreen
        'ElseIf _Berg_Gleis1 = 1 Then
        '    Button61.Text = "Zindelstein"
        '    Button61.BackColor = Drawing.Color.LightYellow
        'ElseIf _Berg_Gleis1 = 2 Then
        '    Button61.Text = "Bärental"
        '    Button61.BackColor = Drawing.Color.LightYellow
        'Else
        '    _Berg_Gleis1 = 0
        'End If

        'If _Berg_Gleis2 = 0 Then
        '    Button62.Text = "kein Halt"
        '    Button62.BackColor = Drawing.Color.LightGreen
        'ElseIf _Berg_Gleis2 = 1 Then
        '    Button62.Text = "Zindelstein"
        '    Button62.BackColor = Drawing.Color.LightYellow
        'ElseIf _Berg_Gleis2 = 2 Then
        '    Button62.Text = "Bärental"
        '    Button62.BackColor = Drawing.Color.LightYellow
        'Else
        '    _Berg_Gleis2 = 0
        'End If

        'If _Berg_Gleis3 = 0 Then
        '    Button63.Text = "kein Halt"
        '    Button63.BackColor = Drawing.Color.LightGreen
        'ElseIf _Berg_Gleis3 = 1 Then
        '    Button63.Text = "Zindelstein"
        '    Button63.BackColor = Drawing.Color.LightYellow
        'ElseIf _Berg_Gleis3 = 2 Then
        '    Button63.Text = "Bärental"
        '    Button63.BackColor = Drawing.Color.LightYellow
        'Else
        '    _Berg_Gleis3 = 0
        'End If

        'If _Berg_Gleis4 = 0 Then
        '    Button64.Text = "kein Halt"
        '    Button64.BackColor = Drawing.Color.LightGreen
        'ElseIf _Berg_Gleis4 = 1 Then
        '    Button64.Text = "Zindelstein"
        '    Button64.BackColor = Drawing.Color.LightYellow
        'ElseIf _Berg_Gleis4 = 2 Then
        '    Button64.Text = "Bärental"
        '    Button64.BackColor = Drawing.Color.LightYellow
        'Else
        '    _Berg_Gleis4 = 0
        'End If
        ' *** Verhalten im Bahnhof in umgekehrter Richtung
        'If _Bhf2_Gleis1 = 0 Then
        '    Button71.Text = "kein Halt"
        '    Button71.BackColor = Drawing.Color.LightGreen
        'ElseIf _Bhf2_Gleis1 = 1 Then
        '    Button71.Text = "Halt"
        '    Button71.BackColor = Drawing.Color.LightYellow
        'ElseIf _Bhf2_Gleis1 = 2 Then
        '    Button71.Text = "Wechsel > 2"
        '    Button71.BackColor = Drawing.Color.LightYellow
        'ElseIf _Bhf2_Gleis1 = 3 Then
        '    Button71.Text = "Wechsel > 3"
        '    Button71.BackColor = Drawing.Color.LightYellow
        'ElseIf _Bhf2_Gleis1 = 4 Then
        '    Button71.Text = "Wechsel > 4"
        '    Button71.BackColor = Drawing.Color.LightYellow
        'End If

        'If _Bhf2_Gleis2 = 0 Then
        '    Button72.Text = "kein Halt"
        '    Button72.BackColor = Drawing.Color.LightGreen
        'ElseIf _Bhf2_Gleis2 = 2 Then
        '    Button72.Text = "Halt"
        '    Button72.BackColor = Drawing.Color.LightYellow
        'ElseIf _Bhf2_Gleis2 = 1 Then
        '    Button72.Text = "Wechsel > 1"
        '    Button72.BackColor = Drawing.Color.LightYellow
        'ElseIf _Bhf2_Gleis2 = 3 Then
        '    Button72.Text = "Wechsel > 3"
        '    Button72.BackColor = Drawing.Color.LightYellow
        'ElseIf _Bhf2_Gleis2 = 4 Then
        '    Button72.Text = "Wechsel > 4"
        '    Button72.BackColor = Drawing.Color.LightYellow
        'End If

        'If _Bhf2_Gleis3 = 0 Then
        '    Button73.Text = "kein Halt"
        '    Button73.BackColor = Drawing.Color.LightGreen
        'ElseIf _Bhf2_Gleis3 = 1 Then
        '    Button73.Text = "Wechsel > 1"
        '    Button73.BackColor = Drawing.Color.LightYellow
        'ElseIf _Bhf2_Gleis3 = 2 Then
        '    Button73.Text = "Wechsel > 2"
        '    Button73.BackColor = Drawing.Color.LightYellow
        'ElseIf _Bhf2_Gleis3 = 3 Then
        '    Button73.Text = "Halt"
        '    Button73.BackColor = Drawing.Color.LightYellow
        'ElseIf _Bhf2_Gleis3 = 4 Then
        '    Button73.Text = "Wechsel > 4"
        '    Button73.BackColor = Drawing.Color.LightYellow
        'End If

        'If _Bhf2_Gleis4 = 0 Then
        '    Button74.Text = "kein Halt"
        '    Button74.BackColor = Drawing.Color.LightGreen
        'ElseIf _Bhf2_Gleis4 = 1 Then
        '    Button74.Text = "Wechsel > 1"
        '    Button74.BackColor = Drawing.Color.LightYellow
        'ElseIf _Bhf2_Gleis4 = 2 Then
        '    Button74.Text = "Wechsel > 2"
        '    Button74.BackColor = Drawing.Color.LightYellow
        'ElseIf _Bhf2_Gleis4 = 3 Then
        '    Button74.Text = "Wechsel > 3"
        '    Button74.BackColor = Drawing.Color.LightYellow
        'ElseIf _Bhf2_Gleis4 = 4 Then
        '    Button74.Text = "Halt"
        '    Button74.BackColor = Drawing.Color.LightYellow
        'End If
        ' *** Verhalten auf der Diagonalen
        'If Diagonale_Gleis1 = 0 Then
        '    Button81.BackColor = Drawing.Color.LightGreen
        '    Button81.Text = "kein Halt"
        'ElseIf Diagonale_Gleis1 = 1 Then
        '    Button81.Text = "Halt"
        '    Button81.BackColor = Drawing.Color.LightYellow
        'End If
        'If Diagonale_Gleis2 = 0 Then
        '    Button82.BackColor = Drawing.Color.LightGreen
        '    Button82.Text = "kein Halt"
        'ElseIf Diagonale_Gleis2 = 2 Then
        '    Button82.Text = "Halt"
        '    Button82.BackColor = Drawing.Color.LightYellow
        'End If
        'If Diagonale_Gleis3 = 0 Then
        '    Button83.BackColor = Drawing.Color.LightGreen
        '    Button83.Text = "kein Halt"
        'ElseIf Diagonale_Gleis3 = 3 Then
        '    Button83.Text = "Halt"
        '    Button83.BackColor = Drawing.Color.LightYellow
        'End If
        'If Diagonale_Gleis4 = 0 Then
        '    Button84.BackColor = Drawing.Color.LightGreen
        '    Button84.Text = "kein Halt"
        'ElseIf Diagonale_Gleis4 = 4 Then
        '    Button84.Text = "Halt"
        '    Button84.BackColor = Drawing.Color.LightYellow
        'End If
        ' *** Verhalten auf der Talstrecke
        'If Talstrecke_Gleis1 = 0 Then
        '    Button91.BackColor = Drawing.Color.LightGreen
        '    Button91.Text = "kein Halt"
        'ElseIf Talstrecke_Gleis1 = 1 Then
        '    Button91.Text = "Halt"
        '    Button91.BackColor = Drawing.Color.LightYellow
        'End If
        'If Talstrecke_Gleis2 = 0 Then
        '    Button92.BackColor = Drawing.Color.LightGreen
        '    Button92.Text = "kein Halt"
        'ElseIf Talstrecke_Gleis2 = 2 Then
        '    Button92.Text = "Halt"
        '    Button92.BackColor = Drawing.Color.LightYellow
        'End If
        'If Talstrecke_Gleis3 = 0 Then
        '    Button93.BackColor = Drawing.Color.LightGreen
        '    Button93.Text = "kein Halt"
        'ElseIf Talstrecke_Gleis3 = 3 Then
        '    Button93.Text = "Halt"
        '    Button93.BackColor = Drawing.Color.LightYellow
        'End If
        'If Talstrecke_Gleis4 = 0 Then
        '    Button94.BackColor = Drawing.Color.LightGreen
        '    Button94.Text = "kein Halt"
        'ElseIf Talstrecke_Gleis4 = 4 Then
        '    Button94.Text = "Halt"
        '    Button94.BackColor = Drawing.Color.LightYellow
        'End If


        ' *** Button39 - Fahrplan
        If Fahrplan = 0 Then
            Button39.Text = "Wartezeit"
            NumericUpDown1.Visible = True
            NumericUpDown2.Visible = True
            NumericUpDown3.Visible = True
            NumericUpDown4.Visible = True
        Else
            Button39.Text = "Fahrplan nach Tabelle"
            NumericUpDown1.Visible = False
            NumericUpDown2.Visible = False
            NumericUpDown3.Visible = False
            NumericUpDown4.Visible = False
        End If

        ' *** Button41 - Weichen stellen
        If _Weichen_initialisiert = True Then
            If _Weichen_in_Startposition = True Then
                Button41.BackColor = Drawing.Color.Green
                Button41.Text = "Weichen sind in Startposition"
            Else
                Button41.BackColor = Drawing.Color.Yellow
                Button41.Text = "Signale initialisieren"
            End If
        Else
            Button41.BackColor = Drawing.Color.Red
            Button41.Text = "Weichen initialisieren"
        End If

        ' *** Button42 - Signale stellen
        If _Signale_initialisiert = True Then
            If _Signale_in_Startposition = True Then
                Button42.BackColor = Drawing.Color.Green
                Button42.Text = "Signale sind in Startposition"
            Else
                Button42.BackColor = Drawing.Color.Yellow
                Button42.Text = "Signale initialisieren"
            End If
        Else
            Button42.BackColor = Drawing.Color.Red
        End If
        ' *** Hue - Button20, 2, 29
        If Hue_Control = 0 Then
            Button20.BackColor = Drawing.Color.LightYellow
            Button2.BackColor = Drawing.Color.LightGray
            Button29.BackColor = Drawing.Color.LightGray
        ElseIf Hue_Control = 1 Or Hue_Control = 2 Then
            Button20.BackColor = Drawing.Color.LightGray
            Button29.BackColor = Drawing.Color.LightGray
            If _Hue = 0 Then
            ElseIf _Hue = 1 Then
                Button2.BackColor = Drawing.Color.LightYellow
                Button2.Text = "Hue"
            ElseIf _Hue = 2 Then
                Button2.BackColor = Drawing.Color.LightYellow
                Button2.Text = "Hue"
            ElseIf _Hue = 3 Then
                Button2.BackColor = Drawing.Color.LightYellow
                Button2.Text = "Auto"
            ElseIf _Hue = 4 Then
                Button2.BackColor = Drawing.Color.Red
                Button2.Text = "Hue"
            ElseIf _Hue = 5 Then
                Button2.BackColor = Drawing.Color.Blue
                Button2.Text = "Hue"
            ElseIf _Hue = 6 Then
                Button2.BackColor = Drawing.Color.Green
                Button2.Text = "Hue"
            ElseIf _Hue = 7 Then
                Button2.BackColor = Drawing.Color.Yellow
                Button2.Text = "Hue"
            ElseIf _Hue = 8 Then
                Button2.BackColor = Drawing.Color.LightGray
                Button2.Text = "Hue"
            End If
        ElseIf Hue_Control = 4 Then
            Button20.BackColor = Drawing.Color.LightGray
            Button2.BackColor = Drawing.Color.LightGray
            Button29.BackColor = Drawing.Color.LightYellow
        End If

    End Sub
    ' *** Betriebsarten wählen
    Private Sub Button10_Click(sender As System.Object, e As System.EventArgs) Handles Button10.Click
        If Betriebsart = 0 Then
            Betriebsart = 1
        ElseIf Betriebsart = 1 Then
            Betriebsart = 2
        ElseIf Betriebsart = 2 Then
            Betriebsart = 0
        Else
            Betriebsart = 0
        End If
        _Weichen_in_Startposition = False
        _Signale_in_Startposition = False
        ButtonsVisible(999)
    End Sub
    Private Sub Button11_Click(sender As System.Object, e As System.EventArgs) Handles Button11.Click
        If Betriebsart12 = 0 Then
            Betriebsart12 = 1
        ElseIf Betriebsart12 = 1 Then
            Betriebsart12 = 2
        ElseIf Betriebsart12 = 2 Then
            Betriebsart12 = 3
        ElseIf Betriebsart12 = 3 Then
            Betriebsart12 = 0
        Else
            Betriebsart12 = 0
        End If
        _Weichen_in_Startposition = False
        _Signale_in_Startposition = False
        _Betriebsart0_3Var = 0
        Button30.Text = "V0"
        _Betriebsart0_4Var = 0
        Button35.Text = "V0"
        _Betriebsart0_5Var = 0
        Button38.Text = "V0"
        _Betriebsart3_0Var = 0
        Button19.Text = "V0"
        TextBox1.Text = " "
        Button43.BackColor = Drawing.Color.White
        ButtonsVisible(999)
    End Sub
    Private Sub Button12_Click(sender As System.Object, e As System.EventArgs) Handles Button12.Click
        If Betriebsart34 = 0 Then
            Betriebsart34 = 3
        ElseIf Betriebsart34 = 3 Then
            Betriebsart34 = 4
        ElseIf Betriebsart34 = 4 Then
            Betriebsart34 = 5
        ElseIf Betriebsart34 = 5 Then
            Betriebsart34 = 0
        Else
            Betriebsart34 = 0
        End If
        _Weichen_in_Startposition = False
        _Signale_in_Startposition = False
        _Betriebsart0_3Var = 0
        Button30.Text = "V0"
        _Betriebsart0_4Var = 0
        Button35.Text = "V0"
        _Betriebsart0_5Var = 0
        Button38.Text = "V0"
        _Betriebsart3_0Var = 0
        Button19.Text = "V0"
        TextBox1.Text = " "
        Button43.BackColor = Drawing.Color.White
        ButtonsVisible(999)
    End Sub
    ' *** Fahrplan
    Private Sub Button39_Click(sender As System.Object, e As System.EventArgs) Handles Button39.Click
        If Fahrplan = 0 Then
            Fahrplan = 1
            Warte1A1 = Betriebsparameter.GetValue("Fahrplan", 2, 10) * 1000
            Warte1A2 = Betriebsparameter.GetValue("Fahrplan", 8, 10) * 1000
            Warte1BA = Betriebsparameter.GetValue("Fahrplan", 10, 10) * 1000
            Warte1SB = Betriebsparameter.GetValue("Fahrplan", 4, 10) * 1000
            Warte1TA = Betriebsparameter.GetValue("Fahrplan", 12, 10) * 1000
            Warte1DI = Betriebsparameter.GetValue("Fahrplan", 6, 10) * 1000

            Warte2A1 = Betriebsparameter.GetValue("Fahrplan", 2, 11) * 1000
            Warte2A2 = Betriebsparameter.GetValue("Fahrplan", 8, 11) * 1000
            Warte2BA = Betriebsparameter.GetValue("Fahrplan", 10, 11) * 1000
            Warte2SB = Betriebsparameter.GetValue("Fahrplan", 4, 11) * 1000
            Warte2TA = Betriebsparameter.GetValue("Fahrplan", 12, 11) * 1000
            Warte2DI = Betriebsparameter.GetValue("Fahrplan", 6, 11) * 1000

            Warte3A1 = Betriebsparameter.GetValue("Fahrplan", 2, 20) * 1000
            Warte3A2 = Betriebsparameter.GetValue("Fahrplan", 10, 20) * 1000
            Warte3BA = Betriebsparameter.GetValue("Fahrplan", 4, 20) * 1000
            Warte3SB = Betriebsparameter.GetValue("Fahrplan", 12, 20) * 1000
            Warte3TA = Betriebsparameter.GetValue("Fahrplan", 6, 20) * 1000
            Warte3DI = Betriebsparameter.GetValue("Fahrplan", 8, 20) * 1000

            Warte4A1 = Betriebsparameter.GetValue("Fahrplan", 2, 21) * 1000
            Warte4A2 = Betriebsparameter.GetValue("Fahrplan", 10, 21) * 1000
            Warte4BA = Betriebsparameter.GetValue("Fahrplan", 4, 21) * 1000
            Warte4SB = Betriebsparameter.GetValue("Fahrplan", 12, 21) * 1000
            Warte4TA = Betriebsparameter.GetValue("Fahrplan", 6, 21) * 1000
            Warte4DI = Betriebsparameter.GetValue("Fahrplan", 8, 21) * 1000
        Else
            Fahrplan = 0
            Warte1A1 = NumericUpDown1.Value * 1000
            Warte1A2 = NumericUpDown1.Value * 1000
            Warte1BA = NumericUpDown1.Value * 1000
            Warte1SB = NumericUpDown1.Value * 1000
            Warte1TA = NumericUpDown1.Value * 1000
            Warte1DI = NumericUpDown1.Value * 1000

            Warte2A1 = NumericUpDown2.Value * 1000
            Warte2A2 = NumericUpDown2.Value * 1000
            Warte2BA = NumericUpDown2.Value * 1000
            Warte2SB = NumericUpDown2.Value * 1000
            Warte2TA = NumericUpDown2.Value * 1000
            Warte2DI = NumericUpDown2.Value * 1000

            Warte3A1 = NumericUpDown3.Value * 1000
            Warte3A2 = NumericUpDown3.Value * 1000
            Warte3BA = NumericUpDown3.Value * 1000
            Warte3SB = NumericUpDown3.Value * 1000
            Warte3TA = NumericUpDown3.Value * 1000
            Warte3DI = NumericUpDown3.Value * 1000

            Warte4A1 = NumericUpDown4.Value * 1000
            Warte4A2 = NumericUpDown4.Value * 1000
            Warte4BA = NumericUpDown4.Value * 1000
            Warte4SB = NumericUpDown4.Value * 1000
            Warte4TA = NumericUpDown4.Value * 1000
            Warte4DI = NumericUpDown4.Value * 1000
        End If
        ButtonsVisible(999)
    End Sub
    ' *** Betriebsart Varianten
    Private Sub Button19_Click(sender As System.Object, e As System.EventArgs) Handles Button19.Click
        '*** Betriebsartvarianten für Gleise 1 und 2
        If _Betriebsart3_0Var = 0 Then
            _Betriebsart3_0Var = 1
            Button19.Text = "V1"
            TextBox1.Text = "Züge 1 und 2 fahren hintereinander über Gleis 1 und 2 (Route OBEN LANG ist festgelegt)"
            _Route_Gleis1 = 2
            _daten.write_to_table(AutomatikParameterTableName, 3, _Route_Gleis1)
            ARoute_Lok1 = _Route_Gleis1
            _Route_Gleis2 = 2
            _daten.write_to_table(AutomatikParameterTableName, 4, _Route_Gleis2)
            ARoute_Lok2 = _Route_Gleis2
            _Bhf_Gleis1 = 1
            _Bhf_Gleis2 = 2
            _Bhf2_Gleis1 = 1
            _Bhf2_Gleis2 = 2
            _SBhf_Gleis1 = 2
            _SBhf_Gleis2 = 1
            Diagonale_Gleis1 = 2
            Diagonale_Gleis2 = 1
            Talstrecke_Gleis1 = 2
            Talstrecke_Gleis2 = 1
            Button31.Text = "Halt"
            Button31.BackColor = Drawing.Color.LightYellow
            Button32.Text = "Halt"
            Button32.BackColor = Drawing.Color.LightYellow
            Button71.Text = "Halt"
            Button71.BackColor = Drawing.Color.LightYellow
            Button72.Text = "Halt"
            Button72.BackColor = Drawing.Color.LightYellow
            Button51.Text = "Wechsel > 2"
            Button51.BackColor = Drawing.Color.LightYellow
            Button52.Text = "Wechsel > 1"
            Button52.BackColor = Drawing.Color.LightYellow
            Button81.Text = "Wechsel > 2"
            Button81.BackColor = Drawing.Color.LightYellow
            Button82.Text = "Wechsel > 1"
            Button82.BackColor = Drawing.Color.LightYellow
            Button91.Text = "Wechsel > 2"
            Button91.BackColor = Drawing.Color.LightYellow
            Button92.Text = "Wechsel > 1"
            Button92.BackColor = Drawing.Color.LightYellow

            ButtonsVisible(999)
        ElseIf _Betriebsart3_0Var = 1 Then
            _Betriebsart3_0Var = 2
            Button19.Text = "V2"
            TextBox1.Text = "Züge 1 und 2 fahren im Gegemverkehr"
            _Route_Gleis1 = 1
            _daten.write_to_table(AutomatikParameterTableName, 3, _Route_Gleis1)
            ARoute_Lok1 = _Route_Gleis1
            _Route_Gleis2 = 1
            _daten.write_to_table(AutomatikParameterTableName, 4, _Route_Gleis2)
            ARoute_Lok2 = _Route_Gleis2
            '_Bhf_Gleis1 = 1
            '_Bhf_Gleis2 = 2
            '_Bhf2_Gleis1 = 1
            '_Bhf2_Gleis2 = 2
            '_SBhf_Gleis1 = 2
            '_SBhf_Gleis2 = 1
            Diagonale_Gleis1 = 0
            Diagonale_Gleis2 = 0
            Talstrecke_Gleis1 = 0
            Talstrecke_Gleis2 = 0
            'Button31.Text = "Halt"
            'Button31.BackColor = Drawing.Color.LightYellow
            'Button32.Text = "Halt"
            'Button32.BackColor = Drawing.Color.LightYellow
            'Button71.Text = "Halt"
            'Button71.BackColor = Drawing.Color.LightYellow
            'Button72.Text = "Halt"
            'Button72.BackColor = Drawing.Color.LightYellow
            'Button51.Text = "Wechsel > 2"
            'Button51.BackColor = Drawing.Color.LightYellow
            'Button52.Text = "Wechsel > 1"
            'Button52.BackColor = Drawing.Color.LightYellow
            'Button81.Text = "Wechsel > 2"
            'Button81.BackColor = Drawing.Color.LightYellow
            'Button82.Text = "Wechsel > 1"
            'Button82.BackColor = Drawing.Color.LightYellow
            Button91.Text = "kein Halt"
            Button91.BackColor = Drawing.Color.LightGreen
            Button92.Text = "kein Halt"
            Button92.BackColor = Drawing.Color.LightGreen

            ButtonsVisible(999)
        Else
            _Betriebsart3_0Var = 0
            Button19.Text = "V0"
            TextBox1.Text = "Züge 1 und 2 fahren über die gewählten Routen (Standard)"
            ButtonsVisible(999)
        End If
        _daten.write_to_table(AutomatikParameterTableName, 65, _Betriebsart3_0Var)
        _Weichen_in_Startposition = False
        _Signale_in_Startposition = False
    End Sub
    Private Sub Button30_Click(sender As System.Object, e As System.EventArgs) Handles Button30.Click
        '*** Betriebsartvarianten für Gleise 3
        If _Betriebsart0_3Var = 0 Then
            _Betriebsart0_3Var = 1
            Button30.Text = "V1"
            TextBox1.Text = "Züge fahren über den inneren Kreis (wie die Züge von Gleis 1 und 2)"
            _Route_Gleis3 = 2
            _daten.write_to_table(AutomatikParameterTableName, 5, _Route_Gleis3)
            ARoute_Lok3 = _Route_Gleis3
            ButtonsVisible(999)
        Else
            _Betriebsart0_3Var = 0
            Button30.Text = "V0"
            TextBox1.Text = "Züge fahren über den äußeren Kreis"
        End If
        _daten.write_to_table(AutomatikParameterTableName, 54, _Betriebsart0_3Var)
        _Weichen_in_Startposition = False
        _Signale_in_Startposition = False
    End Sub
    Private Sub Button35_Click(sender As System.Object, e As System.EventArgs) Handles Button35.Click
        '*** Betriebsartvarianten für Gleis 4
        If _Betriebsart0_4Var = 0 Then
            _Betriebsart0_4Var = 1
            Button35.Text = "V1"
            TextBox1.Text = "Züge fahren über den inneren Kreis (wie die Züge von Gleis 1 und 2)"
            _Route_Gleis4 = 2
            _daten.write_to_table(AutomatikParameterTableName, 6, _Route_Gleis4)
            ARoute_Lok4 = _Route_Gleis4
            _Loknummer_4A = NumericUpDown11.Value
            _daten.write_to_table(AutomatikParameterTableName, 69, _Loknummer_4A)
            NumericUpDown11.Value = _Loknummer_4B
            ButtonsVisible(999)
        ElseIf _Betriebsart0_4Var = 1 Then
            _Betriebsart0_4Var = 2
            Button35.Text = "V2"
            TextBox1.Text = "Zug4 fährt über Gleis 3 und den inneren Kreis (wie die Züge von Gleis 1 und 2)"
            _Route_Gleis4 = 2
            _daten.write_to_table(AutomatikParameterTableName, 6, _Route_Gleis4)
            ARoute_Lok4 = _Route_Gleis4
            ButtonsVisible(999)
        Else
            _Betriebsart0_4Var = 0
            Button35.Text = "V0"
            TextBox1.Text = "Züge fahren über den äußeren Kreis - bei Umschaltung ser Variante wird 'oben kurz' vorbesetzt"
            _Route_Gleis4 = 1
            _daten.write_to_table(AutomatikParameterTableName, 6, _Route_Gleis4)
            ARoute_Lok4 = _Route_Gleis4
            _Loknummer_4B = NumericUpDown11.Value
            _daten.write_to_table(AutomatikParameterTableName, 70, _Loknummer_4B)
            NumericUpDown11.Value = _Loknummer_4A
            ButtonsVisible(999)
        End If
        _daten.write_to_table(AutomatikParameterTableName, 55, _Betriebsart0_4Var)
        _Weichen_in_Startposition = False
        _Signale_in_Startposition = False
    End Sub
    Private Sub Button38_Click(sender As System.Object, e As System.EventArgs) Handles Button38.Click
        '*** Betriebsartvarianten für Gleise 3 und 4
        If _Betriebsart0_5Var = 0 Then
            _Betriebsart0_5Var = 1
            Button38.Text = "V1"
            _Route_Gleis3 = 2
            _daten.write_to_table(AutomatikParameterTableName, 5, _Route_Gleis3)
            ARoute_Lok3 = _Route_Gleis3
            _Route_Gleis4 = 2
            _daten.write_to_table(AutomatikParameterTableName, 6, _Route_Gleis4)
            ARoute_Lok4 = _Route_Gleis4
            _SBhf_Gleis3 = 0
            _SBhf_Gleis4 = 3
            Diagonale_Gleis3 = 4
            Diagonale_Gleis4 = 3
            Talstrecke_Gleis3 = 0
            Talstrecke_Gleis4 = 3
            Button53.Text = "kein Halt"
            Button53.BackColor = Drawing.Color.LightGreen
            Button54.Text = "Wechsel > 3"
            Button54.BackColor = Drawing.Color.LightYellow
            Button83.Text = "Wechsel > 4"
            Button83.BackColor = Drawing.Color.LightYellow
            Button84.Text = "Wechsel > 3"
            Button84.BackColor = Drawing.Color.LightYellow
            Button93.Text = "kein Halt"
            Button93.BackColor = Drawing.Color.LightGreen
            Button94.Text = "Wechsel > 3"
            Button94.BackColor = Drawing.Color.LightYellow

            ButtonsVisible(999)
        Else
            _SBhf_Gleis1 = _daten.read_from_table(AutomatikParameterTableName, 22)
            _SBhf_Gleis2 = _daten.read_from_table(AutomatikParameterTableName, 23)
            _SBhf_Gleis3 = _daten.read_from_table(AutomatikParameterTableName, 24)
            _SBhf_Gleis4 = _daten.read_from_table(AutomatikParameterTableName, 25)

            Diagonale_Gleis1 = _daten.read_from_table(AutomatikParameterTableName, 35)
            Diagonale_Gleis2 = _daten.read_from_table(AutomatikParameterTableName, 36)
            Diagonale_Gleis3 = _daten.read_from_table(AutomatikParameterTableName, 37)
            Diagonale_Gleis4 = _daten.read_from_table(AutomatikParameterTableName, 38)

            Talstrecke_Gleis1 = _daten.read_from_table(AutomatikParameterTableName, 39)
            Talstrecke_Gleis2 = _daten.read_from_table(AutomatikParameterTableName, 40)
            Talstrecke_Gleis3 = _daten.read_from_table(AutomatikParameterTableName, 41)
            Talstrecke_Gleis4 = _daten.read_from_table(AutomatikParameterTableName, 42)
            _Betriebsart0_5Var = 0
            Button38.Text = "V0"

            ButtonsVisible(999)
        End If
        _daten.write_to_table(AutomatikParameterTableName, 56, _Betriebsart0_5Var)
        _Weichen_in_Startposition = False
        _Signale_in_Startposition = False
    End Sub
    Private Sub Button40_Click(sender As Object, e As EventArgs) Handles Button40.Click
        '*** Betriebsartvarianten für Gleis 1
        If _Betriebsart1_0Var = 0 Then
            _Betriebsart1_0Var = 1
            Button40.Text = "V1"
            TextBox1.Text = "Züge fahren rückwärts über den inneren Kreis"
            _Route_Gleis1 = 2
            _daten.write_to_table(AutomatikParameterTableName, 3, _Route_Gleis1)
            ARoute_Lok1 = _Route_Gleis1
            _GleisFrei3 = 1
            Button17.Text = "frei / benutzt"
            Button17.BackColor = Drawing.Color.LightGreen
        Else
            _Betriebsart1_0Var = 0
            Button40.Text = "V0"
            TextBox1.Text = "Züge fahren vorwärts über den inneren Kreis"
            Diagonale_Gleis1 = 0
            Diagonale_Gleis2 = 0
            _GleisFrei3 = 0
            Button17.Text = "belegt / nicht benutzt"
            Button17.BackColor = Drawing.Color.LightYellow
        End If
        _daten.write_to_table(AutomatikParameterTableName, 57, _Betriebsart1_0Var)
        _Weichen_in_Startposition = False
        _Signale_in_Startposition = False
        ButtonsVisible(999)
    End Sub
    Private Sub Button44_Click(sender As Object, e As EventArgs) Handles Button44.Click
        '*** Betriebsartvarianten für Gleis 2
        If _Betriebsart2_0Var = 0 Then
            _Betriebsart2_0Var = 1
            Button44.Text = "V1"
            TextBox1.Text = "Züge fahren Route 'oben kurz' und rückwärts über Gleis 2"
            _Route_Gleis2 = 1
            _daten.write_to_table(AutomatikParameterTableName, 4, _Route_Gleis2)
            ARoute_Lok2 = _Route_Gleis2
        Else
            _Betriebsart2_0Var = 0
            Button44.Text = "V0"
            TextBox1.Text = "Züge fahren vorwärts über Gleis 2"
        End If
        _daten.write_to_table(AutomatikParameterTableName, 61, _Betriebsart2_0Var)
        _Weichen_in_Startposition = False
        _Signale_in_Startposition = False
        ButtonsVisible(999)
    End Sub
    ' *** Zugtyp
    Private Sub Button25_Click(sender As System.Object, e As System.EventArgs) Handles Button25.Click

        If _Zugtyp1 = 6 Then
            _Zugtyp1 = 1
            _NachlaufZug1 = False
            _Kurzzug1 = True
            Button25.Text = "PK"
        ElseIf _Zugtyp1 = 1 Then
            _Zugtyp1 = 2
            _NachlaufZug1 = False
            _Kurzzug1 = True
            Button25.Text = "GK"
        ElseIf _Zugtyp1 = 2 Then
            _Zugtyp1 = 3
            _NachlaufZug1 = False
            _Kurzzug1 = False
            Button25.Text = "PL"
        ElseIf _Zugtyp1 = 3 Then
            _Zugtyp1 = 4
            _NachlaufZug1 = False
            _Kurzzug1 = False
            Button25.Text = "GL"
        ElseIf _Zugtyp1 = 4 Then
            _Zugtyp1 = 5
            _NachlaufZug1 = True
            _Kurzzug1 = False
            Button25.Text = "PN"
        ElseIf _Zugtyp1 = 5 Then
            _Zugtyp1 = 6
            _NachlaufZug1 = True
            _Kurzzug1 = False
            Button25.Text = "GN"
        End If
        _daten.write_to_table(AutomatikParameterTableName, 46, _Zugtyp1)
    End Sub
    Private Sub Button26_Click(sender As System.Object, e As System.EventArgs) Handles Button26.Click
        If _Zugtyp2 = 6 Then
            _Zugtyp2 = 1
            _NachlaufZug2 = False
            _Kurzzug2 = True
            Button26.Text = "PK"
        ElseIf _Zugtyp2 = 1 Then
            _Zugtyp2 = 2
            _NachlaufZug2 = False
            _Kurzzug2 = True
            Button26.Text = "GK"
        ElseIf _Zugtyp2 = 2 Then
            _Zugtyp2 = 3
            _NachlaufZug2 = False
            _Kurzzug2 = False
            Button26.Text = "PL"
        ElseIf _Zugtyp2 = 3 Then
            _Zugtyp2 = 4
            _NachlaufZug2 = False
            _Kurzzug2 = False
            Button26.Text = "GL"
        ElseIf _Zugtyp2 = 4 Then
            _Zugtyp2 = 5
            _NachlaufZug2 = True
            _Kurzzug2 = False
            Button26.Text = "PN"
        ElseIf _Zugtyp2 = 5 Then
            _Zugtyp2 = 6
            _NachlaufZug2 = True
            _Kurzzug2 = False
            Button26.Text = "GN"
        End If
        _daten.write_to_table(AutomatikParameterTableName, 47, _Zugtyp2)
    End Sub
    Private Sub Button27_Click(sender As System.Object, e As System.EventArgs) Handles Button27.Click
        If _Zugtyp3 = 6 Then
            _Zugtyp3 = 1
            _NachlaufZug3 = False
            _Kurzzug3 = True
            Button27.Text = "PK"
        ElseIf _Zugtyp3 = 1 Then
            _Zugtyp3 = 2
            _NachlaufZug3 = False
            _Kurzzug3 = True
            Button27.Text = "GK"
        ElseIf _Zugtyp3 = 2 Then
            _Zugtyp3 = 3
            _NachlaufZug3 = False
            _Kurzzug3 = False
            Button27.Text = "PL"
        ElseIf _Zugtyp3 = 3 Then
            _Zugtyp3 = 4
            _NachlaufZug3 = False
            _Kurzzug3 = False
            Button27.Text = "GL"
        ElseIf _Zugtyp3 = 4 Then
            _Zugtyp3 = 5
            _NachlaufZug3 = True
            _Kurzzug3 = False
            Button27.Text = "PN"
        ElseIf _Zugtyp3 = 5 Then
            _Zugtyp3 = 6
            _NachlaufZug3 = True
            _Kurzzug3 = False
            Button27.Text = "GN"
        End If
        _daten.write_to_table(AutomatikParameterTableName, 48, _Zugtyp3)
    End Sub
    Private Sub Button28_Click(sender As System.Object, e As System.EventArgs) Handles Button28.Click
        If _Zugtyp4 = 6 Then
            _Zugtyp4 = 1
            _NachlaufZug4 = False
            _Kurzzug4 = True
            Button28.Text = "PK"
        ElseIf _Zugtyp4 = 1 Then
            _Zugtyp4 = 2
            _NachlaufZug4 = False
            _Kurzzug4 = True
            Button28.Text = "GK"
        ElseIf _Zugtyp4 = 2 Then
            _Zugtyp4 = 3
            _NachlaufZug4 = False
            _Kurzzug4 = False
            Button28.Text = "PL"
        ElseIf _Zugtyp4 = 3 Then
            _Zugtyp4 = 4
            _NachlaufZug4 = False
            _Kurzzug4 = False
            Button28.Text = "GL"
        ElseIf _Zugtyp4 = 4 Then
            _Zugtyp4 = 5
            _NachlaufZug4 = True
            _Kurzzug4 = False
            Button28.Text = "PN"
        ElseIf _Zugtyp4 = 5 Then
            _Zugtyp4 = 6
            _NachlaufZug4 = True
            _Kurzzug4 = False
            Button28.Text = "GN"
        End If
        _daten.write_to_table(AutomatikParameterTableName, 49, _Zugtyp4)
    End Sub
    ' *** Routen
    Private Sub Button21_Click(sender As System.Object, e As System.EventArgs) Handles Button21.Click
        _Route_Gleis1 = _Route_Gleis1 + 1
        If _Route_Gleis1 = 3 Then
            _Route_Gleis1 = 0
        End If
        Routen(Button21, _Route_Gleis1)
        _daten.write_to_table(AutomatikParameterTableName, 3, _Route_Gleis1)
        ARoute_Lok1 = _Route_Gleis1
        _Betriebsart3_0Var = 0
        Button19.Text = "V0"
        TextBox1.Text = "Hier wird die Route für den Zug auf Gleis 1 festgelegt. "
        _Weichen_in_Startposition = False
        _Signale_in_Startposition = False
        ButtonsVisible(999)
    End Sub
    Private Sub Button22_Click(sender As System.Object, e As System.EventArgs) Handles Button22.Click
        If _Betriebsart2_0Var = 0 Then
            _Route_Gleis2 = _Route_Gleis2 + 1
            If _Route_Gleis2 = 3 Then
                _Route_Gleis2 = 0
            End If
        Else
            _Route_Gleis2 = 1
        End If

        Routen(Button22, _Route_Gleis2)
        _daten.write_to_table(AutomatikParameterTableName, 4, _Route_Gleis2)
        ARoute_Lok2 = _Route_Gleis2
        _Betriebsart3_0Var = 0
        Button19.Text = "V0"
        TextBox1.Text = "Hier wird die Route für den Zug auf Gleis 2 festgelegt. "
        _Weichen_in_Startposition = False
        _Signale_in_Startposition = False
        ButtonsVisible(999)
    End Sub
    Private Sub Button23_Click(sender As System.Object, e As System.EventArgs) Handles Button23.Click
        _Route_Gleis3 = _Route_Gleis3 + 1
        If _Route_Gleis3 = 3 Then
            _Route_Gleis3 = 0
        End If
        _Betriebsart0_3Var = 0
        Button30.Text = "V0"
        Routen(Button23, _Route_Gleis3)
        _daten.write_to_table(AutomatikParameterTableName, 5, _Route_Gleis3)
        ARoute_Lok3 = _Route_Gleis3
        TextBox1.Text = "Hier wird die Route für den Zug auf Gleis 3 festgelegt. "
        _Weichen_in_Startposition = False
        _Signale_in_Startposition = False
        ButtonsVisible(999)
    End Sub
    Private Sub Button24_Click(sender As System.Object, e As System.EventArgs) Handles Button24.Click
        _Route_Gleis4 = _Route_Gleis4 + 1
        If _Route_Gleis4 = 3 Then
            _Route_Gleis4 = 0
        End If
        _Betriebsart0_4Var = 0
        Button35.Text = "V0"
        Routen(Button24, _Route_Gleis4)
        _daten.write_to_table(AutomatikParameterTableName, 6, _Route_Gleis4)
        ARoute_Lok4 = _Route_Gleis4
        TextBox1.Text = "Hier wird die Route für den Zug auf Gleis 4 festgelegt. "
        _Weichen_in_Startposition = False
        _Signale_in_Startposition = False
        ButtonsVisible(999)
    End Sub
    ' *** Bahnhof
    Private Sub Button31_Click(sender As System.Object, e As System.EventArgs) Handles Button31.Click
        'ElseIf Betriebsart12 = 0 And Betriebsart34 = 3 Then
        'ElseIf Betriebsart12 = 0 And Betriebsart34 = 4 Then
        'ElseIf Betriebsart12 = 0 And Betriebsart34 = 5 Then
        If Betriebsart12 = 1 And Betriebsart34 = 0 Then
            If _Bhf_Gleis1 = 0 Or _Bhf_Gleis1 = 2 Or _Bhf_Gleis1 = 3 Or _Bhf_Gleis1 = 4 Then
                _Bhf_Gleis1 = 1
                Button31.Text = "Halt"
                Button31.BackColor = Drawing.Color.LightYellow
            ElseIf _Bhf_Gleis1 = 1 Then
                _Bhf_Gleis1 = 0
                Button31.Text = "kein Halt"
                Button31.BackColor = Drawing.Color.LightGreen
            Else
                _Bhf_Gleis1 = 0
            End If
        ElseIf Betriebsart12 = 1 And Betriebsart34 = 3 Then
            If _Bhf_Gleis1 = 0 Or _Bhf_Gleis1 = 2 Or _Bhf_Gleis1 = 4 Then
                _Bhf_Gleis1 = 1
                Button31.Text = "Halt"
                Button31.BackColor = Drawing.Color.LightYellow
            ElseIf _Bhf_Gleis1 = 1 Then
                _Bhf_Gleis1 = 3
                Button31.Text = "Wechsel > 3"
                Button31.BackColor = Drawing.Color.LightYellow
            ElseIf _Bhf_Gleis1 = 3 Then
                _Bhf_Gleis1 = 0
                Button31.Text = "kein Halt"
                Button31.BackColor = Drawing.Color.LightGreen
            Else
                _Bhf_Gleis1 = 0
            End If
        ElseIf Betriebsart12 = 1 And Betriebsart34 = 4 Then
            If _Bhf_Gleis1 = 0 Or _Bhf_Gleis1 = 2 Or _Bhf_Gleis1 = 3 Then
                _Bhf_Gleis1 = 1
                Button31.Text = "Halt"
                Button31.BackColor = Drawing.Color.LightYellow
            ElseIf _Bhf_Gleis1 = 1 Then
                _Bhf_Gleis1 = 4
                Button31.Text = "Wechsel > 4"
                Button31.BackColor = Drawing.Color.LightYellow
            ElseIf _Bhf_Gleis1 = 4 Then
                _Bhf_Gleis1 = 0
                Button31.Text = "kein Halt"
                Button31.BackColor = Drawing.Color.LightGreen
            Else
                _Bhf_Gleis1 = 0
            End If
        ElseIf Betriebsart12 = 1 And Betriebsart34 = 5 Then
            If _Bhf_Gleis1 = 0 Or _Bhf_Gleis1 = 2 Then
                _Bhf_Gleis1 = 1
                Button31.Text = "Halt"
                Button31.BackColor = Drawing.Color.LightYellow
            ElseIf _Bhf_Gleis1 = 1 Then
                _Bhf_Gleis1 = 3
                Button31.Text = "Wechsel > 3"
                Button31.BackColor = Drawing.Color.LightYellow
            ElseIf _Bhf_Gleis1 = 3 Then
                _Bhf_Gleis1 = 4
                Button31.Text = "Wechsel > 4"
                Button31.BackColor = Drawing.Color.LightYellow
            ElseIf _Bhf_Gleis1 = 4 Then
                _Bhf_Gleis1 = 0
                Button31.Text = "kein Halt"
                Button31.BackColor = Drawing.Color.LightGreen
            Else
                _Bhf_Gleis1 = 0
            End If
            'ElseIf Betriebsart12 = 2 And Betriebsart34 = 0 Then
            'ElseIf Betriebsart12 = 2 And Betriebsart34 = 3 Then
            'ElseIf Betriebsart12 = 2 And Betriebsart34 = 4 Then
            'ElseIf Betriebsart12 = 2 And Betriebsart34 = 5 Then
        ElseIf Betriebsart12 = 3 And Betriebsart34 = 0 Then
            If _Betriebsart3_0Var = 0 Or _Betriebsart3_0Var = 2 Then
                If _Bhf_Gleis1 = 0 Or _Bhf_Gleis1 = 3 Or _Bhf_Gleis1 = 4 Then
                    _Bhf_Gleis1 = 1
                    Button31.Text = "Halt"
                    Button31.BackColor = Drawing.Color.LightYellow
                ElseIf _Bhf_Gleis1 = 1 Then
                    _Bhf_Gleis1 = 2
                    Button31.Text = "Wechsel > 2"
                    Button31.BackColor = Drawing.Color.LightYellow
                ElseIf _Bhf_Gleis1 = 2 Then
                    _Bhf_Gleis1 = 0
                    Button31.Text = "kein Halt"
                    Button31.BackColor = Drawing.Color.LightGreen
                Else
                    _Bhf_Gleis1 = 0
                End If
            Else
                If _Bhf_Gleis1 = 0 Or _Bhf_Gleis1 = 3 Or _Bhf_Gleis1 = 4 Then
                    _Bhf_Gleis1 = 1
                    Button31.Text = "Halt"
                    Button31.BackColor = Drawing.Color.LightYellow
                ElseIf _Bhf_Gleis1 = 1 Then
                    _Bhf_Gleis1 = 0
                    Button31.Text = "kein Halt"
                    Button31.BackColor = Drawing.Color.LightGreen
                Else
                    _Bhf_Gleis1 = 0
                End If
            End If

        ElseIf Betriebsart12 = 3 And Betriebsart34 = 3 Then
            If _Bhf_Gleis1 = 0 Then
                _Bhf_Gleis1 = 1
                Button31.Text = "Halt"
                Button31.BackColor = Drawing.Color.LightYellow
            ElseIf _Bhf_Gleis1 = 1 Then
                _Bhf_Gleis1 = 2
                Button31.Text = "Wechsel > 2"
                Button31.BackColor = Drawing.Color.LightYellow
            ElseIf _Bhf_Gleis1 = 2 Then
                _Bhf_Gleis1 = 3
                Button31.Text = "Wechsel > 3"
                Button31.BackColor = Drawing.Color.LightYellow
            ElseIf _Bhf_Gleis1 = 3 Then
                _Bhf_Gleis1 = 0
                Button31.Text = "kein Halt"
                Button31.BackColor = Drawing.Color.LightGreen
            Else
                _Bhf_Gleis1 = 0
            End If
        ElseIf Betriebsart12 = 3 And Betriebsart34 = 4 Then
            If _Bhf_Gleis1 = 0 Then
                _Bhf_Gleis1 = 1
                Button31.Text = "Halt"
                Button31.BackColor = Drawing.Color.LightYellow
            ElseIf _Bhf_Gleis1 = 1 Then
                _Bhf_Gleis1 = 2
                Button31.Text = "Wechsel > 2"
                Button31.BackColor = Drawing.Color.LightYellow
            ElseIf _Bhf_Gleis1 = 2 Then
                _Bhf_Gleis1 = 4
                Button31.Text = "Wechsel > 4"
                Button31.BackColor = Drawing.Color.LightYellow
            ElseIf _Bhf_Gleis1 = 4 Then
                _Bhf_Gleis1 = 0
                Button31.Text = "kein Halt"
                Button31.BackColor = Drawing.Color.LightGreen
            Else
                _Bhf_Gleis1 = 0
            End If
        ElseIf Betriebsart12 = 3 And Betriebsart34 = 5 Then
            If _Bhf_Gleis1 = 0 Then
                _Bhf_Gleis1 = 1
                Button31.Text = "Halt"
                Button31.BackColor = Drawing.Color.LightYellow
            ElseIf _Bhf_Gleis1 = 1 Then
                _Bhf_Gleis1 = 2
                Button31.Text = "Wechsel > 2"
                Button31.BackColor = Drawing.Color.LightYellow
            ElseIf _Bhf_Gleis1 = 2 Then
                _Bhf_Gleis1 = 3
                Button31.Text = "Wechsel > 3"
                Button31.BackColor = Drawing.Color.LightYellow
            ElseIf _Bhf_Gleis1 = 3 Then
                _Bhf_Gleis1 = 4
                Button31.Text = "Wechsel > 4"
                Button31.BackColor = Drawing.Color.LightYellow
            ElseIf _Bhf_Gleis1 = 4 Then
                _Bhf_Gleis1 = 0
                Button31.Text = "kein Halt"
                Button31.BackColor = Drawing.Color.LightGreen
            Else
                _Bhf_Gleis1 = 0
            End If
        Else
            _Bhf_Gleis1 = 0
        End If
        _daten.write_to_table(AutomatikParameterTableName, 7, _Bhf_Gleis1)
        ButtonsVisible(999)
    End Sub
    Private Sub Button32_Click(sender As System.Object, e As System.EventArgs) Handles Button32.Click
        'ElseIf Betriebsart12 = 0 And Betriebsart34 = 3 Then
        'ElseIf Betriebsart12 = 0 And Betriebsart34 = 4 Then
        'ElseIf Betriebsart12 = 0 And Betriebsart34 = 5 Then
        'ElseIf Betriebsart12 = 1 And Betriebsart34 = 0 Then
        'ElseIf Betriebsart12 = 1 And Betriebsart34 = 3 Then
        'ElseIf Betriebsart12 = 1 And Betriebsart34 = 4 Then
        'ElseIf Betriebsart12 = 1 And Betriebsart34 = 5 Then
        If Betriebsart12 = 2 And Betriebsart34 = 0 Then
            If _Bhf_Gleis2 = 0 Or _Bhf_Gleis2 = 1 Or _Bhf_Gleis2 = 3 Or _Bhf_Gleis2 = 4 Then
                _Bhf_Gleis2 = 2
                Button32.Text = "Halt"
                Button32.BackColor = Drawing.Color.LightYellow
            ElseIf _Bhf_Gleis2 = 2 Then
                _Bhf_Gleis2 = 0
                Button32.Text = "kein Halt"
                Button32.BackColor = Drawing.Color.LightGreen
            Else
                _Bhf_Gleis2 = 0
            End If
        ElseIf Betriebsart12 = 2 And Betriebsart34 = 3 Then
            If _Bhf_Gleis2 = 0 Or _Bhf_Gleis2 = 1 Or _Bhf_Gleis2 = 4 Then
                _Bhf_Gleis2 = 2
                Button32.Text = "Halt"
                Button32.BackColor = Drawing.Color.LightYellow
            ElseIf _Bhf_Gleis2 = 2 Then
                _Bhf_Gleis2 = 3
                Button32.Text = "Wechsel > 3"
                Button32.BackColor = Drawing.Color.LightYellow
            ElseIf _Bhf_Gleis2 = 3 Then
                _Bhf_Gleis2 = 0
                Button32.Text = "kein Halt"
                Button32.BackColor = Drawing.Color.LightGreen
            Else
                _Bhf_Gleis2 = 0
            End If
        ElseIf Betriebsart12 = 2 And Betriebsart34 = 4 Then
            If _Bhf_Gleis2 = 0 Or _Bhf_Gleis2 = 1 Or _Bhf_Gleis2 = 3 Then
                _Bhf_Gleis2 = 2
                Button32.Text = "Halt"
                Button32.BackColor = Drawing.Color.LightYellow
            ElseIf _Bhf_Gleis2 = 2 Then
                _Bhf_Gleis2 = 4
                Button32.Text = "Wechsel > 4"
                Button32.BackColor = Drawing.Color.LightYellow
            ElseIf _Bhf_Gleis2 = 4 Then
                _Bhf_Gleis2 = 0
                Button32.Text = "kein Halt"
                Button32.BackColor = Drawing.Color.LightGreen
            Else
                _Bhf_Gleis2 = 0
            End If
        ElseIf Betriebsart12 = 2 And Betriebsart34 = 5 Then
            If _Bhf_Gleis2 = 0 Or _Bhf_Gleis2 = 1 Then
                _Bhf_Gleis2 = 2
                Button32.Text = "Halt"
                Button32.BackColor = Drawing.Color.LightYellow
            ElseIf _Bhf_Gleis2 = 2 Then
                _Bhf_Gleis2 = 3
                Button32.Text = "Wechsel > 3"
            ElseIf _Bhf_Gleis2 = 3 Then
                _Bhf_Gleis2 = 4
                Button32.Text = "Wechsel > 4"
                Button32.BackColor = Drawing.Color.LightYellow
            ElseIf _Bhf_Gleis2 = 4 Then
                _Bhf_Gleis2 = 0
                Button32.Text = "kein Halt"
                Button32.BackColor = Drawing.Color.LightGreen
            Else
                _Bhf_Gleis2 = 0
            End If
        ElseIf Betriebsart12 = 3 And Betriebsart34 = 0 Then
            If _Betriebsart3_0Var = 0 Then
                If _Bhf_Gleis2 = 0 Or _Bhf_Gleis2 = 3 Or _Bhf_Gleis2 = 4 Then
                    _Bhf_Gleis2 = 2
                    Button32.Text = "Halt"
                    Button32.BackColor = Drawing.Color.LightYellow
                ElseIf _Bhf_Gleis2 = 2 Then
                    _Bhf_Gleis2 = 1
                    Button32.Text = "Wechsel > 1"
                    Button32.BackColor = Drawing.Color.LightYellow
                ElseIf _Bhf_Gleis2 = 1 Then
                    _Bhf_Gleis2 = 0
                    Button32.Text = "kein Halt"
                    Button32.BackColor = Drawing.Color.LightGreen
                Else
                    _Bhf_Gleis2 = 0
                End If
            Else
                If _Bhf_Gleis2 = 0 Or _Bhf_Gleis2 = 3 Or _Bhf_Gleis2 = 4 Then
                    _Bhf_Gleis2 = 2
                    Button32.Text = "Halt"
                    Button32.BackColor = Drawing.Color.LightYellow
                ElseIf _Bhf_Gleis2 = 2 Then
                    _Bhf_Gleis2 = 0
                    Button32.Text = "kein Halt"
                    Button32.BackColor = Drawing.Color.LightGreen
                Else
                    _Bhf_Gleis2 = 0
                End If
            End If

        ElseIf Betriebsart12 = 3 And Betriebsart34 = 3 Then
            If _Bhf_Gleis2 = 0 Or _Bhf_Gleis2 = 4 Then
                _Bhf_Gleis2 = 2
                Button32.Text = "Halt"
                Button32.BackColor = Drawing.Color.LightYellow
            ElseIf _Bhf_Gleis2 = 2 Then
                _Bhf_Gleis2 = 1
                Button32.Text = "Wechsel > 1"
                Button32.BackColor = Drawing.Color.LightYellow
            ElseIf _Bhf_Gleis2 = 1 Then
                _Bhf_Gleis2 = 3
                Button32.Text = "Wechsel > 3"
                Button32.BackColor = Drawing.Color.LightYellow
            ElseIf _Bhf_Gleis2 = 3 Then
                _Bhf_Gleis2 = 0
                Button32.Text = "kein Halt"
                Button32.BackColor = Drawing.Color.LightGreen
            Else
                _Bhf_Gleis2 = 0
            End If
        ElseIf Betriebsart12 = 3 And Betriebsart34 = 4 Then
            If _Bhf_Gleis2 = 0 Or _Bhf_Gleis2 = 3 Then
                _Bhf_Gleis2 = 2
                Button32.Text = "Halt"
                Button32.BackColor = Drawing.Color.LightYellow
            ElseIf _Bhf_Gleis2 = 2 Then
                _Bhf_Gleis2 = 1
                Button32.Text = "Wechsel > 1"
                Button32.BackColor = Drawing.Color.LightYellow
            ElseIf _Bhf_Gleis2 = 1 Then
                _Bhf_Gleis2 = 4
                Button32.Text = "Wechsel > 4"
                Button32.BackColor = Drawing.Color.LightYellow
            ElseIf _Bhf_Gleis2 = 4 Then
                _Bhf_Gleis2 = 0
                Button32.Text = "kein Halt"
                Button32.BackColor = Drawing.Color.LightGreen
            Else
                _Bhf_Gleis2 = 0
            End If
        ElseIf Betriebsart12 = 3 And Betriebsart34 = 5 Then
            If _Bhf_Gleis2 = 0 Then
                _Bhf_Gleis2 = 2
                Button32.Text = "Halt"
                Button32.BackColor = Drawing.Color.LightYellow
            ElseIf _Bhf_Gleis2 = 2 Then
                _Bhf_Gleis2 = 1
                Button32.Text = "Wechsel > 1"
                Button32.BackColor = Drawing.Color.LightYellow
            ElseIf _Bhf_Gleis2 = 1 Then
                _Bhf_Gleis2 = 3
                Button32.Text = "Wechsel > 3"
                Button32.BackColor = Drawing.Color.LightYellow
            ElseIf _Bhf_Gleis2 = 3 Then
                _Bhf_Gleis2 = 4
                Button32.Text = "Wechsel > 4"
                Button32.BackColor = Drawing.Color.LightYellow
            ElseIf _Bhf_Gleis2 = 4 Then
                _Bhf_Gleis2 = 0
                Button32.Text = "kein Halt"
                Button32.BackColor = Drawing.Color.LightGreen
            Else
                _Bhf_Gleis2 = 0
            End If
        Else
            _Bhf_Gleis2 = 0
        End If
        _daten.write_to_table(AutomatikParameterTableName, 8, _Bhf_Gleis2)
        'Betriebsparameter.SetValue("Speicher", "D27", _Bhf_Gleis2)
        ButtonsVisible(999)
    End Sub
    Private Sub Button33_Click(sender As System.Object, e As System.EventArgs) Handles Button33.Click
        If Betriebsart12 = 0 And Betriebsart34 = 3 Then
            If _Bhf_Gleis3 = 0 Or _Bhf_Gleis3 = 1 Or _Bhf_Gleis3 = 2 Or _Bhf_Gleis3 = 4 Then
                _Bhf_Gleis3 = 3
                Button33.Text = "Halt"
                Button33.BackColor = Drawing.Color.LightYellow
            ElseIf _Bhf_Gleis3 = 3 Then
                _Bhf_Gleis3 = 0
                Button33.Text = "kein Halt"
                Button33.BackColor = Drawing.Color.LightGreen
            Else
                _Bhf_Gleis3 = 0
            End If
            'ElseIf Betriebsart12 = 0 And Betriebsart34 = 3 Then
            'ElseIf Betriebsart12 = 0 And Betriebsart34 = 4 Then
        ElseIf Betriebsart12 = 0 And Betriebsart34 = 5 Then
            If _Betriebsart0_5Var = 0 Then
                If _Bhf_Gleis3 = 0 Or _Bhf_Gleis3 = 1 Or _Bhf_Gleis3 = 2 Then
                    _Bhf_Gleis3 = 3
                    Button33.Text = "Halt"
                    Button33.BackColor = Drawing.Color.LightYellow
                ElseIf _Bhf_Gleis3 = 3 Then
                    _Bhf_Gleis3 = 4
                    Button33.Text = "Wechsel > 4"
                    Button33.BackColor = Drawing.Color.LightYellow
                ElseIf _Bhf_Gleis3 = 4 Then
                    _Bhf_Gleis3 = 0
                    Button33.Text = "kein Halt"
                    Button33.BackColor = Drawing.Color.LightGreen
                Else
                    _Bhf_Gleis3 = 0
                End If
            Else
                If _Bhf_Gleis3 = 0 Or _Bhf_Gleis3 = 1 Or _Bhf_Gleis3 = 2 Then
                    _Bhf_Gleis3 = 3
                    Button33.Text = "Halt"
                    Button33.BackColor = Drawing.Color.LightYellow
                ElseIf _Bhf_Gleis3 = 3 Then
                    _Bhf_Gleis3 = 0
                    Button33.Text = "kein Halt"
                    Button33.BackColor = Drawing.Color.LightGreen
                Else
                    _Bhf_Gleis3 = 0
                End If
            End If

            'ElseIf Betriebsart12 = 1 And Betriebsart34 = 0 Then
        ElseIf Betriebsart12 = 1 And Betriebsart34 = 3 Then
            If _Bhf_Gleis3 = 0 Then
                _Bhf_Gleis3 = 3
                Button33.Text = "Halt"
                Button33.BackColor = Drawing.Color.LightYellow
            ElseIf _Bhf_Gleis3 = 3 Then
                _Bhf_Gleis3 = 1
                Button33.Text = "Wechsel > 1"
                Button33.BackColor = Drawing.Color.LightYellow
            ElseIf _Bhf_Gleis3 = 1 Then
                _Bhf_Gleis3 = 0
                Button33.Text = "kein Halt"
                Button33.BackColor = Drawing.Color.LightGreen
            Else
                _Bhf_Gleis3 = 0
            End If
            'ElseIf Betriebsart12 = 1 And Betriebsart34 = 4 Then
        ElseIf Betriebsart12 = 1 And Betriebsart34 = 5 Then
            If _Bhf_Gleis3 = 0 Or _Bhf_Gleis3 = 2 Then
                _Bhf_Gleis3 = 3
                Button33.Text = "Halt"
                Button33.BackColor = Drawing.Color.LightYellow
            ElseIf _Bhf_Gleis3 = 3 Then
                _Bhf_Gleis3 = 1
                Button33.Text = "Wechsel > 1"
                Button33.BackColor = Drawing.Color.LightYellow
            ElseIf _Bhf_Gleis3 = 1 Then
                _Bhf_Gleis3 = 4
                Button33.Text = "Wechsel > 4"
                Button33.BackColor = Drawing.Color.LightYellow
            ElseIf _Bhf_Gleis3 = 4 Then
                _Bhf_Gleis3 = 0
                Button33.Text = "kein Halt"
                Button33.BackColor = Drawing.Color.LightGreen
            Else
                _Bhf_Gleis3 = 0
            End If
            'ElseIf Betriebsart12 = 2 And Betriebsart34 = 0 Then
        ElseIf Betriebsart12 = 2 And Betriebsart34 = 3 Then
            If _Bhf_Gleis3 = 0 Or _Bhf_Gleis3 = 1 Or _Bhf_Gleis3 = 4 Then
                _Bhf_Gleis3 = 3
                Button33.Text = "Halt"
                Button33.BackColor = Drawing.Color.LightYellow
            ElseIf _Bhf_Gleis3 = 3 Then
                _Bhf_Gleis3 = 2
                Button33.Text = "Wechsel > 2"
                Button33.BackColor = Drawing.Color.LightYellow
            ElseIf _Bhf_Gleis3 = 2 Then
                _Bhf_Gleis3 = 0
                Button33.Text = "kein Halt"
                Button33.BackColor = Drawing.Color.LightGreen
            Else
                _Bhf_Gleis3 = 0
            End If
            'ElseIf Betriebsart12 = 2 And Betriebsart34 = 4 Then
        ElseIf Betriebsart12 = 2 And Betriebsart34 = 5 Then
            If _Bhf_Gleis3 = 0 Or _Bhf_Gleis3 = 1 Then
                _Bhf_Gleis3 = 3
                Button33.Text = "Halt"
                Button33.BackColor = Drawing.Color.LightYellow
            ElseIf _Bhf_Gleis3 = 3 Then
                _Bhf_Gleis3 = 2
                Button33.Text = "Wechsel > 2"
                Button33.BackColor = Drawing.Color.LightYellow
            ElseIf _Bhf_Gleis3 = 2 Then
                _Bhf_Gleis3 = 4
                Button33.Text = "Wechsel > 4"
                Button33.BackColor = Drawing.Color.LightYellow
            ElseIf _Bhf_Gleis3 = 4 Then
                _Bhf_Gleis3 = 0
                Button33.Text = "kein Halt"
                Button33.BackColor = Drawing.Color.LightGreen
            Else
                _Bhf_Gleis3 = 0
            End If
            'ElseIf Betriebsart12 = 3 And Betriebsart34 = 0 Then
        ElseIf Betriebsart12 = 3 And Betriebsart34 = 3 Then
            If _Bhf_Gleis3 = 0 Then
                _Bhf_Gleis3 = 3
                Button33.Text = "Halt"
                Button33.BackColor = Drawing.Color.LightYellow
            ElseIf _Bhf_Gleis3 = 3 Then
                _Bhf_Gleis3 = 1
                Button33.Text = "Wechsel > 1"
                Button33.BackColor = Drawing.Color.LightYellow
            ElseIf _Bhf_Gleis3 = 1 Then
                _Bhf_Gleis3 = 2
                Button33.Text = "Wechsel > 2"
                Button33.BackColor = Drawing.Color.LightYellow
            ElseIf _Bhf_Gleis3 = 2 Then
                _Bhf_Gleis3 = 0
                Button33.Text = "kein Halt"
                Button33.BackColor = Drawing.Color.LightGreen
            Else
                _Bhf_Gleis3 = 0
            End If
            'ElseIf Betriebsart12 = 3 And Betriebsart34 = 4 Then
        ElseIf Betriebsart12 = 3 And Betriebsart34 = 5 Then
            If _Bhf_Gleis3 = 0 Then
                _Bhf_Gleis3 = 3
                Button33.Text = "Halt"
                Button33.BackColor = Drawing.Color.LightYellow
            ElseIf _Bhf_Gleis3 = 3 Then
                _Bhf_Gleis3 = 1
                Button33.Text = "Wechsel > 1"
                Button33.BackColor = Drawing.Color.LightYellow
            ElseIf _Bhf_Gleis3 = 1 Then
                _Bhf_Gleis3 = 2
                Button33.Text = "Wechsel > 2"
                Button33.BackColor = Drawing.Color.LightYellow
            ElseIf _Bhf_Gleis3 = 2 Then
                _Bhf_Gleis3 = 4
                Button33.Text = "Wechsel > 4"
                Button33.BackColor = Drawing.Color.LightYellow
            ElseIf _Bhf_Gleis3 = 4 Then
                _Bhf_Gleis3 = 0
                Button33.Text = "kein Halt"
                Button33.BackColor = Drawing.Color.LightGreen
            Else
                _Bhf_Gleis3 = 0
            End If
        Else
            _Bhf_Gleis3 = 0
        End If
        _daten.write_to_table(AutomatikParameterTableName, 9, _Bhf_Gleis3)
        'Betriebsparameter.SetValue("Speicher", "F27", _Bhf_Gleis3)
        ButtonsVisible(999)
    End Sub
    Private Sub Button34_Click(sender As System.Object, e As System.EventArgs) Handles Button34.Click
        'ElseIf Betriebsart12 = 0 And Betriebsart34 = 3 Then
        If Betriebsart12 = 0 And Betriebsart34 = 4 Then
            If _Bhf_Gleis4 = 0 Or _Bhf_Gleis4 = 1 Or _Bhf_Gleis4 = 2 Or _Bhf_Gleis4 = 3 Then
                _Bhf_Gleis4 = 4
                Button34.Text = "Halt"
                Button34.BackColor = Drawing.Color.LightYellow
            ElseIf _Bhf_Gleis4 = 4 Then
                _Bhf_Gleis4 = 0
                Button34.Text = "kein Halt"
                Button34.BackColor = Drawing.Color.LightGreen
            Else
                _Bhf_Gleis4 = 0
            End If
        ElseIf Betriebsart12 = 0 And Betriebsart34 = 5 Then
            If _Betriebsart0_5Var = 0 Then
                If _Bhf_Gleis4 = 0 Or _Bhf_Gleis4 = 1 Or _Bhf_Gleis4 = 2 Then
                    _Bhf_Gleis4 = 4
                    Button34.Text = "Halt"
                    Button34.BackColor = Drawing.Color.LightYellow
                ElseIf _Bhf_Gleis4 = 4 Then
                    _Bhf_Gleis4 = 3
                    Button34.Text = "Wechsel > 3"
                    Button34.BackColor = Drawing.Color.LightYellow
                ElseIf _Bhf_Gleis4 = 3 Then
                    _Bhf_Gleis4 = 0
                    Button34.Text = "kein Halt"
                    Button34.BackColor = Drawing.Color.LightGreen
                Else
                    _Bhf_Gleis4 = 0
                End If
            Else
                If _Bhf_Gleis4 = 0 Or _Bhf_Gleis4 = 1 Or _Bhf_Gleis4 = 2 Then
                    _Bhf_Gleis4 = 4
                    Button34.Text = "Halt"
                    Button34.BackColor = Drawing.Color.LightYellow
                ElseIf _Bhf_Gleis4 = 4 Then
                    _Bhf_Gleis4 = 0
                    Button34.Text = "kein Halt"
                    Button34.BackColor = Drawing.Color.LightGreen
                Else
                    _Bhf_Gleis4 = 0
                End If
            End If
            'ElseIf Betriebsart12 = 1 And Betriebsart34 = 0 Then
            'ElseIf Betriebsart12 = 1 And Betriebsart34 = 3 Then
        ElseIf Betriebsart12 = 1 And Betriebsart34 = 4 Then
            If _Bhf_Gleis4 = 0 Or _Bhf_Gleis4 = 2 Or _Bhf_Gleis4 = 3 Then
                _Bhf_Gleis4 = 4
                Button34.Text = "Halt"
                Button34.BackColor = Drawing.Color.LightYellow
            ElseIf _Bhf_Gleis4 = 4 Then
                _Bhf_Gleis4 = 1
                Button34.Text = "Wechsel > 1"
                Button34.BackColor = Drawing.Color.LightYellow
            ElseIf _Bhf_Gleis4 = 1 Then
                _Bhf_Gleis4 = 0
                Button34.Text = "kein Halt"
                Button34.BackColor = Drawing.Color.LightGreen
            Else
                _Bhf_Gleis4 = 0
            End If
        ElseIf Betriebsart12 = 1 And Betriebsart34 = 5 Then
            If _Bhf_Gleis4 = 0 Or _Bhf_Gleis4 = 2 Then
                _Bhf_Gleis4 = 4
                Button34.Text = "Halt"
                Button34.BackColor = Drawing.Color.LightYellow
            ElseIf _Bhf_Gleis4 = 4 Then
                _Bhf_Gleis4 = 1
                Button34.Text = "Wechsel > 1"
                Button34.BackColor = Drawing.Color.LightYellow
            ElseIf _Bhf_Gleis4 = 1 Then
                _Bhf_Gleis4 = 3
                Button34.Text = "Wechsel > 3"
                Button34.BackColor = Drawing.Color.LightYellow
            ElseIf _Bhf_Gleis4 = 3 Then
                _Bhf_Gleis4 = 0
                Button34.Text = "kein Halt"
                Button34.BackColor = Drawing.Color.LightGreen
            Else
                _Bhf_Gleis4 = 0
            End If
            'ElseIf Betriebsart12 = 2 And Betriebsart34 = 0 Then
            'ElseIf Betriebsart12 = 2 And Betriebsart34 = 3 Then
        ElseIf Betriebsart12 = 2 And Betriebsart34 = 4 Then
            If _Bhf_Gleis4 = 0 Or _Bhf_Gleis4 = 1 Or _Bhf_Gleis4 = 3 Then
                _Bhf_Gleis4 = 4
                Button34.Text = "Halt"
                Button34.BackColor = Drawing.Color.LightYellow
            ElseIf _Bhf_Gleis4 = 4 Then
                _Bhf_Gleis4 = 2
                Button34.Text = "Wechsel > 2"
                Button34.BackColor = Drawing.Color.LightYellow
            ElseIf _Bhf_Gleis4 = 2 Then
                _Bhf_Gleis4 = 0
                Button34.Text = "kein Halt"
                Button34.BackColor = Drawing.Color.LightGreen
            Else
                _Bhf_Gleis4 = 0
            End If
        ElseIf Betriebsart12 = 2 And Betriebsart34 = 5 Then
            If _Bhf_Gleis4 = 0 Or _Bhf_Gleis4 = 1 Then
                _Bhf_Gleis4 = 4
                Button34.Text = "Halt"
                Button34.BackColor = Drawing.Color.LightYellow
            ElseIf _Bhf_Gleis4 = 4 Then
                _Bhf_Gleis4 = 2
                Button34.Text = "Wechsel > 2"
                Button34.BackColor = Drawing.Color.LightYellow
            ElseIf _Bhf_Gleis4 = 2 Then
                _Bhf_Gleis4 = 3
                Button34.Text = "Wechsel > 3"
                Button34.BackColor = Drawing.Color.LightYellow
            ElseIf _Bhf_Gleis4 = 3 Then
                _Bhf_Gleis4 = 0
                Button34.Text = "kein Halt"
                Button34.BackColor = Drawing.Color.LightGreen
            Else
                _Bhf_Gleis4 = 0
            End If
            'ElseIf Betriebsart12 = 3 And Betriebsart34 = 0 Then
            'ElseIf Betriebsart12 = 3 And Betriebsart34 = 3 Then
        ElseIf Betriebsart12 = 3 And Betriebsart34 = 4 Then
            If _Bhf_Gleis4 = 0 Or _Bhf_Gleis4 = 3 Then
                _Bhf_Gleis4 = 4
                Button34.Text = "Halt"
                Button34.BackColor = Drawing.Color.LightYellow
            ElseIf _Bhf_Gleis4 = 4 Then
                _Bhf_Gleis4 = 1
                Button34.Text = "Wechsel > 1"
                Button34.BackColor = Drawing.Color.LightYellow
            ElseIf _Bhf_Gleis4 = 1 Then
                _Bhf_Gleis4 = 2
                Button34.Text = "Wechsel > 2"
                Button34.BackColor = Drawing.Color.LightYellow
            ElseIf _Bhf_Gleis4 = 2 Then
                _Bhf_Gleis4 = 0
                Button34.Text = "kein Halt"
                Button34.BackColor = Drawing.Color.LightGreen
            Else
                _Bhf_Gleis4 = 0
            End If
        ElseIf Betriebsart12 = 3 And Betriebsart34 = 5 Then
            If _Bhf_Gleis4 = 0 Then
                _Bhf_Gleis4 = 4
                Button34.Text = "Halt"
                Button34.BackColor = Drawing.Color.LightYellow
            ElseIf _Bhf_Gleis4 = 4 Then
                _Bhf_Gleis4 = 1
                Button34.Text = "Wechsel > 1"
                Button34.BackColor = Drawing.Color.LightYellow
            ElseIf _Bhf_Gleis4 = 1 Then
                _Bhf_Gleis4 = 2
                Button34.Text = "Wechsel > 2"
                Button34.BackColor = Drawing.Color.LightYellow
            ElseIf _Bhf_Gleis4 = 2 Then
                _Bhf_Gleis4 = 3
                Button34.Text = "Wechsel > 3"
                Button34.BackColor = Drawing.Color.LightYellow
            ElseIf _Bhf_Gleis4 = 3 Then
                _Bhf_Gleis4 = 0
                Button34.Text = "kein Halt"
                Button34.BackColor = Drawing.Color.LightGreen
            Else
                _Bhf_Gleis4 = 0
            End If
        Else
            _Bhf_Gleis4 = 0
        End If
        _daten.write_to_table(AutomatikParameterTableName, 10, _Bhf_Gleis4)
        'Betriebsparameter.SetValue("Speicher", "H27", _Bhf_Gleis4)
        ButtonsVisible(999)
    End Sub
    ' *** Schattenbahnhof
    Private Sub Button51_Click(sender As System.Object, e As System.EventArgs) Handles Button51.Click
        'ElseIf Betriebsart12 = 0 And Betriebsart34 = 3 Then
        'ElseIf Betriebsart12 = 0 And Betriebsart34 = 4 Then
        'ElseIf Betriebsart12 = 0 And Betriebsart34 = 5 Then
        If Betriebsart12 = 1 And Betriebsart34 = 0 Then
            If _SBhf_Gleis1 = 0 Or _SBhf_Gleis1 = 2 Or _SBhf_Gleis1 = 3 Or _SBhf_Gleis1 = 4 Then
                _SBhf_Gleis1 = 1
                Button51.Text = "Halt"
                Button51.BackColor = Drawing.Color.LightYellow
            ElseIf _SBhf_Gleis1 = 1 Then
                _SBhf_Gleis1 = 0
                Button51.Text = "kein Halt"
                Button51.BackColor = Drawing.Color.LightGreen
            Else
                _SBhf_Gleis1 = 0
            End If
        ElseIf Betriebsart12 = 1 And Betriebsart34 = 3 Then
            If _SBhf_Gleis1 = 0 Or _SBhf_Gleis1 = 2 Or _SBhf_Gleis1 = 4 Then
                _SBhf_Gleis1 = 1
                Button51.Text = "Halt"
                Button51.BackColor = Drawing.Color.LightYellow
            ElseIf _SBhf_Gleis1 = 1 Then
                _SBhf_Gleis1 = 3
                Button51.Text = "Wechsel > 3"
                Button51.BackColor = Drawing.Color.LightYellow
            ElseIf _SBhf_Gleis1 = 3 Then
                _SBhf_Gleis1 = 0
                Button51.Text = "kein Halt"
                Button51.BackColor = Drawing.Color.LightGreen
            Else
                _SBhf_Gleis1 = 0
            End If
        ElseIf Betriebsart12 = 1 And Betriebsart34 = 4 Then
            If _SBhf_Gleis1 = 0 Or _SBhf_Gleis1 = 2 Or _SBhf_Gleis1 = 3 Then
                _SBhf_Gleis1 = 1
                Button51.Text = "Halt"
                Button51.BackColor = Drawing.Color.LightYellow
            ElseIf _SBhf_Gleis1 = 1 Then
                _SBhf_Gleis1 = 4
                Button51.Text = "Wechsel > 4"
                Button51.BackColor = Drawing.Color.LightYellow
            ElseIf _SBhf_Gleis1 = 4 Then
                _SBhf_Gleis1 = 0
                Button51.Text = "kein Halt"
                Button51.BackColor = Drawing.Color.LightGreen
            Else
                _SBhf_Gleis1 = 0
            End If
        ElseIf Betriebsart12 = 1 And Betriebsart34 = 5 Then
            If _SBhf_Gleis1 = 0 Or _SBhf_Gleis1 = 2 Then
                _SBhf_Gleis1 = 1
                Button51.Text = "Halt"
                Button51.BackColor = Drawing.Color.LightYellow
            ElseIf _SBhf_Gleis1 = 1 Then
                _SBhf_Gleis1 = 3
                Button51.Text = "Wechsel > 3"
                Button51.BackColor = Drawing.Color.LightYellow
            ElseIf _SBhf_Gleis1 = 3 Then
                _SBhf_Gleis1 = 4
                Button51.Text = "Wechsel > 4"
                Button51.BackColor = Drawing.Color.LightYellow
            ElseIf _SBhf_Gleis1 = 4 Then
                _SBhf_Gleis1 = 0
                Button51.Text = "kein Halt"
                Button51.BackColor = Drawing.Color.LightGreen
            Else
                _SBhf_Gleis1 = 0
            End If
            'ElseIf Betriebsart12 = 2 And Betriebsart34 = 0 Then
            'ElseIf Betriebsart12 = 2 And Betriebsart34 = 3 Then
            'ElseIf Betriebsart12 = 2 And Betriebsart34 = 4 Then
            'ElseIf Betriebsart12 = 2 And Betriebsart34 = 5 Then
        ElseIf Betriebsart12 = 3 And Betriebsart34 = 0 Then
            If _Betriebsart3_0Var = 0 Then
                If _SBhf_Gleis1 = 0 Or _SBhf_Gleis1 = 3 Or _SBhf_Gleis1 = 4 Then
                    _SBhf_Gleis1 = 1
                    Button51.Text = "Halt"
                    Button51.BackColor = Drawing.Color.LightYellow
                ElseIf _SBhf_Gleis1 = 1 Then
                    _SBhf_Gleis1 = 2
                    Button51.Text = "Wechsel > 2"
                    Button51.BackColor = Drawing.Color.LightYellow
                ElseIf _SBhf_Gleis1 = 2 Then
                    _SBhf_Gleis1 = 0
                    Button51.Text = "kein Halt"
                    Button51.BackColor = Drawing.Color.LightGreen
                Else
                    _SBhf_Gleis1 = 0
                End If
            Else
                _SBhf_Gleis1 = 2
                Button51.Text = "Wechsel > 2"
                Button51.BackColor = Drawing.Color.LightYellow
            End If

        ElseIf Betriebsart12 = 3 And Betriebsart34 = 3 Then
            If _SBhf_Gleis1 = 0 Or _SBhf_Gleis1 = 4 Then
                _SBhf_Gleis1 = 1
                Button51.Text = "Halt"
                Button51.BackColor = Drawing.Color.LightYellow
            ElseIf _SBhf_Gleis1 = 1 Then
                _SBhf_Gleis1 = 2
                Button51.Text = "Wechsel > 2"
                Button51.BackColor = Drawing.Color.LightYellow
            ElseIf _SBhf_Gleis1 = 2 Then
                _SBhf_Gleis1 = 3
                Button51.Text = "Wechsel > 3"
                Button51.BackColor = Drawing.Color.LightYellow
            ElseIf _SBhf_Gleis1 = 3 Then
                _SBhf_Gleis1 = 0
                Button51.Text = "kein Halt"
                Button51.BackColor = Drawing.Color.LightGreen
            Else
                _SBhf_Gleis1 = 0
            End If
        ElseIf Betriebsart12 = 3 And Betriebsart34 = 4 Then
            If _SBhf_Gleis1 = 0 Or _SBhf_Gleis1 = 3 Then
                _SBhf_Gleis1 = 1
                Button51.Text = "Halt"
                Button51.BackColor = Drawing.Color.LightYellow
            ElseIf _SBhf_Gleis1 = 1 Then
                _SBhf_Gleis1 = 2
                Button51.Text = "Wechsel > 2"
                Button51.BackColor = Drawing.Color.LightYellow
            ElseIf _SBhf_Gleis1 = 2 Then
                _SBhf_Gleis1 = 4
                Button51.Text = "Wechsel > 4"
                Button51.BackColor = Drawing.Color.LightYellow
            ElseIf _SBhf_Gleis1 = 4 Then
                _SBhf_Gleis1 = 0
                Button51.Text = "kein Halt"
                Button51.BackColor = Drawing.Color.LightGreen
            Else
                _SBhf_Gleis1 = 0
            End If
        ElseIf Betriebsart12 = 3 And Betriebsart34 = 5 Then
            If _SBhf_Gleis1 = 0 Then
                _SBhf_Gleis1 = 1
                Button51.Text = "Halt"
                Button51.BackColor = Drawing.Color.LightYellow
            ElseIf _SBhf_Gleis1 = 1 Then
                _SBhf_Gleis1 = 2
                Button51.Text = "Wechsel > 2"
                Button51.BackColor = Drawing.Color.LightYellow
            ElseIf _SBhf_Gleis1 = 2 Then
                _SBhf_Gleis1 = 3
                Button51.Text = "Wechsel > 3"
                Button51.BackColor = Drawing.Color.LightYellow
            ElseIf _SBhf_Gleis1 = 3 Then
                _SBhf_Gleis1 = 4
                Button51.Text = "Wechsel > 4"
                Button51.BackColor = Drawing.Color.LightYellow
            ElseIf _SBhf_Gleis1 = 4 Then
                _SBhf_Gleis1 = 0
                Button51.Text = "kein Halt"
                Button51.BackColor = Drawing.Color.LightGreen
            Else
                _SBhf_Gleis1 = 0
            End If
        Else
            _SBhf_Gleis1 = 0
        End If
        _daten.write_to_table(AutomatikParameterTableName, 22, _SBhf_Gleis1)
        ButtonsVisible(999)
    End Sub
    Private Sub Button52_Click(sender As System.Object, e As System.EventArgs) Handles Button52.Click
        'ElseIf Betriebsart12 = 0 And Betriebsart34 = 3 Then
        'ElseIf Betriebsart12 = 0 And Betriebsart34 = 4 Then
        'ElseIf Betriebsart12 = 0 And Betriebsart34 = 5 Then
        'ElseIf Betriebsart12 = 1 And Betriebsart34 = 3 Then
        'ElseIf Betriebsart12 = 1 And Betriebsart34 = 4 Then
        'ElseIf Betriebsart12 = 1 And Betriebsart34 = 5 Then
        If Betriebsart12 = 2 And Betriebsart34 = 0 Then
            If _SBhf_Gleis2 = 0 Or _SBhf_Gleis2 = 1 Or _SBhf_Gleis2 = 3 Or _SBhf_Gleis2 = 4 Then
                _SBhf_Gleis2 = 2
                Button52.Text = "Halt"
                Button52.BackColor = Drawing.Color.LightYellow
            ElseIf _SBhf_Gleis2 = 2 Then
                _SBhf_Gleis2 = 0
                Button52.Text = "kein Halt"
                Button52.BackColor = Drawing.Color.LightGreen
            Else
                _SBhf_Gleis2 = 0
            End If
        ElseIf Betriebsart12 = 2 And Betriebsart34 = 3 Then
            If _SBhf_Gleis2 = 0 Or _SBhf_Gleis2 = 1 Or _SBhf_Gleis2 = 4 Then
                _SBhf_Gleis2 = 2
                Button52.Text = "Halt"
                Button52.BackColor = Drawing.Color.LightYellow
            ElseIf _SBhf_Gleis2 = 2 Then
                _SBhf_Gleis2 = 3
                Button52.Text = "Wechsel > 3"
                Button52.BackColor = Drawing.Color.LightYellow
            ElseIf _SBhf_Gleis2 = 3 Then
                _SBhf_Gleis2 = 0
                Button52.Text = "kein Halt"
                Button52.BackColor = Drawing.Color.LightGreen
            Else
                _SBhf_Gleis2 = 0
            End If
        ElseIf Betriebsart12 = 2 And Betriebsart34 = 4 Then
            If _SBhf_Gleis2 = 0 Or _SBhf_Gleis2 = 1 Or _SBhf_Gleis2 = 3 Then
                _SBhf_Gleis2 = 2
                Button52.Text = "Halt"
                Button52.BackColor = Drawing.Color.LightYellow
            ElseIf _SBhf_Gleis2 = 2 Then
                _SBhf_Gleis2 = 4
                Button52.Text = "Wechsel > 4"
                Button52.BackColor = Drawing.Color.LightYellow
            ElseIf _SBhf_Gleis2 = 4 Then
                _SBhf_Gleis2 = 0
                Button52.Text = "kein Halt"
                Button52.BackColor = Drawing.Color.LightGreen
            Else
                _SBhf_Gleis2 = 0
            End If
        ElseIf Betriebsart12 = 2 And Betriebsart34 = 5 Then
            If _SBhf_Gleis2 = 0 Or _SBhf_Gleis2 = 1 Then
                _SBhf_Gleis2 = 2
                Button52.Text = "Halt"
                Button52.BackColor = Drawing.Color.LightYellow
            ElseIf _SBhf_Gleis2 = 2 Then
                _SBhf_Gleis2 = 3
                Button52.Text = "Wechsel > 3"
                Button52.BackColor = Drawing.Color.LightYellow
            ElseIf _SBhf_Gleis2 = 3 Then
                _SBhf_Gleis2 = 4
                Button52.Text = "Wechsel > 4"
                Button52.BackColor = Drawing.Color.LightYellow
            ElseIf _SBhf_Gleis2 = 4 Then
                _SBhf_Gleis2 = 0
                Button52.Text = "kein Halt"
                Button52.BackColor = Drawing.Color.LightGreen
            Else
                _SBhf_Gleis2 = 0
            End If
        ElseIf Betriebsart12 = 3 And Betriebsart34 = 0 Then
            If _Betriebsart3_0Var = 0 Then
                If _SBhf_Gleis2 = 0 Or _SBhf_Gleis2 = 3 Or _SBhf_Gleis2 = 4 Then
                    _SBhf_Gleis2 = 2
                    Button52.Text = "Halt"
                    Button52.BackColor = Drawing.Color.LightYellow
                ElseIf _SBhf_Gleis2 = 2 Then
                    _SBhf_Gleis2 = 1
                    Button52.Text = "Wechsel > 1"
                    Button52.BackColor = Drawing.Color.LightYellow
                ElseIf _SBhf_Gleis2 = 1 Then
                    _SBhf_Gleis2 = 0
                    Button52.Text = "kein Halt"
                    Button52.BackColor = Drawing.Color.LightGreen
                Else
                    _SBhf_Gleis2 = 0
                End If
            Else
                _SBhf_Gleis2 = 1
                Button52.Text = "Wechsel > 1"
                Button52.BackColor = Drawing.Color.LightYellow
            End If
        ElseIf Betriebsart12 = 3 And Betriebsart34 = 3 Then
            If _SBhf_Gleis2 = 0 Or _SBhf_Gleis2 = 4 Then
                _SBhf_Gleis2 = 2
                Button52.Text = "Halt"
                Button52.BackColor = Drawing.Color.LightYellow
            ElseIf _SBhf_Gleis2 = 2 Then
                _SBhf_Gleis2 = 1
                Button52.Text = "Wechsel > 1"
                Button52.BackColor = Drawing.Color.LightYellow
            ElseIf _SBhf_Gleis2 = 1 Then
                _SBhf_Gleis2 = 3
                Button52.Text = "Wechsel > 3"
                Button52.BackColor = Drawing.Color.LightYellow
            ElseIf _SBhf_Gleis2 = 3 Then
                _SBhf_Gleis2 = 0
                Button52.Text = "kein Halt"
                Button52.BackColor = Drawing.Color.LightGreen
            Else
                _SBhf_Gleis2 = 0
            End If
        ElseIf Betriebsart12 = 3 And Betriebsart34 = 4 Then
            If _SBhf_Gleis2 = 0 Or _SBhf_Gleis2 = 3 Then
                _SBhf_Gleis2 = 2
                Button52.Text = "Halt"
                Button52.BackColor = Drawing.Color.LightYellow
            ElseIf _SBhf_Gleis2 = 2 Then
                _SBhf_Gleis2 = 1
                Button52.Text = "Wechsel > 1"
                Button52.BackColor = Drawing.Color.LightYellow
            ElseIf _SBhf_Gleis2 = 1 Then
                _SBhf_Gleis2 = 4
                Button52.Text = "Wechsel > 4"
                Button52.BackColor = Drawing.Color.LightYellow
            ElseIf _SBhf_Gleis2 = 4 Then
                _SBhf_Gleis2 = 0
                Button52.Text = "kein Halt"
                Button52.BackColor = Drawing.Color.LightGreen
            Else
                _SBhf_Gleis2 = 0
            End If
        ElseIf Betriebsart12 = 3 And Betriebsart34 = 5 Then
            If _SBhf_Gleis2 = 0 Then
                _SBhf_Gleis2 = 2
                Button52.Text = "Halt"
                Button52.BackColor = Drawing.Color.LightYellow
            ElseIf _SBhf_Gleis2 = 2 Then
                _SBhf_Gleis2 = 1
                Button52.Text = "Wechsel > 1"
                Button52.BackColor = Drawing.Color.LightYellow
            ElseIf _SBhf_Gleis2 = 1 Then
                _SBhf_Gleis2 = 3
                Button52.Text = "Wechsel > 3"
                Button52.BackColor = Drawing.Color.LightYellow
            ElseIf _SBhf_Gleis2 = 3 Then
                _SBhf_Gleis2 = 4
                Button52.Text = "Wechsel > 4"
                Button52.BackColor = Drawing.Color.LightYellow
            ElseIf _SBhf_Gleis2 = 4 Then
                _SBhf_Gleis2 = 0
                Button52.Text = "kein Halt"
                Button52.BackColor = Drawing.Color.LightGreen
            Else
                _SBhf_Gleis2 = 0
            End If
        Else
            _SBhf_Gleis2 = 0
        End If
        _daten.write_to_table(AutomatikParameterTableName, 23, _SBhf_Gleis2)
        ButtonsVisible(999)
    End Sub
    Private Sub Button53_Click(sender As System.Object, e As System.EventArgs) Handles Button53.Click
        If Betriebsart12 = 0 And Betriebsart34 = 3 Then
            If _SBhf_Gleis3 = 0 Or _SBhf_Gleis3 = 1 Or _SBhf_Gleis3 = 2 Or _SBhf_Gleis3 = 4 Then
                _SBhf_Gleis3 = 3
                Button53.Text = "Halt"
                Button53.BackColor = Drawing.Color.LightYellow
            ElseIf _SBhf_Gleis3 = 3 Then
                _SBhf_Gleis3 = 0
                Button53.Text = "kein Halt"
                Button53.BackColor = Drawing.Color.LightGreen
            Else
                _SBhf_Gleis3 = 0
            End If
            'ElseIf Betriebsart12 = 0 And Betriebsart34 = 4 Then
        ElseIf Betriebsart12 = 0 And Betriebsart34 = 5 Then
            If _Betriebsart0_5Var = 0 Then
                If _SBhf_Gleis3 = 0 Or _SBhf_Gleis3 = 1 Or _SBhf_Gleis3 = 2 Then
                    _SBhf_Gleis3 = 3
                    Button53.Text = "Halt"
                    Button53.BackColor = Drawing.Color.LightYellow
                ElseIf _SBhf_Gleis3 = 3 Then
                    _SBhf_Gleis3 = 4
                    Button53.Text = "Wechsel > 4"
                    Button53.BackColor = Drawing.Color.LightYellow
                ElseIf _SBhf_Gleis3 = 4 Then
                    _SBhf_Gleis3 = 0
                    Button53.Text = "kein Halt"
                    Button53.BackColor = Drawing.Color.LightGreen
                Else
                    _SBhf_Gleis3 = 0
                End If
            Else
                _SBhf_Gleis3 = 4
                Button53.Text = "Wechsel > 4"
                Button53.BackColor = Drawing.Color.LightYellow

            End If

        ElseIf Betriebsart12 = 1 And Betriebsart34 = 3 Then
            If _SBhf_Gleis3 = 0 Or _SBhf_Gleis3 = 2 Or _SBhf_Gleis3 = 4 Then
                _SBhf_Gleis3 = 3
                Button53.Text = "Halt"
                Button53.BackColor = Drawing.Color.LightYellow
            ElseIf _SBhf_Gleis3 = 3 Then
                _SBhf_Gleis3 = 1
                Button53.Text = "Wechsel > 1"
                Button53.BackColor = Drawing.Color.LightYellow
            ElseIf _SBhf_Gleis3 = 1 Then
                _SBhf_Gleis3 = 0
                Button53.Text = "kein Halt"
                Button53.BackColor = Drawing.Color.LightGreen
            Else
                _SBhf_Gleis3 = 0
            End If
            'ElseIf Betriebsart12 = 1 And Betriebsart34 = 4 Then
        ElseIf Betriebsart12 = 1 And Betriebsart34 = 5 Then
            If _SBhf_Gleis3 = 0 Or _SBhf_Gleis3 = 2 Then
                _SBhf_Gleis3 = 3
                Button53.Text = "Halt"
                Button53.BackColor = Drawing.Color.LightYellow
            ElseIf _SBhf_Gleis3 = 3 Then
                _SBhf_Gleis3 = 1
                Button53.Text = "Wechsel > 1"
                Button53.BackColor = Drawing.Color.LightYellow
            ElseIf _SBhf_Gleis3 = 1 Then
                _SBhf_Gleis3 = 4
                Button53.Text = "Wechsel > 4"
                Button53.BackColor = Drawing.Color.LightYellow
            ElseIf _SBhf_Gleis3 = 4 Then
                _SBhf_Gleis3 = 0
                Button53.Text = "kein Halt"
                Button53.BackColor = Drawing.Color.LightGreen
            Else
                _SBhf_Gleis3 = 0
            End If
            'ElseIf Betriebsart12 = 2 And Betriebsart34 = 0 Then
        ElseIf Betriebsart12 = 2 And Betriebsart34 = 3 Then
            If _SBhf_Gleis3 = 0 Or _SBhf_Gleis3 = 1 Or _SBhf_Gleis3 = 4 Then
                _SBhf_Gleis3 = 3
                Button53.Text = "Halt"
                Button53.BackColor = Drawing.Color.LightYellow
            ElseIf _SBhf_Gleis3 = 3 Then
                _SBhf_Gleis3 = 2
                Button53.Text = "Wechsel > 2"
                Button53.BackColor = Drawing.Color.LightYellow
            ElseIf _SBhf_Gleis3 = 2 Then
                _SBhf_Gleis3 = 0
                Button53.Text = "kein Halt"
                Button53.BackColor = Drawing.Color.LightGreen
            Else
                _SBhf_Gleis3 = 0
            End If
        ElseIf Betriebsart12 = 2 And Betriebsart34 = 5 Then
            If _SBhf_Gleis3 = 0 Or _SBhf_Gleis3 = 1 Then
                _SBhf_Gleis3 = 3
                Button53.Text = "Halt"
                Button53.BackColor = Drawing.Color.LightYellow
            ElseIf _SBhf_Gleis3 = 3 Then
                _SBhf_Gleis3 = 2
                Button53.Text = "Wechsel > 2"
                Button53.BackColor = Drawing.Color.LightYellow
            ElseIf _SBhf_Gleis3 = 2 Then
                _SBhf_Gleis3 = 4
                Button53.Text = "Wechsel > 4"
                Button53.BackColor = Drawing.Color.LightYellow
            ElseIf _SBhf_Gleis3 = 4 Then
                _SBhf_Gleis3 = 0
                Button53.Text = "kein Halt"
                Button53.BackColor = Drawing.Color.LightGreen
            Else
                _SBhf_Gleis3 = 0
            End If
        ElseIf Betriebsart12 = 3 And Betriebsart34 = 3 Then
            If _SBhf_Gleis3 = 0 Or _SBhf_Gleis3 = 4 Then
                _SBhf_Gleis3 = 3
                Button53.Text = "Halt"
                Button53.BackColor = Drawing.Color.LightYellow
            ElseIf _SBhf_Gleis3 = 3 Then
                _SBhf_Gleis3 = 1
                Button53.Text = "Wechsel > 1"
                Button53.BackColor = Drawing.Color.LightYellow
            ElseIf _SBhf_Gleis3 = 1 Then
                _SBhf_Gleis3 = 2
                Button53.Text = "Wechsel > 2"
                Button53.BackColor = Drawing.Color.LightYellow
            ElseIf _SBhf_Gleis3 = 2 Then
                _SBhf_Gleis3 = 0
                Button53.Text = "kein Halt"
                Button53.BackColor = Drawing.Color.LightGreen
            Else
                _SBhf_Gleis3 = 0
            End If
            'ElseIf Betriebsart12 = 3 And Betriebsart34 = 4 Then
        ElseIf Betriebsart12 = 3 And Betriebsart34 = 5 Then
            If _SBhf_Gleis3 = 0 Then
                _SBhf_Gleis3 = 3
                Button53.Text = "Halt"
                Button53.BackColor = Drawing.Color.LightYellow
            ElseIf _SBhf_Gleis3 = 3 Then
                _SBhf_Gleis3 = 1
                Button53.Text = "Wechsel > 1"
                Button53.BackColor = Drawing.Color.LightYellow
            ElseIf _SBhf_Gleis3 = 1 Then
                _SBhf_Gleis3 = 2
                Button53.Text = "Wechsel > 2"
                Button53.BackColor = Drawing.Color.LightYellow
            ElseIf _SBhf_Gleis3 = 2 Then
                _SBhf_Gleis3 = 4
                Button53.Text = "Wechsel > 4"
                Button53.BackColor = Drawing.Color.LightYellow
            ElseIf _SBhf_Gleis3 = 4 Then
                _SBhf_Gleis3 = 0
                Button53.Text = "kein Halt"
                Button53.BackColor = Drawing.Color.LightGreen
            Else
                _SBhf_Gleis3 = 0
            End If
        Else
            _SBhf_Gleis3 = 0
        End If
        _daten.write_to_table(AutomatikParameterTableName, 24, _SBhf_Gleis3)
        ButtonsVisible(999)
    End Sub
    Private Sub Button54_Click(sender As System.Object, e As System.EventArgs) Handles Button54.Click
        'ElseIf Betriebsart12 = 0 And Betriebsart34 = 3 Then
        If Betriebsart12 = 0 And Betriebsart34 = 4 Then
            If _SBhf_Gleis4 = 0 Then
                _SBhf_Gleis4 = 4
                Button54.Text = "Halt"
                Button54.BackColor = Drawing.Color.LightYellow
            ElseIf _SBhf_Gleis4 = 4 Then
                _SBhf_Gleis4 = 0
                Button54.Text = "kein Halt"
                Button54.BackColor = Drawing.Color.LightGreen
            Else
                _SBhf_Gleis4 = 0
            End If
        ElseIf Betriebsart12 = 0 And Betriebsart34 = 5 Then
            If _Betriebsart0_5Var = 0 Then
                If _SBhf_Gleis4 = 0 Then
                    _SBhf_Gleis4 = 4
                    Button54.Text = "Halt"
                    Button54.BackColor = Drawing.Color.LightYellow
                ElseIf _SBhf_Gleis4 = 4 Then
                    _SBhf_Gleis4 = 3
                    Button54.Text = "Wechsel > 3"
                    Button54.BackColor = Drawing.Color.LightYellow
                ElseIf _SBhf_Gleis4 = 3 Then
                    _SBhf_Gleis4 = 0
                    Button54.Text = "kein Halt"
                    Button54.BackColor = Drawing.Color.LightGreen
                Else
                    _SBhf_Gleis4 = 0
                End If
            Else
                _SBhf_Gleis4 = 3
                Button54.Text = "Wechsel > 3"
                Button54.BackColor = Drawing.Color.LightYellow

            End If

            'ElseIf Betriebsart12 = 1 And Betriebsart34 = 3 Then
        ElseIf Betriebsart12 = 1 And Betriebsart34 = 4 Then
            If _SBhf_Gleis4 = 0 Then
                _SBhf_Gleis4 = 4
                Button54.Text = "Halt"
                Button54.BackColor = Drawing.Color.LightYellow
            ElseIf _SBhf_Gleis4 = 4 Then
                _SBhf_Gleis4 = 1
                Button54.Text = "Wechsel > 1"
                Button54.BackColor = Drawing.Color.LightYellow
            ElseIf _SBhf_Gleis4 = 1 Then
                _SBhf_Gleis4 = 0
                Button54.Text = "kein Halt"
                Button54.BackColor = Drawing.Color.LightGreen
            Else
                _SBhf_Gleis4 = 0
            End If
        ElseIf Betriebsart12 = 1 And Betriebsart34 = 5 Then
            If _SBhf_Gleis4 = 0 Then
                _SBhf_Gleis4 = 4
                Button54.Text = "Halt"
                Button54.BackColor = Drawing.Color.LightYellow
            ElseIf _SBhf_Gleis4 = 4 Then
                _SBhf_Gleis4 = 1
                Button54.Text = "Wechsel > 1"
                Button54.BackColor = Drawing.Color.LightYellow
            ElseIf _SBhf_Gleis4 = 1 Then
                _SBhf_Gleis4 = 3
                Button54.Text = "Wechsel > 3"
                Button54.BackColor = Drawing.Color.LightYellow
            ElseIf _SBhf_Gleis4 = 3 Then
                _SBhf_Gleis4 = 0
                Button54.Text = "kein Halt"
                Button54.BackColor = Drawing.Color.LightGreen
            Else
                _SBhf_Gleis4 = 0
            End If
            'ElseIf Betriebsart12 = 2 And Betriebsart34 = 0 Then
            'ElseIf Betriebsart12 = 2 And Betriebsart34 = 3 Then
        ElseIf Betriebsart12 = 2 And Betriebsart34 = 4 Then
            If _SBhf_Gleis4 = 0 Then
                _SBhf_Gleis4 = 4
                Button54.Text = "Halt"
                Button54.BackColor = Drawing.Color.LightYellow
            ElseIf _SBhf_Gleis4 = 4 Then
                _SBhf_Gleis4 = 2
                Button54.Text = "Wechsel > 2"
                Button54.BackColor = Drawing.Color.LightYellow
            ElseIf _SBhf_Gleis4 = 2 Then
                _SBhf_Gleis4 = 0
                Button54.Text = "kein Halt"
                Button54.BackColor = Drawing.Color.LightGreen
            Else
                _SBhf_Gleis4 = 0
            End If
        ElseIf Betriebsart12 = 2 And Betriebsart34 = 5 Then
            If _SBhf_Gleis4 = 0 Then
                _SBhf_Gleis4 = 4
                Button54.Text = "Halt"
                Button54.BackColor = Drawing.Color.LightYellow
            ElseIf _SBhf_Gleis4 = 4 Then
                _SBhf_Gleis4 = 2
                Button54.Text = "Wechsel > 2"
                Button54.BackColor = Drawing.Color.LightYellow
            ElseIf _SBhf_Gleis4 = 2 Then
                _SBhf_Gleis4 = 3
                Button54.Text = "Wechsel > 3"
                Button54.BackColor = Drawing.Color.LightYellow
            ElseIf _SBhf_Gleis4 = 3 Then
                _SBhf_Gleis4 = 0
                Button54.Text = "kein Halt"
                Button54.BackColor = Drawing.Color.LightGreen
            Else
                _SBhf_Gleis4 = 0
            End If
            'ElseIf Betriebsart12 = 3 And Betriebsart34 = 3 Then
        ElseIf Betriebsart12 = 3 And Betriebsart34 = 4 Then
            If _SBhf_Gleis4 = 0 Then
                _SBhf_Gleis4 = 4
                Button54.Text = "Halt"
                Button54.BackColor = Drawing.Color.LightYellow
            ElseIf _SBhf_Gleis4 = 4 Then
                _SBhf_Gleis4 = 1
                Button54.Text = "Wechsel > 1"
                Button54.BackColor = Drawing.Color.LightYellow
            ElseIf _SBhf_Gleis4 = 1 Then
                _SBhf_Gleis4 = 2
                Button54.Text = "Wechsel > 2"
                Button54.BackColor = Drawing.Color.LightYellow
            ElseIf _SBhf_Gleis4 = 2 Then
                _SBhf_Gleis4 = 0
                Button54.Text = "kein Halt"
                Button54.BackColor = Drawing.Color.LightGreen
            Else
                _SBhf_Gleis4 = 0
            End If
        ElseIf Betriebsart12 = 3 And Betriebsart34 = 5 Then
            If _SBhf_Gleis4 = 0 Then
                _SBhf_Gleis4 = 4
                Button54.Text = "Halt"
                Button54.BackColor = Drawing.Color.LightYellow
            ElseIf _SBhf_Gleis4 = 4 Then
                _SBhf_Gleis4 = 1
                Button54.Text = "Wechsel > 1"
                Button54.BackColor = Drawing.Color.LightYellow
            ElseIf _SBhf_Gleis4 = 1 Then
                _SBhf_Gleis4 = 2
                Button54.Text = "Wechsel > 2"
                Button54.BackColor = Drawing.Color.LightYellow
            ElseIf _SBhf_Gleis4 = 2 Then
                _SBhf_Gleis4 = 3
                Button54.Text = "Wechsel > 3"
                Button54.BackColor = Drawing.Color.LightYellow
            ElseIf _SBhf_Gleis4 = 3 Then
                _SBhf_Gleis4 = 0
                Button54.Text = "kein Halt"
                Button54.BackColor = Drawing.Color.LightGreen
            Else
                _SBhf_Gleis4 = 0
            End If
        Else
            _SBhf_Gleis4 = 0
        End If
        _daten.write_to_table(AutomatikParameterTableName, 25, _SBhf_Gleis4)
        ButtonsVisible(999)
    End Sub
    ' *** Berg
    Private Sub Button61_Click(sender As System.Object, e As System.EventArgs) Handles Button61.Click
        If _Berg_Gleis1 = 0 Then
            _Berg_Gleis1 = 1
            Button61.Text = "Zindelstein"
            Button61.BackColor = Drawing.Color.LightYellow
        ElseIf _Berg_Gleis1 = 1 Then
            _Berg_Gleis1 = 2
            Button61.Text = "Bärental"
            Button61.BackColor = Drawing.Color.LightYellow
        ElseIf _Berg_Gleis1 = 2 Then
            _Berg_Gleis1 = 0
            Button61.Text = "kein Halt"
            Button61.BackColor = Drawing.Color.LightGreen
        Else
            _Berg_Gleis1 = 0
        End If
        _daten.write_to_table(AutomatikParameterTableName, 26, _Berg_Gleis1)
    End Sub
    Private Sub Button62_Click(sender As System.Object, e As System.EventArgs) Handles Button62.Click
        If _Berg_Gleis2 = 0 Then
            _Berg_Gleis2 = 1
            Button62.Text = "Zindelstein"
            Button62.BackColor = Drawing.Color.LightYellow
        ElseIf _Berg_Gleis2 = 1 Then
            _Berg_Gleis2 = 2
            Button62.Text = "Bärental"
            Button62.BackColor = Drawing.Color.LightYellow
        ElseIf _Berg_Gleis2 = 2 Then
            _Berg_Gleis2 = 0
            Button62.Text = "kein Halt"
            Button62.BackColor = Drawing.Color.LightGreen
        Else
            _Berg_Gleis2 = 0
        End If
        _daten.write_to_table(AutomatikParameterTableName, 27, _Berg_Gleis2)
    End Sub
    Private Sub Button63_Click(sender As System.Object, e As System.EventArgs) Handles Button63.Click
        If _Berg_Gleis3 = 0 Then
            _Berg_Gleis3 = 1
            Button63.Text = "Zindelstein"
            Button63.BackColor = Drawing.Color.LightYellow
        ElseIf _Berg_Gleis3 = 1 Then
            _Berg_Gleis3 = 2
            Button63.Text = "Bärental"
            Button63.BackColor = Drawing.Color.LightYellow
        ElseIf _Berg_Gleis3 = 2 Then
            _Berg_Gleis3 = 0
            Button63.Text = "kein Halt"
            Button63.BackColor = Drawing.Color.LightGreen
        Else
            _Berg_Gleis3 = 0
        End If
        _daten.write_to_table(AutomatikParameterTableName, 28, _Berg_Gleis3)

    End Sub
    Private Sub Button64_Click(sender As System.Object, e As System.EventArgs) Handles Button64.Click
        If _Berg_Gleis4 = 0 Then
            _Berg_Gleis4 = 1
            Button64.Text = "Zindelstein"
            Button64.BackColor = Drawing.Color.LightYellow
        ElseIf _Berg_Gleis4 = 1 Then
            _Berg_Gleis4 = 2
            Button64.Text = "Bärental"
            Button64.BackColor = Drawing.Color.LightYellow
        ElseIf _Berg_Gleis4 = 2 Then
            _Berg_Gleis4 = 0
            Button64.Text = "kein Halt"
            Button64.BackColor = Drawing.Color.LightGreen
        Else
            _Berg_Gleis4 = 0
        End If
        _daten.write_to_table(AutomatikParameterTableName, 29, _Berg_Gleis4)
    End Sub
    ' *** Bahnhof 2
    Private Sub Button71_Click(sender As System.Object, e As System.EventArgs) Handles Button71.Click
        'ElseIf Betriebsart12 = 0 And Betriebsart34 = 3 Then
        'ElseIf Betriebsart12 = 0 And Betriebsart34 = 4 Then
        'ElseIf Betriebsart12 = 0 And Betriebsart34 = 5 Then
        If Betriebsart12 = 1 And Betriebsart34 = 0 Then
            If _Bhf2_Gleis1 = 0 Or _Bhf2_Gleis1 = 2 Or _Bhf2_Gleis1 = 3 Or _Bhf2_Gleis1 = 4 Then
                _Bhf2_Gleis1 = 1
                Button71.Text = "Halt"
                Button71.BackColor = Drawing.Color.LightYellow
            ElseIf _Bhf2_Gleis1 = 1 Then
                _Bhf2_Gleis1 = 0
                Button71.Text = "kein Halt"
                Button71.BackColor = Drawing.Color.LightGreen
            Else
                _Bhf2_Gleis1 = 0
            End If
        ElseIf Betriebsart12 = 1 And Betriebsart34 = 3 Then
            If _Bhf2_Gleis1 = 0 Or _Bhf2_Gleis1 = 2 Or _Bhf2_Gleis1 = 4 Then
                _Bhf2_Gleis1 = 1
                Button71.Text = "Halt"
                Button71.BackColor = Drawing.Color.LightYellow
            ElseIf _Bhf2_Gleis1 = 1 Then
                _Bhf2_Gleis1 = 3
                Button71.Text = "Wechsel > 3"
                Button71.BackColor = Drawing.Color.LightYellow
            ElseIf _Bhf2_Gleis1 = 3 Then
                _Bhf2_Gleis1 = 0
                Button71.Text = "kein Halt"
                Button71.BackColor = Drawing.Color.LightGreen
            Else
                _Bhf2_Gleis1 = 0
            End If
        ElseIf Betriebsart12 = 1 And Betriebsart34 = 4 Then
            If _Bhf2_Gleis1 = 0 Or _Bhf2_Gleis1 = 2 Or _Bhf2_Gleis1 = 3 Then
                _Bhf2_Gleis1 = 1
                Button71.Text = "Halt"
                Button71.BackColor = Drawing.Color.LightYellow
            ElseIf _Bhf2_Gleis1 = 1 Then
                _Bhf2_Gleis1 = 4
                Button71.Text = "Wechsel > 4"
                Button71.BackColor = Drawing.Color.LightYellow
            ElseIf _Bhf2_Gleis1 = 4 Then
                _Bhf2_Gleis1 = 0
                Button71.Text = "kein Halt"
                Button71.BackColor = Drawing.Color.LightGreen
            Else
                _Bhf2_Gleis1 = 0
            End If
        ElseIf Betriebsart12 = 1 And Betriebsart34 = 5 Then
            If _Bhf2_Gleis1 = 0 Or _Bhf2_Gleis1 = 2 Then
                _Bhf2_Gleis1 = 1
                Button71.Text = "Halt"
                Button71.BackColor = Drawing.Color.LightYellow
            ElseIf _Bhf2_Gleis1 = 1 Then
                _Bhf2_Gleis1 = 3
                Button71.Text = "Wechsel > 3"
                Button71.BackColor = Drawing.Color.LightYellow
            ElseIf _Bhf2_Gleis1 = 3 Then
                _Bhf2_Gleis1 = 4
                Button71.Text = "Wechsel > 4"
                Button71.BackColor = Drawing.Color.LightYellow
            ElseIf _Bhf2_Gleis1 = 4 Then
                _Bhf2_Gleis1 = 0
                Button71.Text = "kein Halt"
                Button71.BackColor = Drawing.Color.LightGreen
            Else
                _Bhf2_Gleis1 = 0
            End If
            'ElseIf Betriebsart12 = 2 And Betriebsart34 = 0 Then
            'ElseIf Betriebsart12 = 2 And Betriebsart34 = 3 Then
            'ElseIf Betriebsart12 = 2 And Betriebsart34 = 4 Then
            'ElseIf Betriebsart12 = 2 And Betriebsart34 = 5 Then
        ElseIf Betriebsart12 = 3 And Betriebsart34 = 0 Then
            If _Betriebsart3_0Var = 0 Then
                If _Bhf2_Gleis1 = 0 Or _Bhf2_Gleis1 = 3 Or _Bhf2_Gleis1 = 4 Then
                    _Bhf2_Gleis1 = 1
                    Button71.Text = "Halt"
                    Button71.BackColor = Drawing.Color.LightYellow
                ElseIf _Bhf2_Gleis1 = 1 Then
                    _Bhf2_Gleis1 = 2
                    Button71.Text = "Wechsel > 2"
                    Button71.BackColor = Drawing.Color.LightYellow
                ElseIf _Bhf2_Gleis1 = 2 Then
                    _Bhf2_Gleis1 = 0
                    Button71.Text = "kein Halt"
                    Button71.BackColor = Drawing.Color.LightGreen
                Else
                    _Bhf2_Gleis1 = 0
                End If
            Else
                If _Bhf2_Gleis1 = 0 Or _Bhf2_Gleis1 = 3 Or _Bhf2_Gleis1 = 4 Then
                    _Bhf2_Gleis1 = 1
                    Button71.Text = "Halt"
                    Button71.BackColor = Drawing.Color.LightYellow
                ElseIf _Bhf2_Gleis1 = 1 Then
                    _Bhf2_Gleis1 = 0
                    Button71.Text = "kein Halt"
                    Button71.BackColor = Drawing.Color.LightGreen
                Else
                    _Bhf2_Gleis1 = 0
                End If
            End If

        ElseIf Betriebsart12 = 3 And Betriebsart34 = 3 Then
            If _Bhf2_Gleis1 = 0 Or _Bhf2_Gleis1 = 4 Then
                _Bhf2_Gleis1 = 1
                Button71.Text = "Halt"
                Button71.BackColor = Drawing.Color.LightYellow
            ElseIf _Bhf2_Gleis1 = 1 Then
                _Bhf2_Gleis1 = 2
                Button71.Text = "Wechsel > 2"
                Button71.BackColor = Drawing.Color.LightYellow
            ElseIf _Bhf2_Gleis1 = 2 Then
                _Bhf2_Gleis1 = 3
                Button71.Text = "Wechsel > 3"
                Button71.BackColor = Drawing.Color.LightYellow
            ElseIf _Bhf2_Gleis1 >= 3 Then
                _Bhf2_Gleis1 = 0
                Button71.Text = "kein Halt"
                Button71.BackColor = Drawing.Color.LightGreen
            Else
                _Bhf2_Gleis1 = 0
            End If
        ElseIf Betriebsart12 = 3 And Betriebsart34 = 4 Then
            If _Bhf2_Gleis1 = 0 Or _Bhf2_Gleis1 = 3 Then
                _Bhf2_Gleis1 = 1
                Button71.Text = "Halt"
                Button71.BackColor = Drawing.Color.LightYellow
            ElseIf _Bhf2_Gleis1 = 1 Then
                _Bhf2_Gleis1 = 2
                Button71.Text = "Wechsel > 2"
                Button71.BackColor = Drawing.Color.LightYellow
            ElseIf _Bhf2_Gleis1 = 2 Then
                _Bhf2_Gleis1 = 4
                Button71.Text = "Wechsel > 4"
                Button71.BackColor = Drawing.Color.LightYellow
            ElseIf _Bhf2_Gleis1 = 4 Then
                _Bhf2_Gleis1 = 0
                Button71.Text = "kein Halt"
                Button71.BackColor = Drawing.Color.LightGreen
            Else
                _Bhf2_Gleis1 = 0
            End If
        ElseIf Betriebsart12 = 3 And Betriebsart34 = 5 Then
            If _Bhf2_Gleis1 = 0 Then
                _Bhf2_Gleis1 = 1
                Button71.Text = "Halt"
                Button71.BackColor = Drawing.Color.LightYellow
            ElseIf _Bhf2_Gleis1 = 1 Then
                _Bhf2_Gleis1 = 2
                Button71.Text = "Wechsel > 2"
                Button71.BackColor = Drawing.Color.LightYellow
            ElseIf _Bhf2_Gleis1 = 2 Then
                _Bhf2_Gleis1 = 3
                Button71.Text = "Wechsel > 3"
                Button71.BackColor = Drawing.Color.LightYellow
            ElseIf _Bhf2_Gleis1 = 3 Then
                _Bhf2_Gleis1 = 4
                Button71.Text = "Wechsel > 4"
                Button71.BackColor = Drawing.Color.LightYellow
            ElseIf _Bhf2_Gleis1 = 4 Then
                _Bhf2_Gleis1 = 0
                Button71.Text = "kein Halt"
                Button71.BackColor = Drawing.Color.LightGreen
            Else
                _Bhf2_Gleis1 = 0
            End If
        End If
        _daten.write_to_table(AutomatikParameterTableName, 30, _Bhf2_Gleis1)
    End Sub
    Private Sub Button72_Click(sender As System.Object, e As System.EventArgs) Handles Button72.Click
        'ElseIf Betriebsart12 = 0 And Betriebsart34 = 3 Then
        'ElseIf Betriebsart12 = 0 And Betriebsart34 = 4 Then
        'ElseIf Betriebsart12 = 0 And Betriebsart34 = 5 Then
        'ElseIf Betriebsart12 = 1 And Betriebsart34 = 0 Then
        'ElseIf Betriebsart12 = 1 And Betriebsart34 = 3 Then
        'ElseIf Betriebsart12 = 1 And Betriebsart34 = 4 Then
        'ElseIf Betriebsart12 = 1 And Betriebsart34 = 5 Then
        If Betriebsart12 = 2 And Betriebsart34 = 0 Then
            If _Bhf2_Gleis2 = 0 Or _Bhf2_Gleis2 = 1 Or _Bhf2_Gleis2 = 3 Or _Bhf2_Gleis2 = 4 Then
                _Bhf2_Gleis2 = 2
                Button72.Text = "Halt"
                Button72.BackColor = Drawing.Color.LightYellow
            ElseIf _Bhf2_Gleis2 = 2 Then
                _Bhf2_Gleis2 = 0
                Button72.Text = "kein Halt"
                Button72.BackColor = Drawing.Color.LightGreen
            Else
                _Bhf2_Gleis2 = 0
            End If
        ElseIf Betriebsart12 = 2 And Betriebsart34 = 3 Then
            If _Bhf2_Gleis2 = 0 Or _Bhf2_Gleis2 = 1 Or _Bhf2_Gleis2 = 4 Then
                _Bhf2_Gleis2 = 2
                Button72.Text = "Halt"
                Button72.BackColor = Drawing.Color.LightYellow
            ElseIf _Bhf2_Gleis2 = 2 Then
                _Bhf2_Gleis2 = 3
                Button72.Text = "Wechsel > 3"
                Button72.BackColor = Drawing.Color.LightYellow
            ElseIf _Bhf2_Gleis2 = 3 Then
                _Bhf2_Gleis2 = 0
                Button72.Text = "kein Halt"
                Button72.BackColor = Drawing.Color.LightGreen
            Else
                _Bhf2_Gleis2 = 0
            End If
        ElseIf Betriebsart12 = 2 And Betriebsart34 = 4 Then
            If _Bhf2_Gleis2 = 0 Or _Bhf2_Gleis2 = 1 Or _Bhf2_Gleis2 = 3 Then
                _Bhf2_Gleis2 = 2
                Button72.Text = "Halt"
                Button72.BackColor = Drawing.Color.LightYellow
            ElseIf _Bhf2_Gleis2 = 2 Then
                _Bhf2_Gleis2 = 4
                Button72.Text = "Wechsel > 4"
                Button72.BackColor = Drawing.Color.LightYellow
            ElseIf _Bhf2_Gleis2 = 4 Then
                _Bhf2_Gleis2 = 0
                Button72.Text = "kein Halt"
                Button72.BackColor = Drawing.Color.LightGreen
            Else
                _Bhf2_Gleis2 = 0
            End If
        ElseIf Betriebsart12 = 2 And Betriebsart34 = 5 Then
            If _Bhf2_Gleis2 = 0 Or _Bhf2_Gleis2 = 1 Then
                _Bhf2_Gleis2 = 2
                Button72.Text = "Halt"
                Button72.BackColor = Drawing.Color.LightYellow
            ElseIf _Bhf2_Gleis2 = 2 Then
                _Bhf2_Gleis2 = 3
                Button72.Text = "Wechsel > 3"
                Button72.BackColor = Drawing.Color.LightYellow
            ElseIf _Bhf2_Gleis2 = 3 Then
                _Bhf2_Gleis2 = 4
                Button72.Text = "Wechsel > 4"
                Button72.BackColor = Drawing.Color.LightYellow
            ElseIf _Bhf2_Gleis2 = 4 Then
                _Bhf2_Gleis2 = 0
                Button72.Text = "kein Halt"
                Button72.BackColor = Drawing.Color.LightGreen
            Else
                _Bhf2_Gleis2 = 0
            End If
        ElseIf Betriebsart12 = 3 And Betriebsart34 = 0 Then
            If _Betriebsart3_0Var = 0 Then
                If _Bhf2_Gleis2 = 0 Or _Bhf2_Gleis2 = 3 Or _Bhf2_Gleis2 = 4 Then
                    _Bhf2_Gleis2 = 2
                    Button72.Text = "Halt"
                    Button72.BackColor = Drawing.Color.LightYellow
                ElseIf _Bhf2_Gleis2 = 2 Then
                    _Bhf2_Gleis2 = 1
                    Button72.Text = "Wechsel > 1"
                    Button72.BackColor = Drawing.Color.LightYellow
                ElseIf _Bhf2_Gleis2 = 1 Then
                    _Bhf2_Gleis2 = 0
                    Button72.Text = "kein Halt"
                    Button72.BackColor = Drawing.Color.LightGreen
                Else
                    _Bhf2_Gleis2 = 0
                End If
            ElseIf _Betriebsart3_0Var = 1 Then
                If _Bhf2_Gleis2 = 0 Or _Bhf2_Gleis2 = 3 Or _Bhf2_Gleis2 = 4 Then
                    _Bhf2_Gleis2 = 2
                    Button72.Text = "Halt"
                    Button72.BackColor = Drawing.Color.LightYellow
                ElseIf _Bhf2_Gleis2 = 2 Then
                    _Bhf2_Gleis2 = 0
                    Button72.Text = "kein Halt"
                    Button72.BackColor = Drawing.Color.LightGreen
                Else
                    _Bhf2_Gleis2 = 0
                End If
            Else
                If _Bhf2_Gleis2 = 0 Or _Bhf2_Gleis2 = 3 Or _Bhf2_Gleis2 = 4 Then
                    _Bhf2_Gleis2 = 2
                    Button72.Text = "Halt"
                    Button72.BackColor = Drawing.Color.LightYellow
                ElseIf _Bhf2_Gleis2 = 2 Then
                    _Bhf2_Gleis2 = 1
                    Button72.Text = "Wechsel > 1"
                    Button72.BackColor = Drawing.Color.LightYellow
                ElseIf _Bhf2_Gleis2 = 1 Then
                    _Bhf2_Gleis2 = 0
                    Button72.Text = "kein Halt"
                    Button72.BackColor = Drawing.Color.LightGreen
                Else
                    _Bhf2_Gleis2 = 0
                End If
            End If

        ElseIf Betriebsart12 = 3 And Betriebsart34 = 3 Then
            If _Bhf2_Gleis2 = 0 Or _Bhf2_Gleis2 = 4 Then
                _Bhf2_Gleis2 = 2
                Button72.Text = "Halt"
                Button72.BackColor = Drawing.Color.LightYellow
            ElseIf _Bhf2_Gleis2 = 2 Then
                _Bhf2_Gleis2 = 1
                Button72.Text = "Wechsel > 1"
                Button72.BackColor = Drawing.Color.LightYellow
            ElseIf _Bhf2_Gleis2 = 1 Then
                _Bhf2_Gleis2 = 3
                Button72.Text = "Wechsel > 3"
                Button72.BackColor = Drawing.Color.LightYellow
            ElseIf _Bhf2_Gleis2 = 3 Then
                _Bhf2_Gleis2 = 0
                Button72.Text = "kein Halt"
                Button72.BackColor = Drawing.Color.LightGreen
            Else
                _Bhf2_Gleis2 = 0
            End If
        ElseIf Betriebsart12 = 3 And Betriebsart34 = 4 Then
            If _Bhf2_Gleis2 = 0 Or _Bhf2_Gleis2 = 3 Then
                _Bhf2_Gleis2 = 2
                Button72.Text = "Halt"
                Button72.BackColor = Drawing.Color.LightYellow
            ElseIf _Bhf2_Gleis2 = 2 Then
                _Bhf2_Gleis2 = 1
                Button72.Text = "Wechsel > 1"
                Button72.BackColor = Drawing.Color.LightYellow
            ElseIf _Bhf2_Gleis2 = 1 Then
                _Bhf2_Gleis2 = 4
                Button72.Text = "Wechsel > 4"
                Button72.BackColor = Drawing.Color.LightYellow
            ElseIf _Bhf2_Gleis2 = 4 Then
                _Bhf2_Gleis2 = 0
                Button72.Text = "kein Halt"
                Button72.BackColor = Drawing.Color.LightGreen
            End If
        ElseIf Betriebsart12 = 3 And Betriebsart34 = 5 Then
            If _Bhf2_Gleis2 = 0 Then
                _Bhf2_Gleis2 = 2
                Button72.Text = "Halt"
                Button72.BackColor = Drawing.Color.LightYellow
            ElseIf _Bhf2_Gleis2 = 2 Then
                _Bhf2_Gleis2 = 1
                Button72.Text = "Wechsel > 1"
                Button72.BackColor = Drawing.Color.LightYellow
            ElseIf _Bhf2_Gleis2 = 1 Then
                _Bhf2_Gleis2 = 3
                Button72.Text = "Wechsel > 3"
                Button72.BackColor = Drawing.Color.LightYellow
            ElseIf _Bhf2_Gleis2 = 3 Then
                _Bhf2_Gleis2 = 4
                Button72.Text = "Wechsel > 4"
                Button72.BackColor = Drawing.Color.LightYellow
            ElseIf _Bhf2_Gleis2 = 4 Then
                _Bhf2_Gleis2 = 0
                Button72.Text = "kein Halt"
                Button72.BackColor = Drawing.Color.LightGreen
            End If
        Else
            _Bhf2_Gleis2 = 0
        End If
        _daten.write_to_table(AutomatikParameterTableName, 31, _Bhf2_Gleis2)
    End Sub
    Private Sub Button73_Click(sender As System.Object, e As System.EventArgs) Handles Button73.Click
        If Betriebsart12 = 0 And Betriebsart34 = 3 Then
            If _Bhf2_Gleis3 = 0 Or _Bhf2_Gleis3 = 1 Or _Bhf2_Gleis3 = 2 Or _Bhf2_Gleis3 = 4 Then
                _Bhf2_Gleis3 = 3
                Button73.Text = "Halt"
                Button73.BackColor = Drawing.Color.LightYellow
            ElseIf _Bhf2_Gleis3 = 3 Then
                _Bhf2_Gleis3 = 0
                Button73.Text = "kein Halt"
                Button73.BackColor = Drawing.Color.LightGreen
            End If
            'ElseIf Betriebsart12 = 0 And Betriebsart34 = 4 Then
        ElseIf Betriebsart12 = 0 And Betriebsart34 = 5 Then
            If _Betriebsart0_5Var = 0 Then
                If _Bhf2_Gleis3 = 0 Or _Bhf2_Gleis3 = 1 Or _Bhf2_Gleis3 = 2 Then
                    _Bhf2_Gleis3 = 3
                    Button73.Text = "Halt"
                    Button73.BackColor = Drawing.Color.LightYellow
                ElseIf _Bhf2_Gleis3 = 3 Then
                    _Bhf2_Gleis3 = 4
                    Button73.Text = "Wechsel > 4"
                    Button73.BackColor = Drawing.Color.LightYellow
                ElseIf _Bhf2_Gleis3 = 4 Then
                    _Bhf2_Gleis3 = 0
                    Button73.Text = "kein Halt"
                    Button73.BackColor = Drawing.Color.LightGreen
                Else
                    _Bhf2_Gleis3 = 0
                End If
            Else
                If _Bhf2_Gleis3 = 0 Or _Bhf2_Gleis3 = 1 Or _Bhf2_Gleis3 = 2 Then
                    _Bhf2_Gleis3 = 3
                    Button73.Text = "Halt"
                    Button73.BackColor = Drawing.Color.LightYellow
                ElseIf _Bhf2_Gleis3 = 3 Then
                    _Bhf2_Gleis3 = 0
                    Button73.Text = "kein Halt"
                    Button73.BackColor = Drawing.Color.LightGreen
                Else
                    _Bhf2_Gleis3 = 0
                End If
            End If
 
            'ElseIf Betriebsart12 = 1 And Betriebsart34 = 0 Then
        ElseIf Betriebsart12 = 1 And Betriebsart34 = 3 Then
            If _Bhf2_Gleis3 = 0 Or _Bhf2_Gleis3 = 2 Or _Bhf2_Gleis3 = 4 Then
                _Bhf2_Gleis3 = 3
                Button73.Text = "Halt"
                Button73.BackColor = Drawing.Color.LightYellow
            ElseIf _Bhf2_Gleis3 = 3 Then
                _Bhf2_Gleis3 = 1
                Button73.Text = "Wechsel > 1"
                Button73.BackColor = Drawing.Color.LightYellow
            ElseIf _Bhf2_Gleis3 = 1 Then
                _Bhf2_Gleis3 = 0
                Button73.Text = "kein Halt"
                Button73.BackColor = Drawing.Color.LightGreen
            End If
            'ElseIf Betriebsart12 = 1 And Betriebsart34 = 4 Then
        ElseIf Betriebsart12 = 1 And Betriebsart34 = 5 Then
            If _Bhf2_Gleis3 = 0 Or _Bhf2_Gleis3 = 2 Then
                _Bhf2_Gleis3 = 3
                Button73.Text = "Halt"
                Button73.BackColor = Drawing.Color.LightYellow
            ElseIf _Bhf2_Gleis3 = 3 Then
                _Bhf2_Gleis3 = 1
                Button73.Text = "Wechsel > 1"
                Button73.BackColor = Drawing.Color.LightYellow
            ElseIf _Bhf2_Gleis3 = 1 Then
                _Bhf2_Gleis3 = 4
                Button73.Text = "Wechsel > 4"
                Button73.BackColor = Drawing.Color.LightYellow
            ElseIf _Bhf2_Gleis3 = 4 Then
                _Bhf2_Gleis3 = 0
                Button73.Text = "kein Halt"
                Button73.BackColor = Drawing.Color.LightGreen
            End If
            'ElseIf Betriebsart12 = 2 And Betriebsart34 = 0 Then
        ElseIf Betriebsart12 = 2 And Betriebsart34 = 3 Then
            If _Bhf2_Gleis3 = 0 Or _Bhf2_Gleis3 = 1 Or _Bhf2_Gleis3 = 4 Then
                _Bhf2_Gleis3 = 3
                Button73.Text = "Halt"
                Button73.BackColor = Drawing.Color.LightYellow
            ElseIf _Bhf2_Gleis3 = 3 Then
                _Bhf2_Gleis3 = 2
                Button73.Text = "Wechsel > 2"
                Button73.BackColor = Drawing.Color.LightYellow
            ElseIf _Bhf2_Gleis3 = 2 Then
                _Bhf2_Gleis3 = 0
                Button73.Text = "kein Halt"
                Button73.BackColor = Drawing.Color.LightGreen
            End If
            'ElseIf Betriebsart12 = 2 And Betriebsart34 = 4 Then
        ElseIf Betriebsart12 = 2 And Betriebsart34 = 5 Then
            If _Bhf2_Gleis3 = 0 Or _Bhf2_Gleis3 = 1 Then
                _Bhf2_Gleis3 = 3
                Button73.Text = "Halt"
                Button73.BackColor = Drawing.Color.LightYellow
            ElseIf _Bhf2_Gleis3 = 3 Then
                _Bhf2_Gleis3 = 2
                Button73.Text = "Wechsel > 2"
                Button73.BackColor = Drawing.Color.LightYellow
            ElseIf _Bhf2_Gleis3 = 2 Then
                _Bhf2_Gleis3 = 4
                Button73.Text = "Wechsel > 4"
                Button73.BackColor = Drawing.Color.LightYellow
            ElseIf _Bhf2_Gleis3 = 4 Then
                _Bhf2_Gleis3 = 0
                Button73.Text = "kein Halt"
                Button73.BackColor = Drawing.Color.LightGreen
            End If
            'ElseIf Betriebsart12 = 3 And Betriebsart34 = 0 Then
        ElseIf Betriebsart12 = 3 And Betriebsart34 = 3 Then
            If _Bhf2_Gleis3 = 0 Or _Bhf2_Gleis3 = 4 Then
                _Bhf2_Gleis3 = 3
                Button73.Text = "Halt"
                Button73.BackColor = Drawing.Color.LightYellow
            ElseIf _Bhf2_Gleis3 = 3 Then
                _Bhf2_Gleis3 = 1
                Button73.Text = "Wechsel > 1"
                Button73.BackColor = Drawing.Color.LightYellow
            ElseIf _Bhf2_Gleis3 = 1 Then
                _Bhf2_Gleis3 = 2
                Button73.Text = "Wechsel > 2"
                Button73.BackColor = Drawing.Color.LightYellow
            ElseIf _Bhf2_Gleis3 = 2 Then
                _Bhf2_Gleis3 = 0
                Button73.Text = "kein Halt"
                Button73.BackColor = Drawing.Color.LightGreen
            End If
            'ElseIf Betriebsart12 = 3 And Betriebsart34 = 4 Then
        ElseIf Betriebsart12 = 3 And Betriebsart34 = 5 Then
            If _Bhf2_Gleis3 = 0 Then
                _Bhf2_Gleis3 = 3
                Button73.Text = "Halt"
                Button73.BackColor = Drawing.Color.LightYellow
            ElseIf _Bhf2_Gleis3 = 3 Then
                _Bhf2_Gleis3 = 1
                Button73.Text = "Wechsel > 1"
                Button73.BackColor = Drawing.Color.LightYellow
            ElseIf _Bhf2_Gleis3 = 1 Then
                _Bhf2_Gleis3 = 2
                Button73.Text = "Wechsel > 2"
                Button73.BackColor = Drawing.Color.LightYellow
            ElseIf _Bhf2_Gleis3 = 2 Then
                _Bhf2_Gleis3 = 4
                Button73.Text = "Wechsel > 4"
                Button73.BackColor = Drawing.Color.LightYellow
            ElseIf _Bhf2_Gleis3 = 4 Then
                _Bhf2_Gleis3 = 0
                Button73.Text = "kein Halt"
                Button73.BackColor = Drawing.Color.LightGreen
            End If
        Else
            _Bhf2_Gleis3 = 0
        End If
        _daten.write_to_table(AutomatikParameterTableName, 32, _Bhf2_Gleis3)
    End Sub
    Private Sub Button74_Click(sender As System.Object, e As System.EventArgs) Handles Button74.Click
        'ElseIf Betriebsart12 = 0 And Betriebsart34 = 3 Then
        If Betriebsart12 = 0 And Betriebsart34 = 4 Then
            If _Bhf2_Gleis4 = 0 Or _Bhf2_Gleis4 = 1 Or _Bhf2_Gleis4 = 2 Or _Bhf2_Gleis4 = 3 Then
                _Bhf2_Gleis4 = 4
                Button74.Text = "Halt"
                Button74.BackColor = Drawing.Color.LightYellow
            ElseIf _Bhf2_Gleis4 = 4 Then
                _Bhf2_Gleis4 = 0
                Button74.Text = "kein Halt"
                Button74.BackColor = Drawing.Color.LightGreen
            Else
                _Bhf2_Gleis4 = 0
            End If
        ElseIf Betriebsart12 = 0 And Betriebsart34 = 5 Then
            If _Betriebsart0_5Var = 0 Then
                If _Bhf2_Gleis4 = 0 Or _Bhf2_Gleis4 = 1 Or _Bhf2_Gleis4 = 2 Then
                    _Bhf2_Gleis4 = 4
                    Button74.Text = "Halt"
                    Button74.BackColor = Drawing.Color.LightYellow
                ElseIf _Bhf2_Gleis4 = 4 Then
                    _Bhf2_Gleis4 = 3
                    Button74.Text = "Wechsel > 3"
                    Button74.BackColor = Drawing.Color.LightYellow
                ElseIf _Bhf2_Gleis4 = 3 Then
                    _Bhf2_Gleis4 = 0
                    Button74.Text = "kein Halt"
                    Button74.BackColor = Drawing.Color.LightGreen
                Else
                    _Bhf2_Gleis4 = 0
                End If
            Else
                If _Bhf2_Gleis4 = 0 Or _Bhf2_Gleis4 = 1 Or _Bhf2_Gleis4 = 2 Then
                    _Bhf2_Gleis4 = 4
                    Button74.Text = "Halt"
                    Button74.BackColor = Drawing.Color.LightYellow
                ElseIf _Bhf2_Gleis4 = 4 Then
                    _Bhf2_Gleis4 = 0
                    Button74.Text = "kein Halt"
                    Button74.BackColor = Drawing.Color.LightGreen
                Else
                    _Bhf2_Gleis4 = 0
                End If

            End If

            'ElseIf Betriebsart12 = 1 And Betriebsart34 = 0 Then
            'ElseIf Betriebsart12 = 1 And Betriebsart34 = 3 Then
        ElseIf Betriebsart12 = 1 And Betriebsart34 = 4 Then
            If _Bhf2_Gleis4 = 0 Or _Bhf2_Gleis4 = 2 Or _Bhf2_Gleis4 = 3 Then
                _Bhf2_Gleis4 = 4
                Button74.Text = "Halt"
                Button74.BackColor = Drawing.Color.LightYellow
            ElseIf _Bhf2_Gleis4 = 4 Then
                _Bhf2_Gleis4 = 1
                Button74.Text = "Wechsel > 1"
                Button74.BackColor = Drawing.Color.LightYellow
            ElseIf _Bhf2_Gleis4 = 1 Then
                _Bhf2_Gleis4 = 0
                Button74.Text = "kein Halt"
                Button74.BackColor = Drawing.Color.LightGreen
            Else
                _Bhf2_Gleis4 = 0
            End If
        ElseIf Betriebsart12 = 1 And Betriebsart34 = 5 Then
            If _Bhf2_Gleis4 = 0 Or _Bhf2_Gleis4 = 2 Then
                _Bhf2_Gleis4 = 4
                Button74.Text = "Halt"
                Button74.BackColor = Drawing.Color.LightYellow
            ElseIf _Bhf2_Gleis4 = 4 Then
                _Bhf2_Gleis4 = 1
                Button74.Text = "Wechsel > 1"
                Button74.BackColor = Drawing.Color.LightYellow
            ElseIf _Bhf2_Gleis4 = 1 Then
                _Bhf2_Gleis4 = 3
                Button74.Text = "Wechsel > 3"
                Button74.BackColor = Drawing.Color.LightYellow
            ElseIf _Bhf2_Gleis4 = 3 Then
                _Bhf2_Gleis4 = 0
                Button74.Text = "kein Halt"
                Button74.BackColor = Drawing.Color.LightGreen
            Else
                _Bhf2_Gleis4 = 0
            End If
            'ElseIf Betriebsart12 = 2 And Betriebsart34 = 0 Then
            'ElseIf Betriebsart12 = 2 And Betriebsart34 = 3 Then
        ElseIf Betriebsart12 = 2 And Betriebsart34 = 4 Then
            If _Bhf2_Gleis4 = 0 Or _Bhf2_Gleis4 = 1 Or _Bhf2_Gleis4 = 3 Then
                _Bhf2_Gleis4 = 4
                Button74.Text = "Halt"
                Button74.BackColor = Drawing.Color.LightYellow
            ElseIf _Bhf2_Gleis4 = 4 Then
                _Bhf2_Gleis4 = 2
                Button74.Text = "Wechsel > 2"
                Button74.BackColor = Drawing.Color.LightYellow
            ElseIf _Bhf2_Gleis4 = 2 Then
                _Bhf2_Gleis4 = 0
                Button74.Text = "kein Halt"
                Button74.BackColor = Drawing.Color.LightGreen
            Else
                _Bhf2_Gleis4 = 0
            End If
        ElseIf Betriebsart12 = 2 And Betriebsart34 = 5 Then
            If _Bhf2_Gleis4 = 0 Or _Bhf2_Gleis4 = 1 Then
                _Bhf2_Gleis4 = 4
                Button74.Text = "Halt"
                Button74.BackColor = Drawing.Color.LightYellow
            ElseIf _Bhf2_Gleis4 = 4 Then
                _Bhf2_Gleis4 = 2
                Button74.Text = "Wechsel > 2"
                Button74.BackColor = Drawing.Color.LightYellow
            ElseIf _Bhf2_Gleis4 = 2 Then
                _Bhf2_Gleis4 = 3
                Button74.Text = "Wechsel > 3"
                Button74.BackColor = Drawing.Color.LightYellow
            ElseIf _Bhf2_Gleis4 = 3 Then
                _Bhf2_Gleis4 = 0
                Button74.Text = "kein Halt"
                Button74.BackColor = Drawing.Color.LightGreen
            Else
                _Bhf2_Gleis4 = 0
            End If
            'ElseIf Betriebsart12 = 3 And Betriebsart34 = 0 Then
            'ElseIf Betriebsart12 = 3 And Betriebsart34 = 3 Then
        ElseIf Betriebsart12 = 3 And Betriebsart34 = 4 Then
            If _Bhf2_Gleis4 = 0 Then
                _Bhf2_Gleis4 = 4
                Button74.Text = "Halt"
                Button74.BackColor = Drawing.Color.LightYellow
            ElseIf _Bhf2_Gleis4 = 4 Then
                _Bhf2_Gleis4 = 1
                Button74.Text = "Wechsel > 1"
                Button74.BackColor = Drawing.Color.LightYellow
            ElseIf _Bhf2_Gleis4 = 1 Then
                _Bhf2_Gleis4 = 2
                Button74.Text = "Wechsel > 2"
                Button74.BackColor = Drawing.Color.LightYellow
            ElseIf _Bhf2_Gleis4 = 2 Then
                _Bhf2_Gleis4 = 0
                Button74.Text = "kein Halt"
                Button74.BackColor = Drawing.Color.LightGreen
            Else
                _Bhf2_Gleis4 = 0
            End If
        ElseIf Betriebsart12 = 3 And Betriebsart34 = 5 Then
            If _Bhf2_Gleis4 = 0 Then
                _Bhf2_Gleis4 = 4
                Button74.Text = "Halt"
                Button74.BackColor = Drawing.Color.LightYellow
            ElseIf _Bhf2_Gleis4 = 4 Then
                _Bhf2_Gleis4 = 1
                Button74.Text = "Wechsel > 1"
                Button74.BackColor = Drawing.Color.LightYellow
            ElseIf _Bhf2_Gleis4 = 1 Then
                _Bhf2_Gleis4 = 2
                Button74.Text = "Wechsel > 2"
                Button74.BackColor = Drawing.Color.LightYellow
            ElseIf _Bhf2_Gleis4 = 2 Then
                _Bhf2_Gleis4 = 3
                Button74.Text = "Wechsel > 3"
                Button74.BackColor = Drawing.Color.LightYellow
            ElseIf _Bhf2_Gleis4 = 3 Then
                _Bhf2_Gleis4 = 0
                Button74.Text = "kein Halt"
                Button74.BackColor = Drawing.Color.LightGreen
            End If
        Else
            _Bhf2_Gleis4 = 0
        End If

        _daten.write_to_table(AutomatikParameterTableName, 33, _Bhf2_Gleis4)
    End Sub
    ' *** Diagonale
    Private Sub Button81_Click(sender As System.Object, e As System.EventArgs) Handles Button81.Click
        If _Betriebsart3_0Var = 0 Then
            If Diagonale_Gleis1 = 0 Then
                Diagonale_Gleis1 = 1
                Button81.Text = "Halt"
                Button81.BackColor = Drawing.Color.LightYellow
            ElseIf Diagonale_Gleis1 = 1 Then
                Diagonale_Gleis1 = 0
                Button81.Text = "kein Halt"
                Button81.BackColor = Drawing.Color.LightGreen
            Else
                Diagonale_Gleis1 = 0
            End If
        Else
            Diagonale_Gleis1 = 2
            Button81.Text = "Wechsel > 2"
            Button81.BackColor = Drawing.Color.LightYellow
        End If
        _daten.write_to_table(AutomatikParameterTableName, 35, Diagonale_Gleis1)
    End Sub
    Private Sub Button82_Click(sender As System.Object, e As System.EventArgs) Handles Button82.Click
        If _Betriebsart3_0Var = 0 Then
            If Diagonale_Gleis2 = 0 Then
                Diagonale_Gleis2 = 2
                Button82.Text = "Halt"
                Button82.BackColor = Drawing.Color.LightYellow
            ElseIf Diagonale_Gleis2 = 2 Then
                Diagonale_Gleis2 = 0
                Button82.Text = "kein Halt"
                Button82.BackColor = Drawing.Color.LightGreen
            Else
                Diagonale_Gleis2 = 0
            End If
        Else
            Diagonale_Gleis2 = 1
            Button82.Text = "Wechsel > 1"
            Button82.BackColor = Drawing.Color.LightYellow
        End If

        _daten.write_to_table(AutomatikParameterTableName, 36, Diagonale_Gleis2)
    End Sub
    Private Sub Button83_Click(sender As System.Object, e As System.EventArgs) Handles Button83.Click
        If Diagonale_Gleis3 = 0 Then
            Diagonale_Gleis3 = 3
            Button83.Text = "Halt"
            Button83.BackColor = Drawing.Color.LightYellow
        ElseIf Diagonale_Gleis3 = 3 Then
            Diagonale_Gleis3 = 0
            Button83.Text = "kein Halt"
            Button83.BackColor = Drawing.Color.LightGreen
        Else
            Diagonale_Gleis3 = 0
        End If
        _daten.write_to_table(AutomatikParameterTableName, 37, Diagonale_Gleis3)
    End Sub
    Private Sub Button84_Click(sender As System.Object, e As System.EventArgs) Handles Button84.Click
        If Diagonale_Gleis4 = 0 Then
            Diagonale_Gleis4 = 4
            Button84.Text = "Halt"
            Button84.BackColor = Drawing.Color.LightYellow
        ElseIf Diagonale_Gleis4 = 4 Then
            Diagonale_Gleis4 = 0
            Button84.Text = "kein Halt"
            Button84.BackColor = Drawing.Color.LightGreen
        Else
            Diagonale_Gleis4 = 0
        End If
        _daten.write_to_table(AutomatikParameterTableName, 38, Diagonale_Gleis4)
    End Sub
    ' *** Talstrecke
    Private Sub Button91_Click(sender As System.Object, e As System.EventArgs) Handles Button91.Click
        If _Betriebsart3_0Var = 0 Or _Betriebsart3_0Var = 2 Then
            If Talstrecke_Gleis1 = 0 Then
                Talstrecke_Gleis1 = 1
                Button91.Text = "Halt"
                Button91.BackColor = Drawing.Color.LightYellow
            ElseIf Talstrecke_Gleis1 = 1 Then
                Talstrecke_Gleis1 = 0
                Button91.Text = "kein Halt"
                Button91.BackColor = Drawing.Color.LightGreen
            Else
                Talstrecke_Gleis1 = 0
            End If
        Else
            Talstrecke_Gleis1 = 2
            Button91.Text = "Wechsel > 2"
            Button91.BackColor = Drawing.Color.LightYellow
        End If

        _daten.write_to_table(AutomatikParameterTableName, 39, Talstrecke_Gleis1)
    End Sub
    Private Sub Button92_Click(sender As System.Object, e As System.EventArgs) Handles Button92.Click
        If _Betriebsart3_0Var = 0 Or _Betriebsart3_0Var = 2 Then
            If Talstrecke_Gleis2 = 0 Then
                Talstrecke_Gleis2 = 2
                Button92.Text = "Halt"
                Button92.BackColor = Drawing.Color.LightYellow
            ElseIf Talstrecke_Gleis2 = 2 Then
                Talstrecke_Gleis2 = 0
                Button92.Text = "kein Halt"
                Button92.BackColor = Drawing.Color.LightGreen
            Else
                Talstrecke_Gleis2 = 0
            End If
        Else
            Talstrecke_Gleis2 = 1
            Button92.Text = "Wechsel > 1"
            Button92.BackColor = Drawing.Color.LightYellow
        End If
        _daten.write_to_table(AutomatikParameterTableName, 40, Talstrecke_Gleis2)
    End Sub
    Private Sub Button93_Click(sender As System.Object, e As System.EventArgs) Handles Button93.Click
        If _Betriebsart0_5Var = 0 Then
            If Talstrecke_Gleis3 = 0 Then
                Talstrecke_Gleis3 = 3
                Button93.Text = "Halt"
                Button93.BackColor = Drawing.Color.LightYellow
            ElseIf Talstrecke_Gleis3 = 3 Then
                Talstrecke_Gleis3 = 0
                Button93.Text = "kein Halt"
                Button93.BackColor = Drawing.Color.LightGreen
            Else
                Talstrecke_Gleis3 = 0
            End If
        Else
            Talstrecke_Gleis3 = 4
            Button93.Text = "Wechsel > 4"
            Button93.BackColor = Drawing.Color.LightYellow
        End If

        _daten.write_to_table(AutomatikParameterTableName, 41, Talstrecke_Gleis3)
    End Sub
    Private Sub Button94_Click(sender As System.Object, e As System.EventArgs) Handles Button94.Click
        If _Betriebsart0_5Var = 0 Then
            If Talstrecke_Gleis4 = 0 Then
                Talstrecke_Gleis4 = 4
                Button94.Text = "Halt"
                Button94.BackColor = Drawing.Color.LightYellow
            ElseIf Talstrecke_Gleis4 = 4 Then
                Talstrecke_Gleis4 = 0
                Button94.Text = "kein Halt"
                Button94.BackColor = Drawing.Color.LightGreen
            Else
                Talstrecke_Gleis4 = 0
            End If
        Else
            Talstrecke_Gleis4 = 3
            Button94.Text = "Wechsel > 3"
            Button94.BackColor = Drawing.Color.LightYellow
        End If

        _daten.write_to_table(AutomatikParameterTableName, 42, Talstrecke_Gleis4)
    End Sub
    ' *** Weichen stellen, Signale stelle, Automatik start
    Private Sub Button41_Click(sender As System.Object, e As System.EventArgs) Handles Button41.Click
        Dim Startpunkt, Zeile As Integer
        Dim W13, W14, W15, W16, W17, W18, W19, W20, W21, W22, W23, W24, W25, W26, W27 As Integer

        W13 = 8
        W14 = 10
        W15 = 12
        W16 = 14
        W17 = 16
        W18 = 18
        W19 = 20
        W20 = 22
        W21 = 24
        W22 = 26
        W23 = 28
        W24 = 30
        W25 = 32
        W26 = 34
        W27 = 36

        Zeile = 0

        'AutoParaLabel.BackColor = Drawing.Color.LightGray

        _Weichen_in_Startposition = False

        'Betriebsparameter.SetValue("Test", 1, 1, "Hallo Welt")
        'Button10.Text = Betriebsparameter.GetValue("Speicher", "B5")
        ' ***
        ' *** Betriebsart 0 - keine Automatik
        ' ***
        If Betriebsart = 0 Then
            _eb.weicheSchalten(13, Klassen.WeichenRichtung.links)
            _eb.weicheSchalten(14, Klassen.WeichenRichtung.links)
            _eb.weicheSchalten(15, Klassen.WeichenRichtung.rechts)
            _eb.weicheSchalten(16, Klassen.WeichenRichtung.rechts)
            _eb.weicheSchalten(17, Klassen.WeichenRichtung.links)
            _eb.weicheSchalten(19, Klassen.WeichenRichtung.rechts)
            _eb.weicheSchalten(20, Klassen.WeichenRichtung.links)
            _eb.weicheSchalten(21, Klassen.WeichenRichtung.rechts)
            _eb.weicheSchalten(22, Klassen.WeichenRichtung.rechts)
            _eb.weicheSchalten(23, Klassen.WeichenRichtung.links)
            _eb.weicheSchalten(25, Klassen.WeichenRichtung.links)
            _eb.weicheSchalten(26, Klassen.WeichenRichtung.links)
            _eb.weicheSchalten(27, Klassen.WeichenRichtung.links)
            _Weichen_initialisiert = True
            _Weichen_in_Startposition = True
        End If
        ' ***
        ' *** Betriebsart 1 - Züge fahren nur unten
        ' ***
        If Betriebsart = 1 Then
            _eb.weicheSchalten(13, Klassen.WeichenRichtung.links)
            _eb.weicheSchalten(14, Klassen.WeichenRichtung.links)
            _eb.weicheSchalten(15, Klassen.WeichenRichtung.rechts)
            _eb.weicheSchalten(16, Klassen.WeichenRichtung.rechts)
            _eb.weicheSchalten(17, Klassen.WeichenRichtung.links)
            If Betriebsart12 = 1 Then
                _eb.weicheSchalten(19, Klassen.WeichenRichtung.links)
                _eb.weicheSchalten(21, Klassen.WeichenRichtung.rechts)
            End If
            If Betriebsart12 = 2 Then
                _eb.weicheSchalten(19, Klassen.WeichenRichtung.rechts)
                _eb.weicheSchalten(21, Klassen.WeichenRichtung.links)
            End If
            If Betriebsart12 = 3 Then
                _eb.weicheSchalten(19, Klassen.WeichenRichtung.links)
                _eb.weicheSchalten(21, Klassen.WeichenRichtung.rechts)
            End If
            If Betriebsart34 = 3 Then
                _eb.weicheSchalten(20, Klassen.WeichenRichtung.links)
                _eb.weicheSchalten(22, Klassen.WeichenRichtung.rechts)
            End If
            If Betriebsart34 = 4 Then
                _eb.weicheSchalten(20, Klassen.WeichenRichtung.rechts)
                _eb.weicheSchalten(22, Klassen.WeichenRichtung.links)
            End If
            If Betriebsart34 = 5 Then
                _eb.weicheSchalten(20, Klassen.WeichenRichtung.links)
                _eb.weicheSchalten(22, Klassen.WeichenRichtung.rechts)
            End If
            _eb.weicheSchalten(23, Klassen.WeichenRichtung.links)
            _eb.weicheSchalten(25, Klassen.WeichenRichtung.links)
            _eb.weicheSchalten(26, Klassen.WeichenRichtung.links)
            _eb.weicheSchalten(27, Klassen.WeichenRichtung.links)

            _Weichen_initialisiert = True
            _Weichen_in_Startposition = True

        End If
        ' ***
        ' *** Betriebsart 2 - koordinierter Betrieb
        ' ***
        If Betriebsart = 2 Then
            _eb.weicheSchalten(15, Klassen.WeichenRichtung.rechts)
            _eb.weicheSchalten(16, Klassen.WeichenRichtung.rechts)
            ' ***
            ' *** Betriebsart 0 - 3
            ' ***
            If Betriebsart12 = 0 And Betriebsart34 = 3 Then
                Startpunkt = 17
                Zeile = Startpunkt + _Route_Gleis3
                NumericUpDown8.BackColor = Drawing.Color.White
                NumericUpDown9.BackColor = Drawing.Color.White
                NumericUpDown10.BackColor = Drawing.Color.LightBlue
                NumericUpDown11.BackColor = Drawing.Color.White
                Startzug = 3
                _daten.write_to_table(AutomatikParameterTableName, 43, Startzug)
                GeschwindikeitenSetzen(NumericUpDown10.Value)
                If _Betriebsart0_3Var = 1 Then
                    Zeile = 360
                End If
            End If
            ' ***
            ' *** Betriebsart 0 - 4
            ' ***
            If Betriebsart12 = 0 And Betriebsart34 = 4 Then
                Startpunkt = 21
                Zeile = Startpunkt + _Route_Gleis4
                NumericUpDown8.BackColor = Drawing.Color.White
                NumericUpDown9.BackColor = Drawing.Color.White
                NumericUpDown10.BackColor = Drawing.Color.White
                NumericUpDown11.BackColor = Drawing.Color.LightBlue
                Startzug = 4
                _daten.write_to_table(AutomatikParameterTableName, 43, Startzug)
                GeschwindikeitenSetzen(NumericUpDown11.Value)
                If _Betriebsart0_4Var = 1 Then
                    Zeile = 362
                End If
                If _Betriebsart0_4Var = 2 Then
                    Zeile = 368
                End If
            End If
            ' ***
            ' *** Betriebsart 0 - 5
            ' ***
            If Betriebsart12 = 0 And Betriebsart34 = 5 Then
                If _Betriebsart0_5Var = 0 Then
                    Startpunkt = 25
                    Zeile = Startpunkt + (4 * _Route_Gleis3) + _Route_Gleis4

                    If Startzug = 4 Then
                        GeschwindikeitenSetzen(NumericUpDown11.Value)
                        _eb.weicheSchalten(20, Klassen.WeichenRichtung.rechts)
                        If _Route_Gleis4 = 0 Then
                            _eb.weicheSchalten(27, Klassen.WeichenRichtung.links)
                        ElseIf _Route_Gleis4 = 1 Then
                            _eb.weicheSchalten(27, Klassen.WeichenRichtung.rechts)
                        ElseIf _Route_Gleis4 = 2 Then
                            _eb.weicheSchalten(27, Klassen.WeichenRichtung.rechts)
                        End If
                        If _Route_Gleis3 = 2 Then
                            _eb.weicheSchalten(22, Klassen.WeichenRichtung.rechts)
                        Else
                            _eb.weicheSchalten(22, Klassen.WeichenRichtung.links)
                        End If
                    Else
                        NumericUpDown8.BackColor = Drawing.Color.White
                        NumericUpDown9.BackColor = Drawing.Color.White
                        NumericUpDown10.BackColor = Drawing.Color.LightBlue
                        NumericUpDown11.BackColor = Drawing.Color.White
                        Startzug = 3
                        _daten.write_to_table(AutomatikParameterTableName, 43, Startzug)
                        GeschwindikeitenSetzen(NumericUpDown10.Value)
                        _eb.weicheSchalten(20, Klassen.WeichenRichtung.links)
                        If _Route_Gleis3 = 0 Then
                            _eb.weicheSchalten(27, Klassen.WeichenRichtung.links)
                        ElseIf _Route_Gleis3 = 1 Then
                            _eb.weicheSchalten(27, Klassen.WeichenRichtung.rechts)
                        ElseIf _Route_Gleis3 = 2 Then
                            _eb.weicheSchalten(27, Klassen.WeichenRichtung.rechts)
                        End If
                        If _Route_Gleis4 = 2 Then
                            _eb.weicheSchalten(22, Klassen.WeichenRichtung.links)
                        Else
                            _eb.weicheSchalten(22, Klassen.WeichenRichtung.rechts)
                        End If
                    End If
                Else
                    Zeile = 363
                    NumericUpDown8.BackColor = Drawing.Color.White
                    NumericUpDown9.BackColor = Drawing.Color.White
                    NumericUpDown10.BackColor = Drawing.Color.LightBlue
                    NumericUpDown11.BackColor = Drawing.Color.White
                    Startzug = 3
                    _daten.write_to_table(AutomatikParameterTableName, 43, Startzug)
                    GeschwindikeitenSetzen(NumericUpDown10.Value)
                End If

            End If
            ' ***
            ' *** Betriebsart 1 - 0
            ' ***
            If Betriebsart12 = 1 And Betriebsart34 = 0 Then                     '*** 1 - 0
                Startpunkt = 37
                Zeile = Startpunkt + _Route_Gleis1

                NumericUpDown8.BackColor = Drawing.Color.LightBlue
                NumericUpDown9.BackColor = Drawing.Color.White
                NumericUpDown10.BackColor = Drawing.Color.White
                NumericUpDown11.BackColor = Drawing.Color.White
                Startzug = 1
                _daten.write_to_table(AutomatikParameterTableName, 43, Startzug)
                GeschwindikeitenSetzen(NumericUpDown8.Value)
                If _Betriebsart1_0Var = 0 Then
                    If _GleisFrei2 = 1 Then
                        Zeile = 365
                    End If
                    If _GleisFrei3 = 1 Then
                        Zeile = 366
                    End If
                    If _GleisFrei4 = 1 Then
                        Zeile = 367
                    End If
                End If
                If _Betriebsart1_0Var = 1 Then
                    Zeile = 364
                End If
            End If
            ' ***
            ' *** Betriebsart 1 - 3
            ' ***
            If Betriebsart12 = 1 And Betriebsart34 = 3 Then                 '*** 1 - 3
                Startpunkt = 41
                Zeile = Startpunkt + (4 * _Route_Gleis1) + _Route_Gleis3

                If Startzug = 3 Then
                    _eb.weicheSchalten(23, Klassen.WeichenRichtung.rechts)
                    If _Route_Gleis1 = 1 Then
                        If _Route_Gleis3 = 0 Then
                            _eb.weicheSchalten(27, Klassen.WeichenRichtung.links)
                        Else
                            _eb.weicheSchalten(27, Klassen.WeichenRichtung.rechts)
                        End If
                    End If
                Else
                    NumericUpDown8.BackColor = Drawing.Color.LightBlue
                    NumericUpDown9.BackColor = Drawing.Color.White
                    NumericUpDown10.BackColor = Drawing.Color.White
                    NumericUpDown11.BackColor = Drawing.Color.White
                    Startzug = 1
                    _daten.write_to_table(AutomatikParameterTableName, 43, Startzug)
                    _eb.weicheSchalten(23, Klassen.WeichenRichtung.links)
                    If _Route_Gleis1 = 1 Then
                        _eb.weicheSchalten(27, Klassen.WeichenRichtung.rechts)
                    End If
                End If
            End If
            ' ***
            ' *** Betriebsart 1 - 4
            ' ***
            If Betriebsart12 = 1 And Betriebsart34 = 4 Then                 '*** 1 - 4
                Startpunkt = 53
                Zeile = Startpunkt + (4 * _Route_Gleis1) + _Route_Gleis4

                If Startzug = 4 Then
                    _eb.weicheSchalten(23, Klassen.WeichenRichtung.rechts)
                    If _Route_Gleis1 = 1 Then
                        If _Route_Gleis4 = 0 Then
                            _eb.weicheSchalten(27, Klassen.WeichenRichtung.links)
                        Else
                            _eb.weicheSchalten(27, Klassen.WeichenRichtung.rechts)
                        End If
                    End If
                Else
                    NumericUpDown8.BackColor = Drawing.Color.LightBlue
                    NumericUpDown9.BackColor = Drawing.Color.White
                    NumericUpDown10.BackColor = Drawing.Color.White
                    NumericUpDown11.BackColor = Drawing.Color.White
                    Startzug = 1
                    _daten.write_to_table(AutomatikParameterTableName, 43, Startzug)
                    _eb.weicheSchalten(23, Klassen.WeichenRichtung.links)
                    If _Route_Gleis1 = 1 Then
                        _eb.weicheSchalten(27, Klassen.WeichenRichtung.rechts)
                    End If
                End If

            End If
            ' ***
            ' *** Betriebsart 1 - 5
            ' ***
            If Betriebsart12 = 1 And Betriebsart34 = 5 Then
                Startpunkt = 65
                Zeile = Startpunkt + (12 * _Route_Gleis1) + (4 * _Route_Gleis3) + _Route_Gleis4
                If Startzug = 4 Then
                    _eb.weicheSchalten(20, Klassen.WeichenRichtung.rechts)
                    If _Route_Gleis4 = 0 Then
                        _eb.weicheSchalten(27, Klassen.WeichenRichtung.links)
                    Else
                        _eb.weicheSchalten(27, Klassen.WeichenRichtung.rechts)
                    End If
                ElseIf Startzug = 3 Then
                    _eb.weicheSchalten(20, Klassen.WeichenRichtung.links)
                    If _Route_Gleis3 = 0 Then
                        _eb.weicheSchalten(27, Klassen.WeichenRichtung.links)
                    Else
                        _eb.weicheSchalten(27, Klassen.WeichenRichtung.rechts)
                    End If
                Else
                    NumericUpDown8.BackColor = Drawing.Color.LightBlue
                    NumericUpDown9.BackColor = Drawing.Color.White
                    NumericUpDown10.BackColor = Drawing.Color.White
                    NumericUpDown11.BackColor = Drawing.Color.White
                    Startzug = 1
                    _daten.write_to_table(AutomatikParameterTableName, 43, Startzug)
                    _eb.weicheSchalten(20, Klassen.WeichenRichtung.links)
                    If _Route_Gleis3 = 0 And _Route_Gleis4 = 0 Then
                        If _Route_Gleis1 = 0 Then
                            _eb.weicheSchalten(27, Klassen.WeichenRichtung.links)
                        Else
                            _eb.weicheSchalten(27, Klassen.WeichenRichtung.rechts)
                        End If
                    Else
                        _eb.weicheSchalten(27, Klassen.WeichenRichtung.rechts)

                    End If
                End If
                If _Route_Gleis1 = 1 Then
                    _eb.weicheSchalten(17, Klassen.WeichenRichtung.rechts)
                Else
                    _eb.weicheSchalten(17, Klassen.WeichenRichtung.links)
                End If
            End If
            ' ***
            ' *** Betriebsart 2 - 0
            ' ***
            If Betriebsart12 = 2 And Betriebsart34 = 0 Then
                If _Betriebsart2_0Var = 0 Then
                    Startpunkt = 101
                    Zeile = Startpunkt + _Route_Gleis2
                Else
                    Zeile = 356
                End If

                NumericUpDown8.BackColor = Drawing.Color.White
                NumericUpDown9.BackColor = Drawing.Color.LightBlue
                NumericUpDown10.BackColor = Drawing.Color.White
                NumericUpDown11.BackColor = Drawing.Color.White
                Startzug = 2
                _daten.write_to_table(AutomatikParameterTableName, 43, Startzug)

            End If
            ' ***
            ' *** Betriebsart 2 - 3
            ' ***
            If Betriebsart12 = 2 And Betriebsart34 = 3 Then
                Startpunkt = 105
                Zeile = Startpunkt + (4 * _Route_Gleis2) + _Route_Gleis3

                If Startzug = 3 Then
                    _eb.weicheSchalten(23, Klassen.WeichenRichtung.rechts)
                    If _Route_Gleis2 = 1 Then
                        If _Route_Gleis3 = 0 Then
                            _eb.weicheSchalten(27, Klassen.WeichenRichtung.links)
                        Else
                            _eb.weicheSchalten(27, Klassen.WeichenRichtung.rechts)
                        End If
                    End If
                Else
                    NumericUpDown8.BackColor = Drawing.Color.White
                    NumericUpDown9.BackColor = Drawing.Color.LightBlue
                    NumericUpDown10.BackColor = Drawing.Color.White
                    NumericUpDown11.BackColor = Drawing.Color.White
                    Startzug = 2
                    _daten.write_to_table(AutomatikParameterTableName, 43, Startzug)
                    _eb.weicheSchalten(23, Klassen.WeichenRichtung.links)
                    If _Route_Gleis2 = 1 Then
                        _eb.weicheSchalten(27, Klassen.WeichenRichtung.rechts)
                    End If
                End If
            End If
            ' ***
            ' *** Betriebsart 2 - 4
            ' ***
            If Betriebsart12 = 2 And Betriebsart34 = 4 Then
                Startpunkt = 117
                Zeile = Startpunkt + (4 * _Route_Gleis2) + _Route_Gleis4

                If Startzug = 4 Then
                    _eb.weicheSchalten(23, Klassen.WeichenRichtung.rechts)
                    If _Route_Gleis2 = 1 Then
                        If _Route_Gleis4 = 0 Then
                            _eb.weicheSchalten(27, Klassen.WeichenRichtung.links)
                        Else
                            _eb.weicheSchalten(27, Klassen.WeichenRichtung.rechts)
                        End If
                    End If
                Else
                    NumericUpDown8.BackColor = Drawing.Color.White
                    NumericUpDown9.BackColor = Drawing.Color.LightBlue
                    NumericUpDown10.BackColor = Drawing.Color.White
                    NumericUpDown11.BackColor = Drawing.Color.White
                    Startzug = 2
                    _daten.write_to_table(AutomatikParameterTableName, 43, Startzug)
                    _eb.weicheSchalten(23, Klassen.WeichenRichtung.links)
                    If _Route_Gleis2 = 1 Then
                        _eb.weicheSchalten(27, Klassen.WeichenRichtung.rechts)
                    End If
                End If
            End If
            ' ***
            ' *** Betriebsart 2 - 5
            ' ***
            If Betriebsart12 = 2 And Betriebsart34 = 5 Then
                Startpunkt = 129
                Zeile = Startpunkt + (12 * _Route_Gleis2) + (4 * _Route_Gleis3) + _Route_Gleis4

                If Startzug = 4 Then
                    _eb.weicheSchalten(20, Klassen.WeichenRichtung.rechts)
                    If _Route_Gleis4 = 0 Then
                        _eb.weicheSchalten(27, Klassen.WeichenRichtung.links)
                    Else
                        _eb.weicheSchalten(27, Klassen.WeichenRichtung.rechts)
                    End If
                ElseIf Startzug = 3 Then
                    _eb.weicheSchalten(20, Klassen.WeichenRichtung.links)
                    If _Route_Gleis3 = 0 Then
                        _eb.weicheSchalten(27, Klassen.WeichenRichtung.links)
                    Else
                        _eb.weicheSchalten(27, Klassen.WeichenRichtung.rechts)
                    End If
                Else
                    NumericUpDown8.BackColor = Drawing.Color.White
                    NumericUpDown9.BackColor = Drawing.Color.LightBlue
                    NumericUpDown10.BackColor = Drawing.Color.White
                    NumericUpDown11.BackColor = Drawing.Color.White
                    Startzug = 2
                    _daten.write_to_table(AutomatikParameterTableName, 43, Startzug)
                    _eb.weicheSchalten(20, Klassen.WeichenRichtung.links)
                    If _Route_Gleis3 = 0 And _Route_Gleis4 = 0 Then
                        If _Route_Gleis2 = 0 Then
                            _eb.weicheSchalten(27, Klassen.WeichenRichtung.links)
                        Else
                            _eb.weicheSchalten(27, Klassen.WeichenRichtung.rechts)
                        End If
                    Else
                        _eb.weicheSchalten(27, Klassen.WeichenRichtung.rechts)

                    End If
                End If
                If _Route_Gleis2 = 1 Then
                    _eb.weicheSchalten(17, Klassen.WeichenRichtung.rechts)
                Else
                    _eb.weicheSchalten(17, Klassen.WeichenRichtung.links)
                End If
            End If
            ' ***
            ' *** Betriebsart 3 - 0
            ' ***
            If Betriebsart12 = 3 And Betriebsart34 = 0 Then
                If _Betriebsart3_0Var = 0 Then
                    Startpunkt = 165
                    Zeile = Startpunkt + (4 * _Route_Gleis1) + _Route_Gleis2

                    If Startzug = 2 Then
                    Else
                        NumericUpDown8.BackColor = Drawing.Color.LightBlue
                        NumericUpDown9.BackColor = Drawing.Color.White
                        NumericUpDown10.BackColor = Drawing.Color.White
                        NumericUpDown11.BackColor = Drawing.Color.White
                        Startzug = 1
                        _daten.write_to_table(AutomatikParameterTableName, 43, Startzug)
                    End If
                    If Startzug = 2 Then
                        If _Route_Gleis2 = 1 Then
                            _eb.weicheSchalten(17, Klassen.WeichenRichtung.rechts)
                        Else
                            _eb.weicheSchalten(17, Klassen.WeichenRichtung.links)
                        End If
                        _eb.weicheSchalten(19, Klassen.WeichenRichtung.rechts)
                        _eb.weicheSchalten(21, Klassen.WeichenRichtung.links)
                    Else
                        If _Route_Gleis1 = 1 Then
                            _eb.weicheSchalten(17, Klassen.WeichenRichtung.rechts)
                        Else
                            _eb.weicheSchalten(17, Klassen.WeichenRichtung.links)
                        End If
                        _eb.weicheSchalten(19, Klassen.WeichenRichtung.links)
                        _eb.weicheSchalten(21, Klassen.WeichenRichtung.rechts)
                    End If
                ElseIf _Betriebsart3_0Var = 1 Then
                    Zeile = 361
                    NumericUpDown8.BackColor = Drawing.Color.LightBlue
                    NumericUpDown9.BackColor = Drawing.Color.White
                    NumericUpDown10.BackColor = Drawing.Color.White
                    NumericUpDown11.BackColor = Drawing.Color.White
                    Startzug = 1
                    _daten.write_to_table(AutomatikParameterTableName, 43, Startzug)
                    _eb.weicheSchalten(13, Klassen.WeichenRichtung.links)
                    _eb.weicheSchalten(14, Klassen.WeichenRichtung.links)
                    If _Route_Gleis1 = 1 Then
                        _eb.weicheSchalten(17, Klassen.WeichenRichtung.rechts)
                    Else
                        _eb.weicheSchalten(17, Klassen.WeichenRichtung.links)
                    End If
                Else
                    Zeile = 357
                    If Startzug = 1 Then
                        _eb.weicheSchalten(23, Klassen.WeichenRichtung.links)
                    Else
                        _eb.weicheSchalten(23, Klassen.WeichenRichtung.rechts)
                    End If
                End If
            End If
            ' ***
            ' *** Betriebsart 3 - 3
            ' ***
            If Betriebsart12 = 3 And Betriebsart34 = 3 Then
                Startpunkt = 177
                Zeile = Startpunkt + (12 * _Route_Gleis1) + (4 * _Route_Gleis2) + _Route_Gleis3

                If Startzug = 2 Or Startzug = 3 Then
                Else
                    NumericUpDown8.BackColor = Drawing.Color.LightBlue
                    NumericUpDown9.BackColor = Drawing.Color.White
                    NumericUpDown10.BackColor = Drawing.Color.White
                    NumericUpDown11.BackColor = Drawing.Color.White
                    Startzug = 1
                    _daten.write_to_table(AutomatikParameterTableName, 43, Startzug)
                End If

                If Startzug = 1 Then
                    _eb.weicheSchalten(19, Klassen.WeichenRichtung.links)
                    _eb.weicheSchalten(21, Klassen.WeichenRichtung.rechts)
                    _eb.weicheSchalten(23, Klassen.WeichenRichtung.links)
                    If _Route_Gleis1 = 0 Or _Route_Gleis1 = 2 Then
                        _eb.weicheSchalten(17, Klassen.WeichenRichtung.links)
                    Else
                        _eb.weicheSchalten(17, Klassen.WeichenRichtung.rechts)
                    End If
                ElseIf Startzug = 2 Then
                    _eb.weicheSchalten(19, Klassen.WeichenRichtung.rechts)
                    _eb.weicheSchalten(21, Klassen.WeichenRichtung.links)
                    _eb.weicheSchalten(23, Klassen.WeichenRichtung.links)
                    If _Route_Gleis2 = 0 Or _Route_Gleis2 = 2 Then
                        _eb.weicheSchalten(17, Klassen.WeichenRichtung.links)
                    Else
                        _eb.weicheSchalten(17, Klassen.WeichenRichtung.rechts)
                    End If
                ElseIf Startzug = 3 Then
                    _eb.weicheSchalten(17, Klassen.WeichenRichtung.links)
                    _eb.weicheSchalten(23, Klassen.WeichenRichtung.rechts)
                End If

                If _Route_Gleis3 = 0 Or _Route_Gleis3 = 2 Then
                    _eb.weicheSchalten(27, Klassen.WeichenRichtung.rechts)
                Else
                    _eb.weicheSchalten(27, Klassen.WeichenRichtung.links)
                End If

            End If
            ' ***
            ' *** Betriebsart 3 - 4
            ' ***
            If Betriebsart12 = 3 And Betriebsart34 = 4 Then
                Startpunkt = 213
                Zeile = Startpunkt + (12 * _Route_Gleis1) + (4 * _Route_Gleis2) + _Route_Gleis4

                If Startzug = 2 Or Startzug = 4 Then
                Else
                    NumericUpDown8.BackColor = Drawing.Color.LightBlue
                    NumericUpDown9.BackColor = Drawing.Color.White
                    NumericUpDown10.BackColor = Drawing.Color.White
                    NumericUpDown11.BackColor = Drawing.Color.White
                    Startzug = 1
                    _daten.write_to_table(AutomatikParameterTableName, 43, Startzug)
                End If

                If Startzug = 1 Then
                    _eb.weicheSchalten(19, Klassen.WeichenRichtung.links)
                    _eb.weicheSchalten(21, Klassen.WeichenRichtung.rechts)
                    _eb.weicheSchalten(23, Klassen.WeichenRichtung.links)
                    If _Route_Gleis1 = 0 Or _Route_Gleis1 = 2 Then
                        _eb.weicheSchalten(17, Klassen.WeichenRichtung.links)
                    Else
                        _eb.weicheSchalten(17, Klassen.WeichenRichtung.rechts)
                    End If
                ElseIf Startzug = 2 Then
                    _eb.weicheSchalten(19, Klassen.WeichenRichtung.rechts)
                    _eb.weicheSchalten(21, Klassen.WeichenRichtung.links)
                    _eb.weicheSchalten(23, Klassen.WeichenRichtung.links)
                    If _Route_Gleis2 = 0 Or _Route_Gleis2 = 2 Then
                        _eb.weicheSchalten(17, Klassen.WeichenRichtung.links)
                    Else
                        _eb.weicheSchalten(17, Klassen.WeichenRichtung.rechts)
                    End If
                ElseIf Startzug = 4 Then
                    _eb.weicheSchalten(17, Klassen.WeichenRichtung.links)
                    _eb.weicheSchalten(23, Klassen.WeichenRichtung.rechts)
                End If

                If _Route_Gleis4 = 0 Or _Route_Gleis4 = 2 Then
                    _eb.weicheSchalten(27, Klassen.WeichenRichtung.rechts)
                Else
                    _eb.weicheSchalten(27, Klassen.WeichenRichtung.links)
                End If
            End If
            ' ***
            ' *** Betriebsart 3 - 5
            ' ***
            If Betriebsart12 = 3 And Betriebsart34 = 5 Then
                Startpunkt = 249
                Zeile = Startpunkt + (36 * _Route_Gleis1) + (12 * _Route_Gleis2) + (4 * _Route_Gleis3) + _Route_Gleis4

                If Startzug = 1 Then
                    If _Route_Gleis1 = 0 Then
                        _eb.weicheSchalten(17, Klassen.WeichenRichtung.links)
                        If _Route_Gleis3 = 0 And _Route_Gleis4 = 0 Then
                            _eb.weicheSchalten(27, Klassen.WeichenRichtung.links)
                        Else
                            _eb.weicheSchalten(27, Klassen.WeichenRichtung.rechts)
                        End If
                    ElseIf _Route_Gleis1 = 1 Then
                        _eb.weicheSchalten(17, Klassen.WeichenRichtung.rechts)
                        _eb.weicheSchalten(27, Klassen.WeichenRichtung.rechts)
                    ElseIf _Route_Gleis1 = 2 Then
                        _eb.weicheSchalten(17, Klassen.WeichenRichtung.links)
                        _eb.weicheSchalten(27, Klassen.WeichenRichtung.rechts)
                    End If
                    _eb.weicheSchalten(20, Klassen.WeichenRichtung.links)
                    _eb.weicheSchalten(21, Klassen.WeichenRichtung.rechts)
                ElseIf Startzug = 2 Then
                    If _Route_Gleis2 = 0 Then
                        _eb.weicheSchalten(17, Klassen.WeichenRichtung.links)
                        If _Route_Gleis3 = 0 And _Route_Gleis4 = 0 Then
                            _eb.weicheSchalten(27, Klassen.WeichenRichtung.links)
                        Else
                            _eb.weicheSchalten(27, Klassen.WeichenRichtung.rechts)
                        End If
                    ElseIf _Route_Gleis2 = 1 Then
                        _eb.weicheSchalten(17, Klassen.WeichenRichtung.rechts)
                        _eb.weicheSchalten(27, Klassen.WeichenRichtung.rechts)
                    ElseIf _Route_Gleis2 = 2 Then
                        _eb.weicheSchalten(17, Klassen.WeichenRichtung.links)
                        _eb.weicheSchalten(27, Klassen.WeichenRichtung.rechts)
                    End If
                    _eb.weicheSchalten(20, Klassen.WeichenRichtung.links)
                    _eb.weicheSchalten(21, Klassen.WeichenRichtung.links)
                ElseIf Startzug = 3 Then
                    _eb.weicheSchalten(20, Klassen.WeichenRichtung.links)
                    _eb.weicheSchalten(21, Klassen.WeichenRichtung.links)
                    If _Route_Gleis3 = 0 Then
                        If _Route_Gleis1 = 1 And _Route_Gleis2 = 1 Then
                            _eb.weicheSchalten(17, Klassen.WeichenRichtung.rechts)
                        Else
                            _eb.weicheSchalten(27, Klassen.WeichenRichtung.links)
                        End If
                        _eb.weicheSchalten(27, Klassen.WeichenRichtung.links)
                    ElseIf _Route_Gleis3 = 1 Then
                        If _Route_Gleis1 = 1 And _Route_Gleis2 = 1 Then
                            _eb.weicheSchalten(17, Klassen.WeichenRichtung.rechts)
                        Else
                            _eb.weicheSchalten(27, Klassen.WeichenRichtung.links)
                        End If
                        _eb.weicheSchalten(27, Klassen.WeichenRichtung.rechts)
                    ElseIf _Route_Gleis3 = 2 Then
                        _eb.weicheSchalten(17, Klassen.WeichenRichtung.rechts)
                        _eb.weicheSchalten(27, Klassen.WeichenRichtung.rechts)
                    End If
                ElseIf Startzug = 4 Then
                    _eb.weicheSchalten(20, Klassen.WeichenRichtung.rechts)
                    _eb.weicheSchalten(21, Klassen.WeichenRichtung.links)
                    If _Route_Gleis4 = 0 Then
                        If _Route_Gleis1 = 1 And _Route_Gleis2 = 1 Then
                            _eb.weicheSchalten(17, Klassen.WeichenRichtung.rechts)
                        Else
                            _eb.weicheSchalten(27, Klassen.WeichenRichtung.links)
                        End If
                        _eb.weicheSchalten(27, Klassen.WeichenRichtung.links)
                    ElseIf _Route_Gleis4 = 1 Then
                        If _Route_Gleis1 = 1 And _Route_Gleis2 = 1 Then
                            _eb.weicheSchalten(17, Klassen.WeichenRichtung.rechts)
                        Else
                            _eb.weicheSchalten(27, Klassen.WeichenRichtung.links)
                        End If
                        _eb.weicheSchalten(27, Klassen.WeichenRichtung.rechts)
                    ElseIf _Route_Gleis4 = 2 Then
                        _eb.weicheSchalten(27, Klassen.WeichenRichtung.rechts)
                    End If
                End If

            End If

            If Zeile > 0 Then
                AutomatikParameter = Betriebsparameter.GetValue("Weichenparameter", 1, Zeile)
                Weiche13schalten = WeichenStellen(13, Zeile)
                Weiche14schalten = WeichenStellen(14, Zeile)
                Weiche15schalten = WeichenStellen(15, Zeile)
                Weiche16schalten = WeichenStellen(16, Zeile)
                Weiche17schalten = WeichenStellen(17, Zeile)
                Weiche18schalten = WeichenStellen(18, Zeile)
                Weiche19schalten = WeichenStellen(19, Zeile)
                Weiche20schalten = WeichenStellen(20, Zeile)
                Weiche21schalten = WeichenStellen(21, Zeile)
                Weiche22schalten = WeichenStellen(22, Zeile)
                Weiche23schalten = WeichenStellen(23, Zeile)
                Weiche24schalten = WeichenStellen(24, Zeile)
                Weiche25schalten = WeichenStellen(25, Zeile)
                Weiche26schalten = WeichenStellen(26, Zeile)
                Weiche27schalten = WeichenStellen(27, Zeile)
            End If

            _Weichen_initialisiert = True
            _Weichen_in_Startposition = True

        End If
        If Betriebsart = 3 Then
            _eb.weicheSchalten(20, Klassen.WeichenRichtung.links)
            _eb.weicheSchalten(22, Klassen.WeichenRichtung.rechts)
            If Startzug = 2 Then
                _eb.weicheSchalten(20, Klassen.WeichenRichtung.links)
                _eb.weicheSchalten(22, Klassen.WeichenRichtung.rechts)
                WeichenInStartPositionLok2()
            ElseIf Startzug = 3 Then
                _eb.weicheSchalten(19, Klassen.WeichenRichtung.links)
                _eb.weicheSchalten(21, Klassen.WeichenRichtung.rechts)
                WeichenInStartPositionLok3()
            ElseIf Startzug = 4 Then
                _eb.weicheSchalten(19, Klassen.WeichenRichtung.links)
                _eb.weicheSchalten(21, Klassen.WeichenRichtung.rechts)
                WeichenInStartPositionLok4()
            Else
                _eb.weicheSchalten(20, Klassen.WeichenRichtung.links)
                _eb.weicheSchalten(22, Klassen.WeichenRichtung.rechts)
                WeichenInStartPositionLok1()
            End If
            _Weichen_initialisiert = True
            _Weichen_in_Startposition = True
        End If
        TextBox1.Text = "Die Weichen befinden sich in Startposition für die ausgewählte Automatik. Nächster Schritt: Signale in Startposition bringen."
    End Sub
    Private Sub Button42_Click(sender As System.Object, e As System.EventArgs) Handles Button42.Click
        _LokStufen.Senden(0)
        _Signale_in_Startposition = False
        If Betriebsart = 1 Then
            If Betriebsart12 = 0 And Betriebsart34 = 0 Then
                ' *** dient der Initialisierung der Signale wenn kein Automatikbetrieb verwendet wird
                _eb.weicheSchalten(1, Klassen.WeichenRichtung.links)
                _eb.weicheSchalten(2, Klassen.WeichenRichtung.links)
                _eb.weicheSchalten(3, Klassen.WeichenRichtung.links)
                _eb.weicheSchalten(4, Klassen.WeichenRichtung.links)
                _eb.weicheSchalten(5, Klassen.WeichenRichtung.links)
                _eb.weicheSchalten(6, Klassen.WeichenRichtung.links)
                _eb.weicheSchalten(7, Klassen.WeichenRichtung.links)
                _eb.weicheSchalten(8, Klassen.WeichenRichtung.links)
                _eb.weicheSchalten(9, Klassen.WeichenRichtung.links)
                _eb.weicheSchalten(10, Klassen.WeichenRichtung.links)
                _eb.weicheSchalten(11, Klassen.WeichenRichtung.links)
                _eb.weicheSchalten(12, Klassen.WeichenRichtung.links)
            End If
            _eb.weicheSchalten(9, Klassen.WeichenRichtung.links)
            _eb.weicheSchalten(11, Klassen.WeichenRichtung.links)
            _eb.weicheSchalten(12, Klassen.WeichenRichtung.rechts)
            _eb.weicheSchalten(10, Klassen.WeichenRichtung.rechts)
            If Betriebsart12 = 0 Then
                _eb.weicheSchalten(5, Klassen.WeichenRichtung.rechts)
                _eb.weicheSchalten(6, Klassen.WeichenRichtung.rechts)
                _eb.weicheSchalten(7, Klassen.WeichenRichtung.rechts)
                _eb.weicheSchalten(8, Klassen.WeichenRichtung.rechts)
            End If
            If Betriebsart12 = 1 Then
                _eb.weicheSchalten(5, Klassen.WeichenRichtung.links)
                _eb.weicheSchalten(6, Klassen.WeichenRichtung.links)
                _eb.weicheSchalten(7, Klassen.WeichenRichtung.rechts)
                _eb.weicheSchalten(8, Klassen.WeichenRichtung.rechts)
            End If
            If Betriebsart12 = 2 Then
                _eb.weicheSchalten(5, Klassen.WeichenRichtung.rechts)
                _eb.weicheSchalten(6, Klassen.WeichenRichtung.rechts)
                _eb.weicheSchalten(7, Klassen.WeichenRichtung.links)
                _eb.weicheSchalten(8, Klassen.WeichenRichtung.links)
            End If
            If Betriebsart12 = 3 Then
                _eb.weicheSchalten(5, Klassen.WeichenRichtung.links)
                _eb.weicheSchalten(6, Klassen.WeichenRichtung.links)
                _eb.weicheSchalten(7, Klassen.WeichenRichtung.links)
                _eb.weicheSchalten(8, Klassen.WeichenRichtung.links)
            End If
            If Betriebsart34 = 0 Then
                _eb.weicheSchalten(1, Klassen.WeichenRichtung.rechts)
                _eb.weicheSchalten(2, Klassen.WeichenRichtung.rechts)
                _eb.weicheSchalten(3, Klassen.WeichenRichtung.rechts)
                _eb.weicheSchalten(4, Klassen.WeichenRichtung.rechts)
            End If
            If Betriebsart34 = 3 Then
                _eb.weicheSchalten(1, Klassen.WeichenRichtung.links)
                _eb.weicheSchalten(2, Klassen.WeichenRichtung.links)
                _eb.weicheSchalten(3, Klassen.WeichenRichtung.rechts)
                _eb.weicheSchalten(4, Klassen.WeichenRichtung.rechts)
            End If
            If Betriebsart34 = 4 Then
                _eb.weicheSchalten(1, Klassen.WeichenRichtung.rechts)
                _eb.weicheSchalten(2, Klassen.WeichenRichtung.rechts)
                _eb.weicheSchalten(3, Klassen.WeichenRichtung.links)
                _eb.weicheSchalten(4, Klassen.WeichenRichtung.links)
            End If
            If Betriebsart34 = 5 Then
                _eb.weicheSchalten(1, Klassen.WeichenRichtung.links)
                _eb.weicheSchalten(2, Klassen.WeichenRichtung.links)
                _eb.weicheSchalten(3, Klassen.WeichenRichtung.links)
                _eb.weicheSchalten(4, Klassen.WeichenRichtung.links)
            End If
            _Signale_in_Startposition = True
            _Signale_initialisiert = True
            TextBox1.Text = "Die Signale befinden sich in Startposition für die ausgewählte Automatik. Nächster Schritt: Starten."
        End If

        If Betriebsart = 2 Then
            If Betriebsart12 = 0 And Betriebsart34 = 0 Then
                ' *** dient der Initialisierung der Signale wenn kein Automatikbetrieb verwendet wird
                _eb.weicheSchalten(1, Klassen.WeichenRichtung.links)
                _eb.weicheSchalten(2, Klassen.WeichenRichtung.links)
                _eb.weicheSchalten(3, Klassen.WeichenRichtung.links)
                _eb.weicheSchalten(4, Klassen.WeichenRichtung.links)
                _eb.weicheSchalten(5, Klassen.WeichenRichtung.links)
                _eb.weicheSchalten(6, Klassen.WeichenRichtung.links)
                _eb.weicheSchalten(7, Klassen.WeichenRichtung.links)
                _eb.weicheSchalten(8, Klassen.WeichenRichtung.links)
                _eb.weicheSchalten(9, Klassen.WeichenRichtung.links)
                _eb.weicheSchalten(10, Klassen.WeichenRichtung.links)
                _eb.weicheSchalten(11, Klassen.WeichenRichtung.links)
                _eb.weicheSchalten(12, Klassen.WeichenRichtung.links)
            End If
            If Betriebsart12 = 0 And Betriebsart34 = 3 Then
                If _Betriebsart0_3Var = 0 Then
                    If _Bhf_Gleis3 = 1 Or _Bhf_Gleis3 = 2 Or _Bhf_Gleis3 = 4 Then
                        _Bhf_Gleis3 = 3
                        Button33.Text = "Halt"
                        _daten.write_to_table(AutomatikParameterTableName, 9, _Bhf_Gleis3)
                    End If
                    If _SBhf_Gleis3 = 1 Or _SBhf_Gleis3 = 2 Or _SBhf_Gleis3 = 4 Then
                        _SBhf_Gleis3 = 3
                        Button53.Text = "Halt"
                        _daten.write_to_table(AutomatikParameterTableName, 24, _SBhf_Gleis3)
                    End If
                    If _Bhf2_Gleis3 = 1 Or _Bhf2_Gleis3 = 2 Or _Bhf2_Gleis3 = 4 Then
                        _Bhf2_Gleis3 = 3
                        Button73.Text = "Halt"
                        _daten.write_to_table(AutomatikParameterTableName, 32, _Bhf2_Gleis3)
                    End If
                    _eb.weicheSchalten(1, Klassen.WeichenRichtung.links)
                    _eb.weicheSchalten(2, Klassen.WeichenRichtung.links)
                    _eb.weicheSchalten(3, Klassen.WeichenRichtung.rechts)
                    _eb.weicheSchalten(4, Klassen.WeichenRichtung.rechts)
                    _eb.weicheSchalten(5, Klassen.WeichenRichtung.rechts)
                    _eb.weicheSchalten(6, Klassen.WeichenRichtung.rechts)
                    _eb.weicheSchalten(7, Klassen.WeichenRichtung.rechts)
                    _eb.weicheSchalten(8, Klassen.WeichenRichtung.rechts)
                    If _Route_Gleis3 = 0 Then
                        _eb.weicheSchalten(9, Klassen.WeichenRichtung.links)
                        _eb.weicheSchalten(10, Klassen.WeichenRichtung.rechts)
                        _eb.weicheSchalten(11, Klassen.WeichenRichtung.rechts)
                        _eb.weicheSchalten(12, Klassen.WeichenRichtung.rechts)
                    ElseIf _Route_Gleis3 = 1 Then
                        _eb.weicheSchalten(9, Klassen.WeichenRichtung.rechts)
                        _eb.weicheSchalten(10, Klassen.WeichenRichtung.links)
                        _eb.weicheSchalten(11, Klassen.WeichenRichtung.rechts)
                        _eb.weicheSchalten(12, Klassen.WeichenRichtung.links)
                    ElseIf _Route_Gleis3 = 2 Then
                        _eb.weicheSchalten(9, Klassen.WeichenRichtung.links)
                        _eb.weicheSchalten(10, Klassen.WeichenRichtung.links)
                        _eb.weicheSchalten(11, Klassen.WeichenRichtung.links)
                        _eb.weicheSchalten(12, Klassen.WeichenRichtung.links)
                    End If
                Else
                    _eb.weicheSchalten(1, Klassen.WeichenRichtung.links)
                    _eb.weicheSchalten(2, Klassen.WeichenRichtung.links)
                    _eb.weicheSchalten(3, Klassen.WeichenRichtung.rechts)
                    _eb.weicheSchalten(4, Klassen.WeichenRichtung.rechts)
                    _eb.weicheSchalten(5, Klassen.WeichenRichtung.rechts)
                    _eb.weicheSchalten(6, Klassen.WeichenRichtung.rechts)
                    _eb.weicheSchalten(7, Klassen.WeichenRichtung.rechts)
                    _eb.weicheSchalten(8, Klassen.WeichenRichtung.rechts)
                    _eb.weicheSchalten(9, Klassen.WeichenRichtung.rechts)
                    _eb.weicheSchalten(10, Klassen.WeichenRichtung.links)
                    _eb.weicheSchalten(11, Klassen.WeichenRichtung.links)
                    _eb.weicheSchalten(12, Klassen.WeichenRichtung.links)
                End If
            End If

            If Betriebsart12 = 0 And Betriebsart34 = 4 Then
                If _Betriebsart0_4Var = 0 Then
                    If _Bhf_Gleis4 = 1 Or _Bhf_Gleis4 = 2 Or _Bhf_Gleis4 = 3 Then
                        _Bhf_Gleis4 = 4
                        Button34.Text = "Halt"
                        _daten.write_to_table(AutomatikParameterTableName, 10, _Bhf_Gleis4)
                    End If
                    If _SBhf_Gleis4 = 1 Or _SBhf_Gleis4 = 2 Or _SBhf_Gleis4 = 3 Then
                        _SBhf_Gleis4 = 4
                        Button54.Text = "Halt"
                        _daten.write_to_table(AutomatikParameterTableName, 25, _SBhf_Gleis4)
                    End If
                    If _Bhf2_Gleis4 = 1 Or _Bhf2_Gleis4 = 2 Or _Bhf2_Gleis4 = 3 Then
                        _Bhf2_Gleis4 = 4
                        Button74.Text = "Halt"
                        _daten.write_to_table(AutomatikParameterTableName, 33, _Bhf2_Gleis4)
                    End If
                    _eb.weicheSchalten(1, Klassen.WeichenRichtung.rechts)
                    _eb.weicheSchalten(2, Klassen.WeichenRichtung.rechts)
                    _eb.weicheSchalten(3, Klassen.WeichenRichtung.links)
                    _eb.weicheSchalten(4, Klassen.WeichenRichtung.links)
                    _eb.weicheSchalten(5, Klassen.WeichenRichtung.rechts)
                    _eb.weicheSchalten(6, Klassen.WeichenRichtung.rechts)
                    _eb.weicheSchalten(7, Klassen.WeichenRichtung.rechts)
                    _eb.weicheSchalten(8, Klassen.WeichenRichtung.rechts)
                    If _Route_Gleis4 = 0 Then
                        _eb.weicheSchalten(9, Klassen.WeichenRichtung.links)
                        _eb.weicheSchalten(10, Klassen.WeichenRichtung.rechts)
                        _eb.weicheSchalten(11, Klassen.WeichenRichtung.rechts)
                        _eb.weicheSchalten(12, Klassen.WeichenRichtung.rechts)
                    ElseIf _Route_Gleis4 = 1 Then
                        _eb.weicheSchalten(9, Klassen.WeichenRichtung.rechts)
                        _eb.weicheSchalten(10, Klassen.WeichenRichtung.links)
                        _eb.weicheSchalten(11, Klassen.WeichenRichtung.rechts)
                        _eb.weicheSchalten(12, Klassen.WeichenRichtung.links)
                    ElseIf _Route_Gleis4 = 2 Then
                        _eb.weicheSchalten(9, Klassen.WeichenRichtung.links)
                        _eb.weicheSchalten(10, Klassen.WeichenRichtung.links)
                        _eb.weicheSchalten(11, Klassen.WeichenRichtung.rechts)
                        _eb.weicheSchalten(12, Klassen.WeichenRichtung.links)
                    End If
                ElseIf _Betriebsart0_4Var = 1 Then
                    _eb.weicheSchalten(1, Klassen.WeichenRichtung.rechts)
                    _eb.weicheSchalten(2, Klassen.WeichenRichtung.rechts)
                    _eb.weicheSchalten(3, Klassen.WeichenRichtung.links)
                    _eb.weicheSchalten(4, Klassen.WeichenRichtung.links)
                    _eb.weicheSchalten(5, Klassen.WeichenRichtung.rechts)
                    _eb.weicheSchalten(6, Klassen.WeichenRichtung.rechts)
                    _eb.weicheSchalten(7, Klassen.WeichenRichtung.rechts)
                    _eb.weicheSchalten(8, Klassen.WeichenRichtung.rechts)
                    _eb.weicheSchalten(9, Klassen.WeichenRichtung.rechts)
                    _eb.weicheSchalten(10, Klassen.WeichenRichtung.links)
                    _eb.weicheSchalten(11, Klassen.WeichenRichtung.links)
                    _eb.weicheSchalten(12, Klassen.WeichenRichtung.links)
                Else
                    _eb.weicheSchalten(1, Klassen.WeichenRichtung.links)
                    _eb.weicheSchalten(2, Klassen.WeichenRichtung.links)
                    _eb.weicheSchalten(3, Klassen.WeichenRichtung.rechts)
                    _eb.weicheSchalten(4, Klassen.WeichenRichtung.rechts)
                    _eb.weicheSchalten(5, Klassen.WeichenRichtung.rechts)
                    _eb.weicheSchalten(6, Klassen.WeichenRichtung.rechts)
                    _eb.weicheSchalten(7, Klassen.WeichenRichtung.rechts)
                    _eb.weicheSchalten(8, Klassen.WeichenRichtung.rechts)
                    _eb.weicheSchalten(9, Klassen.WeichenRichtung.rechts)
                    _eb.weicheSchalten(10, Klassen.WeichenRichtung.links)
                    _eb.weicheSchalten(11, Klassen.WeichenRichtung.links)
                    _eb.weicheSchalten(12, Klassen.WeichenRichtung.links)
                End If
            End If
            If Betriebsart12 = 0 And Betriebsart34 = 5 Then
                If _Bhf_Gleis3 = 1 Or _Bhf_Gleis3 = 2 Then
                    _Bhf_Gleis3 = 3
                    Button33.Text = "Halt"
                    _daten.write_to_table(AutomatikParameterTableName, 9, _Bhf_Gleis3)
                End If
                If _SBhf_Gleis3 = 1 Or _SBhf_Gleis3 = 2 Then
                    _SBhf_Gleis3 = 3
                    Button53.Text = "Halt"
                    _daten.write_to_table(AutomatikParameterTableName, 24, _SBhf_Gleis3)
                End If
                If _Bhf2_Gleis3 = 1 Or _Bhf2_Gleis3 = 2 Then
                    _Bhf2_Gleis3 = 3
                    Button73.Text = "Halt"
                    _daten.write_to_table(AutomatikParameterTableName, 32, _Bhf2_Gleis3)
                End If
                If _Bhf_Gleis4 = 1 Or _Bhf_Gleis4 = 2 Then
                    _Bhf_Gleis4 = 4
                    Button34.Text = "Halt"
                    _daten.write_to_table(AutomatikParameterTableName, 10, _Bhf_Gleis4)
                End If
                If _SBhf_Gleis4 = 1 Or _SBhf_Gleis4 = 2 Then
                    _SBhf_Gleis4 = 4
                    Button54.Text = "Halt"
                    _daten.write_to_table(AutomatikParameterTableName, 25, _SBhf_Gleis4)
                End If
                If _Bhf2_Gleis4 = 1 Or _Bhf2_Gleis4 = 2 Then
                    _Bhf2_Gleis4 = 4
                    Button74.Text = "Halt"
                    _daten.write_to_table(AutomatikParameterTableName, 33, _Bhf2_Gleis4)
                End If
                If _Route_Gleis3 = 0 Or _Route_Gleis3 = 2 Then
                    If _SBhf_Gleis3 = 2 Then
                        _Route_Gleis4 = 1
                        _daten.write_to_table(AutomatikParameterTableName, 6, _Route_Gleis4)
                        Button24.Text = "Obn k"
                    End If
                End If
                ButtonsVisible(999)


                If _Betriebsart0_5Var = 0 Then
                    _eb.weicheSchalten(1, Klassen.WeichenRichtung.links)
                    _eb.weicheSchalten(2, Klassen.WeichenRichtung.links)
                    _eb.weicheSchalten(3, Klassen.WeichenRichtung.links)
                    _eb.weicheSchalten(4, Klassen.WeichenRichtung.links)
                    _eb.weicheSchalten(5, Klassen.WeichenRichtung.rechts)
                    _eb.weicheSchalten(6, Klassen.WeichenRichtung.rechts)
                    _eb.weicheSchalten(7, Klassen.WeichenRichtung.rechts)
                    _eb.weicheSchalten(8, Klassen.WeichenRichtung.rechts)
                    _eb.weicheSchalten(9, Klassen.WeichenRichtung.links)
                    _eb.weicheSchalten(10, Klassen.WeichenRichtung.links)
                    _eb.weicheSchalten(11, Klassen.WeichenRichtung.rechts)
                    _eb.weicheSchalten(12, Klassen.WeichenRichtung.links)
                Else
                    _eb.weicheSchalten(1, Klassen.WeichenRichtung.links)
                    _eb.weicheSchalten(2, Klassen.WeichenRichtung.links)
                    _eb.weicheSchalten(3, Klassen.WeichenRichtung.links)
                    _eb.weicheSchalten(4, Klassen.WeichenRichtung.links)
                    _eb.weicheSchalten(5, Klassen.WeichenRichtung.rechts)
                    _eb.weicheSchalten(6, Klassen.WeichenRichtung.rechts)
                    _eb.weicheSchalten(7, Klassen.WeichenRichtung.rechts)
                    _eb.weicheSchalten(8, Klassen.WeichenRichtung.rechts)
                    _eb.weicheSchalten(9, Klassen.WeichenRichtung.rechts)
                    _eb.weicheSchalten(10, Klassen.WeichenRichtung.rechts)
                    _eb.weicheSchalten(11, Klassen.WeichenRichtung.links)
                    _eb.weicheSchalten(12, Klassen.WeichenRichtung.links)
                End If

            End If
            If Betriebsart12 = 1 And Betriebsart34 = 0 Then
                If _Bhf_Gleis1 = 2 Or _Bhf_Gleis1 = 3 Or _Bhf_Gleis1 = 4 Then
                    _Bhf_Gleis1 = 1
                    Button31.Text = "Halt"
                    _daten.write_to_table(AutomatikParameterTableName, 7, _Bhf_Gleis1)
                End If
                If _Bhf2_Gleis1 = 2 Or _Bhf2_Gleis1 = 3 Or _Bhf2_Gleis1 = 4 Then
                    _Bhf2_Gleis1 = 1
                    Button71.Text = "Halt"
                    _daten.write_to_table(AutomatikParameterTableName, 30, _Bhf2_Gleis1)
                End If
                If _SBhf_Gleis1 = 2 Or _SBhf_Gleis1 = 3 Or _SBhf_Gleis1 = 4 Then
                    _SBhf_Gleis1 = 1
                    Button51.Text = "Halt"
                    _daten.write_to_table(AutomatikParameterTableName, 22, _SBhf_Gleis1)
                End If
                _eb.weicheSchalten(1, Klassen.WeichenRichtung.rechts)
                _eb.weicheSchalten(2, Klassen.WeichenRichtung.rechts)
                _eb.weicheSchalten(3, Klassen.WeichenRichtung.rechts)
                _eb.weicheSchalten(4, Klassen.WeichenRichtung.rechts)
                _eb.weicheSchalten(5, Klassen.WeichenRichtung.links)
                _eb.weicheSchalten(6, Klassen.WeichenRichtung.links)
                If _GleisFrei2 = 1 Then
                    _eb.weicheSchalten(7, Klassen.WeichenRichtung.links)
                    _eb.weicheSchalten(8, Klassen.WeichenRichtung.links)
                Else
                    _eb.weicheSchalten(7, Klassen.WeichenRichtung.rechts)
                    _eb.weicheSchalten(8, Klassen.WeichenRichtung.rechts)
                End If
                If _GleisFrei3 = 1 Then
                    _eb.weicheSchalten(1, Klassen.WeichenRichtung.links)
                    _eb.weicheSchalten(2, Klassen.WeichenRichtung.links)
                Else
                    _eb.weicheSchalten(1, Klassen.WeichenRichtung.rechts)
                    _eb.weicheSchalten(2, Klassen.WeichenRichtung.rechts)
                End If
                If _GleisFrei4 = 1 Then
                    _eb.weicheSchalten(3, Klassen.WeichenRichtung.links)
                    _eb.weicheSchalten(4, Klassen.WeichenRichtung.links)
                Else
                    _eb.weicheSchalten(3, Klassen.WeichenRichtung.rechts)
                    _eb.weicheSchalten(4, Klassen.WeichenRichtung.rechts)
                End If
                If _Route_Gleis1 = 0 Then
                    _eb.weicheSchalten(9, Klassen.WeichenRichtung.rechts)
                    _eb.weicheSchalten(10, Klassen.WeichenRichtung.rechts)
                    _eb.weicheSchalten(11, Klassen.WeichenRichtung.links)
                    _eb.weicheSchalten(12, Klassen.WeichenRichtung.rechts)
                ElseIf _Route_Gleis1 = 1 Then
                    _eb.weicheSchalten(9, Klassen.WeichenRichtung.rechts)
                    _eb.weicheSchalten(10, Klassen.WeichenRichtung.links)
                    _eb.weicheSchalten(11, Klassen.WeichenRichtung.rechts)
                    _eb.weicheSchalten(12, Klassen.WeichenRichtung.links)
                ElseIf _Route_Gleis1 = 2 Then
                    _eb.weicheSchalten(9, Klassen.WeichenRichtung.rechts)
                    _eb.weicheSchalten(10, Klassen.WeichenRichtung.links)
                    _eb.weicheSchalten(11, Klassen.WeichenRichtung.links)
                    _eb.weicheSchalten(12, Klassen.WeichenRichtung.links)
                End If
            End If
            If Betriebsart12 = 1 And Betriebsart34 = 3 Then
                If _Bhf_Gleis1 = 2 Or _Bhf_Gleis1 = 4 Then
                    _Bhf_Gleis1 = 1
                    Button31.Text = "Halt"
                    _daten.write_to_table(AutomatikParameterTableName, 7, _Bhf_Gleis1)
                End If
                If _Bhf2_Gleis1 = 2 Or _Bhf2_Gleis1 = 4 Then
                    _Bhf2_Gleis1 = 1
                    Button71.Text = "Halt"
                    _daten.write_to_table(AutomatikParameterTableName, 30, _Bhf2_Gleis1)
                End If
                If _SBhf_Gleis1 = 2 Or _SBhf_Gleis1 = 4 Then
                    _SBhf_Gleis1 = 1
                    Button51.Text = "Halt"
                    _daten.write_to_table(AutomatikParameterTableName, 22, _SBhf_Gleis1)
                End If
                If _Bhf_Gleis3 = 2 Or _Bhf_Gleis3 = 4 Then
                    _Bhf_Gleis3 = 3
                    Button33.Text = "Halt"
                    _daten.write_to_table(AutomatikParameterTableName, 9, _Bhf_Gleis3)
                End If
                If _SBhf_Gleis3 = 2 Or _SBhf_Gleis3 = 4 Then
                    _SBhf_Gleis3 = 3
                    Button53.Text = "Halt"
                    _daten.write_to_table(AutomatikParameterTableName, 24, _SBhf_Gleis3)
                End If
                If _Bhf2_Gleis3 = 2 Or _Bhf2_Gleis3 = 4 Then
                    _Bhf2_Gleis3 = 3
                    Button73.Text = "Halt"
                    _daten.write_to_table(AutomatikParameterTableName, 32, _Bhf2_Gleis3)
                End If
                _eb.weicheSchalten(1, Klassen.WeichenRichtung.links)
                _eb.weicheSchalten(2, Klassen.WeichenRichtung.links)
                _eb.weicheSchalten(3, Klassen.WeichenRichtung.rechts)
                _eb.weicheSchalten(4, Klassen.WeichenRichtung.rechts)
                _eb.weicheSchalten(5, Klassen.WeichenRichtung.links)
                _eb.weicheSchalten(6, Klassen.WeichenRichtung.links)
                _eb.weicheSchalten(7, Klassen.WeichenRichtung.rechts)
                _eb.weicheSchalten(8, Klassen.WeichenRichtung.rechts)
                _eb.weicheSchalten(9, Klassen.WeichenRichtung.links)
                _eb.weicheSchalten(10, Klassen.WeichenRichtung.links)
                _eb.weicheSchalten(11, Klassen.WeichenRichtung.links)
                _eb.weicheSchalten(12, Klassen.WeichenRichtung.links)
            End If
            If Betriebsart12 = 1 And Betriebsart34 = 4 Then
                If _Bhf_Gleis1 = 2 Or _Bhf_Gleis1 = 3 Then
                    _Bhf_Gleis1 = 1
                    Button31.Text = "Halt"
                    _daten.write_to_table(AutomatikParameterTableName, 7, _Bhf_Gleis1)
                End If
                If _Bhf2_Gleis1 = 2 Or _Bhf2_Gleis1 = 3 Then
                    _Bhf2_Gleis1 = 1
                    Button71.Text = "Halt"
                    _daten.write_to_table(AutomatikParameterTableName, 30, _Bhf2_Gleis1)
                End If
                If _SBhf_Gleis1 = 2 Or _SBhf_Gleis1 = 3 Then
                    _SBhf_Gleis1 = 1
                    Button51.Text = "Halt"
                    _daten.write_to_table(AutomatikParameterTableName, 22, _SBhf_Gleis1)
                End If
                If _Bhf_Gleis4 = 2 Or _Bhf_Gleis4 = 3 Then
                    _Bhf_Gleis4 = 4
                    Button34.Text = "Halt"
                    _daten.write_to_table(AutomatikParameterTableName, 10, _Bhf_Gleis4)
                End If
                If _SBhf_Gleis4 = 2 Or _SBhf_Gleis4 = 3 Then
                    _SBhf_Gleis4 = 4
                    Button54.Text = "Halt"
                    _daten.write_to_table(AutomatikParameterTableName, 25, _SBhf_Gleis4)
                End If
                If _Bhf2_Gleis4 = 2 Or _Bhf2_Gleis4 = 3 Then
                    _Bhf2_Gleis4 = 4
                    Button74.Text = "Halt"
                    _daten.write_to_table(AutomatikParameterTableName, 33, _Bhf2_Gleis4)
                End If
                _eb.weicheSchalten(1, Klassen.WeichenRichtung.rechts)
                _eb.weicheSchalten(2, Klassen.WeichenRichtung.rechts)
                _eb.weicheSchalten(3, Klassen.WeichenRichtung.links)
                _eb.weicheSchalten(4, Klassen.WeichenRichtung.links)
                _eb.weicheSchalten(5, Klassen.WeichenRichtung.links)
                _eb.weicheSchalten(6, Klassen.WeichenRichtung.links)
                _eb.weicheSchalten(7, Klassen.WeichenRichtung.rechts)
                _eb.weicheSchalten(8, Klassen.WeichenRichtung.rechts)
                _eb.weicheSchalten(9, Klassen.WeichenRichtung.links)
                _eb.weicheSchalten(10, Klassen.WeichenRichtung.links)
                _eb.weicheSchalten(11, Klassen.WeichenRichtung.links)
                _eb.weicheSchalten(12, Klassen.WeichenRichtung.links)
            End If
            If Betriebsart12 = 1 And Betriebsart34 = 5 Then
                If _Bhf_Gleis1 = 2 Then
                    _Bhf_Gleis1 = 1
                    Button31.Text = "Halt"
                    _daten.write_to_table(AutomatikParameterTableName, 7, _Bhf_Gleis1)
                End If
                If _Bhf2_Gleis1 = 2 Then
                    _Bhf2_Gleis1 = 1
                    Button71.Text = "Halt"
                    _daten.write_to_table(AutomatikParameterTableName, 30, _Bhf2_Gleis1)
                End If
                If _SBhf_Gleis1 = 2 Then
                    _SBhf_Gleis1 = 1
                    Button51.Text = "Halt"
                    _daten.write_to_table(AutomatikParameterTableName, 22, _SBhf_Gleis1)
                End If
                If _Bhf_Gleis3 = 2 Then
                    _Bhf_Gleis3 = 3
                    Button33.Text = "Halt"
                    _daten.write_to_table(AutomatikParameterTableName, 9, _Bhf_Gleis3)
                End If
                If _SBhf_Gleis3 = 2 Then
                    _SBhf_Gleis3 = 3
                    Button53.Text = "Halt"
                    _daten.write_to_table(AutomatikParameterTableName, 24, _SBhf_Gleis3)
                End If
                If _Bhf2_Gleis3 = 2 Then
                    _Bhf2_Gleis3 = 3
                    Button73.Text = "Halt"
                    _daten.write_to_table(AutomatikParameterTableName, 32, _Bhf2_Gleis3)
                End If
                If _Bhf_Gleis4 = 2 Then
                    _Bhf_Gleis4 = 4
                    Button34.Text = "Halt"
                    _daten.write_to_table(AutomatikParameterTableName, 10, _Bhf_Gleis4)
                End If
                If _SBhf_Gleis4 = 2 Then
                    _SBhf_Gleis4 = 4
                    Button54.Text = "Halt"
                    _daten.write_to_table(AutomatikParameterTableName, 25, _SBhf_Gleis4)
                End If
                If _Bhf2_Gleis4 = 2 Then
                    _Bhf2_Gleis4 = 4
                    Button74.Text = "Halt"
                    _daten.write_to_table(AutomatikParameterTableName, 33, _Bhf2_Gleis4)
                End If
                _eb.weicheSchalten(1, Klassen.WeichenRichtung.links)
                _eb.weicheSchalten(2, Klassen.WeichenRichtung.links)
                _eb.weicheSchalten(3, Klassen.WeichenRichtung.links)
                _eb.weicheSchalten(4, Klassen.WeichenRichtung.links)
                _eb.weicheSchalten(5, Klassen.WeichenRichtung.links)
                _eb.weicheSchalten(6, Klassen.WeichenRichtung.links)
                _eb.weicheSchalten(7, Klassen.WeichenRichtung.rechts)
                _eb.weicheSchalten(8, Klassen.WeichenRichtung.rechts)
                _eb.weicheSchalten(9, Klassen.WeichenRichtung.links)
                _eb.weicheSchalten(10, Klassen.WeichenRichtung.links)
                _eb.weicheSchalten(11, Klassen.WeichenRichtung.links)
                _eb.weicheSchalten(12, Klassen.WeichenRichtung.links)
            End If
            If Betriebsart12 = 2 And Betriebsart34 = 0 Then
                If _Bhf_Gleis2 = 1 Or _Bhf_Gleis2 = 3 Or _Bhf_Gleis2 = 4 Then
                    _Bhf_Gleis2 = 2
                    Button32.Text = "Halt"
                    _daten.write_to_table(AutomatikParameterTableName, 8, _Bhf_Gleis2)
                End If
                If _Bhf2_Gleis2 = 1 Or _Bhf2_Gleis2 = 3 Or _Bhf2_Gleis2 = 4 Then
                    _Bhf2_Gleis2 = 2
                    Button72.Text = "Halt"
                    _daten.write_to_table(AutomatikParameterTableName, 31, _Bhf2_Gleis2)
                End If
                If _SBhf_Gleis2 = 1 Or _SBhf_Gleis2 = 3 Or _SBhf_Gleis2 = 4 Then
                    _SBhf_Gleis2 = 2
                    Button52.Text = "Halt"
                    _daten.write_to_table(AutomatikParameterTableName, 23, _SBhf_Gleis2)
                End If
                _eb.weicheSchalten(1, Klassen.WeichenRichtung.rechts)
                _eb.weicheSchalten(2, Klassen.WeichenRichtung.rechts)
                _eb.weicheSchalten(3, Klassen.WeichenRichtung.rechts)
                _eb.weicheSchalten(4, Klassen.WeichenRichtung.rechts)
                _eb.weicheSchalten(5, Klassen.WeichenRichtung.rechts)
                _eb.weicheSchalten(6, Klassen.WeichenRichtung.rechts)
                _eb.weicheSchalten(7, Klassen.WeichenRichtung.links)
                _eb.weicheSchalten(8, Klassen.WeichenRichtung.links)
                _eb.weicheSchalten(9, Klassen.WeichenRichtung.rechts)
                If _Route_Gleis2 = 0 Then
                    _eb.weicheSchalten(10, Klassen.WeichenRichtung.rechts)
                    _eb.weicheSchalten(11, Klassen.WeichenRichtung.links)
                    _eb.weicheSchalten(12, Klassen.WeichenRichtung.rechts)
                ElseIf _Route_Gleis2 = 1 Then
                    _eb.weicheSchalten(10, Klassen.WeichenRichtung.links)
                    _eb.weicheSchalten(11, Klassen.WeichenRichtung.rechts)
                    _eb.weicheSchalten(12, Klassen.WeichenRichtung.links)
                ElseIf _Route_Gleis2 = 2 Then
                    _eb.weicheSchalten(10, Klassen.WeichenRichtung.links)
                    _eb.weicheSchalten(11, Klassen.WeichenRichtung.links)
                    _eb.weicheSchalten(12, Klassen.WeichenRichtung.links)
                End If
            End If
            If Betriebsart12 = 2 And Betriebsart34 = 3 Then
                If _Bhf_Gleis2 = 1 Or _Bhf_Gleis2 = 4 Then
                    _Bhf_Gleis2 = 2
                    Button32.Text = "Halt"
                    _daten.write_to_table(AutomatikParameterTableName, 8, _Bhf_Gleis2)
                End If
                If _Bhf2_Gleis2 = 1 Or _Bhf2_Gleis2 = 4 Then
                    _Bhf2_Gleis2 = 2
                    Button72.Text = "Halt"
                    _daten.write_to_table(AutomatikParameterTableName, 31, _Bhf2_Gleis2)
                End If
                If _SBhf_Gleis2 = 1 Or _SBhf_Gleis2 = 4 Then
                    _SBhf_Gleis2 = 2
                    Button52.Text = "Halt"
                    _daten.write_to_table(AutomatikParameterTableName, 23, _SBhf_Gleis2)
                End If
                If _Bhf_Gleis3 = 1 Or _Bhf_Gleis3 = 4 Then
                    _Bhf_Gleis3 = 3
                    Button33.Text = "Halt"
                    _daten.write_to_table(AutomatikParameterTableName, 9, _Bhf_Gleis3)
                End If
                If _SBhf_Gleis3 = 1 Or _SBhf_Gleis3 = 4 Then
                    _SBhf_Gleis3 = 3
                    Button53.Text = "Halt"
                    _daten.write_to_table(AutomatikParameterTableName, 24, _SBhf_Gleis3)
                End If
                If _Bhf2_Gleis3 = 1 Or _Bhf2_Gleis3 = 4 Then
                    _Bhf2_Gleis3 = 3
                    Button73.Text = "Halt"
                    _daten.write_to_table(AutomatikParameterTableName, 32, _Bhf2_Gleis3)
                End If
                _eb.weicheSchalten(1, Klassen.WeichenRichtung.links)
                _eb.weicheSchalten(2, Klassen.WeichenRichtung.links)
                _eb.weicheSchalten(3, Klassen.WeichenRichtung.rechts)
                _eb.weicheSchalten(4, Klassen.WeichenRichtung.rechts)
                _eb.weicheSchalten(5, Klassen.WeichenRichtung.rechts)
                _eb.weicheSchalten(6, Klassen.WeichenRichtung.rechts)
                _eb.weicheSchalten(7, Klassen.WeichenRichtung.links)
                _eb.weicheSchalten(8, Klassen.WeichenRichtung.links)
                _eb.weicheSchalten(10, Klassen.WeichenRichtung.links)
                _eb.weicheSchalten(11, Klassen.WeichenRichtung.links)
                _eb.weicheSchalten(12, Klassen.WeichenRichtung.links)
            End If
            If Betriebsart12 = 2 And Betriebsart34 = 4 Then
                If _Bhf_Gleis2 = 1 Or _Bhf_Gleis2 = 3 Then
                    _Bhf_Gleis2 = 2
                    Button32.Text = "Halt"
                    _daten.write_to_table(AutomatikParameterTableName, 8, _Bhf_Gleis2)
                End If
                If _Bhf2_Gleis2 = 1 Or _Bhf2_Gleis2 = 3 Then
                    _Bhf2_Gleis2 = 2
                    Button72.Text = "Halt"
                    _daten.write_to_table(AutomatikParameterTableName, 31, _Bhf2_Gleis2)
                End If
                If _SBhf_Gleis2 = 1 Or _SBhf_Gleis2 = 3 Then
                    _SBhf_Gleis2 = 2
                    Button52.Text = "Halt"
                    _daten.write_to_table(AutomatikParameterTableName, 23, _SBhf_Gleis2)
                End If
                If _Bhf_Gleis4 = 1 Or _Bhf_Gleis4 = 3 Then
                    _Bhf_Gleis4 = 4
                    Button34.Text = "Halt"
                    _daten.write_to_table(AutomatikParameterTableName, 10, _Bhf_Gleis4)
                End If
                If _SBhf_Gleis4 = 1 Or _SBhf_Gleis4 = 3 Then
                    _SBhf_Gleis4 = 4
                    Button54.Text = "Halt"
                    _daten.write_to_table(AutomatikParameterTableName, 25, _SBhf_Gleis4)
                End If
                If _Bhf2_Gleis4 = 1 Or _Bhf2_Gleis4 = 3 Then
                    _Bhf2_Gleis4 = 4
                    Button74.Text = "Halt"
                    _daten.write_to_table(AutomatikParameterTableName, 33, _Bhf2_Gleis4)
                End If
                _eb.weicheSchalten(1, Klassen.WeichenRichtung.rechts)
                _eb.weicheSchalten(2, Klassen.WeichenRichtung.rechts)
                _eb.weicheSchalten(3, Klassen.WeichenRichtung.links)
                _eb.weicheSchalten(4, Klassen.WeichenRichtung.links)
                _eb.weicheSchalten(5, Klassen.WeichenRichtung.rechts)
                _eb.weicheSchalten(6, Klassen.WeichenRichtung.rechts)
                _eb.weicheSchalten(7, Klassen.WeichenRichtung.links)
                _eb.weicheSchalten(8, Klassen.WeichenRichtung.links)
                _eb.weicheSchalten(9, Klassen.WeichenRichtung.links)
                _eb.weicheSchalten(10, Klassen.WeichenRichtung.links)
                _eb.weicheSchalten(11, Klassen.WeichenRichtung.links)
                _eb.weicheSchalten(12, Klassen.WeichenRichtung.links)
            End If
            If Betriebsart12 = 2 And Betriebsart34 = 5 Then
                If _Bhf_Gleis2 = 1 Then
                    _Bhf_Gleis2 = 2
                    Button32.Text = "Halt"
                    _daten.write_to_table(AutomatikParameterTableName, 8, _Bhf_Gleis2)
                End If
                If _Bhf2_Gleis2 = 1 Then
                    _Bhf2_Gleis2 = 2
                    Button72.Text = "Halt"
                    _daten.write_to_table(AutomatikParameterTableName, 31, _Bhf2_Gleis2)
                End If
                If _SBhf_Gleis2 = 1 Then
                    _SBhf_Gleis2 = 2
                    Button52.Text = "Halt"
                    _daten.write_to_table(AutomatikParameterTableName, 23, _SBhf_Gleis2)
                End If
                If _Bhf_Gleis3 = 1 Then
                    _Bhf_Gleis3 = 3
                    Button33.Text = "Halt"
                    _daten.write_to_table(AutomatikParameterTableName, 9, _Bhf_Gleis3)
                End If
                If _SBhf_Gleis3 = 1 Then
                    _SBhf_Gleis3 = 3
                    Button53.Text = "Halt"
                    _daten.write_to_table(AutomatikParameterTableName, 24, _SBhf_Gleis3)
                End If
                If _Bhf2_Gleis3 = 1 Then
                    _Bhf2_Gleis3 = 3
                    Button73.Text = "Halt"
                    _daten.write_to_table(AutomatikParameterTableName, 32, _Bhf2_Gleis3)
                End If
                If _Bhf_Gleis4 = 1 Then
                    _Bhf_Gleis4 = 4
                    Button34.Text = "Halt"
                    _daten.write_to_table(AutomatikParameterTableName, 10, _Bhf_Gleis4)
                End If
                If _SBhf_Gleis4 = 1 Then
                    _SBhf_Gleis4 = 4
                    Button54.Text = "Halt"
                    _daten.write_to_table(AutomatikParameterTableName, 25, _SBhf_Gleis4)
                End If
                If _Bhf2_Gleis4 = 1 Then
                    _Bhf2_Gleis4 = 4
                    Button74.Text = "Halt"
                    _daten.write_to_table(AutomatikParameterTableName, 33, _Bhf2_Gleis4)
                End If
                _eb.weicheSchalten(1, Klassen.WeichenRichtung.links)
                _eb.weicheSchalten(2, Klassen.WeichenRichtung.links)
                _eb.weicheSchalten(3, Klassen.WeichenRichtung.links)
                _eb.weicheSchalten(4, Klassen.WeichenRichtung.links)
                _eb.weicheSchalten(5, Klassen.WeichenRichtung.rechts)
                _eb.weicheSchalten(6, Klassen.WeichenRichtung.rechts)
                _eb.weicheSchalten(7, Klassen.WeichenRichtung.links)
                _eb.weicheSchalten(8, Klassen.WeichenRichtung.links)
                _eb.weicheSchalten(9, Klassen.WeichenRichtung.links)
                _eb.weicheSchalten(10, Klassen.WeichenRichtung.links)
                _eb.weicheSchalten(11, Klassen.WeichenRichtung.links)
                _eb.weicheSchalten(12, Klassen.WeichenRichtung.links)
            End If
            If Betriebsart12 = 3 And Betriebsart34 = 0 Then
                If _Bhf_Gleis1 = 3 Or _Bhf_Gleis1 = 4 Then
                    _Bhf_Gleis1 = 1
                    Button31.Text = "Halt"
                    _daten.write_to_table(AutomatikParameterTableName, 7, _Bhf_Gleis1)
                End If
                If _Bhf2_Gleis1 = 3 Or _Bhf2_Gleis1 = 4 Then
                    _Bhf2_Gleis1 = 1
                    Button71.Text = "Halt"
                    _daten.write_to_table(AutomatikParameterTableName, 30, _Bhf2_Gleis1)
                End If
                If _SBhf_Gleis1 = 3 Or _SBhf_Gleis1 = 4 Then
                    _SBhf_Gleis1 = 1
                    Button51.Text = "Halt"
                    _daten.write_to_table(AutomatikParameterTableName, 22, _SBhf_Gleis1)
                End If
                If _Bhf_Gleis2 = 3 Or _Bhf_Gleis2 = 4 Then
                    _Bhf_Gleis2 = 2
                    Button32.Text = "Halt"
                    _daten.write_to_table(AutomatikParameterTableName, 8, _Bhf_Gleis2)
                End If
                If _Bhf2_Gleis2 = 3 Or _Bhf2_Gleis2 = 4 Then
                    _Bhf2_Gleis2 = 2
                    Button72.Text = "Halt"
                    _daten.write_to_table(AutomatikParameterTableName, 31, _Bhf2_Gleis2)
                End If
                If _SBhf_Gleis2 = 3 Or _SBhf_Gleis2 = 4 Then
                    _SBhf_Gleis2 = 2
                    Button52.Text = "Halt"
                    _daten.write_to_table(AutomatikParameterTableName, 23, _SBhf_Gleis2)
                End If
                If _Betriebsart3_0Var = 0 Or _Betriebsart3_0Var = 2 Then
                    _eb.weicheSchalten(1, Klassen.WeichenRichtung.rechts)
                    _eb.weicheSchalten(2, Klassen.WeichenRichtung.rechts)
                    _eb.weicheSchalten(3, Klassen.WeichenRichtung.rechts)
                    _eb.weicheSchalten(4, Klassen.WeichenRichtung.rechts)
                    _eb.weicheSchalten(5, Klassen.WeichenRichtung.links)
                    _eb.weicheSchalten(6, Klassen.WeichenRichtung.links)
                    _eb.weicheSchalten(7, Klassen.WeichenRichtung.links)
                    _eb.weicheSchalten(8, Klassen.WeichenRichtung.links)
                    _eb.weicheSchalten(9, Klassen.WeichenRichtung.links)
                    _eb.weicheSchalten(10, Klassen.WeichenRichtung.links)
                    _eb.weicheSchalten(11, Klassen.WeichenRichtung.links)
                    _eb.weicheSchalten(12, Klassen.WeichenRichtung.links)
                ElseIf _Betriebsart3_0Var = 1 Then
                    Talstrecke_Gleis1 = 1
                    Button91.BackColor = Drawing.Color.LightYellow
                    Button91.Text = "Wechsel > 2"
                    Button51.BackColor = Drawing.Color.LightYellow
                    Button51.Text = "Wechsel > 2"
                    Button81.BackColor = Drawing.Color.LightYellow
                    Button81.Text = "Wechsel > 2"
                    Talstrecke_Gleis2 = 1
                    Button92.BackColor = Drawing.Color.LightYellow
                    Button92.Text = "Wechsel > 1"
                    Button52.BackColor = Drawing.Color.LightYellow
                    Button52.Text = "Wechsel > 1"
                    Button82.BackColor = Drawing.Color.LightYellow
                    Button82.Text = "Wechsel > 1"
                    _eb.weicheSchalten(1, Klassen.WeichenRichtung.rechts)
                    _eb.weicheSchalten(2, Klassen.WeichenRichtung.rechts)
                    _eb.weicheSchalten(3, Klassen.WeichenRichtung.rechts)
                    _eb.weicheSchalten(4, Klassen.WeichenRichtung.rechts)
                    _eb.weicheSchalten(5, Klassen.WeichenRichtung.links)
                    _eb.weicheSchalten(6, Klassen.WeichenRichtung.links)
                    _eb.weicheSchalten(7, Klassen.WeichenRichtung.links)
                    _eb.weicheSchalten(8, Klassen.WeichenRichtung.links)
                    _eb.weicheSchalten(9, Klassen.WeichenRichtung.rechts)
                    _eb.weicheSchalten(10, Klassen.WeichenRichtung.rechts)
                    _eb.weicheSchalten(11, Klassen.WeichenRichtung.links)
                    _eb.weicheSchalten(12, Klassen.WeichenRichtung.links)
                End If
            End If
            If Betriebsart12 = 3 And Betriebsart34 = 3 Then
                If _Bhf_Gleis1 = 4 Then
                    _Bhf_Gleis1 = 1
                    Button31.Text = "Halt"
                    _daten.write_to_table(AutomatikParameterTableName, 7, _Bhf_Gleis1)
                End If
                If _Bhf2_Gleis1 = 4 Then
                    _Bhf2_Gleis1 = 1
                    Button71.Text = "Halt"
                    _daten.write_to_table(AutomatikParameterTableName, 30, _Bhf2_Gleis1)
                End If
                If _SBhf_Gleis1 = 4 Then
                    _SBhf_Gleis1 = 1
                    Button51.Text = "Halt"
                    _daten.write_to_table(AutomatikParameterTableName, 22, _SBhf_Gleis1)
                End If
                If _Bhf_Gleis2 = 4 Then
                    _Bhf_Gleis2 = 2
                    Button32.Text = "Halt"
                    _daten.write_to_table(AutomatikParameterTableName, 8, _Bhf_Gleis2)
                End If
                If _Bhf2_Gleis2 = 4 Then
                    _Bhf2_Gleis2 = 2
                    Button72.Text = "Halt"
                    _daten.write_to_table(AutomatikParameterTableName, 31, _Bhf2_Gleis2)
                End If
                If _SBhf_Gleis2 = 4 Then
                    _SBhf_Gleis2 = 2
                    Button52.Text = "Halt"
                    _daten.write_to_table(AutomatikParameterTableName, 23, _SBhf_Gleis2)
                End If
                If _Bhf_Gleis3 = 4 Then
                    _Bhf_Gleis3 = 3
                    Button33.Text = "Halt"
                    _daten.write_to_table(AutomatikParameterTableName, 9, _Bhf_Gleis3)
                End If
                If _SBhf_Gleis3 = 4 Then
                    _SBhf_Gleis3 = 3
                    Button53.Text = "Halt"
                    _daten.write_to_table(AutomatikParameterTableName, 24, _SBhf_Gleis3)
                End If
                If _Bhf2_Gleis3 = 4 Then
                    _Bhf2_Gleis3 = 3
                    Button73.Text = "Halt"
                    _daten.write_to_table(AutomatikParameterTableName, 32, _Bhf2_Gleis3)
                End If
                _eb.weicheSchalten(1, Klassen.WeichenRichtung.links)
                _eb.weicheSchalten(2, Klassen.WeichenRichtung.links)
                _eb.weicheSchalten(3, Klassen.WeichenRichtung.rechts)
                _eb.weicheSchalten(4, Klassen.WeichenRichtung.rechts)
                _eb.weicheSchalten(5, Klassen.WeichenRichtung.links)
                _eb.weicheSchalten(6, Klassen.WeichenRichtung.links)
                _eb.weicheSchalten(7, Klassen.WeichenRichtung.links)
                _eb.weicheSchalten(8, Klassen.WeichenRichtung.links)
                _eb.weicheSchalten(9, Klassen.WeichenRichtung.links)
                _eb.weicheSchalten(10, Klassen.WeichenRichtung.links)
                _eb.weicheSchalten(11, Klassen.WeichenRichtung.links)
                _eb.weicheSchalten(12, Klassen.WeichenRichtung.links)
            End If
            If Betriebsart12 = 3 And Betriebsart34 = 4 Then
                If _Bhf_Gleis1 = 3 Then
                    _Bhf_Gleis1 = 1
                    Button31.Text = "Halt"
                    _daten.write_to_table(AutomatikParameterTableName, 7, _Bhf_Gleis1)
                End If
                If _Bhf2_Gleis1 = 3 Then
                    _Bhf2_Gleis1 = 1
                    Button71.Text = "Halt"
                    _daten.write_to_table(AutomatikParameterTableName, 30, _Bhf2_Gleis1)
                End If
                If _SBhf_Gleis1 = 3 Then
                    _SBhf_Gleis1 = 1
                    Button51.Text = "Halt"
                    _daten.write_to_table(AutomatikParameterTableName, 22, _SBhf_Gleis1)
                End If
                If _Bhf_Gleis2 = 3 Then
                    _Bhf_Gleis2 = 2
                    Button32.Text = "Halt"
                    _daten.write_to_table(AutomatikParameterTableName, 8, _Bhf_Gleis2)
                End If
                If _Bhf2_Gleis2 = 3 Then
                    _Bhf2_Gleis2 = 2
                    Button72.Text = "Halt"
                    _daten.write_to_table(AutomatikParameterTableName, 31, _Bhf2_Gleis2)
                End If
                If _SBhf_Gleis2 = 3 Then
                    _SBhf_Gleis2 = 2
                    Button52.Text = "Halt"
                    _daten.write_to_table(AutomatikParameterTableName, 23, _SBhf_Gleis2)
                End If
                If _Bhf_Gleis4 = 3 Then
                    _Bhf_Gleis4 = 4
                    Button34.Text = "Halt"
                    _daten.write_to_table(AutomatikParameterTableName, 10, _Bhf_Gleis4)
                End If
                If _SBhf_Gleis4 = 3 Then
                    _SBhf_Gleis4 = 4
                    Button54.Text = "Halt"
                    _daten.write_to_table(AutomatikParameterTableName, 25, _SBhf_Gleis4)
                End If
                If _Bhf2_Gleis4 = 3 Then
                    _Bhf2_Gleis4 = 4
                    Button74.Text = "Halt"
                    _daten.write_to_table(AutomatikParameterTableName, 33, _Bhf2_Gleis4)
                End If
                _eb.weicheSchalten(1, Klassen.WeichenRichtung.rechts)
                _eb.weicheSchalten(2, Klassen.WeichenRichtung.rechts)
                _eb.weicheSchalten(3, Klassen.WeichenRichtung.links)
                _eb.weicheSchalten(4, Klassen.WeichenRichtung.links)
                _eb.weicheSchalten(5, Klassen.WeichenRichtung.links)
                _eb.weicheSchalten(6, Klassen.WeichenRichtung.links)
                _eb.weicheSchalten(7, Klassen.WeichenRichtung.links)
                _eb.weicheSchalten(8, Klassen.WeichenRichtung.links)
                _eb.weicheSchalten(9, Klassen.WeichenRichtung.links)
                _eb.weicheSchalten(10, Klassen.WeichenRichtung.links)
                _eb.weicheSchalten(11, Klassen.WeichenRichtung.links)
                _eb.weicheSchalten(12, Klassen.WeichenRichtung.links)
            End If
            If Betriebsart12 = 3 And Betriebsart34 = 5 Then
                _eb.weicheSchalten(1, Klassen.WeichenRichtung.links)
                _eb.weicheSchalten(2, Klassen.WeichenRichtung.links)
                _eb.weicheSchalten(3, Klassen.WeichenRichtung.links)
                _eb.weicheSchalten(4, Klassen.WeichenRichtung.links)
                _eb.weicheSchalten(5, Klassen.WeichenRichtung.links)
                _eb.weicheSchalten(6, Klassen.WeichenRichtung.links)
                _eb.weicheSchalten(7, Klassen.WeichenRichtung.links)
                _eb.weicheSchalten(8, Klassen.WeichenRichtung.links)
                _eb.weicheSchalten(9, Klassen.WeichenRichtung.links)
                _eb.weicheSchalten(10, Klassen.WeichenRichtung.links)
                _eb.weicheSchalten(11, Klassen.WeichenRichtung.links)
                _eb.weicheSchalten(12, Klassen.WeichenRichtung.links)
            End If
        End If
        If Betriebsart = 3 Then
            _eb.weicheSchalten(1, Klassen.WeichenRichtung.links)
            _eb.weicheSchalten(2, Klassen.WeichenRichtung.links)
            _eb.weicheSchalten(3, Klassen.WeichenRichtung.links)
            _eb.weicheSchalten(4, Klassen.WeichenRichtung.links)
            _eb.weicheSchalten(5, Klassen.WeichenRichtung.links)
            _eb.weicheSchalten(6, Klassen.WeichenRichtung.links)
            _eb.weicheSchalten(7, Klassen.WeichenRichtung.links)
            _eb.weicheSchalten(8, Klassen.WeichenRichtung.links)
            _eb.weicheSchalten(9, Klassen.WeichenRichtung.links)
            _eb.weicheSchalten(10, Klassen.WeichenRichtung.links)
            _eb.weicheSchalten(11, Klassen.WeichenRichtung.links)
            _eb.weicheSchalten(12, Klassen.WeichenRichtung.links)
        End If

        _Signale_in_Startposition = True
        _Signale_initialisiert = True
        TextBox1.Text = "Die Signale befinden sich in Startposition für die ausgewählte Automatik. Nächster Schritt: Starten."
    End Sub
    Private Sub Button43_Click(sender As System.Object, e As System.EventArgs) Handles Button43.Click

        A_StopH = 0
        _AutomatikParameterH = 0

        Button11.Enabled = False
        Button12.Enabled = False

        Button21.Enabled = False
        Button22.Enabled = False
        Button23.Enabled = False
        Button24.Enabled = False

        Button19.Enabled = False
        Button30.Enabled = False
        Button35.Enabled = False

        Button19.Enabled = False
        Button38.Enabled = False
        Button40.Enabled = False
        Button44.Enabled = False

        If Start_Betaetigt = False And _Weichen_in_Startposition = True And _Signale_in_Startposition = True Then

            If Betriebsart = 1 Then
                If Betriebsart12 = 1 Then
                    Zug1(anfahren)
                    AutomatikParameter = 100
                End If
                If Betriebsart12 = 2 Then
                    Zug2(anfahren)
                    AutomatikParameter = 200
                End If
                If Betriebsart12 = 3 Then
                    Zug1(anfahren)
                    AutomatikParameter = 100
                End If
                If Betriebsart12 = 0 Then
                    AutomatikParameter = 0
                End If
                If Betriebsart34 = 3 Then
                    Zug3(anfahren)
                    AutomatikParameter1 = 300
                End If
                If Betriebsart34 = 4 Then
                    Zug4(anfahren)
                    AutomatikParameter1 = 400
                End If
                If Betriebsart34 = 5 Then
                    Zug3(anfahren)
                    AutomatikParameter1 = 300
                End If
                If Betriebsart34 = 0 Then
                    AutomatikParameter1 = 0
                End If
                Button43.BackColor = Drawing.Color.Green
                Button43.Text = "Stop am Zyklusende"
            End If

            If Betriebsart = 2 Then
                If Betriebsart12 = 0 And Betriebsart34 = 3 Then
                    Startzug = 3
                    Zug3(anfahren)
                    AutomatikParameter = 300
                End If
                If Betriebsart12 = 0 And Betriebsart34 = 4 Then
                    If _Betriebsart0_4Var = 0 Then
                        Startzug = 4
                        Zug4(anfahren)
                        AutomatikParameter = 400
                    ElseIf _Betriebsart0_4Var = 1 Then
                        Startzug = 4
                        Zug4(anfahren)
                        AutomatikParameter = 90
                    Else
                        Startzug = 4
                        Zug4(anfahren)
                        AutomatikParameter = 90
                    End If

                End If
                If Betriebsart12 = 0 And Betriebsart34 = 5 Then
                    If Startzug = 4 Then
                        Zug4(anfahren)
                        AutomatikParameter = 400
                    Else
                        Startzug = 3
                        Zug3(anfahren)
                        AutomatikParameter = 300
                    End If
                End If
                If Betriebsart12 = 1 And Betriebsart34 = 0 Then
                    Startzug = 1
                    Zug1(anfahren)
                    AutomatikParameter = 100
                End If
                If Betriebsart12 = 1 And Betriebsart34 = 3 Then
                    If Startzug = 3 Then
                        Zug3(anfahren)
                        AutomatikParameter = 300
                    Else
                        Startzug = 1
                        Zug1(anfahren)
                        AutomatikParameter = 100
                    End If
                End If
                If Betriebsart12 = 1 And Betriebsart34 = 4 Then
                    If Startzug = 4 Then
                        Zug4(anfahren)
                        AutomatikParameter = 400
                    Else
                        Startzug = 1
                        Zug1(anfahren)
                        AutomatikParameter = 100
                    End If
                End If
                If Betriebsart12 = 1 And Betriebsart34 = 5 Then
                    If Startzug = 3 Then
                        Zug3(anfahren)
                        AutomatikParameter = 300
                    ElseIf Startzug = 4 Then
                        Startzug = 4
                        Zug4(anfahren)
                        AutomatikParameter = 400
                    Else
                        Startzug = 1
                        Zug1(anfahren)
                        AutomatikParameter = 100
                    End If
                End If
                If Betriebsart12 = 2 And Betriebsart34 = 0 Then
                    Startzug = 2
                    Zug2(anfahren)
                    AutomatikParameter = 200
                End If
                If Betriebsart12 = 2 And Betriebsart34 = 3 Then
                    If Startzug = 3 Then
                        Zug3(anfahren)
                        AutomatikParameter = 300
                    Else
                        Startzug = 2
                        Zug2(anfahren)
                        AutomatikParameter = 200
                    End If
                    _eb.weicheSchalten(11, Klassen.WeichenRichtung.links)
                End If
                If Betriebsart12 = 2 And Betriebsart34 = 4 Then
                    If Startzug = 4 Then
                        Zug4(anfahren)
                        AutomatikParameter = 400
                    Else
                        Startzug = 2
                        Zug2(anfahren)
                        AutomatikParameter = 200
                    End If
                    _eb.weicheSchalten(11, Klassen.WeichenRichtung.links)
                End If
                If Betriebsart12 = 2 And Betriebsart34 = 5 Then
                    If Startzug = 3 Then
                        Zug3(anfahren)
                        AutomatikParameter = 300
                    ElseIf Startzug = 4 Then
                        Zug4(anfahren)
                        AutomatikParameter = 400
                    Else
                        Startzug = 2
                        Zug2(anfahren)
                        AutomatikParameter = 200
                    End If
                    _eb.weicheSchalten(11, Klassen.WeichenRichtung.links)
                End If
                If Betriebsart12 = 3 And Betriebsart34 = 0 Then
                    If _Betriebsart3_0Var = 0 Then
                        If Startzug = 2 Then
                            Zug2(anfahren)
                            AutomatikParameter = 200
                        Else
                            Startzug = 1
                            Zug1(anfahren)
                            AutomatikParameter = 100
                        End If
                    ElseIf _Betriebsart3_0Var = 1 Then
                        Startzug = 1
                        Zug1(anfahren)
                        AutomatikParameter = 90
                    ElseIf _Betriebsart3_0Var = 2 Then
                        If Startzug = 2 Then
                            Zug2(anfahren)
                            AutomatikParameter = 200
                        Else
                            Startzug = 1
                            Zug1(anfahren)
                            AutomatikParameter = 100
                        End If
                    End If

                End If
                If Betriebsart12 = 3 And Betriebsart34 = 3 Then
                    If Startzug = 3 Then
                        Zug3(anfahren)
                        AutomatikParameter = 300
                    ElseIf Startzug = 2 Then
                        Zug2(anfahren)
                        AutomatikParameter = 200
                    Else
                        Startzug = 1
                        Zug1(anfahren)
                        AutomatikParameter = 100
                    End If
                End If
                If Betriebsart12 = 3 And Betriebsart34 = 4 Then
                    If Startzug = 4 Then
                        Zug4(anfahren)
                        AutomatikParameter = 400
                    ElseIf Startzug = 2 Then
                        Zug2(anfahren)
                        AutomatikParameter = 200
                    Else
                        Startzug = 1
                        Zug1(anfahren)
                        AutomatikParameter = 100
                    End If
                End If
                If Betriebsart12 = 3 And Betriebsart34 = 5 Then
                    If Startzug = 0 Or Startzug = 1 Then
                        Startzug = 1
                        Zug1(anfahren)
                        AutomatikParameter = 100
                    ElseIf Startzug = 2 Then
                        Zug2(anfahren)
                        AutomatikParameter = 200
                    ElseIf Startzug = 3 Then
                        Zug3(anfahren)
                        AutomatikParameter = 300
                    ElseIf Startzug = 4 Then
                        Zug4(anfahren)
                        AutomatikParameter = 400
                    End If
                End If
                If Startzug = 1 Or Startzug = 2 Then
                    If _Kamera = 3 Then
                        _Webcams.SetWebcam(0, Marxzel)
                        Button13.Text = "Wiehre"
                        _aktuelleKamera = Marxzel
                    End If
                    If Startzug = 3 Or Startzug = 4 Then
                        If _Kamera = 3 And _aktuelleKamera <> Forbach Then
                            _Webcams.SetWebcam(0, Forbach)
                            Button13.Text = "Hinterzarten"
                            _aktuelleKamera = Forbach
                        End If
                    End If
                End If
                Button43.BackColor = Drawing.Color.Green
                Button43.Text = "Stop am Zyklusende"

            End If

            _StoryPointer = 0

            ComboBox1.Enabled = False

            If ComboBox1.SelectedIndex = 0 Then ' *** Aus

                'Timer_Story_Film.Stop()

            ElseIf ComboBox1.SelectedIndex = 1 Then ' *** Eisenbahn - Filme
                _StoryPointer = 0
                StoryImage = "Kaltes Herz.jpg"
                StoryText = "Eisenbahn Filme "

            ElseIf ComboBox1.SelectedIndex = 2 Then ' *** Das kalte Herz

                _StoryPointer = 0
                StoryImage = "Kaltes Herz.jpg"
                StoryText = "Altenstein begrüßt seine Gäste. "
                Das_kalte_Herz()

                'ElseIf ComboBox1.SelectedIndex = 3 Then ' *** Tag und Nacht

                '    StoryImage = "Time_000.jpg"

                'ElseIf ComboBox1.SelectedIndex = 4 Then ' *** Zug mit Spotlicht verfolgen

                '    Timer_Story_DMX.Interval = 100
                '    Timer_Story_DMX.Start()

                '    DMX_Pointer = 0

                '    StoryImage = "Light_000.jpg"

                '    PlayMusic("H:\Eisenbahn\EisenbahnV4\Plugins\KlausEBspecific\Media\\Let there be light.wav")

                '    _Beleuchtung = 10

                'ElseIf ComboBox1.SelectedIndex = 5 Then ' *** sonstiges

                '    StoryImage = "Time_000.jpg"

                '    PlayMusic("H:\Eisenbahn\EisenbahnV4\Plugins\KlausEBspecific\Media\\Hans Zimmer - Time (Inception).wav")

            Else

            End If
            _daten.write_to_table(AutomatikParameterTableName, 50, _Hue)

            Start_Betaetigt = True
            Stop_Betaetigt = False
            A_Stop = 0
            CheckBox1.Checked = True
            CheckBox1.Enabled = True
        ElseIf Start_Betaetigt = True And _Weichen_initialisiert = True And _Signale_in_Startposition = True Then
            If Betriebsart = 0 Or Betriebsart = 1 Or Betriebsart = 2 Then
                A_Stop = 1
                Start_Betaetigt = False
                Stop_Betaetigt = True
                Button43.BackColor = Drawing.Color.Yellow
                Button43.Text = "Start"
            End If

        ElseIf _Weichen_initialisiert = False Or _Signale_in_Startposition = False Then
            Button43.BackColor = Drawing.Color.White
            Button43.Text = "zuerst Weichen und Signale in Startposition bringen"
            CheckBox1.Enabled = False
        End If
        PictureBox1.Visible = True
    End Sub
    ' *** GleisFrei
    Private Sub Button15_Click(sender As System.Object, e As System.EventArgs) Handles Button15.Click
        If _GleisFrei1 = 1 Then
            _GleisFrei1 = 0
            Button15.Text = "belegt / nicht benutzt"
            Button15.BackColor = Drawing.Color.LightYellow
        ElseIf _GleisFrei1 = 0 Then
            _GleisFrei1 = 1
            Button15.Text = "frei / benutzt"
            Button15.BackColor = Drawing.Color.LightGreen
        Else
            _GleisFrei1 = 0
        End If
        _Weichen_in_Startposition = False
        _Signale_in_Startposition = False
        ButtonsVisible(999)
    End Sub
    Private Sub Button16_Click(sender As System.Object, e As System.EventArgs) Handles Button16.Click
        If _GleisFrei2 = 1 Then
            _GleisFrei2 = 0
            Button16.Text = "belegt / nicht benutzt"
            Button16.BackColor = Drawing.Color.LightYellow
        ElseIf _GleisFrei1 = 0 Then
            _GleisFrei2 = 1
            Button16.Text = "frei / benutzt"
            Button16.BackColor = Drawing.Color.LightGreen
            _GleisFrei3 = 0
            Button17.Text = "belegt / nicht benutzt"
            Button17.BackColor = Drawing.Color.LightYellow
            _GleisFrei4 = 0
            Button18.Text = "belegt / nicht benutzt"
            Button18.BackColor = Drawing.Color.LightYellow
        Else
            _GleisFrei2 = 0
        End If
        _Weichen_in_Startposition = False
        _Signale_in_Startposition = False
        ButtonsVisible(999)
    End Sub
    Private Sub Button17_Click(sender As System.Object, e As System.EventArgs) Handles Button17.Click
        If _GleisFrei3 = 1 Then
            _GleisFrei3 = 0
            Button17.Text = "belegt / nicht benutzt"
            Button17.BackColor = Drawing.Color.LightYellow
        ElseIf _GleisFrei3 = 0 Then
            _GleisFrei3 = 1
            Button17.Text = "frei / benutzt"
            Button17.BackColor = Drawing.Color.LightGreen
            _GleisFrei2 = 0
            Button16.Text = "belegt / nicht benutzt"
            Button16.BackColor = Drawing.Color.LightYellow
            _GleisFrei4 = 0
            Button18.Text = "belegt / nicht benutzt"
            Button18.BackColor = Drawing.Color.LightYellow
        Else
            _GleisFrei3 = 0
        End If
        _Weichen_in_Startposition = False
        _Signale_in_Startposition = False
        ButtonsVisible(999)
    End Sub
    Private Sub Button18_Click(sender As System.Object, e As System.EventArgs) Handles Button18.Click
        If _GleisFrei4 = 1 Then
            _GleisFrei4 = 0
            Button18.Text = "belegt / nicht benutzt"
            Button18.BackColor = Drawing.Color.LightYellow
        ElseIf _GleisFrei4 = 0 Then
            _GleisFrei4 = 1
            Button18.Text = "frei / benutzt"
            Button18.BackColor = Drawing.Color.LightGreen
            _GleisFrei2 = 0
            Button16.Text = "belegt / nicht benutzt"
            Button16.BackColor = Drawing.Color.LightYellow
            _GleisFrei3 = 0
            Button17.Text = "belegt / nicht benutzt"
            Button17.BackColor = Drawing.Color.LightYellow
        Else
            _GleisFrei4 = 0
        End If
        _Weichen_in_Startposition = False
        _Signale_in_Startposition = False
        ButtonsVisible(999)
    End Sub
    ' *** DMX
    'Private Sub Button1_Click(sender As System.Object, e As System.EventArgs) Handles Button1.Click
    '    Dim IndexLicht, DMX1, DMX2, DMX3, DMX4, DMX5, DMX6, DMX7, FMod1, FMod2, FMod3, FMod4, FMod5, FMod6, FMod7, FMod8, FMod9, FMod10, FMod11, FMod12 As Integer
    '    _Beleuchtung = _Beleuchtung + 1
    '    If _Beleuchtung > 9 Then
    '        _Beleuchtung = 2
    '    End If
    '    IndexLicht = _Beleuchtung + 4
    '    DMX1 = Betriebsparameter.GetValue("Beleuchtungsparameter", 2, IndexLicht)
    '    DMX2 = Betriebsparameter.GetValue("Beleuchtungsparameter", 3, IndexLicht)
    '    DMX3 = Betriebsparameter.GetValue("Beleuchtungsparameter", 4, IndexLicht)
    '    DMX4 = Betriebsparameter.GetValue("Beleuchtungsparameter", 5, IndexLicht)
    '    DMX5 = Betriebsparameter.GetValue("Beleuchtungsparameter", 6, IndexLicht)
    '    DMX6 = Betriebsparameter.GetValue("Beleuchtungsparameter", 7, IndexLicht)
    '    DMX7 = Betriebsparameter.GetValue("Beleuchtungsparameter", 8, IndexLicht)

    '    If _Hue = 3 Then
    '        Hue_Control = Betriebsparameter.GetValue("Beleuchtungsparameter", 9, IndexLicht)
    '        Col_soll = Betriebsparameter.GetValue("Beleuchtungsparameter", 10, IndexLicht)
    '        Sat_soll = Betriebsparameter.GetValue("Beleuchtungsparameter", 11, IndexLicht)
    '        Bri_soll = Betriebsparameter.GetValue("Beleuchtungsparameter", 12, IndexLicht)
    '        CT_soll = Betriebsparameter.GetValue("Beleuchtungsparameter", 13, IndexLicht)
    '        Timer_HUE.Start()
    '    End If

    '    FMod1 = Betriebsparameter.GetValue("Beleuchtungsparameter", 14, IndexLicht)
    '    FMod2 = Betriebsparameter.GetValue("Beleuchtungsparameter", 15, IndexLicht)
    '    FMod3 = Betriebsparameter.GetValue("Beleuchtungsparameter", 16, IndexLicht)
    '    FMod4 = Betriebsparameter.GetValue("Beleuchtungsparameter", 17, IndexLicht)
    '    FMod5 = Betriebsparameter.GetValue("Beleuchtungsparameter", 18, IndexLicht)
    '    FMod6 = Betriebsparameter.GetValue("Beleuchtungsparameter", 19, IndexLicht)
    '    FMod7 = Betriebsparameter.GetValue("Beleuchtungsparameter", 20, IndexLicht)
    '    FMod8 = Betriebsparameter.GetValue("Beleuchtungsparameter", 21, IndexLicht)
    '    FMod9 = Betriebsparameter.GetValue("Beleuchtungsparameter", 22, IndexLicht)
    '    FMod10 = Betriebsparameter.GetValue("Beleuchtungsparameter", 23, IndexLicht)
    '    FMod11 = Betriebsparameter.GetValue("Beleuchtungsparameter", 24, IndexLicht)
    '    FMod12 = Betriebsparameter.GetValue("Beleuchtungsparameter", 25, IndexLicht)

    '    'Button1.Text = "DMX " + Betriebsparameter.GetValue("Beleuchtungsparameter", 1, IndexLicht)
    '    'Button1.Text = Betriebsparameter.GetValue("Beleuchtungsparameter", 1, IndexLicht)
    '    DMX(8, 20, DMX1, DMX2, DMX3, DMX4, DMX5, DMX6, DMX7)

    '    If _Funktionsmodelle = 2 Then
    '        If FMod1 = 1 Then
    '            _eb.weicheSchalten(29, Klassen.WeichenRichtung.links)
    '        Else
    '            _eb.weicheSchalten(29, Klassen.WeichenRichtung.rechts)
    '        End If
    '        If FMod2 = 1 Then
    '            _eb.weicheSchalten(30, Klassen.WeichenRichtung.links)
    '        Else
    '            _eb.weicheSchalten(30, Klassen.WeichenRichtung.rechts)
    '        End If
    '        If FMod3 = 1 Then
    '            _eb.weicheSchalten(31, Klassen.WeichenRichtung.links)
    '        Else
    '            _eb.weicheSchalten(31, Klassen.WeichenRichtung.rechts)
    '        End If
    '        If FMod4 = 1 Then
    '            _eb.weicheSchalten(32, Klassen.WeichenRichtung.links)
    '        Else
    '            _eb.weicheSchalten(32, Klassen.WeichenRichtung.rechts)
    '        End If
    '        If FMod5 = 1 Then
    '            _eb.weicheSchalten(33, Klassen.WeichenRichtung.links)
    '        Else
    '            _eb.weicheSchalten(33, Klassen.WeichenRichtung.rechts)
    '        End If
    '        If FMod6 = 1 Then
    '            _eb.weicheSchalten(34, Klassen.WeichenRichtung.links)
    '        Else
    '            _eb.weicheSchalten(34, Klassen.WeichenRichtung.rechts)
    '        End If
    '        If FMod7 = 1 Then
    '            _eb.weicheSchalten(35, Klassen.WeichenRichtung.links)
    '        Else
    '            _eb.weicheSchalten(35, Klassen.WeichenRichtung.rechts)
    '        End If
    '        If FMod8 = 1 Then
    '            _eb.weicheSchalten(36, Klassen.WeichenRichtung.links)
    '        Else
    '            _eb.weicheSchalten(36, Klassen.WeichenRichtung.rechts)
    '        End If
    '        If FMod9 = 1 Then
    '            _eb.weicheSchalten(37, Klassen.WeichenRichtung.links)
    '        Else
    '            _eb.weicheSchalten(37, Klassen.WeichenRichtung.rechts)
    '        End If
    '        If FMod10 = 1 Then
    '            _eb.weicheSchalten(38, Klassen.WeichenRichtung.links)
    '        Else
    '            _eb.weicheSchalten(38, Klassen.WeichenRichtung.rechts)
    '        End If
    '        If FMod11 = 1 Then
    '            _eb.weicheSchalten(39, Klassen.WeichenRichtung.links)
    '        Else
    '            _eb.weicheSchalten(39, Klassen.WeichenRichtung.rechts)
    '        End If
    '        If FMod12 = 1 Then
    '            _eb.weicheSchalten(40, Klassen.WeichenRichtung.links)
    '        Else
    '            _eb.weicheSchalten(40, Klassen.WeichenRichtung.rechts)
    '        End If
    '    End If

    '    Button1.BackColor = Drawing.Color.LightYellow
    '    Button36.BackColor = Drawing.Color.LightGray
    '    Button37.BackColor = Drawing.Color.LightGray

    '    _daten.write_to_table(AutomatikParameterTableName, 44, _Beleuchtung)
    'End Sub
    'Private Sub Button36_Click(sender As System.Object, e As System.EventArgs) Handles Button36.Click
    '    _Beleuchtung = 0
    '    DMX(8, 20, 0, 0, 0, 0, 0, 0, 0)
    '    Button1.BackColor = Drawing.Color.LightGray
    '    Button36.BackColor = Drawing.Color.LightYellow
    '    Button37.BackColor = Drawing.Color.LightGray
    '    Button1.Text = "DMX"
    '    _daten.write_to_table(AutomatikParameterTableName, 44, _Beleuchtung)
    'End Sub
    'Private Sub Button37_Click(sender As System.Object, e As System.EventArgs) Handles Button37.Click
    '    _Beleuchtung = 1
    '    DMX(8, 20, 200, 200, 200, 200, 200, 200, 200)
    '    Button1.BackColor = Drawing.Color.LightGray
    '    Button36.BackColor = Drawing.Color.LightGray
    '    Button37.BackColor = Drawing.Color.LightYellow
    '    Button1.Text = "DMX"
    '    _daten.write_to_table(AutomatikParameterTableName, 44, _Beleuchtung)
    'End Sub
    ' *** Hue
    Private Sub Button2_Click(sender As System.Object, e As System.EventArgs) Handles Button2.Click
        _Hue_Reset = 1
        _HueHell = 0
        _HueAus = 0
        If _Hue = 0 Then
            _Hue = 1
            Hue_Control = 1
            CT_soll = 256
            Bri_soll = 255
        ElseIf _Hue = 1 Then
            _Hue = 2
            Hue_Control = 1
            CT_soll = 256
            Bri_soll = 160
        ElseIf _Hue = 2 Then
            _Hue = 3
            Hue_Control = 1
            CT_soll = 256
            Bri_soll = 80
        ElseIf _Hue = 3 Then
            _Hue = 4
            Hue_Control = 2
            Sat_soll = 254
            Col_soll = 64000
            Bri_soll = 80
            Hue_Control = 2
        ElseIf _Hue = 4 Then
            _Hue = 5
            Hue_Control = 2
            Sat_soll = 254
            Col_soll = 45000
            Bri_soll = 80
        ElseIf _Hue = 5 Then
            _Hue = 6
            Hue_Control = 2
            Sat_soll = 254
            Col_soll = 20500
            Bri_soll = 80
        ElseIf _Hue = 6 Then
            _Hue = 7
            Hue_Control = 2
            Sat_soll = 254
            Col_soll = 10000
            Bri_soll = 80
        ElseIf _Hue = 7 Then
            _Hue = 0
            Hue_Control = 0
        End If
        _daten.write_to_table(AutomatikParameterTableName, 50, _Hue)
        Timer_HUE.Start()
        ButtonsVisible(999)
    End Sub
    Private Sub Button20_Click(sender As System.Object, e As System.EventArgs) Handles Button20.Click
        _Hue_Reset = 1
        _HueHell = 0
        If _HueAus = 0 Then
            _HueAus = 1
            Hue_Control_M = Hue_Control
            Hue_Control = 0
        Else
            _HueAus = 0
            If Hue_Control_M = 0 Then
                Hue_Control = 1
            Else
                Hue_Control = Hue_Control_M
            End If
        End If
        _daten.write_to_table(AutomatikParameterTableName, 53, Hue_Control)
        Timer_HUE.Start()
        ButtonsVisible(999)
    End Sub
    Private Sub Button29_Click(sender As System.Object, e As System.EventArgs) Handles Button29.Click
        _Hue_Reset = 1
        _HueAus = 0
        If _HueHell = 0 Then
            _HueHell = 1
            Hue_Control_M = Hue_Control
            Hue_Control = 4
            CT_M = CT_soll
            Bri_M = Bri_soll
            CT_soll = 128
            Bri_soll = 255
        ElseIf _HueHell = 1 Then
            _HueHell = 0
            Hue_Control = Hue_Control_M
            Bri_soll = Bri_M
            CT_soll = Bri_M
        End If
        _daten.write_to_table(AutomatikParameterTableName, 53, Hue_Control)
        Timer_HUE.Start()
        ButtonsVisible(999)
    End Sub
    ' *** Funktionsmodelle
    Private Sub Button14_Click(sender As System.Object, e As System.EventArgs) Handles Button14.Click
        If _Funktionsmodelle = 0 Then
            _Funktionsmodelle = 1
            Button14.Text = "Funk.-Modelle ein"
            Button14.BackColor = Drawing.Color.LightGreen
            _eb.weicheSchalten(30, Klassen.WeichenRichtung.links)
            _eb.weicheSchalten(34, Klassen.WeichenRichtung.links)
            _eb.weicheSchalten(40, Klassen.WeichenRichtung.links)
        ElseIf _Funktionsmodelle = 1 Then
            _Funktionsmodelle = 2
            Button14.Text = "Funk.-Modelle Auto"
            Button14.BackColor = Drawing.Color.LightYellow
            _eb.weicheSchalten(30, Klassen.WeichenRichtung.rechts)
            _eb.weicheSchalten(34, Klassen.WeichenRichtung.rechts)
            _eb.weicheSchalten(40, Klassen.WeichenRichtung.rechts)
        ElseIf _Funktionsmodelle = 2 Then
            Button14.Text = "Funk.-Modelle aus"
            Button14.BackColor = Drawing.Color.LightGray
            _Funktionsmodelle = 0
            _eb.weicheSchalten(30, Klassen.WeichenRichtung.rechts)
            _eb.weicheSchalten(34, Klassen.WeichenRichtung.rechts)
            _eb.weicheSchalten(40, Klassen.WeichenRichtung.rechts)
        Else
            _Funktionsmodelle = 0
        End If

        _daten.write_to_table(AutomatikParameterTableName, 45, _Funktionsmodelle)
    End Sub
    ' *** Kameras
    Private Sub Button13_Click(sender As System.Object, e As System.EventArgs) Handles Button13.Click
        If _Kamera = 0 Then
            _Kamera = 1
            _Webcams.SetWebcam(0, Forbach)
            Button13.Text = "Hinterzarten"
            Button13.BackColor = Drawing.Color.LightGray
        ElseIf _Kamera = 1 Then
            _Kamera = 2
            _Webcams.SetWebcam(0, Windeck)
            Button13.Text = "Titisee"
            Button13.BackColor = Drawing.Color.LightGray
        ElseIf _Kamera = 2 Then
            _Kamera = 3
            Button13.Text = "Kamera - Automatik"
            Button13.BackColor = Drawing.Color.LightYellow
        ElseIf _Kamera = 3 Then
            _Kamera = 0
            _Webcams.SetWebcam(0, Marxzel)
            Button13.Text = "Wiehre"
            Button13.BackColor = Drawing.Color.LightGray
        End If
        _daten.write_to_table(AutomatikParameterTableName, 34, _Kamera)
    End Sub
    ' *** Motor
    Private Sub Button3_Click(sender As System.Object, e As System.EventArgs) Handles Button3.Click
        If _Motor = 0 Then
            _Motor = 1
            Button3.BackColor = Drawing.Color.LightYellow
            Button3.Text = "Motor ein/aus 1"
        ElseIf _Motor = 1 Then
            _Motor = 2
            Button3.BackColor = Drawing.Color.LightYellow
            Button3.Text = "Motor ein/aus 2"
            'ElseIf _Motor = 2 Then
            '    _Motor = 3
            '    Button3.BackColor = Drawing.Color.LightYellow
            '    Button3.Text = "Motor ein/aus 3"
        ElseIf _Motor = 2 Then
            _Motor = 3
            Button3.BackColor = Drawing.Color.LightYellow
            Button3.Text = "Motor ein"
        ElseIf _Motor = 3 Then
            _Motor = 0
            Button3.BackColor = Drawing.Color.LightGray
            Button3.Text = "Motor aus"
        End If
        _daten.write_to_table(AutomatikParameterTableName, 15, _Motor)
    End Sub
    ' *** Fahrzeugbeleuchtung
    Private Sub Button4_Click(sender As System.Object, e As System.EventArgs) Handles Button4.Click
        If _Fahrzeugbeleuchtung2 = 0 Then
            _Fahrzeugbeleuchtung2 = 1
            Button4.Text = "Beleuchtung ein/aus"
            Button4.BackColor = Drawing.Color.LightYellow
        ElseIf _Fahrzeugbeleuchtung2 = 1 Then
            _Fahrzeugbeleuchtung2 = 2
            Button4.Text = "Beleuchtung ein"
            Button4.BackColor = Drawing.Color.LightYellow
        ElseIf _Fahrzeugbeleuchtung2 = 2 Then
            _Fahrzeugbeleuchtung2 = 0
            Button4.Text = "Beleuchtung aus"
            Button4.BackColor = Drawing.Color.LightGray
        End If
        _daten.write_to_table(AutomatikParameterTableName, 16, _Fahrzeugbeleuchtung2)
    End Sub
    ' *** Dampf
    Private Sub Button5_Click(sender As System.Object, e As System.EventArgs) Handles Button5.Click
        If _Dampf = 0 Then
            _Dampf = 1
            Button5.Text = "Dampf ein/aus 1"
            Button5.BackColor = Drawing.Color.LightYellow
        ElseIf _Dampf = 1 Then
            _Dampf = 2
            Button5.Text = "Dampf ein/aus 2"
            Button5.BackColor = Drawing.Color.LightYellow
        ElseIf _Dampf = 2 Then
            _Dampf = 3
            Button5.Text = "Dampf ein"
            Button5.BackColor = Drawing.Color.LightYellow
        ElseIf _Dampf = 3 Then
            _Dampf = 0
            Button5.Text = "Dampf aus"
            Button5.BackColor = Drawing.Color.LightGray
        End If
        _daten.write_to_table(AutomatikParameterTableName, 17, _Dampf)
    End Sub
    ' *** Innenbeleuchtung
    Private Sub Button6_Click(sender As System.Object, e As System.EventArgs) Handles Button6.Click
        If _Innenbeleuchtung2 = 0 Then
            _Innenbeleuchtung2 = 1
            Button6.BackColor = Drawing.Color.LightYellow
            Button6.Text = "Innenlicht ein/aus"
        ElseIf _Innenbeleuchtung2 = 1 Then
            _Innenbeleuchtung2 = 2
            Button6.BackColor = Drawing.Color.LightYellow
            Button6.Text = "Innenlicht ein"
        ElseIf _Innenbeleuchtung2 = 2 Then
            _Innenbeleuchtung2 = 0
            Button6.BackColor = Drawing.Color.LightGray
            Button6.Text = "Innenlicht aus"
        End If
        _daten.write_to_table(AutomatikParameterTableName, 18, _Innenbeleuchtung2)
    End Sub
    ' *** Akustische Signale
    Private Sub Button7_Click(sender As System.Object, e As System.EventArgs) Handles Button7.Click
        If _AkustischeSignale = 0 Then
            _AkustischeSignale = 1
            Button7.Text = "Akust. Signale ein 1"
            Button7.BackColor = Drawing.Color.LightYellow
        ElseIf _AkustischeSignale = 1 Then
            _AkustischeSignale = 2
            Button7.Text = "Akust. Signale ein 2"
            Button7.BackColor = Drawing.Color.LightYellow
        ElseIf _AkustischeSignale = 2 Then
            _AkustischeSignale = 0
            Button7.Text = "Akust. Signale aus"
            Button7.BackColor = Drawing.Color.LightGray
        End If
        _daten.write_to_table(AutomatikParameterTableName, 19, _AkustischeSignale)
    End Sub
    ' *** Durchsagen
    Private Sub Button8_Click(sender As System.Object, e As System.EventArgs) Handles Button8.Click
        If _Durchsagen = 1 Then
            _Durchsagen = 0
            Button8.BackColor = Drawing.Color.LightGray
        Else
            _Durchsagen = 1
            Button8.BackColor = Drawing.Color.LightYellow
        End If
        _daten.write_to_table(AutomatikParameterTableName, 20, _Durchsagen)
    End Sub
    ' *** Fernlicht
    Private Sub Button9_Click(sender As System.Object, e As System.EventArgs) Handles Button9.Click
        If _Fernlicht = 1 Then
            _Fernlicht = 0
            Button9.BackColor = Drawing.Color.LightGray
        Else
            _Fernlicht = 1
            Button9.BackColor = Drawing.Color.LightYellow
        End If
        _daten.write_to_table(AutomatikParameterTableName, 21, _Fernlicht)

    End Sub

    Private Sub SetText(ByVal control As System.Windows.Forms.Control, ByVal text As String)
        If control.InvokeRequired Then
            control.Invoke(Sub() SetText(control, text))
        Else
            control.Text = text
        End If
    End Sub
    Private Sub LoadImage(ByVal control As System.Windows.Forms.PictureBox, ByVal location As String)
        If control.InvokeRequired Then
            control.Invoke(Sub() LoadImage(control, location))
        Else
            Try
                control.Load(location)
            Catch ex As Exception

            End Try
        End If
    End Sub

    Private Sub ComboBox1_SelectedIndexChanged(sender As System.Object, e As System.EventArgs) Handles ComboBox1.SelectedIndexChanged
        _daten.write_to_table(AutomatikParameterTableName, 52, ComboBox1.SelectedIndex)
    End Sub

    Private Sub LinkLabel1_LinkClicked(sender As System.Object, e As System.Windows.Forms.LinkLabelLinkClickedEventArgs) Handles LinkLabel1.LinkClicked
        Process.Start("http://192.168.178.25/")
    End Sub
    Private Sub LinkLabel2_LinkClicked(sender As Object, e As Windows.Forms.LinkLabelLinkClickedEventArgs) Handles LinkLabel2.LinkClicked
        Process.Start("http://192.168.178.57/")
    End Sub

End Class
